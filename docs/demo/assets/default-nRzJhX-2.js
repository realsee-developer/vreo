(function(){const Se=document.createElement("link").relList;if(Se&&Se.supports&&Se.supports("modulepreload"))return;for(const Ve of document.querySelectorAll('link[rel="modulepreload"]'))De(Ve);new MutationObserver(Ve=>{for(const Fe of Ve)if(Fe.type==="childList")for(const Je of Fe.addedNodes)Je.tagName==="LINK"&&Je.rel==="modulepreload"&&De(Je)}).observe(document,{childList:!0,subtree:!0});function Be(Ve){const Fe={};return Ve.integrity&&(Fe.integrity=Ve.integrity),Ve.referrerPolicy&&(Fe.referrerPolicy=Ve.referrerPolicy),Ve.crossOrigin==="use-credentials"?Fe.credentials="include":Ve.crossOrigin==="anonymous"?Fe.credentials="omit":Fe.credentials="same-origin",Fe}function De(Ve){if(Ve.ep)return;Ve.ep=!0;const Fe=Be(Ve);fetch(Ve.href,Fe)}})();function getDefaultExportFromCjs($e){return $e&&$e.__esModule&&Object.prototype.hasOwnProperty.call($e,"default")?$e.default:$e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var $e=Symbol.for("react.element"),Se=Symbol.for("react.portal"),Be=Symbol.for("react.fragment"),De=Symbol.for("react.strict_mode"),Ve=Symbol.for("react.profiler"),Fe=Symbol.for("react.provider"),Je=Symbol.for("react.context"),Xe=Symbol.for("react.forward_ref"),Ke=Symbol.for("react.suspense"),Ye=Symbol.for("react.memo"),or=Symbol.for("react.lazy"),sr=Symbol.iterator;function cr(Pn){return Pn===null||typeof Pn!="object"?null:(Pn=sr&&Pn[sr]||Pn["@@iterator"],typeof Pn=="function"?Pn:null)}var Br={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tn=Object.assign,en={};function an(Pn,Vn,Yn){this.props=Pn,this.context=Vn,this.refs=en,this.updater=Yn||Br}an.prototype.isReactComponent={},an.prototype.setState=function(Pn,Vn){if(typeof Pn!="object"&&typeof Pn!="function"&&Pn!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Pn,Vn,"setState")},an.prototype.forceUpdate=function(Pn){this.updater.enqueueForceUpdate(this,Pn,"forceUpdate")};function rn(){}rn.prototype=an.prototype;function on(Pn,Vn,Yn){this.props=Pn,this.context=Vn,this.refs=en,this.updater=Yn||Br}var sn=on.prototype=new rn;sn.constructor=on,tn(sn,an.prototype),sn.isPureReactComponent=!0;var ln=Array.isArray,cn=Object.prototype.hasOwnProperty,hn={current:null},mn={key:!0,ref:!0,__self:!0,__source:!0};function An(Pn,Vn,Yn){var ni,Rn={},In=null,Gn=null;if(Vn!=null)for(ni in Vn.ref!==void 0&&(Gn=Vn.ref),Vn.key!==void 0&&(In=""+Vn.key),Vn)cn.call(Vn,ni)&&!mn.hasOwnProperty(ni)&&(Rn[ni]=Vn[ni]);var Fn=arguments.length-2;if(Fn===1)Rn.children=Yn;else if(1<Fn){for(var Hn=Array(Fn),Dn=0;Dn<Fn;Dn++)Hn[Dn]=arguments[Dn+2];Rn.children=Hn}if(Pn&&Pn.defaultProps)for(ni in Fn=Pn.defaultProps,Fn)Rn[ni]===void 0&&(Rn[ni]=Fn[ni]);return{$$typeof:$e,type:Pn,key:In,ref:Gn,props:Rn,_owner:hn.current}}function xn(Pn,Vn){return{$$typeof:$e,type:Pn.type,key:Vn,ref:Pn.ref,props:Pn.props,_owner:Pn._owner}}function pn(Pn){return typeof Pn=="object"&&Pn!==null&&Pn.$$typeof===$e}function dn(Pn){var Vn={"=":"=0",":":"=2"};return"$"+Pn.replace(/[=:]/g,function(Yn){return Vn[Yn]})}var fn=/\/+/g;function yn(Pn,Vn){return typeof Pn=="object"&&Pn!==null&&Pn.key!=null?dn(""+Pn.key):Vn.toString(36)}function Sn(Pn,Vn,Yn,ni,Rn){var In=typeof Pn;(In==="undefined"||In==="boolean")&&(Pn=null);var Gn=!1;if(Pn===null)Gn=!0;else switch(In){case"string":case"number":Gn=!0;break;case"object":switch(Pn.$$typeof){case $e:case Se:Gn=!0}}if(Gn)return Gn=Pn,Rn=Rn(Gn),Pn=ni===""?"."+yn(Gn,0):ni,ln(Rn)?(Yn="",Pn!=null&&(Yn=Pn.replace(fn,"$&/")+"/"),Sn(Rn,Vn,Yn,"",function(Dn){return Dn})):Rn!=null&&(pn(Rn)&&(Rn=xn(Rn,Yn+(!Rn.key||Gn&&Gn.key===Rn.key?"":(""+Rn.key).replace(fn,"$&/")+"/")+Pn)),Vn.push(Rn)),1;if(Gn=0,ni=ni===""?".":ni+":",ln(Pn))for(var Fn=0;Fn<Pn.length;Fn++){In=Pn[Fn];var Hn=ni+yn(In,Fn);Gn+=Sn(In,Vn,Yn,Hn,Rn)}else if(Hn=cr(Pn),typeof Hn=="function")for(Pn=Hn.call(Pn),Fn=0;!(In=Pn.next()).done;)In=In.value,Hn=ni+yn(In,Fn++),Gn+=Sn(In,Vn,Yn,Hn,Rn);else if(In==="object")throw Vn=String(Pn),Error("Objects are not valid as a React child (found: "+(Vn==="[object Object]"?"object with keys {"+Object.keys(Pn).join(", ")+"}":Vn)+"). If you meant to render a collection of children, use an array instead.");return Gn}function gn(Pn,Vn,Yn){if(Pn==null)return Pn;var ni=[],Rn=0;return Sn(Pn,ni,"","",function(In){return Vn.call(Yn,In,Rn++)}),ni}function Cn(Pn){if(Pn._status===-1){var Vn=Pn._result;Vn=Vn(),Vn.then(function(Yn){(Pn._status===0||Pn._status===-1)&&(Pn._status=1,Pn._result=Yn)},function(Yn){(Pn._status===0||Pn._status===-1)&&(Pn._status=2,Pn._result=Yn)}),Pn._status===-1&&(Pn._status=0,Pn._result=Vn)}if(Pn._status===1)return Pn._result.default;throw Pn._result}var Mn={current:null},Bn={transition:null},kn={ReactCurrentDispatcher:Mn,ReactCurrentBatchConfig:Bn,ReactCurrentOwner:hn};function Ln(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:gn,forEach:function(Pn,Vn,Yn){gn(Pn,function(){Vn.apply(this,arguments)},Yn)},count:function(Pn){var Vn=0;return gn(Pn,function(){Vn++}),Vn},toArray:function(Pn){return gn(Pn,function(Vn){return Vn})||[]},only:function(Pn){if(!pn(Pn))throw Error("React.Children.only expected to receive a single React element child.");return Pn}},react_production_min.Component=an,react_production_min.Fragment=Be,react_production_min.Profiler=Ve,react_production_min.PureComponent=on,react_production_min.StrictMode=De,react_production_min.Suspense=Ke,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kn,react_production_min.act=Ln,react_production_min.cloneElement=function(Pn,Vn,Yn){if(Pn==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Pn+".");var ni=tn({},Pn.props),Rn=Pn.key,In=Pn.ref,Gn=Pn._owner;if(Vn!=null){if(Vn.ref!==void 0&&(In=Vn.ref,Gn=hn.current),Vn.key!==void 0&&(Rn=""+Vn.key),Pn.type&&Pn.type.defaultProps)var Fn=Pn.type.defaultProps;for(Hn in Vn)cn.call(Vn,Hn)&&!mn.hasOwnProperty(Hn)&&(ni[Hn]=Vn[Hn]===void 0&&Fn!==void 0?Fn[Hn]:Vn[Hn])}var Hn=arguments.length-2;if(Hn===1)ni.children=Yn;else if(1<Hn){Fn=Array(Hn);for(var Dn=0;Dn<Hn;Dn++)Fn[Dn]=arguments[Dn+2];ni.children=Fn}return{$$typeof:$e,type:Pn.type,key:Rn,ref:In,props:ni,_owner:Gn}},react_production_min.createContext=function(Pn){return Pn={$$typeof:Je,_currentValue:Pn,_currentValue2:Pn,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Pn.Provider={$$typeof:Fe,_context:Pn},Pn.Consumer=Pn},react_production_min.createElement=An,react_production_min.createFactory=function(Pn){var Vn=An.bind(null,Pn);return Vn.type=Pn,Vn},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(Pn){return{$$typeof:Xe,render:Pn}},react_production_min.isValidElement=pn,react_production_min.lazy=function(Pn){return{$$typeof:or,_payload:{_status:-1,_result:Pn},_init:Cn}},react_production_min.memo=function(Pn,Vn){return{$$typeof:Ye,type:Pn,compare:Vn===void 0?null:Vn}},react_production_min.startTransition=function(Pn){var Vn=Bn.transition;Bn.transition={};try{Pn()}finally{Bn.transition=Vn}},react_production_min.unstable_act=Ln,react_production_min.useCallback=function(Pn,Vn){return Mn.current.useCallback(Pn,Vn)},react_production_min.useContext=function(Pn){return Mn.current.useContext(Pn)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(Pn){return Mn.current.useDeferredValue(Pn)},react_production_min.useEffect=function(Pn,Vn){return Mn.current.useEffect(Pn,Vn)},react_production_min.useId=function(){return Mn.current.useId()},react_production_min.useImperativeHandle=function(Pn,Vn,Yn){return Mn.current.useImperativeHandle(Pn,Vn,Yn)},react_production_min.useInsertionEffect=function(Pn,Vn){return Mn.current.useInsertionEffect(Pn,Vn)},react_production_min.useLayoutEffect=function(Pn,Vn){return Mn.current.useLayoutEffect(Pn,Vn)},react_production_min.useMemo=function(Pn,Vn){return Mn.current.useMemo(Pn,Vn)},react_production_min.useReducer=function(Pn,Vn,Yn){return Mn.current.useReducer(Pn,Vn,Yn)},react_production_min.useRef=function(Pn){return Mn.current.useRef(Pn)},react_production_min.useState=function(Pn){return Mn.current.useState(Pn)},react_production_min.useSyncExternalStore=function(Pn,Vn,Yn){return Mn.current.useSyncExternalStore(Pn,Vn,Yn)},react_production_min.useTransition=function(){return Mn.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var $e=requireReact(),Se=Symbol.for("react.element"),Be=Symbol.for("react.fragment"),De=Object.prototype.hasOwnProperty,Ve=$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Fe={key:!0,ref:!0,__self:!0,__source:!0};function Je(Xe,Ke,Ye){var or,sr={},cr=null,Br=null;Ye!==void 0&&(cr=""+Ye),Ke.key!==void 0&&(cr=""+Ke.key),Ke.ref!==void 0&&(Br=Ke.ref);for(or in Ke)De.call(Ke,or)&&!Fe.hasOwnProperty(or)&&(sr[or]=Ke[or]);if(Xe&&Xe.defaultProps)for(or in Ke=Xe.defaultProps,Ke)sr[or]===void 0&&(sr[or]=Ke[or]);return{$$typeof:Se,type:Xe,key:cr,ref:Br,props:sr,_owner:Ve.current}}return reactJsxRuntime_production_min.Fragment=Be,reactJsxRuntime_production_min.jsx=Je,reactJsxRuntime_production_min.jsxs=Je,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function($e){function Se(Bn,kn){var Ln=Bn.length;Bn.push(kn);e:for(;0<Ln;){var Pn=Ln-1>>>1,Vn=Bn[Pn];if(0<Ve(Vn,kn))Bn[Pn]=kn,Bn[Ln]=Vn,Ln=Pn;else break e}}function Be(Bn){return Bn.length===0?null:Bn[0]}function De(Bn){if(Bn.length===0)return null;var kn=Bn[0],Ln=Bn.pop();if(Ln!==kn){Bn[0]=Ln;e:for(var Pn=0,Vn=Bn.length,Yn=Vn>>>1;Pn<Yn;){var ni=2*(Pn+1)-1,Rn=Bn[ni],In=ni+1,Gn=Bn[In];if(0>Ve(Rn,Ln))In<Vn&&0>Ve(Gn,Rn)?(Bn[Pn]=Gn,Bn[In]=Ln,Pn=In):(Bn[Pn]=Rn,Bn[ni]=Ln,Pn=ni);else if(In<Vn&&0>Ve(Gn,Ln))Bn[Pn]=Gn,Bn[In]=Ln,Pn=In;else break e}}return kn}function Ve(Bn,kn){var Ln=Bn.sortIndex-kn.sortIndex;return Ln!==0?Ln:Bn.id-kn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var Fe=performance;$e.unstable_now=function(){return Fe.now()}}else{var Je=Date,Xe=Je.now();$e.unstable_now=function(){return Je.now()-Xe}}var Ke=[],Ye=[],or=1,sr=null,cr=3,Br=!1,tn=!1,en=!1,an=typeof setTimeout=="function"?setTimeout:null,rn=typeof clearTimeout=="function"?clearTimeout:null,on=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function sn(Bn){for(var kn=Be(Ye);kn!==null;){if(kn.callback===null)De(Ye);else if(kn.startTime<=Bn)De(Ye),kn.sortIndex=kn.expirationTime,Se(Ke,kn);else break;kn=Be(Ye)}}function ln(Bn){if(en=!1,sn(Bn),!tn)if(Be(Ke)!==null)tn=!0,Cn(cn);else{var kn=Be(Ye);kn!==null&&Mn(ln,kn.startTime-Bn)}}function cn(Bn,kn){tn=!1,en&&(en=!1,rn(An),An=-1),Br=!0;var Ln=cr;try{for(sn(kn),sr=Be(Ke);sr!==null&&(!(sr.expirationTime>kn)||Bn&&!dn());){var Pn=sr.callback;if(typeof Pn=="function"){sr.callback=null,cr=sr.priorityLevel;var Vn=Pn(sr.expirationTime<=kn);kn=$e.unstable_now(),typeof Vn=="function"?sr.callback=Vn:sr===Be(Ke)&&De(Ke),sn(kn)}else De(Ke);sr=Be(Ke)}if(sr!==null)var Yn=!0;else{var ni=Be(Ye);ni!==null&&Mn(ln,ni.startTime-kn),Yn=!1}return Yn}finally{sr=null,cr=Ln,Br=!1}}var hn=!1,mn=null,An=-1,xn=5,pn=-1;function dn(){return!($e.unstable_now()-pn<xn)}function fn(){if(mn!==null){var Bn=$e.unstable_now();pn=Bn;var kn=!0;try{kn=mn(!0,Bn)}finally{kn?yn():(hn=!1,mn=null)}}else hn=!1}var yn;if(typeof on=="function")yn=function(){on(fn)};else if(typeof MessageChannel<"u"){var Sn=new MessageChannel,gn=Sn.port2;Sn.port1.onmessage=fn,yn=function(){gn.postMessage(null)}}else yn=function(){an(fn,0)};function Cn(Bn){mn=Bn,hn||(hn=!0,yn())}function Mn(Bn,kn){An=an(function(){Bn($e.unstable_now())},kn)}$e.unstable_IdlePriority=5,$e.unstable_ImmediatePriority=1,$e.unstable_LowPriority=4,$e.unstable_NormalPriority=3,$e.unstable_Profiling=null,$e.unstable_UserBlockingPriority=2,$e.unstable_cancelCallback=function(Bn){Bn.callback=null},$e.unstable_continueExecution=function(){tn||Br||(tn=!0,Cn(cn))},$e.unstable_forceFrameRate=function(Bn){0>Bn||125<Bn?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xn=0<Bn?Math.floor(1e3/Bn):5},$e.unstable_getCurrentPriorityLevel=function(){return cr},$e.unstable_getFirstCallbackNode=function(){return Be(Ke)},$e.unstable_next=function(Bn){switch(cr){case 1:case 2:case 3:var kn=3;break;default:kn=cr}var Ln=cr;cr=kn;try{return Bn()}finally{cr=Ln}},$e.unstable_pauseExecution=function(){},$e.unstable_requestPaint=function(){},$e.unstable_runWithPriority=function(Bn,kn){switch(Bn){case 1:case 2:case 3:case 4:case 5:break;default:Bn=3}var Ln=cr;cr=Bn;try{return kn()}finally{cr=Ln}},$e.unstable_scheduleCallback=function(Bn,kn,Ln){var Pn=$e.unstable_now();switch(typeof Ln=="object"&&Ln!==null?(Ln=Ln.delay,Ln=typeof Ln=="number"&&0<Ln?Pn+Ln:Pn):Ln=Pn,Bn){case 1:var Vn=-1;break;case 2:Vn=250;break;case 5:Vn=1073741823;break;case 4:Vn=1e4;break;default:Vn=5e3}return Vn=Ln+Vn,Bn={id:or++,callback:kn,priorityLevel:Bn,startTime:Ln,expirationTime:Vn,sortIndex:-1},Ln>Pn?(Bn.sortIndex=Ln,Se(Ye,Bn),Be(Ke)===null&&Bn===Be(Ye)&&(en?(rn(An),An=-1):en=!0,Mn(ln,Ln-Pn))):(Bn.sortIndex=Vn,Se(Ke,Bn),tn||Br||(tn=!0,Cn(cn))),Bn},$e.unstable_shouldYield=dn,$e.unstable_wrapCallback=function(Bn){var kn=cr;return function(){var Ln=cr;cr=kn;try{return Bn.apply(this,arguments)}finally{cr=Ln}}}}(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var $e=requireReact(),Se=requireScheduler();function Be(Ar){for(var nn="https://reactjs.org/docs/error-decoder.html?invariant="+Ar,un=1;un<arguments.length;un++)nn+="&args[]="+encodeURIComponent(arguments[un]);return"Minified React error #"+Ar+"; visit "+nn+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var De=new Set,Ve={};function Fe(Ar,nn){Je(Ar,nn),Je(Ar+"Capture",nn)}function Je(Ar,nn){for(Ve[Ar]=nn,Ar=0;Ar<nn.length;Ar++)De.add(nn[Ar])}var Xe=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ke=Object.prototype.hasOwnProperty,Ye=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,or={},sr={};function cr(Ar){return Ke.call(sr,Ar)?!0:Ke.call(or,Ar)?!1:Ye.test(Ar)?sr[Ar]=!0:(or[Ar]=!0,!1)}function Br(Ar,nn,un,vn){if(un!==null&&un.type===0)return!1;switch(typeof nn){case"function":case"symbol":return!0;case"boolean":return vn?!1:un!==null?!un.acceptsBooleans:(Ar=Ar.toLowerCase().slice(0,5),Ar!=="data-"&&Ar!=="aria-");default:return!1}}function tn(Ar,nn,un,vn){if(nn===null||typeof nn>"u"||Br(Ar,nn,un,vn))return!0;if(vn)return!1;if(un!==null)switch(un.type){case 3:return!nn;case 4:return nn===!1;case 5:return isNaN(nn);case 6:return isNaN(nn)||1>nn}return!1}function en(Ar,nn,un,vn,En,$n,jn){this.acceptsBooleans=nn===2||nn===3||nn===4,this.attributeName=vn,this.attributeNamespace=En,this.mustUseProperty=un,this.propertyName=Ar,this.type=nn,this.sanitizeURL=$n,this.removeEmptyString=jn}var an={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(Ar){an[Ar]=new en(Ar,0,!1,Ar,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(Ar){var nn=Ar[0];an[nn]=new en(nn,1,!1,Ar[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(Ar){an[Ar]=new en(Ar,2,!1,Ar.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(Ar){an[Ar]=new en(Ar,2,!1,Ar,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(Ar){an[Ar]=new en(Ar,3,!1,Ar.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(Ar){an[Ar]=new en(Ar,3,!0,Ar,null,!1,!1)}),["capture","download"].forEach(function(Ar){an[Ar]=new en(Ar,4,!1,Ar,null,!1,!1)}),["cols","rows","size","span"].forEach(function(Ar){an[Ar]=new en(Ar,6,!1,Ar,null,!1,!1)}),["rowSpan","start"].forEach(function(Ar){an[Ar]=new en(Ar,5,!1,Ar.toLowerCase(),null,!1,!1)});var rn=/[\-:]([a-z])/g;function on(Ar){return Ar[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(Ar){var nn=Ar.replace(rn,on);an[nn]=new en(nn,1,!1,Ar,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(Ar){var nn=Ar.replace(rn,on);an[nn]=new en(nn,1,!1,Ar,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(Ar){var nn=Ar.replace(rn,on);an[nn]=new en(nn,1,!1,Ar,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(Ar){an[Ar]=new en(Ar,1,!1,Ar.toLowerCase(),null,!1,!1)}),an.xlinkHref=new en("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(Ar){an[Ar]=new en(Ar,1,!1,Ar.toLowerCase(),null,!0,!0)});function sn(Ar,nn,un,vn){var En=an.hasOwnProperty(nn)?an[nn]:null;(En!==null?En.type!==0:vn||!(2<nn.length)||nn[0]!=="o"&&nn[0]!=="O"||nn[1]!=="n"&&nn[1]!=="N")&&(tn(nn,un,En,vn)&&(un=null),vn||En===null?cr(nn)&&(un===null?Ar.removeAttribute(nn):Ar.setAttribute(nn,""+un)):En.mustUseProperty?Ar[En.propertyName]=un===null?En.type===3?!1:"":un:(nn=En.attributeName,vn=En.attributeNamespace,un===null?Ar.removeAttribute(nn):(En=En.type,un=En===3||En===4&&un===!0?"":""+un,vn?Ar.setAttributeNS(vn,nn,un):Ar.setAttribute(nn,un))))}var ln=$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cn=Symbol.for("react.element"),hn=Symbol.for("react.portal"),mn=Symbol.for("react.fragment"),An=Symbol.for("react.strict_mode"),xn=Symbol.for("react.profiler"),pn=Symbol.for("react.provider"),dn=Symbol.for("react.context"),fn=Symbol.for("react.forward_ref"),yn=Symbol.for("react.suspense"),Sn=Symbol.for("react.suspense_list"),gn=Symbol.for("react.memo"),Cn=Symbol.for("react.lazy"),Mn=Symbol.for("react.offscreen"),Bn=Symbol.iterator;function kn(Ar){return Ar===null||typeof Ar!="object"?null:(Ar=Bn&&Ar[Bn]||Ar["@@iterator"],typeof Ar=="function"?Ar:null)}var Ln=Object.assign,Pn;function Vn(Ar){if(Pn===void 0)try{throw Error()}catch(un){var nn=un.stack.trim().match(/\n( *(at )?)/);Pn=nn&&nn[1]||""}return`
`+Pn+Ar}var Yn=!1;function ni(Ar,nn){if(!Ar||Yn)return"";Yn=!0;var un=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(nn)if(nn=function(){throw Error()},Object.defineProperty(nn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(nn,[])}catch(Ei){var vn=Ei}Reflect.construct(Ar,[],nn)}else{try{nn.call()}catch(Ei){vn=Ei}Ar.call(nn.prototype)}else{try{throw Error()}catch(Ei){vn=Ei}Ar()}}catch(Ei){if(Ei&&vn&&typeof Ei.stack=="string"){for(var En=Ei.stack.split(`
`),$n=vn.stack.split(`
`),jn=En.length-1,ii=$n.length-1;1<=jn&&0<=ii&&En[jn]!==$n[ii];)ii--;for(;1<=jn&&0<=ii;jn--,ii--)if(En[jn]!==$n[ii]){if(jn!==1||ii!==1)do if(jn--,ii--,0>ii||En[jn]!==$n[ii]){var di=`
`+En[jn].replace(" at new "," at ");return Ar.displayName&&di.includes("<anonymous>")&&(di=di.replace("<anonymous>",Ar.displayName)),di}while(1<=jn&&0<=ii);break}}}finally{Yn=!1,Error.prepareStackTrace=un}return(Ar=Ar?Ar.displayName||Ar.name:"")?Vn(Ar):""}function Rn(Ar){switch(Ar.tag){case 5:return Vn(Ar.type);case 16:return Vn("Lazy");case 13:return Vn("Suspense");case 19:return Vn("SuspenseList");case 0:case 2:case 15:return Ar=ni(Ar.type,!1),Ar;case 11:return Ar=ni(Ar.type.render,!1),Ar;case 1:return Ar=ni(Ar.type,!0),Ar;default:return""}}function In(Ar){if(Ar==null)return null;if(typeof Ar=="function")return Ar.displayName||Ar.name||null;if(typeof Ar=="string")return Ar;switch(Ar){case mn:return"Fragment";case hn:return"Portal";case xn:return"Profiler";case An:return"StrictMode";case yn:return"Suspense";case Sn:return"SuspenseList"}if(typeof Ar=="object")switch(Ar.$$typeof){case dn:return(Ar.displayName||"Context")+".Consumer";case pn:return(Ar._context.displayName||"Context")+".Provider";case fn:var nn=Ar.render;return Ar=Ar.displayName,Ar||(Ar=nn.displayName||nn.name||"",Ar=Ar!==""?"ForwardRef("+Ar+")":"ForwardRef"),Ar;case gn:return nn=Ar.displayName||null,nn!==null?nn:In(Ar.type)||"Memo";case Cn:nn=Ar._payload,Ar=Ar._init;try{return In(Ar(nn))}catch{}}return null}function Gn(Ar){var nn=Ar.type;switch(Ar.tag){case 24:return"Cache";case 9:return(nn.displayName||"Context")+".Consumer";case 10:return(nn._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return Ar=nn.render,Ar=Ar.displayName||Ar.name||"",nn.displayName||(Ar!==""?"ForwardRef("+Ar+")":"ForwardRef");case 7:return"Fragment";case 5:return nn;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return In(nn);case 8:return nn===An?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof nn=="function")return nn.displayName||nn.name||null;if(typeof nn=="string")return nn}return null}function Fn(Ar){switch(typeof Ar){case"boolean":case"number":case"string":case"undefined":return Ar;case"object":return Ar;default:return""}}function Hn(Ar){var nn=Ar.type;return(Ar=Ar.nodeName)&&Ar.toLowerCase()==="input"&&(nn==="checkbox"||nn==="radio")}function Dn(Ar){var nn=Hn(Ar)?"checked":"value",un=Object.getOwnPropertyDescriptor(Ar.constructor.prototype,nn),vn=""+Ar[nn];if(!Ar.hasOwnProperty(nn)&&typeof un<"u"&&typeof un.get=="function"&&typeof un.set=="function"){var En=un.get,$n=un.set;return Object.defineProperty(Ar,nn,{configurable:!0,get:function(){return En.call(this)},set:function(jn){vn=""+jn,$n.call(this,jn)}}),Object.defineProperty(Ar,nn,{enumerable:un.enumerable}),{getValue:function(){return vn},setValue:function(jn){vn=""+jn},stopTracking:function(){Ar._valueTracker=null,delete Ar[nn]}}}}function zn(Ar){Ar._valueTracker||(Ar._valueTracker=Dn(Ar))}function Qn(Ar){if(!Ar)return!1;var nn=Ar._valueTracker;if(!nn)return!0;var un=nn.getValue(),vn="";return Ar&&(vn=Hn(Ar)?Ar.checked?"true":"false":Ar.value),Ar=vn,Ar!==un?(nn.setValue(Ar),!0):!1}function Zn(Ar){if(Ar=Ar||(typeof document<"u"?document:void 0),typeof Ar>"u")return null;try{return Ar.activeElement||Ar.body}catch{return Ar.body}}function si(Ar,nn){var un=nn.checked;return Ln({},nn,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:un??Ar._wrapperState.initialChecked})}function ei(Ar,nn){var un=nn.defaultValue==null?"":nn.defaultValue,vn=nn.checked!=null?nn.checked:nn.defaultChecked;un=Fn(nn.value!=null?nn.value:un),Ar._wrapperState={initialChecked:vn,initialValue:un,controlled:nn.type==="checkbox"||nn.type==="radio"?nn.checked!=null:nn.value!=null}}function hi(Ar,nn){nn=nn.checked,nn!=null&&sn(Ar,"checked",nn,!1)}function Un(Ar,nn){hi(Ar,nn);var un=Fn(nn.value),vn=nn.type;if(un!=null)vn==="number"?(un===0&&Ar.value===""||Ar.value!=un)&&(Ar.value=""+un):Ar.value!==""+un&&(Ar.value=""+un);else if(vn==="submit"||vn==="reset"){Ar.removeAttribute("value");return}nn.hasOwnProperty("value")?Ai(Ar,nn.type,un):nn.hasOwnProperty("defaultValue")&&Ai(Ar,nn.type,Fn(nn.defaultValue)),nn.checked==null&&nn.defaultChecked!=null&&(Ar.defaultChecked=!!nn.defaultChecked)}function Wn(Ar,nn,un){if(nn.hasOwnProperty("value")||nn.hasOwnProperty("defaultValue")){var vn=nn.type;if(!(vn!=="submit"&&vn!=="reset"||nn.value!==void 0&&nn.value!==null))return;nn=""+Ar._wrapperState.initialValue,un||nn===Ar.value||(Ar.value=nn),Ar.defaultValue=nn}un=Ar.name,un!==""&&(Ar.name=""),Ar.defaultChecked=!!Ar._wrapperState.initialChecked,un!==""&&(Ar.name=un)}function Ai(Ar,nn,un){(nn!=="number"||Zn(Ar.ownerDocument)!==Ar)&&(un==null?Ar.defaultValue=""+Ar._wrapperState.initialValue:Ar.defaultValue!==""+un&&(Ar.defaultValue=""+un))}var oi=Array.isArray;function ci(Ar,nn,un,vn){if(Ar=Ar.options,nn){nn={};for(var En=0;En<un.length;En++)nn["$"+un[En]]=!0;for(un=0;un<Ar.length;un++)En=nn.hasOwnProperty("$"+Ar[un].value),Ar[un].selected!==En&&(Ar[un].selected=En),En&&vn&&(Ar[un].defaultSelected=!0)}else{for(un=""+Fn(un),nn=null,En=0;En<Ar.length;En++){if(Ar[En].value===un){Ar[En].selected=!0,vn&&(Ar[En].defaultSelected=!0);return}nn!==null||Ar[En].disabled||(nn=Ar[En])}nn!==null&&(nn.selected=!0)}}function ai(Ar,nn){if(nn.dangerouslySetInnerHTML!=null)throw Error(Be(91));return Ln({},nn,{value:void 0,defaultValue:void 0,children:""+Ar._wrapperState.initialValue})}function wi(Ar,nn){var un=nn.value;if(un==null){if(un=nn.children,nn=nn.defaultValue,un!=null){if(nn!=null)throw Error(Be(92));if(oi(un)){if(1<un.length)throw Error(Be(93));un=un[0]}nn=un}nn==null&&(nn=""),un=nn}Ar._wrapperState={initialValue:Fn(un)}}function Pi(Ar,nn){var un=Fn(nn.value),vn=Fn(nn.defaultValue);un!=null&&(un=""+un,un!==Ar.value&&(Ar.value=un),nn.defaultValue==null&&Ar.defaultValue!==un&&(Ar.defaultValue=un)),vn!=null&&(Ar.defaultValue=""+vn)}function Oi(Ar){var nn=Ar.textContent;nn===Ar._wrapperState.initialValue&&nn!==""&&nn!==null&&(Ar.value=nn)}function Ri(Ar){switch(Ar){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _i(Ar,nn){return Ar==null||Ar==="http://www.w3.org/1999/xhtml"?Ri(nn):Ar==="http://www.w3.org/2000/svg"&&nn==="foreignObject"?"http://www.w3.org/1999/xhtml":Ar}var Mi,$i=function(Ar){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(nn,un,vn,En){MSApp.execUnsafeLocalFunction(function(){return Ar(nn,un,vn,En)})}:Ar}(function(Ar,nn){if(Ar.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in Ar)Ar.innerHTML=nn;else{for(Mi=Mi||document.createElement("div"),Mi.innerHTML="<svg>"+nn.valueOf().toString()+"</svg>",nn=Mi.firstChild;Ar.firstChild;)Ar.removeChild(Ar.firstChild);for(;nn.firstChild;)Ar.appendChild(nn.firstChild)}});function vi(Ar,nn){if(nn){var un=Ar.firstChild;if(un&&un===Ar.lastChild&&un.nodeType===3){un.nodeValue=nn;return}}Ar.textContent=nn}var ri={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ti=["Webkit","ms","Moz","O"];Object.keys(ri).forEach(function(Ar){Ti.forEach(function(nn){nn=nn+Ar.charAt(0).toUpperCase()+Ar.substring(1),ri[nn]=ri[Ar]})});function Bi(Ar,nn,un){return nn==null||typeof nn=="boolean"||nn===""?"":un||typeof nn!="number"||nn===0||ri.hasOwnProperty(Ar)&&ri[Ar]?(""+nn).trim():nn+"px"}function qi(Ar,nn){Ar=Ar.style;for(var un in nn)if(nn.hasOwnProperty(un)){var vn=un.indexOf("--")===0,En=Bi(un,nn[un],vn);un==="float"&&(un="cssFloat"),vn?Ar.setProperty(un,En):Ar[un]=En}}var Ii=Ln({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ui(Ar,nn){if(nn){if(Ii[Ar]&&(nn.children!=null||nn.dangerouslySetInnerHTML!=null))throw Error(Be(137,Ar));if(nn.dangerouslySetInnerHTML!=null){if(nn.children!=null)throw Error(Be(60));if(typeof nn.dangerouslySetInnerHTML!="object"||!("__html"in nn.dangerouslySetInnerHTML))throw Error(Be(61))}if(nn.style!=null&&typeof nn.style!="object")throw Error(Be(62))}}function ho(Ar,nn){if(Ar.indexOf("-")===-1)return typeof nn.is=="string";switch(Ar){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lo=null;function po(Ar){return Ar=Ar.target||Ar.srcElement||window,Ar.correspondingUseElement&&(Ar=Ar.correspondingUseElement),Ar.nodeType===3?Ar.parentNode:Ar}var co=null,go=null,vo=null;function Eo(Ar){if(Ar=ql(Ar)){if(typeof co!="function")throw Error(Be(280));var nn=Ar.stateNode;nn&&(nn=mu(nn),co(Ar.stateNode,Ar.type,nn))}}function Oo(Ar){go?vo?vo.push(Ar):vo=[Ar]:go=Ar}function Bo(){if(go){var Ar=go,nn=vo;if(vo=go=null,Eo(Ar),nn)for(Ar=0;Ar<nn.length;Ar++)Eo(nn[Ar])}}function Po(Ar,nn){return Ar(nn)}function Kn(){}var mi=!1;function gi(Ar,nn,un){if(mi)return Ar(nn,un);mi=!0;try{return Po(Ar,nn,un)}finally{mi=!1,(go!==null||vo!==null)&&(Kn(),Bo())}}function xi(Ar,nn){var un=Ar.stateNode;if(un===null)return null;var vn=mu(un);if(vn===null)return null;un=vn[nn];e:switch(nn){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(vn=!vn.disabled)||(Ar=Ar.type,vn=!(Ar==="button"||Ar==="input"||Ar==="select"||Ar==="textarea")),Ar=!vn;break e;default:Ar=!1}if(Ar)return null;if(un&&typeof un!="function")throw Error(Be(231,nn,typeof un));return un}var ki=!1;if(Xe)try{var Ki={};Object.defineProperty(Ki,"passive",{get:function(){ki=!0}}),window.addEventListener("test",Ki,Ki),window.removeEventListener("test",Ki,Ki)}catch{ki=!1}function Yi(Ar,nn,un,vn,En,$n,jn,ii,di){var Ei=Array.prototype.slice.call(arguments,3);try{nn.apply(un,Ei)}catch(Di){this.onError(Di)}}var ji=!1,Wi=null,Gi=!1,Mo=null,bo={onError:function(Ar){ji=!0,Wi=Ar}};function fo(Ar,nn,un,vn,En,$n,jn,ii,di){ji=!1,Wi=null,Yi.apply(bo,arguments)}function Hi(Ar,nn,un,vn,En,$n,jn,ii,di){if(fo.apply(this,arguments),ji){if(ji){var Ei=Wi;ji=!1,Wi=null}else throw Error(Be(198));Gi||(Gi=!0,Mo=Ei)}}function eo(Ar){var nn=Ar,un=Ar;if(Ar.alternate)for(;nn.return;)nn=nn.return;else{Ar=nn;do nn=Ar,(nn.flags&4098)!==0&&(un=nn.return),Ar=nn.return;while(Ar)}return nn.tag===3?un:null}function mo(Ar){if(Ar.tag===13){var nn=Ar.memoizedState;if(nn===null&&(Ar=Ar.alternate,Ar!==null&&(nn=Ar.memoizedState)),nn!==null)return nn.dehydrated}return null}function xo(Ar){if(eo(Ar)!==Ar)throw Error(Be(188))}function ro(Ar){var nn=Ar.alternate;if(!nn){if(nn=eo(Ar),nn===null)throw Error(Be(188));return nn!==Ar?null:Ar}for(var un=Ar,vn=nn;;){var En=un.return;if(En===null)break;var $n=En.alternate;if($n===null){if(vn=En.return,vn!==null){un=vn;continue}break}if(En.child===$n.child){for($n=En.child;$n;){if($n===un)return xo(En),Ar;if($n===vn)return xo(En),nn;$n=$n.sibling}throw Error(Be(188))}if(un.return!==vn.return)un=En,vn=$n;else{for(var jn=!1,ii=En.child;ii;){if(ii===un){jn=!0,un=En,vn=$n;break}if(ii===vn){jn=!0,vn=En,un=$n;break}ii=ii.sibling}if(!jn){for(ii=$n.child;ii;){if(ii===un){jn=!0,un=$n,vn=En;break}if(ii===vn){jn=!0,vn=$n,un=En;break}ii=ii.sibling}if(!jn)throw Error(Be(189))}}if(un.alternate!==vn)throw Error(Be(190))}if(un.tag!==3)throw Error(Be(188));return un.stateNode.current===un?Ar:nn}function To(Ar){return Ar=ro(Ar),Ar!==null?_o(Ar):null}function _o(Ar){if(Ar.tag===5||Ar.tag===6)return Ar;for(Ar=Ar.child;Ar!==null;){var nn=_o(Ar);if(nn!==null)return nn;Ar=Ar.sibling}return null}var Ho=Se.unstable_scheduleCallback,Io=Se.unstable_cancelCallback,Xa=Se.unstable_shouldYield,Na=Se.unstable_requestPaint,$o=Se.unstable_now,qo=Se.unstable_getCurrentPriorityLevel,na=Se.unstable_ImmediatePriority,Go=Se.unstable_UserBlockingPriority,Jo=Se.unstable_NormalPriority,Xo=Se.unstable_LowPriority,Do=Se.unstable_IdlePriority,ia=null,va=null;function Ka(Ar){if(va&&typeof va.onCommitFiberRoot=="function")try{va.onCommitFiberRoot(ia,Ar,void 0,(Ar.current.flags&128)===128)}catch{}}var Fo=Math.clz32?Math.clz32:Pa,sa=Math.log,za=Math.LN2;function Pa(Ar){return Ar>>>=0,Ar===0?32:31-(sa(Ar)/za|0)|0}var wa=64,ma=4194304;function Aa(Ar){switch(Ar&-Ar){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Ar&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return Ar&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return Ar}}function da(Ar,nn){var un=Ar.pendingLanes;if(un===0)return 0;var vn=0,En=Ar.suspendedLanes,$n=Ar.pingedLanes,jn=un&268435455;if(jn!==0){var ii=jn&~En;ii!==0?vn=Aa(ii):($n&=jn,$n!==0&&(vn=Aa($n)))}else jn=un&~En,jn!==0?vn=Aa(jn):$n!==0&&(vn=Aa($n));if(vn===0)return 0;if(nn!==0&&nn!==vn&&(nn&En)===0&&(En=vn&-vn,$n=nn&-nn,En>=$n||En===16&&($n&4194240)!==0))return nn;if((vn&4)!==0&&(vn|=un&16),nn=Ar.entangledLanes,nn!==0)for(Ar=Ar.entanglements,nn&=vn;0<nn;)un=31-Fo(nn),En=1<<un,vn|=Ar[un],nn&=~En;return vn}function Ia(Ar,nn){switch(Ar){case 1:case 2:case 4:return nn+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return nn+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ys(Ar,nn){for(var un=Ar.suspendedLanes,vn=Ar.pingedLanes,En=Ar.expirationTimes,$n=Ar.pendingLanes;0<$n;){var jn=31-Fo($n),ii=1<<jn,di=En[jn];di===-1?((ii&un)===0||(ii&vn)!==0)&&(En[jn]=Ia(ii,nn)):di<=nn&&(Ar.expiredLanes|=ii),$n&=~ii}}function Ua(Ar){return Ar=Ar.pendingLanes&-1073741825,Ar!==0?Ar:Ar&1073741824?1073741824:0}function Ya(){var Ar=wa;return wa<<=1,(wa&4194240)===0&&(wa=64),Ar}function ja(Ar){for(var nn=[],un=0;31>un;un++)nn.push(Ar);return nn}function Nn(Ar,nn,un){Ar.pendingLanes|=nn,nn!==536870912&&(Ar.suspendedLanes=0,Ar.pingedLanes=0),Ar=Ar.eventTimes,nn=31-Fo(nn),Ar[nn]=un}function Xn(Ar,nn){var un=Ar.pendingLanes&~nn;Ar.pendingLanes=nn,Ar.suspendedLanes=0,Ar.pingedLanes=0,Ar.expiredLanes&=nn,Ar.mutableReadLanes&=nn,Ar.entangledLanes&=nn,nn=Ar.entanglements;var vn=Ar.eventTimes;for(Ar=Ar.expirationTimes;0<un;){var En=31-Fo(un),$n=1<<En;nn[En]=0,vn[En]=-1,Ar[En]=-1,un&=~$n}}function _n(Ar,nn){var un=Ar.entangledLanes|=nn;for(Ar=Ar.entanglements;un;){var vn=31-Fo(un),En=1<<vn;En&nn|Ar[vn]&nn&&(Ar[vn]|=nn),un&=~En}}var On=0;function Jn(Ar){return Ar&=-Ar,1<Ar?4<Ar?(Ar&268435455)!==0?16:536870912:4:1}var pi,Si,zi,no,Co,Uo=!1,la=[],Zo=null,ea=null,Za=null,As=new Map,ns=new Map,Ga=[],Bs="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vl(Ar,nn){switch(Ar){case"focusin":case"focusout":Zo=null;break;case"dragenter":case"dragleave":ea=null;break;case"mouseover":case"mouseout":Za=null;break;case"pointerover":case"pointerout":As.delete(nn.pointerId);break;case"gotpointercapture":case"lostpointercapture":ns.delete(nn.pointerId)}}function bs(Ar,nn,un,vn,En,$n){return Ar===null||Ar.nativeEvent!==$n?(Ar={blockedOn:nn,domEventName:un,eventSystemFlags:vn,nativeEvent:$n,targetContainers:[En]},nn!==null&&(nn=ql(nn),nn!==null&&Si(nn)),Ar):(Ar.eventSystemFlags|=vn,nn=Ar.targetContainers,En!==null&&nn.indexOf(En)===-1&&nn.push(En),Ar)}function Ys(Ar,nn,un,vn,En){switch(nn){case"focusin":return Zo=bs(Zo,Ar,nn,un,vn,En),!0;case"dragenter":return ea=bs(ea,Ar,nn,un,vn,En),!0;case"mouseover":return Za=bs(Za,Ar,nn,un,vn,En),!0;case"pointerover":var $n=En.pointerId;return As.set($n,bs(As.get($n)||null,Ar,nn,un,vn,En)),!0;case"gotpointercapture":return $n=En.pointerId,ns.set($n,bs(ns.get($n)||null,Ar,nn,un,vn,En)),!0}return!1}function Zs(Ar){var nn=rl(Ar.target);if(nn!==null){var un=eo(nn);if(un!==null){if(nn=un.tag,nn===13){if(nn=mo(un),nn!==null){Ar.blockedOn=nn,Co(Ar.priority,function(){zi(un)});return}}else if(nn===3&&un.stateNode.current.memoizedState.isDehydrated){Ar.blockedOn=un.tag===3?un.stateNode.containerInfo:null;return}}}Ar.blockedOn=null}function ka(Ar){if(Ar.blockedOn!==null)return!1;for(var nn=Ar.targetContainers;0<nn.length;){var un=Ro(Ar.domEventName,Ar.eventSystemFlags,nn[0],Ar.nativeEvent);if(un===null){un=Ar.nativeEvent;var vn=new un.constructor(un.type,un);lo=vn,un.target.dispatchEvent(vn),lo=null}else return nn=ql(un),nn!==null&&Si(nn),Ar.blockedOn=un,!1;nn.shift()}return!0}function el(Ar,nn,un){ka(Ar)&&un.delete(nn)}function tl(){Uo=!1,Zo!==null&&ka(Zo)&&(Zo=null),ea!==null&&ka(ea)&&(ea=null),Za!==null&&ka(Za)&&(Za=null),As.forEach(el),ns.forEach(el)}function Ms(Ar,nn){Ar.blockedOn===nn&&(Ar.blockedOn=null,Uo||(Uo=!0,Se.unstable_scheduleCallback(Se.unstable_NormalPriority,tl)))}function _s(Ar){function nn(En){return Ms(En,Ar)}if(0<la.length){Ms(la[0],Ar);for(var un=1;un<la.length;un++){var vn=la[un];vn.blockedOn===Ar&&(vn.blockedOn=null)}}for(Zo!==null&&Ms(Zo,Ar),ea!==null&&Ms(ea,Ar),Za!==null&&Ms(Za,Ar),As.forEach(nn),ns.forEach(nn),un=0;un<Ga.length;un++)vn=Ga[un],vn.blockedOn===Ar&&(vn.blockedOn=null);for(;0<Ga.length&&(un=Ga[0],un.blockedOn===null);)Zs(un),un.blockedOn===null&&Ga.shift()}var Tn=ln.ReactCurrentBatchConfig,qn=!0;function li(Ar,nn,un,vn){var En=On,$n=Tn.transition;Tn.transition=null;try{On=1,wo(Ar,nn,un,vn)}finally{On=En,Tn.transition=$n}}function Ci(Ar,nn,un,vn){var En=On,$n=Tn.transition;Tn.transition=null;try{On=4,wo(Ar,nn,un,vn)}finally{On=En,Tn.transition=$n}}function wo(Ar,nn,un,vn){if(qn){var En=Ro(Ar,nn,un,vn);if(En===null)vc(Ar,nn,vn,ao,un),vl(Ar,vn);else if(Ys(En,Ar,nn,un,vn))vn.stopPropagation();else if(vl(Ar,vn),nn&4&&-1<Bs.indexOf(Ar)){for(;En!==null;){var $n=ql(En);if($n!==null&&pi($n),$n=Ro(Ar,nn,un,vn),$n===null&&vc(Ar,nn,vn,ao,un),$n===En)break;En=$n}En!==null&&vn.stopPropagation()}else vc(Ar,nn,vn,null,un)}}var ao=null;function Ro(Ar,nn,un,vn){if(ao=null,Ar=po(vn),Ar=rl(Ar),Ar!==null)if(nn=eo(Ar),nn===null)Ar=null;else if(un=nn.tag,un===13){if(Ar=mo(nn),Ar!==null)return Ar;Ar=null}else if(un===3){if(nn.stateNode.current.memoizedState.isDehydrated)return nn.tag===3?nn.stateNode.containerInfo:null;Ar=null}else nn!==Ar&&(Ar=null);return ao=Ar,null}function Lo(Ar){switch(Ar){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qo()){case na:return 1;case Go:return 4;case Jo:case Xo:return 16;case Do:return 536870912;default:return 16}default:return 16}}var jo=null,ko=null,ha=null;function Ca(){if(ha)return ha;var Ar,nn=ko,un=nn.length,vn,En="value"in jo?jo.value:jo.textContent,$n=En.length;for(Ar=0;Ar<un&&nn[Ar]===En[Ar];Ar++);var jn=un-Ar;for(vn=1;vn<=jn&&nn[un-vn]===En[$n-vn];vn++);return ha=En.slice(Ar,1<vn?1-vn:void 0)}function ta(Ar){var nn=Ar.keyCode;return"charCode"in Ar?(Ar=Ar.charCode,Ar===0&&nn===13&&(Ar=13)):Ar=nn,Ar===10&&(Ar=13),32<=Ar||Ar===13?Ar:0}function pa(){return!0}function ga(){return!1}function ua(Ar){function nn(un,vn,En,$n,jn){this._reactName=un,this._targetInst=En,this.type=vn,this.nativeEvent=$n,this.target=jn,this.currentTarget=null;for(var ii in Ar)Ar.hasOwnProperty(ii)&&(un=Ar[ii],this[ii]=un?un($n):$n[ii]);return this.isDefaultPrevented=($n.defaultPrevented!=null?$n.defaultPrevented:$n.returnValue===!1)?pa:ga,this.isPropagationStopped=ga,this}return Ln(nn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var un=this.nativeEvent;un&&(un.preventDefault?un.preventDefault():typeof un.returnValue!="unknown"&&(un.returnValue=!1),this.isDefaultPrevented=pa)},stopPropagation:function(){var un=this.nativeEvent;un&&(un.stopPropagation?un.stopPropagation():typeof un.cancelBubble!="unknown"&&(un.cancelBubble=!0),this.isPropagationStopped=pa)},persist:function(){},isPersistent:pa}),nn}var Ra={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(Ar){return Ar.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ds=ua(Ra),Ds=Ln({},Ra,{view:0,detail:0}),ml=ua(Ds),ks,rc,kl,lu=Ln({},Ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ic,button:0,buttons:0,relatedTarget:function(Ar){return Ar.relatedTarget===void 0?Ar.fromElement===Ar.srcElement?Ar.toElement:Ar.fromElement:Ar.relatedTarget},movementX:function(Ar){return"movementX"in Ar?Ar.movementX:(Ar!==kl&&(kl&&Ar.type==="mousemove"?(ks=Ar.screenX-kl.screenX,rc=Ar.screenY-kl.screenY):rc=ks=0,kl=Ar),ks)},movementY:function(Ar){return"movementY"in Ar?Ar.movementY:rc}}),Td=ua(lu),jp=Ln({},lu,{dataTransfer:0}),Gp=ua(jp),Hp=Ln({},Ds,{relatedTarget:0}),nc=ua(Hp),Wp=Ln({},Ra,{animationName:0,elapsedTime:0,pseudoElement:0}),qp=ua(Wp),Qp=Ln({},Ra,{clipboardData:function(Ar){return"clipboardData"in Ar?Ar.clipboardData:window.clipboardData}}),Jp=ua(Qp),Xp=Ln({},Ra,{data:0}),Pd=ua(Xp),Kp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ef(Ar){var nn=this.nativeEvent;return nn.getModifierState?nn.getModifierState(Ar):(Ar=Zp[Ar])?!!nn[Ar]:!1}function ic(){return ef}var tf=Ln({},Ds,{key:function(Ar){if(Ar.key){var nn=Kp[Ar.key]||Ar.key;if(nn!=="Unidentified")return nn}return Ar.type==="keypress"?(Ar=ta(Ar),Ar===13?"Enter":String.fromCharCode(Ar)):Ar.type==="keydown"||Ar.type==="keyup"?Yp[Ar.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ic,charCode:function(Ar){return Ar.type==="keypress"?ta(Ar):0},keyCode:function(Ar){return Ar.type==="keydown"||Ar.type==="keyup"?Ar.keyCode:0},which:function(Ar){return Ar.type==="keypress"?ta(Ar):Ar.type==="keydown"||Ar.type==="keyup"?Ar.keyCode:0}}),rf=ua(tf),nf=Ln({},lu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Id=ua(nf),of=Ln({},Ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ic}),af=ua(of),sf=Ln({},Ra,{propertyName:0,elapsedTime:0,pseudoElement:0}),lf=ua(sf),uf=Ln({},lu,{deltaX:function(Ar){return"deltaX"in Ar?Ar.deltaX:"wheelDeltaX"in Ar?-Ar.wheelDeltaX:0},deltaY:function(Ar){return"deltaY"in Ar?Ar.deltaY:"wheelDeltaY"in Ar?-Ar.wheelDeltaY:"wheelDelta"in Ar?-Ar.wheelDelta:0},deltaZ:0,deltaMode:0}),cf=ua(uf),df=[9,13,27,32],oc=Xe&&"CompositionEvent"in window,Vl=null;Xe&&"documentMode"in document&&(Vl=document.documentMode);var hf=Xe&&"TextEvent"in window&&!Vl,Rd=Xe&&(!oc||Vl&&8<Vl&&11>=Vl),Ld=" ",Od=!1;function Bd(Ar,nn){switch(Ar){case"keyup":return df.indexOf(nn.keyCode)!==-1;case"keydown":return nn.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dd(Ar){return Ar=Ar.detail,typeof Ar=="object"&&"data"in Ar?Ar.data:null}var gl=!1;function pf(Ar,nn){switch(Ar){case"compositionend":return Dd(nn);case"keypress":return nn.which!==32?null:(Od=!0,Ld);case"textInput":return Ar=nn.data,Ar===Ld&&Od?null:Ar;default:return null}}function ff(Ar,nn){if(gl)return Ar==="compositionend"||!oc&&Bd(Ar,nn)?(Ar=Ca(),ha=ko=jo=null,gl=!1,Ar):null;switch(Ar){case"paste":return null;case"keypress":if(!(nn.ctrlKey||nn.altKey||nn.metaKey)||nn.ctrlKey&&nn.altKey){if(nn.char&&1<nn.char.length)return nn.char;if(nn.which)return String.fromCharCode(nn.which)}return null;case"compositionend":return Rd&&nn.locale!=="ko"?null:nn.data;default:return null}}var vf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kd(Ar){var nn=Ar&&Ar.nodeName&&Ar.nodeName.toLowerCase();return nn==="input"?!!vf[Ar.type]:nn==="textarea"}function Vd(Ar,nn,un,vn){Oo(vn),nn=pu(nn,"onChange"),0<nn.length&&(un=new ds("onChange","change",null,un,vn),Ar.push({event:un,listeners:nn}))}var Fl=null,Nl=null;function mf(Ar){rh(Ar,0)}function uu(Ar){var nn=wl(Ar);if(Qn(nn))return Ar}function gf(Ar,nn){if(Ar==="change")return nn}var Fd=!1;if(Xe){var ac;if(Xe){var sc="oninput"in document;if(!sc){var Nd=document.createElement("div");Nd.setAttribute("oninput","return;"),sc=typeof Nd.oninput=="function"}ac=sc}else ac=!1;Fd=ac&&(!document.documentMode||9<document.documentMode)}function zd(){Fl&&(Fl.detachEvent("onpropertychange",Ud),Nl=Fl=null)}function Ud(Ar){if(Ar.propertyName==="value"&&uu(Nl)){var nn=[];Vd(nn,Nl,Ar,po(Ar)),gi(mf,nn)}}function yf(Ar,nn,un){Ar==="focusin"?(zd(),Fl=nn,Nl=un,Fl.attachEvent("onpropertychange",Ud)):Ar==="focusout"&&zd()}function Af(Ar){if(Ar==="selectionchange"||Ar==="keyup"||Ar==="keydown")return uu(Nl)}function bf(Ar,nn){if(Ar==="click")return uu(nn)}function xf(Ar,nn){if(Ar==="input"||Ar==="change")return uu(nn)}function wf(Ar,nn){return Ar===nn&&(Ar!==0||1/Ar===1/nn)||Ar!==Ar&&nn!==nn}var hs=typeof Object.is=="function"?Object.is:wf;function zl(Ar,nn){if(hs(Ar,nn))return!0;if(typeof Ar!="object"||Ar===null||typeof nn!="object"||nn===null)return!1;var un=Object.keys(Ar),vn=Object.keys(nn);if(un.length!==vn.length)return!1;for(vn=0;vn<un.length;vn++){var En=un[vn];if(!Ke.call(nn,En)||!hs(Ar[En],nn[En]))return!1}return!0}function jd(Ar){for(;Ar&&Ar.firstChild;)Ar=Ar.firstChild;return Ar}function Gd(Ar,nn){var un=jd(Ar);Ar=0;for(var vn;un;){if(un.nodeType===3){if(vn=Ar+un.textContent.length,Ar<=nn&&vn>=nn)return{node:un,offset:nn-Ar};Ar=vn}e:{for(;un;){if(un.nextSibling){un=un.nextSibling;break e}un=un.parentNode}un=void 0}un=jd(un)}}function Hd(Ar,nn){return Ar&&nn?Ar===nn?!0:Ar&&Ar.nodeType===3?!1:nn&&nn.nodeType===3?Hd(Ar,nn.parentNode):"contains"in Ar?Ar.contains(nn):Ar.compareDocumentPosition?!!(Ar.compareDocumentPosition(nn)&16):!1:!1}function Wd(){for(var Ar=window,nn=Zn();nn instanceof Ar.HTMLIFrameElement;){try{var un=typeof nn.contentWindow.location.href=="string"}catch{un=!1}if(un)Ar=nn.contentWindow;else break;nn=Zn(Ar.document)}return nn}function lc(Ar){var nn=Ar&&Ar.nodeName&&Ar.nodeName.toLowerCase();return nn&&(nn==="input"&&(Ar.type==="text"||Ar.type==="search"||Ar.type==="tel"||Ar.type==="url"||Ar.type==="password")||nn==="textarea"||Ar.contentEditable==="true")}function Sf(Ar){var nn=Wd(),un=Ar.focusedElem,vn=Ar.selectionRange;if(nn!==un&&un&&un.ownerDocument&&Hd(un.ownerDocument.documentElement,un)){if(vn!==null&&lc(un)){if(nn=vn.start,Ar=vn.end,Ar===void 0&&(Ar=nn),"selectionStart"in un)un.selectionStart=nn,un.selectionEnd=Math.min(Ar,un.value.length);else if(Ar=(nn=un.ownerDocument||document)&&nn.defaultView||window,Ar.getSelection){Ar=Ar.getSelection();var En=un.textContent.length,$n=Math.min(vn.start,En);vn=vn.end===void 0?$n:Math.min(vn.end,En),!Ar.extend&&$n>vn&&(En=vn,vn=$n,$n=En),En=Gd(un,$n);var jn=Gd(un,vn);En&&jn&&(Ar.rangeCount!==1||Ar.anchorNode!==En.node||Ar.anchorOffset!==En.offset||Ar.focusNode!==jn.node||Ar.focusOffset!==jn.offset)&&(nn=nn.createRange(),nn.setStart(En.node,En.offset),Ar.removeAllRanges(),$n>vn?(Ar.addRange(nn),Ar.extend(jn.node,jn.offset)):(nn.setEnd(jn.node,jn.offset),Ar.addRange(nn)))}}for(nn=[],Ar=un;Ar=Ar.parentNode;)Ar.nodeType===1&&nn.push({element:Ar,left:Ar.scrollLeft,top:Ar.scrollTop});for(typeof un.focus=="function"&&un.focus(),un=0;un<nn.length;un++)Ar=nn[un],Ar.element.scrollLeft=Ar.left,Ar.element.scrollTop=Ar.top}}var Ef=Xe&&"documentMode"in document&&11>=document.documentMode,yl=null,uc=null,Ul=null,cc=!1;function qd(Ar,nn,un){var vn=un.window===un?un.document:un.nodeType===9?un:un.ownerDocument;cc||yl==null||yl!==Zn(vn)||(vn=yl,"selectionStart"in vn&&lc(vn)?vn={start:vn.selectionStart,end:vn.selectionEnd}:(vn=(vn.ownerDocument&&vn.ownerDocument.defaultView||window).getSelection(),vn={anchorNode:vn.anchorNode,anchorOffset:vn.anchorOffset,focusNode:vn.focusNode,focusOffset:vn.focusOffset}),Ul&&zl(Ul,vn)||(Ul=vn,vn=pu(uc,"onSelect"),0<vn.length&&(nn=new ds("onSelect","select",null,nn,un),Ar.push({event:nn,listeners:vn}),nn.target=yl)))}function cu(Ar,nn){var un={};return un[Ar.toLowerCase()]=nn.toLowerCase(),un["Webkit"+Ar]="webkit"+nn,un["Moz"+Ar]="moz"+nn,un}var Al={animationend:cu("Animation","AnimationEnd"),animationiteration:cu("Animation","AnimationIteration"),animationstart:cu("Animation","AnimationStart"),transitionend:cu("Transition","TransitionEnd")},dc={},Qd={};Xe&&(Qd=document.createElement("div").style,"AnimationEvent"in window||(delete Al.animationend.animation,delete Al.animationiteration.animation,delete Al.animationstart.animation),"TransitionEvent"in window||delete Al.transitionend.transition);function du(Ar){if(dc[Ar])return dc[Ar];if(!Al[Ar])return Ar;var nn=Al[Ar],un;for(un in nn)if(nn.hasOwnProperty(un)&&un in Qd)return dc[Ar]=nn[un];return Ar}var Jd=du("animationend"),Xd=du("animationiteration"),Kd=du("animationstart"),Yd=du("transitionend"),Zd=new Map,eh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vs(Ar,nn){Zd.set(Ar,nn),Fe(nn,[Ar])}for(var hc=0;hc<eh.length;hc++){var pc=eh[hc],Mf=pc.toLowerCase(),_f=pc[0].toUpperCase()+pc.slice(1);Vs(Mf,"on"+_f)}Vs(Jd,"onAnimationEnd"),Vs(Xd,"onAnimationIteration"),Vs(Kd,"onAnimationStart"),Vs("dblclick","onDoubleClick"),Vs("focusin","onFocus"),Vs("focusout","onBlur"),Vs(Yd,"onTransitionEnd"),Je("onMouseEnter",["mouseout","mouseover"]),Je("onMouseLeave",["mouseout","mouseover"]),Je("onPointerEnter",["pointerout","pointerover"]),Je("onPointerLeave",["pointerout","pointerover"]),Fe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cf=new Set("cancel close invalid load scroll toggle".split(" ").concat(jl));function th(Ar,nn,un){var vn=Ar.type||"unknown-event";Ar.currentTarget=un,Hi(vn,nn,void 0,Ar),Ar.currentTarget=null}function rh(Ar,nn){nn=(nn&4)!==0;for(var un=0;un<Ar.length;un++){var vn=Ar[un],En=vn.event;vn=vn.listeners;e:{var $n=void 0;if(nn)for(var jn=vn.length-1;0<=jn;jn--){var ii=vn[jn],di=ii.instance,Ei=ii.currentTarget;if(ii=ii.listener,di!==$n&&En.isPropagationStopped())break e;th(En,ii,Ei),$n=di}else for(jn=0;jn<vn.length;jn++){if(ii=vn[jn],di=ii.instance,Ei=ii.currentTarget,ii=ii.listener,di!==$n&&En.isPropagationStopped())break e;th(En,ii,Ei),$n=di}}}if(Gi)throw Ar=Mo,Gi=!1,Mo=null,Ar}function Ko(Ar,nn){var un=nn[xc];un===void 0&&(un=nn[xc]=new Set);var vn=Ar+"__bubble";un.has(vn)||(nh(nn,Ar,2,!1),un.add(vn))}function fc(Ar,nn,un){var vn=0;nn&&(vn|=4),nh(un,Ar,vn,nn)}var hu="_reactListening"+Math.random().toString(36).slice(2);function Gl(Ar){if(!Ar[hu]){Ar[hu]=!0,De.forEach(function(un){un!=="selectionchange"&&(Cf.has(un)||fc(un,!1,Ar),fc(un,!0,Ar))});var nn=Ar.nodeType===9?Ar:Ar.ownerDocument;nn===null||nn[hu]||(nn[hu]=!0,fc("selectionchange",!1,nn))}}function nh(Ar,nn,un,vn){switch(Lo(nn)){case 1:var En=li;break;case 4:En=Ci;break;default:En=wo}un=En.bind(null,nn,un,Ar),En=void 0,!ki||nn!=="touchstart"&&nn!=="touchmove"&&nn!=="wheel"||(En=!0),vn?En!==void 0?Ar.addEventListener(nn,un,{capture:!0,passive:En}):Ar.addEventListener(nn,un,!0):En!==void 0?Ar.addEventListener(nn,un,{passive:En}):Ar.addEventListener(nn,un,!1)}function vc(Ar,nn,un,vn,En){var $n=vn;if((nn&1)===0&&(nn&2)===0&&vn!==null)e:for(;;){if(vn===null)return;var jn=vn.tag;if(jn===3||jn===4){var ii=vn.stateNode.containerInfo;if(ii===En||ii.nodeType===8&&ii.parentNode===En)break;if(jn===4)for(jn=vn.return;jn!==null;){var di=jn.tag;if((di===3||di===4)&&(di=jn.stateNode.containerInfo,di===En||di.nodeType===8&&di.parentNode===En))return;jn=jn.return}for(;ii!==null;){if(jn=rl(ii),jn===null)return;if(di=jn.tag,di===5||di===6){vn=$n=jn;continue e}ii=ii.parentNode}}vn=vn.return}gi(function(){var Ei=$n,Di=po(un),Vi=[];e:{var Li=Zd.get(Ar);if(Li!==void 0){var Xi=ds,to=Ar;switch(Ar){case"keypress":if(ta(un)===0)break e;case"keydown":case"keyup":Xi=rf;break;case"focusin":to="focus",Xi=nc;break;case"focusout":to="blur",Xi=nc;break;case"beforeblur":case"afterblur":Xi=nc;break;case"click":if(un.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xi=Td;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xi=Gp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xi=af;break;case Jd:case Xd:case Kd:Xi=qp;break;case Yd:Xi=lf;break;case"scroll":Xi=ml;break;case"wheel":Xi=cf;break;case"copy":case"cut":case"paste":Xi=Jp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xi=Id}var io=(nn&4)!==0,fa=!io&&Ar==="scroll",yi=io?Li!==null?Li+"Capture":null:Li;io=[];for(var fi=Ei,bi;fi!==null;){bi=fi;var Ni=bi.stateNode;if(bi.tag===5&&Ni!==null&&(bi=Ni,yi!==null&&(Ni=xi(fi,yi),Ni!=null&&io.push(Hl(fi,Ni,bi)))),fa)break;fi=fi.return}0<io.length&&(Li=new Xi(Li,to,null,un,Di),Vi.push({event:Li,listeners:io}))}}if((nn&7)===0){e:{if(Li=Ar==="mouseover"||Ar==="pointerover",Xi=Ar==="mouseout"||Ar==="pointerout",Li&&un!==lo&&(to=un.relatedTarget||un.fromElement)&&(rl(to)||to[Cs]))break e;if((Xi||Li)&&(Li=Di.window===Di?Di:(Li=Di.ownerDocument)?Li.defaultView||Li.parentWindow:window,Xi?(to=un.relatedTarget||un.toElement,Xi=Ei,to=to?rl(to):null,to!==null&&(fa=eo(to),to!==fa||to.tag!==5&&to.tag!==6)&&(to=null)):(Xi=null,to=Ei),Xi!==to)){if(io=Td,Ni="onMouseLeave",yi="onMouseEnter",fi="mouse",(Ar==="pointerout"||Ar==="pointerover")&&(io=Id,Ni="onPointerLeave",yi="onPointerEnter",fi="pointer"),fa=Xi==null?Li:wl(Xi),bi=to==null?Li:wl(to),Li=new io(Ni,fi+"leave",Xi,un,Di),Li.target=fa,Li.relatedTarget=bi,Ni=null,rl(Di)===Ei&&(io=new io(yi,fi+"enter",to,un,Di),io.target=bi,io.relatedTarget=fa,Ni=io),fa=Ni,Xi&&to)t:{for(io=Xi,yi=to,fi=0,bi=io;bi;bi=bl(bi))fi++;for(bi=0,Ni=yi;Ni;Ni=bl(Ni))bi++;for(;0<fi-bi;)io=bl(io),fi--;for(;0<bi-fi;)yi=bl(yi),bi--;for(;fi--;){if(io===yi||yi!==null&&io===yi.alternate)break t;io=bl(io),yi=bl(yi)}io=null}else io=null;Xi!==null&&ih(Vi,Li,Xi,io,!1),to!==null&&fa!==null&&ih(Vi,fa,to,io,!0)}}e:{if(Li=Ei?wl(Ei):window,Xi=Li.nodeName&&Li.nodeName.toLowerCase(),Xi==="select"||Xi==="input"&&Li.type==="file")var uo=gf;else if(kd(Li))if(Fd)uo=xf;else{uo=Af;var yo=yf}else(Xi=Li.nodeName)&&Xi.toLowerCase()==="input"&&(Li.type==="checkbox"||Li.type==="radio")&&(uo=bf);if(uo&&(uo=uo(Ar,Ei))){Vd(Vi,uo,un,Di);break e}yo&&yo(Ar,Li,Ei),Ar==="focusout"&&(yo=Li._wrapperState)&&yo.controlled&&Li.type==="number"&&Ai(Li,"number",Li.value)}switch(yo=Ei?wl(Ei):window,Ar){case"focusin":(kd(yo)||yo.contentEditable==="true")&&(yl=yo,uc=Ei,Ul=null);break;case"focusout":Ul=uc=yl=null;break;case"mousedown":cc=!0;break;case"contextmenu":case"mouseup":case"dragend":cc=!1,qd(Vi,un,Di);break;case"selectionchange":if(Ef)break;case"keydown":case"keyup":qd(Vi,un,Di)}var Ao;if(oc)e:{switch(Ar){case"compositionstart":var So="onCompositionStart";break e;case"compositionend":So="onCompositionEnd";break e;case"compositionupdate":So="onCompositionUpdate";break e}So=void 0}else gl?Bd(Ar,un)&&(So="onCompositionEnd"):Ar==="keydown"&&un.keyCode===229&&(So="onCompositionStart");So&&(Rd&&un.locale!=="ko"&&(gl||So!=="onCompositionStart"?So==="onCompositionEnd"&&gl&&(Ao=Ca()):(jo=Di,ko="value"in jo?jo.value:jo.textContent,gl=!0)),yo=pu(Ei,So),0<yo.length&&(So=new Pd(So,Ar,null,un,Di),Vi.push({event:So,listeners:yo}),Ao?So.data=Ao:(Ao=Dd(un),Ao!==null&&(So.data=Ao)))),(Ao=hf?pf(Ar,un):ff(Ar,un))&&(Ei=pu(Ei,"onBeforeInput"),0<Ei.length&&(Di=new Pd("onBeforeInput","beforeinput",null,un,Di),Vi.push({event:Di,listeners:Ei}),Di.data=Ao))}rh(Vi,nn)})}function Hl(Ar,nn,un){return{instance:Ar,listener:nn,currentTarget:un}}function pu(Ar,nn){for(var un=nn+"Capture",vn=[];Ar!==null;){var En=Ar,$n=En.stateNode;En.tag===5&&$n!==null&&(En=$n,$n=xi(Ar,un),$n!=null&&vn.unshift(Hl(Ar,$n,En)),$n=xi(Ar,nn),$n!=null&&vn.push(Hl(Ar,$n,En))),Ar=Ar.return}return vn}function bl(Ar){if(Ar===null)return null;do Ar=Ar.return;while(Ar&&Ar.tag!==5);return Ar||null}function ih(Ar,nn,un,vn,En){for(var $n=nn._reactName,jn=[];un!==null&&un!==vn;){var ii=un,di=ii.alternate,Ei=ii.stateNode;if(di!==null&&di===vn)break;ii.tag===5&&Ei!==null&&(ii=Ei,En?(di=xi(un,$n),di!=null&&jn.unshift(Hl(un,di,ii))):En||(di=xi(un,$n),di!=null&&jn.push(Hl(un,di,ii)))),un=un.return}jn.length!==0&&Ar.push({event:nn,listeners:jn})}var $f=/\r\n?/g,Tf=/\u0000|\uFFFD/g;function oh(Ar){return(typeof Ar=="string"?Ar:""+Ar).replace($f,`
`).replace(Tf,"")}function fu(Ar,nn,un){if(nn=oh(nn),oh(Ar)!==nn&&un)throw Error(Be(425))}function vu(){}var mc=null,gc=null;function yc(Ar,nn){return Ar==="textarea"||Ar==="noscript"||typeof nn.children=="string"||typeof nn.children=="number"||typeof nn.dangerouslySetInnerHTML=="object"&&nn.dangerouslySetInnerHTML!==null&&nn.dangerouslySetInnerHTML.__html!=null}var Ac=typeof setTimeout=="function"?setTimeout:void 0,Pf=typeof clearTimeout=="function"?clearTimeout:void 0,ah=typeof Promise=="function"?Promise:void 0,If=typeof queueMicrotask=="function"?queueMicrotask:typeof ah<"u"?function(Ar){return ah.resolve(null).then(Ar).catch(Rf)}:Ac;function Rf(Ar){setTimeout(function(){throw Ar})}function bc(Ar,nn){var un=nn,vn=0;do{var En=un.nextSibling;if(Ar.removeChild(un),En&&En.nodeType===8)if(un=En.data,un==="/$"){if(vn===0){Ar.removeChild(En),_s(nn);return}vn--}else un!=="$"&&un!=="$?"&&un!=="$!"||vn++;un=En}while(un);_s(nn)}function Fs(Ar){for(;Ar!=null;Ar=Ar.nextSibling){var nn=Ar.nodeType;if(nn===1||nn===3)break;if(nn===8){if(nn=Ar.data,nn==="$"||nn==="$!"||nn==="$?")break;if(nn==="/$")return null}}return Ar}function sh(Ar){Ar=Ar.previousSibling;for(var nn=0;Ar;){if(Ar.nodeType===8){var un=Ar.data;if(un==="$"||un==="$!"||un==="$?"){if(nn===0)return Ar;nn--}else un==="/$"&&nn++}Ar=Ar.previousSibling}return null}var xl=Math.random().toString(36).slice(2),xs="__reactFiber$"+xl,Wl="__reactProps$"+xl,Cs="__reactContainer$"+xl,xc="__reactEvents$"+xl,Lf="__reactListeners$"+xl,Of="__reactHandles$"+xl;function rl(Ar){var nn=Ar[xs];if(nn)return nn;for(var un=Ar.parentNode;un;){if(nn=un[Cs]||un[xs]){if(un=nn.alternate,nn.child!==null||un!==null&&un.child!==null)for(Ar=sh(Ar);Ar!==null;){if(un=Ar[xs])return un;Ar=sh(Ar)}return nn}Ar=un,un=Ar.parentNode}return null}function ql(Ar){return Ar=Ar[xs]||Ar[Cs],!Ar||Ar.tag!==5&&Ar.tag!==6&&Ar.tag!==13&&Ar.tag!==3?null:Ar}function wl(Ar){if(Ar.tag===5||Ar.tag===6)return Ar.stateNode;throw Error(Be(33))}function mu(Ar){return Ar[Wl]||null}var wc=[],Sl=-1;function Ns(Ar){return{current:Ar}}function Yo(Ar){0>Sl||(Ar.current=wc[Sl],wc[Sl]=null,Sl--)}function Wo(Ar,nn){Sl++,wc[Sl]=Ar.current,Ar.current=nn}var zs={},La=Ns(zs),Ha=Ns(!1),nl=zs;function El(Ar,nn){var un=Ar.type.contextTypes;if(!un)return zs;var vn=Ar.stateNode;if(vn&&vn.__reactInternalMemoizedUnmaskedChildContext===nn)return vn.__reactInternalMemoizedMaskedChildContext;var En={},$n;for($n in un)En[$n]=nn[$n];return vn&&(Ar=Ar.stateNode,Ar.__reactInternalMemoizedUnmaskedChildContext=nn,Ar.__reactInternalMemoizedMaskedChildContext=En),En}function Wa(Ar){return Ar=Ar.childContextTypes,Ar!=null}function gu(){Yo(Ha),Yo(La)}function lh(Ar,nn,un){if(La.current!==zs)throw Error(Be(168));Wo(La,nn),Wo(Ha,un)}function uh(Ar,nn,un){var vn=Ar.stateNode;if(nn=nn.childContextTypes,typeof vn.getChildContext!="function")return un;vn=vn.getChildContext();for(var En in vn)if(!(En in nn))throw Error(Be(108,Gn(Ar)||"Unknown",En));return Ln({},un,vn)}function yu(Ar){return Ar=(Ar=Ar.stateNode)&&Ar.__reactInternalMemoizedMergedChildContext||zs,nl=La.current,Wo(La,Ar),Wo(Ha,Ha.current),!0}function ch(Ar,nn,un){var vn=Ar.stateNode;if(!vn)throw Error(Be(169));un?(Ar=uh(Ar,nn,nl),vn.__reactInternalMemoizedMergedChildContext=Ar,Yo(Ha),Yo(La),Wo(La,Ar)):Yo(Ha),Wo(Ha,un)}var $s=null,Au=!1,Sc=!1;function dh(Ar){$s===null?$s=[Ar]:$s.push(Ar)}function Bf(Ar){Au=!0,dh(Ar)}function Us(){if(!Sc&&$s!==null){Sc=!0;var Ar=0,nn=On;try{var un=$s;for(On=1;Ar<un.length;Ar++){var vn=un[Ar];do vn=vn(!0);while(vn!==null)}$s=null,Au=!1}catch(En){throw $s!==null&&($s=$s.slice(Ar+1)),Ho(na,Us),En}finally{On=nn,Sc=!1}}return null}var Ml=[],_l=0,bu=null,xu=0,os=[],as=0,il=null,Ts=1,Ps="";function ol(Ar,nn){Ml[_l++]=xu,Ml[_l++]=bu,bu=Ar,xu=nn}function hh(Ar,nn,un){os[as++]=Ts,os[as++]=Ps,os[as++]=il,il=Ar;var vn=Ts;Ar=Ps;var En=32-Fo(vn)-1;vn&=~(1<<En),un+=1;var $n=32-Fo(nn)+En;if(30<$n){var jn=En-En%5;$n=(vn&(1<<jn)-1).toString(32),vn>>=jn,En-=jn,Ts=1<<32-Fo(nn)+En|un<<En|vn,Ps=$n+Ar}else Ts=1<<$n|un<<En|vn,Ps=Ar}function Ec(Ar){Ar.return!==null&&(ol(Ar,1),hh(Ar,1,0))}function Mc(Ar){for(;Ar===bu;)bu=Ml[--_l],Ml[_l]=null,xu=Ml[--_l],Ml[_l]=null;for(;Ar===il;)il=os[--as],os[as]=null,Ps=os[--as],os[as]=null,Ts=os[--as],os[as]=null}var es=null,ts=null,ra=!1,ps=null;function ph(Ar,nn){var un=cs(5,null,null,0);un.elementType="DELETED",un.stateNode=nn,un.return=Ar,nn=Ar.deletions,nn===null?(Ar.deletions=[un],Ar.flags|=16):nn.push(un)}function fh(Ar,nn){switch(Ar.tag){case 5:var un=Ar.type;return nn=nn.nodeType!==1||un.toLowerCase()!==nn.nodeName.toLowerCase()?null:nn,nn!==null?(Ar.stateNode=nn,es=Ar,ts=Fs(nn.firstChild),!0):!1;case 6:return nn=Ar.pendingProps===""||nn.nodeType!==3?null:nn,nn!==null?(Ar.stateNode=nn,es=Ar,ts=null,!0):!1;case 13:return nn=nn.nodeType!==8?null:nn,nn!==null?(un=il!==null?{id:Ts,overflow:Ps}:null,Ar.memoizedState={dehydrated:nn,treeContext:un,retryLane:1073741824},un=cs(18,null,null,0),un.stateNode=nn,un.return=Ar,Ar.child=un,es=Ar,ts=null,!0):!1;default:return!1}}function _c(Ar){return(Ar.mode&1)!==0&&(Ar.flags&128)===0}function Cc(Ar){if(ra){var nn=ts;if(nn){var un=nn;if(!fh(Ar,nn)){if(_c(Ar))throw Error(Be(418));nn=Fs(un.nextSibling);var vn=es;nn&&fh(Ar,nn)?ph(vn,un):(Ar.flags=Ar.flags&-4097|2,ra=!1,es=Ar)}}else{if(_c(Ar))throw Error(Be(418));Ar.flags=Ar.flags&-4097|2,ra=!1,es=Ar}}}function vh(Ar){for(Ar=Ar.return;Ar!==null&&Ar.tag!==5&&Ar.tag!==3&&Ar.tag!==13;)Ar=Ar.return;es=Ar}function wu(Ar){if(Ar!==es)return!1;if(!ra)return vh(Ar),ra=!0,!1;var nn;if((nn=Ar.tag!==3)&&!(nn=Ar.tag!==5)&&(nn=Ar.type,nn=nn!=="head"&&nn!=="body"&&!yc(Ar.type,Ar.memoizedProps)),nn&&(nn=ts)){if(_c(Ar))throw mh(),Error(Be(418));for(;nn;)ph(Ar,nn),nn=Fs(nn.nextSibling)}if(vh(Ar),Ar.tag===13){if(Ar=Ar.memoizedState,Ar=Ar!==null?Ar.dehydrated:null,!Ar)throw Error(Be(317));e:{for(Ar=Ar.nextSibling,nn=0;Ar;){if(Ar.nodeType===8){var un=Ar.data;if(un==="/$"){if(nn===0){ts=Fs(Ar.nextSibling);break e}nn--}else un!=="$"&&un!=="$!"&&un!=="$?"||nn++}Ar=Ar.nextSibling}ts=null}}else ts=es?Fs(Ar.stateNode.nextSibling):null;return!0}function mh(){for(var Ar=ts;Ar;)Ar=Fs(Ar.nextSibling)}function Cl(){ts=es=null,ra=!1}function $c(Ar){ps===null?ps=[Ar]:ps.push(Ar)}var Df=ln.ReactCurrentBatchConfig;function Ql(Ar,nn,un){if(Ar=un.ref,Ar!==null&&typeof Ar!="function"&&typeof Ar!="object"){if(un._owner){if(un=un._owner,un){if(un.tag!==1)throw Error(Be(309));var vn=un.stateNode}if(!vn)throw Error(Be(147,Ar));var En=vn,$n=""+Ar;return nn!==null&&nn.ref!==null&&typeof nn.ref=="function"&&nn.ref._stringRef===$n?nn.ref:(nn=function(jn){var ii=En.refs;jn===null?delete ii[$n]:ii[$n]=jn},nn._stringRef=$n,nn)}if(typeof Ar!="string")throw Error(Be(284));if(!un._owner)throw Error(Be(290,Ar))}return Ar}function Su(Ar,nn){throw Ar=Object.prototype.toString.call(nn),Error(Be(31,Ar==="[object Object]"?"object with keys {"+Object.keys(nn).join(", ")+"}":Ar))}function gh(Ar){var nn=Ar._init;return nn(Ar._payload)}function yh(Ar){function nn(yi,fi){if(Ar){var bi=yi.deletions;bi===null?(yi.deletions=[fi],yi.flags|=16):bi.push(fi)}}function un(yi,fi){if(!Ar)return null;for(;fi!==null;)nn(yi,fi),fi=fi.sibling;return null}function vn(yi,fi){for(yi=new Map;fi!==null;)fi.key!==null?yi.set(fi.key,fi):yi.set(fi.index,fi),fi=fi.sibling;return yi}function En(yi,fi){return yi=Xs(yi,fi),yi.index=0,yi.sibling=null,yi}function $n(yi,fi,bi){return yi.index=bi,Ar?(bi=yi.alternate,bi!==null?(bi=bi.index,bi<fi?(yi.flags|=2,fi):bi):(yi.flags|=2,fi)):(yi.flags|=1048576,fi)}function jn(yi){return Ar&&yi.alternate===null&&(yi.flags|=2),yi}function ii(yi,fi,bi,Ni){return fi===null||fi.tag!==6?(fi=wd(bi,yi.mode,Ni),fi.return=yi,fi):(fi=En(fi,bi),fi.return=yi,fi)}function di(yi,fi,bi,Ni){var uo=bi.type;return uo===mn?Di(yi,fi,bi.props.children,Ni,bi.key):fi!==null&&(fi.elementType===uo||typeof uo=="object"&&uo!==null&&uo.$$typeof===Cn&&gh(uo)===fi.type)?(Ni=En(fi,bi.props),Ni.ref=Ql(yi,fi,bi),Ni.return=yi,Ni):(Ni=qu(bi.type,bi.key,bi.props,null,yi.mode,Ni),Ni.ref=Ql(yi,fi,bi),Ni.return=yi,Ni)}function Ei(yi,fi,bi,Ni){return fi===null||fi.tag!==4||fi.stateNode.containerInfo!==bi.containerInfo||fi.stateNode.implementation!==bi.implementation?(fi=Sd(bi,yi.mode,Ni),fi.return=yi,fi):(fi=En(fi,bi.children||[]),fi.return=yi,fi)}function Di(yi,fi,bi,Ni,uo){return fi===null||fi.tag!==7?(fi=pl(bi,yi.mode,Ni,uo),fi.return=yi,fi):(fi=En(fi,bi),fi.return=yi,fi)}function Vi(yi,fi,bi){if(typeof fi=="string"&&fi!==""||typeof fi=="number")return fi=wd(""+fi,yi.mode,bi),fi.return=yi,fi;if(typeof fi=="object"&&fi!==null){switch(fi.$$typeof){case cn:return bi=qu(fi.type,fi.key,fi.props,null,yi.mode,bi),bi.ref=Ql(yi,null,fi),bi.return=yi,bi;case hn:return fi=Sd(fi,yi.mode,bi),fi.return=yi,fi;case Cn:var Ni=fi._init;return Vi(yi,Ni(fi._payload),bi)}if(oi(fi)||kn(fi))return fi=pl(fi,yi.mode,bi,null),fi.return=yi,fi;Su(yi,fi)}return null}function Li(yi,fi,bi,Ni){var uo=fi!==null?fi.key:null;if(typeof bi=="string"&&bi!==""||typeof bi=="number")return uo!==null?null:ii(yi,fi,""+bi,Ni);if(typeof bi=="object"&&bi!==null){switch(bi.$$typeof){case cn:return bi.key===uo?di(yi,fi,bi,Ni):null;case hn:return bi.key===uo?Ei(yi,fi,bi,Ni):null;case Cn:return uo=bi._init,Li(yi,fi,uo(bi._payload),Ni)}if(oi(bi)||kn(bi))return uo!==null?null:Di(yi,fi,bi,Ni,null);Su(yi,bi)}return null}function Xi(yi,fi,bi,Ni,uo){if(typeof Ni=="string"&&Ni!==""||typeof Ni=="number")return yi=yi.get(bi)||null,ii(fi,yi,""+Ni,uo);if(typeof Ni=="object"&&Ni!==null){switch(Ni.$$typeof){case cn:return yi=yi.get(Ni.key===null?bi:Ni.key)||null,di(fi,yi,Ni,uo);case hn:return yi=yi.get(Ni.key===null?bi:Ni.key)||null,Ei(fi,yi,Ni,uo);case Cn:var yo=Ni._init;return Xi(yi,fi,bi,yo(Ni._payload),uo)}if(oi(Ni)||kn(Ni))return yi=yi.get(bi)||null,Di(fi,yi,Ni,uo,null);Su(fi,Ni)}return null}function to(yi,fi,bi,Ni){for(var uo=null,yo=null,Ao=fi,So=fi=0,Ma=null;Ao!==null&&So<bi.length;So++){Ao.index>So?(Ma=Ao,Ao=null):Ma=Ao.sibling;var zo=Li(yi,Ao,bi[So],Ni);if(zo===null){Ao===null&&(Ao=Ma);break}Ar&&Ao&&zo.alternate===null&&nn(yi,Ao),fi=$n(zo,fi,So),yo===null?uo=zo:yo.sibling=zo,yo=zo,Ao=Ma}if(So===bi.length)return un(yi,Ao),ra&&ol(yi,So),uo;if(Ao===null){for(;So<bi.length;So++)Ao=Vi(yi,bi[So],Ni),Ao!==null&&(fi=$n(Ao,fi,So),yo===null?uo=Ao:yo.sibling=Ao,yo=Ao);return ra&&ol(yi,So),uo}for(Ao=vn(yi,Ao);So<bi.length;So++)Ma=Xi(Ao,yi,So,bi[So],Ni),Ma!==null&&(Ar&&Ma.alternate!==null&&Ao.delete(Ma.key===null?So:Ma.key),fi=$n(Ma,fi,So),yo===null?uo=Ma:yo.sibling=Ma,yo=Ma);return Ar&&Ao.forEach(function(Ks){return nn(yi,Ks)}),ra&&ol(yi,So),uo}function io(yi,fi,bi,Ni){var uo=kn(bi);if(typeof uo!="function")throw Error(Be(150));if(bi=uo.call(bi),bi==null)throw Error(Be(151));for(var yo=uo=null,Ao=fi,So=fi=0,Ma=null,zo=bi.next();Ao!==null&&!zo.done;So++,zo=bi.next()){Ao.index>So?(Ma=Ao,Ao=null):Ma=Ao.sibling;var Ks=Li(yi,Ao,zo.value,Ni);if(Ks===null){Ao===null&&(Ao=Ma);break}Ar&&Ao&&Ks.alternate===null&&nn(yi,Ao),fi=$n(Ks,fi,So),yo===null?uo=Ks:yo.sibling=Ks,yo=Ks,Ao=Ma}if(zo.done)return un(yi,Ao),ra&&ol(yi,So),uo;if(Ao===null){for(;!zo.done;So++,zo=bi.next())zo=Vi(yi,zo.value,Ni),zo!==null&&(fi=$n(zo,fi,So),yo===null?uo=zo:yo.sibling=zo,yo=zo);return ra&&ol(yi,So),uo}for(Ao=vn(yi,Ao);!zo.done;So++,zo=bi.next())zo=Xi(Ao,yi,So,zo.value,Ni),zo!==null&&(Ar&&zo.alternate!==null&&Ao.delete(zo.key===null?So:zo.key),fi=$n(zo,fi,So),yo===null?uo=zo:yo.sibling=zo,yo=zo);return Ar&&Ao.forEach(function(mv){return nn(yi,mv)}),ra&&ol(yi,So),uo}function fa(yi,fi,bi,Ni){if(typeof bi=="object"&&bi!==null&&bi.type===mn&&bi.key===null&&(bi=bi.props.children),typeof bi=="object"&&bi!==null){switch(bi.$$typeof){case cn:e:{for(var uo=bi.key,yo=fi;yo!==null;){if(yo.key===uo){if(uo=bi.type,uo===mn){if(yo.tag===7){un(yi,yo.sibling),fi=En(yo,bi.props.children),fi.return=yi,yi=fi;break e}}else if(yo.elementType===uo||typeof uo=="object"&&uo!==null&&uo.$$typeof===Cn&&gh(uo)===yo.type){un(yi,yo.sibling),fi=En(yo,bi.props),fi.ref=Ql(yi,yo,bi),fi.return=yi,yi=fi;break e}un(yi,yo);break}else nn(yi,yo);yo=yo.sibling}bi.type===mn?(fi=pl(bi.props.children,yi.mode,Ni,bi.key),fi.return=yi,yi=fi):(Ni=qu(bi.type,bi.key,bi.props,null,yi.mode,Ni),Ni.ref=Ql(yi,fi,bi),Ni.return=yi,yi=Ni)}return jn(yi);case hn:e:{for(yo=bi.key;fi!==null;){if(fi.key===yo)if(fi.tag===4&&fi.stateNode.containerInfo===bi.containerInfo&&fi.stateNode.implementation===bi.implementation){un(yi,fi.sibling),fi=En(fi,bi.children||[]),fi.return=yi,yi=fi;break e}else{un(yi,fi);break}else nn(yi,fi);fi=fi.sibling}fi=Sd(bi,yi.mode,Ni),fi.return=yi,yi=fi}return jn(yi);case Cn:return yo=bi._init,fa(yi,fi,yo(bi._payload),Ni)}if(oi(bi))return to(yi,fi,bi,Ni);if(kn(bi))return io(yi,fi,bi,Ni);Su(yi,bi)}return typeof bi=="string"&&bi!==""||typeof bi=="number"?(bi=""+bi,fi!==null&&fi.tag===6?(un(yi,fi.sibling),fi=En(fi,bi),fi.return=yi,yi=fi):(un(yi,fi),fi=wd(bi,yi.mode,Ni),fi.return=yi,yi=fi),jn(yi)):un(yi,fi)}return fa}var $l=yh(!0),Ah=yh(!1),Eu=Ns(null),Mu=null,Tl=null,Tc=null;function Pc(){Tc=Tl=Mu=null}function Ic(Ar){var nn=Eu.current;Yo(Eu),Ar._currentValue=nn}function Rc(Ar,nn,un){for(;Ar!==null;){var vn=Ar.alternate;if((Ar.childLanes&nn)!==nn?(Ar.childLanes|=nn,vn!==null&&(vn.childLanes|=nn)):vn!==null&&(vn.childLanes&nn)!==nn&&(vn.childLanes|=nn),Ar===un)break;Ar=Ar.return}}function Pl(Ar,nn){Mu=Ar,Tc=Tl=null,Ar=Ar.dependencies,Ar!==null&&Ar.firstContext!==null&&((Ar.lanes&nn)!==0&&(qa=!0),Ar.firstContext=null)}function ss(Ar){var nn=Ar._currentValue;if(Tc!==Ar)if(Ar={context:Ar,memoizedValue:nn,next:null},Tl===null){if(Mu===null)throw Error(Be(308));Tl=Ar,Mu.dependencies={lanes:0,firstContext:Ar}}else Tl=Tl.next=Ar;return nn}var al=null;function Lc(Ar){al===null?al=[Ar]:al.push(Ar)}function bh(Ar,nn,un,vn){var En=nn.interleaved;return En===null?(un.next=un,Lc(nn)):(un.next=En.next,En.next=un),nn.interleaved=un,Is(Ar,vn)}function Is(Ar,nn){Ar.lanes|=nn;var un=Ar.alternate;for(un!==null&&(un.lanes|=nn),un=Ar,Ar=Ar.return;Ar!==null;)Ar.childLanes|=nn,un=Ar.alternate,un!==null&&(un.childLanes|=nn),un=Ar,Ar=Ar.return;return un.tag===3?un.stateNode:null}var js=!1;function Oc(Ar){Ar.updateQueue={baseState:Ar.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xh(Ar,nn){Ar=Ar.updateQueue,nn.updateQueue===Ar&&(nn.updateQueue={baseState:Ar.baseState,firstBaseUpdate:Ar.firstBaseUpdate,lastBaseUpdate:Ar.lastBaseUpdate,shared:Ar.shared,effects:Ar.effects})}function Rs(Ar,nn){return{eventTime:Ar,lane:nn,tag:0,payload:null,callback:null,next:null}}function Gs(Ar,nn,un){var vn=Ar.updateQueue;if(vn===null)return null;if(vn=vn.shared,(Vo&2)!==0){var En=vn.pending;return En===null?nn.next=nn:(nn.next=En.next,En.next=nn),vn.pending=nn,Is(Ar,un)}return En=vn.interleaved,En===null?(nn.next=nn,Lc(vn)):(nn.next=En.next,En.next=nn),vn.interleaved=nn,Is(Ar,un)}function _u(Ar,nn,un){if(nn=nn.updateQueue,nn!==null&&(nn=nn.shared,(un&4194240)!==0)){var vn=nn.lanes;vn&=Ar.pendingLanes,un|=vn,nn.lanes=un,_n(Ar,un)}}function wh(Ar,nn){var un=Ar.updateQueue,vn=Ar.alternate;if(vn!==null&&(vn=vn.updateQueue,un===vn)){var En=null,$n=null;if(un=un.firstBaseUpdate,un!==null){do{var jn={eventTime:un.eventTime,lane:un.lane,tag:un.tag,payload:un.payload,callback:un.callback,next:null};$n===null?En=$n=jn:$n=$n.next=jn,un=un.next}while(un!==null);$n===null?En=$n=nn:$n=$n.next=nn}else En=$n=nn;un={baseState:vn.baseState,firstBaseUpdate:En,lastBaseUpdate:$n,shared:vn.shared,effects:vn.effects},Ar.updateQueue=un;return}Ar=un.lastBaseUpdate,Ar===null?un.firstBaseUpdate=nn:Ar.next=nn,un.lastBaseUpdate=nn}function Cu(Ar,nn,un,vn){var En=Ar.updateQueue;js=!1;var $n=En.firstBaseUpdate,jn=En.lastBaseUpdate,ii=En.shared.pending;if(ii!==null){En.shared.pending=null;var di=ii,Ei=di.next;di.next=null,jn===null?$n=Ei:jn.next=Ei,jn=di;var Di=Ar.alternate;Di!==null&&(Di=Di.updateQueue,ii=Di.lastBaseUpdate,ii!==jn&&(ii===null?Di.firstBaseUpdate=Ei:ii.next=Ei,Di.lastBaseUpdate=di))}if($n!==null){var Vi=En.baseState;jn=0,Di=Ei=di=null,ii=$n;do{var Li=ii.lane,Xi=ii.eventTime;if((vn&Li)===Li){Di!==null&&(Di=Di.next={eventTime:Xi,lane:0,tag:ii.tag,payload:ii.payload,callback:ii.callback,next:null});e:{var to=Ar,io=ii;switch(Li=nn,Xi=un,io.tag){case 1:if(to=io.payload,typeof to=="function"){Vi=to.call(Xi,Vi,Li);break e}Vi=to;break e;case 3:to.flags=to.flags&-65537|128;case 0:if(to=io.payload,Li=typeof to=="function"?to.call(Xi,Vi,Li):to,Li==null)break e;Vi=Ln({},Vi,Li);break e;case 2:js=!0}}ii.callback!==null&&ii.lane!==0&&(Ar.flags|=64,Li=En.effects,Li===null?En.effects=[ii]:Li.push(ii))}else Xi={eventTime:Xi,lane:Li,tag:ii.tag,payload:ii.payload,callback:ii.callback,next:null},Di===null?(Ei=Di=Xi,di=Vi):Di=Di.next=Xi,jn|=Li;if(ii=ii.next,ii===null){if(ii=En.shared.pending,ii===null)break;Li=ii,ii=Li.next,Li.next=null,En.lastBaseUpdate=Li,En.shared.pending=null}}while(!0);if(Di===null&&(di=Vi),En.baseState=di,En.firstBaseUpdate=Ei,En.lastBaseUpdate=Di,nn=En.shared.interleaved,nn!==null){En=nn;do jn|=En.lane,En=En.next;while(En!==nn)}else $n===null&&(En.shared.lanes=0);ul|=jn,Ar.lanes=jn,Ar.memoizedState=Vi}}function Sh(Ar,nn,un){if(Ar=nn.effects,nn.effects=null,Ar!==null)for(nn=0;nn<Ar.length;nn++){var vn=Ar[nn],En=vn.callback;if(En!==null){if(vn.callback=null,vn=un,typeof En!="function")throw Error(Be(191,En));En.call(vn)}}}var Jl={},ws=Ns(Jl),Xl=Ns(Jl),Kl=Ns(Jl);function sl(Ar){if(Ar===Jl)throw Error(Be(174));return Ar}function Bc(Ar,nn){switch(Wo(Kl,nn),Wo(Xl,Ar),Wo(ws,Jl),Ar=nn.nodeType,Ar){case 9:case 11:nn=(nn=nn.documentElement)?nn.namespaceURI:_i(null,"");break;default:Ar=Ar===8?nn.parentNode:nn,nn=Ar.namespaceURI||null,Ar=Ar.tagName,nn=_i(nn,Ar)}Yo(ws),Wo(ws,nn)}function Il(){Yo(ws),Yo(Xl),Yo(Kl)}function Eh(Ar){sl(Kl.current);var nn=sl(ws.current),un=_i(nn,Ar.type);nn!==un&&(Wo(Xl,Ar),Wo(ws,un))}function Dc(Ar){Xl.current===Ar&&(Yo(ws),Yo(Xl))}var oa=Ns(0);function $u(Ar){for(var nn=Ar;nn!==null;){if(nn.tag===13){var un=nn.memoizedState;if(un!==null&&(un=un.dehydrated,un===null||un.data==="$?"||un.data==="$!"))return nn}else if(nn.tag===19&&nn.memoizedProps.revealOrder!==void 0){if((nn.flags&128)!==0)return nn}else if(nn.child!==null){nn.child.return=nn,nn=nn.child;continue}if(nn===Ar)break;for(;nn.sibling===null;){if(nn.return===null||nn.return===Ar)return null;nn=nn.return}nn.sibling.return=nn.return,nn=nn.sibling}return null}var kc=[];function Vc(){for(var Ar=0;Ar<kc.length;Ar++)kc[Ar]._workInProgressVersionPrimary=null;kc.length=0}var Tu=ln.ReactCurrentDispatcher,Fc=ln.ReactCurrentBatchConfig,ll=0,aa=null,ba=null,Sa=null,Pu=!1,Yl=!1,Zl=0,kf=0;function Oa(){throw Error(Be(321))}function Nc(Ar,nn){if(nn===null)return!1;for(var un=0;un<nn.length&&un<Ar.length;un++)if(!hs(Ar[un],nn[un]))return!1;return!0}function zc(Ar,nn,un,vn,En,$n){if(ll=$n,aa=nn,nn.memoizedState=null,nn.updateQueue=null,nn.lanes=0,Tu.current=Ar===null||Ar.memoizedState===null?zf:Uf,Ar=un(vn,En),Yl){$n=0;do{if(Yl=!1,Zl=0,25<=$n)throw Error(Be(301));$n+=1,Sa=ba=null,nn.updateQueue=null,Tu.current=jf,Ar=un(vn,En)}while(Yl)}if(Tu.current=Lu,nn=ba!==null&&ba.next!==null,ll=0,Sa=ba=aa=null,Pu=!1,nn)throw Error(Be(300));return Ar}function Uc(){var Ar=Zl!==0;return Zl=0,Ar}function Ss(){var Ar={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sa===null?aa.memoizedState=Sa=Ar:Sa=Sa.next=Ar,Sa}function ls(){if(ba===null){var Ar=aa.alternate;Ar=Ar!==null?Ar.memoizedState:null}else Ar=ba.next;var nn=Sa===null?aa.memoizedState:Sa.next;if(nn!==null)Sa=nn,ba=Ar;else{if(Ar===null)throw Error(Be(310));ba=Ar,Ar={memoizedState:ba.memoizedState,baseState:ba.baseState,baseQueue:ba.baseQueue,queue:ba.queue,next:null},Sa===null?aa.memoizedState=Sa=Ar:Sa=Sa.next=Ar}return Sa}function eu(Ar,nn){return typeof nn=="function"?nn(Ar):nn}function jc(Ar){var nn=ls(),un=nn.queue;if(un===null)throw Error(Be(311));un.lastRenderedReducer=Ar;var vn=ba,En=vn.baseQueue,$n=un.pending;if($n!==null){if(En!==null){var jn=En.next;En.next=$n.next,$n.next=jn}vn.baseQueue=En=$n,un.pending=null}if(En!==null){$n=En.next,vn=vn.baseState;var ii=jn=null,di=null,Ei=$n;do{var Di=Ei.lane;if((ll&Di)===Di)di!==null&&(di=di.next={lane:0,action:Ei.action,hasEagerState:Ei.hasEagerState,eagerState:Ei.eagerState,next:null}),vn=Ei.hasEagerState?Ei.eagerState:Ar(vn,Ei.action);else{var Vi={lane:Di,action:Ei.action,hasEagerState:Ei.hasEagerState,eagerState:Ei.eagerState,next:null};di===null?(ii=di=Vi,jn=vn):di=di.next=Vi,aa.lanes|=Di,ul|=Di}Ei=Ei.next}while(Ei!==null&&Ei!==$n);di===null?jn=vn:di.next=ii,hs(vn,nn.memoizedState)||(qa=!0),nn.memoizedState=vn,nn.baseState=jn,nn.baseQueue=di,un.lastRenderedState=vn}if(Ar=un.interleaved,Ar!==null){En=Ar;do $n=En.lane,aa.lanes|=$n,ul|=$n,En=En.next;while(En!==Ar)}else En===null&&(un.lanes=0);return[nn.memoizedState,un.dispatch]}function Gc(Ar){var nn=ls(),un=nn.queue;if(un===null)throw Error(Be(311));un.lastRenderedReducer=Ar;var vn=un.dispatch,En=un.pending,$n=nn.memoizedState;if(En!==null){un.pending=null;var jn=En=En.next;do $n=Ar($n,jn.action),jn=jn.next;while(jn!==En);hs($n,nn.memoizedState)||(qa=!0),nn.memoizedState=$n,nn.baseQueue===null&&(nn.baseState=$n),un.lastRenderedState=$n}return[$n,vn]}function Mh(){}function _h(Ar,nn){var un=aa,vn=ls(),En=nn(),$n=!hs(vn.memoizedState,En);if($n&&(vn.memoizedState=En,qa=!0),vn=vn.queue,Hc(Th.bind(null,un,vn,Ar),[Ar]),vn.getSnapshot!==nn||$n||Sa!==null&&Sa.memoizedState.tag&1){if(un.flags|=2048,tu(9,$h.bind(null,un,vn,En,nn),void 0,null),Ea===null)throw Error(Be(349));(ll&30)!==0||Ch(un,nn,En)}return En}function Ch(Ar,nn,un){Ar.flags|=16384,Ar={getSnapshot:nn,value:un},nn=aa.updateQueue,nn===null?(nn={lastEffect:null,stores:null},aa.updateQueue=nn,nn.stores=[Ar]):(un=nn.stores,un===null?nn.stores=[Ar]:un.push(Ar))}function $h(Ar,nn,un,vn){nn.value=un,nn.getSnapshot=vn,Ph(nn)&&Ih(Ar)}function Th(Ar,nn,un){return un(function(){Ph(nn)&&Ih(Ar)})}function Ph(Ar){var nn=Ar.getSnapshot;Ar=Ar.value;try{var un=nn();return!hs(Ar,un)}catch{return!0}}function Ih(Ar){var nn=Is(Ar,1);nn!==null&&gs(nn,Ar,1,-1)}function Rh(Ar){var nn=Ss();return typeof Ar=="function"&&(Ar=Ar()),nn.memoizedState=nn.baseState=Ar,Ar={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eu,lastRenderedState:Ar},nn.queue=Ar,Ar=Ar.dispatch=Nf.bind(null,aa,Ar),[nn.memoizedState,Ar]}function tu(Ar,nn,un,vn){return Ar={tag:Ar,create:nn,destroy:un,deps:vn,next:null},nn=aa.updateQueue,nn===null?(nn={lastEffect:null,stores:null},aa.updateQueue=nn,nn.lastEffect=Ar.next=Ar):(un=nn.lastEffect,un===null?nn.lastEffect=Ar.next=Ar:(vn=un.next,un.next=Ar,Ar.next=vn,nn.lastEffect=Ar)),Ar}function Lh(){return ls().memoizedState}function Iu(Ar,nn,un,vn){var En=Ss();aa.flags|=Ar,En.memoizedState=tu(1|nn,un,void 0,vn===void 0?null:vn)}function Ru(Ar,nn,un,vn){var En=ls();vn=vn===void 0?null:vn;var $n=void 0;if(ba!==null){var jn=ba.memoizedState;if($n=jn.destroy,vn!==null&&Nc(vn,jn.deps)){En.memoizedState=tu(nn,un,$n,vn);return}}aa.flags|=Ar,En.memoizedState=tu(1|nn,un,$n,vn)}function Oh(Ar,nn){return Iu(8390656,8,Ar,nn)}function Hc(Ar,nn){return Ru(2048,8,Ar,nn)}function Bh(Ar,nn){return Ru(4,2,Ar,nn)}function Dh(Ar,nn){return Ru(4,4,Ar,nn)}function kh(Ar,nn){if(typeof nn=="function")return Ar=Ar(),nn(Ar),function(){nn(null)};if(nn!=null)return Ar=Ar(),nn.current=Ar,function(){nn.current=null}}function Vh(Ar,nn,un){return un=un!=null?un.concat([Ar]):null,Ru(4,4,kh.bind(null,nn,Ar),un)}function Wc(){}function Fh(Ar,nn){var un=ls();nn=nn===void 0?null:nn;var vn=un.memoizedState;return vn!==null&&nn!==null&&Nc(nn,vn[1])?vn[0]:(un.memoizedState=[Ar,nn],Ar)}function Nh(Ar,nn){var un=ls();nn=nn===void 0?null:nn;var vn=un.memoizedState;return vn!==null&&nn!==null&&Nc(nn,vn[1])?vn[0]:(Ar=Ar(),un.memoizedState=[Ar,nn],Ar)}function Uh(Ar,nn,un){return(ll&21)===0?(Ar.baseState&&(Ar.baseState=!1,qa=!0),Ar.memoizedState=un):(hs(un,nn)||(un=Ya(),aa.lanes|=un,ul|=un,Ar.baseState=!0),nn)}function Vf(Ar,nn){var un=On;On=un!==0&&4>un?un:4,Ar(!0);var vn=Fc.transition;Fc.transition={};try{Ar(!1),nn()}finally{On=un,Fc.transition=vn}}function jh(){return ls().memoizedState}function Ff(Ar,nn,un){var vn=Qs(Ar);if(un={lane:vn,action:un,hasEagerState:!1,eagerState:null,next:null},Gh(Ar))Hh(nn,un);else if(un=bh(Ar,nn,un,vn),un!==null){var En=Fa();gs(un,Ar,vn,En),Wh(un,nn,vn)}}function Nf(Ar,nn,un){var vn=Qs(Ar),En={lane:vn,action:un,hasEagerState:!1,eagerState:null,next:null};if(Gh(Ar))Hh(nn,En);else{var $n=Ar.alternate;if(Ar.lanes===0&&($n===null||$n.lanes===0)&&($n=nn.lastRenderedReducer,$n!==null))try{var jn=nn.lastRenderedState,ii=$n(jn,un);if(En.hasEagerState=!0,En.eagerState=ii,hs(ii,jn)){var di=nn.interleaved;di===null?(En.next=En,Lc(nn)):(En.next=di.next,di.next=En),nn.interleaved=En;return}}catch{}finally{}un=bh(Ar,nn,En,vn),un!==null&&(En=Fa(),gs(un,Ar,vn,En),Wh(un,nn,vn))}}function Gh(Ar){var nn=Ar.alternate;return Ar===aa||nn!==null&&nn===aa}function Hh(Ar,nn){Yl=Pu=!0;var un=Ar.pending;un===null?nn.next=nn:(nn.next=un.next,un.next=nn),Ar.pending=nn}function Wh(Ar,nn,un){if((un&4194240)!==0){var vn=nn.lanes;vn&=Ar.pendingLanes,un|=vn,nn.lanes=un,_n(Ar,un)}}var Lu={readContext:ss,useCallback:Oa,useContext:Oa,useEffect:Oa,useImperativeHandle:Oa,useInsertionEffect:Oa,useLayoutEffect:Oa,useMemo:Oa,useReducer:Oa,useRef:Oa,useState:Oa,useDebugValue:Oa,useDeferredValue:Oa,useTransition:Oa,useMutableSource:Oa,useSyncExternalStore:Oa,useId:Oa,unstable_isNewReconciler:!1},zf={readContext:ss,useCallback:function(Ar,nn){return Ss().memoizedState=[Ar,nn===void 0?null:nn],Ar},useContext:ss,useEffect:Oh,useImperativeHandle:function(Ar,nn,un){return un=un!=null?un.concat([Ar]):null,Iu(4194308,4,kh.bind(null,nn,Ar),un)},useLayoutEffect:function(Ar,nn){return Iu(4194308,4,Ar,nn)},useInsertionEffect:function(Ar,nn){return Iu(4,2,Ar,nn)},useMemo:function(Ar,nn){var un=Ss();return nn=nn===void 0?null:nn,Ar=Ar(),un.memoizedState=[Ar,nn],Ar},useReducer:function(Ar,nn,un){var vn=Ss();return nn=un!==void 0?un(nn):nn,vn.memoizedState=vn.baseState=nn,Ar={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ar,lastRenderedState:nn},vn.queue=Ar,Ar=Ar.dispatch=Ff.bind(null,aa,Ar),[vn.memoizedState,Ar]},useRef:function(Ar){var nn=Ss();return Ar={current:Ar},nn.memoizedState=Ar},useState:Rh,useDebugValue:Wc,useDeferredValue:function(Ar){return Ss().memoizedState=Ar},useTransition:function(){var Ar=Rh(!1),nn=Ar[0];return Ar=Vf.bind(null,Ar[1]),Ss().memoizedState=Ar,[nn,Ar]},useMutableSource:function(){},useSyncExternalStore:function(Ar,nn,un){var vn=aa,En=Ss();if(ra){if(un===void 0)throw Error(Be(407));un=un()}else{if(un=nn(),Ea===null)throw Error(Be(349));(ll&30)!==0||Ch(vn,nn,un)}En.memoizedState=un;var $n={value:un,getSnapshot:nn};return En.queue=$n,Oh(Th.bind(null,vn,$n,Ar),[Ar]),vn.flags|=2048,tu(9,$h.bind(null,vn,$n,un,nn),void 0,null),un},useId:function(){var Ar=Ss(),nn=Ea.identifierPrefix;if(ra){var un=Ps,vn=Ts;un=(vn&~(1<<32-Fo(vn)-1)).toString(32)+un,nn=":"+nn+"R"+un,un=Zl++,0<un&&(nn+="H"+un.toString(32)),nn+=":"}else un=kf++,nn=":"+nn+"r"+un.toString(32)+":";return Ar.memoizedState=nn},unstable_isNewReconciler:!1},Uf={readContext:ss,useCallback:Fh,useContext:ss,useEffect:Hc,useImperativeHandle:Vh,useInsertionEffect:Bh,useLayoutEffect:Dh,useMemo:Nh,useReducer:jc,useRef:Lh,useState:function(){return jc(eu)},useDebugValue:Wc,useDeferredValue:function(Ar){var nn=ls();return Uh(nn,ba.memoizedState,Ar)},useTransition:function(){var Ar=jc(eu)[0],nn=ls().memoizedState;return[Ar,nn]},useMutableSource:Mh,useSyncExternalStore:_h,useId:jh,unstable_isNewReconciler:!1},jf={readContext:ss,useCallback:Fh,useContext:ss,useEffect:Hc,useImperativeHandle:Vh,useInsertionEffect:Bh,useLayoutEffect:Dh,useMemo:Nh,useReducer:Gc,useRef:Lh,useState:function(){return Gc(eu)},useDebugValue:Wc,useDeferredValue:function(Ar){var nn=ls();return ba===null?nn.memoizedState=Ar:Uh(nn,ba.memoizedState,Ar)},useTransition:function(){var Ar=Gc(eu)[0],nn=ls().memoizedState;return[Ar,nn]},useMutableSource:Mh,useSyncExternalStore:_h,useId:jh,unstable_isNewReconciler:!1};function fs(Ar,nn){if(Ar&&Ar.defaultProps){nn=Ln({},nn),Ar=Ar.defaultProps;for(var un in Ar)nn[un]===void 0&&(nn[un]=Ar[un]);return nn}return nn}function qc(Ar,nn,un,vn){nn=Ar.memoizedState,un=un(vn,nn),un=un==null?nn:Ln({},nn,un),Ar.memoizedState=un,Ar.lanes===0&&(Ar.updateQueue.baseState=un)}var Ou={isMounted:function(Ar){return(Ar=Ar._reactInternals)?eo(Ar)===Ar:!1},enqueueSetState:function(Ar,nn,un){Ar=Ar._reactInternals;var vn=Fa(),En=Qs(Ar),$n=Rs(vn,En);$n.payload=nn,un!=null&&($n.callback=un),nn=Gs(Ar,$n,En),nn!==null&&(gs(nn,Ar,En,vn),_u(nn,Ar,En))},enqueueReplaceState:function(Ar,nn,un){Ar=Ar._reactInternals;var vn=Fa(),En=Qs(Ar),$n=Rs(vn,En);$n.tag=1,$n.payload=nn,un!=null&&($n.callback=un),nn=Gs(Ar,$n,En),nn!==null&&(gs(nn,Ar,En,vn),_u(nn,Ar,En))},enqueueForceUpdate:function(Ar,nn){Ar=Ar._reactInternals;var un=Fa(),vn=Qs(Ar),En=Rs(un,vn);En.tag=2,nn!=null&&(En.callback=nn),nn=Gs(Ar,En,vn),nn!==null&&(gs(nn,Ar,vn,un),_u(nn,Ar,vn))}};function qh(Ar,nn,un,vn,En,$n,jn){return Ar=Ar.stateNode,typeof Ar.shouldComponentUpdate=="function"?Ar.shouldComponentUpdate(vn,$n,jn):nn.prototype&&nn.prototype.isPureReactComponent?!zl(un,vn)||!zl(En,$n):!0}function Qh(Ar,nn,un){var vn=!1,En=zs,$n=nn.contextType;return typeof $n=="object"&&$n!==null?$n=ss($n):(En=Wa(nn)?nl:La.current,vn=nn.contextTypes,$n=(vn=vn!=null)?El(Ar,En):zs),nn=new nn(un,$n),Ar.memoizedState=nn.state!==null&&nn.state!==void 0?nn.state:null,nn.updater=Ou,Ar.stateNode=nn,nn._reactInternals=Ar,vn&&(Ar=Ar.stateNode,Ar.__reactInternalMemoizedUnmaskedChildContext=En,Ar.__reactInternalMemoizedMaskedChildContext=$n),nn}function Jh(Ar,nn,un,vn){Ar=nn.state,typeof nn.componentWillReceiveProps=="function"&&nn.componentWillReceiveProps(un,vn),typeof nn.UNSAFE_componentWillReceiveProps=="function"&&nn.UNSAFE_componentWillReceiveProps(un,vn),nn.state!==Ar&&Ou.enqueueReplaceState(nn,nn.state,null)}function Qc(Ar,nn,un,vn){var En=Ar.stateNode;En.props=un,En.state=Ar.memoizedState,En.refs={},Oc(Ar);var $n=nn.contextType;typeof $n=="object"&&$n!==null?En.context=ss($n):($n=Wa(nn)?nl:La.current,En.context=El(Ar,$n)),En.state=Ar.memoizedState,$n=nn.getDerivedStateFromProps,typeof $n=="function"&&(qc(Ar,nn,$n,un),En.state=Ar.memoizedState),typeof nn.getDerivedStateFromProps=="function"||typeof En.getSnapshotBeforeUpdate=="function"||typeof En.UNSAFE_componentWillMount!="function"&&typeof En.componentWillMount!="function"||(nn=En.state,typeof En.componentWillMount=="function"&&En.componentWillMount(),typeof En.UNSAFE_componentWillMount=="function"&&En.UNSAFE_componentWillMount(),nn!==En.state&&Ou.enqueueReplaceState(En,En.state,null),Cu(Ar,un,En,vn),En.state=Ar.memoizedState),typeof En.componentDidMount=="function"&&(Ar.flags|=4194308)}function Rl(Ar,nn){try{var un="",vn=nn;do un+=Rn(vn),vn=vn.return;while(vn);var En=un}catch($n){En=`
Error generating stack: `+$n.message+`
`+$n.stack}return{value:Ar,source:nn,stack:En,digest:null}}function Jc(Ar,nn,un){return{value:Ar,source:null,stack:un??null,digest:nn??null}}function Xc(Ar,nn){try{console.error(nn.value)}catch(un){setTimeout(function(){throw un})}}var Gf=typeof WeakMap=="function"?WeakMap:Map;function Xh(Ar,nn,un){un=Rs(-1,un),un.tag=3,un.payload={element:null};var vn=nn.value;return un.callback=function(){zu||(zu=!0,pd=vn),Xc(Ar,nn)},un}function Kh(Ar,nn,un){un=Rs(-1,un),un.tag=3;var vn=Ar.type.getDerivedStateFromError;if(typeof vn=="function"){var En=nn.value;un.payload=function(){return vn(En)},un.callback=function(){Xc(Ar,nn)}}var $n=Ar.stateNode;return $n!==null&&typeof $n.componentDidCatch=="function"&&(un.callback=function(){Xc(Ar,nn),typeof vn!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var jn=nn.stack;this.componentDidCatch(nn.value,{componentStack:jn!==null?jn:""})}),un}function Yh(Ar,nn,un){var vn=Ar.pingCache;if(vn===null){vn=Ar.pingCache=new Gf;var En=new Set;vn.set(nn,En)}else En=vn.get(nn),En===void 0&&(En=new Set,vn.set(nn,En));En.has(un)||(En.add(un),Ar=iv.bind(null,Ar,nn,un),nn.then(Ar,Ar))}function Zh(Ar){do{var nn;if((nn=Ar.tag===13)&&(nn=Ar.memoizedState,nn=nn!==null?nn.dehydrated!==null:!0),nn)return Ar;Ar=Ar.return}while(Ar!==null);return null}function ep(Ar,nn,un,vn,En){return(Ar.mode&1)===0?(Ar===nn?Ar.flags|=65536:(Ar.flags|=128,un.flags|=131072,un.flags&=-52805,un.tag===1&&(un.alternate===null?un.tag=17:(nn=Rs(-1,1),nn.tag=2,Gs(un,nn,1))),un.lanes|=1),Ar):(Ar.flags|=65536,Ar.lanes=En,Ar)}var Hf=ln.ReactCurrentOwner,qa=!1;function Va(Ar,nn,un,vn){nn.child=Ar===null?Ah(nn,null,un,vn):$l(nn,Ar.child,un,vn)}function tp(Ar,nn,un,vn,En){un=un.render;var $n=nn.ref;return Pl(nn,En),vn=zc(Ar,nn,un,vn,$n,En),un=Uc(),Ar!==null&&!qa?(nn.updateQueue=Ar.updateQueue,nn.flags&=-2053,Ar.lanes&=~En,Ls(Ar,nn,En)):(ra&&un&&Ec(nn),nn.flags|=1,Va(Ar,nn,vn,En),nn.child)}function rp(Ar,nn,un,vn,En){if(Ar===null){var $n=un.type;return typeof $n=="function"&&!xd($n)&&$n.defaultProps===void 0&&un.compare===null&&un.defaultProps===void 0?(nn.tag=15,nn.type=$n,np(Ar,nn,$n,vn,En)):(Ar=qu(un.type,null,vn,nn,nn.mode,En),Ar.ref=nn.ref,Ar.return=nn,nn.child=Ar)}if($n=Ar.child,(Ar.lanes&En)===0){var jn=$n.memoizedProps;if(un=un.compare,un=un!==null?un:zl,un(jn,vn)&&Ar.ref===nn.ref)return Ls(Ar,nn,En)}return nn.flags|=1,Ar=Xs($n,vn),Ar.ref=nn.ref,Ar.return=nn,nn.child=Ar}function np(Ar,nn,un,vn,En){if(Ar!==null){var $n=Ar.memoizedProps;if(zl($n,vn)&&Ar.ref===nn.ref)if(qa=!1,nn.pendingProps=vn=$n,(Ar.lanes&En)!==0)(Ar.flags&131072)!==0&&(qa=!0);else return nn.lanes=Ar.lanes,Ls(Ar,nn,En)}return Kc(Ar,nn,un,vn,En)}function ip(Ar,nn,un){var vn=nn.pendingProps,En=vn.children,$n=Ar!==null?Ar.memoizedState:null;if(vn.mode==="hidden")if((nn.mode&1)===0)nn.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wo(Ol,rs),rs|=un;else{if((un&1073741824)===0)return Ar=$n!==null?$n.baseLanes|un:un,nn.lanes=nn.childLanes=1073741824,nn.memoizedState={baseLanes:Ar,cachePool:null,transitions:null},nn.updateQueue=null,Wo(Ol,rs),rs|=Ar,null;nn.memoizedState={baseLanes:0,cachePool:null,transitions:null},vn=$n!==null?$n.baseLanes:un,Wo(Ol,rs),rs|=vn}else $n!==null?(vn=$n.baseLanes|un,nn.memoizedState=null):vn=un,Wo(Ol,rs),rs|=vn;return Va(Ar,nn,En,un),nn.child}function op(Ar,nn){var un=nn.ref;(Ar===null&&un!==null||Ar!==null&&Ar.ref!==un)&&(nn.flags|=512,nn.flags|=2097152)}function Kc(Ar,nn,un,vn,En){var $n=Wa(un)?nl:La.current;return $n=El(nn,$n),Pl(nn,En),un=zc(Ar,nn,un,vn,$n,En),vn=Uc(),Ar!==null&&!qa?(nn.updateQueue=Ar.updateQueue,nn.flags&=-2053,Ar.lanes&=~En,Ls(Ar,nn,En)):(ra&&vn&&Ec(nn),nn.flags|=1,Va(Ar,nn,un,En),nn.child)}function ap(Ar,nn,un,vn,En){if(Wa(un)){var $n=!0;yu(nn)}else $n=!1;if(Pl(nn,En),nn.stateNode===null)Du(Ar,nn),Qh(nn,un,vn),Qc(nn,un,vn,En),vn=!0;else if(Ar===null){var jn=nn.stateNode,ii=nn.memoizedProps;jn.props=ii;var di=jn.context,Ei=un.contextType;typeof Ei=="object"&&Ei!==null?Ei=ss(Ei):(Ei=Wa(un)?nl:La.current,Ei=El(nn,Ei));var Di=un.getDerivedStateFromProps,Vi=typeof Di=="function"||typeof jn.getSnapshotBeforeUpdate=="function";Vi||typeof jn.UNSAFE_componentWillReceiveProps!="function"&&typeof jn.componentWillReceiveProps!="function"||(ii!==vn||di!==Ei)&&Jh(nn,jn,vn,Ei),js=!1;var Li=nn.memoizedState;jn.state=Li,Cu(nn,vn,jn,En),di=nn.memoizedState,ii!==vn||Li!==di||Ha.current||js?(typeof Di=="function"&&(qc(nn,un,Di,vn),di=nn.memoizedState),(ii=js||qh(nn,un,ii,vn,Li,di,Ei))?(Vi||typeof jn.UNSAFE_componentWillMount!="function"&&typeof jn.componentWillMount!="function"||(typeof jn.componentWillMount=="function"&&jn.componentWillMount(),typeof jn.UNSAFE_componentWillMount=="function"&&jn.UNSAFE_componentWillMount()),typeof jn.componentDidMount=="function"&&(nn.flags|=4194308)):(typeof jn.componentDidMount=="function"&&(nn.flags|=4194308),nn.memoizedProps=vn,nn.memoizedState=di),jn.props=vn,jn.state=di,jn.context=Ei,vn=ii):(typeof jn.componentDidMount=="function"&&(nn.flags|=4194308),vn=!1)}else{jn=nn.stateNode,xh(Ar,nn),ii=nn.memoizedProps,Ei=nn.type===nn.elementType?ii:fs(nn.type,ii),jn.props=Ei,Vi=nn.pendingProps,Li=jn.context,di=un.contextType,typeof di=="object"&&di!==null?di=ss(di):(di=Wa(un)?nl:La.current,di=El(nn,di));var Xi=un.getDerivedStateFromProps;(Di=typeof Xi=="function"||typeof jn.getSnapshotBeforeUpdate=="function")||typeof jn.UNSAFE_componentWillReceiveProps!="function"&&typeof jn.componentWillReceiveProps!="function"||(ii!==Vi||Li!==di)&&Jh(nn,jn,vn,di),js=!1,Li=nn.memoizedState,jn.state=Li,Cu(nn,vn,jn,En);var to=nn.memoizedState;ii!==Vi||Li!==to||Ha.current||js?(typeof Xi=="function"&&(qc(nn,un,Xi,vn),to=nn.memoizedState),(Ei=js||qh(nn,un,Ei,vn,Li,to,di)||!1)?(Di||typeof jn.UNSAFE_componentWillUpdate!="function"&&typeof jn.componentWillUpdate!="function"||(typeof jn.componentWillUpdate=="function"&&jn.componentWillUpdate(vn,to,di),typeof jn.UNSAFE_componentWillUpdate=="function"&&jn.UNSAFE_componentWillUpdate(vn,to,di)),typeof jn.componentDidUpdate=="function"&&(nn.flags|=4),typeof jn.getSnapshotBeforeUpdate=="function"&&(nn.flags|=1024)):(typeof jn.componentDidUpdate!="function"||ii===Ar.memoizedProps&&Li===Ar.memoizedState||(nn.flags|=4),typeof jn.getSnapshotBeforeUpdate!="function"||ii===Ar.memoizedProps&&Li===Ar.memoizedState||(nn.flags|=1024),nn.memoizedProps=vn,nn.memoizedState=to),jn.props=vn,jn.state=to,jn.context=di,vn=Ei):(typeof jn.componentDidUpdate!="function"||ii===Ar.memoizedProps&&Li===Ar.memoizedState||(nn.flags|=4),typeof jn.getSnapshotBeforeUpdate!="function"||ii===Ar.memoizedProps&&Li===Ar.memoizedState||(nn.flags|=1024),vn=!1)}return Yc(Ar,nn,un,vn,$n,En)}function Yc(Ar,nn,un,vn,En,$n){op(Ar,nn);var jn=(nn.flags&128)!==0;if(!vn&&!jn)return En&&ch(nn,un,!1),Ls(Ar,nn,$n);vn=nn.stateNode,Hf.current=nn;var ii=jn&&typeof un.getDerivedStateFromError!="function"?null:vn.render();return nn.flags|=1,Ar!==null&&jn?(nn.child=$l(nn,Ar.child,null,$n),nn.child=$l(nn,null,ii,$n)):Va(Ar,nn,ii,$n),nn.memoizedState=vn.state,En&&ch(nn,un,!0),nn.child}function sp(Ar){var nn=Ar.stateNode;nn.pendingContext?lh(Ar,nn.pendingContext,nn.pendingContext!==nn.context):nn.context&&lh(Ar,nn.context,!1),Bc(Ar,nn.containerInfo)}function lp(Ar,nn,un,vn,En){return Cl(),$c(En),nn.flags|=256,Va(Ar,nn,un,vn),nn.child}var Zc={dehydrated:null,treeContext:null,retryLane:0};function ed(Ar){return{baseLanes:Ar,cachePool:null,transitions:null}}function up(Ar,nn,un){var vn=nn.pendingProps,En=oa.current,$n=!1,jn=(nn.flags&128)!==0,ii;if((ii=jn)||(ii=Ar!==null&&Ar.memoizedState===null?!1:(En&2)!==0),ii?($n=!0,nn.flags&=-129):(Ar===null||Ar.memoizedState!==null)&&(En|=1),Wo(oa,En&1),Ar===null)return Cc(nn),Ar=nn.memoizedState,Ar!==null&&(Ar=Ar.dehydrated,Ar!==null)?((nn.mode&1)===0?nn.lanes=1:Ar.data==="$!"?nn.lanes=8:nn.lanes=1073741824,null):(jn=vn.children,Ar=vn.fallback,$n?(vn=nn.mode,$n=nn.child,jn={mode:"hidden",children:jn},(vn&1)===0&&$n!==null?($n.childLanes=0,$n.pendingProps=jn):$n=Qu(jn,vn,0,null),Ar=pl(Ar,vn,un,null),$n.return=nn,Ar.return=nn,$n.sibling=Ar,nn.child=$n,nn.child.memoizedState=ed(un),nn.memoizedState=Zc,Ar):rd(nn,jn));if(En=Ar.memoizedState,En!==null&&(ii=En.dehydrated,ii!==null))return Wf(Ar,nn,jn,vn,ii,En,un);if($n){$n=vn.fallback,jn=nn.mode,En=Ar.child,ii=En.sibling;var di={mode:"hidden",children:vn.children};return(jn&1)===0&&nn.child!==En?(vn=nn.child,vn.childLanes=0,vn.pendingProps=di,nn.deletions=null):(vn=Xs(En,di),vn.subtreeFlags=En.subtreeFlags&14680064),ii!==null?$n=Xs(ii,$n):($n=pl($n,jn,un,null),$n.flags|=2),$n.return=nn,vn.return=nn,vn.sibling=$n,nn.child=vn,vn=$n,$n=nn.child,jn=Ar.child.memoizedState,jn=jn===null?ed(un):{baseLanes:jn.baseLanes|un,cachePool:null,transitions:jn.transitions},$n.memoizedState=jn,$n.childLanes=Ar.childLanes&~un,nn.memoizedState=Zc,vn}return $n=Ar.child,Ar=$n.sibling,vn=Xs($n,{mode:"visible",children:vn.children}),(nn.mode&1)===0&&(vn.lanes=un),vn.return=nn,vn.sibling=null,Ar!==null&&(un=nn.deletions,un===null?(nn.deletions=[Ar],nn.flags|=16):un.push(Ar)),nn.child=vn,nn.memoizedState=null,vn}function rd(Ar,nn){return nn=Qu({mode:"visible",children:nn},Ar.mode,0,null),nn.return=Ar,Ar.child=nn}function Bu(Ar,nn,un,vn){return vn!==null&&$c(vn),$l(nn,Ar.child,null,un),Ar=rd(nn,nn.pendingProps.children),Ar.flags|=2,nn.memoizedState=null,Ar}function Wf(Ar,nn,un,vn,En,$n,jn){if(un)return nn.flags&256?(nn.flags&=-257,vn=Jc(Error(Be(422))),Bu(Ar,nn,jn,vn)):nn.memoizedState!==null?(nn.child=Ar.child,nn.flags|=128,null):($n=vn.fallback,En=nn.mode,vn=Qu({mode:"visible",children:vn.children},En,0,null),$n=pl($n,En,jn,null),$n.flags|=2,vn.return=nn,$n.return=nn,vn.sibling=$n,nn.child=vn,(nn.mode&1)!==0&&$l(nn,Ar.child,null,jn),nn.child.memoizedState=ed(jn),nn.memoizedState=Zc,$n);if((nn.mode&1)===0)return Bu(Ar,nn,jn,null);if(En.data==="$!"){if(vn=En.nextSibling&&En.nextSibling.dataset,vn)var ii=vn.dgst;return vn=ii,$n=Error(Be(419)),vn=Jc($n,vn,void 0),Bu(Ar,nn,jn,vn)}if(ii=(jn&Ar.childLanes)!==0,qa||ii){if(vn=Ea,vn!==null){switch(jn&-jn){case 4:En=2;break;case 16:En=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:En=32;break;case 536870912:En=268435456;break;default:En=0}En=(En&(vn.suspendedLanes|jn))!==0?0:En,En!==0&&En!==$n.retryLane&&($n.retryLane=En,Is(Ar,En),gs(vn,Ar,En,-1))}return bd(),vn=Jc(Error(Be(421))),Bu(Ar,nn,jn,vn)}return En.data==="$?"?(nn.flags|=128,nn.child=Ar.child,nn=ov.bind(null,Ar),En._reactRetry=nn,null):(Ar=$n.treeContext,ts=Fs(En.nextSibling),es=nn,ra=!0,ps=null,Ar!==null&&(os[as++]=Ts,os[as++]=Ps,os[as++]=il,Ts=Ar.id,Ps=Ar.overflow,il=nn),nn=rd(nn,vn.children),nn.flags|=4096,nn)}function cp(Ar,nn,un){Ar.lanes|=nn;var vn=Ar.alternate;vn!==null&&(vn.lanes|=nn),Rc(Ar.return,nn,un)}function nd(Ar,nn,un,vn,En){var $n=Ar.memoizedState;$n===null?Ar.memoizedState={isBackwards:nn,rendering:null,renderingStartTime:0,last:vn,tail:un,tailMode:En}:($n.isBackwards=nn,$n.rendering=null,$n.renderingStartTime=0,$n.last=vn,$n.tail=un,$n.tailMode=En)}function dp(Ar,nn,un){var vn=nn.pendingProps,En=vn.revealOrder,$n=vn.tail;if(Va(Ar,nn,vn.children,un),vn=oa.current,(vn&2)!==0)vn=vn&1|2,nn.flags|=128;else{if(Ar!==null&&(Ar.flags&128)!==0)e:for(Ar=nn.child;Ar!==null;){if(Ar.tag===13)Ar.memoizedState!==null&&cp(Ar,un,nn);else if(Ar.tag===19)cp(Ar,un,nn);else if(Ar.child!==null){Ar.child.return=Ar,Ar=Ar.child;continue}if(Ar===nn)break e;for(;Ar.sibling===null;){if(Ar.return===null||Ar.return===nn)break e;Ar=Ar.return}Ar.sibling.return=Ar.return,Ar=Ar.sibling}vn&=1}if(Wo(oa,vn),(nn.mode&1)===0)nn.memoizedState=null;else switch(En){case"forwards":for(un=nn.child,En=null;un!==null;)Ar=un.alternate,Ar!==null&&$u(Ar)===null&&(En=un),un=un.sibling;un=En,un===null?(En=nn.child,nn.child=null):(En=un.sibling,un.sibling=null),nd(nn,!1,En,un,$n);break;case"backwards":for(un=null,En=nn.child,nn.child=null;En!==null;){if(Ar=En.alternate,Ar!==null&&$u(Ar)===null){nn.child=En;break}Ar=En.sibling,En.sibling=un,un=En,En=Ar}nd(nn,!0,un,null,$n);break;case"together":nd(nn,!1,null,null,void 0);break;default:nn.memoizedState=null}return nn.child}function Du(Ar,nn){(nn.mode&1)===0&&Ar!==null&&(Ar.alternate=null,nn.alternate=null,nn.flags|=2)}function Ls(Ar,nn,un){if(Ar!==null&&(nn.dependencies=Ar.dependencies),ul|=nn.lanes,(un&nn.childLanes)===0)return null;if(Ar!==null&&nn.child!==Ar.child)throw Error(Be(153));if(nn.child!==null){for(Ar=nn.child,un=Xs(Ar,Ar.pendingProps),nn.child=un,un.return=nn;Ar.sibling!==null;)Ar=Ar.sibling,un=un.sibling=Xs(Ar,Ar.pendingProps),un.return=nn;un.sibling=null}return nn.child}function qf(Ar,nn,un){switch(nn.tag){case 3:sp(nn),Cl();break;case 5:Eh(nn);break;case 1:Wa(nn.type)&&yu(nn);break;case 4:Bc(nn,nn.stateNode.containerInfo);break;case 10:var vn=nn.type._context,En=nn.memoizedProps.value;Wo(Eu,vn._currentValue),vn._currentValue=En;break;case 13:if(vn=nn.memoizedState,vn!==null)return vn.dehydrated!==null?(Wo(oa,oa.current&1),nn.flags|=128,null):(un&nn.child.childLanes)!==0?up(Ar,nn,un):(Wo(oa,oa.current&1),Ar=Ls(Ar,nn,un),Ar!==null?Ar.sibling:null);Wo(oa,oa.current&1);break;case 19:if(vn=(un&nn.childLanes)!==0,(Ar.flags&128)!==0){if(vn)return dp(Ar,nn,un);nn.flags|=128}if(En=nn.memoizedState,En!==null&&(En.rendering=null,En.tail=null,En.lastEffect=null),Wo(oa,oa.current),vn)break;return null;case 22:case 23:return nn.lanes=0,ip(Ar,nn,un)}return Ls(Ar,nn,un)}var hp,od,pp,fp;hp=function(Ar,nn){for(var un=nn.child;un!==null;){if(un.tag===5||un.tag===6)Ar.appendChild(un.stateNode);else if(un.tag!==4&&un.child!==null){un.child.return=un,un=un.child;continue}if(un===nn)break;for(;un.sibling===null;){if(un.return===null||un.return===nn)return;un=un.return}un.sibling.return=un.return,un=un.sibling}},od=function(){},pp=function(Ar,nn,un,vn){var En=Ar.memoizedProps;if(En!==vn){Ar=nn.stateNode,sl(ws.current);var $n=null;switch(un){case"input":En=si(Ar,En),vn=si(Ar,vn),$n=[];break;case"select":En=Ln({},En,{value:void 0}),vn=Ln({},vn,{value:void 0}),$n=[];break;case"textarea":En=ai(Ar,En),vn=ai(Ar,vn),$n=[];break;default:typeof En.onClick!="function"&&typeof vn.onClick=="function"&&(Ar.onclick=vu)}Ui(un,vn);var jn;un=null;for(Ei in En)if(!vn.hasOwnProperty(Ei)&&En.hasOwnProperty(Ei)&&En[Ei]!=null)if(Ei==="style"){var ii=En[Ei];for(jn in ii)ii.hasOwnProperty(jn)&&(un||(un={}),un[jn]="")}else Ei!=="dangerouslySetInnerHTML"&&Ei!=="children"&&Ei!=="suppressContentEditableWarning"&&Ei!=="suppressHydrationWarning"&&Ei!=="autoFocus"&&(Ve.hasOwnProperty(Ei)?$n||($n=[]):($n=$n||[]).push(Ei,null));for(Ei in vn){var di=vn[Ei];if(ii=En?.[Ei],vn.hasOwnProperty(Ei)&&di!==ii&&(di!=null||ii!=null))if(Ei==="style")if(ii){for(jn in ii)!ii.hasOwnProperty(jn)||di&&di.hasOwnProperty(jn)||(un||(un={}),un[jn]="");for(jn in di)di.hasOwnProperty(jn)&&ii[jn]!==di[jn]&&(un||(un={}),un[jn]=di[jn])}else un||($n||($n=[]),$n.push(Ei,un)),un=di;else Ei==="dangerouslySetInnerHTML"?(di=di?di.__html:void 0,ii=ii?ii.__html:void 0,di!=null&&ii!==di&&($n=$n||[]).push(Ei,di)):Ei==="children"?typeof di!="string"&&typeof di!="number"||($n=$n||[]).push(Ei,""+di):Ei!=="suppressContentEditableWarning"&&Ei!=="suppressHydrationWarning"&&(Ve.hasOwnProperty(Ei)?(di!=null&&Ei==="onScroll"&&Ko("scroll",Ar),$n||ii===di||($n=[])):($n=$n||[]).push(Ei,di))}un&&($n=$n||[]).push("style",un);var Ei=$n;(nn.updateQueue=Ei)&&(nn.flags|=4)}},fp=function(Ar,nn,un,vn){un!==vn&&(nn.flags|=4)};function ru(Ar,nn){if(!ra)switch(Ar.tailMode){case"hidden":nn=Ar.tail;for(var un=null;nn!==null;)nn.alternate!==null&&(un=nn),nn=nn.sibling;un===null?Ar.tail=null:un.sibling=null;break;case"collapsed":un=Ar.tail;for(var vn=null;un!==null;)un.alternate!==null&&(vn=un),un=un.sibling;vn===null?nn||Ar.tail===null?Ar.tail=null:Ar.tail.sibling=null:vn.sibling=null}}function Ba(Ar){var nn=Ar.alternate!==null&&Ar.alternate.child===Ar.child,un=0,vn=0;if(nn)for(var En=Ar.child;En!==null;)un|=En.lanes|En.childLanes,vn|=En.subtreeFlags&14680064,vn|=En.flags&14680064,En.return=Ar,En=En.sibling;else for(En=Ar.child;En!==null;)un|=En.lanes|En.childLanes,vn|=En.subtreeFlags,vn|=En.flags,En.return=Ar,En=En.sibling;return Ar.subtreeFlags|=vn,Ar.childLanes=un,nn}function Qf(Ar,nn,un){var vn=nn.pendingProps;switch(Mc(nn),nn.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ba(nn),null;case 1:return Wa(nn.type)&&gu(),Ba(nn),null;case 3:return vn=nn.stateNode,Il(),Yo(Ha),Yo(La),Vc(),vn.pendingContext&&(vn.context=vn.pendingContext,vn.pendingContext=null),(Ar===null||Ar.child===null)&&(wu(nn)?nn.flags|=4:Ar===null||Ar.memoizedState.isDehydrated&&(nn.flags&256)===0||(nn.flags|=1024,ps!==null&&(gd(ps),ps=null))),od(Ar,nn),Ba(nn),null;case 5:Dc(nn);var En=sl(Kl.current);if(un=nn.type,Ar!==null&&nn.stateNode!=null)pp(Ar,nn,un,vn,En),Ar.ref!==nn.ref&&(nn.flags|=512,nn.flags|=2097152);else{if(!vn){if(nn.stateNode===null)throw Error(Be(166));return Ba(nn),null}if(Ar=sl(ws.current),wu(nn)){vn=nn.stateNode,un=nn.type;var $n=nn.memoizedProps;switch(vn[xs]=nn,vn[Wl]=$n,Ar=(nn.mode&1)!==0,un){case"dialog":Ko("cancel",vn),Ko("close",vn);break;case"iframe":case"object":case"embed":Ko("load",vn);break;case"video":case"audio":for(En=0;En<jl.length;En++)Ko(jl[En],vn);break;case"source":Ko("error",vn);break;case"img":case"image":case"link":Ko("error",vn),Ko("load",vn);break;case"details":Ko("toggle",vn);break;case"input":ei(vn,$n),Ko("invalid",vn);break;case"select":vn._wrapperState={wasMultiple:!!$n.multiple},Ko("invalid",vn);break;case"textarea":wi(vn,$n),Ko("invalid",vn)}Ui(un,$n),En=null;for(var jn in $n)if($n.hasOwnProperty(jn)){var ii=$n[jn];jn==="children"?typeof ii=="string"?vn.textContent!==ii&&($n.suppressHydrationWarning!==!0&&fu(vn.textContent,ii,Ar),En=["children",ii]):typeof ii=="number"&&vn.textContent!==""+ii&&($n.suppressHydrationWarning!==!0&&fu(vn.textContent,ii,Ar),En=["children",""+ii]):Ve.hasOwnProperty(jn)&&ii!=null&&jn==="onScroll"&&Ko("scroll",vn)}switch(un){case"input":zn(vn),Wn(vn,$n,!0);break;case"textarea":zn(vn),Oi(vn);break;case"select":case"option":break;default:typeof $n.onClick=="function"&&(vn.onclick=vu)}vn=En,nn.updateQueue=vn,vn!==null&&(nn.flags|=4)}else{jn=En.nodeType===9?En:En.ownerDocument,Ar==="http://www.w3.org/1999/xhtml"&&(Ar=Ri(un)),Ar==="http://www.w3.org/1999/xhtml"?un==="script"?(Ar=jn.createElement("div"),Ar.innerHTML="<script><\/script>",Ar=Ar.removeChild(Ar.firstChild)):typeof vn.is=="string"?Ar=jn.createElement(un,{is:vn.is}):(Ar=jn.createElement(un),un==="select"&&(jn=Ar,vn.multiple?jn.multiple=!0:vn.size&&(jn.size=vn.size))):Ar=jn.createElementNS(Ar,un),Ar[xs]=nn,Ar[Wl]=vn,hp(Ar,nn,!1,!1),nn.stateNode=Ar;e:{switch(jn=ho(un,vn),un){case"dialog":Ko("cancel",Ar),Ko("close",Ar),En=vn;break;case"iframe":case"object":case"embed":Ko("load",Ar),En=vn;break;case"video":case"audio":for(En=0;En<jl.length;En++)Ko(jl[En],Ar);En=vn;break;case"source":Ko("error",Ar),En=vn;break;case"img":case"image":case"link":Ko("error",Ar),Ko("load",Ar),En=vn;break;case"details":Ko("toggle",Ar),En=vn;break;case"input":ei(Ar,vn),En=si(Ar,vn),Ko("invalid",Ar);break;case"option":En=vn;break;case"select":Ar._wrapperState={wasMultiple:!!vn.multiple},En=Ln({},vn,{value:void 0}),Ko("invalid",Ar);break;case"textarea":wi(Ar,vn),En=ai(Ar,vn),Ko("invalid",Ar);break;default:En=vn}Ui(un,En),ii=En;for($n in ii)if(ii.hasOwnProperty($n)){var di=ii[$n];$n==="style"?qi(Ar,di):$n==="dangerouslySetInnerHTML"?(di=di?di.__html:void 0,di!=null&&$i(Ar,di)):$n==="children"?typeof di=="string"?(un!=="textarea"||di!=="")&&vi(Ar,di):typeof di=="number"&&vi(Ar,""+di):$n!=="suppressContentEditableWarning"&&$n!=="suppressHydrationWarning"&&$n!=="autoFocus"&&(Ve.hasOwnProperty($n)?di!=null&&$n==="onScroll"&&Ko("scroll",Ar):di!=null&&sn(Ar,$n,di,jn))}switch(un){case"input":zn(Ar),Wn(Ar,vn,!1);break;case"textarea":zn(Ar),Oi(Ar);break;case"option":vn.value!=null&&Ar.setAttribute("value",""+Fn(vn.value));break;case"select":Ar.multiple=!!vn.multiple,$n=vn.value,$n!=null?ci(Ar,!!vn.multiple,$n,!1):vn.defaultValue!=null&&ci(Ar,!!vn.multiple,vn.defaultValue,!0);break;default:typeof En.onClick=="function"&&(Ar.onclick=vu)}switch(un){case"button":case"input":case"select":case"textarea":vn=!!vn.autoFocus;break e;case"img":vn=!0;break e;default:vn=!1}}vn&&(nn.flags|=4)}nn.ref!==null&&(nn.flags|=512,nn.flags|=2097152)}return Ba(nn),null;case 6:if(Ar&&nn.stateNode!=null)fp(Ar,nn,Ar.memoizedProps,vn);else{if(typeof vn!="string"&&nn.stateNode===null)throw Error(Be(166));if(un=sl(Kl.current),sl(ws.current),wu(nn)){if(vn=nn.stateNode,un=nn.memoizedProps,vn[xs]=nn,($n=vn.nodeValue!==un)&&(Ar=es,Ar!==null))switch(Ar.tag){case 3:fu(vn.nodeValue,un,(Ar.mode&1)!==0);break;case 5:Ar.memoizedProps.suppressHydrationWarning!==!0&&fu(vn.nodeValue,un,(Ar.mode&1)!==0)}$n&&(nn.flags|=4)}else vn=(un.nodeType===9?un:un.ownerDocument).createTextNode(vn),vn[xs]=nn,nn.stateNode=vn}return Ba(nn),null;case 13:if(Yo(oa),vn=nn.memoizedState,Ar===null||Ar.memoizedState!==null&&Ar.memoizedState.dehydrated!==null){if(ra&&ts!==null&&(nn.mode&1)!==0&&(nn.flags&128)===0)mh(),Cl(),nn.flags|=98560,$n=!1;else if($n=wu(nn),vn!==null&&vn.dehydrated!==null){if(Ar===null){if(!$n)throw Error(Be(318));if($n=nn.memoizedState,$n=$n!==null?$n.dehydrated:null,!$n)throw Error(Be(317));$n[xs]=nn}else Cl(),(nn.flags&128)===0&&(nn.memoizedState=null),nn.flags|=4;Ba(nn),$n=!1}else ps!==null&&(gd(ps),ps=null),$n=!0;if(!$n)return nn.flags&65536?nn:null}return(nn.flags&128)!==0?(nn.lanes=un,nn):(vn=vn!==null,vn!==(Ar!==null&&Ar.memoizedState!==null)&&vn&&(nn.child.flags|=8192,(nn.mode&1)!==0&&(Ar===null||(oa.current&1)!==0?xa===0&&(xa=3):bd())),nn.updateQueue!==null&&(nn.flags|=4),Ba(nn),null);case 4:return Il(),od(Ar,nn),Ar===null&&Gl(nn.stateNode.containerInfo),Ba(nn),null;case 10:return Ic(nn.type._context),Ba(nn),null;case 17:return Wa(nn.type)&&gu(),Ba(nn),null;case 19:if(Yo(oa),$n=nn.memoizedState,$n===null)return Ba(nn),null;if(vn=(nn.flags&128)!==0,jn=$n.rendering,jn===null)if(vn)ru($n,!1);else{if(xa!==0||Ar!==null&&(Ar.flags&128)!==0)for(Ar=nn.child;Ar!==null;){if(jn=$u(Ar),jn!==null){for(nn.flags|=128,ru($n,!1),vn=jn.updateQueue,vn!==null&&(nn.updateQueue=vn,nn.flags|=4),nn.subtreeFlags=0,vn=un,un=nn.child;un!==null;)$n=un,Ar=vn,$n.flags&=14680066,jn=$n.alternate,jn===null?($n.childLanes=0,$n.lanes=Ar,$n.child=null,$n.subtreeFlags=0,$n.memoizedProps=null,$n.memoizedState=null,$n.updateQueue=null,$n.dependencies=null,$n.stateNode=null):($n.childLanes=jn.childLanes,$n.lanes=jn.lanes,$n.child=jn.child,$n.subtreeFlags=0,$n.deletions=null,$n.memoizedProps=jn.memoizedProps,$n.memoizedState=jn.memoizedState,$n.updateQueue=jn.updateQueue,$n.type=jn.type,Ar=jn.dependencies,$n.dependencies=Ar===null?null:{lanes:Ar.lanes,firstContext:Ar.firstContext}),un=un.sibling;return Wo(oa,oa.current&1|2),nn.child}Ar=Ar.sibling}$n.tail!==null&&$o()>Bl&&(nn.flags|=128,vn=!0,ru($n,!1),nn.lanes=4194304)}else{if(!vn)if(Ar=$u(jn),Ar!==null){if(nn.flags|=128,vn=!0,un=Ar.updateQueue,un!==null&&(nn.updateQueue=un,nn.flags|=4),ru($n,!0),$n.tail===null&&$n.tailMode==="hidden"&&!jn.alternate&&!ra)return Ba(nn),null}else 2*$o()-$n.renderingStartTime>Bl&&un!==1073741824&&(nn.flags|=128,vn=!0,ru($n,!1),nn.lanes=4194304);$n.isBackwards?(jn.sibling=nn.child,nn.child=jn):(un=$n.last,un!==null?un.sibling=jn:nn.child=jn,$n.last=jn)}return $n.tail!==null?(nn=$n.tail,$n.rendering=nn,$n.tail=nn.sibling,$n.renderingStartTime=$o(),nn.sibling=null,un=oa.current,Wo(oa,vn?un&1|2:un&1),nn):(Ba(nn),null);case 22:case 23:return Ad(),vn=nn.memoizedState!==null,Ar!==null&&Ar.memoizedState!==null!==vn&&(nn.flags|=8192),vn&&(nn.mode&1)!==0?(rs&1073741824)!==0&&(Ba(nn),nn.subtreeFlags&6&&(nn.flags|=8192)):Ba(nn),null;case 24:return null;case 25:return null}throw Error(Be(156,nn.tag))}function Jf(Ar,nn){switch(Mc(nn),nn.tag){case 1:return Wa(nn.type)&&gu(),Ar=nn.flags,Ar&65536?(nn.flags=Ar&-65537|128,nn):null;case 3:return Il(),Yo(Ha),Yo(La),Vc(),Ar=nn.flags,(Ar&65536)!==0&&(Ar&128)===0?(nn.flags=Ar&-65537|128,nn):null;case 5:return Dc(nn),null;case 13:if(Yo(oa),Ar=nn.memoizedState,Ar!==null&&Ar.dehydrated!==null){if(nn.alternate===null)throw Error(Be(340));Cl()}return Ar=nn.flags,Ar&65536?(nn.flags=Ar&-65537|128,nn):null;case 19:return Yo(oa),null;case 4:return Il(),null;case 10:return Ic(nn.type._context),null;case 22:case 23:return Ad(),null;case 24:return null;default:return null}}var ku=!1,Da=!1,Xf=typeof WeakSet=="function"?WeakSet:Set,Zi=null;function Ll(Ar,nn){var un=Ar.ref;if(un!==null)if(typeof un=="function")try{un(null)}catch(vn){ca(Ar,nn,vn)}else un.current=null}function ad(Ar,nn,un){try{un()}catch(vn){ca(Ar,nn,vn)}}var vp=!1;function Kf(Ar,nn){if(mc=qn,Ar=Wd(),lc(Ar)){if("selectionStart"in Ar)var un={start:Ar.selectionStart,end:Ar.selectionEnd};else e:{un=(un=Ar.ownerDocument)&&un.defaultView||window;var vn=un.getSelection&&un.getSelection();if(vn&&vn.rangeCount!==0){un=vn.anchorNode;var En=vn.anchorOffset,$n=vn.focusNode;vn=vn.focusOffset;try{un.nodeType,$n.nodeType}catch{un=null;break e}var jn=0,ii=-1,di=-1,Ei=0,Di=0,Vi=Ar,Li=null;t:for(;;){for(var Xi;Vi!==un||En!==0&&Vi.nodeType!==3||(ii=jn+En),Vi!==$n||vn!==0&&Vi.nodeType!==3||(di=jn+vn),Vi.nodeType===3&&(jn+=Vi.nodeValue.length),(Xi=Vi.firstChild)!==null;)Li=Vi,Vi=Xi;for(;;){if(Vi===Ar)break t;if(Li===un&&++Ei===En&&(ii=jn),Li===$n&&++Di===vn&&(di=jn),(Xi=Vi.nextSibling)!==null)break;Vi=Li,Li=Vi.parentNode}Vi=Xi}un=ii===-1||di===-1?null:{start:ii,end:di}}else un=null}un=un||{start:0,end:0}}else un=null;for(gc={focusedElem:Ar,selectionRange:un},qn=!1,Zi=nn;Zi!==null;)if(nn=Zi,Ar=nn.child,(nn.subtreeFlags&1028)!==0&&Ar!==null)Ar.return=nn,Zi=Ar;else for(;Zi!==null;){nn=Zi;try{var to=nn.alternate;if((nn.flags&1024)!==0)switch(nn.tag){case 0:case 11:case 15:break;case 1:if(to!==null){var io=to.memoizedProps,fa=to.memoizedState,yi=nn.stateNode,fi=yi.getSnapshotBeforeUpdate(nn.elementType===nn.type?io:fs(nn.type,io),fa);yi.__reactInternalSnapshotBeforeUpdate=fi}break;case 3:var bi=nn.stateNode.containerInfo;bi.nodeType===1?bi.textContent="":bi.nodeType===9&&bi.documentElement&&bi.removeChild(bi.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(Ni){ca(nn,nn.return,Ni)}if(Ar=nn.sibling,Ar!==null){Ar.return=nn.return,Zi=Ar;break}Zi=nn.return}return to=vp,vp=!1,to}function nu(Ar,nn,un){var vn=nn.updateQueue;if(vn=vn!==null?vn.lastEffect:null,vn!==null){var En=vn=vn.next;do{if((En.tag&Ar)===Ar){var $n=En.destroy;En.destroy=void 0,$n!==void 0&&ad(nn,un,$n)}En=En.next}while(En!==vn)}}function Vu(Ar,nn){if(nn=nn.updateQueue,nn=nn!==null?nn.lastEffect:null,nn!==null){var un=nn=nn.next;do{if((un.tag&Ar)===Ar){var vn=un.create;un.destroy=vn()}un=un.next}while(un!==nn)}}function sd(Ar){var nn=Ar.ref;if(nn!==null){var un=Ar.stateNode;switch(Ar.tag){case 5:Ar=un;break;default:Ar=un}typeof nn=="function"?nn(Ar):nn.current=Ar}}function mp(Ar){var nn=Ar.alternate;nn!==null&&(Ar.alternate=null,mp(nn)),Ar.child=null,Ar.deletions=null,Ar.sibling=null,Ar.tag===5&&(nn=Ar.stateNode,nn!==null&&(delete nn[xs],delete nn[Wl],delete nn[xc],delete nn[Lf],delete nn[Of])),Ar.stateNode=null,Ar.return=null,Ar.dependencies=null,Ar.memoizedProps=null,Ar.memoizedState=null,Ar.pendingProps=null,Ar.stateNode=null,Ar.updateQueue=null}function gp(Ar){return Ar.tag===5||Ar.tag===3||Ar.tag===4}function yp(Ar){e:for(;;){for(;Ar.sibling===null;){if(Ar.return===null||gp(Ar.return))return null;Ar=Ar.return}for(Ar.sibling.return=Ar.return,Ar=Ar.sibling;Ar.tag!==5&&Ar.tag!==6&&Ar.tag!==18;){if(Ar.flags&2||Ar.child===null||Ar.tag===4)continue e;Ar.child.return=Ar,Ar=Ar.child}if(!(Ar.flags&2))return Ar.stateNode}}function ld(Ar,nn,un){var vn=Ar.tag;if(vn===5||vn===6)Ar=Ar.stateNode,nn?un.nodeType===8?un.parentNode.insertBefore(Ar,nn):un.insertBefore(Ar,nn):(un.nodeType===8?(nn=un.parentNode,nn.insertBefore(Ar,un)):(nn=un,nn.appendChild(Ar)),un=un._reactRootContainer,un!=null||nn.onclick!==null||(nn.onclick=vu));else if(vn!==4&&(Ar=Ar.child,Ar!==null))for(ld(Ar,nn,un),Ar=Ar.sibling;Ar!==null;)ld(Ar,nn,un),Ar=Ar.sibling}function ud(Ar,nn,un){var vn=Ar.tag;if(vn===5||vn===6)Ar=Ar.stateNode,nn?un.insertBefore(Ar,nn):un.appendChild(Ar);else if(vn!==4&&(Ar=Ar.child,Ar!==null))for(ud(Ar,nn,un),Ar=Ar.sibling;Ar!==null;)ud(Ar,nn,un),Ar=Ar.sibling}var $a=null,vs=!1;function Hs(Ar,nn,un){for(un=un.child;un!==null;)Ap(Ar,nn,un),un=un.sibling}function Ap(Ar,nn,un){if(va&&typeof va.onCommitFiberUnmount=="function")try{va.onCommitFiberUnmount(ia,un)}catch{}switch(un.tag){case 5:Da||Ll(un,nn);case 6:var vn=$a,En=vs;$a=null,Hs(Ar,nn,un),$a=vn,vs=En,$a!==null&&(vs?(Ar=$a,un=un.stateNode,Ar.nodeType===8?Ar.parentNode.removeChild(un):Ar.removeChild(un)):$a.removeChild(un.stateNode));break;case 18:$a!==null&&(vs?(Ar=$a,un=un.stateNode,Ar.nodeType===8?bc(Ar.parentNode,un):Ar.nodeType===1&&bc(Ar,un),_s(Ar)):bc($a,un.stateNode));break;case 4:vn=$a,En=vs,$a=un.stateNode.containerInfo,vs=!0,Hs(Ar,nn,un),$a=vn,vs=En;break;case 0:case 11:case 14:case 15:if(!Da&&(vn=un.updateQueue,vn!==null&&(vn=vn.lastEffect,vn!==null))){En=vn=vn.next;do{var $n=En,jn=$n.destroy;$n=$n.tag,jn!==void 0&&(($n&2)!==0||($n&4)!==0)&&ad(un,nn,jn),En=En.next}while(En!==vn)}Hs(Ar,nn,un);break;case 1:if(!Da&&(Ll(un,nn),vn=un.stateNode,typeof vn.componentWillUnmount=="function"))try{vn.props=un.memoizedProps,vn.state=un.memoizedState,vn.componentWillUnmount()}catch(ii){ca(un,nn,ii)}Hs(Ar,nn,un);break;case 21:Hs(Ar,nn,un);break;case 22:un.mode&1?(Da=(vn=Da)||un.memoizedState!==null,Hs(Ar,nn,un),Da=vn):Hs(Ar,nn,un);break;default:Hs(Ar,nn,un)}}function bp(Ar){var nn=Ar.updateQueue;if(nn!==null){Ar.updateQueue=null;var un=Ar.stateNode;un===null&&(un=Ar.stateNode=new Xf),nn.forEach(function(vn){var En=av.bind(null,Ar,vn);un.has(vn)||(un.add(vn),vn.then(En,En))})}}function ms(Ar,nn){var un=nn.deletions;if(un!==null)for(var vn=0;vn<un.length;vn++){var En=un[vn];try{var $n=Ar,jn=nn,ii=jn;e:for(;ii!==null;){switch(ii.tag){case 5:$a=ii.stateNode,vs=!1;break e;case 3:$a=ii.stateNode.containerInfo,vs=!0;break e;case 4:$a=ii.stateNode.containerInfo,vs=!0;break e}ii=ii.return}if($a===null)throw Error(Be(160));Ap($n,jn,En),$a=null,vs=!1;var di=En.alternate;di!==null&&(di.return=null),En.return=null}catch(Ei){ca(En,nn,Ei)}}if(nn.subtreeFlags&12854)for(nn=nn.child;nn!==null;)xp(nn,Ar),nn=nn.sibling}function xp(Ar,nn){var un=Ar.alternate,vn=Ar.flags;switch(Ar.tag){case 0:case 11:case 14:case 15:if(ms(nn,Ar),Es(Ar),vn&4){try{nu(3,Ar,Ar.return),Vu(3,Ar)}catch(io){ca(Ar,Ar.return,io)}try{nu(5,Ar,Ar.return)}catch(io){ca(Ar,Ar.return,io)}}break;case 1:ms(nn,Ar),Es(Ar),vn&512&&un!==null&&Ll(un,un.return);break;case 5:if(ms(nn,Ar),Es(Ar),vn&512&&un!==null&&Ll(un,un.return),Ar.flags&32){var En=Ar.stateNode;try{vi(En,"")}catch(io){ca(Ar,Ar.return,io)}}if(vn&4&&(En=Ar.stateNode,En!=null)){var $n=Ar.memoizedProps,jn=un!==null?un.memoizedProps:$n,ii=Ar.type,di=Ar.updateQueue;if(Ar.updateQueue=null,di!==null)try{ii==="input"&&$n.type==="radio"&&$n.name!=null&&hi(En,$n),ho(ii,jn);var Ei=ho(ii,$n);for(jn=0;jn<di.length;jn+=2){var Di=di[jn],Vi=di[jn+1];Di==="style"?qi(En,Vi):Di==="dangerouslySetInnerHTML"?$i(En,Vi):Di==="children"?vi(En,Vi):sn(En,Di,Vi,Ei)}switch(ii){case"input":Un(En,$n);break;case"textarea":Pi(En,$n);break;case"select":var Li=En._wrapperState.wasMultiple;En._wrapperState.wasMultiple=!!$n.multiple;var Xi=$n.value;Xi!=null?ci(En,!!$n.multiple,Xi,!1):Li!==!!$n.multiple&&($n.defaultValue!=null?ci(En,!!$n.multiple,$n.defaultValue,!0):ci(En,!!$n.multiple,$n.multiple?[]:"",!1))}En[Wl]=$n}catch(io){ca(Ar,Ar.return,io)}}break;case 6:if(ms(nn,Ar),Es(Ar),vn&4){if(Ar.stateNode===null)throw Error(Be(162));En=Ar.stateNode,$n=Ar.memoizedProps;try{En.nodeValue=$n}catch(io){ca(Ar,Ar.return,io)}}break;case 3:if(ms(nn,Ar),Es(Ar),vn&4&&un!==null&&un.memoizedState.isDehydrated)try{_s(nn.containerInfo)}catch(io){ca(Ar,Ar.return,io)}break;case 4:ms(nn,Ar),Es(Ar);break;case 13:ms(nn,Ar),Es(Ar),En=Ar.child,En.flags&8192&&($n=En.memoizedState!==null,En.stateNode.isHidden=$n,!$n||En.alternate!==null&&En.alternate.memoizedState!==null||(hd=$o())),vn&4&&bp(Ar);break;case 22:if(Di=un!==null&&un.memoizedState!==null,Ar.mode&1?(Da=(Ei=Da)||Di,ms(nn,Ar),Da=Ei):ms(nn,Ar),Es(Ar),vn&8192){if(Ei=Ar.memoizedState!==null,(Ar.stateNode.isHidden=Ei)&&!Di&&(Ar.mode&1)!==0)for(Zi=Ar,Di=Ar.child;Di!==null;){for(Vi=Zi=Di;Zi!==null;){switch(Li=Zi,Xi=Li.child,Li.tag){case 0:case 11:case 14:case 15:nu(4,Li,Li.return);break;case 1:Ll(Li,Li.return);var to=Li.stateNode;if(typeof to.componentWillUnmount=="function"){vn=Li,un=Li.return;try{nn=vn,to.props=nn.memoizedProps,to.state=nn.memoizedState,to.componentWillUnmount()}catch(io){ca(vn,un,io)}}break;case 5:Ll(Li,Li.return);break;case 22:if(Li.memoizedState!==null){Ep(Vi);continue}}Xi!==null?(Xi.return=Li,Zi=Xi):Ep(Vi)}Di=Di.sibling}e:for(Di=null,Vi=Ar;;){if(Vi.tag===5){if(Di===null){Di=Vi;try{En=Vi.stateNode,Ei?($n=En.style,typeof $n.setProperty=="function"?$n.setProperty("display","none","important"):$n.display="none"):(ii=Vi.stateNode,di=Vi.memoizedProps.style,jn=di!=null&&di.hasOwnProperty("display")?di.display:null,ii.style.display=Bi("display",jn))}catch(io){ca(Ar,Ar.return,io)}}}else if(Vi.tag===6){if(Di===null)try{Vi.stateNode.nodeValue=Ei?"":Vi.memoizedProps}catch(io){ca(Ar,Ar.return,io)}}else if((Vi.tag!==22&&Vi.tag!==23||Vi.memoizedState===null||Vi===Ar)&&Vi.child!==null){Vi.child.return=Vi,Vi=Vi.child;continue}if(Vi===Ar)break e;for(;Vi.sibling===null;){if(Vi.return===null||Vi.return===Ar)break e;Di===Vi&&(Di=null),Vi=Vi.return}Di===Vi&&(Di=null),Vi.sibling.return=Vi.return,Vi=Vi.sibling}}break;case 19:ms(nn,Ar),Es(Ar),vn&4&&bp(Ar);break;case 21:break;default:ms(nn,Ar),Es(Ar)}}function Es(Ar){var nn=Ar.flags;if(nn&2){try{e:{for(var un=Ar.return;un!==null;){if(gp(un)){var vn=un;break e}un=un.return}throw Error(Be(160))}switch(vn.tag){case 5:var En=vn.stateNode;vn.flags&32&&(vi(En,""),vn.flags&=-33);var $n=yp(Ar);ud(Ar,$n,En);break;case 3:case 4:var jn=vn.stateNode.containerInfo,ii=yp(Ar);ld(Ar,ii,jn);break;default:throw Error(Be(161))}}catch(di){ca(Ar,Ar.return,di)}Ar.flags&=-3}nn&4096&&(Ar.flags&=-4097)}function Yf(Ar,nn,un){Zi=Ar,wp(Ar)}function wp(Ar,nn,un){for(var vn=(Ar.mode&1)!==0;Zi!==null;){var En=Zi,$n=En.child;if(En.tag===22&&vn){var jn=En.memoizedState!==null||ku;if(!jn){var ii=En.alternate,di=ii!==null&&ii.memoizedState!==null||Da;ii=ku;var Ei=Da;if(ku=jn,(Da=di)&&!Ei)for(Zi=En;Zi!==null;)jn=Zi,di=jn.child,jn.tag===22&&jn.memoizedState!==null?Mp(En):di!==null?(di.return=jn,Zi=di):Mp(En);for(;$n!==null;)Zi=$n,wp($n),$n=$n.sibling;Zi=En,ku=ii,Da=Ei}Sp(Ar)}else(En.subtreeFlags&8772)!==0&&$n!==null?($n.return=En,Zi=$n):Sp(Ar)}}function Sp(Ar){for(;Zi!==null;){var nn=Zi;if((nn.flags&8772)!==0){var un=nn.alternate;try{if((nn.flags&8772)!==0)switch(nn.tag){case 0:case 11:case 15:Da||Vu(5,nn);break;case 1:var vn=nn.stateNode;if(nn.flags&4&&!Da)if(un===null)vn.componentDidMount();else{var En=nn.elementType===nn.type?un.memoizedProps:fs(nn.type,un.memoizedProps);vn.componentDidUpdate(En,un.memoizedState,vn.__reactInternalSnapshotBeforeUpdate)}var $n=nn.updateQueue;$n!==null&&Sh(nn,$n,vn);break;case 3:var jn=nn.updateQueue;if(jn!==null){if(un=null,nn.child!==null)switch(nn.child.tag){case 5:un=nn.child.stateNode;break;case 1:un=nn.child.stateNode}Sh(nn,jn,un)}break;case 5:var ii=nn.stateNode;if(un===null&&nn.flags&4){un=ii;var di=nn.memoizedProps;switch(nn.type){case"button":case"input":case"select":case"textarea":di.autoFocus&&un.focus();break;case"img":di.src&&(un.src=di.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(nn.memoizedState===null){var Ei=nn.alternate;if(Ei!==null){var Di=Ei.memoizedState;if(Di!==null){var Vi=Di.dehydrated;Vi!==null&&_s(Vi)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}Da||nn.flags&512&&sd(nn)}catch(Li){ca(nn,nn.return,Li)}}if(nn===Ar){Zi=null;break}if(un=nn.sibling,un!==null){un.return=nn.return,Zi=un;break}Zi=nn.return}}function Ep(Ar){for(;Zi!==null;){var nn=Zi;if(nn===Ar){Zi=null;break}var un=nn.sibling;if(un!==null){un.return=nn.return,Zi=un;break}Zi=nn.return}}function Mp(Ar){for(;Zi!==null;){var nn=Zi;try{switch(nn.tag){case 0:case 11:case 15:var un=nn.return;try{Vu(4,nn)}catch(di){ca(nn,un,di)}break;case 1:var vn=nn.stateNode;if(typeof vn.componentDidMount=="function"){var En=nn.return;try{vn.componentDidMount()}catch(di){ca(nn,En,di)}}var $n=nn.return;try{sd(nn)}catch(di){ca(nn,$n,di)}break;case 5:var jn=nn.return;try{sd(nn)}catch(di){ca(nn,jn,di)}}}catch(di){ca(nn,nn.return,di)}if(nn===Ar){Zi=null;break}var ii=nn.sibling;if(ii!==null){ii.return=nn.return,Zi=ii;break}Zi=nn.return}}var Zf=Math.ceil,Fu=ln.ReactCurrentDispatcher,cd=ln.ReactCurrentOwner,us=ln.ReactCurrentBatchConfig,Vo=0,Ea=null,ya=null,Ta=0,rs=0,Ol=Ns(0),xa=0,iu=null,ul=0,Nu=0,dd=0,ou=null,Qa=null,hd=0,Bl=1/0,Os=null,zu=!1,pd=null,Ws=null,Uu=!1,qs=null,ju=0,au=0,vd=null,Gu=-1,Hu=0;function Fa(){return(Vo&6)!==0?$o():Gu!==-1?Gu:Gu=$o()}function Qs(Ar){return(Ar.mode&1)===0?1:(Vo&2)!==0&&Ta!==0?Ta&-Ta:Df.transition!==null?(Hu===0&&(Hu=Ya()),Hu):(Ar=On,Ar!==0||(Ar=window.event,Ar=Ar===void 0?16:Lo(Ar.type)),Ar)}function gs(Ar,nn,un,vn){if(50<au)throw au=0,vd=null,Error(Be(185));Nn(Ar,un,vn),((Vo&2)===0||Ar!==Ea)&&(Ar===Ea&&((Vo&2)===0&&(Nu|=un),xa===4&&Js(Ar,Ta)),Ja(Ar,vn),un===1&&Vo===0&&(nn.mode&1)===0&&(Bl=$o()+500,Au&&Us()))}function Ja(Ar,nn){var un=Ar.callbackNode;ys(Ar,nn);var vn=da(Ar,Ar===Ea?Ta:0);if(vn===0)un!==null&&Io(un),Ar.callbackNode=null,Ar.callbackPriority=0;else if(nn=vn&-vn,Ar.callbackPriority!==nn){if(un!=null&&Io(un),nn===1)Ar.tag===0?Bf(Cp.bind(null,Ar)):dh(Cp.bind(null,Ar)),If(function(){(Vo&6)===0&&Us()}),un=null;else{switch(Jn(vn)){case 1:un=na;break;case 4:un=Go;break;case 16:un=Jo;break;case 536870912:un=Do;break;default:un=Jo}un=Dp(un,_p.bind(null,Ar))}Ar.callbackPriority=nn,Ar.callbackNode=un}}function _p(Ar,nn){if(Gu=-1,Hu=0,(Vo&6)!==0)throw Error(Be(327));var un=Ar.callbackNode;if(Dl()&&Ar.callbackNode!==un)return null;var vn=da(Ar,Ar===Ea?Ta:0);if(vn===0)return null;if((vn&30)!==0||(vn&Ar.expiredLanes)!==0||nn)nn=Wu(Ar,vn);else{nn=vn;var En=Vo;Vo|=2;var $n=Tp();(Ea!==Ar||Ta!==nn)&&(Os=null,Bl=$o()+500,dl(Ar,nn));do try{rv();break}catch(ii){$p(Ar,ii)}while(!0);Pc(),Fu.current=$n,Vo=En,ya!==null?nn=0:(Ea=null,Ta=0,nn=xa)}if(nn!==0){if(nn===2&&(En=Ua(Ar),En!==0&&(vn=En,nn=md(Ar,En))),nn===1)throw un=iu,dl(Ar,0),Js(Ar,vn),Ja(Ar,$o()),un;if(nn===6)Js(Ar,vn);else{if(En=Ar.current.alternate,(vn&30)===0&&!ev(En)&&(nn=Wu(Ar,vn),nn===2&&($n=Ua(Ar),$n!==0&&(vn=$n,nn=md(Ar,$n))),nn===1))throw un=iu,dl(Ar,0),Js(Ar,vn),Ja(Ar,$o()),un;switch(Ar.finishedWork=En,Ar.finishedLanes=vn,nn){case 0:case 1:throw Error(Be(345));case 2:hl(Ar,Qa,Os);break;case 3:if(Js(Ar,vn),(vn&130023424)===vn&&(nn=hd+500-$o(),10<nn)){if(da(Ar,0)!==0)break;if(En=Ar.suspendedLanes,(En&vn)!==vn){Fa(),Ar.pingedLanes|=Ar.suspendedLanes&En;break}Ar.timeoutHandle=Ac(hl.bind(null,Ar,Qa,Os),nn);break}hl(Ar,Qa,Os);break;case 4:if(Js(Ar,vn),(vn&4194240)===vn)break;for(nn=Ar.eventTimes,En=-1;0<vn;){var jn=31-Fo(vn);$n=1<<jn,jn=nn[jn],jn>En&&(En=jn),vn&=~$n}if(vn=En,vn=$o()-vn,vn=(120>vn?120:480>vn?480:1080>vn?1080:1920>vn?1920:3e3>vn?3e3:4320>vn?4320:1960*Zf(vn/1960))-vn,10<vn){Ar.timeoutHandle=Ac(hl.bind(null,Ar,Qa,Os),vn);break}hl(Ar,Qa,Os);break;case 5:hl(Ar,Qa,Os);break;default:throw Error(Be(329))}}}return Ja(Ar,$o()),Ar.callbackNode===un?_p.bind(null,Ar):null}function md(Ar,nn){var un=ou;return Ar.current.memoizedState.isDehydrated&&(dl(Ar,nn).flags|=256),Ar=Wu(Ar,nn),Ar!==2&&(nn=Qa,Qa=un,nn!==null&&gd(nn)),Ar}function gd(Ar){Qa===null?Qa=Ar:Qa.push.apply(Qa,Ar)}function ev(Ar){for(var nn=Ar;;){if(nn.flags&16384){var un=nn.updateQueue;if(un!==null&&(un=un.stores,un!==null))for(var vn=0;vn<un.length;vn++){var En=un[vn],$n=En.getSnapshot;En=En.value;try{if(!hs($n(),En))return!1}catch{return!1}}}if(un=nn.child,nn.subtreeFlags&16384&&un!==null)un.return=nn,nn=un;else{if(nn===Ar)break;for(;nn.sibling===null;){if(nn.return===null||nn.return===Ar)return!0;nn=nn.return}nn.sibling.return=nn.return,nn=nn.sibling}}return!0}function Js(Ar,nn){for(nn&=~dd,nn&=~Nu,Ar.suspendedLanes|=nn,Ar.pingedLanes&=~nn,Ar=Ar.expirationTimes;0<nn;){var un=31-Fo(nn),vn=1<<un;Ar[un]=-1,nn&=~vn}}function Cp(Ar){if((Vo&6)!==0)throw Error(Be(327));Dl();var nn=da(Ar,0);if((nn&1)===0)return Ja(Ar,$o()),null;var un=Wu(Ar,nn);if(Ar.tag!==0&&un===2){var vn=Ua(Ar);vn!==0&&(nn=vn,un=md(Ar,vn))}if(un===1)throw un=iu,dl(Ar,0),Js(Ar,nn),Ja(Ar,$o()),un;if(un===6)throw Error(Be(345));return Ar.finishedWork=Ar.current.alternate,Ar.finishedLanes=nn,hl(Ar,Qa,Os),Ja(Ar,$o()),null}function yd(Ar,nn){var un=Vo;Vo|=1;try{return Ar(nn)}finally{Vo=un,Vo===0&&(Bl=$o()+500,Au&&Us())}}function cl(Ar){qs!==null&&qs.tag===0&&(Vo&6)===0&&Dl();var nn=Vo;Vo|=1;var un=us.transition,vn=On;try{if(us.transition=null,On=1,Ar)return Ar()}finally{On=vn,us.transition=un,Vo=nn,(Vo&6)===0&&Us()}}function Ad(){rs=Ol.current,Yo(Ol)}function dl(Ar,nn){Ar.finishedWork=null,Ar.finishedLanes=0;var un=Ar.timeoutHandle;if(un!==-1&&(Ar.timeoutHandle=-1,Pf(un)),ya!==null)for(un=ya.return;un!==null;){var vn=un;switch(Mc(vn),vn.tag){case 1:vn=vn.type.childContextTypes,vn!=null&&gu();break;case 3:Il(),Yo(Ha),Yo(La),Vc();break;case 5:Dc(vn);break;case 4:Il();break;case 13:Yo(oa);break;case 19:Yo(oa);break;case 10:Ic(vn.type._context);break;case 22:case 23:Ad()}un=un.return}if(Ea=Ar,ya=Ar=Xs(Ar.current,null),Ta=rs=nn,xa=0,iu=null,dd=Nu=ul=0,Qa=ou=null,al!==null){for(nn=0;nn<al.length;nn++)if(un=al[nn],vn=un.interleaved,vn!==null){un.interleaved=null;var En=vn.next,$n=un.pending;if($n!==null){var jn=$n.next;$n.next=En,vn.next=jn}un.pending=vn}al=null}return Ar}function $p(Ar,nn){do{var un=ya;try{if(Pc(),Tu.current=Lu,Pu){for(var vn=aa.memoizedState;vn!==null;){var En=vn.queue;En!==null&&(En.pending=null),vn=vn.next}Pu=!1}if(ll=0,Sa=ba=aa=null,Yl=!1,Zl=0,cd.current=null,un===null||un.return===null){xa=1,iu=nn,ya=null;break}e:{var $n=Ar,jn=un.return,ii=un,di=nn;if(nn=Ta,ii.flags|=32768,di!==null&&typeof di=="object"&&typeof di.then=="function"){var Ei=di,Di=ii,Vi=Di.tag;if((Di.mode&1)===0&&(Vi===0||Vi===11||Vi===15)){var Li=Di.alternate;Li?(Di.updateQueue=Li.updateQueue,Di.memoizedState=Li.memoizedState,Di.lanes=Li.lanes):(Di.updateQueue=null,Di.memoizedState=null)}var Xi=Zh(jn);if(Xi!==null){Xi.flags&=-257,ep(Xi,jn,ii,$n,nn),Xi.mode&1&&Yh($n,Ei,nn),nn=Xi,di=Ei;var to=nn.updateQueue;if(to===null){var io=new Set;io.add(di),nn.updateQueue=io}else to.add(di);break e}else{if((nn&1)===0){Yh($n,Ei,nn),bd();break e}di=Error(Be(426))}}else if(ra&&ii.mode&1){var fa=Zh(jn);if(fa!==null){(fa.flags&65536)===0&&(fa.flags|=256),ep(fa,jn,ii,$n,nn),$c(Rl(di,ii));break e}}$n=di=Rl(di,ii),xa!==4&&(xa=2),ou===null?ou=[$n]:ou.push($n),$n=jn;do{switch($n.tag){case 3:$n.flags|=65536,nn&=-nn,$n.lanes|=nn;var yi=Xh($n,di,nn);wh($n,yi);break e;case 1:ii=di;var fi=$n.type,bi=$n.stateNode;if(($n.flags&128)===0&&(typeof fi.getDerivedStateFromError=="function"||bi!==null&&typeof bi.componentDidCatch=="function"&&(Ws===null||!Ws.has(bi)))){$n.flags|=65536,nn&=-nn,$n.lanes|=nn;var Ni=Kh($n,ii,nn);wh($n,Ni);break e}}$n=$n.return}while($n!==null)}Ip(un)}catch(uo){nn=uo,ya===un&&un!==null&&(ya=un=un.return);continue}break}while(!0)}function Tp(){var Ar=Fu.current;return Fu.current=Lu,Ar===null?Lu:Ar}function bd(){(xa===0||xa===3||xa===2)&&(xa=4),Ea===null||(ul&268435455)===0&&(Nu&268435455)===0||Js(Ea,Ta)}function Wu(Ar,nn){var un=Vo;Vo|=2;var vn=Tp();(Ea!==Ar||Ta!==nn)&&(Os=null,dl(Ar,nn));do try{tv();break}catch(En){$p(Ar,En)}while(!0);if(Pc(),Vo=un,Fu.current=vn,ya!==null)throw Error(Be(261));return Ea=null,Ta=0,xa}function tv(){for(;ya!==null;)Pp(ya)}function rv(){for(;ya!==null&&!Xa();)Pp(ya)}function Pp(Ar){var nn=Bp(Ar.alternate,Ar,rs);Ar.memoizedProps=Ar.pendingProps,nn===null?Ip(Ar):ya=nn,cd.current=null}function Ip(Ar){var nn=Ar;do{var un=nn.alternate;if(Ar=nn.return,(nn.flags&32768)===0){if(un=Qf(un,nn,rs),un!==null){ya=un;return}}else{if(un=Jf(un,nn),un!==null){un.flags&=32767,ya=un;return}if(Ar!==null)Ar.flags|=32768,Ar.subtreeFlags=0,Ar.deletions=null;else{xa=6,ya=null;return}}if(nn=nn.sibling,nn!==null){ya=nn;return}ya=nn=Ar}while(nn!==null);xa===0&&(xa=5)}function hl(Ar,nn,un){var vn=On,En=us.transition;try{us.transition=null,On=1,nv(Ar,nn,un,vn)}finally{us.transition=En,On=vn}return null}function nv(Ar,nn,un,vn){do Dl();while(qs!==null);if((Vo&6)!==0)throw Error(Be(327));un=Ar.finishedWork;var En=Ar.finishedLanes;if(un===null)return null;if(Ar.finishedWork=null,Ar.finishedLanes=0,un===Ar.current)throw Error(Be(177));Ar.callbackNode=null,Ar.callbackPriority=0;var $n=un.lanes|un.childLanes;if(Xn(Ar,$n),Ar===Ea&&(ya=Ea=null,Ta=0),(un.subtreeFlags&2064)===0&&(un.flags&2064)===0||Uu||(Uu=!0,Dp(Jo,function(){return Dl(),null})),$n=(un.flags&15990)!==0,(un.subtreeFlags&15990)!==0||$n){$n=us.transition,us.transition=null;var jn=On;On=1;var ii=Vo;Vo|=4,cd.current=null,Kf(Ar,un),xp(un,Ar),Sf(gc),qn=!!mc,gc=mc=null,Ar.current=un,Yf(un),Na(),Vo=ii,On=jn,us.transition=$n}else Ar.current=un;if(Uu&&(Uu=!1,qs=Ar,ju=En),$n=Ar.pendingLanes,$n===0&&(Ws=null),Ka(un.stateNode),Ja(Ar,$o()),nn!==null)for(vn=Ar.onRecoverableError,un=0;un<nn.length;un++)En=nn[un],vn(En.value,{componentStack:En.stack,digest:En.digest});if(zu)throw zu=!1,Ar=pd,pd=null,Ar;return(ju&1)!==0&&Ar.tag!==0&&Dl(),$n=Ar.pendingLanes,($n&1)!==0?Ar===vd?au++:(au=0,vd=Ar):au=0,Us(),null}function Dl(){if(qs!==null){var Ar=Jn(ju),nn=us.transition,un=On;try{if(us.transition=null,On=16>Ar?16:Ar,qs===null)var vn=!1;else{if(Ar=qs,qs=null,ju=0,(Vo&6)!==0)throw Error(Be(331));var En=Vo;for(Vo|=4,Zi=Ar.current;Zi!==null;){var $n=Zi,jn=$n.child;if((Zi.flags&16)!==0){var ii=$n.deletions;if(ii!==null){for(var di=0;di<ii.length;di++){var Ei=ii[di];for(Zi=Ei;Zi!==null;){var Di=Zi;switch(Di.tag){case 0:case 11:case 15:nu(8,Di,$n)}var Vi=Di.child;if(Vi!==null)Vi.return=Di,Zi=Vi;else for(;Zi!==null;){Di=Zi;var Li=Di.sibling,Xi=Di.return;if(mp(Di),Di===Ei){Zi=null;break}if(Li!==null){Li.return=Xi,Zi=Li;break}Zi=Xi}}}var to=$n.alternate;if(to!==null){var io=to.child;if(io!==null){to.child=null;do{var fa=io.sibling;io.sibling=null,io=fa}while(io!==null)}}Zi=$n}}if(($n.subtreeFlags&2064)!==0&&jn!==null)jn.return=$n,Zi=jn;else e:for(;Zi!==null;){if($n=Zi,($n.flags&2048)!==0)switch($n.tag){case 0:case 11:case 15:nu(9,$n,$n.return)}var yi=$n.sibling;if(yi!==null){yi.return=$n.return,Zi=yi;break e}Zi=$n.return}}var fi=Ar.current;for(Zi=fi;Zi!==null;){jn=Zi;var bi=jn.child;if((jn.subtreeFlags&2064)!==0&&bi!==null)bi.return=jn,Zi=bi;else e:for(jn=fi;Zi!==null;){if(ii=Zi,(ii.flags&2048)!==0)try{switch(ii.tag){case 0:case 11:case 15:Vu(9,ii)}}catch(uo){ca(ii,ii.return,uo)}if(ii===jn){Zi=null;break e}var Ni=ii.sibling;if(Ni!==null){Ni.return=ii.return,Zi=Ni;break e}Zi=ii.return}}if(Vo=En,Us(),va&&typeof va.onPostCommitFiberRoot=="function")try{va.onPostCommitFiberRoot(ia,Ar)}catch{}vn=!0}return vn}finally{On=un,us.transition=nn}}return!1}function Rp(Ar,nn,un){nn=Rl(un,nn),nn=Xh(Ar,nn,1),Ar=Gs(Ar,nn,1),nn=Fa(),Ar!==null&&(Nn(Ar,1,nn),Ja(Ar,nn))}function ca(Ar,nn,un){if(Ar.tag===3)Rp(Ar,Ar,un);else for(;nn!==null;){if(nn.tag===3){Rp(nn,Ar,un);break}else if(nn.tag===1){var vn=nn.stateNode;if(typeof nn.type.getDerivedStateFromError=="function"||typeof vn.componentDidCatch=="function"&&(Ws===null||!Ws.has(vn))){Ar=Rl(un,Ar),Ar=Kh(nn,Ar,1),nn=Gs(nn,Ar,1),Ar=Fa(),nn!==null&&(Nn(nn,1,Ar),Ja(nn,Ar));break}}nn=nn.return}}function iv(Ar,nn,un){var vn=Ar.pingCache;vn!==null&&vn.delete(nn),nn=Fa(),Ar.pingedLanes|=Ar.suspendedLanes&un,Ea===Ar&&(Ta&un)===un&&(xa===4||xa===3&&(Ta&130023424)===Ta&&500>$o()-hd?dl(Ar,0):dd|=un),Ja(Ar,nn)}function Lp(Ar,nn){nn===0&&((Ar.mode&1)===0?nn=1:(nn=ma,ma<<=1,(ma&130023424)===0&&(ma=4194304)));var un=Fa();Ar=Is(Ar,nn),Ar!==null&&(Nn(Ar,nn,un),Ja(Ar,un))}function ov(Ar){var nn=Ar.memoizedState,un=0;nn!==null&&(un=nn.retryLane),Lp(Ar,un)}function av(Ar,nn){var un=0;switch(Ar.tag){case 13:var vn=Ar.stateNode,En=Ar.memoizedState;En!==null&&(un=En.retryLane);break;case 19:vn=Ar.stateNode;break;default:throw Error(Be(314))}vn!==null&&vn.delete(nn),Lp(Ar,un)}var Bp;Bp=function(Ar,nn,un){if(Ar!==null)if(Ar.memoizedProps!==nn.pendingProps||Ha.current)qa=!0;else{if((Ar.lanes&un)===0&&(nn.flags&128)===0)return qa=!1,qf(Ar,nn,un);qa=(Ar.flags&131072)!==0}else qa=!1,ra&&(nn.flags&1048576)!==0&&hh(nn,xu,nn.index);switch(nn.lanes=0,nn.tag){case 2:var vn=nn.type;Du(Ar,nn),Ar=nn.pendingProps;var En=El(nn,La.current);Pl(nn,un),En=zc(null,nn,vn,Ar,En,un);var $n=Uc();return nn.flags|=1,typeof En=="object"&&En!==null&&typeof En.render=="function"&&En.$$typeof===void 0?(nn.tag=1,nn.memoizedState=null,nn.updateQueue=null,Wa(vn)?($n=!0,yu(nn)):$n=!1,nn.memoizedState=En.state!==null&&En.state!==void 0?En.state:null,Oc(nn),En.updater=Ou,nn.stateNode=En,En._reactInternals=nn,Qc(nn,vn,Ar,un),nn=Yc(null,nn,vn,!0,$n,un)):(nn.tag=0,ra&&$n&&Ec(nn),Va(null,nn,En,un),nn=nn.child),nn;case 16:vn=nn.elementType;e:{switch(Du(Ar,nn),Ar=nn.pendingProps,En=vn._init,vn=En(vn._payload),nn.type=vn,En=nn.tag=lv(vn),Ar=fs(vn,Ar),En){case 0:nn=Kc(null,nn,vn,Ar,un);break e;case 1:nn=ap(null,nn,vn,Ar,un);break e;case 11:nn=tp(null,nn,vn,Ar,un);break e;case 14:nn=rp(null,nn,vn,fs(vn.type,Ar),un);break e}throw Error(Be(306,vn,""))}return nn;case 0:return vn=nn.type,En=nn.pendingProps,En=nn.elementType===vn?En:fs(vn,En),Kc(Ar,nn,vn,En,un);case 1:return vn=nn.type,En=nn.pendingProps,En=nn.elementType===vn?En:fs(vn,En),ap(Ar,nn,vn,En,un);case 3:e:{if(sp(nn),Ar===null)throw Error(Be(387));vn=nn.pendingProps,$n=nn.memoizedState,En=$n.element,xh(Ar,nn),Cu(nn,vn,null,un);var jn=nn.memoizedState;if(vn=jn.element,$n.isDehydrated)if($n={element:vn,isDehydrated:!1,cache:jn.cache,pendingSuspenseBoundaries:jn.pendingSuspenseBoundaries,transitions:jn.transitions},nn.updateQueue.baseState=$n,nn.memoizedState=$n,nn.flags&256){En=Rl(Error(Be(423)),nn),nn=lp(Ar,nn,vn,un,En);break e}else if(vn!==En){En=Rl(Error(Be(424)),nn),nn=lp(Ar,nn,vn,un,En);break e}else for(ts=Fs(nn.stateNode.containerInfo.firstChild),es=nn,ra=!0,ps=null,un=Ah(nn,null,vn,un),nn.child=un;un;)un.flags=un.flags&-3|4096,un=un.sibling;else{if(Cl(),vn===En){nn=Ls(Ar,nn,un);break e}Va(Ar,nn,vn,un)}nn=nn.child}return nn;case 5:return Eh(nn),Ar===null&&Cc(nn),vn=nn.type,En=nn.pendingProps,$n=Ar!==null?Ar.memoizedProps:null,jn=En.children,yc(vn,En)?jn=null:$n!==null&&yc(vn,$n)&&(nn.flags|=32),op(Ar,nn),Va(Ar,nn,jn,un),nn.child;case 6:return Ar===null&&Cc(nn),null;case 13:return up(Ar,nn,un);case 4:return Bc(nn,nn.stateNode.containerInfo),vn=nn.pendingProps,Ar===null?nn.child=$l(nn,null,vn,un):Va(Ar,nn,vn,un),nn.child;case 11:return vn=nn.type,En=nn.pendingProps,En=nn.elementType===vn?En:fs(vn,En),tp(Ar,nn,vn,En,un);case 7:return Va(Ar,nn,nn.pendingProps,un),nn.child;case 8:return Va(Ar,nn,nn.pendingProps.children,un),nn.child;case 12:return Va(Ar,nn,nn.pendingProps.children,un),nn.child;case 10:e:{if(vn=nn.type._context,En=nn.pendingProps,$n=nn.memoizedProps,jn=En.value,Wo(Eu,vn._currentValue),vn._currentValue=jn,$n!==null)if(hs($n.value,jn)){if($n.children===En.children&&!Ha.current){nn=Ls(Ar,nn,un);break e}}else for($n=nn.child,$n!==null&&($n.return=nn);$n!==null;){var ii=$n.dependencies;if(ii!==null){jn=$n.child;for(var di=ii.firstContext;di!==null;){if(di.context===vn){if($n.tag===1){di=Rs(-1,un&-un),di.tag=2;var Ei=$n.updateQueue;if(Ei!==null){Ei=Ei.shared;var Di=Ei.pending;Di===null?di.next=di:(di.next=Di.next,Di.next=di),Ei.pending=di}}$n.lanes|=un,di=$n.alternate,di!==null&&(di.lanes|=un),Rc($n.return,un,nn),ii.lanes|=un;break}di=di.next}}else if($n.tag===10)jn=$n.type===nn.type?null:$n.child;else if($n.tag===18){if(jn=$n.return,jn===null)throw Error(Be(341));jn.lanes|=un,ii=jn.alternate,ii!==null&&(ii.lanes|=un),Rc(jn,un,nn),jn=$n.sibling}else jn=$n.child;if(jn!==null)jn.return=$n;else for(jn=$n;jn!==null;){if(jn===nn){jn=null;break}if($n=jn.sibling,$n!==null){$n.return=jn.return,jn=$n;break}jn=jn.return}$n=jn}Va(Ar,nn,En.children,un),nn=nn.child}return nn;case 9:return En=nn.type,vn=nn.pendingProps.children,Pl(nn,un),En=ss(En),vn=vn(En),nn.flags|=1,Va(Ar,nn,vn,un),nn.child;case 14:return vn=nn.type,En=fs(vn,nn.pendingProps),En=fs(vn.type,En),rp(Ar,nn,vn,En,un);case 15:return np(Ar,nn,nn.type,nn.pendingProps,un);case 17:return vn=nn.type,En=nn.pendingProps,En=nn.elementType===vn?En:fs(vn,En),Du(Ar,nn),nn.tag=1,Wa(vn)?(Ar=!0,yu(nn)):Ar=!1,Pl(nn,un),Qh(nn,vn,En),Qc(nn,vn,En,un),Yc(null,nn,vn,!0,Ar,un);case 19:return dp(Ar,nn,un);case 22:return ip(Ar,nn,un)}throw Error(Be(156,nn.tag))};function Dp(Ar,nn){return Ho(Ar,nn)}function sv(Ar,nn,un,vn){this.tag=Ar,this.key=un,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=nn,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=vn,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(Ar,nn,un,vn){return new sv(Ar,nn,un,vn)}function xd(Ar){return Ar=Ar.prototype,!(!Ar||!Ar.isReactComponent)}function lv(Ar){if(typeof Ar=="function")return xd(Ar)?1:0;if(Ar!=null){if(Ar=Ar.$$typeof,Ar===fn)return 11;if(Ar===gn)return 14}return 2}function Xs(Ar,nn){var un=Ar.alternate;return un===null?(un=cs(Ar.tag,nn,Ar.key,Ar.mode),un.elementType=Ar.elementType,un.type=Ar.type,un.stateNode=Ar.stateNode,un.alternate=Ar,Ar.alternate=un):(un.pendingProps=nn,un.type=Ar.type,un.flags=0,un.subtreeFlags=0,un.deletions=null),un.flags=Ar.flags&14680064,un.childLanes=Ar.childLanes,un.lanes=Ar.lanes,un.child=Ar.child,un.memoizedProps=Ar.memoizedProps,un.memoizedState=Ar.memoizedState,un.updateQueue=Ar.updateQueue,nn=Ar.dependencies,un.dependencies=nn===null?null:{lanes:nn.lanes,firstContext:nn.firstContext},un.sibling=Ar.sibling,un.index=Ar.index,un.ref=Ar.ref,un}function qu(Ar,nn,un,vn,En,$n){var jn=2;if(vn=Ar,typeof Ar=="function")xd(Ar)&&(jn=1);else if(typeof Ar=="string")jn=5;else e:switch(Ar){case mn:return pl(un.children,En,$n,nn);case An:jn=8,En|=8;break;case xn:return Ar=cs(12,un,nn,En|2),Ar.elementType=xn,Ar.lanes=$n,Ar;case yn:return Ar=cs(13,un,nn,En),Ar.elementType=yn,Ar.lanes=$n,Ar;case Sn:return Ar=cs(19,un,nn,En),Ar.elementType=Sn,Ar.lanes=$n,Ar;case Mn:return Qu(un,En,$n,nn);default:if(typeof Ar=="object"&&Ar!==null)switch(Ar.$$typeof){case pn:jn=10;break e;case dn:jn=9;break e;case fn:jn=11;break e;case gn:jn=14;break e;case Cn:jn=16,vn=null;break e}throw Error(Be(130,Ar==null?Ar:typeof Ar,""))}return nn=cs(jn,un,nn,En),nn.elementType=Ar,nn.type=vn,nn.lanes=$n,nn}function pl(Ar,nn,un,vn){return Ar=cs(7,Ar,vn,nn),Ar.lanes=un,Ar}function Qu(Ar,nn,un,vn){return Ar=cs(22,Ar,vn,nn),Ar.elementType=Mn,Ar.lanes=un,Ar.stateNode={isHidden:!1},Ar}function wd(Ar,nn,un){return Ar=cs(6,Ar,null,nn),Ar.lanes=un,Ar}function Sd(Ar,nn,un){return nn=cs(4,Ar.children!==null?Ar.children:[],Ar.key,nn),nn.lanes=un,nn.stateNode={containerInfo:Ar.containerInfo,pendingChildren:null,implementation:Ar.implementation},nn}function uv(Ar,nn,un,vn,En){this.tag=nn,this.containerInfo=Ar,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ja(0),this.expirationTimes=ja(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ja(0),this.identifierPrefix=vn,this.onRecoverableError=En,this.mutableSourceEagerHydrationData=null}function Ed(Ar,nn,un,vn,En,$n,jn,ii,di){return Ar=new uv(Ar,nn,un,ii,di),nn===1?(nn=1,$n===!0&&(nn|=8)):nn=0,$n=cs(3,null,null,nn),Ar.current=$n,$n.stateNode=Ar,$n.memoizedState={element:vn,isDehydrated:un,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oc($n),Ar}function cv(Ar,nn,un){var vn=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hn,key:vn==null?null:""+vn,children:Ar,containerInfo:nn,implementation:un}}function kp(Ar){if(!Ar)return zs;Ar=Ar._reactInternals;e:{if(eo(Ar)!==Ar||Ar.tag!==1)throw Error(Be(170));var nn=Ar;do{switch(nn.tag){case 3:nn=nn.stateNode.context;break e;case 1:if(Wa(nn.type)){nn=nn.stateNode.__reactInternalMemoizedMergedChildContext;break e}}nn=nn.return}while(nn!==null);throw Error(Be(171))}if(Ar.tag===1){var un=Ar.type;if(Wa(un))return uh(Ar,un,nn)}return nn}function Vp(Ar,nn,un,vn,En,$n,jn,ii,di){return Ar=Ed(un,vn,!0,Ar,En,$n,jn,ii,di),Ar.context=kp(null),un=Ar.current,vn=Fa(),En=Qs(un),$n=Rs(vn,En),$n.callback=nn??null,Gs(un,$n,En),Ar.current.lanes=En,Nn(Ar,En,vn),Ja(Ar,vn),Ar}function Ju(Ar,nn,un,vn){var En=nn.current,$n=Fa(),jn=Qs(En);return un=kp(un),nn.context===null?nn.context=un:nn.pendingContext=un,nn=Rs($n,jn),nn.payload={element:Ar},vn=vn===void 0?null:vn,vn!==null&&(nn.callback=vn),Ar=Gs(En,nn,jn),Ar!==null&&(gs(Ar,En,jn,$n),_u(Ar,En,jn)),jn}function Xu(Ar){if(Ar=Ar.current,!Ar.child)return null;switch(Ar.child.tag){case 5:return Ar.child.stateNode;default:return Ar.child.stateNode}}function Fp(Ar,nn){if(Ar=Ar.memoizedState,Ar!==null&&Ar.dehydrated!==null){var un=Ar.retryLane;Ar.retryLane=un!==0&&un<nn?un:nn}}function Md(Ar,nn){Fp(Ar,nn),(Ar=Ar.alternate)&&Fp(Ar,nn)}function dv(){return null}var Np=typeof reportError=="function"?reportError:function(Ar){console.error(Ar)};function _d(Ar){this._internalRoot=Ar}Ku.prototype.render=_d.prototype.render=function(Ar){var nn=this._internalRoot;if(nn===null)throw Error(Be(409));Ju(Ar,nn,null,null)},Ku.prototype.unmount=_d.prototype.unmount=function(){var Ar=this._internalRoot;if(Ar!==null){this._internalRoot=null;var nn=Ar.containerInfo;cl(function(){Ju(null,Ar,null,null)}),nn[Cs]=null}};function Ku(Ar){this._internalRoot=Ar}Ku.prototype.unstable_scheduleHydration=function(Ar){if(Ar){var nn=no();Ar={blockedOn:null,target:Ar,priority:nn};for(var un=0;un<Ga.length&&nn!==0&&nn<Ga[un].priority;un++);Ga.splice(un,0,Ar),un===0&&Zs(Ar)}};function Cd(Ar){return!(!Ar||Ar.nodeType!==1&&Ar.nodeType!==9&&Ar.nodeType!==11)}function Yu(Ar){return!(!Ar||Ar.nodeType!==1&&Ar.nodeType!==9&&Ar.nodeType!==11&&(Ar.nodeType!==8||Ar.nodeValue!==" react-mount-point-unstable "))}function zp(){}function hv(Ar,nn,un,vn,En){if(En){if(typeof vn=="function"){var $n=vn;vn=function(){var Ei=Xu(jn);$n.call(Ei)}}var jn=Vp(nn,vn,Ar,0,null,!1,!1,"",zp);return Ar._reactRootContainer=jn,Ar[Cs]=jn.current,Gl(Ar.nodeType===8?Ar.parentNode:Ar),cl(),jn}for(;En=Ar.lastChild;)Ar.removeChild(En);if(typeof vn=="function"){var ii=vn;vn=function(){var Ei=Xu(di);ii.call(Ei)}}var di=Ed(Ar,0,!1,null,null,!1,!1,"",zp);return Ar._reactRootContainer=di,Ar[Cs]=di.current,Gl(Ar.nodeType===8?Ar.parentNode:Ar),cl(function(){Ju(nn,di,un,vn)}),di}function Zu(Ar,nn,un,vn,En){var $n=un._reactRootContainer;if($n){var jn=$n;if(typeof En=="function"){var ii=En;En=function(){var di=Xu(jn);ii.call(di)}}Ju(nn,jn,Ar,En)}else jn=hv(un,nn,Ar,En,vn);return Xu(jn)}pi=function(Ar){switch(Ar.tag){case 3:var nn=Ar.stateNode;if(nn.current.memoizedState.isDehydrated){var un=Aa(nn.pendingLanes);un!==0&&(_n(nn,un|1),Ja(nn,$o()),(Vo&6)===0&&(Bl=$o()+500,Us()))}break;case 13:cl(function(){var vn=Is(Ar,1);if(vn!==null){var En=Fa();gs(vn,Ar,1,En)}}),Md(Ar,1)}},Si=function(Ar){if(Ar.tag===13){var nn=Is(Ar,134217728);if(nn!==null){var un=Fa();gs(nn,Ar,134217728,un)}Md(Ar,134217728)}},zi=function(Ar){if(Ar.tag===13){var nn=Qs(Ar),un=Is(Ar,nn);if(un!==null){var vn=Fa();gs(un,Ar,nn,vn)}Md(Ar,nn)}},no=function(){return On},Co=function(Ar,nn){var un=On;try{return On=Ar,nn()}finally{On=un}},co=function(Ar,nn,un){switch(nn){case"input":if(Un(Ar,un),nn=un.name,un.type==="radio"&&nn!=null){for(un=Ar;un.parentNode;)un=un.parentNode;for(un=un.querySelectorAll("input[name="+JSON.stringify(""+nn)+'][type="radio"]'),nn=0;nn<un.length;nn++){var vn=un[nn];if(vn!==Ar&&vn.form===Ar.form){var En=mu(vn);if(!En)throw Error(Be(90));Qn(vn),Un(vn,En)}}}break;case"textarea":Pi(Ar,un);break;case"select":nn=un.value,nn!=null&&ci(Ar,!!un.multiple,nn,!1)}},Po=yd,Kn=cl;var pv={usingClientEntryPoint:!1,Events:[ql,wl,mu,Oo,Bo,yd]},su={findFiberByHostInstance:rl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fv={bundleType:su.bundleType,version:su.version,rendererPackageName:su.rendererPackageName,rendererConfig:su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ln.ReactCurrentDispatcher,findHostInstanceByFiber:function(Ar){return Ar=To(Ar),Ar===null?null:Ar.stateNode},findFiberByHostInstance:su.findFiberByHostInstance||dv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tc.isDisabled&&tc.supportsFiber)try{ia=tc.inject(fv),va=tc}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pv,reactDom_production_min.createPortal=function(Ar,nn){var un=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cd(nn))throw Error(Be(200));return cv(Ar,nn,null,un)},reactDom_production_min.createRoot=function(Ar,nn){if(!Cd(Ar))throw Error(Be(299));var un=!1,vn="",En=Np;return nn!=null&&(nn.unstable_strictMode===!0&&(un=!0),nn.identifierPrefix!==void 0&&(vn=nn.identifierPrefix),nn.onRecoverableError!==void 0&&(En=nn.onRecoverableError)),nn=Ed(Ar,1,!1,null,null,un,!1,vn,En),Ar[Cs]=nn.current,Gl(Ar.nodeType===8?Ar.parentNode:Ar),new _d(nn)},reactDom_production_min.findDOMNode=function(Ar){if(Ar==null)return null;if(Ar.nodeType===1)return Ar;var nn=Ar._reactInternals;if(nn===void 0)throw typeof Ar.render=="function"?Error(Be(188)):(Ar=Object.keys(Ar).join(","),Error(Be(268,Ar)));return Ar=To(nn),Ar=Ar===null?null:Ar.stateNode,Ar},reactDom_production_min.flushSync=function(Ar){return cl(Ar)},reactDom_production_min.hydrate=function(Ar,nn,un){if(!Yu(nn))throw Error(Be(200));return Zu(null,Ar,nn,!0,un)},reactDom_production_min.hydrateRoot=function(Ar,nn,un){if(!Cd(Ar))throw Error(Be(405));var vn=un!=null&&un.hydratedSources||null,En=!1,$n="",jn=Np;if(un!=null&&(un.unstable_strictMode===!0&&(En=!0),un.identifierPrefix!==void 0&&($n=un.identifierPrefix),un.onRecoverableError!==void 0&&(jn=un.onRecoverableError)),nn=Vp(nn,null,Ar,1,un??null,En,!1,$n,jn),Ar[Cs]=nn.current,Gl(Ar),vn)for(Ar=0;Ar<vn.length;Ar++)un=vn[Ar],En=un._getVersion,En=En(un._source),nn.mutableSourceEagerHydrationData==null?nn.mutableSourceEagerHydrationData=[un,En]:nn.mutableSourceEagerHydrationData.push(un,En);return new Ku(nn)},reactDom_production_min.render=function(Ar,nn,un){if(!Yu(nn))throw Error(Be(200));return Zu(null,Ar,nn,!1,un)},reactDom_production_min.unmountComponentAtNode=function(Ar){if(!Yu(Ar))throw Error(Be(40));return Ar._reactRootContainer?(cl(function(){Zu(null,null,Ar,!1,function(){Ar._reactRootContainer=null,Ar[Cs]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=yd,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(Ar,nn,un,vn){if(!Yu(un))throw Error(Be(200));if(Ar==null||Ar._reactInternals===void 0)throw Error(Be(38));return Zu(Ar,nn,un,!1,vn)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function $e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($e)}catch(Se){console.error(Se)}}return $e(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var reactDomExports=requireReactDom();const ReactDOM=getDefaultExportFromCjs(reactDomExports);Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52));Number.isInteger===void 0&&(Number.isInteger=function($e){return typeof $e=="number"&&isFinite($e)&&Math.floor($e)===$e});Math.sign===void 0&&(Math.sign=function($e){return $e<0?-1:$e>0?1:+$e});"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});Object.assign===void 0&&(Object.assign=function($e){if($e==null)throw new TypeError("Cannot convert undefined or null to object");const Se=Object($e);for(let Be=1;Be<arguments.length;Be++){const De=arguments[Be];if(De!=null)for(const Ve in De)Object.prototype.hasOwnProperty.call(De,Ve)&&(Se[Ve]=De[Ve])}return Se});const REVISION="117",CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,FlatShading=1,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,Uncharted2ToneMapping=3,CineonToneMapping=4,ACESFilmicToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,SphericalReflectionMapping=305,CubeUVReflectionMapping=306,CubeUVRefractionMapping=307,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipmapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipmapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedShort565Type=1019,UnsignedInt248Type=1020,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,RGBEFormat=RGBAFormat,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBIntegerFormat=1032,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,SRGB8_ALPHA8_ASTC_4x4_Format=37840,SRGB8_ALPHA8_ASTC_5x4_Format=37841,SRGB8_ALPHA8_ASTC_5x5_Format=37842,SRGB8_ALPHA8_ASTC_6x5_Format=37843,SRGB8_ALPHA8_ASTC_6x6_Format=37844,SRGB8_ALPHA8_ASTC_8x5_Format=37845,SRGB8_ALPHA8_ASTC_8x6_Format=37846,SRGB8_ALPHA8_ASTC_8x8_Format=37847,SRGB8_ALPHA8_ASTC_10x5_Format=37848,SRGB8_ALPHA8_ASTC_10x6_Format=37849,SRGB8_ALPHA8_ASTC_10x8_Format=37850,SRGB8_ALPHA8_ASTC_10x10_Format=37851,SRGB8_ALPHA8_ASTC_12x10_Format=37852,SRGB8_ALPHA8_ASTC_12x12_Format=37853,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding=3e3,sRGBEncoding=3001,GammaEncoding=3007,RGBEEncoding=3002,LogLuvEncoding=3003,RGBM7Encoding=3004,RGBM16Encoding=3005,RGBDEncoding=3006,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,KeepStencilOp=7680,ReplaceStencilOp=7681,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,StaticDrawUsage=35044,DynamicDrawUsage=35048;function EventDispatcher(){}Object.assign(EventDispatcher.prototype,{addEventListener:function($e,Se){this._listeners===void 0&&(this._listeners={});var Be=this._listeners;Be[$e]===void 0&&(Be[$e]=[]),Be[$e].indexOf(Se)===-1&&Be[$e].push(Se)},hasEventListener:function($e,Se){if(this._listeners===void 0)return!1;var Be=this._listeners;return Be[$e]!==void 0&&Be[$e].indexOf(Se)!==-1},removeEventListener:function($e,Se){if(this._listeners!==void 0){var Be=this._listeners,De=Be[$e];if(De!==void 0){var Ve=De.indexOf(Se);Ve!==-1&&De.splice(Ve,1)}}},dispatchEvent:function($e){if(this._listeners!==void 0){var Se=this._listeners,Be=Se[$e.type];if(Be!==void 0){$e.target=this;for(var De=Be.slice(0),Ve=0,Fe=De.length;Ve<Fe;Ve++)De[Ve].call(this,$e)}}}});var _lut=[];for(var i$C=0;i$C<256;i$C++)_lut[i$C]=(i$C<16?"0":"")+i$C.toString(16);var MathUtils={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var $e=Math.random()*4294967295|0,Se=Math.random()*4294967295|0,Be=Math.random()*4294967295|0,De=Math.random()*4294967295|0,Ve=_lut[$e&255]+_lut[$e>>8&255]+_lut[$e>>16&255]+_lut[$e>>24&255]+"-"+_lut[Se&255]+_lut[Se>>8&255]+"-"+_lut[Se>>16&15|64]+_lut[Se>>24&255]+"-"+_lut[Be&63|128]+_lut[Be>>8&255]+"-"+_lut[Be>>16&255]+_lut[Be>>24&255]+_lut[De&255]+_lut[De>>8&255]+_lut[De>>16&255]+_lut[De>>24&255];return Ve.toUpperCase()},clamp:function($e,Se,Be){return Math.max(Se,Math.min(Be,$e))},euclideanModulo:function($e,Se){return($e%Se+Se)%Se},mapLinear:function($e,Se,Be,De,Ve){return De+($e-Se)*(Ve-De)/(Be-Se)},lerp:function($e,Se,Be){return(1-Be)*$e+Be*Se},smoothstep:function($e,Se,Be){return $e<=Se?0:$e>=Be?1:($e=($e-Se)/(Be-Se),$e*$e*(3-2*$e))},smootherstep:function($e,Se,Be){return $e<=Se?0:$e>=Be?1:($e=($e-Se)/(Be-Se),$e*$e*$e*($e*($e*6-15)+10))},randInt:function($e,Se){return $e+Math.floor(Math.random()*(Se-$e+1))},randFloat:function($e,Se){return $e+Math.random()*(Se-$e)},randFloatSpread:function($e){return $e*(.5-Math.random())},degToRad:function($e){return $e*MathUtils.DEG2RAD},radToDeg:function($e){return $e*MathUtils.RAD2DEG},isPowerOfTwo:function($e){return($e&$e-1)===0&&$e!==0},ceilPowerOfTwo:function($e){return Math.pow(2,Math.ceil(Math.log($e)/Math.LN2))},floorPowerOfTwo:function($e){return Math.pow(2,Math.floor(Math.log($e)/Math.LN2))},setQuaternionFromProperEuler:function($e,Se,Be,De,Ve){var Fe=Math.cos,Je=Math.sin,Xe=Fe(Be/2),Ke=Je(Be/2),Ye=Fe((Se+De)/2),or=Je((Se+De)/2),sr=Fe((Se-De)/2),cr=Je((Se-De)/2),Br=Fe((De-Se)/2),tn=Je((De-Se)/2);switch(Ve){case"XYX":$e.set(Xe*or,Ke*sr,Ke*cr,Xe*Ye);break;case"YZY":$e.set(Ke*cr,Xe*or,Ke*sr,Xe*Ye);break;case"ZXZ":$e.set(Ke*sr,Ke*cr,Xe*or,Xe*Ye);break;case"XZX":$e.set(Xe*or,Ke*tn,Ke*Br,Xe*Ye);break;case"YXY":$e.set(Ke*Br,Xe*or,Ke*tn,Xe*Ye);break;case"ZYZ":$e.set(Ke*tn,Ke*Br,Xe*or,Xe*Ye);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+Ve)}}};function Vector2($e,Se){this.x=$e||0,this.y=Se||0}Object.defineProperties(Vector2.prototype,{width:{get:function(){return this.x},set:function($e){this.x=$e}},height:{get:function(){return this.y},set:function($e){this.y=$e}}});Object.assign(Vector2.prototype,{isVector2:!0,set:function($e,Se){return this.x=$e,this.y=Se,this},setScalar:function($e){return this.x=$e,this.y=$e,this},setX:function($e){return this.x=$e,this},setY:function($e){return this.y=$e,this},setComponent:function($e,Se){switch($e){case 0:this.x=Se;break;case 1:this.y=Se;break;default:throw new Error("index is out of range: "+$e)}return this},getComponent:function($e){switch($e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+$e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function($e){return this.x=$e.x,this.y=$e.y,this},add:function($e,Se){return Se!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors($e,Se)):(this.x+=$e.x,this.y+=$e.y,this)},addScalar:function($e){return this.x+=$e,this.y+=$e,this},addVectors:function($e,Se){return this.x=$e.x+Se.x,this.y=$e.y+Se.y,this},addScaledVector:function($e,Se){return this.x+=$e.x*Se,this.y+=$e.y*Se,this},sub:function($e,Se){return Se!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors($e,Se)):(this.x-=$e.x,this.y-=$e.y,this)},subScalar:function($e){return this.x-=$e,this.y-=$e,this},subVectors:function($e,Se){return this.x=$e.x-Se.x,this.y=$e.y-Se.y,this},multiply:function($e){return this.x*=$e.x,this.y*=$e.y,this},multiplyScalar:function($e){return this.x*=$e,this.y*=$e,this},divide:function($e){return this.x/=$e.x,this.y/=$e.y,this},divideScalar:function($e){return this.multiplyScalar(1/$e)},applyMatrix3:function($e){var Se=this.x,Be=this.y,De=$e.elements;return this.x=De[0]*Se+De[3]*Be+De[6],this.y=De[1]*Se+De[4]*Be+De[7],this},min:function($e){return this.x=Math.min(this.x,$e.x),this.y=Math.min(this.y,$e.y),this},max:function($e){return this.x=Math.max(this.x,$e.x),this.y=Math.max(this.y,$e.y),this},clamp:function($e,Se){return this.x=Math.max($e.x,Math.min(Se.x,this.x)),this.y=Math.max($e.y,Math.min(Se.y,this.y)),this},clampScalar:function($e,Se){return this.x=Math.max($e,Math.min(Se,this.x)),this.y=Math.max($e,Math.min(Se,this.y)),this},clampLength:function($e,Se){var Be=this.length();return this.divideScalar(Be||1).multiplyScalar(Math.max($e,Math.min(Se,Be)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function($e){return this.x*$e.x+this.y*$e.y},cross:function($e){return this.x*$e.y-this.y*$e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var $e=Math.atan2(-this.y,-this.x)+Math.PI;return $e},distanceTo:function($e){return Math.sqrt(this.distanceToSquared($e))},distanceToSquared:function($e){var Se=this.x-$e.x,Be=this.y-$e.y;return Se*Se+Be*Be},manhattanDistanceTo:function($e){return Math.abs(this.x-$e.x)+Math.abs(this.y-$e.y)},setLength:function($e){return this.normalize().multiplyScalar($e)},lerp:function($e,Se){return this.x+=($e.x-this.x)*Se,this.y+=($e.y-this.y)*Se,this},lerpVectors:function($e,Se,Be){return this.x=$e.x+(Se.x-$e.x)*Be,this.y=$e.y+(Se.y-$e.y)*Be,this},equals:function($e){return $e.x===this.x&&$e.y===this.y},fromArray:function($e,Se){return Se===void 0&&(Se=0),this.x=$e[Se],this.y=$e[Se+1],this},toArray:function($e,Se){return $e===void 0&&($e=[]),Se===void 0&&(Se=0),$e[Se]=this.x,$e[Se+1]=this.y,$e},fromBufferAttribute:function($e,Se,Be){return Be!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=$e.getX(Se),this.y=$e.getY(Se),this},rotateAround:function($e,Se){var Be=Math.cos(Se),De=Math.sin(Se),Ve=this.x-$e.x,Fe=this.y-$e.y;return this.x=Ve*Be-Fe*De+$e.x,this.y=Ve*De+Fe*Be+$e.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}});function Matrix3(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Matrix3.prototype,{isMatrix3:!0,set:function($e,Se,Be,De,Ve,Fe,Je,Xe,Ke){var Ye=this.elements;return Ye[0]=$e,Ye[1]=De,Ye[2]=Je,Ye[3]=Se,Ye[4]=Ve,Ye[5]=Xe,Ye[6]=Be,Ye[7]=Fe,Ye[8]=Ke,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function($e){var Se=this.elements,Be=$e.elements;return Se[0]=Be[0],Se[1]=Be[1],Se[2]=Be[2],Se[3]=Be[3],Se[4]=Be[4],Se[5]=Be[5],Se[6]=Be[6],Se[7]=Be[7],Se[8]=Be[8],this},extractBasis:function($e,Se,Be){return $e.setFromMatrix3Column(this,0),Se.setFromMatrix3Column(this,1),Be.setFromMatrix3Column(this,2),this},setFromMatrix4:function($e){var Se=$e.elements;return this.set(Se[0],Se[4],Se[8],Se[1],Se[5],Se[9],Se[2],Se[6],Se[10]),this},multiply:function($e){return this.multiplyMatrices(this,$e)},premultiply:function($e){return this.multiplyMatrices($e,this)},multiplyMatrices:function($e,Se){var Be=$e.elements,De=Se.elements,Ve=this.elements,Fe=Be[0],Je=Be[3],Xe=Be[6],Ke=Be[1],Ye=Be[4],or=Be[7],sr=Be[2],cr=Be[5],Br=Be[8],tn=De[0],en=De[3],an=De[6],rn=De[1],on=De[4],sn=De[7],ln=De[2],cn=De[5],hn=De[8];return Ve[0]=Fe*tn+Je*rn+Xe*ln,Ve[3]=Fe*en+Je*on+Xe*cn,Ve[6]=Fe*an+Je*sn+Xe*hn,Ve[1]=Ke*tn+Ye*rn+or*ln,Ve[4]=Ke*en+Ye*on+or*cn,Ve[7]=Ke*an+Ye*sn+or*hn,Ve[2]=sr*tn+cr*rn+Br*ln,Ve[5]=sr*en+cr*on+Br*cn,Ve[8]=sr*an+cr*sn+Br*hn,this},multiplyScalar:function($e){var Se=this.elements;return Se[0]*=$e,Se[3]*=$e,Se[6]*=$e,Se[1]*=$e,Se[4]*=$e,Se[7]*=$e,Se[2]*=$e,Se[5]*=$e,Se[8]*=$e,this},determinant:function(){var $e=this.elements,Se=$e[0],Be=$e[1],De=$e[2],Ve=$e[3],Fe=$e[4],Je=$e[5],Xe=$e[6],Ke=$e[7],Ye=$e[8];return Se*Fe*Ye-Se*Je*Ke-Be*Ve*Ye+Be*Je*Xe+De*Ve*Ke-De*Fe*Xe},getInverse:function($e,Se){Se!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var Be=$e.elements,De=this.elements,Ve=Be[0],Fe=Be[1],Je=Be[2],Xe=Be[3],Ke=Be[4],Ye=Be[5],or=Be[6],sr=Be[7],cr=Be[8],Br=cr*Ke-Ye*sr,tn=Ye*or-cr*Xe,en=sr*Xe-Ke*or,an=Ve*Br+Fe*tn+Je*en;if(an===0)return this.set(0,0,0,0,0,0,0,0,0);var rn=1/an;return De[0]=Br*rn,De[1]=(Je*sr-cr*Fe)*rn,De[2]=(Ye*Fe-Je*Ke)*rn,De[3]=tn*rn,De[4]=(cr*Ve-Je*or)*rn,De[5]=(Je*Xe-Ye*Ve)*rn,De[6]=en*rn,De[7]=(Fe*or-sr*Ve)*rn,De[8]=(Ke*Ve-Fe*Xe)*rn,this},transpose:function(){var $e,Se=this.elements;return $e=Se[1],Se[1]=Se[3],Se[3]=$e,$e=Se[2],Se[2]=Se[6],Se[6]=$e,$e=Se[5],Se[5]=Se[7],Se[7]=$e,this},getNormalMatrix:function($e){return this.setFromMatrix4($e).getInverse(this).transpose()},transposeIntoArray:function($e){var Se=this.elements;return $e[0]=Se[0],$e[1]=Se[3],$e[2]=Se[6],$e[3]=Se[1],$e[4]=Se[4],$e[5]=Se[7],$e[6]=Se[2],$e[7]=Se[5],$e[8]=Se[8],this},setUvTransform:function($e,Se,Be,De,Ve,Fe,Je){var Xe=Math.cos(Ve),Ke=Math.sin(Ve);this.set(Be*Xe,Be*Ke,-Be*(Xe*Fe+Ke*Je)+Fe+$e,-De*Ke,De*Xe,-De*(-Ke*Fe+Xe*Je)+Je+Se,0,0,1)},scale:function($e,Se){var Be=this.elements;return Be[0]*=$e,Be[3]*=$e,Be[6]*=$e,Be[1]*=Se,Be[4]*=Se,Be[7]*=Se,this},rotate:function($e){var Se=Math.cos($e),Be=Math.sin($e),De=this.elements,Ve=De[0],Fe=De[3],Je=De[6],Xe=De[1],Ke=De[4],Ye=De[7];return De[0]=Se*Ve+Be*Xe,De[3]=Se*Fe+Be*Ke,De[6]=Se*Je+Be*Ye,De[1]=-Be*Ve+Se*Xe,De[4]=-Be*Fe+Se*Ke,De[7]=-Be*Je+Se*Ye,this},translate:function($e,Se){var Be=this.elements;return Be[0]+=$e*Be[2],Be[3]+=$e*Be[5],Be[6]+=$e*Be[8],Be[1]+=Se*Be[2],Be[4]+=Se*Be[5],Be[7]+=Se*Be[8],this},equals:function($e){for(var Se=this.elements,Be=$e.elements,De=0;De<9;De++)if(Se[De]!==Be[De])return!1;return!0},fromArray:function($e,Se){Se===void 0&&(Se=0);for(var Be=0;Be<9;Be++)this.elements[Be]=$e[Be+Se];return this},toArray:function($e,Se){$e===void 0&&($e=[]),Se===void 0&&(Se=0);var Be=this.elements;return $e[Se]=Be[0],$e[Se+1]=Be[1],$e[Se+2]=Be[2],$e[Se+3]=Be[3],$e[Se+4]=Be[4],$e[Se+5]=Be[5],$e[Se+6]=Be[6],$e[Se+7]=Be[7],$e[Se+8]=Be[8],$e}});var _canvas,ImageUtils={getDataURL:function($e){var Se;if(typeof HTMLCanvasElement>"u")return $e.src;if($e instanceof HTMLCanvasElement)Se=$e;else{_canvas===void 0&&(_canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),_canvas.width=$e.width,_canvas.height=$e.height;var Be=_canvas.getContext("2d");$e instanceof ImageData?Be.putImageData($e,0,0):Be.drawImage($e,0,0,$e.width,$e.height),Se=_canvas}return Se.width>2048||Se.height>2048?Se.toDataURL("image/jpeg",.6):Se.toDataURL("image/png")}},textureId=0;function Texture($e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye){Object.defineProperty(this,"id",{value:textureId++}),this.uuid=MathUtils.generateUUID(),this.name="",this.image=$e!==void 0?$e:Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=Se!==void 0?Se:Texture.DEFAULT_MAPPING,this.wrapS=Be!==void 0?Be:ClampToEdgeWrapping,this.wrapT=De!==void 0?De:ClampToEdgeWrapping,this.magFilter=Ve!==void 0?Ve:LinearFilter,this.minFilter=Fe!==void 0?Fe:LinearMipmapLinearFilter,this.anisotropy=Ke!==void 0?Ke:1,this.format=Je!==void 0?Je:RGBAFormat,this.internalFormat=null,this.type=Xe!==void 0?Xe:UnsignedByteType,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=Ye!==void 0?Ye:LinearEncoding,this.version=0,this.onUpdate=null}Texture.DEFAULT_IMAGE=void 0;Texture.DEFAULT_MAPPING=UVMapping;Texture.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Texture,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.name=$e.name,this.image=$e.image,this.mipmaps=$e.mipmaps.slice(0),this.mapping=$e.mapping,this.wrapS=$e.wrapS,this.wrapT=$e.wrapT,this.magFilter=$e.magFilter,this.minFilter=$e.minFilter,this.anisotropy=$e.anisotropy,this.format=$e.format,this.internalFormat=$e.internalFormat,this.type=$e.type,this.offset.copy($e.offset),this.repeat.copy($e.repeat),this.center.copy($e.center),this.rotation=$e.rotation,this.matrixAutoUpdate=$e.matrixAutoUpdate,this.matrix.copy($e.matrix),this.generateMipmaps=$e.generateMipmaps,this.premultiplyAlpha=$e.premultiplyAlpha,this.flipY=$e.flipY,this.unpackAlignment=$e.unpackAlignment,this.encoding=$e.encoding,this},toJSON:function($e){var Se=$e===void 0||typeof $e=="string";if(!Se&&$e.textures[this.uuid]!==void 0)return $e.textures[this.uuid];var Be={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var De=this.image;if(De.uuid===void 0&&(De.uuid=MathUtils.generateUUID()),!Se&&$e.images[De.uuid]===void 0){var Ve;if(Array.isArray(De)){Ve=[];for(var Fe=0,Je=De.length;Fe<Je;Fe++)Ve.push(ImageUtils.getDataURL(De[Fe]))}else Ve=ImageUtils.getDataURL(De);$e.images[De.uuid]={uuid:De.uuid,url:Ve}}Be.image=De.uuid}return Se||($e.textures[this.uuid]=Be),Be},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function($e){if(this.mapping!==UVMapping)return $e;if($e.applyMatrix3(this.matrix),$e.x<0||$e.x>1)switch(this.wrapS){case RepeatWrapping:$e.x=$e.x-Math.floor($e.x);break;case ClampToEdgeWrapping:$e.x=$e.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor($e.x)%2)===1?$e.x=Math.ceil($e.x)-$e.x:$e.x=$e.x-Math.floor($e.x);break}if($e.y<0||$e.y>1)switch(this.wrapT){case RepeatWrapping:$e.y=$e.y-Math.floor($e.y);break;case ClampToEdgeWrapping:$e.y=$e.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor($e.y)%2)===1?$e.y=Math.ceil($e.y)-$e.y:$e.y=$e.y-Math.floor($e.y);break}return this.flipY&&($e.y=1-$e.y),$e}});Object.defineProperty(Texture.prototype,"needsUpdate",{set:function($e){$e===!0&&this.version++}});function Vector4($e,Se,Be,De){this.x=$e||0,this.y=Se||0,this.z=Be||0,this.w=De!==void 0?De:1}Object.defineProperties(Vector4.prototype,{width:{get:function(){return this.z},set:function($e){this.z=$e}},height:{get:function(){return this.w},set:function($e){this.w=$e}}});Object.assign(Vector4.prototype,{isVector4:!0,set:function($e,Se,Be,De){return this.x=$e,this.y=Se,this.z=Be,this.w=De,this},setScalar:function($e){return this.x=$e,this.y=$e,this.z=$e,this.w=$e,this},setX:function($e){return this.x=$e,this},setY:function($e){return this.y=$e,this},setZ:function($e){return this.z=$e,this},setW:function($e){return this.w=$e,this},setComponent:function($e,Se){switch($e){case 0:this.x=Se;break;case 1:this.y=Se;break;case 2:this.z=Se;break;case 3:this.w=Se;break;default:throw new Error("index is out of range: "+$e)}return this},getComponent:function($e){switch($e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+$e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function($e){return this.x=$e.x,this.y=$e.y,this.z=$e.z,this.w=$e.w!==void 0?$e.w:1,this},add:function($e,Se){return Se!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors($e,Se)):(this.x+=$e.x,this.y+=$e.y,this.z+=$e.z,this.w+=$e.w,this)},addScalar:function($e){return this.x+=$e,this.y+=$e,this.z+=$e,this.w+=$e,this},addVectors:function($e,Se){return this.x=$e.x+Se.x,this.y=$e.y+Se.y,this.z=$e.z+Se.z,this.w=$e.w+Se.w,this},addScaledVector:function($e,Se){return this.x+=$e.x*Se,this.y+=$e.y*Se,this.z+=$e.z*Se,this.w+=$e.w*Se,this},sub:function($e,Se){return Se!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors($e,Se)):(this.x-=$e.x,this.y-=$e.y,this.z-=$e.z,this.w-=$e.w,this)},subScalar:function($e){return this.x-=$e,this.y-=$e,this.z-=$e,this.w-=$e,this},subVectors:function($e,Se){return this.x=$e.x-Se.x,this.y=$e.y-Se.y,this.z=$e.z-Se.z,this.w=$e.w-Se.w,this},multiplyScalar:function($e){return this.x*=$e,this.y*=$e,this.z*=$e,this.w*=$e,this},applyMatrix4:function($e){var Se=this.x,Be=this.y,De=this.z,Ve=this.w,Fe=$e.elements;return this.x=Fe[0]*Se+Fe[4]*Be+Fe[8]*De+Fe[12]*Ve,this.y=Fe[1]*Se+Fe[5]*Be+Fe[9]*De+Fe[13]*Ve,this.z=Fe[2]*Se+Fe[6]*Be+Fe[10]*De+Fe[14]*Ve,this.w=Fe[3]*Se+Fe[7]*Be+Fe[11]*De+Fe[15]*Ve,this},divideScalar:function($e){return this.multiplyScalar(1/$e)},setAxisAngleFromQuaternion:function($e){this.w=2*Math.acos($e.w);var Se=Math.sqrt(1-$e.w*$e.w);return Se<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=$e.x/Se,this.y=$e.y/Se,this.z=$e.z/Se),this},setAxisAngleFromRotationMatrix:function($e){var Se,Be,De,Ve,Fe=.01,Je=.1,Xe=$e.elements,Ke=Xe[0],Ye=Xe[4],or=Xe[8],sr=Xe[1],cr=Xe[5],Br=Xe[9],tn=Xe[2],en=Xe[6],an=Xe[10];if(Math.abs(Ye-sr)<Fe&&Math.abs(or-tn)<Fe&&Math.abs(Br-en)<Fe){if(Math.abs(Ye+sr)<Je&&Math.abs(or+tn)<Je&&Math.abs(Br+en)<Je&&Math.abs(Ke+cr+an-3)<Je)return this.set(1,0,0,0),this;Se=Math.PI;var rn=(Ke+1)/2,on=(cr+1)/2,sn=(an+1)/2,ln=(Ye+sr)/4,cn=(or+tn)/4,hn=(Br+en)/4;return rn>on&&rn>sn?rn<Fe?(Be=0,De=.707106781,Ve=.707106781):(Be=Math.sqrt(rn),De=ln/Be,Ve=cn/Be):on>sn?on<Fe?(Be=.707106781,De=0,Ve=.707106781):(De=Math.sqrt(on),Be=ln/De,Ve=hn/De):sn<Fe?(Be=.707106781,De=.707106781,Ve=0):(Ve=Math.sqrt(sn),Be=cn/Ve,De=hn/Ve),this.set(Be,De,Ve,Se),this}var mn=Math.sqrt((en-Br)*(en-Br)+(or-tn)*(or-tn)+(sr-Ye)*(sr-Ye));return Math.abs(mn)<.001&&(mn=1),this.x=(en-Br)/mn,this.y=(or-tn)/mn,this.z=(sr-Ye)/mn,this.w=Math.acos((Ke+cr+an-1)/2),this},min:function($e){return this.x=Math.min(this.x,$e.x),this.y=Math.min(this.y,$e.y),this.z=Math.min(this.z,$e.z),this.w=Math.min(this.w,$e.w),this},max:function($e){return this.x=Math.max(this.x,$e.x),this.y=Math.max(this.y,$e.y),this.z=Math.max(this.z,$e.z),this.w=Math.max(this.w,$e.w),this},clamp:function($e,Se){return this.x=Math.max($e.x,Math.min(Se.x,this.x)),this.y=Math.max($e.y,Math.min(Se.y,this.y)),this.z=Math.max($e.z,Math.min(Se.z,this.z)),this.w=Math.max($e.w,Math.min(Se.w,this.w)),this},clampScalar:function($e,Se){return this.x=Math.max($e,Math.min(Se,this.x)),this.y=Math.max($e,Math.min(Se,this.y)),this.z=Math.max($e,Math.min(Se,this.z)),this.w=Math.max($e,Math.min(Se,this.w)),this},clampLength:function($e,Se){var Be=this.length();return this.divideScalar(Be||1).multiplyScalar(Math.max($e,Math.min(Se,Be)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function($e){return this.x*$e.x+this.y*$e.y+this.z*$e.z+this.w*$e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function($e){return this.normalize().multiplyScalar($e)},lerp:function($e,Se){return this.x+=($e.x-this.x)*Se,this.y+=($e.y-this.y)*Se,this.z+=($e.z-this.z)*Se,this.w+=($e.w-this.w)*Se,this},lerpVectors:function($e,Se,Be){return this.x=$e.x+(Se.x-$e.x)*Be,this.y=$e.y+(Se.y-$e.y)*Be,this.z=$e.z+(Se.z-$e.z)*Be,this.w=$e.w+(Se.w-$e.w)*Be,this},equals:function($e){return $e.x===this.x&&$e.y===this.y&&$e.z===this.z&&$e.w===this.w},fromArray:function($e,Se){return Se===void 0&&(Se=0),this.x=$e[Se],this.y=$e[Se+1],this.z=$e[Se+2],this.w=$e[Se+3],this},toArray:function($e,Se){return $e===void 0&&($e=[]),Se===void 0&&(Se=0),$e[Se]=this.x,$e[Se+1]=this.y,$e[Se+2]=this.z,$e[Se+3]=this.w,$e},fromBufferAttribute:function($e,Se,Be){return Be!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=$e.getX(Se),this.y=$e.getY(Se),this.z=$e.getZ(Se),this.w=$e.getW(Se),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}});function WebGLRenderTarget($e,Se,Be){this.width=$e,this.height=Se,this.scissor=new Vector4(0,0,$e,Se),this.scissorTest=!1,this.viewport=new Vector4(0,0,$e,Se),Be=Be||{},this.texture=new Texture(void 0,Be.mapping,Be.wrapS,Be.wrapT,Be.magFilter,Be.minFilter,Be.format,Be.type,Be.anisotropy,Be.encoding),this.texture.image={},this.texture.image.width=$e,this.texture.image.height=Se,this.texture.generateMipmaps=Be.generateMipmaps!==void 0?Be.generateMipmaps:!1,this.texture.minFilter=Be.minFilter!==void 0?Be.minFilter:LinearFilter,this.depthBuffer=Be.depthBuffer!==void 0?Be.depthBuffer:!0,this.stencilBuffer=Be.stencilBuffer!==void 0?Be.stencilBuffer:!0,this.depthTexture=Be.depthTexture!==void 0?Be.depthTexture:null}WebGLRenderTarget.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:WebGLRenderTarget,isWebGLRenderTarget:!0,setSize:function($e,Se){(this.width!==$e||this.height!==Se)&&(this.width=$e,this.height=Se,this.texture.image.width=$e,this.texture.image.height=Se,this.dispose()),this.viewport.set(0,0,$e,Se),this.scissor.set(0,0,$e,Se)},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.width=$e.width,this.height=$e.height,this.viewport.copy($e.viewport),this.texture=$e.texture.clone(),this.depthBuffer=$e.depthBuffer,this.stencilBuffer=$e.stencilBuffer,this.depthTexture=$e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function WebGLMultisampleRenderTarget($e,Se,Be){WebGLRenderTarget.call(this,$e,Se,Be),this.samples=4}WebGLMultisampleRenderTarget.prototype=Object.assign(Object.create(WebGLRenderTarget.prototype),{constructor:WebGLMultisampleRenderTarget,isWebGLMultisampleRenderTarget:!0,copy:function($e){return WebGLRenderTarget.prototype.copy.call(this,$e),this.samples=$e.samples,this}});function Quaternion($e,Se,Be,De){this._x=$e||0,this._y=Se||0,this._z=Be||0,this._w=De!==void 0?De:1}Object.assign(Quaternion,{slerp:function($e,Se,Be,De){return Be.copy($e).slerp(Se,De)},slerpFlat:function($e,Se,Be,De,Ve,Fe,Je){var Xe=Be[De+0],Ke=Be[De+1],Ye=Be[De+2],or=Be[De+3],sr=Ve[Fe+0],cr=Ve[Fe+1],Br=Ve[Fe+2],tn=Ve[Fe+3];if(or!==tn||Xe!==sr||Ke!==cr||Ye!==Br){var en=1-Je,an=Xe*sr+Ke*cr+Ye*Br+or*tn,rn=an>=0?1:-1,on=1-an*an;if(on>Number.EPSILON){var sn=Math.sqrt(on),ln=Math.atan2(sn,an*rn);en=Math.sin(en*ln)/sn,Je=Math.sin(Je*ln)/sn}var cn=Je*rn;if(Xe=Xe*en+sr*cn,Ke=Ke*en+cr*cn,Ye=Ye*en+Br*cn,or=or*en+tn*cn,en===1-Je){var hn=1/Math.sqrt(Xe*Xe+Ke*Ke+Ye*Ye+or*or);Xe*=hn,Ke*=hn,Ye*=hn,or*=hn}}$e[Se]=Xe,$e[Se+1]=Ke,$e[Se+2]=Ye,$e[Se+3]=or},multiplyQuaternionsFlat:function($e,Se,Be,De,Ve,Fe){var Je=Be[De],Xe=Be[De+1],Ke=Be[De+2],Ye=Be[De+3],or=Ve[Fe],sr=Ve[Fe+1],cr=Ve[Fe+2],Br=Ve[Fe+3];return $e[Se]=Je*Br+Ye*or+Xe*cr-Ke*sr,$e[Se+1]=Xe*Br+Ye*sr+Ke*or-Je*cr,$e[Se+2]=Ke*Br+Ye*cr+Je*sr-Xe*or,$e[Se+3]=Ye*Br-Je*or-Xe*sr-Ke*cr,$e}});Object.defineProperties(Quaternion.prototype,{x:{get:function(){return this._x},set:function($e){this._x=$e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function($e){this._y=$e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function($e){this._z=$e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function($e){this._w=$e,this._onChangeCallback()}}});Object.assign(Quaternion.prototype,{isQuaternion:!0,set:function($e,Se,Be,De){return this._x=$e,this._y=Se,this._z=Be,this._w=De,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function($e){return this._x=$e.x,this._y=$e.y,this._z=$e.z,this._w=$e.w,this._onChangeCallback(),this},setFromEuler:function($e,Se){if(!($e&&$e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var Be=$e._x,De=$e._y,Ve=$e._z,Fe=$e.order,Je=Math.cos,Xe=Math.sin,Ke=Je(Be/2),Ye=Je(De/2),or=Je(Ve/2),sr=Xe(Be/2),cr=Xe(De/2),Br=Xe(Ve/2);switch(Fe){case"XYZ":this._x=sr*Ye*or+Ke*cr*Br,this._y=Ke*cr*or-sr*Ye*Br,this._z=Ke*Ye*Br+sr*cr*or,this._w=Ke*Ye*or-sr*cr*Br;break;case"YXZ":this._x=sr*Ye*or+Ke*cr*Br,this._y=Ke*cr*or-sr*Ye*Br,this._z=Ke*Ye*Br-sr*cr*or,this._w=Ke*Ye*or+sr*cr*Br;break;case"ZXY":this._x=sr*Ye*or-Ke*cr*Br,this._y=Ke*cr*or+sr*Ye*Br,this._z=Ke*Ye*Br+sr*cr*or,this._w=Ke*Ye*or-sr*cr*Br;break;case"ZYX":this._x=sr*Ye*or-Ke*cr*Br,this._y=Ke*cr*or+sr*Ye*Br,this._z=Ke*Ye*Br-sr*cr*or,this._w=Ke*Ye*or+sr*cr*Br;break;case"YZX":this._x=sr*Ye*or+Ke*cr*Br,this._y=Ke*cr*or+sr*Ye*Br,this._z=Ke*Ye*Br-sr*cr*or,this._w=Ke*Ye*or-sr*cr*Br;break;case"XZY":this._x=sr*Ye*or-Ke*cr*Br,this._y=Ke*cr*or-sr*Ye*Br,this._z=Ke*Ye*Br+sr*cr*or,this._w=Ke*Ye*or+sr*cr*Br;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+Fe)}return Se!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function($e,Se){var Be=Se/2,De=Math.sin(Be);return this._x=$e.x*De,this._y=$e.y*De,this._z=$e.z*De,this._w=Math.cos(Be),this._onChangeCallback(),this},setFromRotationMatrix:function($e){var Se=$e.elements,Be=Se[0],De=Se[4],Ve=Se[8],Fe=Se[1],Je=Se[5],Xe=Se[9],Ke=Se[2],Ye=Se[6],or=Se[10],sr=Be+Je+or,cr;return sr>0?(cr=.5/Math.sqrt(sr+1),this._w=.25/cr,this._x=(Ye-Xe)*cr,this._y=(Ve-Ke)*cr,this._z=(Fe-De)*cr):Be>Je&&Be>or?(cr=2*Math.sqrt(1+Be-Je-or),this._w=(Ye-Xe)/cr,this._x=.25*cr,this._y=(De+Fe)/cr,this._z=(Ve+Ke)/cr):Je>or?(cr=2*Math.sqrt(1+Je-Be-or),this._w=(Ve-Ke)/cr,this._x=(De+Fe)/cr,this._y=.25*cr,this._z=(Xe+Ye)/cr):(cr=2*Math.sqrt(1+or-Be-Je),this._w=(Fe-De)/cr,this._x=(Ve+Ke)/cr,this._y=(Xe+Ye)/cr,this._z=.25*cr),this._onChangeCallback(),this},setFromUnitVectors:function($e,Se){var Be=1e-6,De=$e.dot(Se)+1;return De<Be?(De=0,Math.abs($e.x)>Math.abs($e.z)?(this._x=-$e.y,this._y=$e.x,this._z=0,this._w=De):(this._x=0,this._y=-$e.z,this._z=$e.y,this._w=De)):(this._x=$e.y*Se.z-$e.z*Se.y,this._y=$e.z*Se.x-$e.x*Se.z,this._z=$e.x*Se.y-$e.y*Se.x,this._w=De),this.normalize()},angleTo:function($e){return 2*Math.acos(Math.abs(MathUtils.clamp(this.dot($e),-1,1)))},rotateTowards:function($e,Se){var Be=this.angleTo($e);if(Be===0)return this;var De=Math.min(1,Se/Be);return this.slerp($e,De),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function($e){return this._x*$e._x+this._y*$e._y+this._z*$e._z+this._w*$e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var $e=this.length();return $e===0?(this._x=0,this._y=0,this._z=0,this._w=1):($e=1/$e,this._x=this._x*$e,this._y=this._y*$e,this._z=this._z*$e,this._w=this._w*$e),this._onChangeCallback(),this},multiply:function($e,Se){return Se!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions($e,Se)):this.multiplyQuaternions(this,$e)},premultiply:function($e){return this.multiplyQuaternions($e,this)},multiplyQuaternions:function($e,Se){var Be=$e._x,De=$e._y,Ve=$e._z,Fe=$e._w,Je=Se._x,Xe=Se._y,Ke=Se._z,Ye=Se._w;return this._x=Be*Ye+Fe*Je+De*Ke-Ve*Xe,this._y=De*Ye+Fe*Xe+Ve*Je-Be*Ke,this._z=Ve*Ye+Fe*Ke+Be*Xe-De*Je,this._w=Fe*Ye-Be*Je-De*Xe-Ve*Ke,this._onChangeCallback(),this},slerp:function($e,Se){if(Se===0)return this;if(Se===1)return this.copy($e);var Be=this._x,De=this._y,Ve=this._z,Fe=this._w,Je=Fe*$e._w+Be*$e._x+De*$e._y+Ve*$e._z;if(Je<0?(this._w=-$e._w,this._x=-$e._x,this._y=-$e._y,this._z=-$e._z,Je=-Je):this.copy($e),Je>=1)return this._w=Fe,this._x=Be,this._y=De,this._z=Ve,this;var Xe=1-Je*Je;if(Xe<=Number.EPSILON){var Ke=1-Se;return this._w=Ke*Fe+Se*this._w,this._x=Ke*Be+Se*this._x,this._y=Ke*De+Se*this._y,this._z=Ke*Ve+Se*this._z,this.normalize(),this._onChangeCallback(),this}var Ye=Math.sqrt(Xe),or=Math.atan2(Ye,Je),sr=Math.sin((1-Se)*or)/Ye,cr=Math.sin(Se*or)/Ye;return this._w=Fe*sr+this._w*cr,this._x=Be*sr+this._x*cr,this._y=De*sr+this._y*cr,this._z=Ve*sr+this._z*cr,this._onChangeCallback(),this},equals:function($e){return $e._x===this._x&&$e._y===this._y&&$e._z===this._z&&$e._w===this._w},fromArray:function($e,Se){return Se===void 0&&(Se=0),this._x=$e[Se],this._y=$e[Se+1],this._z=$e[Se+2],this._w=$e[Se+3],this._onChangeCallback(),this},toArray:function($e,Se){return $e===void 0&&($e=[]),Se===void 0&&(Se=0),$e[Se]=this._x,$e[Se+1]=this._y,$e[Se+2]=this._z,$e[Se+3]=this._w,$e},fromBufferAttribute:function($e,Se){return this._x=$e.getX(Se),this._y=$e.getY(Se),this._z=$e.getZ(Se),this._w=$e.getW(Se),this},_onChange:function($e){return this._onChangeCallback=$e,this},_onChangeCallback:function(){}});var _vector$1=new Vector3,_quaternion=new Quaternion;function Vector3($e,Se,Be){this.x=$e||0,this.y=Se||0,this.z=Be||0}Object.assign(Vector3.prototype,{isVector3:!0,set:function($e,Se,Be){return this.x=$e,this.y=Se,this.z=Be,this},setScalar:function($e){return this.x=$e,this.y=$e,this.z=$e,this},setX:function($e){return this.x=$e,this},setY:function($e){return this.y=$e,this},setZ:function($e){return this.z=$e,this},setComponent:function($e,Se){switch($e){case 0:this.x=Se;break;case 1:this.y=Se;break;case 2:this.z=Se;break;default:throw new Error("index is out of range: "+$e)}return this},getComponent:function($e){switch($e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+$e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function($e){return this.x=$e.x,this.y=$e.y,this.z=$e.z,this},add:function($e,Se){return Se!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors($e,Se)):(this.x+=$e.x,this.y+=$e.y,this.z+=$e.z,this)},addScalar:function($e){return this.x+=$e,this.y+=$e,this.z+=$e,this},addVectors:function($e,Se){return this.x=$e.x+Se.x,this.y=$e.y+Se.y,this.z=$e.z+Se.z,this},addScaledVector:function($e,Se){return this.x+=$e.x*Se,this.y+=$e.y*Se,this.z+=$e.z*Se,this},sub:function($e,Se){return Se!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors($e,Se)):(this.x-=$e.x,this.y-=$e.y,this.z-=$e.z,this)},subScalar:function($e){return this.x-=$e,this.y-=$e,this.z-=$e,this},subVectors:function($e,Se){return this.x=$e.x-Se.x,this.y=$e.y-Se.y,this.z=$e.z-Se.z,this},multiply:function($e,Se){return Se!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors($e,Se)):(this.x*=$e.x,this.y*=$e.y,this.z*=$e.z,this)},multiplyScalar:function($e){return this.x*=$e,this.y*=$e,this.z*=$e,this},multiplyVectors:function($e,Se){return this.x=$e.x*Se.x,this.y=$e.y*Se.y,this.z=$e.z*Se.z,this},applyEuler:function($e){return $e&&$e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(_quaternion.setFromEuler($e))},applyAxisAngle:function($e,Se){return this.applyQuaternion(_quaternion.setFromAxisAngle($e,Se))},applyMatrix3:function($e){var Se=this.x,Be=this.y,De=this.z,Ve=$e.elements;return this.x=Ve[0]*Se+Ve[3]*Be+Ve[6]*De,this.y=Ve[1]*Se+Ve[4]*Be+Ve[7]*De,this.z=Ve[2]*Se+Ve[5]*Be+Ve[8]*De,this},applyNormalMatrix:function($e){return this.applyMatrix3($e).normalize()},applyMatrix4:function($e){var Se=this.x,Be=this.y,De=this.z,Ve=$e.elements,Fe=1/(Ve[3]*Se+Ve[7]*Be+Ve[11]*De+Ve[15]);return this.x=(Ve[0]*Se+Ve[4]*Be+Ve[8]*De+Ve[12])*Fe,this.y=(Ve[1]*Se+Ve[5]*Be+Ve[9]*De+Ve[13])*Fe,this.z=(Ve[2]*Se+Ve[6]*Be+Ve[10]*De+Ve[14])*Fe,this},applyQuaternion:function($e){var Se=this.x,Be=this.y,De=this.z,Ve=$e.x,Fe=$e.y,Je=$e.z,Xe=$e.w,Ke=Xe*Se+Fe*De-Je*Be,Ye=Xe*Be+Je*Se-Ve*De,or=Xe*De+Ve*Be-Fe*Se,sr=-Ve*Se-Fe*Be-Je*De;return this.x=Ke*Xe+sr*-Ve+Ye*-Je-or*-Fe,this.y=Ye*Xe+sr*-Fe+or*-Ve-Ke*-Je,this.z=or*Xe+sr*-Je+Ke*-Fe-Ye*-Ve,this},project:function($e){return this.applyMatrix4($e.matrixWorldInverse).applyMatrix4($e.projectionMatrix)},unproject:function($e){return this.applyMatrix4($e.projectionMatrixInverse).applyMatrix4($e.matrixWorld)},transformDirection:function($e){var Se=this.x,Be=this.y,De=this.z,Ve=$e.elements;return this.x=Ve[0]*Se+Ve[4]*Be+Ve[8]*De,this.y=Ve[1]*Se+Ve[5]*Be+Ve[9]*De,this.z=Ve[2]*Se+Ve[6]*Be+Ve[10]*De,this.normalize()},divide:function($e){return this.x/=$e.x,this.y/=$e.y,this.z/=$e.z,this},divideScalar:function($e){return this.multiplyScalar(1/$e)},min:function($e){return this.x=Math.min(this.x,$e.x),this.y=Math.min(this.y,$e.y),this.z=Math.min(this.z,$e.z),this},max:function($e){return this.x=Math.max(this.x,$e.x),this.y=Math.max(this.y,$e.y),this.z=Math.max(this.z,$e.z),this},clamp:function($e,Se){return this.x=Math.max($e.x,Math.min(Se.x,this.x)),this.y=Math.max($e.y,Math.min(Se.y,this.y)),this.z=Math.max($e.z,Math.min(Se.z,this.z)),this},clampScalar:function($e,Se){return this.x=Math.max($e,Math.min(Se,this.x)),this.y=Math.max($e,Math.min(Se,this.y)),this.z=Math.max($e,Math.min(Se,this.z)),this},clampLength:function($e,Se){var Be=this.length();return this.divideScalar(Be||1).multiplyScalar(Math.max($e,Math.min(Se,Be)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function($e){return this.x*$e.x+this.y*$e.y+this.z*$e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function($e){return this.normalize().multiplyScalar($e)},lerp:function($e,Se){return this.x+=($e.x-this.x)*Se,this.y+=($e.y-this.y)*Se,this.z+=($e.z-this.z)*Se,this},lerpVectors:function($e,Se,Be){return this.x=$e.x+(Se.x-$e.x)*Be,this.y=$e.y+(Se.y-$e.y)*Be,this.z=$e.z+(Se.z-$e.z)*Be,this},cross:function($e,Se){return Se!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors($e,Se)):this.crossVectors(this,$e)},crossVectors:function($e,Se){var Be=$e.x,De=$e.y,Ve=$e.z,Fe=Se.x,Je=Se.y,Xe=Se.z;return this.x=De*Xe-Ve*Je,this.y=Ve*Fe-Be*Xe,this.z=Be*Je-De*Fe,this},projectOnVector:function($e){var Se=$e.lengthSq();if(Se===0)return this.set(0,0,0);var Be=$e.dot(this)/Se;return this.copy($e).multiplyScalar(Be)},projectOnPlane:function($e){return _vector$1.copy(this).projectOnVector($e),this.sub(_vector$1)},reflect:function($e){return this.sub(_vector$1.copy($e).multiplyScalar(2*this.dot($e)))},angleTo:function($e){var Se=Math.sqrt(this.lengthSq()*$e.lengthSq());if(Se===0)return Math.PI/2;var Be=this.dot($e)/Se;return Math.acos(MathUtils.clamp(Be,-1,1))},distanceTo:function($e){return Math.sqrt(this.distanceToSquared($e))},distanceToSquared:function($e){var Se=this.x-$e.x,Be=this.y-$e.y,De=this.z-$e.z;return Se*Se+Be*Be+De*De},manhattanDistanceTo:function($e){return Math.abs(this.x-$e.x)+Math.abs(this.y-$e.y)+Math.abs(this.z-$e.z)},setFromSpherical:function($e){return this.setFromSphericalCoords($e.radius,$e.phi,$e.theta)},setFromSphericalCoords:function($e,Se,Be){var De=Math.sin(Se)*$e;return this.x=De*Math.sin(Be),this.y=Math.cos(Se)*$e,this.z=De*Math.cos(Be),this},setFromCylindrical:function($e){return this.setFromCylindricalCoords($e.radius,$e.theta,$e.y)},setFromCylindricalCoords:function($e,Se,Be){return this.x=$e*Math.sin(Se),this.y=Be,this.z=$e*Math.cos(Se),this},setFromMatrixPosition:function($e){var Se=$e.elements;return this.x=Se[12],this.y=Se[13],this.z=Se[14],this},setFromMatrixScale:function($e){var Se=this.setFromMatrixColumn($e,0).length(),Be=this.setFromMatrixColumn($e,1).length(),De=this.setFromMatrixColumn($e,2).length();return this.x=Se,this.y=Be,this.z=De,this},setFromMatrixColumn:function($e,Se){return this.fromArray($e.elements,Se*4)},setFromMatrix3Column:function($e,Se){return this.fromArray($e.elements,Se*3)},equals:function($e){return $e.x===this.x&&$e.y===this.y&&$e.z===this.z},fromArray:function($e,Se){return Se===void 0&&(Se=0),this.x=$e[Se],this.y=$e[Se+1],this.z=$e[Se+2],this},toArray:function($e,Se){return $e===void 0&&($e=[]),Se===void 0&&(Se=0),$e[Se]=this.x,$e[Se+1]=this.y,$e[Se+2]=this.z,$e},fromBufferAttribute:function($e,Se,Be){return Be!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=$e.getX(Se),this.y=$e.getY(Se),this.z=$e.getZ(Se),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var _v1=new Vector3,_m1=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3;function Matrix4(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Matrix4.prototype,{isMatrix4:!0,set:function($e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en){var an=this.elements;return an[0]=$e,an[4]=Se,an[8]=Be,an[12]=De,an[1]=Ve,an[5]=Fe,an[9]=Je,an[13]=Xe,an[2]=Ke,an[6]=Ye,an[10]=or,an[14]=sr,an[3]=cr,an[7]=Br,an[11]=tn,an[15]=en,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new Matrix4().fromArray(this.elements)},copy:function($e){var Se=this.elements,Be=$e.elements;return Se[0]=Be[0],Se[1]=Be[1],Se[2]=Be[2],Se[3]=Be[3],Se[4]=Be[4],Se[5]=Be[5],Se[6]=Be[6],Se[7]=Be[7],Se[8]=Be[8],Se[9]=Be[9],Se[10]=Be[10],Se[11]=Be[11],Se[12]=Be[12],Se[13]=Be[13],Se[14]=Be[14],Se[15]=Be[15],this},copyPosition:function($e){var Se=this.elements,Be=$e.elements;return Se[12]=Be[12],Se[13]=Be[13],Se[14]=Be[14],this},extractBasis:function($e,Se,Be){return $e.setFromMatrixColumn(this,0),Se.setFromMatrixColumn(this,1),Be.setFromMatrixColumn(this,2),this},makeBasis:function($e,Se,Be){return this.set($e.x,Se.x,Be.x,0,$e.y,Se.y,Be.y,0,$e.z,Se.z,Be.z,0,0,0,0,1),this},extractRotation:function($e){var Se=this.elements,Be=$e.elements,De=1/_v1.setFromMatrixColumn($e,0).length(),Ve=1/_v1.setFromMatrixColumn($e,1).length(),Fe=1/_v1.setFromMatrixColumn($e,2).length();return Se[0]=Be[0]*De,Se[1]=Be[1]*De,Se[2]=Be[2]*De,Se[3]=0,Se[4]=Be[4]*Ve,Se[5]=Be[5]*Ve,Se[6]=Be[6]*Ve,Se[7]=0,Se[8]=Be[8]*Fe,Se[9]=Be[9]*Fe,Se[10]=Be[10]*Fe,Se[11]=0,Se[12]=0,Se[13]=0,Se[14]=0,Se[15]=1,this},makeRotationFromEuler:function($e){$e&&$e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var Se=this.elements,Be=$e.x,De=$e.y,Ve=$e.z,Fe=Math.cos(Be),Je=Math.sin(Be),Xe=Math.cos(De),Ke=Math.sin(De),Ye=Math.cos(Ve),or=Math.sin(Ve);if($e.order==="XYZ"){var sr=Fe*Ye,cr=Fe*or,Br=Je*Ye,tn=Je*or;Se[0]=Xe*Ye,Se[4]=-Xe*or,Se[8]=Ke,Se[1]=cr+Br*Ke,Se[5]=sr-tn*Ke,Se[9]=-Je*Xe,Se[2]=tn-sr*Ke,Se[6]=Br+cr*Ke,Se[10]=Fe*Xe}else if($e.order==="YXZ"){var en=Xe*Ye,an=Xe*or,rn=Ke*Ye,on=Ke*or;Se[0]=en+on*Je,Se[4]=rn*Je-an,Se[8]=Fe*Ke,Se[1]=Fe*or,Se[5]=Fe*Ye,Se[9]=-Je,Se[2]=an*Je-rn,Se[6]=on+en*Je,Se[10]=Fe*Xe}else if($e.order==="ZXY"){var en=Xe*Ye,an=Xe*or,rn=Ke*Ye,on=Ke*or;Se[0]=en-on*Je,Se[4]=-Fe*or,Se[8]=rn+an*Je,Se[1]=an+rn*Je,Se[5]=Fe*Ye,Se[9]=on-en*Je,Se[2]=-Fe*Ke,Se[6]=Je,Se[10]=Fe*Xe}else if($e.order==="ZYX"){var sr=Fe*Ye,cr=Fe*or,Br=Je*Ye,tn=Je*or;Se[0]=Xe*Ye,Se[4]=Br*Ke-cr,Se[8]=sr*Ke+tn,Se[1]=Xe*or,Se[5]=tn*Ke+sr,Se[9]=cr*Ke-Br,Se[2]=-Ke,Se[6]=Je*Xe,Se[10]=Fe*Xe}else if($e.order==="YZX"){var sn=Fe*Xe,ln=Fe*Ke,cn=Je*Xe,hn=Je*Ke;Se[0]=Xe*Ye,Se[4]=hn-sn*or,Se[8]=cn*or+ln,Se[1]=or,Se[5]=Fe*Ye,Se[9]=-Je*Ye,Se[2]=-Ke*Ye,Se[6]=ln*or+cn,Se[10]=sn-hn*or}else if($e.order==="XZY"){var sn=Fe*Xe,ln=Fe*Ke,cn=Je*Xe,hn=Je*Ke;Se[0]=Xe*Ye,Se[4]=-or,Se[8]=Ke*Ye,Se[1]=sn*or+hn,Se[5]=Fe*Ye,Se[9]=ln*or-cn,Se[2]=cn*or-ln,Se[6]=Je*Ye,Se[10]=hn*or+sn}return Se[3]=0,Se[7]=0,Se[11]=0,Se[12]=0,Se[13]=0,Se[14]=0,Se[15]=1,this},makeRotationFromQuaternion:function($e){return this.compose(_zero,$e,_one)},lookAt:function($e,Se,Be){var De=this.elements;return _z.subVectors($e,Se),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(Be,_z),_x.lengthSq()===0&&(Math.abs(Be.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(Be,_z)),_x.normalize(),_y.crossVectors(_z,_x),De[0]=_x.x,De[4]=_y.x,De[8]=_z.x,De[1]=_x.y,De[5]=_y.y,De[9]=_z.y,De[2]=_x.z,De[6]=_y.z,De[10]=_z.z,this},multiply:function($e,Se){return Se!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices($e,Se)):this.multiplyMatrices(this,$e)},premultiply:function($e){return this.multiplyMatrices($e,this)},multiplyMatrices:function($e,Se){var Be=$e.elements,De=Se.elements,Ve=this.elements,Fe=Be[0],Je=Be[4],Xe=Be[8],Ke=Be[12],Ye=Be[1],or=Be[5],sr=Be[9],cr=Be[13],Br=Be[2],tn=Be[6],en=Be[10],an=Be[14],rn=Be[3],on=Be[7],sn=Be[11],ln=Be[15],cn=De[0],hn=De[4],mn=De[8],An=De[12],xn=De[1],pn=De[5],dn=De[9],fn=De[13],yn=De[2],Sn=De[6],gn=De[10],Cn=De[14],Mn=De[3],Bn=De[7],kn=De[11],Ln=De[15];return Ve[0]=Fe*cn+Je*xn+Xe*yn+Ke*Mn,Ve[4]=Fe*hn+Je*pn+Xe*Sn+Ke*Bn,Ve[8]=Fe*mn+Je*dn+Xe*gn+Ke*kn,Ve[12]=Fe*An+Je*fn+Xe*Cn+Ke*Ln,Ve[1]=Ye*cn+or*xn+sr*yn+cr*Mn,Ve[5]=Ye*hn+or*pn+sr*Sn+cr*Bn,Ve[9]=Ye*mn+or*dn+sr*gn+cr*kn,Ve[13]=Ye*An+or*fn+sr*Cn+cr*Ln,Ve[2]=Br*cn+tn*xn+en*yn+an*Mn,Ve[6]=Br*hn+tn*pn+en*Sn+an*Bn,Ve[10]=Br*mn+tn*dn+en*gn+an*kn,Ve[14]=Br*An+tn*fn+en*Cn+an*Ln,Ve[3]=rn*cn+on*xn+sn*yn+ln*Mn,Ve[7]=rn*hn+on*pn+sn*Sn+ln*Bn,Ve[11]=rn*mn+on*dn+sn*gn+ln*kn,Ve[15]=rn*An+on*fn+sn*Cn+ln*Ln,this},multiplyScalar:function($e){var Se=this.elements;return Se[0]*=$e,Se[4]*=$e,Se[8]*=$e,Se[12]*=$e,Se[1]*=$e,Se[5]*=$e,Se[9]*=$e,Se[13]*=$e,Se[2]*=$e,Se[6]*=$e,Se[10]*=$e,Se[14]*=$e,Se[3]*=$e,Se[7]*=$e,Se[11]*=$e,Se[15]*=$e,this},determinant:function(){var $e=this.elements,Se=$e[0],Be=$e[4],De=$e[8],Ve=$e[12],Fe=$e[1],Je=$e[5],Xe=$e[9],Ke=$e[13],Ye=$e[2],or=$e[6],sr=$e[10],cr=$e[14],Br=$e[3],tn=$e[7],en=$e[11],an=$e[15];return Br*(+Ve*Xe*or-De*Ke*or-Ve*Je*sr+Be*Ke*sr+De*Je*cr-Be*Xe*cr)+tn*(+Se*Xe*cr-Se*Ke*sr+Ve*Fe*sr-De*Fe*cr+De*Ke*Ye-Ve*Xe*Ye)+en*(+Se*Ke*or-Se*Je*cr-Ve*Fe*or+Be*Fe*cr+Ve*Je*Ye-Be*Ke*Ye)+an*(-De*Je*Ye-Se*Xe*or+Se*Je*sr+De*Fe*or-Be*Fe*sr+Be*Xe*Ye)},transpose:function(){var $e=this.elements,Se;return Se=$e[1],$e[1]=$e[4],$e[4]=Se,Se=$e[2],$e[2]=$e[8],$e[8]=Se,Se=$e[6],$e[6]=$e[9],$e[9]=Se,Se=$e[3],$e[3]=$e[12],$e[12]=Se,Se=$e[7],$e[7]=$e[13],$e[13]=Se,Se=$e[11],$e[11]=$e[14],$e[14]=Se,this},setPosition:function($e,Se,Be){var De=this.elements;return $e.isVector3?(De[12]=$e.x,De[13]=$e.y,De[14]=$e.z):(De[12]=$e,De[13]=Se,De[14]=Be),this},getInverse:function($e,Se){Se!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var Be=this.elements,De=$e.elements,Ve=De[0],Fe=De[1],Je=De[2],Xe=De[3],Ke=De[4],Ye=De[5],or=De[6],sr=De[7],cr=De[8],Br=De[9],tn=De[10],en=De[11],an=De[12],rn=De[13],on=De[14],sn=De[15],ln=Br*on*sr-rn*tn*sr+rn*or*en-Ye*on*en-Br*or*sn+Ye*tn*sn,cn=an*tn*sr-cr*on*sr-an*or*en+Ke*on*en+cr*or*sn-Ke*tn*sn,hn=cr*rn*sr-an*Br*sr+an*Ye*en-Ke*rn*en-cr*Ye*sn+Ke*Br*sn,mn=an*Br*or-cr*rn*or-an*Ye*tn+Ke*rn*tn+cr*Ye*on-Ke*Br*on,An=Ve*ln+Fe*cn+Je*hn+Xe*mn;if(An===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var xn=1/An;return Be[0]=ln*xn,Be[1]=(rn*tn*Xe-Br*on*Xe-rn*Je*en+Fe*on*en+Br*Je*sn-Fe*tn*sn)*xn,Be[2]=(Ye*on*Xe-rn*or*Xe+rn*Je*sr-Fe*on*sr-Ye*Je*sn+Fe*or*sn)*xn,Be[3]=(Br*or*Xe-Ye*tn*Xe-Br*Je*sr+Fe*tn*sr+Ye*Je*en-Fe*or*en)*xn,Be[4]=cn*xn,Be[5]=(cr*on*Xe-an*tn*Xe+an*Je*en-Ve*on*en-cr*Je*sn+Ve*tn*sn)*xn,Be[6]=(an*or*Xe-Ke*on*Xe-an*Je*sr+Ve*on*sr+Ke*Je*sn-Ve*or*sn)*xn,Be[7]=(Ke*tn*Xe-cr*or*Xe+cr*Je*sr-Ve*tn*sr-Ke*Je*en+Ve*or*en)*xn,Be[8]=hn*xn,Be[9]=(an*Br*Xe-cr*rn*Xe-an*Fe*en+Ve*rn*en+cr*Fe*sn-Ve*Br*sn)*xn,Be[10]=(Ke*rn*Xe-an*Ye*Xe+an*Fe*sr-Ve*rn*sr-Ke*Fe*sn+Ve*Ye*sn)*xn,Be[11]=(cr*Ye*Xe-Ke*Br*Xe-cr*Fe*sr+Ve*Br*sr+Ke*Fe*en-Ve*Ye*en)*xn,Be[12]=mn*xn,Be[13]=(cr*rn*Je-an*Br*Je+an*Fe*tn-Ve*rn*tn-cr*Fe*on+Ve*Br*on)*xn,Be[14]=(an*Ye*Je-Ke*rn*Je-an*Fe*or+Ve*rn*or+Ke*Fe*on-Ve*Ye*on)*xn,Be[15]=(Ke*Br*Je-cr*Ye*Je+cr*Fe*or-Ve*Br*or-Ke*Fe*tn+Ve*Ye*tn)*xn,this},scale:function($e){var Se=this.elements,Be=$e.x,De=$e.y,Ve=$e.z;return Se[0]*=Be,Se[4]*=De,Se[8]*=Ve,Se[1]*=Be,Se[5]*=De,Se[9]*=Ve,Se[2]*=Be,Se[6]*=De,Se[10]*=Ve,Se[3]*=Be,Se[7]*=De,Se[11]*=Ve,this},getMaxScaleOnAxis:function(){var $e=this.elements,Se=$e[0]*$e[0]+$e[1]*$e[1]+$e[2]*$e[2],Be=$e[4]*$e[4]+$e[5]*$e[5]+$e[6]*$e[6],De=$e[8]*$e[8]+$e[9]*$e[9]+$e[10]*$e[10];return Math.sqrt(Math.max(Se,Be,De))},makeTranslation:function($e,Se,Be){return this.set(1,0,0,$e,0,1,0,Se,0,0,1,Be,0,0,0,1),this},makeRotationX:function($e){var Se=Math.cos($e),Be=Math.sin($e);return this.set(1,0,0,0,0,Se,-Be,0,0,Be,Se,0,0,0,0,1),this},makeRotationY:function($e){var Se=Math.cos($e),Be=Math.sin($e);return this.set(Se,0,Be,0,0,1,0,0,-Be,0,Se,0,0,0,0,1),this},makeRotationZ:function($e){var Se=Math.cos($e),Be=Math.sin($e);return this.set(Se,-Be,0,0,Be,Se,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function($e,Se){var Be=Math.cos(Se),De=Math.sin(Se),Ve=1-Be,Fe=$e.x,Je=$e.y,Xe=$e.z,Ke=Ve*Fe,Ye=Ve*Je;return this.set(Ke*Fe+Be,Ke*Je-De*Xe,Ke*Xe+De*Je,0,Ke*Je+De*Xe,Ye*Je+Be,Ye*Xe-De*Fe,0,Ke*Xe-De*Je,Ye*Xe+De*Fe,Ve*Xe*Xe+Be,0,0,0,0,1),this},makeScale:function($e,Se,Be){return this.set($e,0,0,0,0,Se,0,0,0,0,Be,0,0,0,0,1),this},makeShear:function($e,Se,Be){return this.set(1,Se,Be,0,$e,1,Be,0,$e,Se,1,0,0,0,0,1),this},compose:function($e,Se,Be){var De=this.elements,Ve=Se._x,Fe=Se._y,Je=Se._z,Xe=Se._w,Ke=Ve+Ve,Ye=Fe+Fe,or=Je+Je,sr=Ve*Ke,cr=Ve*Ye,Br=Ve*or,tn=Fe*Ye,en=Fe*or,an=Je*or,rn=Xe*Ke,on=Xe*Ye,sn=Xe*or,ln=Be.x,cn=Be.y,hn=Be.z;return De[0]=(1-(tn+an))*ln,De[1]=(cr+sn)*ln,De[2]=(Br-on)*ln,De[3]=0,De[4]=(cr-sn)*cn,De[5]=(1-(sr+an))*cn,De[6]=(en+rn)*cn,De[7]=0,De[8]=(Br+on)*hn,De[9]=(en-rn)*hn,De[10]=(1-(sr+tn))*hn,De[11]=0,De[12]=$e.x,De[13]=$e.y,De[14]=$e.z,De[15]=1,this},decompose:function($e,Se,Be){var De=this.elements,Ve=_v1.set(De[0],De[1],De[2]).length(),Fe=_v1.set(De[4],De[5],De[6]).length(),Je=_v1.set(De[8],De[9],De[10]).length(),Xe=this.determinant();Xe<0&&(Ve=-Ve),$e.x=De[12],$e.y=De[13],$e.z=De[14],_m1.copy(this);var Ke=1/Ve,Ye=1/Fe,or=1/Je;return _m1.elements[0]*=Ke,_m1.elements[1]*=Ke,_m1.elements[2]*=Ke,_m1.elements[4]*=Ye,_m1.elements[5]*=Ye,_m1.elements[6]*=Ye,_m1.elements[8]*=or,_m1.elements[9]*=or,_m1.elements[10]*=or,Se.setFromRotationMatrix(_m1),Be.x=Ve,Be.y=Fe,Be.z=Je,this},makePerspective:function($e,Se,Be,De,Ve,Fe){Fe===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var Je=this.elements,Xe=2*Ve/(Se-$e),Ke=2*Ve/(Be-De),Ye=(Se+$e)/(Se-$e),or=(Be+De)/(Be-De),sr=-(Fe+Ve)/(Fe-Ve),cr=-2*Fe*Ve/(Fe-Ve);return Je[0]=Xe,Je[4]=0,Je[8]=Ye,Je[12]=0,Je[1]=0,Je[5]=Ke,Je[9]=or,Je[13]=0,Je[2]=0,Je[6]=0,Je[10]=sr,Je[14]=cr,Je[3]=0,Je[7]=0,Je[11]=-1,Je[15]=0,this},makeOrthographic:function($e,Se,Be,De,Ve,Fe){var Je=this.elements,Xe=1/(Se-$e),Ke=1/(Be-De),Ye=1/(Fe-Ve),or=(Se+$e)*Xe,sr=(Be+De)*Ke,cr=(Fe+Ve)*Ye;return Je[0]=2*Xe,Je[4]=0,Je[8]=0,Je[12]=-or,Je[1]=0,Je[5]=2*Ke,Je[9]=0,Je[13]=-sr,Je[2]=0,Je[6]=0,Je[10]=-2*Ye,Je[14]=-cr,Je[3]=0,Je[7]=0,Je[11]=0,Je[15]=1,this},equals:function($e){for(var Se=this.elements,Be=$e.elements,De=0;De<16;De++)if(Se[De]!==Be[De])return!1;return!0},fromArray:function($e,Se){Se===void 0&&(Se=0);for(var Be=0;Be<16;Be++)this.elements[Be]=$e[Be+Se];return this},toArray:function($e,Se){$e===void 0&&($e=[]),Se===void 0&&(Se=0);var Be=this.elements;return $e[Se]=Be[0],$e[Se+1]=Be[1],$e[Se+2]=Be[2],$e[Se+3]=Be[3],$e[Se+4]=Be[4],$e[Se+5]=Be[5],$e[Se+6]=Be[6],$e[Se+7]=Be[7],$e[Se+8]=Be[8],$e[Se+9]=Be[9],$e[Se+10]=Be[10],$e[Se+11]=Be[11],$e[Se+12]=Be[12],$e[Se+13]=Be[13],$e[Se+14]=Be[14],$e[Se+15]=Be[15],$e}});var _matrix=new Matrix4,_quaternion$1=new Quaternion;function Euler($e,Se,Be,De){this._x=$e||0,this._y=Se||0,this._z=Be||0,this._order=De||Euler.DefaultOrder}Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];Euler.DefaultOrder="XYZ";Object.defineProperties(Euler.prototype,{x:{get:function(){return this._x},set:function($e){this._x=$e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function($e){this._y=$e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function($e){this._z=$e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function($e){this._order=$e,this._onChangeCallback()}}});Object.assign(Euler.prototype,{isEuler:!0,set:function($e,Se,Be,De){return this._x=$e,this._y=Se,this._z=Be,this._order=De||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function($e){return this._x=$e._x,this._y=$e._y,this._z=$e._z,this._order=$e._order,this._onChangeCallback(),this},setFromRotationMatrix:function($e,Se,Be){var De=MathUtils.clamp,Ve=$e.elements,Fe=Ve[0],Je=Ve[4],Xe=Ve[8],Ke=Ve[1],Ye=Ve[5],or=Ve[9],sr=Ve[2],cr=Ve[6],Br=Ve[10];switch(Se=Se||this._order,Se){case"XYZ":this._y=Math.asin(De(Xe,-1,1)),Math.abs(Xe)<.9999999?(this._x=Math.atan2(-or,Br),this._z=Math.atan2(-Je,Fe)):(this._x=Math.atan2(cr,Ye),this._z=0);break;case"YXZ":this._x=Math.asin(-De(or,-1,1)),Math.abs(or)<.9999999?(this._y=Math.atan2(Xe,Br),this._z=Math.atan2(Ke,Ye)):(this._y=Math.atan2(-sr,Fe),this._z=0);break;case"ZXY":this._x=Math.asin(De(cr,-1,1)),Math.abs(cr)<.9999999?(this._y=Math.atan2(-sr,Br),this._z=Math.atan2(-Je,Ye)):(this._y=0,this._z=Math.atan2(Ke,Fe));break;case"ZYX":this._y=Math.asin(-De(sr,-1,1)),Math.abs(sr)<.9999999?(this._x=Math.atan2(cr,Br),this._z=Math.atan2(Ke,Fe)):(this._x=0,this._z=Math.atan2(-Je,Ye));break;case"YZX":this._z=Math.asin(De(Ke,-1,1)),Math.abs(Ke)<.9999999?(this._x=Math.atan2(-or,Ye),this._y=Math.atan2(-sr,Fe)):(this._x=0,this._y=Math.atan2(Xe,Br));break;case"XZY":this._z=Math.asin(-De(Je,-1,1)),Math.abs(Je)<.9999999?(this._x=Math.atan2(cr,Ye),this._y=Math.atan2(Xe,Fe)):(this._x=Math.atan2(-or,Br),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+Se)}return this._order=Se,Be!==!1&&this._onChangeCallback(),this},setFromQuaternion:function($e,Se,Be){return _matrix.makeRotationFromQuaternion($e),this.setFromRotationMatrix(_matrix,Se,Be)},setFromVector3:function($e,Se){return this.set($e.x,$e.y,$e.z,Se||this._order)},reorder:function($e){return _quaternion$1.setFromEuler(this),this.setFromQuaternion(_quaternion$1,$e)},equals:function($e){return $e._x===this._x&&$e._y===this._y&&$e._z===this._z&&$e._order===this._order},fromArray:function($e){return this._x=$e[0],this._y=$e[1],this._z=$e[2],$e[3]!==void 0&&(this._order=$e[3]),this._onChangeCallback(),this},toArray:function($e,Se){return $e===void 0&&($e=[]),Se===void 0&&(Se=0),$e[Se]=this._x,$e[Se+1]=this._y,$e[Se+2]=this._z,$e[Se+3]=this._order,$e},toVector3:function($e){return $e?$e.set(this._x,this._y,this._z):new Vector3(this._x,this._y,this._z)},_onChange:function($e){return this._onChangeCallback=$e,this},_onChangeCallback:function(){}});function Layers(){this.mask=1}Object.assign(Layers.prototype,{set:function($e){this.mask=1<<$e|0},enable:function($e){this.mask|=1<<$e|0},enableAll:function(){this.mask=-1},toggle:function($e){this.mask^=1<<$e|0},disable:function($e){this.mask&=~(1<<$e|0)},disableAll:function(){this.mask=0},test:function($e){return(this.mask&$e.mask)!==0}});let _object3DId=0;const _v1$1=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position=new Vector3,_scale=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};function Object3D(){Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DefaultUp.clone();var $e=new Vector3,Se=new Euler,Be=new Quaternion,De=new Vector3(1,1,1);function Ve(){Be.setFromEuler(Se,!1)}function Fe(){Se.setFromQuaternion(Be,void 0,!1)}Se._onChange(Ve),Be._onChange(Fe),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:$e},rotation:{configurable:!0,enumerable:!0,value:Se},quaternion:{configurable:!0,enumerable:!0,value:Be},scale:{configurable:!0,enumerable:!0,value:De},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Object3D.DefaultUp=new Vector3(0,1,0);Object3D.DefaultMatrixAutoUpdate=!0;Object3D.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Object3D,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function($e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply($e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function($e){return this.quaternion.premultiply($e),this},setRotationFromAxisAngle:function($e,Se){this.quaternion.setFromAxisAngle($e,Se)},setRotationFromEuler:function($e){this.quaternion.setFromEuler($e,!0)},setRotationFromMatrix:function($e){this.quaternion.setFromRotationMatrix($e)},setRotationFromQuaternion:function($e){this.quaternion.copy($e)},rotateOnAxis:function($e,Se){return _q1.setFromAxisAngle($e,Se),this.quaternion.multiply(_q1),this},rotateOnWorldAxis:function($e,Se){return _q1.setFromAxisAngle($e,Se),this.quaternion.premultiply(_q1),this},rotateX:function($e){return this.rotateOnAxis(_xAxis,$e)},rotateY:function($e){return this.rotateOnAxis(_yAxis,$e)},rotateZ:function($e){return this.rotateOnAxis(_zAxis,$e)},translateOnAxis:function($e,Se){return _v1$1.copy($e).applyQuaternion(this.quaternion),this.position.add(_v1$1.multiplyScalar(Se)),this},translateX:function($e){return this.translateOnAxis(_xAxis,$e)},translateY:function($e){return this.translateOnAxis(_yAxis,$e)},translateZ:function($e){return this.translateOnAxis(_zAxis,$e)},localToWorld:function($e){return $e.applyMatrix4(this.matrixWorld)},worldToLocal:function($e){return $e.applyMatrix4(_m1$1.getInverse(this.matrixWorld))},lookAt:function($e,Se,Be){$e.isVector3?_target.copy($e):_target.set($e,Se,Be);var De=this.parent;this.updateWorldMatrix(!0,!1),_position.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position,_target,this.up):_m1$1.lookAt(_target,_position,this.up),this.quaternion.setFromRotationMatrix(_m1$1),De&&(_m1$1.extractRotation(De.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.inverse()))},add:function($e){if(arguments.length>1){for(var Se=0;Se<arguments.length;Se++)this.add(arguments[Se]);return this}return $e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",$e),this):($e&&$e.isObject3D?($e.parent!==null&&$e.parent.remove($e),$e.parent=this,this.children.push($e),$e.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",$e),this)},remove:function($e){if(arguments.length>1){for(var Se=0;Se<arguments.length;Se++)this.remove(arguments[Se]);return this}var Be=this.children.indexOf($e);return Be!==-1&&($e.parent=null,this.children.splice(Be,1),$e.dispatchEvent(_removedEvent)),this},attach:function($e){return this.updateWorldMatrix(!0,!1),_m1$1.getInverse(this.matrixWorld),$e.parent!==null&&($e.parent.updateWorldMatrix(!0,!1),_m1$1.multiply($e.parent.matrixWorld)),$e.applyMatrix4(_m1$1),$e.updateWorldMatrix(!1,!1),this.add($e),this},getObjectById:function($e){return this.getObjectByProperty("id",$e)},getObjectByName:function($e){return this.getObjectByProperty("name",$e)},getObjectByProperty:function($e,Se){if(this[$e]===Se)return this;for(var Be=0,De=this.children.length;Be<De;Be++){var Ve=this.children[Be],Fe=Ve.getObjectByProperty($e,Se);if(Fe!==void 0)return Fe}},getWorldPosition:function($e){return $e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),$e=new Vector3),this.updateMatrixWorld(!0),$e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function($e){return $e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),$e=new Quaternion),this.updateMatrixWorld(!0),this.matrixWorld.decompose(_position,$e,_scale),$e},getWorldScale:function($e){return $e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),$e=new Vector3),this.updateMatrixWorld(!0),this.matrixWorld.decompose(_position,_quaternion$2,$e),$e},getWorldDirection:function($e){$e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),$e=new Vector3),this.updateMatrixWorld(!0);var Se=this.matrixWorld.elements;return $e.set(Se[8],Se[9],Se[10]).normalize()},raycast:function(){},traverse:function($e){$e(this);for(var Se=this.children,Be=0,De=Se.length;Be<De;Be++)Se[Be].traverse($e)},traverseVisible:function($e){if(this.visible!==!1){$e(this);for(var Se=this.children,Be=0,De=Se.length;Be<De;Be++)Se[Be].traverseVisible($e)}},traverseAncestors:function($e){var Se=this.parent;Se!==null&&($e(Se),Se.traverseAncestors($e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function($e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||$e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,$e=!0);for(var Se=this.children,Be=0,De=Se.length;Be<De;Be++)Se[Be].updateMatrixWorld($e)},updateWorldMatrix:function($e,Se){var Be=this.parent;if($e===!0&&Be!==null&&Be.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),Se===!0)for(var De=this.children,Ve=0,Fe=De.length;Ve<Fe;Ve++)De[Ve].updateWorldMatrix(!1,!0)},toJSON:function($e){var Se=$e===void 0||typeof $e=="string",Be={};Se&&($e={geometries:{},materials:{},textures:{},images:{},shapes:{}},Be.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var De={};De.uuid=this.uuid,De.type=this.type,this.name!==""&&(De.name=this.name),this.castShadow===!0&&(De.castShadow=!0),this.receiveShadow===!0&&(De.receiveShadow=!0),this.visible===!1&&(De.visible=!1),this.frustumCulled===!1&&(De.frustumCulled=!1),this.renderOrder!==0&&(De.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(De.userData=this.userData),De.layers=this.layers.mask,De.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(De.matrixAutoUpdate=!1),this.isInstancedMesh&&(De.type="InstancedMesh",De.count=this.count,De.instanceMatrix=this.instanceMatrix.toJSON());function Ve(an,rn){return an[rn.uuid]===void 0&&(an[rn.uuid]=rn.toJSON($e)),rn.uuid}if(this.isMesh||this.isLine||this.isPoints){De.geometry=Ve($e.geometries,this.geometry);var Fe=this.geometry.parameters;if(Fe!==void 0&&Fe.shapes!==void 0){var Je=Fe.shapes;if(Array.isArray(Je))for(var Xe=0,Ke=Je.length;Xe<Ke;Xe++){var Ye=Je[Xe];Ve($e.shapes,Ye)}else Ve($e.shapes,Je)}}if(this.material!==void 0)if(Array.isArray(this.material)){for(var or=[],Xe=0,Ke=this.material.length;Xe<Ke;Xe++)or.push(Ve($e.materials,this.material[Xe]));De.material=or}else De.material=Ve($e.materials,this.material);if(this.children.length>0){De.children=[];for(var Xe=0;Xe<this.children.length;Xe++)De.children.push(this.children[Xe].toJSON($e).object)}if(Se){var sr=en($e.geometries),cr=en($e.materials),Br=en($e.textures),tn=en($e.images),Je=en($e.shapes);sr.length>0&&(Be.geometries=sr),cr.length>0&&(Be.materials=cr),Br.length>0&&(Be.textures=Br),tn.length>0&&(Be.images=tn),Je.length>0&&(Be.shapes=Je)}return Be.object=De,Be;function en(an){var rn=[];for(var on in an){var sn=an[on];delete sn.metadata,rn.push(sn)}return rn}},clone:function($e){return new this.constructor().copy(this,$e)},copy:function($e,Se){if(Se===void 0&&(Se=!0),this.name=$e.name,this.up.copy($e.up),this.position.copy($e.position),this.quaternion.copy($e.quaternion),this.scale.copy($e.scale),this.matrix.copy($e.matrix),this.matrixWorld.copy($e.matrixWorld),this.matrixAutoUpdate=$e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=$e.matrixWorldNeedsUpdate,this.layers.mask=$e.layers.mask,this.visible=$e.visible,this.castShadow=$e.castShadow,this.receiveShadow=$e.receiveShadow,this.frustumCulled=$e.frustumCulled,this.renderOrder=$e.renderOrder,this.userData=JSON.parse(JSON.stringify($e.userData)),Se===!0)for(var Be=0;Be<$e.children.length;Be++){var De=$e.children[Be];this.add(De.clone())}return this}});function Scene$1(){Object3D.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Scene$1.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Scene$1,isScene:!0,copy:function($e,Se){return Object3D.prototype.copy.call(this,$e,Se),$e.background!==null&&(this.background=$e.background.clone()),$e.environment!==null&&(this.environment=$e.environment.clone()),$e.fog!==null&&(this.fog=$e.fog.clone()),$e.overrideMaterial!==null&&(this.overrideMaterial=$e.overrideMaterial.clone()),this.autoUpdate=$e.autoUpdate,this.matrixAutoUpdate=$e.matrixAutoUpdate,this},toJSON:function($e){var Se=Object3D.prototype.toJSON.call(this,$e);return this.background!==null&&(Se.object.background=this.background.toJSON($e)),this.environment!==null&&(Se.object.environment=this.environment.toJSON($e)),this.fog!==null&&(Se.object.fog=this.fog.toJSON()),Se},dispose:function(){this.dispatchEvent({type:"dispose"})}});var _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$1$1=new Vector3,_box=new Box3,_v0=new Vector3,_v1$2=new Vector3,_v2=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function Box3($e,Se){this.min=$e!==void 0?$e:new Vector3(1/0,1/0,1/0),this.max=Se!==void 0?Se:new Vector3(-1/0,-1/0,-1/0)}Object.assign(Box3.prototype,{isBox3:!0,set:function($e,Se){return this.min.copy($e),this.max.copy(Se),this},setFromArray:function($e){for(var Se=1/0,Be=1/0,De=1/0,Ve=-1/0,Fe=-1/0,Je=-1/0,Xe=0,Ke=$e.length;Xe<Ke;Xe+=3){var Ye=$e[Xe],or=$e[Xe+1],sr=$e[Xe+2];Ye<Se&&(Se=Ye),or<Be&&(Be=or),sr<De&&(De=sr),Ye>Ve&&(Ve=Ye),or>Fe&&(Fe=or),sr>Je&&(Je=sr)}return this.min.set(Se,Be,De),this.max.set(Ve,Fe,Je),this},setFromBufferAttribute:function($e){for(var Se=1/0,Be=1/0,De=1/0,Ve=-1/0,Fe=-1/0,Je=-1/0,Xe=0,Ke=$e.count;Xe<Ke;Xe++){var Ye=$e.getX(Xe),or=$e.getY(Xe),sr=$e.getZ(Xe);Ye<Se&&(Se=Ye),or<Be&&(Be=or),sr<De&&(De=sr),Ye>Ve&&(Ve=Ye),or>Fe&&(Fe=or),sr>Je&&(Je=sr)}return this.min.set(Se,Be,De),this.max.set(Ve,Fe,Je),this},setFromPoints:function($e){this.makeEmpty();for(var Se=0,Be=$e.length;Se<Be;Se++)this.expandByPoint($e[Se]);return this},setFromCenterAndSize:function($e,Se){var Be=_vector$1$1.copy(Se).multiplyScalar(.5);return this.min.copy($e).sub(Be),this.max.copy($e).add(Be),this},setFromObject:function($e){return this.makeEmpty(),this.expandByObject($e)},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.min.copy($e.min),this.max.copy($e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function($e){return $e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),$e=new Vector3),this.isEmpty()?$e.set(0,0,0):$e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function($e){return $e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),$e=new Vector3),this.isEmpty()?$e.set(0,0,0):$e.subVectors(this.max,this.min)},expandByPoint:function($e){return this.min.min($e),this.max.max($e),this},expandByVector:function($e){return this.min.sub($e),this.max.add($e),this},expandByScalar:function($e){return this.min.addScalar(-$e),this.max.addScalar($e),this},expandByObject:function($e){$e.updateWorldMatrix(!1,!1);var Se=$e.geometry;Se!==void 0&&(Se.boundingBox===null&&Se.computeBoundingBox(),_box.copy(Se.boundingBox),_box.applyMatrix4($e.matrixWorld),this.union(_box));for(var Be=$e.children,De=0,Ve=Be.length;De<Ve;De++)this.expandByObject(Be[De]);return this},containsPoint:function($e){return!($e.x<this.min.x||$e.x>this.max.x||$e.y<this.min.y||$e.y>this.max.y||$e.z<this.min.z||$e.z>this.max.z)},containsBox:function($e){return this.min.x<=$e.min.x&&$e.max.x<=this.max.x&&this.min.y<=$e.min.y&&$e.max.y<=this.max.y&&this.min.z<=$e.min.z&&$e.max.z<=this.max.z},getParameter:function($e,Se){return Se===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),Se=new Vector3),Se.set(($e.x-this.min.x)/(this.max.x-this.min.x),($e.y-this.min.y)/(this.max.y-this.min.y),($e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function($e){return!($e.max.x<this.min.x||$e.min.x>this.max.x||$e.max.y<this.min.y||$e.min.y>this.max.y||$e.max.z<this.min.z||$e.min.z>this.max.z)},intersectsSphere:function($e){return this.clampPoint($e.center,_vector$1$1),_vector$1$1.distanceToSquared($e.center)<=$e.radius*$e.radius},intersectsPlane:function($e){var Se,Be;return $e.normal.x>0?(Se=$e.normal.x*this.min.x,Be=$e.normal.x*this.max.x):(Se=$e.normal.x*this.max.x,Be=$e.normal.x*this.min.x),$e.normal.y>0?(Se+=$e.normal.y*this.min.y,Be+=$e.normal.y*this.max.y):(Se+=$e.normal.y*this.max.y,Be+=$e.normal.y*this.min.y),$e.normal.z>0?(Se+=$e.normal.z*this.min.z,Be+=$e.normal.z*this.max.z):(Se+=$e.normal.z*this.max.z,Be+=$e.normal.z*this.min.z),Se<=-$e.constant&&Be>=-$e.constant},intersectsTriangle:function($e){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0.subVectors($e.a,_center),_v1$2.subVectors($e.b,_center),_v2.subVectors($e.c,_center),_f0.subVectors(_v1$2,_v0),_f1.subVectors(_v2,_v1$2),_f2.subVectors(_v0,_v2);var Se=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(Se,_v0,_v1$2,_v2,_extents)||(Se=[1,0,0,0,1,0,0,0,1],!satForAxes(Se,_v0,_v1$2,_v2,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),Se=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(Se,_v0,_v1$2,_v2,_extents))},clampPoint:function($e,Se){return Se===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),Se=new Vector3),Se.copy($e).clamp(this.min,this.max)},distanceToPoint:function($e){var Se=_vector$1$1.copy($e).clamp(this.min,this.max);return Se.sub($e).length()},getBoundingSphere:function($e){return $e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter($e.center),$e.radius=this.getSize(_vector$1$1).length()*.5,$e},intersect:function($e){return this.min.max($e.min),this.max.min($e.max),this.isEmpty()&&this.makeEmpty(),this},union:function($e){return this.min.min($e.min),this.max.max($e.max),this},applyMatrix4:function($e){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4($e),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4($e),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4($e),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4($e),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4($e),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4($e),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4($e),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4($e),this.setFromPoints(_points),this)},translate:function($e){return this.min.add($e),this.max.add($e),this},equals:function($e){return $e.min.equals(this.min)&&$e.max.equals(this.max)}});function satForAxes($e,Se,Be,De,Ve){var Fe,Je;for(Fe=0,Je=$e.length-3;Fe<=Je;Fe+=3){_testAxis.fromArray($e,Fe);var Xe=Ve.x*Math.abs(_testAxis.x)+Ve.y*Math.abs(_testAxis.y)+Ve.z*Math.abs(_testAxis.z),Ke=Se.dot(_testAxis),Ye=Be.dot(_testAxis),or=De.dot(_testAxis);if(Math.max(-Math.max(Ke,Ye,or),Math.min(Ke,Ye,or))>Xe)return!1}return!0}var _box$1=new Box3;function Sphere($e,Se){this.center=$e!==void 0?$e:new Vector3,this.radius=Se!==void 0?Se:-1}Object.assign(Sphere.prototype,{set:function($e,Se){return this.center.copy($e),this.radius=Se,this},setFromPoints:function($e,Se){var Be=this.center;Se!==void 0?Be.copy(Se):_box$1.setFromPoints($e).getCenter(Be);for(var De=0,Ve=0,Fe=$e.length;Ve<Fe;Ve++)De=Math.max(De,Be.distanceToSquared($e[Ve]));return this.radius=Math.sqrt(De),this},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.center.copy($e.center),this.radius=$e.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function($e){return $e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function($e){return $e.distanceTo(this.center)-this.radius},intersectsSphere:function($e){var Se=this.radius+$e.radius;return $e.center.distanceToSquared(this.center)<=Se*Se},intersectsBox:function($e){return $e.intersectsSphere(this)},intersectsPlane:function($e){return Math.abs($e.distanceToPoint(this.center))<=this.radius},clampPoint:function($e,Se){var Be=this.center.distanceToSquared($e);return Se===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),Se=new Vector3),Se.copy($e),Be>this.radius*this.radius&&(Se.sub(this.center).normalize(),Se.multiplyScalar(this.radius).add(this.center)),Se},getBoundingBox:function($e){return $e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),$e=new Box3),this.isEmpty()?($e.makeEmpty(),$e):($e.set(this.center,this.center),$e.expandByScalar(this.radius),$e)},applyMatrix4:function($e){return this.center.applyMatrix4($e),this.radius=this.radius*$e.getMaxScaleOnAxis(),this},translate:function($e){return this.center.add($e),this},equals:function($e){return $e.center.equals(this.center)&&$e.radius===this.radius}});var _vector$2=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal=new Vector3;function Ray($e,Se){this.origin=$e!==void 0?$e:new Vector3,this.direction=Se!==void 0?Se:new Vector3(0,0,-1)}Object.assign(Ray.prototype,{set:function($e,Se){return this.origin.copy($e),this.direction.copy(Se),this},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.origin.copy($e.origin),this.direction.copy($e.direction),this},at:function($e,Se){return Se===void 0&&(console.warn("THREE.Ray: .at() target is now required"),Se=new Vector3),Se.copy(this.direction).multiplyScalar($e).add(this.origin)},lookAt:function($e){return this.direction.copy($e).sub(this.origin).normalize(),this},recast:function($e){return this.origin.copy(this.at($e,_vector$2)),this},closestPointToPoint:function($e,Se){Se===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),Se=new Vector3),Se.subVectors($e,this.origin);var Be=Se.dot(this.direction);return Be<0?Se.copy(this.origin):Se.copy(this.direction).multiplyScalar(Be).add(this.origin)},distanceToPoint:function($e){return Math.sqrt(this.distanceSqToPoint($e))},distanceSqToPoint:function($e){var Se=_vector$2.subVectors($e,this.origin).dot(this.direction);return Se<0?this.origin.distanceToSquared($e):(_vector$2.copy(this.direction).multiplyScalar(Se).add(this.origin),_vector$2.distanceToSquared($e))},distanceSqToSegment:function($e,Se,Be,De){_segCenter.copy($e).add(Se).multiplyScalar(.5),_segDir.copy(Se).sub($e).normalize(),_diff.copy(this.origin).sub(_segCenter);var Ve=$e.distanceTo(Se)*.5,Fe=-this.direction.dot(_segDir),Je=_diff.dot(this.direction),Xe=-_diff.dot(_segDir),Ke=_diff.lengthSq(),Ye=Math.abs(1-Fe*Fe),or,sr,cr,Br;if(Ye>0)if(or=Fe*Xe-Je,sr=Fe*Je-Xe,Br=Ve*Ye,or>=0)if(sr>=-Br)if(sr<=Br){var tn=1/Ye;or*=tn,sr*=tn,cr=or*(or+Fe*sr+2*Je)+sr*(Fe*or+sr+2*Xe)+Ke}else sr=Ve,or=Math.max(0,-(Fe*sr+Je)),cr=-or*or+sr*(sr+2*Xe)+Ke;else sr=-Ve,or=Math.max(0,-(Fe*sr+Je)),cr=-or*or+sr*(sr+2*Xe)+Ke;else sr<=-Br?(or=Math.max(0,-(-Fe*Ve+Je)),sr=or>0?-Ve:Math.min(Math.max(-Ve,-Xe),Ve),cr=-or*or+sr*(sr+2*Xe)+Ke):sr<=Br?(or=0,sr=Math.min(Math.max(-Ve,-Xe),Ve),cr=sr*(sr+2*Xe)+Ke):(or=Math.max(0,-(Fe*Ve+Je)),sr=or>0?Ve:Math.min(Math.max(-Ve,-Xe),Ve),cr=-or*or+sr*(sr+2*Xe)+Ke);else sr=Fe>0?-Ve:Ve,or=Math.max(0,-(Fe*sr+Je)),cr=-or*or+sr*(sr+2*Xe)+Ke;return Be&&Be.copy(this.direction).multiplyScalar(or).add(this.origin),De&&De.copy(_segDir).multiplyScalar(sr).add(_segCenter),cr},intersectSphere:function($e,Se){_vector$2.subVectors($e.center,this.origin);var Be=_vector$2.dot(this.direction),De=_vector$2.dot(_vector$2)-Be*Be,Ve=$e.radius*$e.radius;if(De>Ve)return null;var Fe=Math.sqrt(Ve-De),Je=Be-Fe,Xe=Be+Fe;return Je<0&&Xe<0?null:Je<0?this.at(Xe,Se):this.at(Je,Se)},intersectsSphere:function($e){return this.distanceSqToPoint($e.center)<=$e.radius*$e.radius},distanceToPlane:function($e){var Se=$e.normal.dot(this.direction);if(Se===0)return $e.distanceToPoint(this.origin)===0?0:null;var Be=-(this.origin.dot($e.normal)+$e.constant)/Se;return Be>=0?Be:null},intersectPlane:function($e,Se){var Be=this.distanceToPlane($e);return Be===null?null:this.at(Be,Se)},intersectsPlane:function($e){var Se=$e.distanceToPoint(this.origin);if(Se===0)return!0;var Be=$e.normal.dot(this.direction);return Be*Se<0},intersectBox:function($e,Se){var Be,De,Ve,Fe,Je,Xe,Ke=1/this.direction.x,Ye=1/this.direction.y,or=1/this.direction.z,sr=this.origin;return Ke>=0?(Be=($e.min.x-sr.x)*Ke,De=($e.max.x-sr.x)*Ke):(Be=($e.max.x-sr.x)*Ke,De=($e.min.x-sr.x)*Ke),Ye>=0?(Ve=($e.min.y-sr.y)*Ye,Fe=($e.max.y-sr.y)*Ye):(Ve=($e.max.y-sr.y)*Ye,Fe=($e.min.y-sr.y)*Ye),Be>Fe||Ve>De||((Ve>Be||Be!==Be)&&(Be=Ve),(Fe<De||De!==De)&&(De=Fe),or>=0?(Je=($e.min.z-sr.z)*or,Xe=($e.max.z-sr.z)*or):(Je=($e.max.z-sr.z)*or,Xe=($e.min.z-sr.z)*or),Be>Xe||Je>De)||((Je>Be||Be!==Be)&&(Be=Je),(Xe<De||De!==De)&&(De=Xe),De<0)?null:this.at(Be>=0?Be:De,Se)},intersectsBox:function($e){return this.intersectBox($e,_vector$2)!==null},intersectTriangle:function($e,Se,Be,De,Ve){_edge1.subVectors(Se,$e),_edge2.subVectors(Be,$e),_normal.crossVectors(_edge1,_edge2);var Fe=this.direction.dot(_normal),Je;if(Fe>0){if(De)return null;Je=1}else if(Fe<0)Je=-1,Fe=-Fe;else return null;_diff.subVectors(this.origin,$e);var Xe=Je*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(Xe<0)return null;var Ke=Je*this.direction.dot(_edge1.cross(_diff));if(Ke<0||Xe+Ke>Fe)return null;var Ye=-Je*_diff.dot(_normal);return Ye<0?null:this.at(Ye/Fe,Ve)},applyMatrix4:function($e){return this.origin.applyMatrix4($e),this.direction.transformDirection($e),this},equals:function($e){return $e.origin.equals(this.origin)&&$e.direction.equals(this.direction)}});var _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;function Plane($e,Se){this.normal=$e!==void 0?$e:new Vector3(1,0,0),this.constant=Se!==void 0?Se:0}Object.assign(Plane.prototype,{isPlane:!0,set:function($e,Se){return this.normal.copy($e),this.constant=Se,this},setComponents:function($e,Se,Be,De){return this.normal.set($e,Se,Be),this.constant=De,this},setFromNormalAndCoplanarPoint:function($e,Se){return this.normal.copy($e),this.constant=-Se.dot(this.normal),this},setFromCoplanarPoints:function($e,Se,Be){var De=_vector1.subVectors(Be,Se).cross(_vector2.subVectors($e,Se)).normalize();return this.setFromNormalAndCoplanarPoint(De,$e),this},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.normal.copy($e.normal),this.constant=$e.constant,this},normalize:function(){var $e=1/this.normal.length();return this.normal.multiplyScalar($e),this.constant*=$e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function($e){return this.normal.dot($e)+this.constant},distanceToSphere:function($e){return this.distanceToPoint($e.center)-$e.radius},projectPoint:function($e,Se){return Se===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),Se=new Vector3),Se.copy(this.normal).multiplyScalar(-this.distanceToPoint($e)).add($e)},intersectLine:function($e,Se){Se===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),Se=new Vector3);var Be=$e.delta(_vector1),De=this.normal.dot(Be);if(De===0)return this.distanceToPoint($e.start)===0?Se.copy($e.start):void 0;var Ve=-($e.start.dot(this.normal)+this.constant)/De;if(!(Ve<0||Ve>1))return Se.copy(Be).multiplyScalar(Ve).add($e.start)},intersectsLine:function($e){var Se=this.distanceToPoint($e.start),Be=this.distanceToPoint($e.end);return Se<0&&Be>0||Be<0&&Se>0},intersectsBox:function($e){return $e.intersectsPlane(this)},intersectsSphere:function($e){return $e.intersectsPlane(this)},coplanarPoint:function($e){return $e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),$e=new Vector3),$e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function($e,Se){var Be=Se||_normalMatrix.getNormalMatrix($e),De=this.coplanarPoint(_vector1).applyMatrix4($e),Ve=this.normal.applyMatrix3(Be).normalize();return this.constant=-De.dot(Ve),this},translate:function($e){return this.constant-=$e.dot(this.normal),this},equals:function($e){return $e.normal.equals(this.normal)&&$e.constant===this.constant}});var _v0$1=new Vector3,_v1$3=new Vector3,_v2$1=new Vector3,_v3=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;function Triangle($e,Se,Be){this.a=$e!==void 0?$e:new Vector3,this.b=Se!==void 0?Se:new Vector3,this.c=Be!==void 0?Be:new Vector3}Object.assign(Triangle,{getNormal:function($e,Se,Be,De){De===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),De=new Vector3),De.subVectors(Be,Se),_v0$1.subVectors($e,Se),De.cross(_v0$1);var Ve=De.lengthSq();return Ve>0?De.multiplyScalar(1/Math.sqrt(Ve)):De.set(0,0,0)},getBarycoord:function($e,Se,Be,De,Ve){_v0$1.subVectors(De,Se),_v1$3.subVectors(Be,Se),_v2$1.subVectors($e,Se);var Fe=_v0$1.dot(_v0$1),Je=_v0$1.dot(_v1$3),Xe=_v0$1.dot(_v2$1),Ke=_v1$3.dot(_v1$3),Ye=_v1$3.dot(_v2$1),or=Fe*Ke-Je*Je;if(Ve===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),Ve=new Vector3),or===0)return Ve.set(-2,-1,-1);var sr=1/or,cr=(Ke*Xe-Je*Ye)*sr,Br=(Fe*Ye-Je*Xe)*sr;return Ve.set(1-cr-Br,Br,cr)},containsPoint:function($e,Se,Be,De){return Triangle.getBarycoord($e,Se,Be,De,_v3),_v3.x>=0&&_v3.y>=0&&_v3.x+_v3.y<=1},getUV:function($e,Se,Be,De,Ve,Fe,Je,Xe){return this.getBarycoord($e,Se,Be,De,_v3),Xe.set(0,0),Xe.addScaledVector(Ve,_v3.x),Xe.addScaledVector(Fe,_v3.y),Xe.addScaledVector(Je,_v3.z),Xe},isFrontFacing:function($e,Se,Be,De){return _v0$1.subVectors(Be,Se),_v1$3.subVectors($e,Se),_v0$1.cross(_v1$3).dot(De)<0}});Object.assign(Triangle.prototype,{set:function($e,Se,Be){return this.a.copy($e),this.b.copy(Se),this.c.copy(Be),this},setFromPointsAndIndices:function($e,Se,Be,De){return this.a.copy($e[Se]),this.b.copy($e[Be]),this.c.copy($e[De]),this},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.a.copy($e.a),this.b.copy($e.b),this.c.copy($e.c),this},getArea:function(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5},getMidpoint:function($e){return $e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),$e=new Vector3),$e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function($e){return Triangle.getNormal(this.a,this.b,this.c,$e)},getPlane:function($e){return $e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),$e=new Plane),$e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function($e,Se){return Triangle.getBarycoord($e,this.a,this.b,this.c,Se)},getUV:function($e,Se,Be,De,Ve){return Triangle.getUV($e,this.a,this.b,this.c,Se,Be,De,Ve)},containsPoint:function($e){return Triangle.containsPoint($e,this.a,this.b,this.c)},isFrontFacing:function($e){return Triangle.isFrontFacing(this.a,this.b,this.c,$e)},intersectsBox:function($e){return $e.intersectsTriangle(this)},closestPointToPoint:function($e,Se){Se===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),Se=new Vector3);var Be=this.a,De=this.b,Ve=this.c,Fe,Je;_vab.subVectors(De,Be),_vac.subVectors(Ve,Be),_vap.subVectors($e,Be);var Xe=_vab.dot(_vap),Ke=_vac.dot(_vap);if(Xe<=0&&Ke<=0)return Se.copy(Be);_vbp.subVectors($e,De);var Ye=_vab.dot(_vbp),or=_vac.dot(_vbp);if(Ye>=0&&or<=Ye)return Se.copy(De);var sr=Xe*or-Ye*Ke;if(sr<=0&&Xe>=0&&Ye<=0)return Fe=Xe/(Xe-Ye),Se.copy(Be).addScaledVector(_vab,Fe);_vcp.subVectors($e,Ve);var cr=_vab.dot(_vcp),Br=_vac.dot(_vcp);if(Br>=0&&cr<=Br)return Se.copy(Ve);var tn=cr*Ke-Xe*Br;if(tn<=0&&Ke>=0&&Br<=0)return Je=Ke/(Ke-Br),Se.copy(Be).addScaledVector(_vac,Je);var en=Ye*Br-cr*or;if(en<=0&&or-Ye>=0&&cr-Br>=0)return _vbc.subVectors(Ve,De),Je=(or-Ye)/(or-Ye+(cr-Br)),Se.copy(De).addScaledVector(_vbc,Je);var an=1/(en+tn+sr);return Fe=tn*an,Je=sr*an,Se.copy(Be).addScaledVector(_vab,Fe).addScaledVector(_vac,Je)},equals:function($e){return $e.a.equals(this.a)&&$e.b.equals(this.b)&&$e.c.equals(this.c)}});var _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function Color($e,Se,Be){return Se===void 0&&Be===void 0?this.set($e):this.setRGB($e,Se,Be)}function hue2rgb($e,Se,Be){return Be<0&&(Be+=1),Be>1&&(Be-=1),Be<1/6?$e+(Se-$e)*6*Be:Be<1/2?Se:Be<2/3?$e+(Se-$e)*6*(2/3-Be):$e}function SRGBToLinear($e){return $e<.04045?$e*.0773993808:Math.pow($e*.9478672986+.0521327014,2.4)}function LinearToSRGB($e){return $e<.0031308?$e*12.92:1.055*Math.pow($e,.41666)-.055}Object.assign(Color.prototype,{isColor:!0,r:1,g:1,b:1,set:function($e){return $e&&$e.isColor?this.copy($e):typeof $e=="number"?this.setHex($e):typeof $e=="string"&&this.setStyle($e),this},setScalar:function($e){return this.r=$e,this.g=$e,this.b=$e,this},setHex:function($e){return $e=Math.floor($e),this.r=($e>>16&255)/255,this.g=($e>>8&255)/255,this.b=($e&255)/255,this},setRGB:function($e,Se,Be){return this.r=$e,this.g=Se,this.b=Be,this},setHSL:function($e,Se,Be){if($e=MathUtils.euclideanModulo($e,1),Se=MathUtils.clamp(Se,0,1),Be=MathUtils.clamp(Be,0,1),Se===0)this.r=this.g=this.b=Be;else{var De=Be<=.5?Be*(1+Se):Be+Se-Be*Se,Ve=2*Be-De;this.r=hue2rgb(Ve,De,$e+1/3),this.g=hue2rgb(Ve,De,$e),this.b=hue2rgb(Ve,De,$e-1/3)}return this},setStyle:function($e){function Se(sr){sr!==void 0&&parseFloat(sr)<1&&console.warn("THREE.Color: Alpha component of "+$e+" will be ignored.")}var Be;if(Be=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec($e)){var De,Ve=Be[1],Fe=Be[2];switch(Ve){case"rgb":case"rgba":if(De=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Fe))return this.r=Math.min(255,parseInt(De[1],10))/255,this.g=Math.min(255,parseInt(De[2],10))/255,this.b=Math.min(255,parseInt(De[3],10))/255,Se(De[5]),this;if(De=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Fe))return this.r=Math.min(100,parseInt(De[1],10))/100,this.g=Math.min(100,parseInt(De[2],10))/100,this.b=Math.min(100,parseInt(De[3],10))/100,Se(De[5]),this;break;case"hsl":case"hsla":if(De=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Fe)){var Je=parseFloat(De[1])/360,Xe=parseInt(De[2],10)/100,Ke=parseInt(De[3],10)/100;return Se(De[5]),this.setHSL(Je,Xe,Ke)}break}}else if(Be=/^\#([A-Fa-f0-9]+)$/.exec($e)){var Ye=Be[1],or=Ye.length;if(or===3)return this.r=parseInt(Ye.charAt(0)+Ye.charAt(0),16)/255,this.g=parseInt(Ye.charAt(1)+Ye.charAt(1),16)/255,this.b=parseInt(Ye.charAt(2)+Ye.charAt(2),16)/255,this;if(or===6)return this.r=parseInt(Ye.charAt(0)+Ye.charAt(1),16)/255,this.g=parseInt(Ye.charAt(2)+Ye.charAt(3),16)/255,this.b=parseInt(Ye.charAt(4)+Ye.charAt(5),16)/255,this}return $e&&$e.length>0?this.setColorName($e):this},setColorName:function($e){var Se=_colorKeywords[$e];return Se!==void 0?this.setHex(Se):console.warn("THREE.Color: Unknown color "+$e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function($e){return this.r=$e.r,this.g=$e.g,this.b=$e.b,this},copyGammaToLinear:function($e,Se){return Se===void 0&&(Se=2),this.r=Math.pow($e.r,Se),this.g=Math.pow($e.g,Se),this.b=Math.pow($e.b,Se),this},copyLinearToGamma:function($e,Se){Se===void 0&&(Se=2);var Be=Se>0?1/Se:1;return this.r=Math.pow($e.r,Be),this.g=Math.pow($e.g,Be),this.b=Math.pow($e.b,Be),this},convertGammaToLinear:function($e){return this.copyGammaToLinear(this,$e),this},convertLinearToGamma:function($e){return this.copyLinearToGamma(this,$e),this},copySRGBToLinear:function($e){return this.r=SRGBToLinear($e.r),this.g=SRGBToLinear($e.g),this.b=SRGBToLinear($e.b),this},copyLinearToSRGB:function($e){return this.r=LinearToSRGB($e.r),this.g=LinearToSRGB($e.g),this.b=LinearToSRGB($e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function($e){$e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),$e={h:0,s:0,l:0});var Se=this.r,Be=this.g,De=this.b,Ve=Math.max(Se,Be,De),Fe=Math.min(Se,Be,De),Je,Xe,Ke=(Fe+Ve)/2;if(Fe===Ve)Je=0,Xe=0;else{var Ye=Ve-Fe;switch(Xe=Ke<=.5?Ye/(Ve+Fe):Ye/(2-Ve-Fe),Ve){case Se:Je=(Be-De)/Ye+(Be<De?6:0);break;case Be:Je=(De-Se)/Ye+2;break;case De:Je=(Se-Be)/Ye+4;break}Je/=6}return $e.h=Je,$e.s=Xe,$e.l=Ke,$e},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function($e,Se,Be){return this.getHSL(_hslA),_hslA.h+=$e,_hslA.s+=Se,_hslA.l+=Be,this.setHSL(_hslA.h,_hslA.s,_hslA.l),this},add:function($e){return this.r+=$e.r,this.g+=$e.g,this.b+=$e.b,this},addColors:function($e,Se){return this.r=$e.r+Se.r,this.g=$e.g+Se.g,this.b=$e.b+Se.b,this},addScalar:function($e){return this.r+=$e,this.g+=$e,this.b+=$e,this},sub:function($e){return this.r=Math.max(0,this.r-$e.r),this.g=Math.max(0,this.g-$e.g),this.b=Math.max(0,this.b-$e.b),this},multiply:function($e){return this.r*=$e.r,this.g*=$e.g,this.b*=$e.b,this},multiplyScalar:function($e){return this.r*=$e,this.g*=$e,this.b*=$e,this},lerp:function($e,Se){return this.r+=($e.r-this.r)*Se,this.g+=($e.g-this.g)*Se,this.b+=($e.b-this.b)*Se,this},lerpHSL:function($e,Se){this.getHSL(_hslA),$e.getHSL(_hslB);var Be=MathUtils.lerp(_hslA.h,_hslB.h,Se),De=MathUtils.lerp(_hslA.s,_hslB.s,Se),Ve=MathUtils.lerp(_hslA.l,_hslB.l,Se);return this.setHSL(Be,De,Ve),this},equals:function($e){return $e.r===this.r&&$e.g===this.g&&$e.b===this.b},fromArray:function($e,Se){return Se===void 0&&(Se=0),this.r=$e[Se],this.g=$e[Se+1],this.b=$e[Se+2],this},toArray:function($e,Se){return $e===void 0&&($e=[]),Se===void 0&&(Se=0),$e[Se]=this.r,$e[Se+1]=this.g,$e[Se+2]=this.b,$e},toJSON:function(){return this.getHex()}});Color.NAMES=_colorKeywords;function Face3($e,Se,Be,De,Ve,Fe){this.a=$e,this.b=Se,this.c=Be,this.normal=De&&De.isVector3?De:new Vector3,this.vertexNormals=Array.isArray(De)?De:[],this.color=Ve&&Ve.isColor?Ve:new Color,this.vertexColors=Array.isArray(Ve)?Ve:[],this.materialIndex=Fe!==void 0?Fe:0}Object.assign(Face3.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function($e){this.a=$e.a,this.b=$e.b,this.c=$e.c,this.normal.copy($e.normal),this.color.copy($e.color),this.materialIndex=$e.materialIndex;for(var Se=0,Be=$e.vertexNormals.length;Se<Be;Se++)this.vertexNormals[Se]=$e.vertexNormals[Se].clone();for(var Se=0,Be=$e.vertexColors.length;Se<Be;Se++)this.vertexColors[Se]=$e.vertexColors[Se].clone();return this}});var materialId=0;function Material(){Object.defineProperty(this,"id",{value:materialId++}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=NormalBlending,this.side=FrontSide,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Material.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Material,isMaterial:!0,onBeforeCompile:function(){},setValues:function($e){if($e!==void 0)for(var Se in $e){var Be=$e[Se];if(Be===void 0){console.warn("THREE.Material: '"+Se+"' parameter is undefined.");continue}if(Se==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=Be===FlatShading;continue}var De=this[Se];if(De===void 0){console.warn("THREE."+this.type+": '"+Se+"' is not a property of this material.");continue}De&&De.isColor?De.set(Be):De&&De.isVector3&&Be&&Be.isVector3?De.copy(Be):this[Se]=Be}},toJSON:function($e){var Se=$e===void 0||typeof $e=="string";Se&&($e={textures:{},images:{}});var Be={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};Be.uuid=this.uuid,Be.type=this.type,this.name!==""&&(Be.name=this.name),this.color&&this.color.isColor&&(Be.color=this.color.getHex()),this.roughness!==void 0&&(Be.roughness=this.roughness),this.metalness!==void 0&&(Be.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(Be.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(Be.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(Be.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(Be.specular=this.specular.getHex()),this.shininess!==void 0&&(Be.shininess=this.shininess),this.clearcoat!==void 0&&(Be.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(Be.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(Be.clearcoatMap=this.clearcoatMap.toJSON($e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(Be.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON($e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(Be.clearcoatNormalMap=this.clearcoatNormalMap.toJSON($e).uuid,Be.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(Be.map=this.map.toJSON($e).uuid),this.matcap&&this.matcap.isTexture&&(Be.matcap=this.matcap.toJSON($e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(Be.alphaMap=this.alphaMap.toJSON($e).uuid),this.lightMap&&this.lightMap.isTexture&&(Be.lightMap=this.lightMap.toJSON($e).uuid),this.aoMap&&this.aoMap.isTexture&&(Be.aoMap=this.aoMap.toJSON($e).uuid,Be.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(Be.bumpMap=this.bumpMap.toJSON($e).uuid,Be.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(Be.normalMap=this.normalMap.toJSON($e).uuid,Be.normalMapType=this.normalMapType,Be.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(Be.displacementMap=this.displacementMap.toJSON($e).uuid,Be.displacementScale=this.displacementScale,Be.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(Be.roughnessMap=this.roughnessMap.toJSON($e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(Be.metalnessMap=this.metalnessMap.toJSON($e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(Be.emissiveMap=this.emissiveMap.toJSON($e).uuid),this.specularMap&&this.specularMap.isTexture&&(Be.specularMap=this.specularMap.toJSON($e).uuid),this.envMap&&this.envMap.isTexture&&(Be.envMap=this.envMap.toJSON($e).uuid,Be.reflectivity=this.reflectivity,Be.refractionRatio=this.refractionRatio,this.combine!==void 0&&(Be.combine=this.combine),this.envMapIntensity!==void 0&&(Be.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(Be.gradientMap=this.gradientMap.toJSON($e).uuid),this.size!==void 0&&(Be.size=this.size),this.sizeAttenuation!==void 0&&(Be.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(Be.blending=this.blending),this.flatShading===!0&&(Be.flatShading=this.flatShading),this.side!==FrontSide&&(Be.side=this.side),this.vertexColors&&(Be.vertexColors=!0),this.opacity<1&&(Be.opacity=this.opacity),this.transparent===!0&&(Be.transparent=this.transparent),Be.depthFunc=this.depthFunc,Be.depthTest=this.depthTest,Be.depthWrite=this.depthWrite,Be.stencilWrite=this.stencilWrite,Be.stencilWriteMask=this.stencilWriteMask,Be.stencilFunc=this.stencilFunc,Be.stencilRef=this.stencilRef,Be.stencilFuncMask=this.stencilFuncMask,Be.stencilFail=this.stencilFail,Be.stencilZFail=this.stencilZFail,Be.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(Be.rotation=this.rotation),this.polygonOffset===!0&&(Be.polygonOffset=!0),this.polygonOffsetFactor!==0&&(Be.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(Be.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(Be.linewidth=this.linewidth),this.dashSize!==void 0&&(Be.dashSize=this.dashSize),this.gapSize!==void 0&&(Be.gapSize=this.gapSize),this.scale!==void 0&&(Be.scale=this.scale),this.dithering===!0&&(Be.dithering=!0),this.alphaTest>0&&(Be.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(Be.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(Be.wireframe=this.wireframe),this.wireframeLinewidth>1&&(Be.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(Be.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(Be.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(Be.morphTargets=!0),this.morphNormals===!0&&(Be.morphNormals=!0),this.skinning===!0&&(Be.skinning=!0),this.visible===!1&&(Be.visible=!1),this.toneMapped===!1&&(Be.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(Be.userData=this.userData);function De(Je){var Xe=[];for(var Ke in Je){var Ye=Je[Ke];delete Ye.metadata,Xe.push(Ye)}return Xe}if(Se){var Ve=De($e.textures),Fe=De($e.images);Ve.length>0&&(Be.textures=Ve),Fe.length>0&&(Be.images=Fe)}return Be},clone:function(){return new this.constructor().copy(this)},copy:function($e){this.name=$e.name,this.fog=$e.fog,this.blending=$e.blending,this.side=$e.side,this.flatShading=$e.flatShading,this.vertexColors=$e.vertexColors,this.opacity=$e.opacity,this.transparent=$e.transparent,this.blendSrc=$e.blendSrc,this.blendDst=$e.blendDst,this.blendEquation=$e.blendEquation,this.blendSrcAlpha=$e.blendSrcAlpha,this.blendDstAlpha=$e.blendDstAlpha,this.blendEquationAlpha=$e.blendEquationAlpha,this.depthFunc=$e.depthFunc,this.depthTest=$e.depthTest,this.depthWrite=$e.depthWrite,this.stencilWriteMask=$e.stencilWriteMask,this.stencilFunc=$e.stencilFunc,this.stencilRef=$e.stencilRef,this.stencilFuncMask=$e.stencilFuncMask,this.stencilFail=$e.stencilFail,this.stencilZFail=$e.stencilZFail,this.stencilZPass=$e.stencilZPass,this.stencilWrite=$e.stencilWrite;var Se=$e.clippingPlanes,Be=null;if(Se!==null){var De=Se.length;Be=new Array(De);for(var Ve=0;Ve!==De;++Ve)Be[Ve]=Se[Ve].clone()}return this.clippingPlanes=Be,this.clipIntersection=$e.clipIntersection,this.clipShadows=$e.clipShadows,this.shadowSide=$e.shadowSide,this.colorWrite=$e.colorWrite,this.precision=$e.precision,this.polygonOffset=$e.polygonOffset,this.polygonOffsetFactor=$e.polygonOffsetFactor,this.polygonOffsetUnits=$e.polygonOffsetUnits,this.dithering=$e.dithering,this.alphaTest=$e.alphaTest,this.premultipliedAlpha=$e.premultipliedAlpha,this.visible=$e.visible,this.toneMapped=$e.toneMapped,this.userData=JSON.parse(JSON.stringify($e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(Material.prototype,"needsUpdate",{set:function($e){$e===!0&&this.version++}});function MeshBasicMaterial($e){Material.call(this),this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues($e)}MeshBasicMaterial.prototype=Object.create(Material.prototype);MeshBasicMaterial.prototype.constructor=MeshBasicMaterial;MeshBasicMaterial.prototype.isMeshBasicMaterial=!0;MeshBasicMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.color.copy($e.color),this.map=$e.map,this.lightMap=$e.lightMap,this.lightMapIntensity=$e.lightMapIntensity,this.aoMap=$e.aoMap,this.aoMapIntensity=$e.aoMapIntensity,this.specularMap=$e.specularMap,this.alphaMap=$e.alphaMap,this.envMap=$e.envMap,this.combine=$e.combine,this.reflectivity=$e.reflectivity,this.refractionRatio=$e.refractionRatio,this.wireframe=$e.wireframe,this.wireframeLinewidth=$e.wireframeLinewidth,this.wireframeLinecap=$e.wireframeLinecap,this.wireframeLinejoin=$e.wireframeLinejoin,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this};var _vector$3=new Vector3;function BufferAttribute($e,Se,Be){if(Array.isArray($e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=$e,this.itemSize=Se,this.count=$e!==void 0?$e.length/Se:0,this.normalized=Be===!0,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(BufferAttribute.prototype,"needsUpdate",{set:function($e){$e===!0&&this.version++}});Object.assign(BufferAttribute.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function($e){return this.usage=$e,this},copy:function($e){return this.name=$e.name,this.array=new $e.array.constructor($e.array),this.itemSize=$e.itemSize,this.count=$e.count,this.normalized=$e.normalized,this.usage=$e.usage,this},copyAt:function($e,Se,Be){$e*=this.itemSize,Be*=Se.itemSize;for(var De=0,Ve=this.itemSize;De<Ve;De++)this.array[$e+De]=Se.array[Be+De];return this},copyArray:function($e){return this.array.set($e),this},copyColorsArray:function($e){for(var Se=this.array,Be=0,De=0,Ve=$e.length;De<Ve;De++){var Fe=$e[De];Fe===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",De),Fe=new Color),Se[Be++]=Fe.r,Se[Be++]=Fe.g,Se[Be++]=Fe.b}return this},copyVector2sArray:function($e){for(var Se=this.array,Be=0,De=0,Ve=$e.length;De<Ve;De++){var Fe=$e[De];Fe===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",De),Fe=new Vector2),Se[Be++]=Fe.x,Se[Be++]=Fe.y}return this},copyVector3sArray:function($e){for(var Se=this.array,Be=0,De=0,Ve=$e.length;De<Ve;De++){var Fe=$e[De];Fe===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",De),Fe=new Vector3),Se[Be++]=Fe.x,Se[Be++]=Fe.y,Se[Be++]=Fe.z}return this},copyVector4sArray:function($e){for(var Se=this.array,Be=0,De=0,Ve=$e.length;De<Ve;De++){var Fe=$e[De];Fe===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",De),Fe=new Vector4),Se[Be++]=Fe.x,Se[Be++]=Fe.y,Se[Be++]=Fe.z,Se[Be++]=Fe.w}return this},applyMatrix3:function($e){for(var Se=0,Be=this.count;Se<Be;Se++)_vector$3.x=this.getX(Se),_vector$3.y=this.getY(Se),_vector$3.z=this.getZ(Se),_vector$3.applyMatrix3($e),this.setXYZ(Se,_vector$3.x,_vector$3.y,_vector$3.z);return this},applyMatrix4:function($e){for(var Se=0,Be=this.count;Se<Be;Se++)_vector$3.x=this.getX(Se),_vector$3.y=this.getY(Se),_vector$3.z=this.getZ(Se),_vector$3.applyMatrix4($e),this.setXYZ(Se,_vector$3.x,_vector$3.y,_vector$3.z);return this},applyNormalMatrix:function($e){for(var Se=0,Be=this.count;Se<Be;Se++)_vector$3.x=this.getX(Se),_vector$3.y=this.getY(Se),_vector$3.z=this.getZ(Se),_vector$3.applyNormalMatrix($e),this.setXYZ(Se,_vector$3.x,_vector$3.y,_vector$3.z);return this},transformDirection:function($e){for(var Se=0,Be=this.count;Se<Be;Se++)_vector$3.x=this.getX(Se),_vector$3.y=this.getY(Se),_vector$3.z=this.getZ(Se),_vector$3.transformDirection($e),this.setXYZ(Se,_vector$3.x,_vector$3.y,_vector$3.z);return this},set:function($e,Se){return Se===void 0&&(Se=0),this.array.set($e,Se),this},getX:function($e){return this.array[$e*this.itemSize]},setX:function($e,Se){return this.array[$e*this.itemSize]=Se,this},getY:function($e){return this.array[$e*this.itemSize+1]},setY:function($e,Se){return this.array[$e*this.itemSize+1]=Se,this},getZ:function($e){return this.array[$e*this.itemSize+2]},setZ:function($e,Se){return this.array[$e*this.itemSize+2]=Se,this},getW:function($e){return this.array[$e*this.itemSize+3]},setW:function($e,Se){return this.array[$e*this.itemSize+3]=Se,this},setXY:function($e,Se,Be){return $e*=this.itemSize,this.array[$e+0]=Se,this.array[$e+1]=Be,this},setXYZ:function($e,Se,Be,De){return $e*=this.itemSize,this.array[$e+0]=Se,this.array[$e+1]=Be,this.array[$e+2]=De,this},setXYZW:function($e,Se,Be,De,Ve){return $e*=this.itemSize,this.array[$e+0]=Se,this.array[$e+1]=Be,this.array[$e+2]=De,this.array[$e+3]=Ve,this},onUpload:function($e){return this.onUploadCallback=$e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Int8BufferAttribute($e,Se,Be){BufferAttribute.call(this,new Int8Array($e),Se,Be)}Int8BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Int8BufferAttribute.prototype.constructor=Int8BufferAttribute;function Uint8BufferAttribute($e,Se,Be){BufferAttribute.call(this,new Uint8Array($e),Se,Be)}Uint8BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Uint8BufferAttribute.prototype.constructor=Uint8BufferAttribute;function Uint8ClampedBufferAttribute($e,Se,Be){BufferAttribute.call(this,new Uint8ClampedArray($e),Se,Be)}Uint8ClampedBufferAttribute.prototype=Object.create(BufferAttribute.prototype);Uint8ClampedBufferAttribute.prototype.constructor=Uint8ClampedBufferAttribute;function Int16BufferAttribute($e,Se,Be){BufferAttribute.call(this,new Int16Array($e),Se,Be)}Int16BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Int16BufferAttribute.prototype.constructor=Int16BufferAttribute;function Uint16BufferAttribute($e,Se,Be){BufferAttribute.call(this,new Uint16Array($e),Se,Be)}Uint16BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Uint16BufferAttribute.prototype.constructor=Uint16BufferAttribute;function Int32BufferAttribute($e,Se,Be){BufferAttribute.call(this,new Int32Array($e),Se,Be)}Int32BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Int32BufferAttribute.prototype.constructor=Int32BufferAttribute;function Uint32BufferAttribute($e,Se,Be){BufferAttribute.call(this,new Uint32Array($e),Se,Be)}Uint32BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Uint32BufferAttribute.prototype.constructor=Uint32BufferAttribute;function Float32BufferAttribute($e,Se,Be){BufferAttribute.call(this,new Float32Array($e),Se,Be)}Float32BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Float32BufferAttribute.prototype.constructor=Float32BufferAttribute;function Float64BufferAttribute($e,Se,Be){BufferAttribute.call(this,new Float64Array($e),Se,Be)}Float64BufferAttribute.prototype=Object.create(BufferAttribute.prototype);Float64BufferAttribute.prototype.constructor=Float64BufferAttribute;function DirectGeometry(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(DirectGeometry.prototype,{computeGroups:function($e){for(var Se,Be=[],De=void 0,Ve=$e.faces,Fe=0;Fe<Ve.length;Fe++){var Je=Ve[Fe];Je.materialIndex!==De&&(De=Je.materialIndex,Se!==void 0&&(Se.count=Fe*3-Se.start,Be.push(Se)),Se={start:Fe*3,materialIndex:De})}Se!==void 0&&(Se.count=Fe*3-Se.start,Be.push(Se)),this.groups=Be},fromGeometry:function($e){var Se=$e.faces,Be=$e.vertices,De=$e.faceVertexUvs,Ve=De[0]&&De[0].length>0,Fe=De[1]&&De[1].length>0,Je=$e.morphTargets,Xe=Je.length,Ke;if(Xe>0){Ke=[];for(var Ye=0;Ye<Xe;Ye++)Ke[Ye]={name:Je[Ye].name,data:[]};this.morphTargets.position=Ke}var or=$e.morphNormals,sr=or.length,cr;if(sr>0){cr=[];for(var Ye=0;Ye<sr;Ye++)cr[Ye]={name:or[Ye].name,data:[]};this.morphTargets.normal=cr}var Br=$e.skinIndices,tn=$e.skinWeights,en=Br.length===Be.length,an=tn.length===Be.length;Be.length>0&&Se.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var Ye=0;Ye<Se.length;Ye++){var rn=Se[Ye];this.vertices.push(Be[rn.a],Be[rn.b],Be[rn.c]);var on=rn.vertexNormals;if(on.length===3)this.normals.push(on[0],on[1],on[2]);else{var sn=rn.normal;this.normals.push(sn,sn,sn)}var ln=rn.vertexColors;if(ln.length===3)this.colors.push(ln[0],ln[1],ln[2]);else{var cn=rn.color;this.colors.push(cn,cn,cn)}if(Ve===!0){var hn=De[0][Ye];hn!==void 0?this.uvs.push(hn[0],hn[1],hn[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",Ye),this.uvs.push(new Vector2,new Vector2,new Vector2))}if(Fe===!0){var hn=De[1][Ye];hn!==void 0?this.uvs2.push(hn[0],hn[1],hn[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",Ye),this.uvs2.push(new Vector2,new Vector2,new Vector2))}for(var mn=0;mn<Xe;mn++){var An=Je[mn].vertices;Ke[mn].data.push(An[rn.a],An[rn.b],An[rn.c])}for(var mn=0;mn<sr;mn++){var xn=or[mn].vertexNormals[Ye];cr[mn].data.push(xn.a,xn.b,xn.c)}en&&this.skinIndices.push(Br[rn.a],Br[rn.b],Br[rn.c]),an&&this.skinWeights.push(tn[rn.a],tn[rn.b],tn[rn.c])}return this.computeGroups($e),this.verticesNeedUpdate=$e.verticesNeedUpdate,this.normalsNeedUpdate=$e.normalsNeedUpdate,this.colorsNeedUpdate=$e.colorsNeedUpdate,this.uvsNeedUpdate=$e.uvsNeedUpdate,this.groupsNeedUpdate=$e.groupsNeedUpdate,$e.boundingSphere!==null&&(this.boundingSphere=$e.boundingSphere.clone()),$e.boundingBox!==null&&(this.boundingBox=$e.boundingBox.clone()),this}});function arrayMax($e){if($e.length===0)return-1/0;let Se=$e[0];for(let Be=1,De=$e.length;Be<De;++Be)$e[Be]>Se&&(Se=$e[Be]);return Se}var _bufferGeometryId=1,_m1$2=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$4=new Vector3;function BufferGeometry(){Object.defineProperty(this,"id",{value:_bufferGeometryId+=2}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}BufferGeometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:BufferGeometry,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function($e){Array.isArray($e)?this.index=new(arrayMax($e)>65535?Uint32BufferAttribute:Uint16BufferAttribute)($e,1):this.index=$e},getAttribute:function($e){return this.attributes[$e]},setAttribute:function($e,Se){return this.attributes[$e]=Se,this},deleteAttribute:function($e){return delete this.attributes[$e],this},addGroup:function($e,Se,Be){this.groups.push({start:$e,count:Se,materialIndex:Be!==void 0?Be:0})},clearGroups:function(){this.groups=[]},setDrawRange:function($e,Se){this.drawRange.start=$e,this.drawRange.count=Se},applyMatrix4:function($e){var Se=this.attributes.position;Se!==void 0&&(Se.applyMatrix4($e),Se.needsUpdate=!0);var Be=this.attributes.normal;if(Be!==void 0){var De=new Matrix3().getNormalMatrix($e);Be.applyNormalMatrix(De),Be.needsUpdate=!0}var Ve=this.attributes.tangent;return Ve!==void 0&&(Ve.transformDirection($e),Ve.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function($e){return _m1$2.makeRotationX($e),this.applyMatrix4(_m1$2),this},rotateY:function($e){return _m1$2.makeRotationY($e),this.applyMatrix4(_m1$2),this},rotateZ:function($e){return _m1$2.makeRotationZ($e),this.applyMatrix4(_m1$2),this},translate:function($e,Se,Be){return _m1$2.makeTranslation($e,Se,Be),this.applyMatrix4(_m1$2),this},scale:function($e,Se,Be){return _m1$2.makeScale($e,Se,Be),this.applyMatrix4(_m1$2),this},lookAt:function($e){return _obj.lookAt($e),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this},setFromObject:function($e){var Se=$e.geometry;if($e.isPoints||$e.isLine){var Be=new Float32BufferAttribute(Se.vertices.length*3,3),De=new Float32BufferAttribute(Se.colors.length*3,3);if(this.setAttribute("position",Be.copyVector3sArray(Se.vertices)),this.setAttribute("color",De.copyColorsArray(Se.colors)),Se.lineDistances&&Se.lineDistances.length===Se.vertices.length){var Ve=new Float32BufferAttribute(Se.lineDistances.length,1);this.setAttribute("lineDistance",Ve.copyArray(Se.lineDistances))}Se.boundingSphere!==null&&(this.boundingSphere=Se.boundingSphere.clone()),Se.boundingBox!==null&&(this.boundingBox=Se.boundingBox.clone())}else $e.isMesh&&Se&&Se.isGeometry&&this.fromGeometry(Se);return this},setFromPoints:function($e){for(var Se=[],Be=0,De=$e.length;Be<De;Be++){var Ve=$e[Be];Se.push(Ve.x,Ve.y,Ve.z||0)}return this.setAttribute("position",new Float32BufferAttribute(Se,3)),this},updateFromObject:function($e){var Se=$e.geometry;if($e.isMesh){var Be=Se.__directGeometry;if(Se.elementsNeedUpdate===!0&&(Be=void 0,Se.elementsNeedUpdate=!1),Be===void 0)return this.fromGeometry(Se);Be.verticesNeedUpdate=Se.verticesNeedUpdate,Be.normalsNeedUpdate=Se.normalsNeedUpdate,Be.colorsNeedUpdate=Se.colorsNeedUpdate,Be.uvsNeedUpdate=Se.uvsNeedUpdate,Be.groupsNeedUpdate=Se.groupsNeedUpdate,Se.verticesNeedUpdate=!1,Se.normalsNeedUpdate=!1,Se.colorsNeedUpdate=!1,Se.uvsNeedUpdate=!1,Se.groupsNeedUpdate=!1,Se=Be}var De;return Se.verticesNeedUpdate===!0&&(De=this.attributes.position,De!==void 0&&(De.copyVector3sArray(Se.vertices),De.needsUpdate=!0),Se.verticesNeedUpdate=!1),Se.normalsNeedUpdate===!0&&(De=this.attributes.normal,De!==void 0&&(De.copyVector3sArray(Se.normals),De.needsUpdate=!0),Se.normalsNeedUpdate=!1),Se.colorsNeedUpdate===!0&&(De=this.attributes.color,De!==void 0&&(De.copyColorsArray(Se.colors),De.needsUpdate=!0),Se.colorsNeedUpdate=!1),Se.uvsNeedUpdate&&(De=this.attributes.uv,De!==void 0&&(De.copyVector2sArray(Se.uvs),De.needsUpdate=!0),Se.uvsNeedUpdate=!1),Se.lineDistancesNeedUpdate&&(De=this.attributes.lineDistance,De!==void 0&&(De.copyArray(Se.lineDistances),De.needsUpdate=!0),Se.lineDistancesNeedUpdate=!1),Se.groupsNeedUpdate&&(Se.computeGroups($e.geometry),this.groups=Se.groups,Se.groupsNeedUpdate=!1),this},fromGeometry:function($e){return $e.__directGeometry=new DirectGeometry().fromGeometry($e),this.fromDirectGeometry($e.__directGeometry)},fromDirectGeometry:function($e){var Se=new Float32Array($e.vertices.length*3);if(this.setAttribute("position",new BufferAttribute(Se,3).copyVector3sArray($e.vertices)),$e.normals.length>0){var Be=new Float32Array($e.normals.length*3);this.setAttribute("normal",new BufferAttribute(Be,3).copyVector3sArray($e.normals))}if($e.colors.length>0){var De=new Float32Array($e.colors.length*3);this.setAttribute("color",new BufferAttribute(De,3).copyColorsArray($e.colors))}if($e.uvs.length>0){var Ve=new Float32Array($e.uvs.length*2);this.setAttribute("uv",new BufferAttribute(Ve,2).copyVector2sArray($e.uvs))}if($e.uvs2.length>0){var Fe=new Float32Array($e.uvs2.length*2);this.setAttribute("uv2",new BufferAttribute(Fe,2).copyVector2sArray($e.uvs2))}this.groups=$e.groups;for(var Je in $e.morphTargets){for(var Xe=[],Ke=$e.morphTargets[Je],Ye=0,or=Ke.length;Ye<or;Ye++){var sr=Ke[Ye],cr=new Float32BufferAttribute(sr.data.length*3,3);cr.name=sr.name,Xe.push(cr.copyVector3sArray(sr.data))}this.morphAttributes[Je]=Xe}if($e.skinIndices.length>0){var Br=new Float32BufferAttribute($e.skinIndices.length*4,4);this.setAttribute("skinIndex",Br.copyVector4sArray($e.skinIndices))}if($e.skinWeights.length>0){var tn=new Float32BufferAttribute($e.skinWeights.length*4,4);this.setAttribute("skinWeight",tn.copyVector4sArray($e.skinWeights))}return $e.boundingSphere!==null&&(this.boundingSphere=$e.boundingSphere.clone()),$e.boundingBox!==null&&(this.boundingBox=$e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Box3);var $e=this.attributes.position,Se=this.morphAttributes.position;if($e!==void 0){if(this.boundingBox.setFromBufferAttribute($e),Se)for(var Be=0,De=Se.length;Be<De;Be++){var Ve=Se[Be];_box$2.setFromBufferAttribute(Ve),this.morphTargetsRelative?(_vector$4.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$4),_vector$4.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$4)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);var $e=this.attributes.position,Se=this.morphAttributes.position;if($e){var Be=this.boundingSphere.center;if(_box$2.setFromBufferAttribute($e),Se)for(var De=0,Ve=Se.length;De<Ve;De++){var Fe=Se[De];_boxMorphTargets.setFromBufferAttribute(Fe),this.morphTargetsRelative?(_vector$4.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$4),_vector$4.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$4)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(Be);for(var Je=0,De=0,Ve=$e.count;De<Ve;De++)_vector$4.fromBufferAttribute($e,De),Je=Math.max(Je,Be.distanceToSquared(_vector$4));if(Se)for(var De=0,Ve=Se.length;De<Ve;De++)for(var Fe=Se[De],Xe=this.morphTargetsRelative,Ke=0,Ye=Fe.count;Ke<Ye;Ke++)_vector$4.fromBufferAttribute(Fe,Ke),Xe&&(_offset.fromBufferAttribute($e,Ke),_vector$4.add(_offset)),Je=Math.max(Je,Be.distanceToSquared(_vector$4));this.boundingSphere.radius=Math.sqrt(Je),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var $e=this.index,Se=this.attributes;if(Se.position){var Be=Se.position.array;if(Se.normal===void 0)this.setAttribute("normal",new BufferAttribute(new Float32Array(Be.length),3));else for(var De=Se.normal.array,Ve=0,Fe=De.length;Ve<Fe;Ve++)De[Ve]=0;var Je=Se.normal.array,Xe,Ke,Ye,or=new Vector3,sr=new Vector3,cr=new Vector3,Br=new Vector3,tn=new Vector3;if($e)for(var en=$e.array,Ve=0,Fe=$e.count;Ve<Fe;Ve+=3)Xe=en[Ve+0]*3,Ke=en[Ve+1]*3,Ye=en[Ve+2]*3,or.fromArray(Be,Xe),sr.fromArray(Be,Ke),cr.fromArray(Be,Ye),Br.subVectors(cr,sr),tn.subVectors(or,sr),Br.cross(tn),Je[Xe]+=Br.x,Je[Xe+1]+=Br.y,Je[Xe+2]+=Br.z,Je[Ke]+=Br.x,Je[Ke+1]+=Br.y,Je[Ke+2]+=Br.z,Je[Ye]+=Br.x,Je[Ye+1]+=Br.y,Je[Ye+2]+=Br.z;else for(var Ve=0,Fe=Be.length;Ve<Fe;Ve+=9)or.fromArray(Be,Ve),sr.fromArray(Be,Ve+3),cr.fromArray(Be,Ve+6),Br.subVectors(cr,sr),tn.subVectors(or,sr),Br.cross(tn),Je[Ve]=Br.x,Je[Ve+1]=Br.y,Je[Ve+2]=Br.z,Je[Ve+3]=Br.x,Je[Ve+4]=Br.y,Je[Ve+5]=Br.z,Je[Ve+6]=Br.x,Je[Ve+7]=Br.y,Je[Ve+8]=Br.z;this.normalizeNormals(),Se.normal.needsUpdate=!0}},merge:function($e,Se){if(!($e&&$e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",$e);return}Se===void 0&&(Se=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var Be=this.attributes;for(var De in Be)if($e.attributes[De]!==void 0)for(var Ve=Be[De],Fe=Ve.array,Je=$e.attributes[De],Xe=Je.array,Ke=Je.itemSize*Se,Ye=Math.min(Xe.length,Fe.length-Ke),or=0,sr=Ke;or<Ye;or++,sr++)Fe[sr]=Xe[or];return this},normalizeNormals:function(){for(var $e=this.attributes.normal,Se=0,Be=$e.count;Se<Be;Se++)_vector$4.x=$e.getX(Se),_vector$4.y=$e.getY(Se),_vector$4.z=$e.getZ(Se),_vector$4.normalize(),$e.setXYZ(Se,_vector$4.x,_vector$4.y,_vector$4.z)},toNonIndexed:function(){function $e(en,an){for(var rn=en.array,on=en.itemSize,sn=en.normalized,ln=new rn.constructor(an.length*on),cn=0,hn=0,mn=0,An=an.length;mn<An;mn++){cn=an[mn]*on;for(var xn=0;xn<on;xn++)ln[hn++]=rn[cn++]}return new BufferAttribute(ln,on,sn)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var Se=new BufferGeometry,Be=this.index.array,De=this.attributes;for(var Ve in De){var Fe=De[Ve],Je=$e(Fe,Be);Se.setAttribute(Ve,Je)}var Xe=this.morphAttributes;for(Ve in Xe){for(var Ke=[],Ye=Xe[Ve],or=0,sr=Ye.length;or<sr;or++){var Fe=Ye[or],Je=$e(Fe,Be);Ke.push(Je)}Se.morphAttributes[Ve]=Ke}Se.morphTargetsRelative=this.morphTargetsRelative;for(var cr=this.groups,or=0,Br=cr.length;or<Br;or++){var tn=cr[or];Se.addGroup(tn.start,tn.count,tn.materialIndex)}return Se},toJSON:function(){var $e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if($e.uuid=this.uuid,$e.type=this.type,this.name!==""&&($e.name=this.name),Object.keys(this.userData).length>0&&($e.userData=this.userData),this.parameters!==void 0){var Se=this.parameters;for(var Be in Se)Se[Be]!==void 0&&($e[Be]=Se[Be]);return $e}$e.data={attributes:{}};var De=this.index;De!==null&&($e.data.index={type:De.array.constructor.name,array:Array.prototype.slice.call(De.array)});var Ve=this.attributes;for(var Be in Ve){var Fe=Ve[Be],Je=Fe.toJSON();Fe.name!==""&&(Je.name=Fe.name),$e.data.attributes[Be]=Je}var Xe={},Ke=!1;for(var Be in this.morphAttributes){for(var Ye=this.morphAttributes[Be],or=[],sr=0,cr=Ye.length;sr<cr;sr++){var Fe=Ye[sr],Je=Fe.toJSON();Fe.name!==""&&(Je.name=Fe.name),or.push(Je)}or.length>0&&(Xe[Be]=or,Ke=!0)}Ke&&($e.data.morphAttributes=Xe,$e.data.morphTargetsRelative=this.morphTargetsRelative);var Br=this.groups;Br.length>0&&($e.data.groups=JSON.parse(JSON.stringify(Br)));var tn=this.boundingSphere;return tn!==null&&($e.data.boundingSphere={center:tn.center.toArray(),radius:tn.radius}),$e},clone:function(){return new BufferGeometry().copy(this)},copy:function($e){var Se,Be,De;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=$e.name;var Ve=$e.index;Ve!==null&&this.setIndex(Ve.clone());var Fe=$e.attributes;for(Se in Fe){var Je=Fe[Se];this.setAttribute(Se,Je.clone())}var Xe=$e.morphAttributes;for(Se in Xe){var Ke=[],Ye=Xe[Se];for(Be=0,De=Ye.length;Be<De;Be++)Ke.push(Ye[Be].clone());this.morphAttributes[Se]=Ke}this.morphTargetsRelative=$e.morphTargetsRelative;var or=$e.groups;for(Be=0,De=or.length;Be<De;Be++){var sr=or[Be];this.addGroup(sr.start,sr.count,sr.materialIndex)}var cr=$e.boundingBox;cr!==null&&(this.boundingBox=cr.clone());var Br=$e.boundingSphere;return Br!==null&&(this.boundingSphere=Br.clone()),this.drawRange.start=$e.drawRange.start,this.drawRange.count=$e.drawRange.count,this.userData=$e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var _inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_tempA=new Vector3,_tempB=new Vector3,_tempC=new Vector3,_morphA=new Vector3,_morphB=new Vector3,_morphC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;function Mesh($e,Se){Object3D.call(this),this.type="Mesh",this.geometry=$e!==void 0?$e:new BufferGeometry,this.material=Se!==void 0?Se:new MeshBasicMaterial,this.updateMorphTargets()}Mesh.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Mesh,isMesh:!0,copy:function($e){return Object3D.prototype.copy.call(this,$e),$e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=$e.morphTargetInfluences.slice()),$e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},$e.morphTargetDictionary)),this},updateMorphTargets:function(){var $e=this.geometry,Se,Be,De;if($e.isBufferGeometry){var Ve=$e.morphAttributes,Fe=Object.keys(Ve);if(Fe.length>0){var Je=Ve[Fe[0]];if(Je!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},Se=0,Be=Je.length;Se<Be;Se++)De=Je[Se].name||String(Se),this.morphTargetInfluences.push(0),this.morphTargetDictionary[De]=Se}}else{var Xe=$e.morphTargets;Xe!==void 0&&Xe.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function($e,Se){var Be=this.geometry,De=this.material,Ve=this.matrixWorld;if(De!==void 0&&(Be.boundingSphere===null&&Be.computeBoundingSphere(),_sphere.copy(Be.boundingSphere),_sphere.applyMatrix4(Ve),$e.ray.intersectsSphere(_sphere)!==!1&&(_inverseMatrix.getInverse(Ve),_ray.copy($e.ray).applyMatrix4(_inverseMatrix),!(Be.boundingBox!==null&&_ray.intersectsBox(Be.boundingBox)===!1)))){var Fe;if(Be.isBufferGeometry){var Je,Xe,Ke,Ye=Be.index,or=Be.attributes.position,sr=Be.morphAttributes.position,cr=Be.morphTargetsRelative,Br=Be.attributes.uv,tn=Be.attributes.uv2,en=Be.groups,an=Be.drawRange,rn,on,sn,ln,cn,hn,mn,An;if(Ye!==null)if(Array.isArray(De))for(rn=0,sn=en.length;rn<sn;rn++)for(cn=en[rn],hn=De[cn.materialIndex],mn=Math.max(cn.start,an.start),An=Math.min(cn.start+cn.count,an.start+an.count),on=mn,ln=An;on<ln;on+=3)Je=Ye.getX(on),Xe=Ye.getX(on+1),Ke=Ye.getX(on+2),Fe=checkBufferGeometryIntersection(this,hn,$e,_ray,or,sr,cr,Br,tn,Je,Xe,Ke),Fe&&(Fe.faceIndex=Math.floor(on/3),Fe.face.materialIndex=cn.materialIndex,Se.push(Fe));else for(mn=Math.max(0,an.start),An=Math.min(Ye.count,an.start+an.count),rn=mn,sn=An;rn<sn;rn+=3)Je=Ye.getX(rn),Xe=Ye.getX(rn+1),Ke=Ye.getX(rn+2),Fe=checkBufferGeometryIntersection(this,De,$e,_ray,or,sr,cr,Br,tn,Je,Xe,Ke),Fe&&(Fe.faceIndex=Math.floor(rn/3),Se.push(Fe));else if(or!==void 0)if(Array.isArray(De))for(rn=0,sn=en.length;rn<sn;rn++)for(cn=en[rn],hn=De[cn.materialIndex],mn=Math.max(cn.start,an.start),An=Math.min(cn.start+cn.count,an.start+an.count),on=mn,ln=An;on<ln;on+=3)Je=on,Xe=on+1,Ke=on+2,Fe=checkBufferGeometryIntersection(this,hn,$e,_ray,or,sr,cr,Br,tn,Je,Xe,Ke),Fe&&(Fe.faceIndex=Math.floor(on/3),Fe.face.materialIndex=cn.materialIndex,Se.push(Fe));else for(mn=Math.max(0,an.start),An=Math.min(or.count,an.start+an.count),rn=mn,sn=An;rn<sn;rn+=3)Je=rn,Xe=rn+1,Ke=rn+2,Fe=checkBufferGeometryIntersection(this,De,$e,_ray,or,sr,cr,Br,tn,Je,Xe,Ke),Fe&&(Fe.faceIndex=Math.floor(rn/3),Se.push(Fe))}else if(Be.isGeometry){var xn,pn,dn,fn=Array.isArray(De),yn=Be.vertices,Sn=Be.faces,gn,Cn=Be.faceVertexUvs[0];Cn.length>0&&(gn=Cn);for(var Mn=0,Bn=Sn.length;Mn<Bn;Mn++){var kn=Sn[Mn],Ln=fn?De[kn.materialIndex]:De;if(Ln!==void 0&&(xn=yn[kn.a],pn=yn[kn.b],dn=yn[kn.c],Fe=checkIntersection(this,Ln,$e,_ray,xn,pn,dn,_intersectionPoint),Fe)){if(gn&&gn[Mn]){var Pn=gn[Mn];_uvA.copy(Pn[0]),_uvB.copy(Pn[1]),_uvC.copy(Pn[2]),Fe.uv=Triangle.getUV(_intersectionPoint,xn,pn,dn,_uvA,_uvB,_uvC,new Vector2)}Fe.face=kn,Fe.faceIndex=Mn,Se.push(Fe)}}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function checkIntersection($e,Se,Be,De,Ve,Fe,Je,Xe){var Ke;if(Se.side===BackSide?Ke=De.intersectTriangle(Je,Fe,Ve,!0,Xe):Ke=De.intersectTriangle(Ve,Fe,Je,Se.side!==DoubleSide,Xe),Ke===null)return null;_intersectionPointWorld.copy(Xe),_intersectionPointWorld.applyMatrix4($e.matrixWorld);var Ye=Be.ray.origin.distanceTo(_intersectionPointWorld);return Ye<Be.near||Ye>Be.far?null:{distance:Ye,point:_intersectionPointWorld.clone(),object:$e}}function checkBufferGeometryIntersection($e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr){_vA.fromBufferAttribute(Ve,Ye),_vB.fromBufferAttribute(Ve,or),_vC.fromBufferAttribute(Ve,sr);var cr=$e.morphTargetInfluences;if(Se.morphTargets&&Fe&&cr){_morphA.set(0,0,0),_morphB.set(0,0,0),_morphC.set(0,0,0);for(var Br=0,tn=Fe.length;Br<tn;Br++){var en=cr[Br],an=Fe[Br];en!==0&&(_tempA.fromBufferAttribute(an,Ye),_tempB.fromBufferAttribute(an,or),_tempC.fromBufferAttribute(an,sr),Je?(_morphA.addScaledVector(_tempA,en),_morphB.addScaledVector(_tempB,en),_morphC.addScaledVector(_tempC,en)):(_morphA.addScaledVector(_tempA.sub(_vA),en),_morphB.addScaledVector(_tempB.sub(_vB),en),_morphC.addScaledVector(_tempC.sub(_vC),en)))}_vA.add(_morphA),_vB.add(_morphB),_vC.add(_morphC)}$e.isSkinnedMesh&&($e.boneTransform(Ye,_vA),$e.boneTransform(or,_vB),$e.boneTransform(sr,_vC));var rn=checkIntersection($e,Se,Be,De,_vA,_vB,_vC,_intersectionPoint);if(rn){Xe&&(_uvA.fromBufferAttribute(Xe,Ye),_uvB.fromBufferAttribute(Xe,or),_uvC.fromBufferAttribute(Xe,sr),rn.uv=Triangle.getUV(_intersectionPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2)),Ke&&(_uvA.fromBufferAttribute(Ke,Ye),_uvB.fromBufferAttribute(Ke,or),_uvC.fromBufferAttribute(Ke,sr),rn.uv2=Triangle.getUV(_intersectionPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2));var on=new Face3(Ye,or,sr);Triangle.getNormal(_vA,_vB,_vC,on.normal),rn.face=on}return rn}var _geometryId=0,_m1$3=new Matrix4,_obj$1=new Object3D,_offset$1=new Vector3;function Geometry(){Object.defineProperty(this,"id",{value:_geometryId+=2}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Geometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Geometry,isGeometry:!0,applyMatrix4:function($e){for(var Se=new Matrix3().getNormalMatrix($e),Be=0,De=this.vertices.length;Be<De;Be++){var Ve=this.vertices[Be];Ve.applyMatrix4($e)}for(var Be=0,De=this.faces.length;Be<De;Be++){var Fe=this.faces[Be];Fe.normal.applyMatrix3(Se).normalize();for(var Je=0,Xe=Fe.vertexNormals.length;Je<Xe;Je++)Fe.vertexNormals[Je].applyMatrix3(Se).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function($e){return _m1$3.makeRotationX($e),this.applyMatrix4(_m1$3),this},rotateY:function($e){return _m1$3.makeRotationY($e),this.applyMatrix4(_m1$3),this},rotateZ:function($e){return _m1$3.makeRotationZ($e),this.applyMatrix4(_m1$3),this},translate:function($e,Se,Be){return _m1$3.makeTranslation($e,Se,Be),this.applyMatrix4(_m1$3),this},scale:function($e,Se,Be){return _m1$3.makeScale($e,Se,Be),this.applyMatrix4(_m1$3),this},lookAt:function($e){return _obj$1.lookAt($e),_obj$1.updateMatrix(),this.applyMatrix4(_obj$1.matrix),this},fromBufferGeometry:function($e){var Se=this,Be=$e.index!==null?$e.index.array:void 0,De=$e.attributes;if(De.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var Ve=De.position.array,Fe=De.normal!==void 0?De.normal.array:void 0,Je=De.color!==void 0?De.color.array:void 0,Xe=De.uv!==void 0?De.uv.array:void 0,Ke=De.uv2!==void 0?De.uv2.array:void 0;Ke!==void 0&&(this.faceVertexUvs[1]=[]);for(var Ye=0;Ye<Ve.length;Ye+=3)Se.vertices.push(new Vector3().fromArray(Ve,Ye)),Je!==void 0&&Se.colors.push(new Color().fromArray(Je,Ye));function or(rn,on,sn,ln){var cn=Je===void 0?[]:[Se.colors[rn].clone(),Se.colors[on].clone(),Se.colors[sn].clone()],hn=Fe===void 0?[]:[new Vector3().fromArray(Fe,rn*3),new Vector3().fromArray(Fe,on*3),new Vector3().fromArray(Fe,sn*3)],mn=new Face3(rn,on,sn,hn,cn,ln);Se.faces.push(mn),Xe!==void 0&&Se.faceVertexUvs[0].push([new Vector2().fromArray(Xe,rn*2),new Vector2().fromArray(Xe,on*2),new Vector2().fromArray(Xe,sn*2)]),Ke!==void 0&&Se.faceVertexUvs[1].push([new Vector2().fromArray(Ke,rn*2),new Vector2().fromArray(Ke,on*2),new Vector2().fromArray(Ke,sn*2)])}var sr=$e.groups;if(sr.length>0)for(var Ye=0;Ye<sr.length;Ye++)for(var cr=sr[Ye],Br=cr.start,tn=cr.count,en=Br,an=Br+tn;en<an;en+=3)Be!==void 0?or(Be[en],Be[en+1],Be[en+2],cr.materialIndex):or(en,en+1,en+2,cr.materialIndex);else if(Be!==void 0)for(var Ye=0;Ye<Be.length;Ye+=3)or(Be[Ye],Be[Ye+1],Be[Ye+2]);else for(var Ye=0;Ye<Ve.length/3;Ye+=3)or(Ye,Ye+1,Ye+2);return this.computeFaceNormals(),$e.boundingBox!==null&&(this.boundingBox=$e.boundingBox.clone()),$e.boundingSphere!==null&&(this.boundingSphere=$e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset$1).negate(),this.translate(_offset$1.x,_offset$1.y,_offset$1.z),this},normalize:function(){this.computeBoundingSphere();var $e=this.boundingSphere.center,Se=this.boundingSphere.radius,Be=Se===0?1:1/Se,De=new Matrix4;return De.set(Be,0,0,-Be*$e.x,0,Be,0,-Be*$e.y,0,0,Be,-Be*$e.z,0,0,0,1),this.applyMatrix4(De),this},computeFaceNormals:function(){for(var $e=new Vector3,Se=new Vector3,Be=0,De=this.faces.length;Be<De;Be++){var Ve=this.faces[Be],Fe=this.vertices[Ve.a],Je=this.vertices[Ve.b],Xe=this.vertices[Ve.c];$e.subVectors(Xe,Je),Se.subVectors(Fe,Je),$e.cross(Se),$e.normalize(),Ve.normal.copy($e)}},computeVertexNormals:function($e){$e===void 0&&($e=!0);var Se,Be,De,Ve,Fe,Je;for(Je=new Array(this.vertices.length),Se=0,Be=this.vertices.length;Se<Be;Se++)Je[Se]=new Vector3;if($e){var Xe,Ke,Ye,or=new Vector3,sr=new Vector3;for(De=0,Ve=this.faces.length;De<Ve;De++)Fe=this.faces[De],Xe=this.vertices[Fe.a],Ke=this.vertices[Fe.b],Ye=this.vertices[Fe.c],or.subVectors(Ye,Ke),sr.subVectors(Xe,Ke),or.cross(sr),Je[Fe.a].add(or),Je[Fe.b].add(or),Je[Fe.c].add(or)}else for(this.computeFaceNormals(),De=0,Ve=this.faces.length;De<Ve;De++)Fe=this.faces[De],Je[Fe.a].add(Fe.normal),Je[Fe.b].add(Fe.normal),Je[Fe.c].add(Fe.normal);for(Se=0,Be=this.vertices.length;Se<Be;Se++)Je[Se].normalize();for(De=0,Ve=this.faces.length;De<Ve;De++){Fe=this.faces[De];var cr=Fe.vertexNormals;cr.length===3?(cr[0].copy(Je[Fe.a]),cr[1].copy(Je[Fe.b]),cr[2].copy(Je[Fe.c])):(cr[0]=Je[Fe.a].clone(),cr[1]=Je[Fe.b].clone(),cr[2]=Je[Fe.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var $e,Se,Be;for(this.computeFaceNormals(),$e=0,Se=this.faces.length;$e<Se;$e++){Be=this.faces[$e];var De=Be.vertexNormals;De.length===3?(De[0].copy(Be.normal),De[1].copy(Be.normal),De[2].copy(Be.normal)):(De[0]=Be.normal.clone(),De[1]=Be.normal.clone(),De[2]=Be.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var $e,Se,Be,De,Ve;for(Be=0,De=this.faces.length;Be<De;Be++)for(Ve=this.faces[Be],Ve.__originalFaceNormal?Ve.__originalFaceNormal.copy(Ve.normal):Ve.__originalFaceNormal=Ve.normal.clone(),Ve.__originalVertexNormals||(Ve.__originalVertexNormals=[]),$e=0,Se=Ve.vertexNormals.length;$e<Se;$e++)Ve.__originalVertexNormals[$e]?Ve.__originalVertexNormals[$e].copy(Ve.vertexNormals[$e]):Ve.__originalVertexNormals[$e]=Ve.vertexNormals[$e].clone();var Fe=new Geometry;for(Fe.faces=this.faces,$e=0,Se=this.morphTargets.length;$e<Se;$e++){if(!this.morphNormals[$e]){this.morphNormals[$e]={},this.morphNormals[$e].faceNormals=[],this.morphNormals[$e].vertexNormals=[];var Je=this.morphNormals[$e].faceNormals,Xe=this.morphNormals[$e].vertexNormals,Ye,or;for(Be=0,De=this.faces.length;Be<De;Be++)Ye=new Vector3,or={a:new Vector3,b:new Vector3,c:new Vector3},Je.push(Ye),Xe.push(or)}var Ke=this.morphNormals[$e];Fe.vertices=this.morphTargets[$e].vertices,Fe.computeFaceNormals(),Fe.computeVertexNormals();var Ye,or;for(Be=0,De=this.faces.length;Be<De;Be++)Ve=this.faces[Be],Ye=Ke.faceNormals[Be],or=Ke.vertexNormals[Be],Ye.copy(Ve.normal),or.a.copy(Ve.vertexNormals[0]),or.b.copy(Ve.vertexNormals[1]),or.c.copy(Ve.vertexNormals[2])}for(Be=0,De=this.faces.length;Be<De;Be++)Ve=this.faces[Be],Ve.normal=Ve.__originalFaceNormal,Ve.vertexNormals=Ve.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function($e,Se,Be){if(!($e&&$e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",$e);return}var De,Ve=this.vertices.length,Fe=this.vertices,Je=$e.vertices,Xe=this.faces,Ke=$e.faces,Ye=this.colors,or=$e.colors;Be===void 0&&(Be=0),Se!==void 0&&(De=new Matrix3().getNormalMatrix(Se));for(var sr=0,cr=Je.length;sr<cr;sr++){var Br=Je[sr],tn=Br.clone();Se!==void 0&&tn.applyMatrix4(Se),Fe.push(tn)}for(var sr=0,cr=or.length;sr<cr;sr++)Ye.push(or[sr].clone());for(sr=0,cr=Ke.length;sr<cr;sr++){var en=Ke[sr],an,rn,on,sn=en.vertexNormals,ln=en.vertexColors;an=new Face3(en.a+Ve,en.b+Ve,en.c+Ve),an.normal.copy(en.normal),De!==void 0&&an.normal.applyMatrix3(De).normalize();for(var cn=0,hn=sn.length;cn<hn;cn++)rn=sn[cn].clone(),De!==void 0&&rn.applyMatrix3(De).normalize(),an.vertexNormals.push(rn);an.color.copy(en.color);for(var cn=0,hn=ln.length;cn<hn;cn++)on=ln[cn],an.vertexColors.push(on.clone());an.materialIndex=en.materialIndex+Be,Xe.push(an)}for(var sr=0,cr=$e.faceVertexUvs.length;sr<cr;sr++){var mn=$e.faceVertexUvs[sr];this.faceVertexUvs[sr]===void 0&&(this.faceVertexUvs[sr]=[]);for(var cn=0,hn=mn.length;cn<hn;cn++){for(var An=mn[cn],xn=[],pn=0,dn=An.length;pn<dn;pn++)xn.push(An[pn].clone());this.faceVertexUvs[sr].push(xn)}}},mergeMesh:function($e){if(!($e&&$e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",$e);return}$e.matrixAutoUpdate&&$e.updateMatrix(),this.merge($e.geometry,$e.matrix)},mergeVertices:function(){var $e={},Se=[],Be=[],De,Ve,Fe=4,Je=Math.pow(10,Fe),Xe,Ke,Ye,or,sr,cr;for(Xe=0,Ke=this.vertices.length;Xe<Ke;Xe++)De=this.vertices[Xe],Ve=Math.round(De.x*Je)+"_"+Math.round(De.y*Je)+"_"+Math.round(De.z*Je),$e[Ve]===void 0?($e[Ve]=Xe,Se.push(this.vertices[Xe]),Be[Xe]=Se.length-1):Be[Xe]=Be[$e[Ve]];var Br=[];for(Xe=0,Ke=this.faces.length;Xe<Ke;Xe++){Ye=this.faces[Xe],Ye.a=Be[Ye.a],Ye.b=Be[Ye.b],Ye.c=Be[Ye.c],or=[Ye.a,Ye.b,Ye.c];for(var tn=0;tn<3;tn++)if(or[tn]===or[(tn+1)%3]){Br.push(Xe);break}}for(Xe=Br.length-1;Xe>=0;Xe--){var en=Br[Xe];for(this.faces.splice(en,1),sr=0,cr=this.faceVertexUvs.length;sr<cr;sr++)this.faceVertexUvs[sr].splice(en,1)}var an=this.vertices.length-Se.length;return this.vertices=Se,an},setFromPoints:function($e){this.vertices=[];for(var Se=0,Be=$e.length;Se<Be;Se++){var De=$e[Se];this.vertices.push(new Vector3(De.x,De.y,De.z||0))}return this},sortFacesByMaterialIndex:function(){for(var $e=this.faces,Se=$e.length,Be=0;Be<Se;Be++)$e[Be]._id=Be;function De(Ye,or){return Ye.materialIndex-or.materialIndex}$e.sort(De);var Ve=this.faceVertexUvs[0],Fe=this.faceVertexUvs[1],Je,Xe;Ve&&Ve.length===Se&&(Je=[]),Fe&&Fe.length===Se&&(Xe=[]);for(var Be=0;Be<Se;Be++){var Ke=$e[Be]._id;Je&&Je.push(Ve[Ke]),Xe&&Xe.push(Fe[Ke])}Je&&(this.faceVertexUvs[0]=Je),Xe&&(this.faceVertexUvs[1]=Xe)},toJSON:function(){var $e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if($e.uuid=this.uuid,$e.type=this.type,this.name!==""&&($e.name=this.name),this.parameters!==void 0){var Se=this.parameters;for(var Be in Se)Se[Be]!==void 0&&($e[Be]=Se[Be]);return $e}for(var De=[],Ve=0;Ve<this.vertices.length;Ve++){var Fe=this.vertices[Ve];De.push(Fe.x,Fe.y,Fe.z)}for(var Je=[],Xe=[],Ke={},Ye=[],or={},sr=[],cr={},Ve=0;Ve<this.faces.length;Ve++){var Br=this.faces[Ve],tn=!0,en=!1,an=this.faceVertexUvs[0][Ve]!==void 0,rn=Br.normal.length()>0,on=Br.vertexNormals.length>0,sn=Br.color.r!==1||Br.color.g!==1||Br.color.b!==1,ln=Br.vertexColors.length>0,cn=0;if(cn=xn(cn,0,0),cn=xn(cn,1,tn),cn=xn(cn,2,en),cn=xn(cn,3,an),cn=xn(cn,4,rn),cn=xn(cn,5,on),cn=xn(cn,6,sn),cn=xn(cn,7,ln),Je.push(cn),Je.push(Br.a,Br.b,Br.c),Je.push(Br.materialIndex),an){var hn=this.faceVertexUvs[0][Ve];Je.push(fn(hn[0]),fn(hn[1]),fn(hn[2]))}if(rn&&Je.push(pn(Br.normal)),on){var mn=Br.vertexNormals;Je.push(pn(mn[0]),pn(mn[1]),pn(mn[2]))}if(sn&&Je.push(dn(Br.color)),ln){var An=Br.vertexColors;Je.push(dn(An[0]),dn(An[1]),dn(An[2]))}}function xn(yn,Sn,gn){return gn?yn|1<<Sn:yn&~(1<<Sn)}function pn(yn){var Sn=yn.x.toString()+yn.y.toString()+yn.z.toString();return Ke[Sn]!==void 0||(Ke[Sn]=Xe.length/3,Xe.push(yn.x,yn.y,yn.z)),Ke[Sn]}function dn(yn){var Sn=yn.r.toString()+yn.g.toString()+yn.b.toString();return or[Sn]!==void 0||(or[Sn]=Ye.length,Ye.push(yn.getHex())),or[Sn]}function fn(yn){var Sn=yn.x.toString()+yn.y.toString();return cr[Sn]!==void 0||(cr[Sn]=sr.length/2,sr.push(yn.x,yn.y)),cr[Sn]}return $e.data={},$e.data.vertices=De,$e.data.normals=Xe,Ye.length>0&&($e.data.colors=Ye),sr.length>0&&($e.data.uvs=[sr]),$e.data.faces=Je,$e},clone:function(){return new Geometry().copy(this)},copy:function($e){var Se,Be,De,Ve,Fe,Je;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=$e.name;var Xe=$e.vertices;for(Se=0,Be=Xe.length;Se<Be;Se++)this.vertices.push(Xe[Se].clone());var Ke=$e.colors;for(Se=0,Be=Ke.length;Se<Be;Se++)this.colors.push(Ke[Se].clone());var Ye=$e.faces;for(Se=0,Be=Ye.length;Se<Be;Se++)this.faces.push(Ye[Se].clone());for(Se=0,Be=$e.faceVertexUvs.length;Se<Be;Se++){var or=$e.faceVertexUvs[Se];for(this.faceVertexUvs[Se]===void 0&&(this.faceVertexUvs[Se]=[]),De=0,Ve=or.length;De<Ve;De++){var sr=or[De],cr=[];for(Fe=0,Je=sr.length;Fe<Je;Fe++){var Br=sr[Fe];cr.push(Br.clone())}this.faceVertexUvs[Se].push(cr)}}var tn=$e.morphTargets;for(Se=0,Be=tn.length;Se<Be;Se++){var en={};if(en.name=tn[Se].name,tn[Se].vertices!==void 0)for(en.vertices=[],De=0,Ve=tn[Se].vertices.length;De<Ve;De++)en.vertices.push(tn[Se].vertices[De].clone());if(tn[Se].normals!==void 0)for(en.normals=[],De=0,Ve=tn[Se].normals.length;De<Ve;De++)en.normals.push(tn[Se].normals[De].clone());this.morphTargets.push(en)}var an=$e.morphNormals;for(Se=0,Be=an.length;Se<Be;Se++){var rn={};if(an[Se].vertexNormals!==void 0)for(rn.vertexNormals=[],De=0,Ve=an[Se].vertexNormals.length;De<Ve;De++){var on=an[Se].vertexNormals[De],sn={};sn.a=on.a.clone(),sn.b=on.b.clone(),sn.c=on.c.clone(),rn.vertexNormals.push(sn)}if(an[Se].faceNormals!==void 0)for(rn.faceNormals=[],De=0,Ve=an[Se].faceNormals.length;De<Ve;De++)rn.faceNormals.push(an[Se].faceNormals[De].clone());this.morphNormals.push(rn)}var ln=$e.skinWeights;for(Se=0,Be=ln.length;Se<Be;Se++)this.skinWeights.push(ln[Se].clone());var cn=$e.skinIndices;for(Se=0,Be=cn.length;Se<Be;Se++)this.skinIndices.push(cn[Se].clone());var hn=$e.lineDistances;for(Se=0,Be=hn.length;Se<Be;Se++)this.lineDistances.push(hn[Se]);var mn=$e.boundingBox;mn!==null&&(this.boundingBox=mn.clone());var An=$e.boundingSphere;return An!==null&&(this.boundingSphere=An.clone()),this.elementsNeedUpdate=$e.elementsNeedUpdate,this.verticesNeedUpdate=$e.verticesNeedUpdate,this.uvsNeedUpdate=$e.uvsNeedUpdate,this.normalsNeedUpdate=$e.normalsNeedUpdate,this.colorsNeedUpdate=$e.colorsNeedUpdate,this.lineDistancesNeedUpdate=$e.lineDistancesNeedUpdate,this.groupsNeedUpdate=$e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class BoxGeometry extends Geometry{constructor(Se,Be,De,Ve,Fe,Je){super(),this.type="BoxGeometry",this.parameters={width:Se,height:Be,depth:De,widthSegments:Ve,heightSegments:Fe,depthSegments:Je},this.fromBufferGeometry(new BoxBufferGeometry(Se,Be,De,Ve,Fe,Je)),this.mergeVertices()}}class BoxBufferGeometry extends BufferGeometry{constructor(Se,Be,De,Ve,Fe,Je){super(),this.type="BoxBufferGeometry",this.parameters={width:Se,height:Be,depth:De,widthSegments:Ve,heightSegments:Fe,depthSegments:Je};const Xe=this;Se=Se||1,Be=Be||1,De=De||1,Ve=Math.floor(Ve)||1,Fe=Math.floor(Fe)||1,Je=Math.floor(Je)||1;const Ke=[],Ye=[],or=[],sr=[];let cr=0,Br=0;tn("z","y","x",-1,-1,De,Be,Se,Je,Fe,0),tn("z","y","x",1,-1,De,Be,-Se,Je,Fe,1),tn("x","z","y",1,1,Se,De,Be,Ve,Je,2),tn("x","z","y",1,-1,Se,De,-Be,Ve,Je,3),tn("x","y","z",1,-1,Se,Be,De,Ve,Fe,4),tn("x","y","z",-1,-1,Se,Be,-De,Ve,Fe,5),this.setIndex(Ke),this.setAttribute("position",new Float32BufferAttribute(Ye,3)),this.setAttribute("normal",new Float32BufferAttribute(or,3)),this.setAttribute("uv",new Float32BufferAttribute(sr,2));function tn(en,an,rn,on,sn,ln,cn,hn,mn,An,xn){const pn=ln/mn,dn=cn/An,fn=ln/2,yn=cn/2,Sn=hn/2,gn=mn+1,Cn=An+1;let Mn=0,Bn=0;const kn=new Vector3;for(let Ln=0;Ln<Cn;Ln++){const Pn=Ln*dn-yn;for(let Vn=0;Vn<gn;Vn++){const Yn=Vn*pn-fn;kn[en]=Yn*on,kn[an]=Pn*sn,kn[rn]=Sn,Ye.push(kn.x,kn.y,kn.z),kn[en]=0,kn[an]=0,kn[rn]=hn>0?1:-1,or.push(kn.x,kn.y,kn.z),sr.push(Vn/mn),sr.push(1-Ln/An),Mn+=1}}for(let Ln=0;Ln<An;Ln++)for(let Pn=0;Pn<mn;Pn++){const Vn=cr+Pn+gn*Ln,Yn=cr+Pn+gn*(Ln+1),ni=cr+(Pn+1)+gn*(Ln+1),Rn=cr+(Pn+1)+gn*Ln;Ke.push(Vn,Yn,Rn),Ke.push(Yn,ni,Rn),Bn+=6}Xe.addGroup(Br,Bn,xn),Br+=Bn,cr+=Mn}}}function cloneUniforms($e){var Se={};for(var Be in $e){Se[Be]={};for(var De in $e[Be]){var Ve=$e[Be][De];Ve&&(Ve.isColor||Ve.isMatrix3||Ve.isMatrix4||Ve.isVector2||Ve.isVector3||Ve.isVector4||Ve.isTexture)?Se[Be][De]=Ve.clone():Array.isArray(Ve)?Se[Be][De]=Ve.slice():Se[Be][De]=Ve}}return Se}function mergeUniforms($e){for(var Se={},Be=0;Be<$e.length;Be++){var De=cloneUniforms($e[Be]);for(var Ve in De)Se[Ve]=De[Ve]}return Se}var UniformsUtils={clone:cloneUniforms,merge:mergeUniforms},default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function ShaderMaterial($e){Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,$e!==void 0&&($e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues($e))}ShaderMaterial.prototype=Object.create(Material.prototype);ShaderMaterial.prototype.constructor=ShaderMaterial;ShaderMaterial.prototype.isShaderMaterial=!0;ShaderMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.fragmentShader=$e.fragmentShader,this.vertexShader=$e.vertexShader,this.uniforms=cloneUniforms($e.uniforms),this.defines=Object.assign({},$e.defines),this.wireframe=$e.wireframe,this.wireframeLinewidth=$e.wireframeLinewidth,this.lights=$e.lights,this.clipping=$e.clipping,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.morphNormals=$e.morphNormals,this.extensions=Object.assign({},$e.extensions),this};ShaderMaterial.prototype.toJSON=function($e){var Se=Material.prototype.toJSON.call(this,$e);Se.uniforms={};for(var Be in this.uniforms){var De=this.uniforms[Be],Ve=De.value;Ve&&Ve.isTexture?Se.uniforms[Be]={type:"t",value:Ve.toJSON($e).uuid}:Ve&&Ve.isColor?Se.uniforms[Be]={type:"c",value:Ve.getHex()}:Ve&&Ve.isVector2?Se.uniforms[Be]={type:"v2",value:Ve.toArray()}:Ve&&Ve.isVector3?Se.uniforms[Be]={type:"v3",value:Ve.toArray()}:Ve&&Ve.isVector4?Se.uniforms[Be]={type:"v4",value:Ve.toArray()}:Ve&&Ve.isMatrix3?Se.uniforms[Be]={type:"m3",value:Ve.toArray()}:Ve&&Ve.isMatrix4?Se.uniforms[Be]={type:"m4",value:Ve.toArray()}:Se.uniforms[Be]={value:Ve}}Object.keys(this.defines).length>0&&(Se.defines=this.defines),Se.vertexShader=this.vertexShader,Se.fragmentShader=this.fragmentShader;var Fe={};for(var Je in this.extensions)this.extensions[Je]===!0&&(Fe[Je]=!0);return Object.keys(Fe).length>0&&(Se.extensions=Fe),Se};function Camera$1(){Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4}Camera$1.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Camera$1,isCamera:!0,copy:function($e,Se){return Object3D.prototype.copy.call(this,$e,Se),this.matrixWorldInverse.copy($e.matrixWorldInverse),this.projectionMatrix.copy($e.projectionMatrix),this.projectionMatrixInverse.copy($e.projectionMatrixInverse),this},getWorldDirection:function($e){$e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),$e=new Vector3),this.updateMatrixWorld(!0);var Se=this.matrixWorld.elements;return $e.set(-Se[8],-Se[9],-Se[10]).normalize()},updateMatrixWorld:function($e){Object3D.prototype.updateMatrixWorld.call(this,$e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function($e,Se){Object3D.prototype.updateWorldMatrix.call(this,$e,Se),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function PerspectiveCamera($e,Se,Be,De){Camera$1.call(this),this.type="PerspectiveCamera",this.fov=$e!==void 0?$e:50,this.zoom=1,this.near=Be!==void 0?Be:.1,this.far=De!==void 0?De:2e3,this.focus=10,this.aspect=Se!==void 0?Se:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}PerspectiveCamera.prototype=Object.assign(Object.create(Camera$1.prototype),{constructor:PerspectiveCamera,isPerspectiveCamera:!0,copy:function($e,Se){return Camera$1.prototype.copy.call(this,$e,Se),this.fov=$e.fov,this.zoom=$e.zoom,this.near=$e.near,this.far=$e.far,this.focus=$e.focus,this.aspect=$e.aspect,this.view=$e.view===null?null:Object.assign({},$e.view),this.filmGauge=$e.filmGauge,this.filmOffset=$e.filmOffset,this},setFocalLength:function($e){var Se=.5*this.getFilmHeight()/$e;this.fov=MathUtils.RAD2DEG*2*Math.atan(Se),this.updateProjectionMatrix()},getFocalLength:function(){var $e=Math.tan(MathUtils.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/$e},getEffectiveFOV:function(){return MathUtils.RAD2DEG*2*Math.atan(Math.tan(MathUtils.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function($e,Se,Be,De,Ve,Fe){this.aspect=$e/Se,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=$e,this.view.fullHeight=Se,this.view.offsetX=Be,this.view.offsetY=De,this.view.width=Ve,this.view.height=Fe,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var $e=this.near,Se=$e*Math.tan(MathUtils.DEG2RAD*.5*this.fov)/this.zoom,Be=2*Se,De=this.aspect*Be,Ve=-.5*De,Fe=this.view;if(this.view!==null&&this.view.enabled){var Je=Fe.fullWidth,Xe=Fe.fullHeight;Ve+=Fe.offsetX*De/Je,Se-=Fe.offsetY*Be/Xe,De*=Fe.width/Je,Be*=Fe.height/Xe}var Ke=this.filmOffset;Ke!==0&&(Ve+=$e*Ke/this.getFilmWidth()),this.projectionMatrix.makePerspective(Ve,Ve+De,Se,Se-Be,$e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function($e){var Se=Object3D.prototype.toJSON.call(this,$e);return Se.object.fov=this.fov,Se.object.zoom=this.zoom,Se.object.near=this.near,Se.object.far=this.far,Se.object.focus=this.focus,Se.object.aspect=this.aspect,this.view!==null&&(Se.object.view=Object.assign({},this.view)),Se.object.filmGauge=this.filmGauge,Se.object.filmOffset=this.filmOffset,Se}});var fov=90,aspect=1;function CubeCamera($e,Se,Be){if(Object3D.call(this),this.type="CubeCamera",Be.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=Be;var De=new PerspectiveCamera(fov,aspect,$e,Se);De.layers=this.layers,De.up.set(0,-1,0),De.lookAt(new Vector3(1,0,0)),this.add(De);var Ve=new PerspectiveCamera(fov,aspect,$e,Se);Ve.layers=this.layers,Ve.up.set(0,-1,0),Ve.lookAt(new Vector3(-1,0,0)),this.add(Ve);var Fe=new PerspectiveCamera(fov,aspect,$e,Se);Fe.layers=this.layers,Fe.up.set(0,0,1),Fe.lookAt(new Vector3(0,1,0)),this.add(Fe);var Je=new PerspectiveCamera(fov,aspect,$e,Se);Je.layers=this.layers,Je.up.set(0,0,-1),Je.lookAt(new Vector3(0,-1,0)),this.add(Je);var Xe=new PerspectiveCamera(fov,aspect,$e,Se);Xe.layers=this.layers,Xe.up.set(0,-1,0),Xe.lookAt(new Vector3(0,0,1)),this.add(Xe);var Ke=new PerspectiveCamera(fov,aspect,$e,Se);Ke.layers=this.layers,Ke.up.set(0,-1,0),Ke.lookAt(new Vector3(0,0,-1)),this.add(Ke),this.update=function(Ye,or){this.parent===null&&this.updateMatrixWorld();var sr=Ye.xr.enabled,cr=Ye.getRenderTarget();Ye.xr.enabled=!1;var Br=Be.texture.generateMipmaps;Be.texture.generateMipmaps=!1,Ye.setRenderTarget(Be,0),Ye.render(or,De),Ye.setRenderTarget(Be,1),Ye.render(or,Ve),Ye.setRenderTarget(Be,2),Ye.render(or,Fe),Ye.setRenderTarget(Be,3),Ye.render(or,Je),Ye.setRenderTarget(Be,4),Ye.render(or,Xe),Be.texture.generateMipmaps=Br,Ye.setRenderTarget(Be,5),Ye.render(or,Ke),Ye.setRenderTarget(cr),Ye.xr.enabled=sr},this.clear=function(Ye,or,sr,cr){for(var Br=Ye.getRenderTarget(),tn=0;tn<6;tn++)Ye.setRenderTarget(Be,tn),Ye.clear(or,sr,cr);Ye.setRenderTarget(Br)}}CubeCamera.prototype=Object.create(Object3D.prototype);CubeCamera.prototype.constructor=CubeCamera;function WebGLCubeRenderTarget($e,Se,Be){Number.isInteger(Se)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),Se=Be),WebGLRenderTarget.call(this,$e,$e,Se)}WebGLCubeRenderTarget.prototype=Object.create(WebGLRenderTarget.prototype);WebGLCubeRenderTarget.prototype.constructor=WebGLCubeRenderTarget;WebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget=!0;WebGLCubeRenderTarget.prototype.fromEquirectangularTexture=function($e,Se){this.texture.type=Se.type,this.texture.format=Se.format,this.texture.encoding=Se.encoding;var Be=new Scene$1,De={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","	vWorldDirection = transformDirection( position, modelMatrix );","	#include <begin_vertex>","	#include <project_vertex>","}"].join(`
`),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#include <common>","void main() {","	vec3 direction = normalize( vWorldDirection );","	vec2 sampleUV = equirectUv( direction );","	gl_FragColor = texture2D( tEquirect, sampleUV );","}"].join(`
`)},Ve=new ShaderMaterial({type:"CubemapFromEquirect",uniforms:cloneUniforms(De.uniforms),vertexShader:De.vertexShader,fragmentShader:De.fragmentShader,side:BackSide,blending:NoBlending});Ve.uniforms.tEquirect.value=Se;var Fe=new Mesh(new BoxBufferGeometry(5,5,5),Ve);Be.add(Fe);var Je=new CubeCamera(1,10,this);return Je.update($e,Be),Fe.geometry.dispose(),Fe.material.dispose(),this};function DataTexture($e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr){Texture.call(this,null,Fe,Je,Xe,Ke,Ye,De,Ve,or,sr),this.image={data:$e||null,width:Se||1,height:Be||1},this.magFilter=Ke!==void 0?Ke:NearestFilter,this.minFilter=Ye!==void 0?Ye:NearestFilter,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}DataTexture.prototype=Object.create(Texture.prototype);DataTexture.prototype.constructor=DataTexture;DataTexture.prototype.isDataTexture=!0;var _sphere$1=new Sphere,_vector$5=new Vector3;function Frustum($e,Se,Be,De,Ve,Fe){this.planes=[$e!==void 0?$e:new Plane,Se!==void 0?Se:new Plane,Be!==void 0?Be:new Plane,De!==void 0?De:new Plane,Ve!==void 0?Ve:new Plane,Fe!==void 0?Fe:new Plane]}Object.assign(Frustum.prototype,{set:function($e,Se,Be,De,Ve,Fe){var Je=this.planes;return Je[0].copy($e),Je[1].copy(Se),Je[2].copy(Be),Je[3].copy(De),Je[4].copy(Ve),Je[5].copy(Fe),this},clone:function(){return new this.constructor().copy(this)},copy:function($e){for(var Se=this.planes,Be=0;Be<6;Be++)Se[Be].copy($e.planes[Be]);return this},setFromProjectionMatrix:function($e){var Se=this.planes,Be=$e.elements,De=Be[0],Ve=Be[1],Fe=Be[2],Je=Be[3],Xe=Be[4],Ke=Be[5],Ye=Be[6],or=Be[7],sr=Be[8],cr=Be[9],Br=Be[10],tn=Be[11],en=Be[12],an=Be[13],rn=Be[14],on=Be[15];return Se[0].setComponents(Je-De,or-Xe,tn-sr,on-en).normalize(),Se[1].setComponents(Je+De,or+Xe,tn+sr,on+en).normalize(),Se[2].setComponents(Je+Ve,or+Ke,tn+cr,on+an).normalize(),Se[3].setComponents(Je-Ve,or-Ke,tn-cr,on-an).normalize(),Se[4].setComponents(Je-Fe,or-Ye,tn-Br,on-rn).normalize(),Se[5].setComponents(Je+Fe,or+Ye,tn+Br,on+rn).normalize(),this},intersectsObject:function($e){var Se=$e.geometry;return Se.boundingSphere===null&&Se.computeBoundingSphere(),_sphere$1.copy(Se.boundingSphere).applyMatrix4($e.matrixWorld),this.intersectsSphere(_sphere$1)},intersectsSprite:function($e){return _sphere$1.center.set(0,0,0),_sphere$1.radius=.7071067811865476,_sphere$1.applyMatrix4($e.matrixWorld),this.intersectsSphere(_sphere$1)},intersectsSphere:function($e){for(var Se=this.planes,Be=$e.center,De=-$e.radius,Ve=0;Ve<6;Ve++){var Fe=Se[Ve].distanceToPoint(Be);if(Fe<De)return!1}return!0},intersectsBox:function($e){for(var Se=this.planes,Be=0;Be<6;Be++){var De=Se[Be];if(_vector$5.x=De.normal.x>0?$e.max.x:$e.min.x,_vector$5.y=De.normal.y>0?$e.max.y:$e.min.y,_vector$5.z=De.normal.z>0?$e.max.z:$e.min.z,De.distanceToPoint(_vector$5)<0)return!1}return!0},containsPoint:function($e){for(var Se=this.planes,Be=0;Be<6;Be++)if(Se[Be].distanceToPoint($e)<0)return!1;return!0}});var UniformsLib={common:{diffuse:{value:new Color(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Matrix3},uv2Transform:{value:new Matrix3},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Color(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(15658734)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Matrix3}}};function WebGLAnimation(){var $e=null,Se=!1,Be=null;function De(Ve,Fe){Se!==!1&&(Be(Ve,Fe),$e.requestAnimationFrame(De))}return{start:function(){Se!==!0&&Be!==null&&($e.requestAnimationFrame(De),Se=!0)},stop:function(){Se=!1},setAnimationLoop:function(Ve){Be=Ve},setContext:function(Ve){$e=Ve}}}function WebGLAttributes($e,Se){var Be=Se.isWebGL2,De=new WeakMap;function Ve(Ye,or){var sr=Ye.array,cr=Ye.usage,Br=$e.createBuffer();$e.bindBuffer(or,Br),$e.bufferData(or,sr,cr),Ye.onUploadCallback();var tn=5126;return sr instanceof Float32Array?tn=5126:sr instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):sr instanceof Uint16Array?tn=5123:sr instanceof Int16Array?tn=5122:sr instanceof Uint32Array?tn=5125:sr instanceof Int32Array?tn=5124:sr instanceof Int8Array?tn=5120:sr instanceof Uint8Array&&(tn=5121),{buffer:Br,type:tn,bytesPerElement:sr.BYTES_PER_ELEMENT,version:Ye.version}}function Fe(Ye,or,sr){var cr=or.array,Br=or.updateRange;$e.bindBuffer(sr,Ye),Br.count===-1?$e.bufferSubData(sr,0,cr):(Be?$e.bufferSubData(sr,Br.offset*cr.BYTES_PER_ELEMENT,cr,Br.offset,Br.count):$e.bufferSubData(sr,Br.offset*cr.BYTES_PER_ELEMENT,cr.subarray(Br.offset,Br.offset+Br.count)),Br.count=-1)}function Je(Ye){return Ye.isInterleavedBufferAttribute&&(Ye=Ye.data),De.get(Ye)}function Xe(Ye){Ye.isInterleavedBufferAttribute&&(Ye=Ye.data);var or=De.get(Ye);or&&($e.deleteBuffer(or.buffer),De.delete(Ye))}function Ke(Ye,or){Ye.isInterleavedBufferAttribute&&(Ye=Ye.data);var sr=De.get(Ye);sr===void 0?De.set(Ye,Ve(Ye,or)):sr.version<Ye.version&&(Fe(sr.buffer,Ye,or),sr.version=Ye.version)}return{get:Je,remove:Xe,update:Ke}}function PlaneGeometry($e,Se,Be,De){Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:$e,height:Se,widthSegments:Be,heightSegments:De},this.fromBufferGeometry(new PlaneBufferGeometry($e,Se,Be,De)),this.mergeVertices()}PlaneGeometry.prototype=Object.create(Geometry.prototype);PlaneGeometry.prototype.constructor=PlaneGeometry;function PlaneBufferGeometry($e,Se,Be,De){BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:$e,height:Se,widthSegments:Be,heightSegments:De},$e=$e||1,Se=Se||1;var Ve=$e/2,Fe=Se/2,Je=Math.floor(Be)||1,Xe=Math.floor(De)||1,Ke=Je+1,Ye=Xe+1,or=$e/Je,sr=Se/Xe,cr,Br,tn=[],en=[],an=[],rn=[];for(Br=0;Br<Ye;Br++){var on=Br*sr-Fe;for(cr=0;cr<Ke;cr++){var sn=cr*or-Ve;en.push(sn,-on,0),an.push(0,0,1),rn.push(cr/Je),rn.push(1-Br/Xe)}}for(Br=0;Br<Xe;Br++)for(cr=0;cr<Je;cr++){var ln=cr+Ke*Br,cn=cr+Ke*(Br+1),hn=cr+1+Ke*(Br+1),mn=cr+1+Ke*Br;tn.push(ln,cn,mn),tn.push(cn,hn,mn)}this.setIndex(tn),this.setAttribute("position",new Float32BufferAttribute(en,3)),this.setAttribute("normal",new Float32BufferAttribute(an,3)),this.setAttribute("uv",new Float32BufferAttribute(rn,2))}PlaneBufferGeometry.prototype=Object.create(BufferGeometry.prototype);PlaneBufferGeometry.prototype.constructor=PlaneBufferGeometry;var alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex="vec3 transformed = vec3( position );",beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex=`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common=`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {
      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {
      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {
      uv = vec2(direction.x, direction.y) / abs(direction.z);    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		reflectVec = normalize( reflectVec );
		vec2 sampleUV = equirectUv( reflectVec );
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
		struct PointLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV = equirectUv( reflectVec );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert=`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ShaderChunk={alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,aomap_fragment,aomap_pars_fragment,begin_vertex,beginnormal_vertex,bsdfs,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,encodings_fragment,encodings_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_fragment,lightmap_pars_fragment,lights_lambert_vertex,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,uv2_pars_fragment,uv2_pars_vertex,uv2_vertex,worldpos_vertex,background_frag,background_vert,cube_frag,cube_vert,depth_frag,depth_vert,distanceRGBA_frag,distanceRGBA_vert,equirect_frag,equirect_vert,linedashed_frag,linedashed_vert,meshbasic_frag,meshbasic_vert,meshlambert_frag,meshlambert_vert,meshmatcap_frag,meshmatcap_vert,meshtoon_frag,meshtoon_vert,meshphong_frag,meshphong_vert,meshphysical_frag,meshphysical_vert,normal_frag,normal_vert,points_frag,points_vert,shadow_frag,shadow_vert,sprite_frag,sprite_vert},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.normal_vert,fragmentShader:ShaderChunk.normal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},cube:{uniforms:mergeUniforms([UniformsLib.envmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Color(0)},transparency:{value:0}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};function WebGLBackground($e,Se,Be,De){var Ve=new Color(0),Fe=0,Je,Xe,Ke=null,Ye=0,or=null;function sr(Br,tn,en,an){var rn=tn.background,on=$e.xr,sn=on.getSession&&on.getSession();if(sn&&sn.environmentBlendMode==="additive"&&(rn=null),rn===null?cr(Ve,Fe):rn&&rn.isColor&&(cr(rn,1),an=!0),($e.autoClear||an)&&$e.clear($e.autoClearColor,$e.autoClearDepth,$e.autoClearStencil),rn&&(rn.isCubeTexture||rn.isWebGLCubeRenderTarget||rn.mapping===CubeUVReflectionMapping)){Xe===void 0&&(Xe=new Mesh(new BoxBufferGeometry(1,1,1),new ShaderMaterial({type:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.cube.uniforms),vertexShader:ShaderLib.cube.vertexShader,fragmentShader:ShaderLib.cube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),Xe.geometry.deleteAttribute("normal"),Xe.geometry.deleteAttribute("uv"),Xe.onBeforeRender=function(cn,hn,mn){this.matrixWorld.copyPosition(mn.matrixWorld)},Object.defineProperty(Xe.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),Be.update(Xe));var ln=rn.isWebGLCubeRenderTarget?rn.texture:rn;Xe.material.uniforms.envMap.value=ln,Xe.material.uniforms.flipEnvMap.value=ln.isCubeTexture?-1:1,(Ke!==rn||Ye!==ln.version||or!==$e.toneMapping)&&(Xe.material.needsUpdate=!0,Ke=rn,Ye=ln.version,or=$e.toneMapping),Br.unshift(Xe,Xe.geometry,Xe.material,0,0,null)}else rn&&rn.isTexture&&(Je===void 0&&(Je=new Mesh(new PlaneBufferGeometry(2,2),new ShaderMaterial({type:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),Je.geometry.deleteAttribute("normal"),Object.defineProperty(Je.material,"map",{get:function(){return this.uniforms.t2D.value}}),Be.update(Je)),Je.material.uniforms.t2D.value=rn,rn.matrixAutoUpdate===!0&&rn.updateMatrix(),Je.material.uniforms.uvTransform.value.copy(rn.matrix),(Ke!==rn||Ye!==rn.version||or!==$e.toneMapping)&&(Je.material.needsUpdate=!0,Ke=rn,Ye=rn.version,or=$e.toneMapping),Br.unshift(Je,Je.geometry,Je.material,0,0,null))}function cr(Br,tn){Se.buffers.color.setClear(Br.r,Br.g,Br.b,tn,De)}return{getClearColor:function(){return Ve},setClearColor:function(Br,tn){Ve.set(Br),Fe=tn!==void 0?tn:1,cr(Ve,Fe)},getClearAlpha:function(){return Fe},setClearAlpha:function(Br){Fe=Br,cr(Ve,Fe)},render:sr}}function WebGLBufferRenderer($e,Se,Be,De){var Ve=De.isWebGL2,Fe;function Je(Ye){Fe=Ye}function Xe(Ye,or){$e.drawArrays(Fe,Ye,or),Be.update(or,Fe)}function Ke(Ye,or,sr,cr){if(cr!==0){var Br,tn;if(Ve)Br=$e,tn="drawArraysInstanced";else if(Br=Se.get("ANGLE_instanced_arrays"),tn="drawArraysInstancedANGLE",Br===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}Br[tn](Fe,or,sr,cr),Be.update(sr,Fe,cr)}}this.setMode=Je,this.render=Xe,this.renderInstances=Ke}function WebGLCapabilities($e,Se,Be){var De;function Ve(){if(De!==void 0)return De;var hn=Se.get("EXT_texture_filter_anisotropic");return hn!==null?De=$e.getParameter(hn.MAX_TEXTURE_MAX_ANISOTROPY_EXT):De=0,De}function Fe(hn){if(hn==="highp"){if($e.getShaderPrecisionFormat(35633,36338).precision>0&&$e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";hn="mediump"}return hn==="mediump"&&$e.getShaderPrecisionFormat(35633,36337).precision>0&&$e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var Je=typeof WebGL2RenderingContext<"u"&&$e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&$e instanceof WebGL2ComputeRenderingContext,Xe=Be.precision!==void 0?Be.precision:"highp",Ke=Fe(Xe);Ke!==Xe&&(console.warn("THREE.WebGLRenderer:",Xe,"not supported, using",Ke,"instead."),Xe=Ke);var Ye=Be.logarithmicDepthBuffer===!0,or=$e.getParameter(34930),sr=$e.getParameter(35660),cr=$e.getParameter(3379),Br=$e.getParameter(34076),tn=$e.getParameter(34921),en=$e.getParameter(36347),an=$e.getParameter(36348),rn=$e.getParameter(36349),on=sr>0,sn=Je||!!Se.get("OES_texture_float"),ln=on&&sn,cn=Je?$e.getParameter(36183):0;return{isWebGL2:Je,getMaxAnisotropy:Ve,getMaxPrecision:Fe,precision:Xe,logarithmicDepthBuffer:Ye,maxTextures:or,maxVertexTextures:sr,maxTextureSize:cr,maxCubemapSize:Br,maxAttributes:tn,maxVertexUniforms:en,maxVaryings:an,maxFragmentUniforms:rn,vertexTextures:on,floatFragmentTextures:sn,floatVertexTextures:ln,maxSamples:cn}}function WebGLClipping(){var $e=this,Se=null,Be=0,De=!1,Ve=!1,Fe=new Plane,Je=new Matrix3,Xe={value:null,needsUpdate:!1};this.uniform=Xe,this.numPlanes=0,this.numIntersection=0,this.init=function(or,sr,cr){var Br=or.length!==0||sr||Be!==0||De;return De=sr,Se=Ye(or,cr,0),Be=or.length,Br},this.beginShadows=function(){Ve=!0,Ye(null)},this.endShadows=function(){Ve=!1,Ke()},this.setState=function(or,sr,cr,Br,tn,en){if(!De||or===null||or.length===0||Ve&&!cr)Ve?Ye(null):Ke();else{var an=Ve?0:Be,rn=an*4,on=tn.clippingState||null;Xe.value=on,on=Ye(or,Br,rn,en);for(var sn=0;sn!==rn;++sn)on[sn]=Se[sn];tn.clippingState=on,this.numIntersection=sr?this.numPlanes:0,this.numPlanes+=an}};function Ke(){Xe.value!==Se&&(Xe.value=Se,Xe.needsUpdate=Be>0),$e.numPlanes=Be,$e.numIntersection=0}function Ye(or,sr,cr,Br){var tn=or!==null?or.length:0,en=null;if(tn!==0){if(en=Xe.value,Br!==!0||en===null){var an=cr+tn*4,rn=sr.matrixWorldInverse;Je.getNormalMatrix(rn),(en===null||en.length<an)&&(en=new Float32Array(an));for(var on=0,sn=cr;on!==tn;++on,sn+=4)Fe.copy(or[on]).applyMatrix4(rn,Je),Fe.normal.toArray(en,sn),en[sn+3]=Fe.constant}Xe.value=en,Xe.needsUpdate=!0}return $e.numPlanes=tn,$e.numIntersection=0,en}}function WebGLExtensions($e){var Se={};return{get:function(Be){if(Se[Be]!==void 0)return Se[Be];var De;switch(Be){case"WEBGL_depth_texture":De=$e.getExtension("WEBGL_depth_texture")||$e.getExtension("MOZ_WEBGL_depth_texture")||$e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":De=$e.getExtension("EXT_texture_filter_anisotropic")||$e.getExtension("MOZ_EXT_texture_filter_anisotropic")||$e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":De=$e.getExtension("WEBGL_compressed_texture_s3tc")||$e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||$e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":De=$e.getExtension("WEBGL_compressed_texture_pvrtc")||$e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:De=$e.getExtension(Be)}return De===null&&console.warn("THREE.WebGLRenderer: "+Be+" extension not supported."),Se[Be]=De,De}}}function WebGLGeometries($e,Se,Be){var De=new WeakMap,Ve=new WeakMap;function Fe(or){var sr=or.target,cr=De.get(sr);cr.index!==null&&Se.remove(cr.index);for(var Br in cr.attributes)Se.remove(cr.attributes[Br]);sr.removeEventListener("dispose",Fe),De.delete(sr);var tn=Ve.get(cr);tn&&(Se.remove(tn),Ve.delete(cr)),Be.memory.geometries--}function Je(or,sr){var cr=De.get(sr);return cr||(sr.addEventListener("dispose",Fe),sr.isBufferGeometry?cr=sr:sr.isGeometry&&(sr._bufferGeometry===void 0&&(sr._bufferGeometry=new BufferGeometry().setFromObject(or)),cr=sr._bufferGeometry),De.set(sr,cr),Be.memory.geometries++,cr)}function Xe(or){var sr=or.index,cr=or.attributes;sr!==null&&Se.update(sr,34963);for(var Br in cr)Se.update(cr[Br],34962);var tn=or.morphAttributes;for(var Br in tn)for(var en=tn[Br],an=0,rn=en.length;an<rn;an++)Se.update(en[an],34962)}function Ke(or){var sr=[],cr=or.index,Br=or.attributes.position,tn=0;if(cr!==null){var en=cr.array;tn=cr.version;for(var an=0,rn=en.length;an<rn;an+=3){var on=en[an+0],sn=en[an+1],ln=en[an+2];sr.push(on,sn,sn,ln,ln,on)}}else{var en=Br.array;tn=Br.version;for(var an=0,rn=en.length/3-1;an<rn;an+=3){var on=an+0,sn=an+1,ln=an+2;sr.push(on,sn,sn,ln,ln,on)}}var cn=new(arrayMax(sr)>65535?Uint32BufferAttribute:Uint16BufferAttribute)(sr,1);cn.version=tn,Se.update(cn,34963);var hn=Ve.get(or);hn&&Se.remove(hn),Ve.set(or,cn)}function Ye(or){var sr=Ve.get(or);if(sr){var cr=or.index;cr!==null&&sr.version<cr.version&&Ke(or)}else Ke(or);return Ve.get(or)}return{get:Je,update:Xe,getWireframeAttribute:Ye}}function WebGLIndexedBufferRenderer($e,Se,Be,De){var Ve=De.isWebGL2,Fe;function Je(cr){Fe=cr}var Xe,Ke;function Ye(cr){Xe=cr.type,Ke=cr.bytesPerElement}function or(cr,Br){$e.drawElements(Fe,Br,Xe,cr*Ke),Be.update(Br,Fe)}function sr(cr,Br,tn,en){if(en!==0){var an,rn;if(Ve)an=$e,rn="drawElementsInstanced";else if(an=Se.get("ANGLE_instanced_arrays"),rn="drawElementsInstancedANGLE",an===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}an[rn](Fe,tn,Xe,Br*Ke,en),Be.update(tn,Fe,en)}}this.setMode=Je,this.setIndex=Ye,this.render=or,this.renderInstances=sr}function WebGLInfo($e){var Se={geometries:0,textures:0},Be={frame:0,calls:0,triangles:0,points:0,lines:0};function De(Fe,Je,Xe){switch(Xe=Xe||1,Be.calls++,Je){case 4:Be.triangles+=Xe*(Fe/3);break;case 1:Be.lines+=Xe*(Fe/2);break;case 3:Be.lines+=Xe*(Fe-1);break;case 2:Be.lines+=Xe*Fe;break;case 0:Be.points+=Xe*Fe;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",Je);break}}function Ve(){Be.frame++,Be.calls=0,Be.triangles=0,Be.points=0,Be.lines=0}return{memory:Se,render:Be,programs:null,autoReset:!0,reset:Ve,update:De}}function absNumericalSort($e,Se){return Math.abs(Se[1])-Math.abs($e[1])}function WebGLMorphtargets($e){var Se={},Be=new Float32Array(8);function De(Ve,Fe,Je,Xe){var Ke=Ve.morphTargetInfluences,Ye=Ke===void 0?0:Ke.length,or=Se[Fe.id];if(or===void 0){or=[];for(var sr=0;sr<Ye;sr++)or[sr]=[sr,0];Se[Fe.id]=or}for(var cr=Je.morphTargets&&Fe.morphAttributes.position,Br=Je.morphNormals&&Fe.morphAttributes.normal,sr=0;sr<Ye;sr++){var tn=or[sr];tn[1]!==0&&(cr&&Fe.deleteAttribute("morphTarget"+sr),Br&&Fe.deleteAttribute("morphNormal"+sr))}for(var sr=0;sr<Ye;sr++){var tn=or[sr];tn[0]=sr,tn[1]=Ke[sr]}or.sort(absNumericalSort);for(var en=0,sr=0;sr<8;sr++){var tn=or[sr];if(tn){var an=tn[0],rn=tn[1];if(rn){cr&&Fe.setAttribute("morphTarget"+sr,cr[an]),Br&&Fe.setAttribute("morphNormal"+sr,Br[an]),Be[sr]=rn,en+=rn;continue}}Be[sr]=0}var on=Fe.morphTargetsRelative?1:1-en;Xe.getUniforms().setValue($e,"morphTargetBaseInfluence",on),Xe.getUniforms().setValue($e,"morphTargetInfluences",Be)}return{update:De}}function WebGLObjects($e,Se,Be,De){var Ve=new WeakMap;function Fe(Xe){var Ke=De.render.frame,Ye=Xe.geometry,or=Se.get(Xe,Ye);return Ve.get(or)!==Ke&&(Ye.isGeometry&&or.updateFromObject(Xe),Se.update(or),Ve.set(or,Ke)),Xe.isInstancedMesh&&Be.update(Xe.instanceMatrix,34962),or}function Je(){Ve=new WeakMap}return{update:Fe,dispose:Je}}function CubeTexture($e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye){$e=$e!==void 0?$e:[],Se=Se!==void 0?Se:CubeReflectionMapping,Je=Je!==void 0?Je:RGBFormat,Texture.call(this,$e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye),this.flipY=!1}CubeTexture.prototype=Object.create(Texture.prototype);CubeTexture.prototype.constructor=CubeTexture;CubeTexture.prototype.isCubeTexture=!0;Object.defineProperty(CubeTexture.prototype,"images",{get:function(){return this.image},set:function($e){this.image=$e}});function DataTexture2DArray($e,Se,Be,De){Texture.call(this,null),this.image={data:$e||null,width:Se||1,height:Be||1,depth:De||1},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}DataTexture2DArray.prototype=Object.create(Texture.prototype);DataTexture2DArray.prototype.constructor=DataTexture2DArray;DataTexture2DArray.prototype.isDataTexture2DArray=!0;function DataTexture3D($e,Se,Be,De){Texture.call(this,null),this.image={data:$e||null,width:Se||1,height:Be||1,depth:De||1},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}DataTexture3D.prototype=Object.create(Texture.prototype);DataTexture3D.prototype.constructor=DataTexture3D;DataTexture3D.prototype.isDataTexture3D=!0;var emptyTexture=new Texture,emptyTexture2dArray=new DataTexture2DArray,emptyTexture3d=new DataTexture3D,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten($e,Se,Be){var De=$e[0];if(De<=0||De>0)return $e;var Ve=Se*Be,Fe=arrayCacheF32[Ve];if(Fe===void 0&&(Fe=new Float32Array(Ve),arrayCacheF32[Ve]=Fe),Se!==0){De.toArray(Fe,0);for(var Je=1,Xe=0;Je!==Se;++Je)Xe+=Be,$e[Je].toArray(Fe,Xe)}return Fe}function arraysEqual($e,Se){if($e.length!==Se.length)return!1;for(var Be=0,De=$e.length;Be<De;Be++)if($e[Be]!==Se[Be])return!1;return!0}function copyArray($e,Se){for(var Be=0,De=Se.length;Be<De;Be++)$e[Be]=Se[Be]}function allocTexUnits($e,Se){var Be=arrayCacheI32[Se];Be===void 0&&(Be=new Int32Array(Se),arrayCacheI32[Se]=Be);for(var De=0;De!==Se;++De)Be[De]=$e.allocateTextureUnit();return Be}function setValueV1f($e,Se){var Be=this.cache;Be[0]!==Se&&($e.uniform1f(this.addr,Se),Be[0]=Se)}function setValueV2f($e,Se){var Be=this.cache;if(Se.x!==void 0)(Be[0]!==Se.x||Be[1]!==Se.y)&&($e.uniform2f(this.addr,Se.x,Se.y),Be[0]=Se.x,Be[1]=Se.y);else{if(arraysEqual(Be,Se))return;$e.uniform2fv(this.addr,Se),copyArray(Be,Se)}}function setValueV3f($e,Se){var Be=this.cache;if(Se.x!==void 0)(Be[0]!==Se.x||Be[1]!==Se.y||Be[2]!==Se.z)&&($e.uniform3f(this.addr,Se.x,Se.y,Se.z),Be[0]=Se.x,Be[1]=Se.y,Be[2]=Se.z);else if(Se.r!==void 0)(Be[0]!==Se.r||Be[1]!==Se.g||Be[2]!==Se.b)&&($e.uniform3f(this.addr,Se.r,Se.g,Se.b),Be[0]=Se.r,Be[1]=Se.g,Be[2]=Se.b);else{if(arraysEqual(Be,Se))return;$e.uniform3fv(this.addr,Se),copyArray(Be,Se)}}function setValueV4f($e,Se){var Be=this.cache;if(Se.x!==void 0)(Be[0]!==Se.x||Be[1]!==Se.y||Be[2]!==Se.z||Be[3]!==Se.w)&&($e.uniform4f(this.addr,Se.x,Se.y,Se.z,Se.w),Be[0]=Se.x,Be[1]=Se.y,Be[2]=Se.z,Be[3]=Se.w);else{if(arraysEqual(Be,Se))return;$e.uniform4fv(this.addr,Se),copyArray(Be,Se)}}function setValueM2($e,Se){var Be=this.cache,De=Se.elements;if(De===void 0){if(arraysEqual(Be,Se))return;$e.uniformMatrix2fv(this.addr,!1,Se),copyArray(Be,Se)}else{if(arraysEqual(Be,De))return;mat2array.set(De),$e.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(Be,De)}}function setValueM3($e,Se){var Be=this.cache,De=Se.elements;if(De===void 0){if(arraysEqual(Be,Se))return;$e.uniformMatrix3fv(this.addr,!1,Se),copyArray(Be,Se)}else{if(arraysEqual(Be,De))return;mat3array.set(De),$e.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(Be,De)}}function setValueM4($e,Se){var Be=this.cache,De=Se.elements;if(De===void 0){if(arraysEqual(Be,Se))return;$e.uniformMatrix4fv(this.addr,!1,Se),copyArray(Be,Se)}else{if(arraysEqual(Be,De))return;mat4array.set(De),$e.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(Be,De)}}function setValueT1($e,Se,Be){var De=this.cache,Ve=Be.allocateTextureUnit();De[0]!==Ve&&($e.uniform1i(this.addr,Ve),De[0]=Ve),Be.safeSetTexture2D(Se||emptyTexture,Ve)}function setValueT2DArray1($e,Se,Be){var De=this.cache,Ve=Be.allocateTextureUnit();De[0]!==Ve&&($e.uniform1i(this.addr,Ve),De[0]=Ve),Be.setTexture2DArray(Se||emptyTexture2dArray,Ve)}function setValueT3D1($e,Se,Be){var De=this.cache,Ve=Be.allocateTextureUnit();De[0]!==Ve&&($e.uniform1i(this.addr,Ve),De[0]=Ve),Be.setTexture3D(Se||emptyTexture3d,Ve)}function setValueT6($e,Se,Be){var De=this.cache,Ve=Be.allocateTextureUnit();De[0]!==Ve&&($e.uniform1i(this.addr,Ve),De[0]=Ve),Be.safeSetTextureCube(Se||emptyCubeTexture,Ve)}function setValueV1i($e,Se){var Be=this.cache;Be[0]!==Se&&($e.uniform1i(this.addr,Se),Be[0]=Se)}function setValueV2i($e,Se){var Be=this.cache;arraysEqual(Be,Se)||($e.uniform2iv(this.addr,Se),copyArray(Be,Se))}function setValueV3i($e,Se){var Be=this.cache;arraysEqual(Be,Se)||($e.uniform3iv(this.addr,Se),copyArray(Be,Se))}function setValueV4i($e,Se){var Be=this.cache;arraysEqual(Be,Se)||($e.uniform4iv(this.addr,Se),copyArray(Be,Se))}function setValueV1ui($e,Se){var Be=this.cache;Be[0]!==Se&&($e.uniform1ui(this.addr,Se),Be[0]=Se)}function getSingularSetter($e){switch($e){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray($e,Se){$e.uniform1fv(this.addr,Se)}function setValueV1iArray($e,Se){$e.uniform1iv(this.addr,Se)}function setValueV2iArray($e,Se){$e.uniform2iv(this.addr,Se)}function setValueV3iArray($e,Se){$e.uniform3iv(this.addr,Se)}function setValueV4iArray($e,Se){$e.uniform4iv(this.addr,Se)}function setValueV2fArray($e,Se){var Be=flatten(Se,this.size,2);$e.uniform2fv(this.addr,Be)}function setValueV3fArray($e,Se){var Be=flatten(Se,this.size,3);$e.uniform3fv(this.addr,Be)}function setValueV4fArray($e,Se){var Be=flatten(Se,this.size,4);$e.uniform4fv(this.addr,Be)}function setValueM2Array($e,Se){var Be=flatten(Se,this.size,4);$e.uniformMatrix2fv(this.addr,!1,Be)}function setValueM3Array($e,Se){var Be=flatten(Se,this.size,9);$e.uniformMatrix3fv(this.addr,!1,Be)}function setValueM4Array($e,Se){var Be=flatten(Se,this.size,16);$e.uniformMatrix4fv(this.addr,!1,Be)}function setValueT1Array($e,Se,Be){var De=Se.length,Ve=allocTexUnits(Be,De);$e.uniform1iv(this.addr,Ve);for(var Fe=0;Fe!==De;++Fe)Be.safeSetTexture2D(Se[Fe]||emptyTexture,Ve[Fe])}function setValueT6Array($e,Se,Be){var De=Se.length,Ve=allocTexUnits(Be,De);$e.uniform1iv(this.addr,Ve);for(var Fe=0;Fe!==De;++Fe)Be.safeSetTextureCube(Se[Fe]||emptyCubeTexture,Ve[Fe])}function getPureArraySetter($e){switch($e){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35680:case 36300:case 36308:case 36293:return setValueT6Array}}function SingleUniform($e,Se,Be){this.id=$e,this.addr=Be,this.cache=[],this.setValue=getSingularSetter(Se.type)}function PureArrayUniform($e,Se,Be){this.id=$e,this.addr=Be,this.cache=[],this.size=Se.size,this.setValue=getPureArraySetter(Se.type)}PureArrayUniform.prototype.updateCache=function($e){var Se=this.cache;$e instanceof Float32Array&&Se.length!==$e.length&&(this.cache=new Float32Array($e.length)),copyArray(Se,$e)};function StructuredUniform($e){this.id=$e,this.seq=[],this.map={}}StructuredUniform.prototype.setValue=function($e,Se,Be){for(var De=this.seq,Ve=0,Fe=De.length;Ve!==Fe;++Ve){var Je=De[Ve];Je.setValue($e,Se[Je.id],Be)}};var RePathPart=/([\w\d_]+)(\])?(\[|\.)?/g;function addUniform($e,Se){$e.seq.push(Se),$e.map[Se.id]=Se}function parseUniform($e,Se,Be){var De=$e.name,Ve=De.length;for(RePathPart.lastIndex=0;;){var Fe=RePathPart.exec(De),Je=RePathPart.lastIndex,Xe=Fe[1],Ke=Fe[2]==="]",Ye=Fe[3];if(Ke&&(Xe=Xe|0),Ye===void 0||Ye==="["&&Je+2===Ve){addUniform(Be,Ye===void 0?new SingleUniform(Xe,$e,Se):new PureArrayUniform(Xe,$e,Se));break}else{var or=Be.map,sr=or[Xe];sr===void 0&&(sr=new StructuredUniform(Xe),addUniform(Be,sr)),Be=sr}}}function WebGLUniforms($e,Se){this.seq=[],this.map={};for(var Be=$e.getProgramParameter(Se,35718),De=0;De<Be;++De){var Ve=$e.getActiveUniform(Se,De),Fe=$e.getUniformLocation(Se,Ve.name);parseUniform(Ve,Fe,this)}}WebGLUniforms.prototype.setValue=function($e,Se,Be,De){var Ve=this.map[Se];Ve!==void 0&&Ve.setValue($e,Be,De)};WebGLUniforms.prototype.setOptional=function($e,Se,Be){var De=Se[Be];De!==void 0&&this.setValue($e,Be,De)};WebGLUniforms.upload=function($e,Se,Be,De){for(var Ve=0,Fe=Se.length;Ve!==Fe;++Ve){var Je=Se[Ve],Xe=Be[Je.id];Xe.needsUpdate!==!1&&Je.setValue($e,Xe.value,De)}};WebGLUniforms.seqWithValue=function($e,Se){for(var Be=[],De=0,Ve=$e.length;De!==Ve;++De){var Fe=$e[De];Fe.id in Se&&Be.push(Fe)}return Be};function WebGLShader($e,Se,Be){var De=$e.createShader(Se);return $e.shaderSource(De,Be),$e.compileShader(De),De}var programIdCount=0;function addLineNumbers($e){for(var Se=$e.split(`
`),Be=0;Be<Se.length;Be++)Se[Be]=Be+1+": "+Se[Be];return Se.join(`
`)}function getEncodingComponents($e){switch($e){case LinearEncoding:return["Linear","( value )"];case sRGBEncoding:return["sRGB","( value )"];case RGBEEncoding:return["RGBE","( value )"];case RGBM7Encoding:return["RGBM","( value, 7.0 )"];case RGBM16Encoding:return["RGBM","( value, 16.0 )"];case RGBDEncoding:return["RGBD","( value, 256.0 )"];case GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case LogLuvEncoding:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+$e)}}function getShaderErrors($e,Se,Be){var De=$e.getShaderParameter(Se,35713),Ve=$e.getShaderInfoLog(Se).trim();if(De&&Ve==="")return"";var Fe=$e.getShaderSource(Se);return"THREE.WebGLShader: gl.getShaderInfoLog() "+Be+`
`+Ve+addLineNumbers(Fe)}function getTexelDecodingFunction($e,Se){var Be=getEncodingComponents(Se);return"vec4 "+$e+"( vec4 value ) { return "+Be[0]+"ToLinear"+Be[1]+"; }"}function getTexelEncodingFunction($e,Se){var Be=getEncodingComponents(Se);return"vec4 "+$e+"( vec4 value ) { return LinearTo"+Be[0]+Be[1]+"; }"}function getToneMappingFunction($e,Se){var Be;switch(Se){case LinearToneMapping:Be="Linear";break;case ReinhardToneMapping:Be="Reinhard";break;case Uncharted2ToneMapping:Be="Uncharted2";break;case CineonToneMapping:Be="OptimizedCineon";break;case ACESFilmicToneMapping:Be="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+Se)}return"vec3 "+$e+"( vec3 color ) { return "+Be+"ToneMapping( color ); }"}function generateExtensions($e){var Se=[$e.extensionDerivatives||$e.envMapCubeUV||$e.bumpMap||$e.tangentSpaceNormalMap||$e.clearcoatNormalMap||$e.flatShading||$e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",($e.extensionFragDepth||$e.logarithmicDepthBuffer)&&$e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",$e.extensionDrawBuffers&&$e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",($e.extensionShaderTextureLOD||$e.envMap)&&$e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return Se.filter(filterEmptyLine).join(`
`)}function generateDefines($e){var Se=[];for(var Be in $e){var De=$e[Be];De!==!1&&Se.push("#define "+Be+" "+De)}return Se.join(`
`)}function fetchAttributeLocations($e,Se){for(var Be={},De=$e.getProgramParameter(Se,35721),Ve=0;Ve<De;Ve++){var Fe=$e.getActiveAttrib(Se,Ve),Je=Fe.name;Be[Je]=$e.getAttribLocation(Se,Je)}return Be}function filterEmptyLine($e){return $e!==""}function replaceLightNums($e,Se){return $e.replace(/NUM_DIR_LIGHTS/g,Se.numDirLights).replace(/NUM_SPOT_LIGHTS/g,Se.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,Se.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,Se.numPointLights).replace(/NUM_HEMI_LIGHTS/g,Se.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,Se.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,Se.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,Se.numPointLightShadows)}function replaceClippingPlaneNums($e,Se){return $e.replace(/NUM_CLIPPING_PLANES/g,Se.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,Se.numClippingPlanes-Se.numClipIntersection)}var includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes($e){return $e.replace(includePattern,includeReplacer)}function includeReplacer($e,Se){var Be=ShaderChunk[Se];if(Be===void 0)throw new Error("Can not resolve #include <"+Se+">");return resolveIncludes(Be)}var deprecatedUnrollLoopPattern=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,unrollLoopPattern=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function unrollLoops($e){return $e.replace(unrollLoopPattern,loopReplacer).replace(deprecatedUnrollLoopPattern,deprecatedLoopReplacer)}function deprecatedLoopReplacer($e,Se,Be,De){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),loopReplacer($e,Se,Be,De)}function loopReplacer($e,Se,Be,De){for(var Ve="",Fe=parseInt(Se);Fe<parseInt(Be);Fe++)Ve+=De.replace(/\[ i \]/g,"[ "+Fe+" ]").replace(/UNROLLED_LOOP_INDEX/g,Fe);return Ve}function generatePrecision($e){var Se="precision "+$e.precision+` float;
precision `+$e.precision+" int;";return $e.precision==="highp"?Se+=`
#define HIGH_PRECISION`:$e.precision==="mediump"?Se+=`
#define MEDIUM_PRECISION`:$e.precision==="lowp"&&(Se+=`
#define LOW_PRECISION`),Se}function generateShadowMapTypeDefine($e){var Se="SHADOWMAP_TYPE_BASIC";return $e.shadowMapType===PCFShadowMap?Se="SHADOWMAP_TYPE_PCF":$e.shadowMapType===PCFSoftShadowMap?Se="SHADOWMAP_TYPE_PCF_SOFT":$e.shadowMapType===VSMShadowMap&&(Se="SHADOWMAP_TYPE_VSM"),Se}function generateEnvMapTypeDefine($e){var Se="ENVMAP_TYPE_CUBE";if($e.envMap)switch($e.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:Se="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:case CubeUVRefractionMapping:Se="ENVMAP_TYPE_CUBE_UV";break;case EquirectangularReflectionMapping:case EquirectangularRefractionMapping:Se="ENVMAP_TYPE_EQUIREC";break;case SphericalReflectionMapping:Se="ENVMAP_TYPE_SPHERE";break}return Se}function generateEnvMapModeDefine($e){var Se="ENVMAP_MODE_REFLECTION";if($e.envMap)switch($e.envMapMode){case CubeRefractionMapping:case EquirectangularRefractionMapping:Se="ENVMAP_MODE_REFRACTION";break}return Se}function generateEnvMapBlendingDefine($e){var Se="ENVMAP_BLENDING_NONE";if($e.envMap)switch($e.combine){case MultiplyOperation:Se="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:Se="ENVMAP_BLENDING_MIX";break;case AddOperation:Se="ENVMAP_BLENDING_ADD";break}return Se}function WebGLProgram($e,Se,Be){var De=$e.getContext(),Ve=Be.defines,Fe=Be.vertexShader,Je=Be.fragmentShader,Xe=generateShadowMapTypeDefine(Be),Ke=generateEnvMapTypeDefine(Be),Ye=generateEnvMapModeDefine(Be),or=generateEnvMapBlendingDefine(Be),sr=$e.gammaFactor>0?$e.gammaFactor:1,cr=Be.isWebGL2?"":generateExtensions(Be),Br=generateDefines(Ve),tn=De.createProgram(),en,an;if(Be.isRawShaderMaterial?(en=[Br].filter(filterEmptyLine).join(`
`),en.length>0&&(en+=`
`),an=[cr,Br].filter(filterEmptyLine).join(`
`),an.length>0&&(an+=`
`)):(en=[generatePrecision(Be),"#define SHADER_NAME "+Be.shaderName,Br,Be.instancing?"#define USE_INSTANCING":"",Be.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+sr,"#define MAX_BONES "+Be.maxBones,Be.useFog&&Be.fog?"#define USE_FOG":"",Be.useFog&&Be.fogExp2?"#define FOG_EXP2":"",Be.map?"#define USE_MAP":"",Be.envMap?"#define USE_ENVMAP":"",Be.envMap?"#define "+Ye:"",Be.lightMap?"#define USE_LIGHTMAP":"",Be.aoMap?"#define USE_AOMAP":"",Be.emissiveMap?"#define USE_EMISSIVEMAP":"",Be.bumpMap?"#define USE_BUMPMAP":"",Be.normalMap?"#define USE_NORMALMAP":"",Be.normalMap&&Be.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",Be.normalMap&&Be.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",Be.clearcoatMap?"#define USE_CLEARCOATMAP":"",Be.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",Be.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",Be.displacementMap&&Be.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",Be.specularMap?"#define USE_SPECULARMAP":"",Be.roughnessMap?"#define USE_ROUGHNESSMAP":"",Be.metalnessMap?"#define USE_METALNESSMAP":"",Be.alphaMap?"#define USE_ALPHAMAP":"",Be.vertexTangents?"#define USE_TANGENT":"",Be.vertexColors?"#define USE_COLOR":"",Be.vertexUvs?"#define USE_UV":"",Be.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",Be.flatShading?"#define FLAT_SHADED":"",Be.skinning?"#define USE_SKINNING":"",Be.useVertexTexture?"#define BONE_TEXTURE":"",Be.morphTargets?"#define USE_MORPHTARGETS":"",Be.morphNormals&&Be.flatShading===!1?"#define USE_MORPHNORMALS":"",Be.doubleSided?"#define DOUBLE_SIDED":"",Be.flipSided?"#define FLIP_SIDED":"",Be.shadowMapEnabled?"#define USE_SHADOWMAP":"",Be.shadowMapEnabled?"#define "+Xe:"",Be.sizeAttenuation?"#define USE_SIZEATTENUATION":"",Be.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Be.logarithmicDepthBuffer&&Be.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),an=[cr,generatePrecision(Be),"#define SHADER_NAME "+Be.shaderName,Br,Be.alphaTest?"#define ALPHATEST "+Be.alphaTest+(Be.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+sr,Be.useFog&&Be.fog?"#define USE_FOG":"",Be.useFog&&Be.fogExp2?"#define FOG_EXP2":"",Be.map?"#define USE_MAP":"",Be.matcap?"#define USE_MATCAP":"",Be.envMap?"#define USE_ENVMAP":"",Be.envMap?"#define "+Ke:"",Be.envMap?"#define "+Ye:"",Be.envMap?"#define "+or:"",Be.lightMap?"#define USE_LIGHTMAP":"",Be.aoMap?"#define USE_AOMAP":"",Be.emissiveMap?"#define USE_EMISSIVEMAP":"",Be.bumpMap?"#define USE_BUMPMAP":"",Be.normalMap?"#define USE_NORMALMAP":"",Be.normalMap&&Be.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",Be.normalMap&&Be.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",Be.clearcoatMap?"#define USE_CLEARCOATMAP":"",Be.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",Be.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",Be.specularMap?"#define USE_SPECULARMAP":"",Be.roughnessMap?"#define USE_ROUGHNESSMAP":"",Be.metalnessMap?"#define USE_METALNESSMAP":"",Be.alphaMap?"#define USE_ALPHAMAP":"",Be.sheen?"#define USE_SHEEN":"",Be.vertexTangents?"#define USE_TANGENT":"",Be.vertexColors?"#define USE_COLOR":"",Be.vertexUvs?"#define USE_UV":"",Be.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",Be.gradientMap?"#define USE_GRADIENTMAP":"",Be.flatShading?"#define FLAT_SHADED":"",Be.doubleSided?"#define DOUBLE_SIDED":"",Be.flipSided?"#define FLIP_SIDED":"",Be.shadowMapEnabled?"#define USE_SHADOWMAP":"",Be.shadowMapEnabled?"#define "+Xe:"",Be.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",Be.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",Be.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Be.logarithmicDepthBuffer&&Be.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(Be.extensionShaderTextureLOD||Be.envMap)&&Be.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",Be.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",Be.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",Be.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",Be.toneMapping):"",Be.dithering?"#define DITHERING":"",Be.outputEncoding||Be.mapEncoding||Be.matcapEncoding||Be.envMapEncoding||Be.emissiveMapEncoding||Be.lightMapEncoding?ShaderChunk.encodings_pars_fragment:"",Be.mapEncoding?getTexelDecodingFunction("mapTexelToLinear",Be.mapEncoding):"",Be.matcapEncoding?getTexelDecodingFunction("matcapTexelToLinear",Be.matcapEncoding):"",Be.envMapEncoding?getTexelDecodingFunction("envMapTexelToLinear",Be.envMapEncoding):"",Be.emissiveMapEncoding?getTexelDecodingFunction("emissiveMapTexelToLinear",Be.emissiveMapEncoding):"",Be.lightMapEncoding?getTexelDecodingFunction("lightMapTexelToLinear",Be.lightMapEncoding):"",Be.outputEncoding?getTexelEncodingFunction("linearToOutputTexel",Be.outputEncoding):"",Be.depthPacking?"#define DEPTH_PACKING "+Be.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),Fe=resolveIncludes(Fe),Fe=replaceLightNums(Fe,Be),Fe=replaceClippingPlaneNums(Fe,Be),Je=resolveIncludes(Je),Je=replaceLightNums(Je,Be),Je=replaceClippingPlaneNums(Je,Be),Fe=unrollLoops(Fe),Je=unrollLoops(Je),Be.isWebGL2&&!Be.isRawShaderMaterial){var rn=!1,on=/^\s*#version\s+300\s+es\s*\n/;Be.isShaderMaterial&&Fe.match(on)!==null&&Je.match(on)!==null&&(rn=!0,Fe=Fe.replace(on,""),Je=Je.replace(on,"")),en=[`#version 300 es
`,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+en,an=[`#version 300 es
`,"#define varying in",rn?"":"out highp vec4 pc_fragColor;",rn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+an}var sn=en+Fe,ln=an+Je,cn=WebGLShader(De,35633,sn),hn=WebGLShader(De,35632,ln);if(De.attachShader(tn,cn),De.attachShader(tn,hn),Be.index0AttributeName!==void 0?De.bindAttribLocation(tn,0,Be.index0AttributeName):Be.morphTargets===!0&&De.bindAttribLocation(tn,0,"position"),De.linkProgram(tn),$e.debug.checkShaderErrors){var mn=De.getProgramInfoLog(tn).trim(),An=De.getShaderInfoLog(cn).trim(),xn=De.getShaderInfoLog(hn).trim(),pn=!0,dn=!0;if(De.getProgramParameter(tn,35714)===!1){pn=!1;var fn=getShaderErrors(De,cn,"vertex"),yn=getShaderErrors(De,hn,"fragment");console.error("THREE.WebGLProgram: shader error: ",De.getError(),"35715",De.getProgramParameter(tn,35715),"gl.getProgramInfoLog",mn,fn,yn)}else mn!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",mn):(An===""||xn==="")&&(dn=!1);dn&&(this.diagnostics={runnable:pn,programLog:mn,vertexShader:{log:An,prefix:en},fragmentShader:{log:xn,prefix:an}})}De.deleteShader(cn),De.deleteShader(hn);var Sn;this.getUniforms=function(){return Sn===void 0&&(Sn=new WebGLUniforms(De,tn)),Sn};var gn;return this.getAttributes=function(){return gn===void 0&&(gn=fetchAttributeLocations(De,tn)),gn},this.destroy=function(){De.deleteProgram(tn),this.program=void 0},this.name=Be.shaderName,this.id=programIdCount++,this.cacheKey=Se,this.usedTimes=1,this.program=tn,this.vertexShader=cn,this.fragmentShader=hn,this}function WebGLPrograms($e,Se,Be){var De=[],Ve=Be.isWebGL2,Fe=Be.logarithmicDepthBuffer,Je=Be.floatVertexTextures,Xe=Be.precision,Ke=Be.maxVertexUniforms,Ye=Be.vertexTextures,or={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},sr=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function cr(en,an){var rn;if(an){var on=ShaderLib[an];rn={name:en.type,uniforms:UniformsUtils.clone(on.uniforms),vertexShader:on.vertexShader,fragmentShader:on.fragmentShader}}else rn={name:en.type,uniforms:en.uniforms,vertexShader:en.vertexShader,fragmentShader:en.fragmentShader};return rn}function Br(en){var an=en.skeleton,rn=an.bones;if(Je)return 1024;var on=Ke,sn=Math.floor((on-20)/4),ln=Math.min(sn,rn.length);return ln<rn.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+rn.length+" bones. This GPU supports "+ln+"."),0):ln}function tn(en){var an;return en?en.isTexture?an=en.encoding:en.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),an=en.texture.encoding):an=LinearEncoding,an}this.getParameters=function(en,an,rn,on,sn,ln,cn){var hn=on.fog,mn=en.isMeshStandardMaterial?on.environment:null,An=en.envMap||mn,xn=or[en.type],pn=cn.isSkinnedMesh?Br(cn):0;en.precision!==null&&(Xe=Be.getMaxPrecision(en.precision),Xe!==en.precision&&console.warn("THREE.WebGLProgram.getParameters:",en.precision,"not supported, using",Xe,"instead."));var dn=cr(en,xn);en.onBeforeCompile(dn,$e);var fn=$e.getRenderTarget(),yn={isWebGL2:Ve,shaderID:xn,shaderName:dn.name,uniforms:dn.uniforms,vertexShader:dn.vertexShader,fragmentShader:dn.fragmentShader,defines:en.defines,isRawShaderMaterial:en.isRawShaderMaterial,isShaderMaterial:en.isShaderMaterial,precision:Xe,instancing:cn.isInstancedMesh===!0,supportsVertexTextures:Ye,outputEncoding:fn!==null?tn(fn.texture):$e.outputEncoding,map:!!en.map,mapEncoding:tn(en.map),matcap:!!en.matcap,matcapEncoding:tn(en.matcap),envMap:!!An,envMapMode:An&&An.mapping,envMapEncoding:tn(An),envMapCubeUV:!!An&&(An.mapping===CubeUVReflectionMapping||An.mapping===CubeUVRefractionMapping),lightMap:!!en.lightMap,lightMapEncoding:tn(en.lightMap),aoMap:!!en.aoMap,emissiveMap:!!en.emissiveMap,emissiveMapEncoding:tn(en.emissiveMap),bumpMap:!!en.bumpMap,normalMap:!!en.normalMap,objectSpaceNormalMap:en.normalMapType===ObjectSpaceNormalMap,tangentSpaceNormalMap:en.normalMapType===TangentSpaceNormalMap,clearcoatMap:!!en.clearcoatMap,clearcoatRoughnessMap:!!en.clearcoatRoughnessMap,clearcoatNormalMap:!!en.clearcoatNormalMap,displacementMap:!!en.displacementMap,roughnessMap:!!en.roughnessMap,metalnessMap:!!en.metalnessMap,specularMap:!!en.specularMap,alphaMap:!!en.alphaMap,gradientMap:!!en.gradientMap,sheen:!!en.sheen,combine:en.combine,vertexTangents:en.normalMap&&en.vertexTangents,vertexColors:en.vertexColors,vertexUvs:!!en.map||!!en.bumpMap||!!en.normalMap||!!en.specularMap||!!en.alphaMap||!!en.emissiveMap||!!en.roughnessMap||!!en.metalnessMap||!!en.clearcoatMap||!!en.clearcoatRoughnessMap||!!en.clearcoatNormalMap||!!en.displacementMap,uvsVertexOnly:!(en.map||en.bumpMap||en.normalMap||en.specularMap||en.alphaMap||en.emissiveMap||en.roughnessMap||en.metalnessMap||en.clearcoatNormalMap)&&!!en.displacementMap,fog:!!hn,useFog:en.fog,fogExp2:hn&&hn.isFogExp2,flatShading:en.flatShading,sizeAttenuation:en.sizeAttenuation,logarithmicDepthBuffer:Fe,skinning:en.skinning&&pn>0,maxBones:pn,useVertexTexture:Je,morphTargets:en.morphTargets,morphNormals:en.morphNormals,maxMorphTargets:$e.maxMorphTargets,maxMorphNormals:$e.maxMorphNormals,numDirLights:an.directional.length,numPointLights:an.point.length,numSpotLights:an.spot.length,numRectAreaLights:an.rectArea.length,numHemiLights:an.hemi.length,numDirLightShadows:an.directionalShadowMap.length,numPointLightShadows:an.pointShadowMap.length,numSpotLightShadows:an.spotShadowMap.length,numClippingPlanes:sn,numClipIntersection:ln,dithering:en.dithering,shadowMapEnabled:$e.shadowMap.enabled&&rn.length>0,shadowMapType:$e.shadowMap.type,toneMapping:en.toneMapped?$e.toneMapping:NoToneMapping,physicallyCorrectLights:$e.physicallyCorrectLights,premultipliedAlpha:en.premultipliedAlpha,alphaTest:en.alphaTest,doubleSided:en.side===DoubleSide,flipSided:en.side===BackSide,depthPacking:en.depthPacking!==void 0?en.depthPacking:!1,index0AttributeName:en.index0AttributeName,extensionDerivatives:en.extensions&&en.extensions.derivatives,extensionFragDepth:en.extensions&&en.extensions.fragDepth,extensionDrawBuffers:en.extensions&&en.extensions.drawBuffers,extensionShaderTextureLOD:en.extensions&&en.extensions.shaderTextureLOD,rendererExtensionFragDepth:Ve||Se.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:Ve||Se.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:Ve||Se.get("EXT_shader_texture_lod")!==null,onBeforeCompile:en.onBeforeCompile};return yn},this.getProgramCacheKey=function(en){var an=[];if(en.shaderID?an.push(en.shaderID):(an.push(en.fragmentShader),an.push(en.vertexShader)),en.defines!==void 0)for(var rn in en.defines)an.push(rn),an.push(en.defines[rn]);if(en.isRawShaderMaterial===void 0){for(var on=0;on<sr.length;on++)an.push(en[sr[on]]);an.push($e.outputEncoding),an.push($e.gammaFactor)}return an.push(en.onBeforeCompile.toString()),an.join()},this.acquireProgram=function(en,an){for(var rn,on=0,sn=De.length;on<sn;on++){var ln=De[on];if(ln.cacheKey===an){rn=ln,++rn.usedTimes;break}}return rn===void 0&&(rn=new WebGLProgram($e,an,en),De.push(rn)),rn},this.releaseProgram=function(en){if(--en.usedTimes===0){var an=De.indexOf(en);De[an]=De[De.length-1],De.pop(),en.destroy()}},this.programs=De}function WebGLProperties(){var $e=new WeakMap;function Se(Fe){var Je=$e.get(Fe);return Je===void 0&&(Je={},$e.set(Fe,Je)),Je}function Be(Fe){$e.delete(Fe)}function De(Fe,Je,Xe){$e.get(Fe)[Je]=Xe}function Ve(){$e=new WeakMap}return{get:Se,remove:Be,update:De,dispose:Ve}}function painterSortStable($e,Se){return $e.groupOrder!==Se.groupOrder?$e.groupOrder-Se.groupOrder:$e.renderOrder!==Se.renderOrder?$e.renderOrder-Se.renderOrder:$e.program!==Se.program?$e.program.id-Se.program.id:$e.material.id!==Se.material.id?$e.material.id-Se.material.id:$e.z!==Se.z?$e.z-Se.z:$e.id-Se.id}function reversePainterSortStable($e,Se){return $e.groupOrder!==Se.groupOrder?$e.groupOrder-Se.groupOrder:$e.renderOrder!==Se.renderOrder?$e.renderOrder-Se.renderOrder:$e.z!==Se.z?Se.z-$e.z:$e.id-Se.id}function WebGLRenderList(){var $e=[],Se=0,Be=[],De=[],Ve={id:-1};function Fe(){Se=0,Be.length=0,De.length=0}function Je(sr,cr,Br,tn,en,an){var rn=$e[Se];return rn===void 0?(rn={id:sr.id,object:sr,geometry:cr,material:Br,program:Br.program||Ve,groupOrder:tn,renderOrder:sr.renderOrder,z:en,group:an},$e[Se]=rn):(rn.id=sr.id,rn.object=sr,rn.geometry=cr,rn.material=Br,rn.program=Br.program||Ve,rn.groupOrder=tn,rn.renderOrder=sr.renderOrder,rn.z=en,rn.group=an),Se++,rn}function Xe(sr,cr,Br,tn,en,an){var rn=Je(sr,cr,Br,tn,en,an);(Br.transparent===!0?De:Be).push(rn)}function Ke(sr,cr,Br,tn,en,an){var rn=Je(sr,cr,Br,tn,en,an);(Br.transparent===!0?De:Be).unshift(rn)}function Ye(sr,cr){Be.length>1&&Be.sort(sr||painterSortStable),De.length>1&&De.sort(cr||reversePainterSortStable)}function or(){for(var sr=Se,cr=$e.length;sr<cr;sr++){var Br=$e[sr];if(Br.id===null)break;Br.id=null,Br.object=null,Br.geometry=null,Br.material=null,Br.program=null,Br.group=null}}return{opaque:Be,transparent:De,init:Fe,push:Xe,unshift:Ke,finish:or,sort:Ye}}function WebGLRenderLists(){var $e=new WeakMap;function Se(Ve){var Fe=Ve.target;Fe.removeEventListener("dispose",Se),$e.delete(Fe)}function Be(Ve,Fe){var Je=$e.get(Ve),Xe;return Je===void 0?(Xe=new WebGLRenderList,$e.set(Ve,new WeakMap),$e.get(Ve).set(Fe,Xe),Ve.addEventListener("dispose",Se)):(Xe=Je.get(Fe),Xe===void 0&&(Xe=new WebGLRenderList,Je.set(Fe,Xe))),Xe}function De(){$e=new WeakMap}return{get:Be,dispose:De}}function UniformsCache(){var $e={};return{get:function(Se){if($e[Se.id]!==void 0)return $e[Se.id];var Be;switch(Se.type){case"DirectionalLight":Be={direction:new Vector3,color:new Color};break;case"SpotLight":Be={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":Be={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":Be={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":Be={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return $e[Se.id]=Be,Be}}}function ShadowUniformsCache(){var $e={};return{get:function(Se){if($e[Se.id]!==void 0)return $e[Se.id];var Be;switch(Se.type){case"DirectionalLight":Be={shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":Be={shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":Be={shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return $e[Se.id]=Be,Be}}}var nextVersion=0;function shadowCastingLightsFirst($e,Se){return(Se.castShadow?1:0)-($e.castShadow?1:0)}function WebGLLights(){for(var $e=new UniformsCache,Se=ShadowUniformsCache(),Be={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},De=0;De<9;De++)Be.probe.push(new Vector3);var Ve=new Vector3,Fe=new Matrix4,Je=new Matrix4;function Xe(Ke,Ye,or){for(var sr=0,cr=0,Br=0,tn=0;tn<9;tn++)Be.probe[tn].set(0,0,0);var en=0,an=0,rn=0,on=0,sn=0,ln=0,cn=0,hn=0,mn=or.matrixWorldInverse;Ke.sort(shadowCastingLightsFirst);for(var tn=0,An=Ke.length;tn<An;tn++){var xn=Ke[tn],pn=xn.color,dn=xn.intensity,fn=xn.distance,yn=xn.shadow&&xn.shadow.map?xn.shadow.map.texture:null;if(xn.isAmbientLight)sr+=pn.r*dn,cr+=pn.g*dn,Br+=pn.b*dn;else if(xn.isLightProbe)for(var Sn=0;Sn<9;Sn++)Be.probe[Sn].addScaledVector(xn.sh.coefficients[Sn],dn);else if(xn.isDirectionalLight){var gn=$e.get(xn);if(gn.color.copy(xn.color).multiplyScalar(xn.intensity),gn.direction.setFromMatrixPosition(xn.matrixWorld),Ve.setFromMatrixPosition(xn.target.matrixWorld),gn.direction.sub(Ve),gn.direction.transformDirection(mn),xn.castShadow){var Cn=xn.shadow,Mn=Se.get(xn);Mn.shadowBias=Cn.bias,Mn.shadowRadius=Cn.radius,Mn.shadowMapSize=Cn.mapSize,Be.directionalShadow[en]=Mn,Be.directionalShadowMap[en]=yn,Be.directionalShadowMatrix[en]=xn.shadow.matrix,ln++}Be.directional[en]=gn,en++}else if(xn.isSpotLight){var gn=$e.get(xn);if(gn.position.setFromMatrixPosition(xn.matrixWorld),gn.position.applyMatrix4(mn),gn.color.copy(pn).multiplyScalar(dn),gn.distance=fn,gn.direction.setFromMatrixPosition(xn.matrixWorld),Ve.setFromMatrixPosition(xn.target.matrixWorld),gn.direction.sub(Ve),gn.direction.transformDirection(mn),gn.coneCos=Math.cos(xn.angle),gn.penumbraCos=Math.cos(xn.angle*(1-xn.penumbra)),gn.decay=xn.decay,xn.castShadow){var Cn=xn.shadow,Mn=Se.get(xn);Mn.shadowBias=Cn.bias,Mn.shadowRadius=Cn.radius,Mn.shadowMapSize=Cn.mapSize,Be.spotShadow[rn]=Mn,Be.spotShadowMap[rn]=yn,Be.spotShadowMatrix[rn]=xn.shadow.matrix,hn++}Be.spot[rn]=gn,rn++}else if(xn.isRectAreaLight){var gn=$e.get(xn);gn.color.copy(pn).multiplyScalar(dn),gn.position.setFromMatrixPosition(xn.matrixWorld),gn.position.applyMatrix4(mn),Je.identity(),Fe.copy(xn.matrixWorld),Fe.premultiply(mn),Je.extractRotation(Fe),gn.halfWidth.set(xn.width*.5,0,0),gn.halfHeight.set(0,xn.height*.5,0),gn.halfWidth.applyMatrix4(Je),gn.halfHeight.applyMatrix4(Je),Be.rectArea[on]=gn,on++}else if(xn.isPointLight){var gn=$e.get(xn);if(gn.position.setFromMatrixPosition(xn.matrixWorld),gn.position.applyMatrix4(mn),gn.color.copy(xn.color).multiplyScalar(xn.intensity),gn.distance=xn.distance,gn.decay=xn.decay,xn.castShadow){var Cn=xn.shadow,Mn=Se.get(xn);Mn.shadowBias=Cn.bias,Mn.shadowRadius=Cn.radius,Mn.shadowMapSize=Cn.mapSize,Mn.shadowCameraNear=Cn.camera.near,Mn.shadowCameraFar=Cn.camera.far,Be.pointShadow[an]=Mn,Be.pointShadowMap[an]=yn,Be.pointShadowMatrix[an]=xn.shadow.matrix,cn++}Be.point[an]=gn,an++}else if(xn.isHemisphereLight){var gn=$e.get(xn);gn.direction.setFromMatrixPosition(xn.matrixWorld),gn.direction.transformDirection(mn),gn.direction.normalize(),gn.skyColor.copy(xn.color).multiplyScalar(dn),gn.groundColor.copy(xn.groundColor).multiplyScalar(dn),Be.hemi[sn]=gn,sn++}}Be.ambient[0]=sr,Be.ambient[1]=cr,Be.ambient[2]=Br;var Bn=Be.hash;(Bn.directionalLength!==en||Bn.pointLength!==an||Bn.spotLength!==rn||Bn.rectAreaLength!==on||Bn.hemiLength!==sn||Bn.numDirectionalShadows!==ln||Bn.numPointShadows!==cn||Bn.numSpotShadows!==hn)&&(Be.directional.length=en,Be.spot.length=rn,Be.rectArea.length=on,Be.point.length=an,Be.hemi.length=sn,Be.directionalShadow.length=ln,Be.directionalShadowMap.length=ln,Be.pointShadow.length=cn,Be.pointShadowMap.length=cn,Be.spotShadow.length=hn,Be.spotShadowMap.length=hn,Be.directionalShadowMatrix.length=ln,Be.pointShadowMatrix.length=cn,Be.spotShadowMatrix.length=hn,Bn.directionalLength=en,Bn.pointLength=an,Bn.spotLength=rn,Bn.rectAreaLength=on,Bn.hemiLength=sn,Bn.numDirectionalShadows=ln,Bn.numPointShadows=cn,Bn.numSpotShadows=hn,Be.version=nextVersion++)}return{setup:Xe,state:Be}}function WebGLRenderState(){var $e=new WebGLLights,Se=[],Be=[];function De(){Se.length=0,Be.length=0}function Ve(Ke){Se.push(Ke)}function Fe(Ke){Be.push(Ke)}function Je(Ke){$e.setup(Se,Be,Ke)}var Xe={lightsArray:Se,shadowsArray:Be,lights:$e};return{init:De,state:Xe,setupLights:Je,pushLight:Ve,pushShadow:Fe}}function WebGLRenderStates(){var $e=new WeakMap;function Se(Ve){var Fe=Ve.target;Fe.removeEventListener("dispose",Se),$e.delete(Fe)}function Be(Ve,Fe){var Je;return $e.has(Ve)===!1?(Je=new WebGLRenderState,$e.set(Ve,new WeakMap),$e.get(Ve).set(Fe,Je),Ve.addEventListener("dispose",Se)):$e.get(Ve).has(Fe)===!1?(Je=new WebGLRenderState,$e.get(Ve).set(Fe,Je)):Je=$e.get(Ve).get(Fe),Je}function De(){$e=new WeakMap}return{get:Be,dispose:De}}function MeshDepthMaterial($e){Material.call(this),this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues($e)}MeshDepthMaterial.prototype=Object.create(Material.prototype);MeshDepthMaterial.prototype.constructor=MeshDepthMaterial;MeshDepthMaterial.prototype.isMeshDepthMaterial=!0;MeshDepthMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.depthPacking=$e.depthPacking,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.map=$e.map,this.alphaMap=$e.alphaMap,this.displacementMap=$e.displacementMap,this.displacementScale=$e.displacementScale,this.displacementBias=$e.displacementBias,this.wireframe=$e.wireframe,this.wireframeLinewidth=$e.wireframeLinewidth,this};function MeshDistanceMaterial($e){Material.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Vector3,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues($e)}MeshDistanceMaterial.prototype=Object.create(Material.prototype);MeshDistanceMaterial.prototype.constructor=MeshDistanceMaterial;MeshDistanceMaterial.prototype.isMeshDistanceMaterial=!0;MeshDistanceMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.referencePosition.copy($e.referencePosition),this.nearDistance=$e.nearDistance,this.farDistance=$e.farDistance,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.map=$e.map,this.alphaMap=$e.alphaMap,this.displacementMap=$e.displacementMap,this.displacementScale=$e.displacementScale,this.displacementBias=$e.displacementBias,this};var vsm_frag=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,vsm_vert=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function WebGLShadowMap($e,Se,Be){var De=new Frustum,Ve=new Vector2,Fe=new Vector2,Je=new Vector4,Xe=[],Ke=[],Ye={},or={0:BackSide,1:FrontSide,2:DoubleSide},sr=new ShaderMaterial({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vsm_vert,fragmentShader:vsm_frag}),cr=sr.clone();cr.defines.HORIZONAL_PASS=1;var Br=new BufferGeometry;Br.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var tn=new Mesh(Br,sr),en=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap,this.render=function(cn,hn,mn){if(en.enabled!==!1&&!(en.autoUpdate===!1&&en.needsUpdate===!1)&&cn.length!==0){var An=$e.getRenderTarget(),xn=$e.getActiveCubeFace(),pn=$e.getActiveMipmapLevel(),dn=$e.state;dn.setBlending(NoBlending),dn.buffers.color.setClear(1,1,1,1),dn.buffers.depth.setTest(!0),dn.setScissorTest(!1);for(var fn=0,yn=cn.length;fn<yn;fn++){var Sn=cn[fn],gn=Sn.shadow;if(gn===void 0){console.warn("THREE.WebGLShadowMap:",Sn,"has no shadow.");continue}Ve.copy(gn.mapSize);var Cn=gn.getFrameExtents();if(Ve.multiply(Cn),Fe.copy(gn.mapSize),(Ve.x>Be||Ve.y>Be)&&(Ve.x>Be&&(Fe.x=Math.floor(Be/Cn.x),Ve.x=Fe.x*Cn.x,gn.mapSize.x=Fe.x),Ve.y>Be&&(Fe.y=Math.floor(Be/Cn.y),Ve.y=Fe.y*Cn.y,gn.mapSize.y=Fe.y)),gn.map===null&&!gn.isPointLightShadow&&this.type===VSMShadowMap){var Mn={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat};gn.map=new WebGLRenderTarget(Ve.x,Ve.y,Mn),gn.map.texture.name=Sn.name+".shadowMap",gn.mapPass=new WebGLRenderTarget(Ve.x,Ve.y,Mn),gn.camera.updateProjectionMatrix()}if(gn.map===null){var Mn={minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat};gn.map=new WebGLRenderTarget(Ve.x,Ve.y,Mn),gn.map.texture.name=Sn.name+".shadowMap",gn.camera.updateProjectionMatrix()}$e.setRenderTarget(gn.map),$e.clear();for(var Bn=gn.getViewportCount(),kn=0;kn<Bn;kn++){var Ln=gn.getViewport(kn);Je.set(Fe.x*Ln.x,Fe.y*Ln.y,Fe.x*Ln.z,Fe.y*Ln.w),dn.viewport(Je),gn.updateMatrices(Sn,kn),De=gn.getFrustum(),ln(hn,mn,gn.camera,Sn,this.type)}!gn.isPointLightShadow&&this.type===VSMShadowMap&&an(gn,mn)}en.needsUpdate=!1,$e.setRenderTarget(An,xn,pn)}};function an(cn,hn){var mn=Se.update(tn);sr.uniforms.shadow_pass.value=cn.map.texture,sr.uniforms.resolution.value=cn.mapSize,sr.uniforms.radius.value=cn.radius,$e.setRenderTarget(cn.mapPass),$e.clear(),$e.renderBufferDirect(hn,null,mn,sr,tn,null),cr.uniforms.shadow_pass.value=cn.mapPass.texture,cr.uniforms.resolution.value=cn.mapSize,cr.uniforms.radius.value=cn.radius,$e.setRenderTarget(cn.map),$e.clear(),$e.renderBufferDirect(hn,null,mn,cr,tn,null)}function rn(cn,hn,mn){var An=cn<<0|hn<<1|mn<<2,xn=Xe[An];return xn===void 0&&(xn=new MeshDepthMaterial({depthPacking:RGBADepthPacking,morphTargets:cn,skinning:hn}),Xe[An]=xn),xn}function on(cn,hn,mn){var An=cn<<0|hn<<1|mn<<2,xn=Ke[An];return xn===void 0&&(xn=new MeshDistanceMaterial({morphTargets:cn,skinning:hn}),Ke[An]=xn),xn}function sn(cn,hn,mn,An,xn,pn,dn){var fn=null,yn=rn,Sn=cn.customDepthMaterial;if(An.isPointLight===!0&&(yn=on,Sn=cn.customDistanceMaterial),Sn===void 0){var gn=!1;mn.morphTargets===!0&&(gn=hn.morphAttributes&&hn.morphAttributes.position&&hn.morphAttributes.position.length>0);var Cn=!1;cn.isSkinnedMesh===!0&&(mn.skinning===!0?Cn=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",cn));var Mn=cn.isInstancedMesh===!0;fn=yn(gn,Cn,Mn)}else fn=Sn;if($e.localClippingEnabled&&mn.clipShadows===!0&&mn.clippingPlanes.length!==0){var Bn=fn.uuid,kn=mn.uuid,Ln=Ye[Bn];Ln===void 0&&(Ln={},Ye[Bn]=Ln);var Pn=Ln[kn];Pn===void 0&&(Pn=fn.clone(),Ln[kn]=Pn),fn=Pn}return fn.visible=mn.visible,fn.wireframe=mn.wireframe,dn===VSMShadowMap?fn.side=mn.shadowSide!==null?mn.shadowSide:mn.side:fn.side=mn.shadowSide!==null?mn.shadowSide:or[mn.side],fn.clipShadows=mn.clipShadows,fn.clippingPlanes=mn.clippingPlanes,fn.clipIntersection=mn.clipIntersection,fn.wireframeLinewidth=mn.wireframeLinewidth,fn.linewidth=mn.linewidth,An.isPointLight===!0&&fn.isMeshDistanceMaterial===!0&&(fn.referencePosition.setFromMatrixPosition(An.matrixWorld),fn.nearDistance=xn,fn.farDistance=pn),fn}function ln(cn,hn,mn,An,xn){if(cn.visible!==!1){var pn=cn.layers.test(hn.layers);if(pn&&(cn.isMesh||cn.isLine||cn.isPoints)&&(cn.castShadow||cn.receiveShadow&&xn===VSMShadowMap)&&(!cn.frustumCulled||De.intersectsObject(cn))){cn.modelViewMatrix.multiplyMatrices(mn.matrixWorldInverse,cn.matrixWorld);var dn=Se.update(cn),fn=cn.material;if(Array.isArray(fn))for(var yn=dn.groups,Sn=0,gn=yn.length;Sn<gn;Sn++){var Cn=yn[Sn],Mn=fn[Cn.materialIndex];if(Mn&&Mn.visible){var Bn=sn(cn,dn,Mn,An,mn.near,mn.far,xn);$e.renderBufferDirect(mn,null,dn,Bn,cn,Cn)}}else if(fn.visible){var Bn=sn(cn,dn,fn,An,mn.near,mn.far,xn);$e.renderBufferDirect(mn,null,dn,Bn,cn,null)}}for(var kn=cn.children,Ln=0,Pn=kn.length;Ln<Pn;Ln++)ln(kn[Ln],hn,mn,An,xn)}}}function WebGLState($e,Se,Be){var De=Be.isWebGL2;function Ve(){var ri=!1,Ti=new Vector4,Bi=null,qi=new Vector4(0,0,0,0);return{setMask:function(Ii){Bi!==Ii&&!ri&&($e.colorMask(Ii,Ii,Ii,Ii),Bi=Ii)},setLocked:function(Ii){ri=Ii},setClear:function(Ii,Ui,ho,lo,po){po===!0&&(Ii*=lo,Ui*=lo,ho*=lo),Ti.set(Ii,Ui,ho,lo),qi.equals(Ti)===!1&&($e.clearColor(Ii,Ui,ho,lo),qi.copy(Ti))},reset:function(){ri=!1,Bi=null,qi.set(-1,0,0,0)}}}function Fe(){var ri=!1,Ti=null,Bi=null,qi=null;return{setTest:function(Ii){Ii?Hn(2929):Dn(2929)},setMask:function(Ii){Ti!==Ii&&!ri&&($e.depthMask(Ii),Ti=Ii)},setFunc:function(Ii){if(Bi!==Ii){if(Ii)switch(Ii){case NeverDepth:$e.depthFunc(512);break;case AlwaysDepth:$e.depthFunc(519);break;case LessDepth:$e.depthFunc(513);break;case LessEqualDepth:$e.depthFunc(515);break;case EqualDepth:$e.depthFunc(514);break;case GreaterEqualDepth:$e.depthFunc(518);break;case GreaterDepth:$e.depthFunc(516);break;case NotEqualDepth:$e.depthFunc(517);break;default:$e.depthFunc(515)}else $e.depthFunc(515);Bi=Ii}},setLocked:function(Ii){ri=Ii},setClear:function(Ii){qi!==Ii&&($e.clearDepth(Ii),qi=Ii)},reset:function(){ri=!1,Ti=null,Bi=null,qi=null}}}function Je(){var ri=!1,Ti=null,Bi=null,qi=null,Ii=null,Ui=null,ho=null,lo=null,po=null;return{setTest:function(co){ri||(co?Hn(2960):Dn(2960))},setMask:function(co){Ti!==co&&!ri&&($e.stencilMask(co),Ti=co)},setFunc:function(co,go,vo){(Bi!==co||qi!==go||Ii!==vo)&&($e.stencilFunc(co,go,vo),Bi=co,qi=go,Ii=vo)},setOp:function(co,go,vo){(Ui!==co||ho!==go||lo!==vo)&&($e.stencilOp(co,go,vo),Ui=co,ho=go,lo=vo)},setLocked:function(co){ri=co},setClear:function(co){po!==co&&($e.clearStencil(co),po=co)},reset:function(){ri=!1,Ti=null,Bi=null,qi=null,Ii=null,Ui=null,ho=null,lo=null,po=null}}}var Xe=new Ve,Ke=new Fe,Ye=new Je,or=$e.getParameter(34921),sr=new Uint8Array(or),cr=new Uint8Array(or),Br=new Uint8Array(or),tn={},en=null,an=null,rn=null,on=null,sn=null,ln=null,cn=null,hn=null,mn=null,An=!1,xn=null,pn=null,dn=null,fn=null,yn=null,Sn=$e.getParameter(35661),gn=!1,Cn=0,Mn=$e.getParameter(7938);Mn.indexOf("WebGL")!==-1?(Cn=parseFloat(/^WebGL\ ([0-9])/.exec(Mn)[1]),gn=Cn>=1):Mn.indexOf("OpenGL ES")!==-1&&(Cn=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Mn)[1]),gn=Cn>=2);var Bn=null,kn={},Ln=new Vector4,Pn=new Vector4;function Vn(ri,Ti,Bi){var qi=new Uint8Array(4),Ii=$e.createTexture();$e.bindTexture(ri,Ii),$e.texParameteri(ri,10241,9728),$e.texParameteri(ri,10240,9728);for(var Ui=0;Ui<Bi;Ui++)$e.texImage2D(Ti+Ui,0,6408,1,1,0,6408,5121,qi);return Ii}var Yn={};Yn[3553]=Vn(3553,3553,1),Yn[34067]=Vn(34067,34069,6),Xe.setClear(0,0,0,1),Ke.setClear(1),Ye.setClear(0),Hn(2929),Ke.setFunc(LessEqualDepth),Un(!1),Wn(CullFaceBack),Hn(2884),ei(NoBlending);function ni(){for(var ri=0,Ti=sr.length;ri<Ti;ri++)sr[ri]=0}function Rn(ri){In(ri,0)}function In(ri,Ti){if(sr[ri]=1,cr[ri]===0&&($e.enableVertexAttribArray(ri),cr[ri]=1),Br[ri]!==Ti){var Bi=De?$e:Se.get("ANGLE_instanced_arrays");Bi[De?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ri,Ti),Br[ri]=Ti}}function Gn(){for(var ri=0,Ti=cr.length;ri!==Ti;++ri)cr[ri]!==sr[ri]&&($e.disableVertexAttribArray(ri),cr[ri]=0)}function Fn(ri,Ti,Bi,qi,Ii,Ui){De===!0&&(Bi===5124||Bi===5125)?$e.vertexAttribIPointer(ri,Ti,Bi,qi,Ii,Ui):$e.vertexAttribPointer(ri,Ti,Bi,qi,Ii,Ui)}function Hn(ri){tn[ri]!==!0&&($e.enable(ri),tn[ri]=!0)}function Dn(ri){tn[ri]!==!1&&($e.disable(ri),tn[ri]=!1)}function zn(ri){return en!==ri?($e.useProgram(ri),en=ri,!0):!1}var Qn={[AddEquation]:32774,[SubtractEquation]:32778,[ReverseSubtractEquation]:32779};if(De)Qn[MinEquation]=32775,Qn[MaxEquation]=32776;else{var Zn=Se.get("EXT_blend_minmax");Zn!==null&&(Qn[MinEquation]=Zn.MIN_EXT,Qn[MaxEquation]=Zn.MAX_EXT)}var si={[ZeroFactor]:0,[OneFactor]:1,[SrcColorFactor]:768,[SrcAlphaFactor]:770,[SrcAlphaSaturateFactor]:776,[DstColorFactor]:774,[DstAlphaFactor]:772,[OneMinusSrcColorFactor]:769,[OneMinusSrcAlphaFactor]:771,[OneMinusDstColorFactor]:775,[OneMinusDstAlphaFactor]:773};function ei(ri,Ti,Bi,qi,Ii,Ui,ho,lo){if(ri===NoBlending){an&&(Dn(3042),an=!1);return}if(an||(Hn(3042),an=!0),ri!==CustomBlending){if(ri!==rn||lo!==An){if((on!==AddEquation||cn!==AddEquation)&&($e.blendEquation(32774),on=AddEquation,cn=AddEquation),lo)switch(ri){case NormalBlending:$e.blendFuncSeparate(1,771,1,771);break;case AdditiveBlending:$e.blendFunc(1,1);break;case SubtractiveBlending:$e.blendFuncSeparate(0,0,769,771);break;case MultiplyBlending:$e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ri);break}else switch(ri){case NormalBlending:$e.blendFuncSeparate(770,771,1,771);break;case AdditiveBlending:$e.blendFunc(770,1);break;case SubtractiveBlending:$e.blendFunc(0,769);break;case MultiplyBlending:$e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ri);break}sn=null,ln=null,hn=null,mn=null,rn=ri,An=lo}return}Ii=Ii||Ti,Ui=Ui||Bi,ho=ho||qi,(Ti!==on||Ii!==cn)&&($e.blendEquationSeparate(Qn[Ti],Qn[Ii]),on=Ti,cn=Ii),(Bi!==sn||qi!==ln||Ui!==hn||ho!==mn)&&($e.blendFuncSeparate(si[Bi],si[qi],si[Ui],si[ho]),sn=Bi,ln=qi,hn=Ui,mn=ho),rn=ri,An=null}function hi(ri,Ti){ri.side===DoubleSide?Dn(2884):Hn(2884);var Bi=ri.side===BackSide;Ti&&(Bi=!Bi),Un(Bi),ri.blending===NormalBlending&&ri.transparent===!1?ei(NoBlending):ei(ri.blending,ri.blendEquation,ri.blendSrc,ri.blendDst,ri.blendEquationAlpha,ri.blendSrcAlpha,ri.blendDstAlpha,ri.premultipliedAlpha),Ke.setFunc(ri.depthFunc),Ke.setTest(ri.depthTest),Ke.setMask(ri.depthWrite),Xe.setMask(ri.colorWrite);var qi=ri.stencilWrite;Ye.setTest(qi),qi&&(Ye.setMask(ri.stencilWriteMask),Ye.setFunc(ri.stencilFunc,ri.stencilRef,ri.stencilFuncMask),Ye.setOp(ri.stencilFail,ri.stencilZFail,ri.stencilZPass)),oi(ri.polygonOffset,ri.polygonOffsetFactor,ri.polygonOffsetUnits)}function Un(ri){xn!==ri&&(ri?$e.frontFace(2304):$e.frontFace(2305),xn=ri)}function Wn(ri){ri!==CullFaceNone?(Hn(2884),ri!==pn&&(ri===CullFaceBack?$e.cullFace(1029):ri===CullFaceFront?$e.cullFace(1028):$e.cullFace(1032))):Dn(2884),pn=ri}function Ai(ri){ri!==dn&&(gn&&$e.lineWidth(ri),dn=ri)}function oi(ri,Ti,Bi){ri?(Hn(32823),(fn!==Ti||yn!==Bi)&&($e.polygonOffset(Ti,Bi),fn=Ti,yn=Bi)):Dn(32823)}function ci(ri){ri?Hn(3089):Dn(3089)}function ai(ri){ri===void 0&&(ri=33984+Sn-1),Bn!==ri&&($e.activeTexture(ri),Bn=ri)}function wi(ri,Ti){Bn===null&&ai();var Bi=kn[Bn];Bi===void 0&&(Bi={type:void 0,texture:void 0},kn[Bn]=Bi),(Bi.type!==ri||Bi.texture!==Ti)&&($e.bindTexture(ri,Ti||Yn[ri]),Bi.type=ri,Bi.texture=Ti)}function Pi(){var ri=kn[Bn];ri!==void 0&&ri.type!==void 0&&($e.bindTexture(ri.type,null),ri.type=void 0,ri.texture=void 0)}function Oi(){try{$e.compressedTexImage2D.apply($e,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}}function Ri(){try{$e.texImage2D.apply($e,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}}function _i(){try{$e.texImage3D.apply($e,arguments)}catch(ri){console.error("THREE.WebGLState:",ri)}}function Mi(ri){Ln.equals(ri)===!1&&($e.scissor(ri.x,ri.y,ri.z,ri.w),Ln.copy(ri))}function $i(ri){Pn.equals(ri)===!1&&($e.viewport(ri.x,ri.y,ri.z,ri.w),Pn.copy(ri))}function vi(){for(var ri=0;ri<cr.length;ri++)cr[ri]===1&&($e.disableVertexAttribArray(ri),cr[ri]=0);tn={},Bn=null,kn={},en=null,rn=null,xn=null,pn=null,Xe.reset(),Ke.reset(),Ye.reset()}return{buffers:{color:Xe,depth:Ke,stencil:Ye},initAttributes:ni,enableAttribute:Rn,enableAttributeAndDivisor:In,disableUnusedAttributes:Gn,vertexAttribPointer:Fn,enable:Hn,disable:Dn,useProgram:zn,setBlending:ei,setMaterial:hi,setFlipSided:Un,setCullFace:Wn,setLineWidth:Ai,setPolygonOffset:oi,setScissorTest:ci,activeTexture:ai,bindTexture:wi,unbindTexture:Pi,compressedTexImage2D:Oi,texImage2D:Ri,texImage3D:_i,scissor:Mi,viewport:$i,reset:vi}}function WebGLTextures($e,Se,Be,De,Ve,Fe,Je){var Xe=Ve.isWebGL2,Ke=Ve.maxTextures,Ye=Ve.maxCubemapSize,or=Ve.maxTextureSize,sr=Ve.maxSamples,cr=new WeakMap,Br,tn=!1;try{tn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function en(Un,Wn){return tn?new OffscreenCanvas(Un,Wn):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function an(Un,Wn,Ai,oi){var ci=1;if((Un.width>oi||Un.height>oi)&&(ci=oi/Math.max(Un.width,Un.height)),ci<1||Wn===!0)if(typeof HTMLImageElement<"u"&&Un instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Un instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Un instanceof ImageBitmap){var ai=Wn?MathUtils.floorPowerOfTwo:Math.floor,wi=ai(ci*Un.width),Pi=ai(ci*Un.height);Br===void 0&&(Br=en(wi,Pi));var Oi=Ai?en(wi,Pi):Br;Oi.width=wi,Oi.height=Pi;var Ri=Oi.getContext("2d");return Ri.drawImage(Un,0,0,wi,Pi),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Un.width+"x"+Un.height+") to ("+wi+"x"+Pi+")."),Oi}else return"data"in Un&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Un.width+"x"+Un.height+")."),Un;return Un}function rn(Un){return MathUtils.isPowerOfTwo(Un.width)&&MathUtils.isPowerOfTwo(Un.height)}function on(Un){return Xe?!1:Un.wrapS!==ClampToEdgeWrapping||Un.wrapT!==ClampToEdgeWrapping||Un.minFilter!==NearestFilter&&Un.minFilter!==LinearFilter}function sn(Un,Wn){return Un.generateMipmaps&&Wn&&Un.minFilter!==NearestFilter&&Un.minFilter!==LinearFilter}function ln(Un,Wn,Ai,oi){$e.generateMipmap(Un);var ci=De.get(Wn);ci.__maxMipLevel=Math.log(Math.max(Ai,oi))*Math.LOG2E}function cn(Un,Wn,Ai){if(Xe===!1)return Wn;if(Un!==null){if($e[Un]!==void 0)return $e[Un];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Un+"'")}var oi=Wn;return Wn===6403&&(Ai===5126&&(oi=33326),Ai===5131&&(oi=33325),Ai===5121&&(oi=33321)),Wn===6407&&(Ai===5126&&(oi=34837),Ai===5131&&(oi=34843),Ai===5121&&(oi=32849)),Wn===6408&&(Ai===5126&&(oi=34836),Ai===5131&&(oi=34842),Ai===5121&&(oi=32856)),(oi===33325||oi===33326||oi===34842||oi===34836)&&Se.get("EXT_color_buffer_float"),oi}function hn(Un){return Un===NearestFilter||Un===NearestMipmapNearestFilter||Un===NearestMipmapLinearFilter?9728:9729}function mn(Un){var Wn=Un.target;Wn.removeEventListener("dispose",mn),xn(Wn),Wn.isVideoTexture&&cr.delete(Wn),Je.memory.textures--}function An(Un){var Wn=Un.target;Wn.removeEventListener("dispose",An),pn(Wn),Je.memory.textures--}function xn(Un){var Wn=De.get(Un);Wn.__webglInit!==void 0&&($e.deleteTexture(Wn.__webglTexture),De.remove(Un))}function pn(Un){var Wn=De.get(Un),Ai=De.get(Un.texture);if(Un){if(Ai.__webglTexture!==void 0&&$e.deleteTexture(Ai.__webglTexture),Un.depthTexture&&Un.depthTexture.dispose(),Un.isWebGLCubeRenderTarget)for(var oi=0;oi<6;oi++)$e.deleteFramebuffer(Wn.__webglFramebuffer[oi]),Wn.__webglDepthbuffer&&$e.deleteRenderbuffer(Wn.__webglDepthbuffer[oi]);else $e.deleteFramebuffer(Wn.__webglFramebuffer),Wn.__webglDepthbuffer&&$e.deleteRenderbuffer(Wn.__webglDepthbuffer),Wn.__webglMultisampledFramebuffer&&$e.deleteFramebuffer(Wn.__webglMultisampledFramebuffer),Wn.__webglColorRenderbuffer&&$e.deleteRenderbuffer(Wn.__webglColorRenderbuffer),Wn.__webglDepthRenderbuffer&&$e.deleteRenderbuffer(Wn.__webglDepthRenderbuffer);De.remove(Un.texture),De.remove(Un)}}var dn=0;function fn(){dn=0}function yn(){var Un=dn;return Un>=Ke&&console.warn("THREE.WebGLTextures: Trying to use "+Un+" texture units while this GPU supports only "+Ke),dn+=1,Un}function Sn(Un,Wn){var Ai=De.get(Un);if(Un.isVideoTexture&&Qn(Un),Un.version>0&&Ai.__version!==Un.version){var oi=Un.image;if(oi===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(oi.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Yn(Ai,Un,Wn);return}}Be.activeTexture(33984+Wn),Be.bindTexture(3553,Ai.__webglTexture)}function gn(Un,Wn){var Ai=De.get(Un);if(Un.version>0&&Ai.__version!==Un.version){Yn(Ai,Un,Wn);return}Be.activeTexture(33984+Wn),Be.bindTexture(35866,Ai.__webglTexture)}function Cn(Un,Wn){var Ai=De.get(Un);if(Un.version>0&&Ai.__version!==Un.version){Yn(Ai,Un,Wn);return}Be.activeTexture(33984+Wn),Be.bindTexture(32879,Ai.__webglTexture)}function Mn(Un,Wn){if(Un.image.length===6){var Ai=De.get(Un);if(Un.version>0&&Ai.__version!==Un.version){Vn(Ai,Un),Be.activeTexture(33984+Wn),Be.bindTexture(34067,Ai.__webglTexture),$e.pixelStorei(37440,Un.flipY);for(var oi=Un&&(Un.isCompressedTexture||Un.image[0].isCompressedTexture),ci=Un.image[0]&&Un.image[0].isDataTexture,ai=[],wi=0;wi<6;wi++)!oi&&!ci?ai[wi]=an(Un.image[wi],!1,!0,Ye):ai[wi]=ci?Un.image[wi].image:Un.image[wi];var Pi=ai[0],Oi=rn(Pi)||Xe,Ri=Fe.convert(Un.format),_i=Fe.convert(Un.type),Mi=cn(Un.internalFormat,Ri,_i);Pn(34067,Un,Oi);var $i;if(oi){for(var wi=0;wi<6;wi++){$i=ai[wi].mipmaps;for(var vi=0;vi<$i.length;vi++){var ri=$i[vi];Un.format!==RGBAFormat&&Un.format!==RGBFormat?Ri!==null?Be.compressedTexImage2D(34069+wi,vi,Mi,ri.width,ri.height,0,ri.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Be.texImage2D(34069+wi,vi,Mi,ri.width,ri.height,0,Ri,_i,ri.data)}}Ai.__maxMipLevel=$i.length-1}else{$i=Un.mipmaps;for(var wi=0;wi<6;wi++)if(ci){Be.texImage2D(34069+wi,0,Mi,ai[wi].width,ai[wi].height,0,Ri,_i,ai[wi].data);for(var vi=0;vi<$i.length;vi++){var ri=$i[vi],Ti=ri.image[wi].image;Be.texImage2D(34069+wi,vi+1,Mi,Ti.width,Ti.height,0,Ri,_i,Ti.data)}}else{Be.texImage2D(34069+wi,0,Mi,Ri,_i,ai[wi]);for(var vi=0;vi<$i.length;vi++){var ri=$i[vi];Be.texImage2D(34069+wi,vi+1,Mi,Ri,_i,ri.image[wi])}}Ai.__maxMipLevel=$i.length}sn(Un,Oi)&&ln(34067,Un,Pi.width,Pi.height),Ai.__version=Un.version,Un.onUpdate&&Un.onUpdate(Un)}else Be.activeTexture(33984+Wn),Be.bindTexture(34067,Ai.__webglTexture)}}function Bn(Un,Wn){Be.activeTexture(33984+Wn),Be.bindTexture(34067,De.get(Un).__webglTexture)}var kn={[RepeatWrapping]:10497,[ClampToEdgeWrapping]:33071,[MirroredRepeatWrapping]:33648},Ln={[NearestFilter]:9728,[NearestMipmapNearestFilter]:9984,[NearestMipmapLinearFilter]:9986,[LinearFilter]:9729,[LinearMipmapNearestFilter]:9985,[LinearMipmapLinearFilter]:9987};function Pn(Un,Wn,Ai){Ai?($e.texParameteri(Un,10242,kn[Wn.wrapS]),$e.texParameteri(Un,10243,kn[Wn.wrapT]),(Un===32879||Un===35866)&&$e.texParameteri(Un,32882,kn[Wn.wrapR]),$e.texParameteri(Un,10240,Ln[Wn.magFilter]),$e.texParameteri(Un,10241,Ln[Wn.minFilter])):($e.texParameteri(Un,10242,33071),$e.texParameteri(Un,10243,33071),(Un===32879||Un===35866)&&$e.texParameteri(Un,32882,33071),(Wn.wrapS!==ClampToEdgeWrapping||Wn.wrapT!==ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),$e.texParameteri(Un,10240,hn(Wn.magFilter)),$e.texParameteri(Un,10241,hn(Wn.minFilter)),Wn.minFilter!==NearestFilter&&Wn.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var oi=Se.get("EXT_texture_filter_anisotropic");if(oi){if(Wn.type===FloatType&&Se.get("OES_texture_float_linear")===null||Wn.type===HalfFloatType&&(Xe||Se.get("OES_texture_half_float_linear"))===null)return;(Wn.anisotropy>1||De.get(Wn).__currentAnisotropy)&&($e.texParameterf(Un,oi.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Wn.anisotropy,Ve.getMaxAnisotropy())),De.get(Wn).__currentAnisotropy=Wn.anisotropy)}}function Vn(Un,Wn){Un.__webglInit===void 0&&(Un.__webglInit=!0,Wn.addEventListener("dispose",mn),Un.__webglTexture=$e.createTexture(),Je.memory.textures++)}function Yn(Un,Wn,Ai){var oi=3553;Wn.isDataTexture2DArray&&(oi=35866),Wn.isDataTexture3D&&(oi=32879),Vn(Un,Wn),Be.activeTexture(33984+Ai),Be.bindTexture(oi,Un.__webglTexture),$e.pixelStorei(37440,Wn.flipY),$e.pixelStorei(37441,Wn.premultiplyAlpha),$e.pixelStorei(3317,Wn.unpackAlignment);var ci=on(Wn)&&rn(Wn.image)===!1,ai=an(Wn.image,ci,!1,or),wi=rn(ai)||Xe,Pi=Fe.convert(Wn.format),Oi=Fe.convert(Wn.type),Ri=cn(Wn.internalFormat,Pi,Oi);Pn(oi,Wn,wi);var _i,Mi=Wn.mipmaps;if(Wn.isDepthTexture)Ri=6402,Xe?Wn.type===FloatType?Ri=36012:Wn.type===UnsignedIntType?Ri=33190:Wn.type===UnsignedInt248Type?Ri=35056:Ri=33189:Wn.type===FloatType&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Wn.format===DepthFormat&&Ri===6402&&Wn.type!==UnsignedShortType&&Wn.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Wn.type=UnsignedShortType,Oi=Fe.convert(Wn.type)),Wn.format===DepthStencilFormat&&Ri===6402&&(Ri=34041,Wn.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Wn.type=UnsignedInt248Type,Oi=Fe.convert(Wn.type))),Be.texImage2D(3553,0,Ri,ai.width,ai.height,0,Pi,Oi,null);else if(Wn.isDataTexture)if(Mi.length>0&&wi){for(var $i=0,vi=Mi.length;$i<vi;$i++)_i=Mi[$i],Be.texImage2D(3553,$i,Ri,_i.width,_i.height,0,Pi,Oi,_i.data);Wn.generateMipmaps=!1,Un.__maxMipLevel=Mi.length-1}else Be.texImage2D(3553,0,Ri,ai.width,ai.height,0,Pi,Oi,ai.data),Un.__maxMipLevel=0;else if(Wn.isCompressedTexture){for(var $i=0,vi=Mi.length;$i<vi;$i++)_i=Mi[$i],Wn.format!==RGBAFormat&&Wn.format!==RGBFormat?Pi!==null?Be.compressedTexImage2D(3553,$i,Ri,_i.width,_i.height,0,_i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Be.texImage2D(3553,$i,Ri,_i.width,_i.height,0,Pi,Oi,_i.data);Un.__maxMipLevel=Mi.length-1}else if(Wn.isDataTexture2DArray)Be.texImage3D(35866,0,Ri,ai.width,ai.height,ai.depth,0,Pi,Oi,ai.data),Un.__maxMipLevel=0;else if(Wn.isDataTexture3D)Be.texImage3D(32879,0,Ri,ai.width,ai.height,ai.depth,0,Pi,Oi,ai.data),Un.__maxMipLevel=0;else if(Mi.length>0&&wi){for(var $i=0,vi=Mi.length;$i<vi;$i++)_i=Mi[$i],Be.texImage2D(3553,$i,Ri,Pi,Oi,_i);Wn.generateMipmaps=!1,Un.__maxMipLevel=Mi.length-1}else Be.texImage2D(3553,0,Ri,Pi,Oi,ai),Un.__maxMipLevel=0;sn(Wn,wi)&&ln(oi,Wn,ai.width,ai.height),Un.__version=Wn.version,Wn.onUpdate&&Wn.onUpdate(Wn)}function ni(Un,Wn,Ai,oi){var ci=Fe.convert(Wn.texture.format),ai=Fe.convert(Wn.texture.type),wi=cn(Wn.texture.internalFormat,ci,ai);Be.texImage2D(oi,0,wi,Wn.width,Wn.height,0,ci,ai,null),$e.bindFramebuffer(36160,Un),$e.framebufferTexture2D(36160,Ai,oi,De.get(Wn.texture).__webglTexture,0),$e.bindFramebuffer(36160,null)}function Rn(Un,Wn,Ai){if($e.bindRenderbuffer(36161,Un),Wn.depthBuffer&&!Wn.stencilBuffer){var oi=33189;if(Ai){var ci=Wn.depthTexture;ci&&ci.isDepthTexture&&(ci.type===FloatType?oi=36012:ci.type===UnsignedIntType&&(oi=33190));var ai=zn(Wn);$e.renderbufferStorageMultisample(36161,ai,oi,Wn.width,Wn.height)}else $e.renderbufferStorage(36161,oi,Wn.width,Wn.height);$e.framebufferRenderbuffer(36160,36096,36161,Un)}else if(Wn.depthBuffer&&Wn.stencilBuffer){if(Ai){var ai=zn(Wn);$e.renderbufferStorageMultisample(36161,ai,35056,Wn.width,Wn.height)}else $e.renderbufferStorage(36161,34041,Wn.width,Wn.height);$e.framebufferRenderbuffer(36160,33306,36161,Un)}else{var wi=Fe.convert(Wn.texture.format),Pi=Fe.convert(Wn.texture.type),oi=cn(Wn.texture.internalFormat,wi,Pi);if(Ai){var ai=zn(Wn);$e.renderbufferStorageMultisample(36161,ai,oi,Wn.width,Wn.height)}else $e.renderbufferStorage(36161,oi,Wn.width,Wn.height)}$e.bindRenderbuffer(36161,null)}function In(Un,Wn){var Ai=Wn&&Wn.isWebGLCubeRenderTarget;if(Ai)throw new Error("Depth Texture with cube render targets is not supported");if($e.bindFramebuffer(36160,Un),!(Wn.depthTexture&&Wn.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!De.get(Wn.depthTexture).__webglTexture||Wn.depthTexture.image.width!==Wn.width||Wn.depthTexture.image.height!==Wn.height)&&(Wn.depthTexture.image.width=Wn.width,Wn.depthTexture.image.height=Wn.height,Wn.depthTexture.needsUpdate=!0),Sn(Wn.depthTexture,0);var oi=De.get(Wn.depthTexture).__webglTexture;if(Wn.depthTexture.format===DepthFormat)$e.framebufferTexture2D(36160,36096,3553,oi,0);else if(Wn.depthTexture.format===DepthStencilFormat)$e.framebufferTexture2D(36160,33306,3553,oi,0);else throw new Error("Unknown depthTexture format")}function Gn(Un){var Wn=De.get(Un),Ai=Un.isWebGLCubeRenderTarget===!0;if(Un.depthTexture){if(Ai)throw new Error("target.depthTexture not supported in Cube render targets");In(Wn.__webglFramebuffer,Un)}else if(Ai){Wn.__webglDepthbuffer=[];for(var oi=0;oi<6;oi++)$e.bindFramebuffer(36160,Wn.__webglFramebuffer[oi]),Wn.__webglDepthbuffer[oi]=$e.createRenderbuffer(),Rn(Wn.__webglDepthbuffer[oi],Un,!1)}else $e.bindFramebuffer(36160,Wn.__webglFramebuffer),Wn.__webglDepthbuffer=$e.createRenderbuffer(),Rn(Wn.__webglDepthbuffer,Un,!1);$e.bindFramebuffer(36160,null)}function Fn(Un){var Wn=De.get(Un),Ai=De.get(Un.texture);Un.addEventListener("dispose",An),Ai.__webglTexture=$e.createTexture(),Je.memory.textures++;var oi=Un.isWebGLCubeRenderTarget===!0,ci=Un.isWebGLMultisampleRenderTarget===!0,ai=rn(Un)||Xe;if(Xe&&Un.texture.format===RGBFormat&&(Un.texture.type===FloatType||Un.texture.type===HalfFloatType)&&(Un.texture.format=RGBAFormat,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),oi){Wn.__webglFramebuffer=[];for(var wi=0;wi<6;wi++)Wn.__webglFramebuffer[wi]=$e.createFramebuffer()}else if(Wn.__webglFramebuffer=$e.createFramebuffer(),ci)if(Xe){Wn.__webglMultisampledFramebuffer=$e.createFramebuffer(),Wn.__webglColorRenderbuffer=$e.createRenderbuffer(),$e.bindRenderbuffer(36161,Wn.__webglColorRenderbuffer);var Pi=Fe.convert(Un.texture.format),Oi=Fe.convert(Un.texture.type),Ri=cn(Un.texture.internalFormat,Pi,Oi),_i=zn(Un);$e.renderbufferStorageMultisample(36161,_i,Ri,Un.width,Un.height),$e.bindFramebuffer(36160,Wn.__webglMultisampledFramebuffer),$e.framebufferRenderbuffer(36160,36064,36161,Wn.__webglColorRenderbuffer),$e.bindRenderbuffer(36161,null),Un.depthBuffer&&(Wn.__webglDepthRenderbuffer=$e.createRenderbuffer(),Rn(Wn.__webglDepthRenderbuffer,Un,!0)),$e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(oi){Be.bindTexture(34067,Ai.__webglTexture),Pn(34067,Un.texture,ai);for(var wi=0;wi<6;wi++)ni(Wn.__webglFramebuffer[wi],Un,36064,34069+wi);sn(Un.texture,ai)&&ln(34067,Un.texture,Un.width,Un.height),Be.bindTexture(34067,null)}else Be.bindTexture(3553,Ai.__webglTexture),Pn(3553,Un.texture,ai),ni(Wn.__webglFramebuffer,Un,36064,3553),sn(Un.texture,ai)&&ln(3553,Un.texture,Un.width,Un.height),Be.bindTexture(3553,null);Un.depthBuffer&&Gn(Un)}function Hn(Un){var Wn=Un.texture,Ai=rn(Un)||Xe;if(sn(Wn,Ai)){var oi=Un.isWebGLCubeRenderTarget?34067:3553,ci=De.get(Wn).__webglTexture;Be.bindTexture(oi,ci),ln(oi,Wn,Un.width,Un.height),Be.bindTexture(oi,null)}}function Dn(Un){if(Un.isWebGLMultisampleRenderTarget)if(Xe){var Wn=De.get(Un);$e.bindFramebuffer(36008,Wn.__webglMultisampledFramebuffer),$e.bindFramebuffer(36009,Wn.__webglFramebuffer);var Ai=Un.width,oi=Un.height,ci=16384;Un.depthBuffer&&(ci|=256),Un.stencilBuffer&&(ci|=1024),$e.blitFramebuffer(0,0,Ai,oi,0,0,Ai,oi,ci,9728),$e.bindFramebuffer(36160,Wn.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function zn(Un){return Xe&&Un.isWebGLMultisampleRenderTarget?Math.min(sr,Un.samples):0}function Qn(Un){var Wn=Je.render.frame;cr.get(Un)!==Wn&&(cr.set(Un,Wn),Un.update())}var Zn=!1,si=!1;function ei(Un,Wn){Un&&Un.isWebGLRenderTarget&&(Zn===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Zn=!0),Un=Un.texture),Sn(Un,Wn)}function hi(Un,Wn){Un&&Un.isWebGLCubeRenderTarget&&(si===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),si=!0),Un=Un.texture),Un&&Un.isCubeTexture||Array.isArray(Un.image)&&Un.image.length===6?Mn(Un,Wn):Bn(Un,Wn)}this.allocateTextureUnit=yn,this.resetTextureUnits=fn,this.setTexture2D=Sn,this.setTexture2DArray=gn,this.setTexture3D=Cn,this.setTextureCube=Mn,this.setTextureCubeDynamic=Bn,this.setupRenderTarget=Fn,this.updateRenderTargetMipmap=Hn,this.updateMultisampleRenderTarget=Dn,this.safeSetTexture2D=ei,this.safeSetTextureCube=hi}function WebGLUtils($e,Se,Be){var De=Be.isWebGL2;function Ve(Fe){var Je;if(Fe===UnsignedByteType)return 5121;if(Fe===UnsignedShort4444Type)return 32819;if(Fe===UnsignedShort5551Type)return 32820;if(Fe===UnsignedShort565Type)return 33635;if(Fe===ByteType)return 5120;if(Fe===ShortType)return 5122;if(Fe===UnsignedShortType)return 5123;if(Fe===IntType)return 5124;if(Fe===UnsignedIntType)return 5125;if(Fe===FloatType)return 5126;if(Fe===HalfFloatType)return De?5131:(Je=Se.get("OES_texture_half_float"),Je!==null?Je.HALF_FLOAT_OES:null);if(Fe===AlphaFormat)return 6406;if(Fe===RGBFormat)return 6407;if(Fe===RGBAFormat)return 6408;if(Fe===LuminanceFormat)return 6409;if(Fe===LuminanceAlphaFormat)return 6410;if(Fe===DepthFormat)return 6402;if(Fe===DepthStencilFormat)return 34041;if(Fe===RedFormat)return 6403;if(Fe===RedIntegerFormat)return 36244;if(Fe===RGFormat)return 33319;if(Fe===RGIntegerFormat)return 33320;if(Fe===RGBIntegerFormat)return 36248;if(Fe===RGBAIntegerFormat)return 36249;if(Fe===RGB_S3TC_DXT1_Format||Fe===RGBA_S3TC_DXT1_Format||Fe===RGBA_S3TC_DXT3_Format||Fe===RGBA_S3TC_DXT5_Format)if(Je=Se.get("WEBGL_compressed_texture_s3tc"),Je!==null){if(Fe===RGB_S3TC_DXT1_Format)return Je.COMPRESSED_RGB_S3TC_DXT1_EXT;if(Fe===RGBA_S3TC_DXT1_Format)return Je.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(Fe===RGBA_S3TC_DXT3_Format)return Je.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(Fe===RGBA_S3TC_DXT5_Format)return Je.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(Fe===RGB_PVRTC_4BPPV1_Format||Fe===RGB_PVRTC_2BPPV1_Format||Fe===RGBA_PVRTC_4BPPV1_Format||Fe===RGBA_PVRTC_2BPPV1_Format)if(Je=Se.get("WEBGL_compressed_texture_pvrtc"),Je!==null){if(Fe===RGB_PVRTC_4BPPV1_Format)return Je.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(Fe===RGB_PVRTC_2BPPV1_Format)return Je.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(Fe===RGBA_PVRTC_4BPPV1_Format)return Je.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(Fe===RGBA_PVRTC_2BPPV1_Format)return Je.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(Fe===RGB_ETC1_Format)return Je=Se.get("WEBGL_compressed_texture_etc1"),Je!==null?Je.COMPRESSED_RGB_ETC1_WEBGL:null;if((Fe===RGB_ETC2_Format||Fe===RGBA_ETC2_EAC_Format)&&(Je=Se.get("WEBGL_compressed_texture_etc"),Je!==null)){if(Fe===RGB_ETC2_Format)return Je.COMPRESSED_RGB8_ETC2;if(Fe===RGBA_ETC2_EAC_Format)return Je.COMPRESSED_RGBA8_ETC2_EAC}if(Fe===RGBA_ASTC_4x4_Format||Fe===RGBA_ASTC_5x4_Format||Fe===RGBA_ASTC_5x5_Format||Fe===RGBA_ASTC_6x5_Format||Fe===RGBA_ASTC_6x6_Format||Fe===RGBA_ASTC_8x5_Format||Fe===RGBA_ASTC_8x6_Format||Fe===RGBA_ASTC_8x8_Format||Fe===RGBA_ASTC_10x5_Format||Fe===RGBA_ASTC_10x6_Format||Fe===RGBA_ASTC_10x8_Format||Fe===RGBA_ASTC_10x10_Format||Fe===RGBA_ASTC_12x10_Format||Fe===RGBA_ASTC_12x12_Format||Fe===SRGB8_ALPHA8_ASTC_4x4_Format||Fe===SRGB8_ALPHA8_ASTC_5x4_Format||Fe===SRGB8_ALPHA8_ASTC_5x5_Format||Fe===SRGB8_ALPHA8_ASTC_6x5_Format||Fe===SRGB8_ALPHA8_ASTC_6x6_Format||Fe===SRGB8_ALPHA8_ASTC_8x5_Format||Fe===SRGB8_ALPHA8_ASTC_8x6_Format||Fe===SRGB8_ALPHA8_ASTC_8x8_Format||Fe===SRGB8_ALPHA8_ASTC_10x5_Format||Fe===SRGB8_ALPHA8_ASTC_10x6_Format||Fe===SRGB8_ALPHA8_ASTC_10x8_Format||Fe===SRGB8_ALPHA8_ASTC_10x10_Format||Fe===SRGB8_ALPHA8_ASTC_12x10_Format||Fe===SRGB8_ALPHA8_ASTC_12x12_Format)return Je=Se.get("WEBGL_compressed_texture_astc"),Je!==null?Fe:null;if(Fe===RGBA_BPTC_Format)return Je=Se.get("EXT_texture_compression_bptc"),Je!==null?Fe:null;if(Fe===UnsignedInt248Type)return De?34042:(Je=Se.get("WEBGL_depth_texture"),Je!==null?Je.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:Ve}}function ArrayCamera($e){PerspectiveCamera.call(this),this.cameras=$e||[]}ArrayCamera.prototype=Object.assign(Object.create(PerspectiveCamera.prototype),{constructor:ArrayCamera,isArrayCamera:!0});function Group$1(){Object3D.call(this),this.type="Group"}Group$1.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Group$1,isGroup:!0});function WebXRController(){this._targetRay=null,this._grip=null}Object.assign(WebXRController.prototype,{constructor:WebXRController,getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Group$1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Group$1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function($e){return this._targetRay!==null&&this._targetRay.dispatchEvent($e),this._grip!==null&&this._grip.dispatchEvent($e),this},disconnect:function($e){return this.dispatchEvent({type:"disconnected",data:$e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this},update:function($e,Se,Be){var De=null,Ve=null,Fe=this._targetRay,Je=this._grip;return $e&&(Fe!==null&&(De=Se.getPose($e.targetRaySpace,Be),De!==null&&(Fe.matrix.fromArray(De.transform.matrix),Fe.matrix.decompose(Fe.position,Fe.rotation,Fe.scale))),Je!==null&&$e.gripSpace&&(Ve=Se.getPose($e.gripSpace,Be),Ve!==null&&(Je.matrix.fromArray(Ve.transform.matrix),Je.matrix.decompose(Je.position,Je.rotation,Je.scale)))),Fe!==null&&(Fe.visible=De!==null),Je!==null&&(Je.visible=Ve!==null),this}});function WebXRManager($e,Se){var Be=this,De=null,Ve=1,Fe=null,Je="local-floor",Xe=null,Ke=[],Ye=new Map,or=new PerspectiveCamera;or.layers.enable(1),or.viewport=new Vector4;var sr=new PerspectiveCamera;sr.layers.enable(2),sr.viewport=new Vector4;var cr=[or,sr],Br=new ArrayCamera;Br.layers.enable(1),Br.layers.enable(2);var tn=null,en=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(dn){var fn=Ke[dn];return fn===void 0&&(fn=new WebXRController,Ke[dn]=fn),fn.getTargetRaySpace()},this.getControllerGrip=function(dn){var fn=Ke[dn];return fn===void 0&&(fn=new WebXRController,Ke[dn]=fn),fn.getGripSpace()};function an(dn){var fn=Ye.get(dn.inputSource);fn&&fn.dispatchEvent({type:dn.type})}function rn(){Ye.forEach(function(dn,fn){dn.disconnect(fn)}),Ye.clear(),$e.setFramebuffer(null),$e.setRenderTarget($e.getRenderTarget()),pn.stop(),Be.isPresenting=!1,Be.dispatchEvent({type:"sessionend"})}function on(dn){Fe=dn,pn.setContext(De),pn.start(),Be.isPresenting=!0,Be.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(dn){Ve=dn,Be.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(dn){Je=dn,Be.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return Fe},this.getSession=function(){return De},this.setSession=function(dn){if(De=dn,De!==null){De.addEventListener("select",an),De.addEventListener("selectstart",an),De.addEventListener("selectend",an),De.addEventListener("squeeze",an),De.addEventListener("squeezestart",an),De.addEventListener("squeezeend",an),De.addEventListener("end",rn);var fn=Se.getContextAttributes();fn.xrCompatible!==!0&&Se.makeXRCompatible();var yn={antialias:fn.antialias,alpha:fn.alpha,depth:fn.depth,stencil:fn.stencil,framebufferScaleFactor:Ve},Sn=new XRWebGLLayer(De,Se,yn);De.updateRenderState({baseLayer:Sn}),De.requestReferenceSpace(Je).then(on),De.addEventListener("inputsourceschange",sn)}};function sn(dn){for(var fn=De.inputSources,yn=0;yn<Ke.length;yn++)Ye.set(fn[yn],Ke[yn]);for(var yn=0;yn<dn.removed.length;yn++){var Sn=dn.removed[yn],gn=Ye.get(Sn);gn&&(gn.dispatchEvent({type:"disconnected",data:Sn}),Ye.delete(Sn))}for(var yn=0;yn<dn.added.length;yn++){var Sn=dn.added[yn],gn=Ye.get(Sn);gn&&gn.dispatchEvent({type:"connected",data:Sn})}}var ln=new Vector3,cn=new Vector3;function hn(dn,fn,yn){ln.setFromMatrixPosition(fn.matrixWorld),cn.setFromMatrixPosition(yn.matrixWorld);var Sn=ln.distanceTo(cn),gn=fn.projectionMatrix.elements,Cn=yn.projectionMatrix.elements,Mn=gn[14]/(gn[10]-1),Bn=gn[14]/(gn[10]+1),kn=(gn[9]+1)/gn[5],Ln=(gn[9]-1)/gn[5],Pn=(gn[8]-1)/gn[0],Vn=(Cn[8]+1)/Cn[0],Yn=Mn*Pn,ni=Mn*Vn,Rn=Sn/(-Pn+Vn),In=Rn*-Pn;fn.matrixWorld.decompose(dn.position,dn.quaternion,dn.scale),dn.translateX(In),dn.translateZ(Rn),dn.matrixWorld.compose(dn.position,dn.quaternion,dn.scale),dn.matrixWorldInverse.getInverse(dn.matrixWorld);var Gn=Mn+Rn,Fn=Bn+Rn,Hn=Yn-In,Dn=ni+(Sn-In),zn=kn*Bn/Fn*Gn,Qn=Ln*Bn/Fn*Gn;dn.projectionMatrix.makePerspective(Hn,Dn,zn,Qn,Gn,Fn)}function mn(dn,fn){fn===null?dn.matrixWorld.copy(dn.matrix):dn.matrixWorld.multiplyMatrices(fn.matrixWorld,dn.matrix),dn.matrixWorldInverse.getInverse(dn.matrixWorld)}this.getCamera=function(dn){Br.near=sr.near=or.near=dn.near,Br.far=sr.far=or.far=dn.far,(tn!==Br.near||en!==Br.far)&&(De.updateRenderState({depthNear:Br.near,depthFar:Br.far}),tn=Br.near,en=Br.far);var fn=dn.parent,yn=Br.cameras;mn(Br,fn);for(var Sn=0;Sn<yn.length;Sn++)mn(yn[Sn],fn);dn.matrixWorld.copy(Br.matrixWorld);for(var gn=dn.children,Sn=0,Cn=gn.length;Sn<Cn;Sn++)gn[Sn].updateMatrixWorld(!0);return yn.length===2?hn(Br,or,sr):Br.projectionMatrix.copy(or.projectionMatrix),Br};var An=null;function xn(dn,fn){if(Xe=fn.getViewerPose(Fe),Xe!==null){var yn=Xe.views,Sn=De.renderState.baseLayer;$e.setFramebuffer(Sn.framebuffer);var gn=!1;yn.length!==Br.cameras.length&&(Br.cameras.length=0,gn=!0);for(var Cn=0;Cn<yn.length;Cn++){var Mn=yn[Cn],Bn=Sn.getViewport(Mn),kn=cr[Cn];kn.matrix.fromArray(Mn.transform.matrix),kn.projectionMatrix.fromArray(Mn.projectionMatrix),kn.viewport.set(Bn.x,Bn.y,Bn.width,Bn.height),Cn===0&&Br.matrix.copy(kn.matrix),gn===!0&&Br.cameras.push(kn)}}for(var Ln=De.inputSources,Cn=0;Cn<Ke.length;Cn++){var Pn=Ke[Cn],Vn=Ln[Cn];Pn.update(Vn,fn,Fe)}An&&An(dn,fn)}var pn=new WebGLAnimation;pn.setAnimationLoop(xn),this.setAnimationLoop=function(dn){An=dn},this.dispose=function(){}}Object.assign(WebXRManager.prototype,EventDispatcher.prototype);function WebGLMaterials($e){function Se(rn,on){rn.fogColor.value.copy(on.color),on.isFog?(rn.fogNear.value=on.near,rn.fogFar.value=on.far):on.isFogExp2&&(rn.fogDensity.value=on.density)}function Be(rn,on,sn,ln,cn){on.isMeshBasicMaterial?De(rn,on):on.isMeshLambertMaterial?(De(rn,on),Ke(rn,on)):on.isMeshToonMaterial?(De(rn,on),or(rn,on)):on.isMeshPhongMaterial?(De(rn,on),Ye(rn,on)):on.isMeshStandardMaterial?(De(rn,on,sn),on.isMeshPhysicalMaterial?cr(rn,on,sn):sr(rn,on,sn)):on.isMeshMatcapMaterial?(De(rn,on),Br(rn,on)):on.isMeshDepthMaterial?(De(rn,on),tn(rn,on)):on.isMeshDistanceMaterial?(De(rn,on),en(rn,on)):on.isMeshNormalMaterial?(De(rn,on),an(rn,on)):on.isLineBasicMaterial?(Ve(rn,on),on.isLineDashedMaterial&&Fe(rn,on)):on.isPointsMaterial?Je(rn,on,ln,cn):on.isSpriteMaterial?Xe(rn,on):on.isShadowMaterial?(rn.color.value.copy(on.color),rn.opacity.value=on.opacity):on.isShaderMaterial&&(on.uniformsNeedUpdate=!1)}function De(rn,on,sn){rn.opacity.value=on.opacity,on.color&&rn.diffuse.value.copy(on.color),on.emissive&&rn.emissive.value.copy(on.emissive).multiplyScalar(on.emissiveIntensity),on.map&&(rn.map.value=on.map),on.alphaMap&&(rn.alphaMap.value=on.alphaMap),on.specularMap&&(rn.specularMap.value=on.specularMap);var ln=on.envMap||sn;ln&&(rn.envMap.value=ln,rn.flipEnvMap.value=ln.isCubeTexture?-1:1,rn.reflectivity.value=on.reflectivity,rn.refractionRatio.value=on.refractionRatio,rn.maxMipLevel.value=$e.get(ln).__maxMipLevel),on.lightMap&&(rn.lightMap.value=on.lightMap,rn.lightMapIntensity.value=on.lightMapIntensity),on.aoMap&&(rn.aoMap.value=on.aoMap,rn.aoMapIntensity.value=on.aoMapIntensity);var cn;on.map?cn=on.map:on.specularMap?cn=on.specularMap:on.displacementMap?cn=on.displacementMap:on.normalMap?cn=on.normalMap:on.bumpMap?cn=on.bumpMap:on.roughnessMap?cn=on.roughnessMap:on.metalnessMap?cn=on.metalnessMap:on.alphaMap?cn=on.alphaMap:on.emissiveMap&&(cn=on.emissiveMap),cn!==void 0&&(cn.isWebGLRenderTarget&&(cn=cn.texture),cn.matrixAutoUpdate===!0&&cn.updateMatrix(),rn.uvTransform.value.copy(cn.matrix));var hn;on.aoMap?hn=on.aoMap:on.lightMap&&(hn=on.lightMap),hn!==void 0&&(hn.isWebGLRenderTarget&&(hn=hn.texture),hn.matrixAutoUpdate===!0&&hn.updateMatrix(),rn.uv2Transform.value.copy(hn.matrix))}function Ve(rn,on){rn.diffuse.value.copy(on.color),rn.opacity.value=on.opacity}function Fe(rn,on){rn.dashSize.value=on.dashSize,rn.totalSize.value=on.dashSize+on.gapSize,rn.scale.value=on.scale}function Je(rn,on,sn,ln){rn.diffuse.value.copy(on.color),rn.opacity.value=on.opacity,rn.size.value=on.size*sn,rn.scale.value=ln*.5,on.map&&(rn.map.value=on.map),on.alphaMap&&(rn.alphaMap.value=on.alphaMap);var cn;on.map?cn=on.map:on.alphaMap&&(cn=on.alphaMap),cn!==void 0&&(cn.matrixAutoUpdate===!0&&cn.updateMatrix(),rn.uvTransform.value.copy(cn.matrix))}function Xe(rn,on){rn.diffuse.value.copy(on.color),rn.opacity.value=on.opacity,rn.rotation.value=on.rotation,on.map&&(rn.map.value=on.map),on.alphaMap&&(rn.alphaMap.value=on.alphaMap);var sn;on.map?sn=on.map:on.alphaMap&&(sn=on.alphaMap),sn!==void 0&&(sn.matrixAutoUpdate===!0&&sn.updateMatrix(),rn.uvTransform.value.copy(sn.matrix))}function Ke(rn,on){on.emissiveMap&&(rn.emissiveMap.value=on.emissiveMap)}function Ye(rn,on){rn.specular.value.copy(on.specular),rn.shininess.value=Math.max(on.shininess,1e-4),on.emissiveMap&&(rn.emissiveMap.value=on.emissiveMap),on.bumpMap&&(rn.bumpMap.value=on.bumpMap,rn.bumpScale.value=on.bumpScale,on.side===BackSide&&(rn.bumpScale.value*=-1)),on.normalMap&&(rn.normalMap.value=on.normalMap,rn.normalScale.value.copy(on.normalScale),on.side===BackSide&&rn.normalScale.value.negate()),on.displacementMap&&(rn.displacementMap.value=on.displacementMap,rn.displacementScale.value=on.displacementScale,rn.displacementBias.value=on.displacementBias)}function or(rn,on){rn.specular.value.copy(on.specular),rn.shininess.value=Math.max(on.shininess,1e-4),on.gradientMap&&(rn.gradientMap.value=on.gradientMap),on.emissiveMap&&(rn.emissiveMap.value=on.emissiveMap),on.bumpMap&&(rn.bumpMap.value=on.bumpMap,rn.bumpScale.value=on.bumpScale,on.side===BackSide&&(rn.bumpScale.value*=-1)),on.normalMap&&(rn.normalMap.value=on.normalMap,rn.normalScale.value.copy(on.normalScale),on.side===BackSide&&rn.normalScale.value.negate()),on.displacementMap&&(rn.displacementMap.value=on.displacementMap,rn.displacementScale.value=on.displacementScale,rn.displacementBias.value=on.displacementBias)}function sr(rn,on,sn){rn.roughness.value=on.roughness,rn.metalness.value=on.metalness,on.roughnessMap&&(rn.roughnessMap.value=on.roughnessMap),on.metalnessMap&&(rn.metalnessMap.value=on.metalnessMap),on.emissiveMap&&(rn.emissiveMap.value=on.emissiveMap),on.bumpMap&&(rn.bumpMap.value=on.bumpMap,rn.bumpScale.value=on.bumpScale,on.side===BackSide&&(rn.bumpScale.value*=-1)),on.normalMap&&(rn.normalMap.value=on.normalMap,rn.normalScale.value.copy(on.normalScale),on.side===BackSide&&rn.normalScale.value.negate()),on.displacementMap&&(rn.displacementMap.value=on.displacementMap,rn.displacementScale.value=on.displacementScale,rn.displacementBias.value=on.displacementBias),(on.envMap||sn)&&(rn.envMapIntensity.value=on.envMapIntensity)}function cr(rn,on,sn){sr(rn,on,sn),rn.reflectivity.value=on.reflectivity,rn.clearcoat.value=on.clearcoat,rn.clearcoatRoughness.value=on.clearcoatRoughness,on.sheen&&rn.sheen.value.copy(on.sheen),on.clearcoatMap&&(rn.clearcoatMap.value=on.clearcoatMap),on.clearcoatRoughnessMap&&(rn.clearcoatRoughnessMap.value=on.clearcoatRoughnessMap),on.clearcoatNormalMap&&(rn.clearcoatNormalScale.value.copy(on.clearcoatNormalScale),rn.clearcoatNormalMap.value=on.clearcoatNormalMap,on.side===BackSide&&rn.clearcoatNormalScale.value.negate()),rn.transparency.value=on.transparency}function Br(rn,on){on.matcap&&(rn.matcap.value=on.matcap),on.bumpMap&&(rn.bumpMap.value=on.bumpMap,rn.bumpScale.value=on.bumpScale,on.side===BackSide&&(rn.bumpScale.value*=-1)),on.normalMap&&(rn.normalMap.value=on.normalMap,rn.normalScale.value.copy(on.normalScale),on.side===BackSide&&rn.normalScale.value.negate()),on.displacementMap&&(rn.displacementMap.value=on.displacementMap,rn.displacementScale.value=on.displacementScale,rn.displacementBias.value=on.displacementBias)}function tn(rn,on){on.displacementMap&&(rn.displacementMap.value=on.displacementMap,rn.displacementScale.value=on.displacementScale,rn.displacementBias.value=on.displacementBias)}function en(rn,on){on.displacementMap&&(rn.displacementMap.value=on.displacementMap,rn.displacementScale.value=on.displacementScale,rn.displacementBias.value=on.displacementBias),rn.referencePosition.value.copy(on.referencePosition),rn.nearDistance.value=on.nearDistance,rn.farDistance.value=on.farDistance}function an(rn,on){on.bumpMap&&(rn.bumpMap.value=on.bumpMap,rn.bumpScale.value=on.bumpScale,on.side===BackSide&&(rn.bumpScale.value*=-1)),on.normalMap&&(rn.normalMap.value=on.normalMap,rn.normalScale.value.copy(on.normalScale),on.side===BackSide&&rn.normalScale.value.negate()),on.displacementMap&&(rn.displacementMap.value=on.displacementMap,rn.displacementScale.value=on.displacementScale,rn.displacementBias.value=on.displacementBias)}return{refreshFogUniforms:Se,refreshMaterialUniforms:Be}}function WebGLRenderer($e){$e=$e||{};var Se=$e.canvas!==void 0?$e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),Be=$e.context!==void 0?$e.context:null,De=$e.alpha!==void 0?$e.alpha:!1,Ve=$e.depth!==void 0?$e.depth:!0,Fe=$e.stencil!==void 0?$e.stencil:!0,Je=$e.antialias!==void 0?$e.antialias:!1,Xe=$e.premultipliedAlpha!==void 0?$e.premultipliedAlpha:!0,Ke=$e.preserveDrawingBuffer!==void 0?$e.preserveDrawingBuffer:!1,Ye=$e.powerPreference!==void 0?$e.powerPreference:"default",or=$e.failIfMajorPerformanceCaveat!==void 0?$e.failIfMajorPerformanceCaveat:!1,sr=null,cr=null;this.domElement=Se,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=LinearEncoding,this.physicallyCorrectLights=!1,this.toneMapping=NoToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Br=this,tn=!1,en=null,an=0,rn=0,on=null,sn=null,ln=-1,cn={geometry:null,program:null,wireframe:!1},hn=null,mn=null,An=new Vector4,xn=new Vector4,pn=null,dn=Se.width,fn=Se.height,yn=1,Sn=null,gn=null,Cn=new Vector4(0,0,dn,fn),Mn=new Vector4(0,0,dn,fn),Bn=!1,kn=new Frustum,Ln=new WebGLClipping,Pn=!1,Vn=!1,Yn=new Matrix4,ni=new Vector3;function Rn(){return on===null?yn:1}var In;try{var Gn={alpha:De,depth:Ve,stencil:Fe,antialias:Je,premultipliedAlpha:Xe,preserveDrawingBuffer:Ke,powerPreference:Ye,failIfMajorPerformanceCaveat:or};if(Se.addEventListener("webglcontextlost",$i,!1),Se.addEventListener("webglcontextrestored",vi,!1),In=Be||Se.getContext("webgl",Gn)||Se.getContext("experimental-webgl",Gn),In===null)throw Se.getContext("webgl")!==null?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");In.getShaderPrecisionFormat===void 0&&(In.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Kn){throw console.error("THREE.WebGLRenderer: "+Kn.message),Kn}var Fn,Hn,Dn,zn,Qn,Zn,si,ei,hi,Un,Wn,Ai,oi,ci,ai,wi,Pi,Oi;function Ri(){Fn=new WebGLExtensions(In),Hn=new WebGLCapabilities(In,Fn,$e),Hn.isWebGL2===!1&&(Fn.get("WEBGL_depth_texture"),Fn.get("OES_texture_float"),Fn.get("OES_texture_half_float"),Fn.get("OES_texture_half_float_linear"),Fn.get("OES_standard_derivatives"),Fn.get("OES_element_index_uint"),Fn.get("ANGLE_instanced_arrays")),Fn.get("OES_texture_float_linear"),Oi=new WebGLUtils(In,Fn,Hn),Dn=new WebGLState(In,Fn,Hn),Dn.scissor(xn.copy(Mn).multiplyScalar(yn).floor()),Dn.viewport(An.copy(Cn).multiplyScalar(yn).floor()),zn=new WebGLInfo,Qn=new WebGLProperties,Zn=new WebGLTextures(In,Fn,Dn,Qn,Hn,Oi,zn),si=new WebGLAttributes(In,Hn),ei=new WebGLGeometries(In,si,zn),hi=new WebGLObjects(In,ei,si,zn),ai=new WebGLMorphtargets(In),Un=new WebGLPrograms(Br,Fn,Hn),Wn=new WebGLMaterials(Qn),Ai=new WebGLRenderLists,oi=new WebGLRenderStates,ci=new WebGLBackground(Br,Dn,hi,Xe),wi=new WebGLBufferRenderer(In,Fn,zn,Hn),Pi=new WebGLIndexedBufferRenderer(In,Fn,zn,Hn),zn.programs=Un.programs,Br.capabilities=Hn,Br.extensions=Fn,Br.properties=Qn,Br.renderLists=Ai,Br.state=Dn,Br.info=zn}Ri();var _i=new WebXRManager(Br,In);this.xr=_i;var Mi=new WebGLShadowMap(Br,hi,Hn.maxTextureSize);this.shadowMap=Mi,this.getContext=function(){return In},this.getContextAttributes=function(){return In.getContextAttributes()},this.forceContextLoss=function(){var Kn=Fn.get("WEBGL_lose_context");Kn&&Kn.loseContext()},this.forceContextRestore=function(){var Kn=Fn.get("WEBGL_lose_context");Kn&&Kn.restoreContext()},this.getPixelRatio=function(){return yn},this.setPixelRatio=function(Kn){Kn!==void 0&&(yn=Kn,this.setSize(dn,fn,!1))},this.getSize=function(Kn){return Kn===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Kn=new Vector2),Kn.set(dn,fn)},this.setSize=function(Kn,mi,gi){if(_i.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}dn=Kn,fn=mi,Se.width=Math.floor(Kn*yn),Se.height=Math.floor(mi*yn),gi!==!1&&(Se.style.width=Kn+"px",Se.style.height=mi+"px"),this.setViewport(0,0,Kn,mi)},this.getDrawingBufferSize=function(Kn){return Kn===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Kn=new Vector2),Kn.set(dn*yn,fn*yn).floor()},this.setDrawingBufferSize=function(Kn,mi,gi){dn=Kn,fn=mi,yn=gi,Se.width=Math.floor(Kn*gi),Se.height=Math.floor(mi*gi),this.setViewport(0,0,Kn,mi)},this.getCurrentViewport=function(Kn){return Kn===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Kn=new Vector4),Kn.copy(An)},this.getViewport=function(Kn){return Kn.copy(Cn)},this.setViewport=function(Kn,mi,gi,xi){Kn.isVector4?Cn.set(Kn.x,Kn.y,Kn.z,Kn.w):Cn.set(Kn,mi,gi,xi),Dn.viewport(An.copy(Cn).multiplyScalar(yn).floor())},this.getScissor=function(Kn){return Kn.copy(Mn)},this.setScissor=function(Kn,mi,gi,xi){Kn.isVector4?Mn.set(Kn.x,Kn.y,Kn.z,Kn.w):Mn.set(Kn,mi,gi,xi),Dn.scissor(xn.copy(Mn).multiplyScalar(yn).floor())},this.getScissorTest=function(){return Bn},this.setScissorTest=function(Kn){Dn.setScissorTest(Bn=Kn)},this.setOpaqueSort=function(Kn){Sn=Kn},this.setTransparentSort=function(Kn){gn=Kn},this.getClearColor=function(){return ci.getClearColor()},this.setClearColor=function(){ci.setClearColor.apply(ci,arguments)},this.getClearAlpha=function(){return ci.getClearAlpha()},this.setClearAlpha=function(){ci.setClearAlpha.apply(ci,arguments)},this.clear=function(Kn,mi,gi){var xi=0;(Kn===void 0||Kn)&&(xi|=16384),(mi===void 0||mi)&&(xi|=256),(gi===void 0||gi)&&(xi|=1024),In.clear(xi)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){Se.removeEventListener("webglcontextlost",$i,!1),Se.removeEventListener("webglcontextrestored",vi,!1),Ai.dispose(),oi.dispose(),Qn.dispose(),hi.dispose(),_i.dispose(),po.stop()};function $i(Kn){Kn.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),tn=!0}function vi(){console.log("THREE.WebGLRenderer: Context Restored."),tn=!1,Ri()}function ri(Kn){var mi=Kn.target;mi.removeEventListener("dispose",ri),Ti(mi)}function Ti(Kn){Bi(Kn),Qn.remove(Kn)}function Bi(Kn){var mi=Qn.get(Kn).program;Kn.program=void 0,mi!==void 0&&Un.releaseProgram(mi)}function qi(Kn,mi){Kn.render(function(gi){Br.renderBufferImmediate(gi,mi)})}this.renderBufferImmediate=function(Kn,mi){Dn.initAttributes();var gi=Qn.get(Kn);Kn.hasPositions&&!gi.position&&(gi.position=In.createBuffer()),Kn.hasNormals&&!gi.normal&&(gi.normal=In.createBuffer()),Kn.hasUvs&&!gi.uv&&(gi.uv=In.createBuffer()),Kn.hasColors&&!gi.color&&(gi.color=In.createBuffer());var xi=mi.getAttributes();Kn.hasPositions&&(In.bindBuffer(34962,gi.position),In.bufferData(34962,Kn.positionArray,35048),Dn.enableAttribute(xi.position),In.vertexAttribPointer(xi.position,3,5126,!1,0,0)),Kn.hasNormals&&(In.bindBuffer(34962,gi.normal),In.bufferData(34962,Kn.normalArray,35048),Dn.enableAttribute(xi.normal),In.vertexAttribPointer(xi.normal,3,5126,!1,0,0)),Kn.hasUvs&&(In.bindBuffer(34962,gi.uv),In.bufferData(34962,Kn.uvArray,35048),Dn.enableAttribute(xi.uv),In.vertexAttribPointer(xi.uv,2,5126,!1,0,0)),Kn.hasColors&&(In.bindBuffer(34962,gi.color),In.bufferData(34962,Kn.colorArray,35048),Dn.enableAttribute(xi.color),In.vertexAttribPointer(xi.color,3,5126,!1,0,0)),Dn.disableUnusedAttributes(),In.drawArrays(4,0,Kn.count),Kn.count=0};var Ii=new Scene$1;this.renderBufferDirect=function(Kn,mi,gi,xi,ki,Ki){mi===null&&(mi=Ii);var Yi=ki.isMesh&&ki.matrixWorld.determinant()<0,ji=Oo(Kn,mi,xi,ki);Dn.setMaterial(xi,Yi);var Wi=!1;(cn.geometry!==gi.id||cn.program!==ji.id||cn.wireframe!==(xi.wireframe===!0))&&(cn.geometry=gi.id,cn.program=ji.id,cn.wireframe=xi.wireframe===!0,Wi=!0),(xi.morphTargets||xi.morphNormals)&&(ai.update(ki,gi,xi,ji),Wi=!0),ki.isInstancedMesh===!0&&(Wi=!0);var Gi=gi.index,Mo=gi.attributes.position;if(Gi===null){if(Mo===void 0||Mo.count===0)return}else if(Gi.count===0)return;var bo=1;xi.wireframe===!0&&(Gi=ei.getWireframeAttribute(gi),bo=2);var fo,Hi=wi;Gi!==null&&(fo=si.get(Gi),Hi=Pi,Hi.setIndex(fo)),Wi&&(Ui(ki,gi,xi,ji),Gi!==null&&In.bindBuffer(34963,fo.buffer));var eo=Gi!==null?Gi.count:Mo.count,mo=gi.drawRange.start*bo,xo=gi.drawRange.count*bo,ro=Ki!==null?Ki.start*bo:0,To=Ki!==null?Ki.count*bo:1/0,_o=Math.max(mo,ro),Ho=Math.min(eo,mo+xo,ro+To)-1,Io=Math.max(0,Ho-_o+1);if(Io!==0){if(ki.isMesh)xi.wireframe===!0?(Dn.setLineWidth(xi.wireframeLinewidth*Rn()),Hi.setMode(1)):Hi.setMode(4);else if(ki.isLine){var Xa=xi.linewidth;Xa===void 0&&(Xa=1),Dn.setLineWidth(Xa*Rn()),ki.isLineSegments?Hi.setMode(1):ki.isLineLoop?Hi.setMode(2):Hi.setMode(3)}else ki.isPoints?Hi.setMode(0):ki.isSprite&&Hi.setMode(4);if(ki.isInstancedMesh)Hi.renderInstances(gi,_o,Io,ki.count);else if(gi.isInstancedBufferGeometry){var Na=Math.min(gi.instanceCount,gi._maxInstanceCount);Hi.renderInstances(gi,_o,Io,Na)}else Hi.render(_o,Io)}};function Ui(Kn,mi,gi,xi){if(!(Hn.isWebGL2===!1&&(Kn.isInstancedMesh||mi.isInstancedBufferGeometry)&&Fn.get("ANGLE_instanced_arrays")===null)){Dn.initAttributes();var ki=mi.attributes,Ki=xi.getAttributes(),Yi=gi.defaultAttributeValues;for(var ji in Ki){var Wi=Ki[ji];if(Wi>=0){var Gi=ki[ji];if(Gi!==void 0){var Mo=Gi.normalized,bo=Gi.itemSize,fo=si.get(Gi);if(fo===void 0)continue;var Hi=fo.buffer,eo=fo.type,mo=fo.bytesPerElement;if(Gi.isInterleavedBufferAttribute){var xo=Gi.data,ro=xo.stride,To=Gi.offset;xo&&xo.isInstancedInterleavedBuffer?(Dn.enableAttributeAndDivisor(Wi,xo.meshPerAttribute),mi._maxInstanceCount===void 0&&(mi._maxInstanceCount=xo.meshPerAttribute*xo.count)):Dn.enableAttribute(Wi),In.bindBuffer(34962,Hi),Dn.vertexAttribPointer(Wi,bo,eo,Mo,ro*mo,To*mo)}else Gi.isInstancedBufferAttribute?(Dn.enableAttributeAndDivisor(Wi,Gi.meshPerAttribute),mi._maxInstanceCount===void 0&&(mi._maxInstanceCount=Gi.meshPerAttribute*Gi.count)):Dn.enableAttribute(Wi),In.bindBuffer(34962,Hi),Dn.vertexAttribPointer(Wi,bo,eo,Mo,0,0)}else if(ji==="instanceMatrix"){var fo=si.get(Kn.instanceMatrix);if(fo===void 0)continue;var Hi=fo.buffer,eo=fo.type;Dn.enableAttributeAndDivisor(Wi+0,1),Dn.enableAttributeAndDivisor(Wi+1,1),Dn.enableAttributeAndDivisor(Wi+2,1),Dn.enableAttributeAndDivisor(Wi+3,1),In.bindBuffer(34962,Hi),In.vertexAttribPointer(Wi+0,4,eo,!1,64,0),In.vertexAttribPointer(Wi+1,4,eo,!1,64,16),In.vertexAttribPointer(Wi+2,4,eo,!1,64,32),In.vertexAttribPointer(Wi+3,4,eo,!1,64,48)}else if(Yi!==void 0){var _o=Yi[ji];if(_o!==void 0)switch(_o.length){case 2:In.vertexAttrib2fv(Wi,_o);break;case 3:In.vertexAttrib3fv(Wi,_o);break;case 4:In.vertexAttrib4fv(Wi,_o);break;default:In.vertexAttrib1fv(Wi,_o)}}}}Dn.disableUnusedAttributes()}}this.compile=function(Kn,mi){cr=oi.get(Kn,mi),cr.init(),Kn.traverse(function(xi){xi.isLight&&(cr.pushLight(xi),xi.castShadow&&cr.pushShadow(xi))}),cr.setupLights(mi);const gi={};Kn.traverse(function(xi){let ki=xi.material;if(ki)if(Array.isArray(ki))for(let Ki=0;Ki<ki.length;Ki++){let Yi=ki[Ki];Yi.uuid in gi||(Eo(Yi,Kn,xi),gi[Yi.uuid]=!0)}else ki.uuid in gi||(Eo(ki,Kn,xi),gi[ki.uuid]=!0)})};var ho=null;function lo(Kn){_i.isPresenting||ho&&ho(Kn)}var po=new WebGLAnimation;po.setAnimationLoop(lo),typeof window<"u"&&po.setContext(window),this.setAnimationLoop=function(Kn){ho=Kn,_i.setAnimationLoop(Kn),po.start()},this.render=function(Kn,mi){var gi,xi;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),gi=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),xi=arguments[3]),!(mi&&mi.isCamera)){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!tn){cn.geometry=null,cn.program=null,cn.wireframe=!1,ln=-1,hn=null,Kn.autoUpdate===!0&&Kn.updateMatrixWorld(),mi.parent===null&&mi.updateMatrixWorld(),_i.enabled&&_i.isPresenting&&(mi=_i.getCamera(mi)),Kn.onBeforeRender(Br,Kn,mi,gi||on),cr=oi.get(Kn,mi),cr.init(),Yn.multiplyMatrices(mi.projectionMatrix,mi.matrixWorldInverse),kn.setFromProjectionMatrix(Yn),Vn=this.localClippingEnabled,Pn=Ln.init(this.clippingPlanes,Vn,mi),sr=Ai.get(Kn,mi),sr.init(),co(Kn,mi,0,Br.sortObjects),sr.finish(),Br.sortObjects===!0&&sr.sort(Sn,gn),Pn&&Ln.beginShadows();var ki=cr.state.shadowsArray;Mi.render(ki,Kn,mi),cr.setupLights(mi),Pn&&Ln.endShadows(),this.info.autoReset&&this.info.reset(),gi!==void 0&&this.setRenderTarget(gi),ci.render(sr,Kn,mi,xi);var Ki=sr.opaque,Yi=sr.transparent;if(Kn.overrideMaterial){var ji=Kn.overrideMaterial;Ki.length&&go(Ki,Kn,mi,ji),Yi.length&&go(Yi,Kn,mi,ji)}else Ki.length&&go(Ki,Kn,mi),Yi.length&&go(Yi,Kn,mi);Kn.onAfterRender(Br,Kn,mi),on!==null&&(Zn.updateRenderTargetMipmap(on),Zn.updateMultisampleRenderTarget(on)),Dn.buffers.depth.setTest(!0),Dn.buffers.depth.setMask(!0),Dn.buffers.color.setMask(!0),Dn.setPolygonOffset(!1),sr=null,cr=null}};function co(Kn,mi,gi,xi){if(Kn.visible!==!1){var ki=Kn.layers.test(mi.layers);if(ki){if(Kn.isGroup)gi=Kn.renderOrder;else if(Kn.isLOD)Kn.autoUpdate===!0&&Kn.update(mi);else if(Kn.isLight)cr.pushLight(Kn),Kn.castShadow&&cr.pushShadow(Kn);else if(Kn.isSprite){if(!Kn.frustumCulled||kn.intersectsSprite(Kn)){xi&&ni.setFromMatrixPosition(Kn.matrixWorld).applyMatrix4(Yn);var Ki=hi.update(Kn),Yi=Kn.material;Yi.visible&&sr.push(Kn,Ki,Yi,gi,ni.z,null)}}else if(Kn.isImmediateRenderObject)xi&&ni.setFromMatrixPosition(Kn.matrixWorld).applyMatrix4(Yn),sr.push(Kn,null,Kn.material,gi,ni.z,null);else if((Kn.isMesh||Kn.isLine||Kn.isPoints)&&(Kn.isSkinnedMesh&&Kn.skeleton.frame!==zn.render.frame&&(Kn.skeleton.update(),Kn.skeleton.frame=zn.render.frame),!Kn.frustumCulled||kn.intersectsObject(Kn))){xi&&ni.setFromMatrixPosition(Kn.matrixWorld).applyMatrix4(Yn);var Ki=hi.update(Kn),Yi=Kn.material;if(Array.isArray(Yi))for(var ji=Ki.groups,Wi=0,Gi=ji.length;Wi<Gi;Wi++){var Mo=ji[Wi],bo=Yi[Mo.materialIndex];bo&&bo.visible&&sr.push(Kn,Ki,bo,gi,ni.z,Mo)}else Yi.visible&&sr.push(Kn,Ki,Yi,gi,ni.z,null)}}for(var fo=Kn.children,Wi=0,Gi=fo.length;Wi<Gi;Wi++)co(fo[Wi],mi,gi,xi)}}function go(Kn,mi,gi,xi){for(var ki=0,Ki=Kn.length;ki<Ki;ki++){var Yi=Kn[ki],ji=Yi.object,Wi=Yi.geometry,Gi=xi===void 0?Yi.material:xi,Mo=Yi.group;if(gi.isArrayCamera){mn=gi;for(var bo=gi.cameras,fo=0,Hi=bo.length;fo<Hi;fo++){var eo=bo[fo];ji.layers.test(eo.layers)&&(Dn.viewport(An.copy(eo.viewport)),cr.setupLights(eo),vo(ji,mi,eo,Wi,Gi,Mo))}}else mn=null,vo(ji,mi,gi,Wi,Gi,Mo)}}function vo(Kn,mi,gi,xi,ki,Ki){if(Kn.onBeforeRender(Br,mi,gi,xi,ki,Ki),cr=oi.get(mi,mn||gi),Kn.modelViewMatrix.multiplyMatrices(gi.matrixWorldInverse,Kn.matrixWorld),Kn.normalMatrix.getNormalMatrix(Kn.modelViewMatrix),Kn.isImmediateRenderObject){var Yi=Oo(gi,mi,ki,Kn);Dn.setMaterial(ki),cn.geometry=null,cn.program=null,cn.wireframe=!1,qi(Kn,Yi)}else Br.renderBufferDirect(gi,mi,xi,ki,Kn,Ki);Kn.onAfterRender(Br,mi,gi,xi,ki,Ki),cr=oi.get(mi,mn||gi)}function Eo(Kn,mi,gi){var xi=Qn.get(Kn),ki=cr.state.lights,Ki=cr.state.shadowsArray,Yi=ki.state.version,ji=Un.getParameters(Kn,ki.state,Ki,mi,Ln.numPlanes,Ln.numIntersection,gi),Wi=Un.getProgramCacheKey(ji),Gi=xi.program,Mo=!0;if(Gi===void 0)Kn.addEventListener("dispose",ri);else if(Gi.cacheKey!==Wi)Bi(Kn);else if(xi.lightsStateVersion!==Yi)xi.lightsStateVersion=Yi,Mo=!1;else{if(ji.shaderID!==void 0)return;Mo=!1}Mo&&(Gi=Un.acquireProgram(ji,Wi),xi.program=Gi,xi.uniforms=ji.uniforms,xi.outputEncoding=ji.outputEncoding,Kn.program=Gi);var bo=Gi.getAttributes();if(Kn.morphTargets){Kn.numSupportedMorphTargets=0;for(var fo=0;fo<Br.maxMorphTargets;fo++)bo["morphTarget"+fo]>=0&&Kn.numSupportedMorphTargets++}if(Kn.morphNormals){Kn.numSupportedMorphNormals=0;for(var fo=0;fo<Br.maxMorphNormals;fo++)bo["morphNormal"+fo]>=0&&Kn.numSupportedMorphNormals++}var Hi=xi.uniforms;(!Kn.isShaderMaterial&&!Kn.isRawShaderMaterial||Kn.clipping===!0)&&(xi.numClippingPlanes=Ln.numPlanes,xi.numIntersection=Ln.numIntersection,Hi.clippingPlanes=Ln.uniform),xi.environment=Kn.isMeshStandardMaterial?mi.environment:null,xi.fog=mi.fog,xi.needsLights=Po(Kn),xi.lightsStateVersion=Yi,xi.needsLights&&(Hi.ambientLightColor.value=ki.state.ambient,Hi.lightProbe.value=ki.state.probe,Hi.directionalLights.value=ki.state.directional,Hi.directionalLightShadows.value=ki.state.directionalShadow,Hi.spotLights.value=ki.state.spot,Hi.spotLightShadows.value=ki.state.spotShadow,Hi.rectAreaLights.value=ki.state.rectArea,Hi.pointLights.value=ki.state.point,Hi.pointLightShadows.value=ki.state.pointShadow,Hi.hemisphereLights.value=ki.state.hemi,Hi.directionalShadowMap.value=ki.state.directionalShadowMap,Hi.directionalShadowMatrix.value=ki.state.directionalShadowMatrix,Hi.spotShadowMap.value=ki.state.spotShadowMap,Hi.spotShadowMatrix.value=ki.state.spotShadowMatrix,Hi.pointShadowMap.value=ki.state.pointShadowMap,Hi.pointShadowMatrix.value=ki.state.pointShadowMatrix);var eo=xi.program.getUniforms(),mo=WebGLUniforms.seqWithValue(eo.seq,Hi);xi.uniformsList=mo}function Oo(Kn,mi,gi,xi){Zn.resetTextureUnits();var ki=mi.fog,Ki=gi.isMeshStandardMaterial?mi.environment:null,Yi=on===null?Br.outputEncoding:on.texture.encoding,ji=Qn.get(gi),Wi=cr.state.lights;if(Pn&&(Vn||Kn!==hn)){var Gi=Kn===hn&&gi.id===ln;Ln.setState(gi.clippingPlanes,gi.clipIntersection,gi.clipShadows,Kn,ji,Gi)}gi.version===ji.__version?(ji.program===void 0||gi.fog&&ji.fog!==ki||ji.environment!==Ki||ji.needsLights&&ji.lightsStateVersion!==Wi.state.version||ji.numClippingPlanes!==void 0&&(ji.numClippingPlanes!==Ln.numPlanes||ji.numIntersection!==Ln.numIntersection)||ji.outputEncoding!==Yi)&&Eo(gi,mi,xi):(Eo(gi,mi,xi),ji.__version=gi.version);var Mo=!1,bo=!1,fo=!1,Hi=ji.program,eo=Hi.getUniforms(),mo=ji.uniforms;if(Dn.useProgram(Hi.program)&&(Mo=!0,bo=!0,fo=!0),gi.id!==ln&&(ln=gi.id,bo=!0),Mo||hn!==Kn){if(eo.setValue(In,"projectionMatrix",Kn.projectionMatrix),Hn.logarithmicDepthBuffer&&eo.setValue(In,"logDepthBufFC",2/(Math.log(Kn.far+1)/Math.LN2)),hn!==Kn&&(hn=Kn,bo=!0,fo=!0),gi.isShaderMaterial||gi.isMeshPhongMaterial||gi.isMeshToonMaterial||gi.isMeshStandardMaterial||gi.envMap){var xo=eo.map.cameraPosition;xo!==void 0&&xo.setValue(In,ni.setFromMatrixPosition(Kn.matrixWorld))}(gi.isMeshPhongMaterial||gi.isMeshToonMaterial||gi.isMeshLambertMaterial||gi.isMeshBasicMaterial||gi.isMeshStandardMaterial||gi.isShaderMaterial)&&eo.setValue(In,"isOrthographic",Kn.isOrthographicCamera===!0),(gi.isMeshPhongMaterial||gi.isMeshToonMaterial||gi.isMeshLambertMaterial||gi.isMeshBasicMaterial||gi.isMeshStandardMaterial||gi.isShaderMaterial||gi.skinning)&&eo.setValue(In,"viewMatrix",Kn.matrixWorldInverse)}if(gi.skinning){eo.setOptional(In,xi,"bindMatrix"),eo.setOptional(In,xi,"bindMatrixInverse");var ro=xi.skeleton;if(ro){var To=ro.bones;if(Hn.floatVertexTextures){if(ro.boneTexture===void 0){var _o=Math.sqrt(To.length*4);_o=MathUtils.ceilPowerOfTwo(_o),_o=Math.max(_o,4);var Ho=new Float32Array(_o*_o*4);Ho.set(ro.boneMatrices);var Io=new DataTexture(Ho,_o,_o,RGBAFormat,FloatType);ro.boneMatrices=Ho,ro.boneTexture=Io,ro.boneTextureSize=_o}eo.setValue(In,"boneTexture",ro.boneTexture,Zn),eo.setValue(In,"boneTextureSize",ro.boneTextureSize)}else eo.setOptional(In,ro,"boneMatrices")}}return(bo||ji.receiveShadow!==xi.receiveShadow)&&(ji.receiveShadow=xi.receiveShadow,eo.setValue(In,"receiveShadow",xi.receiveShadow)),bo&&(eo.setValue(In,"toneMappingExposure",Br.toneMappingExposure),eo.setValue(In,"toneMappingWhitePoint",Br.toneMappingWhitePoint),ji.needsLights&&Bo(mo,fo),ki&&gi.fog&&Wn.refreshFogUniforms(mo,ki),Wn.refreshMaterialUniforms(mo,gi,Ki,yn,fn),mo.ltc_1!==void 0&&(mo.ltc_1.value=UniformsLib.LTC_1),mo.ltc_2!==void 0&&(mo.ltc_2.value=UniformsLib.LTC_2),WebGLUniforms.upload(In,ji.uniformsList,mo,Zn)),gi.isShaderMaterial&&gi.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(In,ji.uniformsList,mo,Zn),gi.uniformsNeedUpdate=!1),gi.isSpriteMaterial&&eo.setValue(In,"center",xi.center),eo.setValue(In,"modelViewMatrix",xi.modelViewMatrix),eo.setValue(In,"normalMatrix",xi.normalMatrix),eo.setValue(In,"modelMatrix",xi.matrixWorld),Hi}function Bo(Kn,mi){Kn.ambientLightColor.needsUpdate=mi,Kn.lightProbe.needsUpdate=mi,Kn.directionalLights.needsUpdate=mi,Kn.directionalLightShadows.needsUpdate=mi,Kn.pointLights.needsUpdate=mi,Kn.pointLightShadows.needsUpdate=mi,Kn.spotLights.needsUpdate=mi,Kn.spotLightShadows.needsUpdate=mi,Kn.rectAreaLights.needsUpdate=mi,Kn.hemisphereLights.needsUpdate=mi}function Po(Kn){return Kn.isMeshLambertMaterial||Kn.isMeshToonMaterial||Kn.isMeshPhongMaterial||Kn.isMeshStandardMaterial||Kn.isShadowMaterial||Kn.isShaderMaterial&&Kn.lights===!0}this.setFramebuffer=function(Kn){en!==Kn&&on===null&&In.bindFramebuffer(36160,Kn),en=Kn},this.getActiveCubeFace=function(){return an},this.getActiveMipmapLevel=function(){return rn},this.getRenderTarget=function(){return on},this.setRenderTarget=function(Kn,mi,gi){on=Kn,an=mi,rn=gi,Kn&&Qn.get(Kn).__webglFramebuffer===void 0&&Zn.setupRenderTarget(Kn);var xi=en,ki=!1;if(Kn){var Ki=Qn.get(Kn).__webglFramebuffer;Kn.isWebGLCubeRenderTarget?(xi=Ki[mi||0],ki=!0):Kn.isWebGLMultisampleRenderTarget?xi=Qn.get(Kn).__webglMultisampledFramebuffer:xi=Ki,An.copy(Kn.viewport),xn.copy(Kn.scissor),pn=Kn.scissorTest}else An.copy(Cn).multiplyScalar(yn).floor(),xn.copy(Mn).multiplyScalar(yn).floor(),pn=Bn;if(sn!==xi&&(In.bindFramebuffer(36160,xi),sn=xi),Dn.viewport(An),Dn.scissor(xn),Dn.setScissorTest(pn),ki){var Yi=Qn.get(Kn.texture);In.framebufferTexture2D(36160,36064,34069+(mi||0),Yi.__webglTexture,gi||0)}},this.readRenderTargetPixels=function(Kn,mi,gi,xi,ki,Ki,Yi){if(!(Kn&&Kn.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var ji=Qn.get(Kn).__webglFramebuffer;if(Kn.isWebGLCubeRenderTarget&&Yi!==void 0&&(ji=ji[Yi]),ji){var Wi=!1;ji!==sn&&(In.bindFramebuffer(36160,ji),Wi=!0);try{var Gi=Kn.texture,Mo=Gi.format,bo=Gi.type;if(Mo!==RGBAFormat&&Oi.convert(Mo)!==In.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(bo!==UnsignedByteType&&Oi.convert(bo)!==In.getParameter(35738)&&!(bo===FloatType&&(Hn.isWebGL2||Fn.get("OES_texture_float")||Fn.get("WEBGL_color_buffer_float")))&&!(bo===HalfFloatType&&(Hn.isWebGL2?Fn.get("EXT_color_buffer_float"):Fn.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}In.checkFramebufferStatus(36160)===36053?mi>=0&&mi<=Kn.width-xi&&gi>=0&&gi<=Kn.height-ki&&In.readPixels(mi,gi,xi,ki,Oi.convert(Mo),Oi.convert(bo),Ki):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Wi&&In.bindFramebuffer(36160,sn)}}},this.copyFramebufferToTexture=function(Kn,mi,gi){gi===void 0&&(gi=0);var xi=Math.pow(2,-gi),ki=Math.floor(mi.image.width*xi),Ki=Math.floor(mi.image.height*xi),Yi=Oi.convert(mi.format);Zn.setTexture2D(mi,0),In.copyTexImage2D(3553,gi,Yi,Kn.x,Kn.y,ki,Ki,0),Dn.unbindTexture()},this.copyTextureToTexture=function(Kn,mi,gi,xi){xi===void 0&&(xi=0);var ki=mi.image.width,Ki=mi.image.height,Yi=Oi.convert(gi.format),ji=Oi.convert(gi.type);Zn.setTexture2D(gi,0),mi.isDataTexture?In.texSubImage2D(3553,xi,Kn.x,Kn.y,ki,Ki,Yi,ji,mi.image.data):mi.isCompressedTexture?In.compressedTexSubImage2D(3553,xi,Kn.x,Kn.y,mi.mipmaps[0].width,mi.mipmaps[0].height,Yi,mi.mipmaps[0].data):In.texSubImage2D(3553,xi,Kn.x,Kn.y,Yi,ji,mi.image),xi===0&&gi.generateMipmaps&&In.generateMipmap(3553),Dn.unbindTexture()},this.initTexture=function(Kn){Zn.setTexture2D(Kn,0),Dn.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function FogExp2($e,Se){this.name="",this.color=new Color($e),this.density=Se!==void 0?Se:25e-5}Object.assign(FogExp2.prototype,{isFogExp2:!0,clone:function(){return new FogExp2(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}});function Fog($e,Se,Be){this.name="",this.color=new Color($e),this.near=Se!==void 0?Se:1,this.far=Be!==void 0?Be:1e3}Object.assign(Fog.prototype,{isFog:!0,clone:function(){return new Fog(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}});function InterleavedBuffer($e,Se){this.array=$e,this.stride=Se,this.count=$e!==void 0?$e.length/Se:0,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(InterleavedBuffer.prototype,"needsUpdate",{set:function($e){$e===!0&&this.version++}});Object.assign(InterleavedBuffer.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function($e){return this.usage=$e,this},copy:function($e){return this.array=new $e.array.constructor($e.array),this.count=$e.count,this.stride=$e.stride,this.usage=$e.usage,this},copyAt:function($e,Se,Be){$e*=this.stride,Be*=Se.stride;for(var De=0,Ve=this.stride;De<Ve;De++)this.array[$e+De]=Se.array[Be+De];return this},set:function($e,Se){return Se===void 0&&(Se=0),this.array.set($e,Se),this},clone:function(){return new this.constructor().copy(this)},onUpload:function($e){return this.onUploadCallback=$e,this}});var _vector$6=new Vector3;function InterleavedBufferAttribute($e,Se,Be,De){this.name="",this.data=$e,this.itemSize=Se,this.offset=Be,this.normalized=De===!0}Object.defineProperties(InterleavedBufferAttribute.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(InterleavedBufferAttribute.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function($e){for(var Se=0,Be=this.data.count;Se<Be;Se++)_vector$6.x=this.getX(Se),_vector$6.y=this.getY(Se),_vector$6.z=this.getZ(Se),_vector$6.applyMatrix4($e),this.setXYZ(Se,_vector$6.x,_vector$6.y,_vector$6.z);return this},setX:function($e,Se){return this.data.array[$e*this.data.stride+this.offset]=Se,this},setY:function($e,Se){return this.data.array[$e*this.data.stride+this.offset+1]=Se,this},setZ:function($e,Se){return this.data.array[$e*this.data.stride+this.offset+2]=Se,this},setW:function($e,Se){return this.data.array[$e*this.data.stride+this.offset+3]=Se,this},getX:function($e){return this.data.array[$e*this.data.stride+this.offset]},getY:function($e){return this.data.array[$e*this.data.stride+this.offset+1]},getZ:function($e){return this.data.array[$e*this.data.stride+this.offset+2]},getW:function($e){return this.data.array[$e*this.data.stride+this.offset+3]},setXY:function($e,Se,Be){return $e=$e*this.data.stride+this.offset,this.data.array[$e+0]=Se,this.data.array[$e+1]=Be,this},setXYZ:function($e,Se,Be,De){return $e=$e*this.data.stride+this.offset,this.data.array[$e+0]=Se,this.data.array[$e+1]=Be,this.data.array[$e+2]=De,this},setXYZW:function($e,Se,Be,De,Ve){return $e=$e*this.data.stride+this.offset,this.data.array[$e+0]=Se,this.data.array[$e+1]=Be,this.data.array[$e+2]=De,this.data.array[$e+3]=Ve,this},clone:function(){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var $e=[],Se=0;Se<this.count;Se++)for(var Be=Se*this.data.stride+this.offset,De=0;De<this.itemSize;De++)$e.push(this.data.array[Be+De]);return new BufferAttribute(new this.array.constructor($e),this.itemSize,this.normalized)},toJSON:function(){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var $e=[],Se=0;Se<this.count;Se++)for(var Be=Se*this.data.stride+this.offset,De=0;De<this.itemSize;De++)$e.push(this.data.array[Be+De]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:$e,normalized:this.normalized}}});function SpriteMaterial($e){Material.call(this),this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues($e)}SpriteMaterial.prototype=Object.create(Material.prototype);SpriteMaterial.prototype.constructor=SpriteMaterial;SpriteMaterial.prototype.isSpriteMaterial=!0;SpriteMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.color.copy($e.color),this.map=$e.map,this.alphaMap=$e.alphaMap,this.rotation=$e.rotation,this.sizeAttenuation=$e.sizeAttenuation,this};var _geometry,_intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2;function Sprite($e){if(Object3D.call(this),this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;var Se=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),Be=new InterleavedBuffer(Se,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(Be,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(Be,2,3,!1))}this.geometry=_geometry,this.material=$e!==void 0?$e:new SpriteMaterial,this.center=new Vector2(.5,.5)}Sprite.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Sprite,isSprite:!0,raycast:function($e,Se){$e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy($e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices($e.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),$e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);var Be=this.material.rotation,De,Ve;Be!==0&&(Ve=Math.cos(Be),De=Math.sin(Be));var Fe=this.center;transformVertex(_vA$1.set(-.5,-.5,0),_mvPosition,Fe,_worldScale,De,Ve),transformVertex(_vB$1.set(.5,-.5,0),_mvPosition,Fe,_worldScale,De,Ve),transformVertex(_vC$1.set(.5,.5,0),_mvPosition,Fe,_worldScale,De,Ve),_uvA$1.set(0,0),_uvB$1.set(1,0),_uvC$1.set(1,1);var Je=$e.ray.intersectTriangle(_vA$1,_vB$1,_vC$1,!1,_intersectPoint);if(!(Je===null&&(transformVertex(_vB$1.set(-.5,.5,0),_mvPosition,Fe,_worldScale,De,Ve),_uvB$1.set(0,1),Je=$e.ray.intersectTriangle(_vA$1,_vC$1,_vB$1,!1,_intersectPoint),Je===null))){var Xe=$e.ray.origin.distanceTo(_intersectPoint);Xe<$e.near||Xe>$e.far||Se.push({distance:Xe,point:_intersectPoint.clone(),uv:Triangle.getUV(_intersectPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function($e){return Object3D.prototype.copy.call(this,$e),$e.center!==void 0&&this.center.copy($e.center),this}});function transformVertex($e,Se,Be,De,Ve,Fe){_alignedPosition.subVectors($e,Be).addScalar(.5).multiply(De),Ve!==void 0?(_rotatedPosition.x=Fe*_alignedPosition.x-Ve*_alignedPosition.y,_rotatedPosition.y=Ve*_alignedPosition.x+Fe*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),$e.copy(Se),$e.x+=_rotatedPosition.x,$e.y+=_rotatedPosition.y,$e.applyMatrix4(_viewWorldMatrix)}var _v1$4=new Vector3,_v2$2=new Vector3;function LOD(){Object3D.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}LOD.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:LOD,isLOD:!0,copy:function($e){Object3D.prototype.copy.call(this,$e,!1);for(var Se=$e.levels,Be=0,De=Se.length;Be<De;Be++){var Ve=Se[Be];this.addLevel(Ve.object.clone(),Ve.distance)}return this.autoUpdate=$e.autoUpdate,this},addLevel:function($e,Se){Se===void 0&&(Se=0),Se=Math.abs(Se);for(var Be=this.levels,De=0;De<Be.length&&!(Se<Be[De].distance);De++);return Be.splice(De,0,{distance:Se,object:$e}),this.add($e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function($e){var Se=this.levels;if(Se.length>0){for(var Be=1,De=Se.length;Be<De&&!($e<Se[Be].distance);Be++);return Se[Be-1].object}return null},raycast:function($e,Se){var Be=this.levels;if(Be.length>0){_v1$4.setFromMatrixPosition(this.matrixWorld);var De=$e.ray.origin.distanceTo(_v1$4);this.getObjectForDistance(De).raycast($e,Se)}},update:function($e){var Se=this.levels;if(Se.length>1){_v1$4.setFromMatrixPosition($e.matrixWorld),_v2$2.setFromMatrixPosition(this.matrixWorld);var Be=_v1$4.distanceTo(_v2$2)/$e.zoom;Se[0].object.visible=!0;for(var De=1,Ve=Se.length;De<Ve&&Be>=Se[De].distance;De++)Se[De-1].object.visible=!1,Se[De].object.visible=!0;for(this._currentLevel=De-1;De<Ve;De++)Se[De].object.visible=!1}},toJSON:function($e){var Se=Object3D.prototype.toJSON.call(this,$e);this.autoUpdate===!1&&(Se.object.autoUpdate=!1),Se.object.levels=[];for(var Be=this.levels,De=0,Ve=Be.length;De<Ve;De++){var Fe=Be[De];Se.object.levels.push({object:Fe.object.uuid,distance:Fe.distance})}return Se}});function SkinnedMesh($e,Se){$e&&$e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Mesh.call(this,$e,Se),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4}SkinnedMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:SkinnedMesh,isSkinnedMesh:!0,bind:function($e,Se){this.skeleton=$e,Se===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),Se=this.matrixWorld),this.bindMatrix.copy(Se),this.bindMatrixInverse.getInverse(Se)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var $e=new Vector4,Se=this.geometry.attributes.skinWeight,Be=0,De=Se.count;Be<De;Be++){$e.x=Se.getX(Be),$e.y=Se.getY(Be),$e.z=Se.getZ(Be),$e.w=Se.getW(Be);var Ve=1/$e.manhattanLength();Ve!==1/0?$e.multiplyScalar(Ve):$e.set(1,0,0,0),Se.setXYZW(Be,$e.x,$e.y,$e.z,$e.w)}},updateMatrixWorld:function($e){Mesh.prototype.updateMatrixWorld.call(this,$e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var $e=new Vector3,Se=new Vector4,Be=new Vector4,De=new Vector3,Ve=new Matrix4;return function(Fe,Je){var Xe=this.skeleton,Ke=this.geometry;Se.fromBufferAttribute(Ke.attributes.skinIndex,Fe),Be.fromBufferAttribute(Ke.attributes.skinWeight,Fe),$e.fromBufferAttribute(Ke.attributes.position,Fe).applyMatrix4(this.bindMatrix),Je.set(0,0,0);for(var Ye=0;Ye<4;Ye++){var or=Be.getComponent(Ye);if(or!==0){var sr=Se.getComponent(Ye);Ve.multiplyMatrices(Xe.bones[sr].matrixWorld,Xe.boneInverses[sr]),Je.addScaledVector(De.copy($e).applyMatrix4(Ve),or)}}return Je.applyMatrix4(this.bindMatrixInverse)}}()});var _offsetMatrix=new Matrix4,_identityMatrix=new Matrix4;function Skeleton($e,Se){if($e=$e||[],this.bones=$e.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,Se===void 0)this.calculateInverses();else if(this.bones.length===Se.length)this.boneInverses=Se.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var Be=0,De=this.bones.length;Be<De;Be++)this.boneInverses.push(new Matrix4)}}Object.assign(Skeleton.prototype,{calculateInverses:function(){this.boneInverses=[];for(var $e=0,Se=this.bones.length;$e<Se;$e++){var Be=new Matrix4;this.bones[$e]&&Be.getInverse(this.bones[$e].matrixWorld),this.boneInverses.push(Be)}},pose:function(){var $e,Se,Be;for(Se=0,Be=this.bones.length;Se<Be;Se++)$e=this.bones[Se],$e&&$e.matrixWorld.getInverse(this.boneInverses[Se]);for(Se=0,Be=this.bones.length;Se<Be;Se++)$e=this.bones[Se],$e&&($e.parent&&$e.parent.isBone?($e.matrix.getInverse($e.parent.matrixWorld),$e.matrix.multiply($e.matrixWorld)):$e.matrix.copy($e.matrixWorld),$e.matrix.decompose($e.position,$e.quaternion,$e.scale))},update:function(){for(var $e=this.bones,Se=this.boneInverses,Be=this.boneMatrices,De=this.boneTexture,Ve=0,Fe=$e.length;Ve<Fe;Ve++){var Je=$e[Ve]?$e[Ve].matrixWorld:_identityMatrix;_offsetMatrix.multiplyMatrices(Je,Se[Ve]),_offsetMatrix.toArray(Be,Ve*16)}De!==void 0&&(De.needsUpdate=!0)},clone:function(){return new Skeleton(this.bones,this.boneInverses)},getBoneByName:function($e){for(var Se=0,Be=this.bones.length;Se<Be;Se++){var De=this.bones[Se];if(De.name===$e)return De}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});function Bone(){Object3D.call(this),this.type="Bone"}Bone.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Bone,isBone:!0});var _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_mesh=new Mesh;function InstancedMesh($e,Se,Be){Mesh.call(this,$e,Se),this.instanceMatrix=new BufferAttribute(new Float32Array(Be*16),16),this.count=Be,this.frustumCulled=!1}InstancedMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:InstancedMesh,isInstancedMesh:!0,getMatrixAt:function($e,Se){Se.fromArray(this.instanceMatrix.array,$e*16)},raycast:function($e,Se){var Be=this.matrixWorld,De=this.count;if(_mesh.geometry=this.geometry,_mesh.material=this.material,_mesh.material!==void 0)for(var Ve=0;Ve<De;Ve++){this.getMatrixAt(Ve,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(Be,_instanceLocalMatrix),_mesh.matrixWorld=_instanceWorldMatrix,_mesh.raycast($e,_instanceIntersects);for(var Fe=0,Je=_instanceIntersects.length;Fe<Je;Fe++){var Xe=_instanceIntersects[Fe];Xe.instanceId=Ve,Xe.object=this,Se.push(Xe)}_instanceIntersects.length=0}},setMatrixAt:function($e,Se){Se.toArray(this.instanceMatrix.array,$e*16)},updateMorphTargets:function(){}});function LineBasicMaterial($e){Material.call(this),this.type="LineBasicMaterial",this.color=new Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues($e)}LineBasicMaterial.prototype=Object.create(Material.prototype);LineBasicMaterial.prototype.constructor=LineBasicMaterial;LineBasicMaterial.prototype.isLineBasicMaterial=!0;LineBasicMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.color.copy($e.color),this.linewidth=$e.linewidth,this.linecap=$e.linecap,this.linejoin=$e.linejoin,this.morphTargets=$e.morphTargets,this};var _start=new Vector3,_end=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$2=new Sphere;function Line($e,Se,Be){Be===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Object3D.call(this),this.type="Line",this.geometry=$e!==void 0?$e:new BufferGeometry,this.material=Se!==void 0?Se:new LineBasicMaterial,this.updateMorphTargets()}Line.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Line,isLine:!0,computeLineDistances:function(){var $e=this.geometry;if($e.isBufferGeometry)if($e.index===null){for(var Se=$e.attributes.position,Be=[0],De=1,Ve=Se.count;De<Ve;De++)_start.fromBufferAttribute(Se,De-1),_end.fromBufferAttribute(Se,De),Be[De]=Be[De-1],Be[De]+=_start.distanceTo(_end);$e.setAttribute("lineDistance",new Float32BufferAttribute(Be,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if($e.isGeometry){var Fe=$e.vertices,Be=$e.lineDistances;Be[0]=0;for(var De=1,Ve=Fe.length;De<Ve;De++)Be[De]=Be[De-1],Be[De]+=Fe[De-1].distanceTo(Fe[De])}return this},raycast:function($e,Se){var Be=this.geometry,De=this.matrixWorld,Ve=$e.params.Line.threshold;if(Be.boundingSphere===null&&Be.computeBoundingSphere(),_sphere$2.copy(Be.boundingSphere),_sphere$2.applyMatrix4(De),_sphere$2.radius+=Ve,$e.ray.intersectsSphere(_sphere$2)!==!1){_inverseMatrix$1.getInverse(De),_ray$1.copy($e.ray).applyMatrix4(_inverseMatrix$1);var Fe=Ve/((this.scale.x+this.scale.y+this.scale.z)/3),Je=Fe*Fe,Xe=new Vector3,Ke=new Vector3,Ye=new Vector3,or=new Vector3,sr=this&&this.isLineSegments?2:1;if(Be.isBufferGeometry){var cr=Be.index,Br=Be.attributes,tn=Br.position.array;if(cr!==null)for(var en=cr.array,an=0,rn=en.length-1;an<rn;an+=sr){var on=en[an],sn=en[an+1];Xe.fromArray(tn,on*3),Ke.fromArray(tn,sn*3);var ln=_ray$1.distanceSqToSegment(Xe,Ke,or,Ye);if(!(ln>Je)){or.applyMatrix4(this.matrixWorld);var cn=$e.ray.origin.distanceTo(or);cn<$e.near||cn>$e.far||Se.push({distance:cn,point:Ye.clone().applyMatrix4(this.matrixWorld),index:an,face:null,faceIndex:null,object:this})}}else for(var an=0,rn=tn.length/3-1;an<rn;an+=sr){Xe.fromArray(tn,3*an),Ke.fromArray(tn,3*an+3);var ln=_ray$1.distanceSqToSegment(Xe,Ke,or,Ye);if(!(ln>Je)){or.applyMatrix4(this.matrixWorld);var cn=$e.ray.origin.distanceTo(or);cn<$e.near||cn>$e.far||Se.push({distance:cn,point:Ye.clone().applyMatrix4(this.matrixWorld),index:an,face:null,faceIndex:null,object:this})}}}else if(Be.isGeometry)for(var hn=Be.vertices,mn=hn.length,an=0;an<mn-1;an+=sr){var ln=_ray$1.distanceSqToSegment(hn[an],hn[an+1],or,Ye);if(!(ln>Je)){or.applyMatrix4(this.matrixWorld);var cn=$e.ray.origin.distanceTo(or);cn<$e.near||cn>$e.far||Se.push({distance:cn,point:Ye.clone().applyMatrix4(this.matrixWorld),index:an,face:null,faceIndex:null,object:this})}}}},updateMorphTargets:function(){var $e=this.geometry,Se,Be,De;if($e.isBufferGeometry){var Ve=$e.morphAttributes,Fe=Object.keys(Ve);if(Fe.length>0){var Je=Ve[Fe[0]];if(Je!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},Se=0,Be=Je.length;Se<Be;Se++)De=Je[Se].name||String(Se),this.morphTargetInfluences.push(0),this.morphTargetDictionary[De]=Se}}else{var Xe=$e.morphTargets;Xe!==void 0&&Xe.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var _start$1=new Vector3,_end$1=new Vector3;function LineSegments($e,Se){Line.call(this,$e,Se),this.type="LineSegments"}LineSegments.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineSegments,isLineSegments:!0,computeLineDistances:function(){var $e=this.geometry;if($e.isBufferGeometry)if($e.index===null){for(var Se=$e.attributes.position,Be=[],De=0,Ve=Se.count;De<Ve;De+=2)_start$1.fromBufferAttribute(Se,De),_end$1.fromBufferAttribute(Se,De+1),Be[De]=De===0?0:Be[De-1],Be[De+1]=Be[De]+_start$1.distanceTo(_end$1);$e.setAttribute("lineDistance",new Float32BufferAttribute(Be,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if($e.isGeometry)for(var Fe=$e.vertices,Be=$e.lineDistances,De=0,Ve=Fe.length;De<Ve;De+=2)_start$1.copy(Fe[De]),_end$1.copy(Fe[De+1]),Be[De]=De===0?0:Be[De-1],Be[De+1]=Be[De]+_start$1.distanceTo(_end$1);return this}});function LineLoop($e,Se){Line.call(this,$e,Se),this.type="LineLoop"}LineLoop.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineLoop,isLineLoop:!0});function PointsMaterial($e){Material.call(this),this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues($e)}PointsMaterial.prototype=Object.create(Material.prototype);PointsMaterial.prototype.constructor=PointsMaterial;PointsMaterial.prototype.isPointsMaterial=!0;PointsMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.color.copy($e.color),this.map=$e.map,this.alphaMap=$e.alphaMap,this.size=$e.size,this.sizeAttenuation=$e.sizeAttenuation,this.morphTargets=$e.morphTargets,this};var _inverseMatrix$2=new Matrix4,_ray$2=new Ray,_sphere$3=new Sphere,_position$1=new Vector3;function Points($e,Se){Object3D.call(this),this.type="Points",this.geometry=$e!==void 0?$e:new BufferGeometry,this.material=Se!==void 0?Se:new PointsMaterial,this.updateMorphTargets()}Points.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Points,isPoints:!0,raycast:function($e,Se){var Be=this.geometry,De=this.matrixWorld,Ve=$e.params.Points.threshold;if(Be.boundingSphere===null&&Be.computeBoundingSphere(),_sphere$3.copy(Be.boundingSphere),_sphere$3.applyMatrix4(De),_sphere$3.radius+=Ve,$e.ray.intersectsSphere(_sphere$3)!==!1){_inverseMatrix$2.getInverse(De),_ray$2.copy($e.ray).applyMatrix4(_inverseMatrix$2);var Fe=Ve/((this.scale.x+this.scale.y+this.scale.z)/3),Je=Fe*Fe;if(Be.isBufferGeometry){var Xe=Be.index,Ke=Be.attributes,Ye=Ke.position.array;if(Xe!==null)for(var or=Xe.array,sr=0,cr=or.length;sr<cr;sr++){var Br=or[sr];_position$1.fromArray(Ye,Br*3),testPoint(_position$1,Br,Je,De,$e,Se,this)}else for(var sr=0,tn=Ye.length/3;sr<tn;sr++)_position$1.fromArray(Ye,sr*3),testPoint(_position$1,sr,Je,De,$e,Se,this)}else for(var en=Be.vertices,sr=0,tn=en.length;sr<tn;sr++)testPoint(en[sr],sr,Je,De,$e,Se,this)}},updateMorphTargets:function(){var $e=this.geometry,Se,Be,De;if($e.isBufferGeometry){var Ve=$e.morphAttributes,Fe=Object.keys(Ve);if(Fe.length>0){var Je=Ve[Fe[0]];if(Je!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},Se=0,Be=Je.length;Se<Be;Se++)De=Je[Se].name||String(Se),this.morphTargetInfluences.push(0),this.morphTargetDictionary[De]=Se}}else{var Xe=$e.morphTargets;Xe!==void 0&&Xe.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function testPoint($e,Se,Be,De,Ve,Fe,Je){var Xe=_ray$2.distanceSqToPoint($e);if(Xe<Be){var Ke=new Vector3;_ray$2.closestPointToPoint($e,Ke),Ke.applyMatrix4(De);var Ye=Ve.ray.origin.distanceTo(Ke);if(Ye<Ve.near||Ye>Ve.far)return;Fe.push({distance:Ye,distanceToRay:Math.sqrt(Xe),point:Ke,index:Se,face:null,object:Je})}}function VideoTexture($e,Se,Be,De,Ve,Fe,Je,Xe,Ke){Texture.call(this,$e,Se,Be,De,Ve,Fe,Je,Xe,Ke),this.format=Je!==void 0?Je:RGBFormat,this.minFilter=Fe!==void 0?Fe:LinearFilter,this.magFilter=Ve!==void 0?Ve:LinearFilter,this.generateMipmaps=!1}VideoTexture.prototype=Object.assign(Object.create(Texture.prototype),{constructor:VideoTexture,isVideoTexture:!0,update:function(){var $e=this.image;$e.readyState>=$e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function CompressedTexture($e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr){Texture.call(this,null,Fe,Je,Xe,Ke,Ye,De,Ve,or,sr),this.image={width:Se,height:Be},this.mipmaps=$e,this.flipY=!1,this.generateMipmaps=!1}CompressedTexture.prototype=Object.create(Texture.prototype);CompressedTexture.prototype.constructor=CompressedTexture;CompressedTexture.prototype.isCompressedTexture=!0;function CanvasTexture($e,Se,Be,De,Ve,Fe,Je,Xe,Ke){Texture.call(this,$e,Se,Be,De,Ve,Fe,Je,Xe,Ke),this.needsUpdate=!0}CanvasTexture.prototype=Object.create(Texture.prototype);CanvasTexture.prototype.constructor=CanvasTexture;CanvasTexture.prototype.isCanvasTexture=!0;function DepthTexture($e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye){if(Ye=Ye!==void 0?Ye:DepthFormat,Ye!==DepthFormat&&Ye!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");Be===void 0&&Ye===DepthFormat&&(Be=UnsignedShortType),Be===void 0&&Ye===DepthStencilFormat&&(Be=UnsignedInt248Type),Texture.call(this,null,De,Ve,Fe,Je,Xe,Ye,Be,Ke),this.image={width:$e,height:Se},this.magFilter=Je!==void 0?Je:NearestFilter,this.minFilter=Xe!==void 0?Xe:NearestFilter,this.flipY=!1,this.generateMipmaps=!1}DepthTexture.prototype=Object.create(Texture.prototype);DepthTexture.prototype.constructor=DepthTexture;DepthTexture.prototype.isDepthTexture=!0;function WireframeGeometry($e){BufferGeometry.call(this),this.type="WireframeGeometry";var Se=[],Be,De,Ve,Fe,Je,Xe=[0,0],Ke={},Ye,or,sr,cr,Br=["a","b","c"],tn;if($e&&$e.isGeometry){var en=$e.faces;for(Be=0,Ve=en.length;Be<Ve;Be++){var an=en[Be];for(De=0;De<3;De++)or=an[Br[De]],sr=an[Br[(De+1)%3]],Xe[0]=Math.min(or,sr),Xe[1]=Math.max(or,sr),cr=Xe[0]+","+Xe[1],Ke[cr]===void 0&&(Ke[cr]={index1:Xe[0],index2:Xe[1]})}for(cr in Ke)Ye=Ke[cr],tn=$e.vertices[Ye.index1],Se.push(tn.x,tn.y,tn.z),tn=$e.vertices[Ye.index2],Se.push(tn.x,tn.y,tn.z)}else if($e&&$e.isBufferGeometry){var rn,on,sn,ln,cn,hn,mn,An;if(tn=new Vector3,$e.index!==null){for(rn=$e.attributes.position,on=$e.index,sn=$e.groups,sn.length===0&&(sn=[{start:0,count:on.count,materialIndex:0}]),Fe=0,Je=sn.length;Fe<Je;++Fe)for(ln=sn[Fe],cn=ln.start,hn=ln.count,Be=cn,Ve=cn+hn;Be<Ve;Be+=3)for(De=0;De<3;De++)or=on.getX(Be+De),sr=on.getX(Be+(De+1)%3),Xe[0]=Math.min(or,sr),Xe[1]=Math.max(or,sr),cr=Xe[0]+","+Xe[1],Ke[cr]===void 0&&(Ke[cr]={index1:Xe[0],index2:Xe[1]});for(cr in Ke)Ye=Ke[cr],tn.fromBufferAttribute(rn,Ye.index1),Se.push(tn.x,tn.y,tn.z),tn.fromBufferAttribute(rn,Ye.index2),Se.push(tn.x,tn.y,tn.z)}else for(rn=$e.attributes.position,Be=0,Ve=rn.count/3;Be<Ve;Be++)for(De=0;De<3;De++)mn=3*Be+De,tn.fromBufferAttribute(rn,mn),Se.push(tn.x,tn.y,tn.z),An=3*Be+(De+1)%3,tn.fromBufferAttribute(rn,An),Se.push(tn.x,tn.y,tn.z)}this.setAttribute("position",new Float32BufferAttribute(Se,3))}WireframeGeometry.prototype=Object.create(BufferGeometry.prototype);WireframeGeometry.prototype.constructor=WireframeGeometry;function ParametricGeometry($e,Se,Be){Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:$e,slices:Se,stacks:Be},this.fromBufferGeometry(new ParametricBufferGeometry($e,Se,Be)),this.mergeVertices()}ParametricGeometry.prototype=Object.create(Geometry.prototype);ParametricGeometry.prototype.constructor=ParametricGeometry;function ParametricBufferGeometry($e,Se,Be){BufferGeometry.call(this),this.type="ParametricBufferGeometry",this.parameters={func:$e,slices:Se,stacks:Be};var De=[],Ve=[],Fe=[],Je=[],Xe=1e-5,Ke=new Vector3,Ye=new Vector3,or=new Vector3,sr=new Vector3,cr=new Vector3,Br,tn;$e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var en=Se+1;for(Br=0;Br<=Be;Br++){var an=Br/Be;for(tn=0;tn<=Se;tn++){var rn=tn/Se;$e(rn,an,Ye),Ve.push(Ye.x,Ye.y,Ye.z),rn-Xe>=0?($e(rn-Xe,an,or),sr.subVectors(Ye,or)):($e(rn+Xe,an,or),sr.subVectors(or,Ye)),an-Xe>=0?($e(rn,an-Xe,or),cr.subVectors(Ye,or)):($e(rn,an+Xe,or),cr.subVectors(or,Ye)),Ke.crossVectors(sr,cr).normalize(),Fe.push(Ke.x,Ke.y,Ke.z),Je.push(rn,an)}}for(Br=0;Br<Be;Br++)for(tn=0;tn<Se;tn++){var on=Br*en+tn,sn=Br*en+tn+1,ln=(Br+1)*en+tn+1,cn=(Br+1)*en+tn;De.push(on,sn,cn),De.push(sn,ln,cn)}this.setIndex(De),this.setAttribute("position",new Float32BufferAttribute(Ve,3)),this.setAttribute("normal",new Float32BufferAttribute(Fe,3)),this.setAttribute("uv",new Float32BufferAttribute(Je,2))}ParametricBufferGeometry.prototype=Object.create(BufferGeometry.prototype);ParametricBufferGeometry.prototype.constructor=ParametricBufferGeometry;function PolyhedronGeometry($e,Se,Be,De){Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:$e,indices:Se,radius:Be,detail:De},this.fromBufferGeometry(new PolyhedronBufferGeometry($e,Se,Be,De)),this.mergeVertices()}PolyhedronGeometry.prototype=Object.create(Geometry.prototype);PolyhedronGeometry.prototype.constructor=PolyhedronGeometry;function PolyhedronBufferGeometry($e,Se,Be,De){BufferGeometry.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:$e,indices:Se,radius:Be,detail:De},Be=Be||1,De=De||0;var Ve=[],Fe=[];Je(De),Ke(Be),Ye(),this.setAttribute("position",new Float32BufferAttribute(Ve,3)),this.setAttribute("normal",new Float32BufferAttribute(Ve.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(Fe,2)),De===0?this.computeVertexNormals():this.normalizeNormals();function Je(rn){for(var on=new Vector3,sn=new Vector3,ln=new Vector3,cn=0;cn<Se.length;cn+=3)cr(Se[cn+0],on),cr(Se[cn+1],sn),cr(Se[cn+2],ln),Xe(on,sn,ln,rn)}function Xe(rn,on,sn,ln){var cn=Math.pow(2,ln),hn=[],mn,An;for(mn=0;mn<=cn;mn++){hn[mn]=[];var xn=rn.clone().lerp(sn,mn/cn),pn=on.clone().lerp(sn,mn/cn),dn=cn-mn;for(An=0;An<=dn;An++)An===0&&mn===cn?hn[mn][An]=xn:hn[mn][An]=xn.clone().lerp(pn,An/dn)}for(mn=0;mn<cn;mn++)for(An=0;An<2*(cn-mn)-1;An++){var fn=Math.floor(An/2);An%2===0?(sr(hn[mn][fn+1]),sr(hn[mn+1][fn]),sr(hn[mn][fn])):(sr(hn[mn][fn+1]),sr(hn[mn+1][fn+1]),sr(hn[mn+1][fn]))}}function Ke(rn){for(var on=new Vector3,sn=0;sn<Ve.length;sn+=3)on.x=Ve[sn+0],on.y=Ve[sn+1],on.z=Ve[sn+2],on.normalize().multiplyScalar(rn),Ve[sn+0]=on.x,Ve[sn+1]=on.y,Ve[sn+2]=on.z}function Ye(){for(var rn=new Vector3,on=0;on<Ve.length;on+=3){rn.x=Ve[on+0],rn.y=Ve[on+1],rn.z=Ve[on+2];var sn=en(rn)/2/Math.PI+.5,ln=an(rn)/Math.PI+.5;Fe.push(sn,1-ln)}Br(),or()}function or(){for(var rn=0;rn<Fe.length;rn+=6){var on=Fe[rn+0],sn=Fe[rn+2],ln=Fe[rn+4],cn=Math.max(on,sn,ln),hn=Math.min(on,sn,ln);cn>.9&&hn<.1&&(on<.2&&(Fe[rn+0]+=1),sn<.2&&(Fe[rn+2]+=1),ln<.2&&(Fe[rn+4]+=1))}}function sr(rn){Ve.push(rn.x,rn.y,rn.z)}function cr(rn,on){var sn=rn*3;on.x=$e[sn+0],on.y=$e[sn+1],on.z=$e[sn+2]}function Br(){for(var rn=new Vector3,on=new Vector3,sn=new Vector3,ln=new Vector3,cn=new Vector2,hn=new Vector2,mn=new Vector2,An=0,xn=0;An<Ve.length;An+=9,xn+=6){rn.set(Ve[An+0],Ve[An+1],Ve[An+2]),on.set(Ve[An+3],Ve[An+4],Ve[An+5]),sn.set(Ve[An+6],Ve[An+7],Ve[An+8]),cn.set(Fe[xn+0],Fe[xn+1]),hn.set(Fe[xn+2],Fe[xn+3]),mn.set(Fe[xn+4],Fe[xn+5]),ln.copy(rn).add(on).add(sn).divideScalar(3);var pn=en(ln);tn(cn,xn+0,rn,pn),tn(hn,xn+2,on,pn),tn(mn,xn+4,sn,pn)}}function tn(rn,on,sn,ln){ln<0&&rn.x===1&&(Fe[on]=rn.x-1),sn.x===0&&sn.z===0&&(Fe[on]=ln/2/Math.PI+.5)}function en(rn){return Math.atan2(rn.z,-rn.x)}function an(rn){return Math.atan2(-rn.y,Math.sqrt(rn.x*rn.x+rn.z*rn.z))}}PolyhedronBufferGeometry.prototype=Object.create(BufferGeometry.prototype);PolyhedronBufferGeometry.prototype.constructor=PolyhedronBufferGeometry;function TetrahedronGeometry($e,Se){Geometry.call(this),this.type="TetrahedronGeometry",this.parameters={radius:$e,detail:Se},this.fromBufferGeometry(new TetrahedronBufferGeometry($e,Se)),this.mergeVertices()}TetrahedronGeometry.prototype=Object.create(Geometry.prototype);TetrahedronGeometry.prototype.constructor=TetrahedronGeometry;function TetrahedronBufferGeometry($e,Se){var Be=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],De=[2,1,0,0,3,2,1,3,0,2,3,1];PolyhedronBufferGeometry.call(this,Be,De,$e,Se),this.type="TetrahedronBufferGeometry",this.parameters={radius:$e,detail:Se}}TetrahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype);TetrahedronBufferGeometry.prototype.constructor=TetrahedronBufferGeometry;function OctahedronGeometry($e,Se){Geometry.call(this),this.type="OctahedronGeometry",this.parameters={radius:$e,detail:Se},this.fromBufferGeometry(new OctahedronBufferGeometry($e,Se)),this.mergeVertices()}OctahedronGeometry.prototype=Object.create(Geometry.prototype);OctahedronGeometry.prototype.constructor=OctahedronGeometry;function OctahedronBufferGeometry($e,Se){var Be=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],De=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];PolyhedronBufferGeometry.call(this,Be,De,$e,Se),this.type="OctahedronBufferGeometry",this.parameters={radius:$e,detail:Se}}OctahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype);OctahedronBufferGeometry.prototype.constructor=OctahedronBufferGeometry;function IcosahedronGeometry($e,Se){Geometry.call(this),this.type="IcosahedronGeometry",this.parameters={radius:$e,detail:Se},this.fromBufferGeometry(new IcosahedronBufferGeometry($e,Se)),this.mergeVertices()}IcosahedronGeometry.prototype=Object.create(Geometry.prototype);IcosahedronGeometry.prototype.constructor=IcosahedronGeometry;function IcosahedronBufferGeometry($e,Se){var Be=(1+Math.sqrt(5))/2,De=[-1,Be,0,1,Be,0,-1,-Be,0,1,-Be,0,0,-1,Be,0,1,Be,0,-1,-Be,0,1,-Be,Be,0,-1,Be,0,1,-Be,0,-1,-Be,0,1],Ve=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];PolyhedronBufferGeometry.call(this,De,Ve,$e,Se),this.type="IcosahedronBufferGeometry",this.parameters={radius:$e,detail:Se}}IcosahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype);IcosahedronBufferGeometry.prototype.constructor=IcosahedronBufferGeometry;function DodecahedronGeometry($e,Se){Geometry.call(this),this.type="DodecahedronGeometry",this.parameters={radius:$e,detail:Se},this.fromBufferGeometry(new DodecahedronBufferGeometry($e,Se)),this.mergeVertices()}DodecahedronGeometry.prototype=Object.create(Geometry.prototype);DodecahedronGeometry.prototype.constructor=DodecahedronGeometry;function DodecahedronBufferGeometry($e,Se){var Be=(1+Math.sqrt(5))/2,De=1/Be,Ve=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-De,-Be,0,-De,Be,0,De,-Be,0,De,Be,-De,-Be,0,-De,Be,0,De,-Be,0,De,Be,0,-Be,0,-De,Be,0,-De,-Be,0,De,Be,0,De],Fe=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];PolyhedronBufferGeometry.call(this,Ve,Fe,$e,Se),this.type="DodecahedronBufferGeometry",this.parameters={radius:$e,detail:Se}}DodecahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype);DodecahedronBufferGeometry.prototype.constructor=DodecahedronBufferGeometry;function TubeGeometry($e,Se,Be,De,Ve,Fe){Geometry.call(this),this.type="TubeGeometry",this.parameters={path:$e,tubularSegments:Se,radius:Be,radialSegments:De,closed:Ve},Fe!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var Je=new TubeBufferGeometry($e,Se,Be,De,Ve);this.tangents=Je.tangents,this.normals=Je.normals,this.binormals=Je.binormals,this.fromBufferGeometry(Je),this.mergeVertices()}TubeGeometry.prototype=Object.create(Geometry.prototype);TubeGeometry.prototype.constructor=TubeGeometry;function TubeBufferGeometry($e,Se,Be,De,Ve){BufferGeometry.call(this),this.type="TubeBufferGeometry",this.parameters={path:$e,tubularSegments:Se,radius:Be,radialSegments:De,closed:Ve},Se=Se||64,Be=Be||1,De=De||8,Ve=Ve||!1;var Fe=$e.computeFrenetFrames(Se,Ve);this.tangents=Fe.tangents,this.normals=Fe.normals,this.binormals=Fe.binormals;var Je=new Vector3,Xe=new Vector3,Ke=new Vector2,Ye=new Vector3,or,sr,cr=[],Br=[],tn=[],en=[];an(),this.setIndex(en),this.setAttribute("position",new Float32BufferAttribute(cr,3)),this.setAttribute("normal",new Float32BufferAttribute(Br,3)),this.setAttribute("uv",new Float32BufferAttribute(tn,2));function an(){for(or=0;or<Se;or++)rn(or);rn(Ve===!1?Se:0),sn(),on()}function rn(ln){Ye=$e.getPointAt(ln/Se,Ye);var cn=Fe.normals[ln],hn=Fe.binormals[ln];for(sr=0;sr<=De;sr++){var mn=sr/De*Math.PI*2,An=Math.sin(mn),xn=-Math.cos(mn);Xe.x=xn*cn.x+An*hn.x,Xe.y=xn*cn.y+An*hn.y,Xe.z=xn*cn.z+An*hn.z,Xe.normalize(),Br.push(Xe.x,Xe.y,Xe.z),Je.x=Ye.x+Be*Xe.x,Je.y=Ye.y+Be*Xe.y,Je.z=Ye.z+Be*Xe.z,cr.push(Je.x,Je.y,Je.z)}}function on(){for(sr=1;sr<=Se;sr++)for(or=1;or<=De;or++){var ln=(De+1)*(sr-1)+(or-1),cn=(De+1)*sr+(or-1),hn=(De+1)*sr+or,mn=(De+1)*(sr-1)+or;en.push(ln,cn,mn),en.push(cn,hn,mn)}}function sn(){for(or=0;or<=Se;or++)for(sr=0;sr<=De;sr++)Ke.x=or/Se,Ke.y=sr/De,tn.push(Ke.x,Ke.y)}}TubeBufferGeometry.prototype=Object.create(BufferGeometry.prototype);TubeBufferGeometry.prototype.constructor=TubeBufferGeometry;TubeBufferGeometry.prototype.toJSON=function(){var $e=BufferGeometry.prototype.toJSON.call(this);return $e.path=this.parameters.path.toJSON(),$e};function TorusKnotGeometry($e,Se,Be,De,Ve,Fe,Je){Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:$e,tube:Se,tubularSegments:Be,radialSegments:De,p:Ve,q:Fe},Je!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new TorusKnotBufferGeometry($e,Se,Be,De,Ve,Fe)),this.mergeVertices()}TorusKnotGeometry.prototype=Object.create(Geometry.prototype);TorusKnotGeometry.prototype.constructor=TorusKnotGeometry;function TorusKnotBufferGeometry($e,Se,Be,De,Ve,Fe){BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:$e,tube:Se,tubularSegments:Be,radialSegments:De,p:Ve,q:Fe},$e=$e||1,Se=Se||.4,Be=Math.floor(Be)||64,De=Math.floor(De)||8,Ve=Ve||2,Fe=Fe||3;var Je=[],Xe=[],Ke=[],Ye=[],or,sr,cr=new Vector3,Br=new Vector3,tn=new Vector3,en=new Vector3,an=new Vector3,rn=new Vector3,on=new Vector3;for(or=0;or<=Be;++or){var sn=or/Be*Ve*Math.PI*2;for(dn(sn,Ve,Fe,$e,tn),dn(sn+.01,Ve,Fe,$e,en),rn.subVectors(en,tn),on.addVectors(en,tn),an.crossVectors(rn,on),on.crossVectors(an,rn),an.normalize(),on.normalize(),sr=0;sr<=De;++sr){var ln=sr/De*Math.PI*2,cn=-Se*Math.cos(ln),hn=Se*Math.sin(ln);cr.x=tn.x+(cn*on.x+hn*an.x),cr.y=tn.y+(cn*on.y+hn*an.y),cr.z=tn.z+(cn*on.z+hn*an.z),Xe.push(cr.x,cr.y,cr.z),Br.subVectors(cr,tn).normalize(),Ke.push(Br.x,Br.y,Br.z),Ye.push(or/Be),Ye.push(sr/De)}}for(sr=1;sr<=Be;sr++)for(or=1;or<=De;or++){var mn=(De+1)*(sr-1)+(or-1),An=(De+1)*sr+(or-1),xn=(De+1)*sr+or,pn=(De+1)*(sr-1)+or;Je.push(mn,An,pn),Je.push(An,xn,pn)}this.setIndex(Je),this.setAttribute("position",new Float32BufferAttribute(Xe,3)),this.setAttribute("normal",new Float32BufferAttribute(Ke,3)),this.setAttribute("uv",new Float32BufferAttribute(Ye,2));function dn(fn,yn,Sn,gn,Cn){var Mn=Math.cos(fn),Bn=Math.sin(fn),kn=Sn/yn*fn,Ln=Math.cos(kn);Cn.x=gn*(2+Ln)*.5*Mn,Cn.y=gn*(2+Ln)*Bn*.5,Cn.z=gn*Math.sin(kn)*.5}}TorusKnotBufferGeometry.prototype=Object.create(BufferGeometry.prototype);TorusKnotBufferGeometry.prototype.constructor=TorusKnotBufferGeometry;function TorusGeometry($e,Se,Be,De,Ve){Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:$e,tube:Se,radialSegments:Be,tubularSegments:De,arc:Ve},this.fromBufferGeometry(new TorusBufferGeometry($e,Se,Be,De,Ve)),this.mergeVertices()}TorusGeometry.prototype=Object.create(Geometry.prototype);TorusGeometry.prototype.constructor=TorusGeometry;function TorusBufferGeometry($e,Se,Be,De,Ve){BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:$e,tube:Se,radialSegments:Be,tubularSegments:De,arc:Ve},$e=$e||1,Se=Se||.4,Be=Math.floor(Be)||8,De=Math.floor(De)||6,Ve=Ve||Math.PI*2;var Fe=[],Je=[],Xe=[],Ke=[],Ye=new Vector3,or=new Vector3,sr=new Vector3,cr,Br;for(cr=0;cr<=Be;cr++)for(Br=0;Br<=De;Br++){var tn=Br/De*Ve,en=cr/Be*Math.PI*2;or.x=($e+Se*Math.cos(en))*Math.cos(tn),or.y=($e+Se*Math.cos(en))*Math.sin(tn),or.z=Se*Math.sin(en),Je.push(or.x,or.y,or.z),Ye.x=$e*Math.cos(tn),Ye.y=$e*Math.sin(tn),sr.subVectors(or,Ye).normalize(),Xe.push(sr.x,sr.y,sr.z),Ke.push(Br/De),Ke.push(cr/Be)}for(cr=1;cr<=Be;cr++)for(Br=1;Br<=De;Br++){var an=(De+1)*cr+Br-1,rn=(De+1)*(cr-1)+Br-1,on=(De+1)*(cr-1)+Br,sn=(De+1)*cr+Br;Fe.push(an,rn,sn),Fe.push(rn,on,sn)}this.setIndex(Fe),this.setAttribute("position",new Float32BufferAttribute(Je,3)),this.setAttribute("normal",new Float32BufferAttribute(Xe,3)),this.setAttribute("uv",new Float32BufferAttribute(Ke,2))}TorusBufferGeometry.prototype=Object.create(BufferGeometry.prototype);TorusBufferGeometry.prototype.constructor=TorusBufferGeometry;var Earcut={triangulate:function($e,Se,Be){Be=Be||2;var De=Se&&Se.length,Ve=De?Se[0]*Be:$e.length,Fe=linkedList($e,0,Ve,Be,!0),Je=[];if(!Fe||Fe.next===Fe.prev)return Je;var Xe,Ke,Ye,or,sr,cr,Br;if(De&&(Fe=eliminateHoles($e,Se,Fe,Be)),$e.length>80*Be){Xe=Ye=$e[0],Ke=or=$e[1];for(var tn=Be;tn<Ve;tn+=Be)sr=$e[tn],cr=$e[tn+1],sr<Xe&&(Xe=sr),cr<Ke&&(Ke=cr),sr>Ye&&(Ye=sr),cr>or&&(or=cr);Br=Math.max(Ye-Xe,or-Ke),Br=Br!==0?1/Br:0}return earcutLinked(Fe,Je,Be,Xe,Ke,Br),Je}};function linkedList($e,Se,Be,De,Ve){var Fe,Je;if(Ve===signedArea($e,Se,Be,De)>0)for(Fe=Se;Fe<Be;Fe+=De)Je=insertNode(Fe,$e[Fe],$e[Fe+1],Je);else for(Fe=Be-De;Fe>=Se;Fe-=De)Je=insertNode(Fe,$e[Fe],$e[Fe+1],Je);return Je&&equals(Je,Je.next)&&(removeNode(Je),Je=Je.next),Je}function filterPoints($e,Se){if(!$e)return $e;Se||(Se=$e);var Be=$e,De;do if(De=!1,!Be.steiner&&(equals(Be,Be.next)||area(Be.prev,Be,Be.next)===0)){if(removeNode(Be),Be=Se=Be.prev,Be===Be.next)break;De=!0}else Be=Be.next;while(De||Be!==Se);return Se}function earcutLinked($e,Se,Be,De,Ve,Fe,Je){if($e){!Je&&Fe&&indexCurve($e,De,Ve,Fe);for(var Xe=$e,Ke,Ye;$e.prev!==$e.next;){if(Ke=$e.prev,Ye=$e.next,Fe?isEarHashed($e,De,Ve,Fe):isEar($e)){Se.push(Ke.i/Be),Se.push($e.i/Be),Se.push(Ye.i/Be),removeNode($e),$e=Ye.next,Xe=Ye.next;continue}if($e=Ye,$e===Xe){Je?Je===1?($e=cureLocalIntersections(filterPoints($e),Se,Be),earcutLinked($e,Se,Be,De,Ve,Fe,2)):Je===2&&splitEarcut($e,Se,Be,De,Ve,Fe):earcutLinked(filterPoints($e),Se,Be,De,Ve,Fe,1);break}}}}function isEar($e){var Se=$e.prev,Be=$e,De=$e.next;if(area(Se,Be,De)>=0)return!1;for(var Ve=$e.next.next;Ve!==$e.prev;){if(pointInTriangle(Se.x,Se.y,Be.x,Be.y,De.x,De.y,Ve.x,Ve.y)&&area(Ve.prev,Ve,Ve.next)>=0)return!1;Ve=Ve.next}return!0}function isEarHashed($e,Se,Be,De){var Ve=$e.prev,Fe=$e,Je=$e.next;if(area(Ve,Fe,Je)>=0)return!1;for(var Xe=Ve.x<Fe.x?Ve.x<Je.x?Ve.x:Je.x:Fe.x<Je.x?Fe.x:Je.x,Ke=Ve.y<Fe.y?Ve.y<Je.y?Ve.y:Je.y:Fe.y<Je.y?Fe.y:Je.y,Ye=Ve.x>Fe.x?Ve.x>Je.x?Ve.x:Je.x:Fe.x>Je.x?Fe.x:Je.x,or=Ve.y>Fe.y?Ve.y>Je.y?Ve.y:Je.y:Fe.y>Je.y?Fe.y:Je.y,sr=zOrder(Xe,Ke,Se,Be,De),cr=zOrder(Ye,or,Se,Be,De),Br=$e.prevZ,tn=$e.nextZ;Br&&Br.z>=sr&&tn&&tn.z<=cr;){if(Br!==$e.prev&&Br!==$e.next&&pointInTriangle(Ve.x,Ve.y,Fe.x,Fe.y,Je.x,Je.y,Br.x,Br.y)&&area(Br.prev,Br,Br.next)>=0||(Br=Br.prevZ,tn!==$e.prev&&tn!==$e.next&&pointInTriangle(Ve.x,Ve.y,Fe.x,Fe.y,Je.x,Je.y,tn.x,tn.y)&&area(tn.prev,tn,tn.next)>=0))return!1;tn=tn.nextZ}for(;Br&&Br.z>=sr;){if(Br!==$e.prev&&Br!==$e.next&&pointInTriangle(Ve.x,Ve.y,Fe.x,Fe.y,Je.x,Je.y,Br.x,Br.y)&&area(Br.prev,Br,Br.next)>=0)return!1;Br=Br.prevZ}for(;tn&&tn.z<=cr;){if(tn!==$e.prev&&tn!==$e.next&&pointInTriangle(Ve.x,Ve.y,Fe.x,Fe.y,Je.x,Je.y,tn.x,tn.y)&&area(tn.prev,tn,tn.next)>=0)return!1;tn=tn.nextZ}return!0}function cureLocalIntersections($e,Se,Be){var De=$e;do{var Ve=De.prev,Fe=De.next.next;!equals(Ve,Fe)&&intersects(Ve,De,De.next,Fe)&&locallyInside(Ve,Fe)&&locallyInside(Fe,Ve)&&(Se.push(Ve.i/Be),Se.push(De.i/Be),Se.push(Fe.i/Be),removeNode(De),removeNode(De.next),De=$e=Fe),De=De.next}while(De!==$e);return filterPoints(De)}function splitEarcut($e,Se,Be,De,Ve,Fe){var Je=$e;do{for(var Xe=Je.next.next;Xe!==Je.prev;){if(Je.i!==Xe.i&&isValidDiagonal(Je,Xe)){var Ke=splitPolygon(Je,Xe);Je=filterPoints(Je,Je.next),Ke=filterPoints(Ke,Ke.next),earcutLinked(Je,Se,Be,De,Ve,Fe),earcutLinked(Ke,Se,Be,De,Ve,Fe);return}Xe=Xe.next}Je=Je.next}while(Je!==$e)}function eliminateHoles($e,Se,Be,De){var Ve=[],Fe,Je,Xe,Ke,Ye;for(Fe=0,Je=Se.length;Fe<Je;Fe++)Xe=Se[Fe]*De,Ke=Fe<Je-1?Se[Fe+1]*De:$e.length,Ye=linkedList($e,Xe,Ke,De,!1),Ye===Ye.next&&(Ye.steiner=!0),Ve.push(getLeftmost(Ye));for(Ve.sort(compareX),Fe=0;Fe<Ve.length;Fe++)eliminateHole(Ve[Fe],Be),Be=filterPoints(Be,Be.next);return Be}function compareX($e,Se){return $e.x-Se.x}function eliminateHole($e,Se){if(Se=findHoleBridge($e,Se),Se){var Be=splitPolygon(Se,$e);filterPoints(Se,Se.next),filterPoints(Be,Be.next)}}function findHoleBridge($e,Se){var Be=Se,De=$e.x,Ve=$e.y,Fe=-1/0,Je;do{if(Ve<=Be.y&&Ve>=Be.next.y&&Be.next.y!==Be.y){var Xe=Be.x+(Ve-Be.y)*(Be.next.x-Be.x)/(Be.next.y-Be.y);if(Xe<=De&&Xe>Fe){if(Fe=Xe,Xe===De){if(Ve===Be.y)return Be;if(Ve===Be.next.y)return Be.next}Je=Be.x<Be.next.x?Be:Be.next}}Be=Be.next}while(Be!==Se);if(!Je)return null;if(De===Fe)return Je;var Ke=Je,Ye=Je.x,or=Je.y,sr=1/0,cr;Be=Je;do De>=Be.x&&Be.x>=Ye&&De!==Be.x&&pointInTriangle(Ve<or?De:Fe,Ve,Ye,or,Ve<or?Fe:De,Ve,Be.x,Be.y)&&(cr=Math.abs(Ve-Be.y)/(De-Be.x),locallyInside(Be,$e)&&(cr<sr||cr===sr&&(Be.x>Je.x||Be.x===Je.x&&sectorContainsSector(Je,Be)))&&(Je=Be,sr=cr)),Be=Be.next;while(Be!==Ke);return Je}function sectorContainsSector($e,Se){return area($e.prev,$e,Se.prev)<0&&area(Se.next,$e,$e.next)<0}function indexCurve($e,Se,Be,De){var Ve=$e;do Ve.z===null&&(Ve.z=zOrder(Ve.x,Ve.y,Se,Be,De)),Ve.prevZ=Ve.prev,Ve.nextZ=Ve.next,Ve=Ve.next;while(Ve!==$e);Ve.prevZ.nextZ=null,Ve.prevZ=null,sortLinked(Ve)}function sortLinked($e){var Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye=1;do{for(Be=$e,$e=null,Fe=null,Je=0;Be;){for(Je++,De=Be,Xe=0,Se=0;Se<Ye&&(Xe++,De=De.nextZ,!!De);Se++);for(Ke=Ye;Xe>0||Ke>0&&De;)Xe!==0&&(Ke===0||!De||Be.z<=De.z)?(Ve=Be,Be=Be.nextZ,Xe--):(Ve=De,De=De.nextZ,Ke--),Fe?Fe.nextZ=Ve:$e=Ve,Ve.prevZ=Fe,Fe=Ve;Be=De}Fe.nextZ=null,Ye*=2}while(Je>1);return $e}function zOrder($e,Se,Be,De,Ve){return $e=32767*($e-Be)*Ve,Se=32767*(Se-De)*Ve,$e=($e|$e<<8)&16711935,$e=($e|$e<<4)&252645135,$e=($e|$e<<2)&858993459,$e=($e|$e<<1)&1431655765,Se=(Se|Se<<8)&16711935,Se=(Se|Se<<4)&252645135,Se=(Se|Se<<2)&858993459,Se=(Se|Se<<1)&1431655765,$e|Se<<1}function getLeftmost($e){var Se=$e,Be=$e;do(Se.x<Be.x||Se.x===Be.x&&Se.y<Be.y)&&(Be=Se),Se=Se.next;while(Se!==$e);return Be}function pointInTriangle($e,Se,Be,De,Ve,Fe,Je,Xe){return(Ve-Je)*(Se-Xe)-($e-Je)*(Fe-Xe)>=0&&($e-Je)*(De-Xe)-(Be-Je)*(Se-Xe)>=0&&(Be-Je)*(Fe-Xe)-(Ve-Je)*(De-Xe)>=0}function isValidDiagonal($e,Se){return $e.next.i!==Se.i&&$e.prev.i!==Se.i&&!intersectsPolygon($e,Se)&&(locallyInside($e,Se)&&locallyInside(Se,$e)&&middleInside($e,Se)&&(area($e.prev,$e,Se.prev)||area($e,Se.prev,Se))||equals($e,Se)&&area($e.prev,$e,$e.next)>0&&area(Se.prev,Se,Se.next)>0)}function area($e,Se,Be){return(Se.y-$e.y)*(Be.x-Se.x)-(Se.x-$e.x)*(Be.y-Se.y)}function equals($e,Se){return $e.x===Se.x&&$e.y===Se.y}function intersects($e,Se,Be,De){var Ve=sign(area($e,Se,Be)),Fe=sign(area($e,Se,De)),Je=sign(area(Be,De,$e)),Xe=sign(area(Be,De,Se));return!!(Ve!==Fe&&Je!==Xe||Ve===0&&onSegment($e,Be,Se)||Fe===0&&onSegment($e,De,Se)||Je===0&&onSegment(Be,$e,De)||Xe===0&&onSegment(Be,Se,De))}function onSegment($e,Se,Be){return Se.x<=Math.max($e.x,Be.x)&&Se.x>=Math.min($e.x,Be.x)&&Se.y<=Math.max($e.y,Be.y)&&Se.y>=Math.min($e.y,Be.y)}function sign($e){return $e>0?1:$e<0?-1:0}function intersectsPolygon($e,Se){var Be=$e;do{if(Be.i!==$e.i&&Be.next.i!==$e.i&&Be.i!==Se.i&&Be.next.i!==Se.i&&intersects(Be,Be.next,$e,Se))return!0;Be=Be.next}while(Be!==$e);return!1}function locallyInside($e,Se){return area($e.prev,$e,$e.next)<0?area($e,Se,$e.next)>=0&&area($e,$e.prev,Se)>=0:area($e,Se,$e.prev)<0||area($e,$e.next,Se)<0}function middleInside($e,Se){var Be=$e,De=!1,Ve=($e.x+Se.x)/2,Fe=($e.y+Se.y)/2;do Be.y>Fe!=Be.next.y>Fe&&Be.next.y!==Be.y&&Ve<(Be.next.x-Be.x)*(Fe-Be.y)/(Be.next.y-Be.y)+Be.x&&(De=!De),Be=Be.next;while(Be!==$e);return De}function splitPolygon($e,Se){var Be=new Node($e.i,$e.x,$e.y),De=new Node(Se.i,Se.x,Se.y),Ve=$e.next,Fe=Se.prev;return $e.next=Se,Se.prev=$e,Be.next=Ve,Ve.prev=Be,De.next=Be,Be.prev=De,Fe.next=De,De.prev=Fe,De}function insertNode($e,Se,Be,De){var Ve=new Node($e,Se,Be);return De?(Ve.next=De.next,Ve.prev=De,De.next.prev=Ve,De.next=Ve):(Ve.prev=Ve,Ve.next=Ve),Ve}function removeNode($e){$e.next.prev=$e.prev,$e.prev.next=$e.next,$e.prevZ&&($e.prevZ.nextZ=$e.nextZ),$e.nextZ&&($e.nextZ.prevZ=$e.prevZ)}function Node($e,Se,Be){this.i=$e,this.x=Se,this.y=Be,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea($e,Se,Be,De){for(var Ve=0,Fe=Se,Je=Be-De;Fe<Be;Fe+=De)Ve+=($e[Je]-$e[Fe])*($e[Fe+1]+$e[Je+1]),Je=Fe;return Ve}var ShapeUtils={area:function($e){for(var Se=$e.length,Be=0,De=Se-1,Ve=0;Ve<Se;De=Ve++)Be+=$e[De].x*$e[Ve].y-$e[Ve].x*$e[De].y;return Be*.5},isClockWise:function($e){return ShapeUtils.area($e)<0},triangulateShape:function($e,Se){var Be=[],De=[],Ve=[];removeDupEndPts($e),addContour(Be,$e);var Fe=$e.length;Se.forEach(removeDupEndPts);for(var Je=0;Je<Se.length;Je++)De.push(Fe),Fe+=Se[Je].length,addContour(Be,Se[Je]);for(var Xe=Earcut.triangulate(Be,De),Je=0;Je<Xe.length;Je+=3)Ve.push(Xe.slice(Je,Je+3));return Ve}};function removeDupEndPts($e){var Se=$e.length;Se>2&&$e[Se-1].equals($e[0])&&$e.pop()}function addContour($e,Se){for(var Be=0;Be<Se.length;Be++)$e.push(Se[Be].x),$e.push(Se[Be].y)}function ExtrudeGeometry($e,Se){Geometry.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:$e,options:Se},this.fromBufferGeometry(new ExtrudeBufferGeometry($e,Se)),this.mergeVertices()}ExtrudeGeometry.prototype=Object.create(Geometry.prototype);ExtrudeGeometry.prototype.constructor=ExtrudeGeometry;ExtrudeGeometry.prototype.toJSON=function(){var $e=Geometry.prototype.toJSON.call(this),Se=this.parameters.shapes,Be=this.parameters.options;return toJSON(Se,Be,$e)};function ExtrudeBufferGeometry($e,Se){BufferGeometry.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:$e,options:Se},$e=Array.isArray($e)?$e:[$e];for(var Be=this,De=[],Ve=[],Fe=0,Je=$e.length;Fe<Je;Fe++){var Xe=$e[Fe];Ke(Xe)}this.setAttribute("position",new Float32BufferAttribute(De,3)),this.setAttribute("uv",new Float32BufferAttribute(Ve,2)),this.computeVertexNormals();function Ke(Ye){var or=[],sr=Se.curveSegments!==void 0?Se.curveSegments:12,cr=Se.steps!==void 0?Se.steps:1,Br=Se.depth!==void 0?Se.depth:100,tn=Se.bevelEnabled!==void 0?Se.bevelEnabled:!0,en=Se.bevelThickness!==void 0?Se.bevelThickness:6,an=Se.bevelSize!==void 0?Se.bevelSize:en-2,rn=Se.bevelOffset!==void 0?Se.bevelOffset:0,on=Se.bevelSegments!==void 0?Se.bevelSegments:3,sn=Se.extrudePath,ln=Se.UVGenerator!==void 0?Se.UVGenerator:WorldUVGenerator;Se.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),Br=Se.amount);var cn,hn=!1,mn,An,xn,pn;sn&&(cn=sn.getSpacedPoints(cr),hn=!0,tn=!1,mn=sn.computeFrenetFrames(cr,!1),An=new Vector3,xn=new Vector3,pn=new Vector3),tn||(on=0,en=0,an=0,rn=0);var dn,fn,yn,Sn=Ye.extractPoints(sr),gn=Sn.shape,Cn=Sn.holes,Mn=!ShapeUtils.isClockWise(gn);if(Mn)for(gn=gn.reverse(),fn=0,yn=Cn.length;fn<yn;fn++)dn=Cn[fn],ShapeUtils.isClockWise(dn)&&(Cn[fn]=dn.reverse());var Bn=ShapeUtils.triangulateShape(gn,Cn),kn=gn;for(fn=0,yn=Cn.length;fn<yn;fn++)dn=Cn[fn],gn=gn.concat(dn);function Ln(_i,Mi,$i){return Mi||console.error("THREE.ExtrudeGeometry: vec does not exist"),Mi.clone().multiplyScalar($i).add(_i)}var Pn,Vn,Yn,ni,Rn,In=gn.length,Gn,Fn=Bn.length;function Hn(_i,Mi,$i){var vi,ri,Ti,Bi=_i.x-Mi.x,qi=_i.y-Mi.y,Ii=$i.x-_i.x,Ui=$i.y-_i.y,ho=Bi*Bi+qi*qi,lo=Bi*Ui-qi*Ii;if(Math.abs(lo)>Number.EPSILON){var po=Math.sqrt(ho),co=Math.sqrt(Ii*Ii+Ui*Ui),go=Mi.x-qi/po,vo=Mi.y+Bi/po,Eo=$i.x-Ui/co,Oo=$i.y+Ii/co,Bo=((Eo-go)*Ui-(Oo-vo)*Ii)/(Bi*Ui-qi*Ii);vi=go+Bi*Bo-_i.x,ri=vo+qi*Bo-_i.y;var Po=vi*vi+ri*ri;if(Po<=2)return new Vector2(vi,ri);Ti=Math.sqrt(Po/2)}else{var Kn=!1;Bi>Number.EPSILON?Ii>Number.EPSILON&&(Kn=!0):Bi<-Number.EPSILON?Ii<-Number.EPSILON&&(Kn=!0):Math.sign(qi)===Math.sign(Ui)&&(Kn=!0),Kn?(vi=-qi,ri=Bi,Ti=Math.sqrt(ho)):(vi=Bi,ri=qi,Ti=Math.sqrt(ho/2))}return new Vector2(vi/Ti,ri/Ti)}for(var Dn=[],zn=0,Qn=kn.length,Zn=Qn-1,si=zn+1;zn<Qn;zn++,Zn++,si++)Zn===Qn&&(Zn=0),si===Qn&&(si=0),Dn[zn]=Hn(kn[zn],kn[Zn],kn[si]);var ei=[],hi,Un=Dn.concat();for(fn=0,yn=Cn.length;fn<yn;fn++){for(dn=Cn[fn],hi=[],zn=0,Qn=dn.length,Zn=Qn-1,si=zn+1;zn<Qn;zn++,Zn++,si++)Zn===Qn&&(Zn=0),si===Qn&&(si=0),hi[zn]=Hn(dn[zn],dn[Zn],dn[si]);ei.push(hi),Un=Un.concat(hi)}for(Pn=0;Pn<on;Pn++){for(Yn=Pn/on,ni=en*Math.cos(Yn*Math.PI/2),Vn=an*Math.sin(Yn*Math.PI/2)+rn,zn=0,Qn=kn.length;zn<Qn;zn++)Rn=Ln(kn[zn],Dn[zn],Vn),ai(Rn.x,Rn.y,-ni);for(fn=0,yn=Cn.length;fn<yn;fn++)for(dn=Cn[fn],hi=ei[fn],zn=0,Qn=dn.length;zn<Qn;zn++)Rn=Ln(dn[zn],hi[zn],Vn),ai(Rn.x,Rn.y,-ni)}for(Vn=an+rn,zn=0;zn<In;zn++)Rn=tn?Ln(gn[zn],Un[zn],Vn):gn[zn],hn?(xn.copy(mn.normals[0]).multiplyScalar(Rn.x),An.copy(mn.binormals[0]).multiplyScalar(Rn.y),pn.copy(cn[0]).add(xn).add(An),ai(pn.x,pn.y,pn.z)):ai(Rn.x,Rn.y,0);var Wn;for(Wn=1;Wn<=cr;Wn++)for(zn=0;zn<In;zn++)Rn=tn?Ln(gn[zn],Un[zn],Vn):gn[zn],hn?(xn.copy(mn.normals[Wn]).multiplyScalar(Rn.x),An.copy(mn.binormals[Wn]).multiplyScalar(Rn.y),pn.copy(cn[Wn]).add(xn).add(An),ai(pn.x,pn.y,pn.z)):ai(Rn.x,Rn.y,Br/cr*Wn);for(Pn=on-1;Pn>=0;Pn--){for(Yn=Pn/on,ni=en*Math.cos(Yn*Math.PI/2),Vn=an*Math.sin(Yn*Math.PI/2)+rn,zn=0,Qn=kn.length;zn<Qn;zn++)Rn=Ln(kn[zn],Dn[zn],Vn),ai(Rn.x,Rn.y,Br+ni);for(fn=0,yn=Cn.length;fn<yn;fn++)for(dn=Cn[fn],hi=ei[fn],zn=0,Qn=dn.length;zn<Qn;zn++)Rn=Ln(dn[zn],hi[zn],Vn),hn?ai(Rn.x,Rn.y+cn[cr-1].y,cn[cr-1].x+ni):ai(Rn.x,Rn.y,Br+ni)}Ai(),oi();function Ai(){var _i=De.length/3;if(tn){var Mi=0,$i=In*Mi;for(zn=0;zn<Fn;zn++)Gn=Bn[zn],wi(Gn[2]+$i,Gn[1]+$i,Gn[0]+$i);for(Mi=cr+on*2,$i=In*Mi,zn=0;zn<Fn;zn++)Gn=Bn[zn],wi(Gn[0]+$i,Gn[1]+$i,Gn[2]+$i)}else{for(zn=0;zn<Fn;zn++)Gn=Bn[zn],wi(Gn[2],Gn[1],Gn[0]);for(zn=0;zn<Fn;zn++)Gn=Bn[zn],wi(Gn[0]+In*cr,Gn[1]+In*cr,Gn[2]+In*cr)}Be.addGroup(_i,De.length/3-_i,0)}function oi(){var _i=De.length/3,Mi=0;for(ci(kn,Mi),Mi+=kn.length,fn=0,yn=Cn.length;fn<yn;fn++)dn=Cn[fn],ci(dn,Mi),Mi+=dn.length;Be.addGroup(_i,De.length/3-_i,1)}function ci(_i,Mi){var $i,vi;for(zn=_i.length;--zn>=0;){$i=zn,vi=zn-1,vi<0&&(vi=_i.length-1);var ri=0,Ti=cr+on*2;for(ri=0;ri<Ti;ri++){var Bi=In*ri,qi=In*(ri+1),Ii=Mi+$i+Bi,Ui=Mi+vi+Bi,ho=Mi+vi+qi,lo=Mi+$i+qi;Pi(Ii,Ui,ho,lo)}}}function ai(_i,Mi,$i){or.push(_i),or.push(Mi),or.push($i)}function wi(_i,Mi,$i){Oi(_i),Oi(Mi),Oi($i);var vi=De.length/3,ri=ln.generateTopUV(Be,De,vi-3,vi-2,vi-1);Ri(ri[0]),Ri(ri[1]),Ri(ri[2])}function Pi(_i,Mi,$i,vi){Oi(_i),Oi(Mi),Oi(vi),Oi(Mi),Oi($i),Oi(vi);var ri=De.length/3,Ti=ln.generateSideWallUV(Be,De,ri-6,ri-3,ri-2,ri-1);Ri(Ti[0]),Ri(Ti[1]),Ri(Ti[3]),Ri(Ti[1]),Ri(Ti[2]),Ri(Ti[3])}function Oi(_i){De.push(or[_i*3+0]),De.push(or[_i*3+1]),De.push(or[_i*3+2])}function Ri(_i){Ve.push(_i.x),Ve.push(_i.y)}}}ExtrudeBufferGeometry.prototype=Object.create(BufferGeometry.prototype);ExtrudeBufferGeometry.prototype.constructor=ExtrudeBufferGeometry;ExtrudeBufferGeometry.prototype.toJSON=function(){var $e=BufferGeometry.prototype.toJSON.call(this),Se=this.parameters.shapes,Be=this.parameters.options;return toJSON(Se,Be,$e)};var WorldUVGenerator={generateTopUV:function($e,Se,Be,De,Ve){var Fe=Se[Be*3],Je=Se[Be*3+1],Xe=Se[De*3],Ke=Se[De*3+1],Ye=Se[Ve*3],or=Se[Ve*3+1];return[new Vector2(Fe,Je),new Vector2(Xe,Ke),new Vector2(Ye,or)]},generateSideWallUV:function($e,Se,Be,De,Ve,Fe){var Je=Se[Be*3],Xe=Se[Be*3+1],Ke=Se[Be*3+2],Ye=Se[De*3],or=Se[De*3+1],sr=Se[De*3+2],cr=Se[Ve*3],Br=Se[Ve*3+1],tn=Se[Ve*3+2],en=Se[Fe*3],an=Se[Fe*3+1],rn=Se[Fe*3+2];return Math.abs(Xe-or)<.01?[new Vector2(Je,1-Ke),new Vector2(Ye,1-sr),new Vector2(cr,1-tn),new Vector2(en,1-rn)]:[new Vector2(Xe,1-Ke),new Vector2(or,1-sr),new Vector2(Br,1-tn),new Vector2(an,1-rn)]}};function toJSON($e,Se,Be){if(Be.shapes=[],Array.isArray($e))for(var De=0,Ve=$e.length;De<Ve;De++){var Fe=$e[De];Be.shapes.push(Fe.uuid)}else Be.shapes.push($e.uuid);return Se.extrudePath!==void 0&&(Be.options.extrudePath=Se.extrudePath.toJSON()),Be}function TextGeometry($e,Se){Geometry.call(this),this.type="TextGeometry",this.parameters={text:$e,parameters:Se},this.fromBufferGeometry(new TextBufferGeometry($e,Se)),this.mergeVertices()}TextGeometry.prototype=Object.create(Geometry.prototype);TextGeometry.prototype.constructor=TextGeometry;function TextBufferGeometry($e,Se){Se=Se||{};var Be=Se.font;if(!(Be&&Be.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Geometry;var De=Be.generateShapes($e,Se.size);Se.depth=Se.height!==void 0?Se.height:50,Se.bevelThickness===void 0&&(Se.bevelThickness=10),Se.bevelSize===void 0&&(Se.bevelSize=8),Se.bevelEnabled===void 0&&(Se.bevelEnabled=!1),ExtrudeBufferGeometry.call(this,De,Se),this.type="TextBufferGeometry"}TextBufferGeometry.prototype=Object.create(ExtrudeBufferGeometry.prototype);TextBufferGeometry.prototype.constructor=TextBufferGeometry;function SphereGeometry($e,Se,Be,De,Ve,Fe,Je){Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:$e,widthSegments:Se,heightSegments:Be,phiStart:De,phiLength:Ve,thetaStart:Fe,thetaLength:Je},this.fromBufferGeometry(new SphereBufferGeometry($e,Se,Be,De,Ve,Fe,Je)),this.mergeVertices()}SphereGeometry.prototype=Object.create(Geometry.prototype);SphereGeometry.prototype.constructor=SphereGeometry;function SphereBufferGeometry($e,Se,Be,De,Ve,Fe,Je){BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:$e,widthSegments:Se,heightSegments:Be,phiStart:De,phiLength:Ve,thetaStart:Fe,thetaLength:Je},$e=$e||1,Se=Math.max(3,Math.floor(Se)||8),Be=Math.max(2,Math.floor(Be)||6),De=De!==void 0?De:0,Ve=Ve!==void 0?Ve:Math.PI*2,Fe=Fe!==void 0?Fe:0,Je=Je!==void 0?Je:Math.PI;var Xe=Math.min(Fe+Je,Math.PI),Ke,Ye,or=0,sr=[],cr=new Vector3,Br=new Vector3,tn=[],en=[],an=[],rn=[];for(Ye=0;Ye<=Be;Ye++){var on=[],sn=Ye/Be,ln=0;for(Ye==0&&Fe==0?ln=.5/Se:Ye==Be&&Xe==Math.PI&&(ln=-.5/Se),Ke=0;Ke<=Se;Ke++){var cn=Ke/Se;cr.x=-$e*Math.cos(De+cn*Ve)*Math.sin(Fe+sn*Je),cr.y=$e*Math.cos(Fe+sn*Je),cr.z=$e*Math.sin(De+cn*Ve)*Math.sin(Fe+sn*Je),en.push(cr.x,cr.y,cr.z),Br.copy(cr).normalize(),an.push(Br.x,Br.y,Br.z),rn.push(cn+ln,1-sn),on.push(or++)}sr.push(on)}for(Ye=0;Ye<Be;Ye++)for(Ke=0;Ke<Se;Ke++){var hn=sr[Ye][Ke+1],mn=sr[Ye][Ke],An=sr[Ye+1][Ke],xn=sr[Ye+1][Ke+1];(Ye!==0||Fe>0)&&tn.push(hn,mn,xn),(Ye!==Be-1||Xe<Math.PI)&&tn.push(mn,An,xn)}this.setIndex(tn),this.setAttribute("position",new Float32BufferAttribute(en,3)),this.setAttribute("normal",new Float32BufferAttribute(an,3)),this.setAttribute("uv",new Float32BufferAttribute(rn,2))}SphereBufferGeometry.prototype=Object.create(BufferGeometry.prototype);SphereBufferGeometry.prototype.constructor=SphereBufferGeometry;function RingGeometry($e,Se,Be,De,Ve,Fe){Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:$e,outerRadius:Se,thetaSegments:Be,phiSegments:De,thetaStart:Ve,thetaLength:Fe},this.fromBufferGeometry(new RingBufferGeometry($e,Se,Be,De,Ve,Fe)),this.mergeVertices()}RingGeometry.prototype=Object.create(Geometry.prototype);RingGeometry.prototype.constructor=RingGeometry;function RingBufferGeometry($e,Se,Be,De,Ve,Fe){BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:$e,outerRadius:Se,thetaSegments:Be,phiSegments:De,thetaStart:Ve,thetaLength:Fe},$e=$e||.5,Se=Se||1,Ve=Ve!==void 0?Ve:0,Fe=Fe!==void 0?Fe:Math.PI*2,Be=Be!==void 0?Math.max(3,Be):8,De=De!==void 0?Math.max(1,De):1;var Je=[],Xe=[],Ke=[],Ye=[],or,sr=$e,cr=(Se-$e)/De,Br=new Vector3,tn=new Vector2,en,an;for(en=0;en<=De;en++){for(an=0;an<=Be;an++)or=Ve+an/Be*Fe,Br.x=sr*Math.cos(or),Br.y=sr*Math.sin(or),Xe.push(Br.x,Br.y,Br.z),Ke.push(0,0,1),tn.x=(Br.x/Se+1)/2,tn.y=(Br.y/Se+1)/2,Ye.push(tn.x,tn.y);sr+=cr}for(en=0;en<De;en++){var rn=en*(Be+1);for(an=0;an<Be;an++){or=an+rn;var on=or,sn=or+Be+1,ln=or+Be+2,cn=or+1;Je.push(on,sn,cn),Je.push(sn,ln,cn)}}this.setIndex(Je),this.setAttribute("position",new Float32BufferAttribute(Xe,3)),this.setAttribute("normal",new Float32BufferAttribute(Ke,3)),this.setAttribute("uv",new Float32BufferAttribute(Ye,2))}RingBufferGeometry.prototype=Object.create(BufferGeometry.prototype);RingBufferGeometry.prototype.constructor=RingBufferGeometry;function LatheGeometry($e,Se,Be,De){Geometry.call(this),this.type="LatheGeometry",this.parameters={points:$e,segments:Se,phiStart:Be,phiLength:De},this.fromBufferGeometry(new LatheBufferGeometry($e,Se,Be,De)),this.mergeVertices()}LatheGeometry.prototype=Object.create(Geometry.prototype);LatheGeometry.prototype.constructor=LatheGeometry;function LatheBufferGeometry($e,Se,Be,De){BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:$e,segments:Se,phiStart:Be,phiLength:De},Se=Math.floor(Se)||12,Be=Be||0,De=De||Math.PI*2,De=MathUtils.clamp(De,0,Math.PI*2);var Ve=[],Fe=[],Je=[],Xe,Ke=1/Se,Ye=new Vector3,or=new Vector2,sr,cr;for(sr=0;sr<=Se;sr++){var Br=Be+sr*Ke*De,tn=Math.sin(Br),en=Math.cos(Br);for(cr=0;cr<=$e.length-1;cr++)Ye.x=$e[cr].x*tn,Ye.y=$e[cr].y,Ye.z=$e[cr].x*en,Fe.push(Ye.x,Ye.y,Ye.z),or.x=sr/Se,or.y=cr/($e.length-1),Je.push(or.x,or.y)}for(sr=0;sr<Se;sr++)for(cr=0;cr<$e.length-1;cr++){Xe=cr+sr*$e.length;var an=Xe,rn=Xe+$e.length,on=Xe+$e.length+1,sn=Xe+1;Ve.push(an,rn,sn),Ve.push(rn,on,sn)}if(this.setIndex(Ve),this.setAttribute("position",new Float32BufferAttribute(Fe,3)),this.setAttribute("uv",new Float32BufferAttribute(Je,2)),this.computeVertexNormals(),De===Math.PI*2){var ln=this.attributes.normal.array,cn=new Vector3,hn=new Vector3,mn=new Vector3;for(Xe=Se*$e.length*3,sr=0,cr=0;sr<$e.length;sr++,cr+=3)cn.x=ln[cr+0],cn.y=ln[cr+1],cn.z=ln[cr+2],hn.x=ln[Xe+cr+0],hn.y=ln[Xe+cr+1],hn.z=ln[Xe+cr+2],mn.addVectors(cn,hn).normalize(),ln[cr+0]=ln[Xe+cr+0]=mn.x,ln[cr+1]=ln[Xe+cr+1]=mn.y,ln[cr+2]=ln[Xe+cr+2]=mn.z}}LatheBufferGeometry.prototype=Object.create(BufferGeometry.prototype);LatheBufferGeometry.prototype.constructor=LatheBufferGeometry;function ShapeGeometry($e,Se){Geometry.call(this),this.type="ShapeGeometry",typeof Se=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),Se=Se.curveSegments),this.parameters={shapes:$e,curveSegments:Se},this.fromBufferGeometry(new ShapeBufferGeometry($e,Se)),this.mergeVertices()}ShapeGeometry.prototype=Object.create(Geometry.prototype);ShapeGeometry.prototype.constructor=ShapeGeometry;ShapeGeometry.prototype.toJSON=function(){var $e=Geometry.prototype.toJSON.call(this),Se=this.parameters.shapes;return toJSON$1(Se,$e)};function ShapeBufferGeometry($e,Se){BufferGeometry.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:$e,curveSegments:Se},Se=Se||12;var Be=[],De=[],Ve=[],Fe=[],Je=0,Xe=0;if(Array.isArray($e)===!1)Ye($e);else for(var Ke=0;Ke<$e.length;Ke++)Ye($e[Ke]),this.addGroup(Je,Xe,Ke),Je+=Xe,Xe=0;this.setIndex(Be),this.setAttribute("position",new Float32BufferAttribute(De,3)),this.setAttribute("normal",new Float32BufferAttribute(Ve,3)),this.setAttribute("uv",new Float32BufferAttribute(Fe,2));function Ye(or){var sr,cr,Br,tn=De.length/3,en=or.extractPoints(Se),an=en.shape,rn=en.holes;for(ShapeUtils.isClockWise(an)===!1&&(an=an.reverse()),sr=0,cr=rn.length;sr<cr;sr++)Br=rn[sr],ShapeUtils.isClockWise(Br)===!0&&(rn[sr]=Br.reverse());var on=ShapeUtils.triangulateShape(an,rn);for(sr=0,cr=rn.length;sr<cr;sr++)Br=rn[sr],an=an.concat(Br);for(sr=0,cr=an.length;sr<cr;sr++){var sn=an[sr];De.push(sn.x,sn.y,0),Ve.push(0,0,1),Fe.push(sn.x,sn.y)}for(sr=0,cr=on.length;sr<cr;sr++){var ln=on[sr],cn=ln[0]+tn,hn=ln[1]+tn,mn=ln[2]+tn;Be.push(cn,hn,mn),Xe+=3}}}ShapeBufferGeometry.prototype=Object.create(BufferGeometry.prototype);ShapeBufferGeometry.prototype.constructor=ShapeBufferGeometry;ShapeBufferGeometry.prototype.toJSON=function(){var $e=BufferGeometry.prototype.toJSON.call(this),Se=this.parameters.shapes;return toJSON$1(Se,$e)};function toJSON$1($e,Se){if(Se.shapes=[],Array.isArray($e))for(var Be=0,De=$e.length;Be<De;Be++){var Ve=$e[Be];Se.shapes.push(Ve.uuid)}else Se.shapes.push($e.uuid);return Se}function EdgesGeometry($e,Se){BufferGeometry.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:Se},Se=Se!==void 0?Se:1;var Be=[],De=Math.cos(MathUtils.DEG2RAD*Se),Ve=[0,0],Fe={},Je,Xe,Ke,Ye=["a","b","c"],or;$e.isBufferGeometry?(or=new Geometry,or.fromBufferGeometry($e)):or=$e.clone(),or.mergeVertices(),or.computeFaceNormals();for(var sr=or.vertices,cr=or.faces,Br=0,tn=cr.length;Br<tn;Br++)for(var en=cr[Br],an=0;an<3;an++)Je=en[Ye[an]],Xe=en[Ye[(an+1)%3]],Ve[0]=Math.min(Je,Xe),Ve[1]=Math.max(Je,Xe),Ke=Ve[0]+","+Ve[1],Fe[Ke]===void 0?Fe[Ke]={index1:Ve[0],index2:Ve[1],face1:Br,face2:void 0}:Fe[Ke].face2=Br;for(Ke in Fe){var rn=Fe[Ke];if(rn.face2===void 0||cr[rn.face1].normal.dot(cr[rn.face2].normal)<=De){var on=sr[rn.index1];Be.push(on.x,on.y,on.z),on=sr[rn.index2],Be.push(on.x,on.y,on.z)}}this.setAttribute("position",new Float32BufferAttribute(Be,3))}EdgesGeometry.prototype=Object.create(BufferGeometry.prototype);EdgesGeometry.prototype.constructor=EdgesGeometry;function CylinderGeometry($e,Se,Be,De,Ve,Fe,Je,Xe){Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:$e,radiusBottom:Se,height:Be,radialSegments:De,heightSegments:Ve,openEnded:Fe,thetaStart:Je,thetaLength:Xe},this.fromBufferGeometry(new CylinderBufferGeometry($e,Se,Be,De,Ve,Fe,Je,Xe)),this.mergeVertices()}CylinderGeometry.prototype=Object.create(Geometry.prototype);CylinderGeometry.prototype.constructor=CylinderGeometry;function CylinderBufferGeometry($e,Se,Be,De,Ve,Fe,Je,Xe){BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:$e,radiusBottom:Se,height:Be,radialSegments:De,heightSegments:Ve,openEnded:Fe,thetaStart:Je,thetaLength:Xe};var Ke=this;$e=$e!==void 0?$e:1,Se=Se!==void 0?Se:1,Be=Be||1,De=Math.floor(De)||8,Ve=Math.floor(Ve)||1,Fe=Fe!==void 0?Fe:!1,Je=Je!==void 0?Je:0,Xe=Xe!==void 0?Xe:Math.PI*2;var Ye=[],or=[],sr=[],cr=[],Br=0,tn=[],en=Be/2,an=0;rn(),Fe===!1&&($e>0&&on(!0),Se>0&&on(!1)),this.setIndex(Ye),this.setAttribute("position",new Float32BufferAttribute(or,3)),this.setAttribute("normal",new Float32BufferAttribute(sr,3)),this.setAttribute("uv",new Float32BufferAttribute(cr,2));function rn(){var sn,ln,cn=new Vector3,hn=new Vector3,mn=0,An=(Se-$e)/Be;for(ln=0;ln<=Ve;ln++){var xn=[],pn=ln/Ve,dn=pn*(Se-$e)+$e;for(sn=0;sn<=De;sn++){var fn=sn/De,yn=fn*Xe+Je,Sn=Math.sin(yn),gn=Math.cos(yn);hn.x=dn*Sn,hn.y=-pn*Be+en,hn.z=dn*gn,or.push(hn.x,hn.y,hn.z),cn.set(Sn,An,gn).normalize(),sr.push(cn.x,cn.y,cn.z),cr.push(fn,1-pn),xn.push(Br++)}tn.push(xn)}for(sn=0;sn<De;sn++)for(ln=0;ln<Ve;ln++){var Cn=tn[ln][sn],Mn=tn[ln+1][sn],Bn=tn[ln+1][sn+1],kn=tn[ln][sn+1];Ye.push(Cn,Mn,kn),Ye.push(Mn,Bn,kn),mn+=6}Ke.addGroup(an,mn,0),an+=mn}function on(sn){var ln,cn,hn,mn=new Vector2,An=new Vector3,xn=0,pn=sn===!0?$e:Se,dn=sn===!0?1:-1;for(cn=Br,ln=1;ln<=De;ln++)or.push(0,en*dn,0),sr.push(0,dn,0),cr.push(.5,.5),Br++;for(hn=Br,ln=0;ln<=De;ln++){var fn=ln/De,yn=fn*Xe+Je,Sn=Math.cos(yn),gn=Math.sin(yn);An.x=pn*gn,An.y=en*dn,An.z=pn*Sn,or.push(An.x,An.y,An.z),sr.push(0,dn,0),mn.x=Sn*.5+.5,mn.y=gn*.5*dn+.5,cr.push(mn.x,mn.y),Br++}for(ln=0;ln<De;ln++){var Cn=cn+ln,Mn=hn+ln;sn===!0?Ye.push(Mn,Mn+1,Cn):Ye.push(Mn+1,Mn,Cn),xn+=3}Ke.addGroup(an,xn,sn===!0?1:2),an+=xn}}CylinderBufferGeometry.prototype=Object.create(BufferGeometry.prototype);CylinderBufferGeometry.prototype.constructor=CylinderBufferGeometry;function ConeGeometry($e,Se,Be,De,Ve,Fe,Je){CylinderGeometry.call(this,0,$e,Se,Be,De,Ve,Fe,Je),this.type="ConeGeometry",this.parameters={radius:$e,height:Se,radialSegments:Be,heightSegments:De,openEnded:Ve,thetaStart:Fe,thetaLength:Je}}ConeGeometry.prototype=Object.create(CylinderGeometry.prototype);ConeGeometry.prototype.constructor=ConeGeometry;function ConeBufferGeometry($e,Se,Be,De,Ve,Fe,Je){CylinderBufferGeometry.call(this,0,$e,Se,Be,De,Ve,Fe,Je),this.type="ConeBufferGeometry",this.parameters={radius:$e,height:Se,radialSegments:Be,heightSegments:De,openEnded:Ve,thetaStart:Fe,thetaLength:Je}}ConeBufferGeometry.prototype=Object.create(CylinderBufferGeometry.prototype);ConeBufferGeometry.prototype.constructor=ConeBufferGeometry;function CircleGeometry($e,Se,Be,De){Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:$e,segments:Se,thetaStart:Be,thetaLength:De},this.fromBufferGeometry(new CircleBufferGeometry($e,Se,Be,De)),this.mergeVertices()}CircleGeometry.prototype=Object.create(Geometry.prototype);CircleGeometry.prototype.constructor=CircleGeometry;function CircleBufferGeometry($e,Se,Be,De){BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:$e,segments:Se,thetaStart:Be,thetaLength:De},$e=$e||1,Se=Se!==void 0?Math.max(3,Se):8,Be=Be!==void 0?Be:0,De=De!==void 0?De:Math.PI*2;var Ve=[],Fe=[],Je=[],Xe=[],Ke,Ye,or=new Vector3,sr=new Vector2;for(Fe.push(0,0,0),Je.push(0,0,1),Xe.push(.5,.5),Ye=0,Ke=3;Ye<=Se;Ye++,Ke+=3){var cr=Be+Ye/Se*De;or.x=$e*Math.cos(cr),or.y=$e*Math.sin(cr),Fe.push(or.x,or.y,or.z),Je.push(0,0,1),sr.x=(Fe[Ke]/$e+1)/2,sr.y=(Fe[Ke+1]/$e+1)/2,Xe.push(sr.x,sr.y)}for(Ke=1;Ke<=Se;Ke++)Ve.push(Ke,Ke+1,0);this.setIndex(Ve),this.setAttribute("position",new Float32BufferAttribute(Fe,3)),this.setAttribute("normal",new Float32BufferAttribute(Je,3)),this.setAttribute("uv",new Float32BufferAttribute(Xe,2))}CircleBufferGeometry.prototype=Object.create(BufferGeometry.prototype);CircleBufferGeometry.prototype.constructor=CircleBufferGeometry;var Geometries=Object.freeze({__proto__:null,WireframeGeometry,ParametricGeometry,ParametricBufferGeometry,TetrahedronGeometry,TetrahedronBufferGeometry,OctahedronGeometry,OctahedronBufferGeometry,IcosahedronGeometry,IcosahedronBufferGeometry,DodecahedronGeometry,DodecahedronBufferGeometry,PolyhedronGeometry,PolyhedronBufferGeometry,TubeGeometry,TubeBufferGeometry,TorusKnotGeometry,TorusKnotBufferGeometry,TorusGeometry,TorusBufferGeometry,TextGeometry,TextBufferGeometry,SphereGeometry,SphereBufferGeometry,RingGeometry,RingBufferGeometry,PlaneGeometry,PlaneBufferGeometry,LatheGeometry,LatheBufferGeometry,ShapeGeometry,ShapeBufferGeometry,ExtrudeGeometry,ExtrudeBufferGeometry,EdgesGeometry,ConeGeometry,ConeBufferGeometry,CylinderGeometry,CylinderBufferGeometry,CircleGeometry,CircleBufferGeometry,BoxGeometry,BoxBufferGeometry});function ShadowMaterial($e){Material.call(this),this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.setValues($e)}ShadowMaterial.prototype=Object.create(Material.prototype);ShadowMaterial.prototype.constructor=ShadowMaterial;ShadowMaterial.prototype.isShadowMaterial=!0;ShadowMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.color.copy($e.color),this};function RawShaderMaterial($e){ShaderMaterial.call(this,$e),this.type="RawShaderMaterial"}RawShaderMaterial.prototype=Object.create(ShaderMaterial.prototype);RawShaderMaterial.prototype.constructor=RawShaderMaterial;RawShaderMaterial.prototype.isRawShaderMaterial=!0;function MeshStandardMaterial($e){Material.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues($e)}MeshStandardMaterial.prototype=Object.create(Material.prototype);MeshStandardMaterial.prototype.constructor=MeshStandardMaterial;MeshStandardMaterial.prototype.isMeshStandardMaterial=!0;MeshStandardMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.defines={STANDARD:""},this.color.copy($e.color),this.roughness=$e.roughness,this.metalness=$e.metalness,this.map=$e.map,this.lightMap=$e.lightMap,this.lightMapIntensity=$e.lightMapIntensity,this.aoMap=$e.aoMap,this.aoMapIntensity=$e.aoMapIntensity,this.emissive.copy($e.emissive),this.emissiveMap=$e.emissiveMap,this.emissiveIntensity=$e.emissiveIntensity,this.bumpMap=$e.bumpMap,this.bumpScale=$e.bumpScale,this.normalMap=$e.normalMap,this.normalMapType=$e.normalMapType,this.normalScale.copy($e.normalScale),this.displacementMap=$e.displacementMap,this.displacementScale=$e.displacementScale,this.displacementBias=$e.displacementBias,this.roughnessMap=$e.roughnessMap,this.metalnessMap=$e.metalnessMap,this.alphaMap=$e.alphaMap,this.envMap=$e.envMap,this.envMapIntensity=$e.envMapIntensity,this.refractionRatio=$e.refractionRatio,this.wireframe=$e.wireframe,this.wireframeLinewidth=$e.wireframeLinewidth,this.wireframeLinecap=$e.wireframeLinecap,this.wireframeLinejoin=$e.wireframeLinejoin,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.morphNormals=$e.morphNormals,this.vertexTangents=$e.vertexTangents,this};function MeshPhysicalMaterial($e){MeshStandardMaterial.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues($e)}MeshPhysicalMaterial.prototype=Object.create(MeshStandardMaterial.prototype);MeshPhysicalMaterial.prototype.constructor=MeshPhysicalMaterial;MeshPhysicalMaterial.prototype.isMeshPhysicalMaterial=!0;MeshPhysicalMaterial.prototype.copy=function($e){return MeshStandardMaterial.prototype.copy.call(this,$e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=$e.clearcoat,this.clearcoatMap=$e.clearcoatMap,this.clearcoatRoughness=$e.clearcoatRoughness,this.clearcoatRoughnessMap=$e.clearcoatRoughnessMap,this.clearcoatNormalMap=$e.clearcoatNormalMap,this.clearcoatNormalScale.copy($e.clearcoatNormalScale),this.reflectivity=$e.reflectivity,$e.sheen?this.sheen=(this.sheen||new Color).copy($e.sheen):this.sheen=null,this.transparency=$e.transparency,this};function MeshPhongMaterial($e){Material.call(this),this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues($e)}MeshPhongMaterial.prototype=Object.create(Material.prototype);MeshPhongMaterial.prototype.constructor=MeshPhongMaterial;MeshPhongMaterial.prototype.isMeshPhongMaterial=!0;MeshPhongMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.color.copy($e.color),this.specular.copy($e.specular),this.shininess=$e.shininess,this.map=$e.map,this.lightMap=$e.lightMap,this.lightMapIntensity=$e.lightMapIntensity,this.aoMap=$e.aoMap,this.aoMapIntensity=$e.aoMapIntensity,this.emissive.copy($e.emissive),this.emissiveMap=$e.emissiveMap,this.emissiveIntensity=$e.emissiveIntensity,this.bumpMap=$e.bumpMap,this.bumpScale=$e.bumpScale,this.normalMap=$e.normalMap,this.normalMapType=$e.normalMapType,this.normalScale.copy($e.normalScale),this.displacementMap=$e.displacementMap,this.displacementScale=$e.displacementScale,this.displacementBias=$e.displacementBias,this.specularMap=$e.specularMap,this.alphaMap=$e.alphaMap,this.envMap=$e.envMap,this.combine=$e.combine,this.reflectivity=$e.reflectivity,this.refractionRatio=$e.refractionRatio,this.wireframe=$e.wireframe,this.wireframeLinewidth=$e.wireframeLinewidth,this.wireframeLinecap=$e.wireframeLinecap,this.wireframeLinejoin=$e.wireframeLinejoin,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.morphNormals=$e.morphNormals,this};function MeshToonMaterial($e){Material.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues($e)}MeshToonMaterial.prototype=Object.create(Material.prototype);MeshToonMaterial.prototype.constructor=MeshToonMaterial;MeshToonMaterial.prototype.isMeshToonMaterial=!0;MeshToonMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.color.copy($e.color),this.specular.copy($e.specular),this.shininess=$e.shininess,this.map=$e.map,this.gradientMap=$e.gradientMap,this.lightMap=$e.lightMap,this.lightMapIntensity=$e.lightMapIntensity,this.aoMap=$e.aoMap,this.aoMapIntensity=$e.aoMapIntensity,this.emissive.copy($e.emissive),this.emissiveMap=$e.emissiveMap,this.emissiveIntensity=$e.emissiveIntensity,this.bumpMap=$e.bumpMap,this.bumpScale=$e.bumpScale,this.normalMap=$e.normalMap,this.normalMapType=$e.normalMapType,this.normalScale.copy($e.normalScale),this.displacementMap=$e.displacementMap,this.displacementScale=$e.displacementScale,this.displacementBias=$e.displacementBias,this.specularMap=$e.specularMap,this.alphaMap=$e.alphaMap,this.wireframe=$e.wireframe,this.wireframeLinewidth=$e.wireframeLinewidth,this.wireframeLinecap=$e.wireframeLinecap,this.wireframeLinejoin=$e.wireframeLinejoin,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.morphNormals=$e.morphNormals,this};function MeshNormalMaterial($e){Material.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues($e)}MeshNormalMaterial.prototype=Object.create(Material.prototype);MeshNormalMaterial.prototype.constructor=MeshNormalMaterial;MeshNormalMaterial.prototype.isMeshNormalMaterial=!0;MeshNormalMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.bumpMap=$e.bumpMap,this.bumpScale=$e.bumpScale,this.normalMap=$e.normalMap,this.normalMapType=$e.normalMapType,this.normalScale.copy($e.normalScale),this.displacementMap=$e.displacementMap,this.displacementScale=$e.displacementScale,this.displacementBias=$e.displacementBias,this.wireframe=$e.wireframe,this.wireframeLinewidth=$e.wireframeLinewidth,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.morphNormals=$e.morphNormals,this};function MeshLambertMaterial($e){Material.call(this),this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues($e)}MeshLambertMaterial.prototype=Object.create(Material.prototype);MeshLambertMaterial.prototype.constructor=MeshLambertMaterial;MeshLambertMaterial.prototype.isMeshLambertMaterial=!0;MeshLambertMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.color.copy($e.color),this.map=$e.map,this.lightMap=$e.lightMap,this.lightMapIntensity=$e.lightMapIntensity,this.aoMap=$e.aoMap,this.aoMapIntensity=$e.aoMapIntensity,this.emissive.copy($e.emissive),this.emissiveMap=$e.emissiveMap,this.emissiveIntensity=$e.emissiveIntensity,this.specularMap=$e.specularMap,this.alphaMap=$e.alphaMap,this.envMap=$e.envMap,this.combine=$e.combine,this.reflectivity=$e.reflectivity,this.refractionRatio=$e.refractionRatio,this.wireframe=$e.wireframe,this.wireframeLinewidth=$e.wireframeLinewidth,this.wireframeLinecap=$e.wireframeLinecap,this.wireframeLinejoin=$e.wireframeLinejoin,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.morphNormals=$e.morphNormals,this};function MeshMatcapMaterial($e){Material.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues($e)}MeshMatcapMaterial.prototype=Object.create(Material.prototype);MeshMatcapMaterial.prototype.constructor=MeshMatcapMaterial;MeshMatcapMaterial.prototype.isMeshMatcapMaterial=!0;MeshMatcapMaterial.prototype.copy=function($e){return Material.prototype.copy.call(this,$e),this.defines={MATCAP:""},this.color.copy($e.color),this.matcap=$e.matcap,this.map=$e.map,this.bumpMap=$e.bumpMap,this.bumpScale=$e.bumpScale,this.normalMap=$e.normalMap,this.normalMapType=$e.normalMapType,this.normalScale.copy($e.normalScale),this.displacementMap=$e.displacementMap,this.displacementScale=$e.displacementScale,this.displacementBias=$e.displacementBias,this.alphaMap=$e.alphaMap,this.skinning=$e.skinning,this.morphTargets=$e.morphTargets,this.morphNormals=$e.morphNormals,this};function LineDashedMaterial($e){LineBasicMaterial.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues($e)}LineDashedMaterial.prototype=Object.create(LineBasicMaterial.prototype);LineDashedMaterial.prototype.constructor=LineDashedMaterial;LineDashedMaterial.prototype.isLineDashedMaterial=!0;LineDashedMaterial.prototype.copy=function($e){return LineBasicMaterial.prototype.copy.call(this,$e),this.scale=$e.scale,this.dashSize=$e.dashSize,this.gapSize=$e.gapSize,this};var Materials=Object.freeze({__proto__:null,ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material}),AnimationUtils={arraySlice:function($e,Se,Be){return AnimationUtils.isTypedArray($e)?new $e.constructor($e.subarray(Se,Be!==void 0?Be:$e.length)):$e.slice(Se,Be)},convertArray:function($e,Se,Be){return!$e||!Be&&$e.constructor===Se?$e:typeof Se.BYTES_PER_ELEMENT=="number"?new Se($e):Array.prototype.slice.call($e)},isTypedArray:function($e){return ArrayBuffer.isView($e)&&!($e instanceof DataView)},getKeyframeOrder:function($e){function Se(Fe,Je){return $e[Fe]-$e[Je]}for(var Be=$e.length,De=new Array(Be),Ve=0;Ve!==Be;++Ve)De[Ve]=Ve;return De.sort(Se),De},sortedArray:function($e,Se,Be){for(var De=$e.length,Ve=new $e.constructor(De),Fe=0,Je=0;Je!==De;++Fe)for(var Xe=Be[Fe]*Se,Ke=0;Ke!==Se;++Ke)Ve[Je++]=$e[Xe+Ke];return Ve},flattenJSON:function($e,Se,Be,De){for(var Ve=1,Fe=$e[0];Fe!==void 0&&Fe[De]===void 0;)Fe=$e[Ve++];if(Fe!==void 0){var Je=Fe[De];if(Je!==void 0)if(Array.isArray(Je))do Je=Fe[De],Je!==void 0&&(Se.push(Fe.time),Be.push.apply(Be,Je)),Fe=$e[Ve++];while(Fe!==void 0);else if(Je.toArray!==void 0)do Je=Fe[De],Je!==void 0&&(Se.push(Fe.time),Je.toArray(Be,Be.length)),Fe=$e[Ve++];while(Fe!==void 0);else do Je=Fe[De],Je!==void 0&&(Se.push(Fe.time),Be.push(Je)),Fe=$e[Ve++];while(Fe!==void 0)}},subclip:function($e,Se,Be,De,Ve){Ve=Ve||30;var Fe=$e.clone();Fe.name=Se;for(var Je=[],Xe=0;Xe<Fe.tracks.length;++Xe){for(var Ke=Fe.tracks[Xe],Ye=Ke.getValueSize(),or=[],sr=[],cr=0;cr<Ke.times.length;++cr){var Br=Ke.times[cr]*Ve;if(!(Br<Be||Br>=De)){or.push(Ke.times[cr]);for(var tn=0;tn<Ye;++tn)sr.push(Ke.values[cr*Ye+tn])}}or.length!==0&&(Ke.times=AnimationUtils.convertArray(or,Ke.times.constructor),Ke.values=AnimationUtils.convertArray(sr,Ke.values.constructor),Je.push(Ke))}Fe.tracks=Je;for(var en=1/0,Xe=0;Xe<Fe.tracks.length;++Xe)en>Fe.tracks[Xe].times[0]&&(en=Fe.tracks[Xe].times[0]);for(var Xe=0;Xe<Fe.tracks.length;++Xe)Fe.tracks[Xe].shift(-1*en);return Fe.resetDuration(),Fe},makeClipAdditive:function($e,Se,Be,De){Se===void 0&&(Se=0),Be===void 0&&(Be=$e),(De===void 0||De<=0)&&(De=30);for(var Ve=$e.tracks.length,Fe=Se/De,Je=0;Je<Ve;++Je){var Xe=Be.tracks[Je],Ke=Xe.ValueTypeName;if(!(Ke==="bool"||Ke==="string")){var Ye=$e.tracks.find(function(ln){return ln.name===Xe.name&&ln.ValueTypeName===Ke});if(Ye!==void 0){var or=Xe.getValueSize(),sr=Xe.times.length-1,cr;if(Fe<=Xe.times[0])cr=AnimationUtils.arraySlice(Xe.values,0,Xe.valueSize);else if(Fe>=Xe.times[sr]){var Br=sr*or;cr=AnimationUtils.arraySlice(Xe.values,Br)}else{var tn=Xe.createInterpolant();tn.evaluate(Fe),cr=tn.resultBuffer}if(Ke==="quaternion"){var en=new Quaternion(cr[0],cr[1],cr[2],cr[3]).normalize().conjugate();en.toArray(cr)}for(var an=Ye.times.length,rn=0;rn<an;++rn){var on=rn*or;if(Ke==="quaternion")Quaternion.multiplyQuaternionsFlat(Ye.values,on,cr,0,Ye.values,on);else for(var sn=0;sn<or;++sn)Ye.values[on+sn]-=cr[sn]}}}}return $e.blendMode=AdditiveAnimationBlendMode,$e}};function Interpolant($e,Se,Be,De){this.parameterPositions=$e,this._cachedIndex=0,this.resultBuffer=De!==void 0?De:new Se.constructor(Be),this.sampleValues=Se,this.valueSize=Be}Object.assign(Interpolant.prototype,{evaluate:function($e){var Se=this.parameterPositions,Be=this._cachedIndex,De=Se[Be],Ve=Se[Be-1];e:{t:{var Fe;r:{n:if(!($e<De)){for(var Je=Be+2;;){if(De===void 0){if($e<Ve)break n;return Be=Se.length,this._cachedIndex=Be,this.afterEnd_(Be-1,$e,Ve)}if(Be===Je)break;if(Ve=De,De=Se[++Be],$e<De)break t}Fe=Se.length;break r}if(!($e>=Ve)){var Xe=Se[1];$e<Xe&&(Be=2,Ve=Xe);for(var Je=Be-2;;){if(Ve===void 0)return this._cachedIndex=0,this.beforeStart_(0,$e,De);if(Be===Je)break;if(De=Ve,Ve=Se[--Be-1],$e>=Ve)break t}Fe=Be,Be=0;break r}break e}for(;Be<Fe;){var Ke=Be+Fe>>>1;$e<Se[Ke]?Fe=Ke:Be=Ke+1}if(De=Se[Be],Ve=Se[Be-1],Ve===void 0)return this._cachedIndex=0,this.beforeStart_(0,$e,De);if(De===void 0)return Be=Se.length,this._cachedIndex=Be,this.afterEnd_(Be-1,Ve,$e)}this._cachedIndex=Be,this.intervalChanged_(Be,Ve,De)}return this.interpolate_(Be,Ve,$e,De)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function($e){for(var Se=this.resultBuffer,Be=this.sampleValues,De=this.valueSize,Ve=$e*De,Fe=0;Fe!==De;++Fe)Se[Fe]=Be[Ve+Fe];return Se},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});Object.assign(Interpolant.prototype,{beforeStart_:Interpolant.prototype.copySampleValue_,afterEnd_:Interpolant.prototype.copySampleValue_});function CubicInterpolant($e,Se,Be,De){Interpolant.call(this,$e,Se,Be,De),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}CubicInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:CubicInterpolant,DefaultSettings_:{endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding},intervalChanged_:function($e,Se,Be){var De=this.parameterPositions,Ve=$e-2,Fe=$e+1,Je=De[Ve],Xe=De[Fe];if(Je===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:Ve=$e,Je=2*Se-Be;break;case WrapAroundEnding:Ve=De.length-2,Je=Se+De[Ve]-De[Ve+1];break;default:Ve=$e,Je=Be}if(Xe===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:Fe=$e,Xe=2*Be-Se;break;case WrapAroundEnding:Fe=1,Xe=Be+De[1]-De[0];break;default:Fe=$e-1,Xe=Se}var Ke=(Be-Se)*.5,Ye=this.valueSize;this._weightPrev=Ke/(Se-Je),this._weightNext=Ke/(Xe-Be),this._offsetPrev=Ve*Ye,this._offsetNext=Fe*Ye},interpolate_:function($e,Se,Be,De){for(var Ve=this.resultBuffer,Fe=this.sampleValues,Je=this.valueSize,Xe=$e*Je,Ke=Xe-Je,Ye=this._offsetPrev,or=this._offsetNext,sr=this._weightPrev,cr=this._weightNext,Br=(Be-Se)/(De-Se),tn=Br*Br,en=tn*Br,an=-sr*en+2*sr*tn-sr*Br,rn=(1+sr)*en+(-1.5-2*sr)*tn+(-.5+sr)*Br+1,on=(-1-cr)*en+(1.5+cr)*tn+.5*Br,sn=cr*en-cr*tn,ln=0;ln!==Je;++ln)Ve[ln]=an*Fe[Ye+ln]+rn*Fe[Ke+ln]+on*Fe[Xe+ln]+sn*Fe[or+ln];return Ve}});function LinearInterpolant($e,Se,Be,De){Interpolant.call(this,$e,Se,Be,De)}LinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:LinearInterpolant,interpolate_:function($e,Se,Be,De){for(var Ve=this.resultBuffer,Fe=this.sampleValues,Je=this.valueSize,Xe=$e*Je,Ke=Xe-Je,Ye=(Be-Se)/(De-Se),or=1-Ye,sr=0;sr!==Je;++sr)Ve[sr]=Fe[Ke+sr]*or+Fe[Xe+sr]*Ye;return Ve}});function DiscreteInterpolant($e,Se,Be,De){Interpolant.call(this,$e,Se,Be,De)}DiscreteInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:DiscreteInterpolant,interpolate_:function($e){return this.copySampleValue_($e-1)}});function KeyframeTrack($e,Se,Be,De){if($e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(Se===void 0||Se.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+$e);this.name=$e,this.times=AnimationUtils.convertArray(Se,this.TimeBufferType),this.values=AnimationUtils.convertArray(Be,this.ValueBufferType),this.setInterpolation(De||this.DefaultInterpolation)}Object.assign(KeyframeTrack,{toJSON:function($e){var Se=$e.constructor,Be;if(Se.toJSON!==void 0)Be=Se.toJSON($e);else{Be={name:$e.name,times:AnimationUtils.convertArray($e.times,Array),values:AnimationUtils.convertArray($e.values,Array)};var De=$e.getInterpolation();De!==$e.DefaultInterpolation&&(Be.interpolation=De)}return Be.type=$e.ValueTypeName,Be}});Object.assign(KeyframeTrack.prototype,{constructor:KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:InterpolateLinear,InterpolantFactoryMethodDiscrete:function($e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),$e)},InterpolantFactoryMethodLinear:function($e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),$e)},InterpolantFactoryMethodSmooth:function($e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),$e)},setInterpolation:function($e){var Se;switch($e){case InterpolateDiscrete:Se=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:Se=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:Se=this.InterpolantFactoryMethodSmooth;break}if(Se===void 0){var Be="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if($e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(Be);return console.warn("THREE.KeyframeTrack:",Be),this}return this.createInterpolant=Se,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function($e){if($e!==0)for(var Se=this.times,Be=0,De=Se.length;Be!==De;++Be)Se[Be]+=$e;return this},scale:function($e){if($e!==1)for(var Se=this.times,Be=0,De=Se.length;Be!==De;++Be)Se[Be]*=$e;return this},trim:function($e,Se){for(var Be=this.times,De=Be.length,Ve=0,Fe=De-1;Ve!==De&&Be[Ve]<$e;)++Ve;for(;Fe!==-1&&Be[Fe]>Se;)--Fe;if(++Fe,Ve!==0||Fe!==De){Ve>=Fe&&(Fe=Math.max(Fe,1),Ve=Fe-1);var Je=this.getValueSize();this.times=AnimationUtils.arraySlice(Be,Ve,Fe),this.values=AnimationUtils.arraySlice(this.values,Ve*Je,Fe*Je)}return this},validate:function(){var $e=!0,Se=this.getValueSize();Se-Math.floor(Se)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),$e=!1);var Be=this.times,De=this.values,Ve=Be.length;Ve===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),$e=!1);for(var Fe=null,Je=0;Je!==Ve;Je++){var Xe=Be[Je];if(typeof Xe=="number"&&isNaN(Xe)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,Je,Xe),$e=!1;break}if(Fe!==null&&Fe>Xe){console.error("THREE.KeyframeTrack: Out of order keys.",this,Je,Xe,Fe),$e=!1;break}Fe=Xe}if(De!==void 0&&AnimationUtils.isTypedArray(De))for(var Je=0,Ke=De.length;Je!==Ke;++Je){var Ye=De[Je];if(isNaN(Ye)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,Je,Ye),$e=!1;break}}return $e},optimize:function(){for(var $e=AnimationUtils.arraySlice(this.times),Se=AnimationUtils.arraySlice(this.values),Be=this.getValueSize(),De=this.getInterpolation()===InterpolateSmooth,Ve=1,Fe=$e.length-1,Je=1;Je<Fe;++Je){var Xe=!1,Ke=$e[Je],Ye=$e[Je+1];if(Ke!==Ye&&(Je!==1||Ke!==Ke[0]))if(De)Xe=!0;else for(var or=Je*Be,sr=or-Be,cr=or+Be,Br=0;Br!==Be;++Br){var tn=Se[or+Br];if(tn!==Se[sr+Br]||tn!==Se[cr+Br]){Xe=!0;break}}if(Xe){if(Je!==Ve){$e[Ve]=$e[Je];for(var en=Je*Be,an=Ve*Be,Br=0;Br!==Be;++Br)Se[an+Br]=Se[en+Br]}++Ve}}if(Fe>0){$e[Ve]=$e[Fe];for(var en=Fe*Be,an=Ve*Be,Br=0;Br!==Be;++Br)Se[an+Br]=Se[en+Br];++Ve}return Ve!==$e.length?(this.times=AnimationUtils.arraySlice($e,0,Ve),this.values=AnimationUtils.arraySlice(Se,0,Ve*Be)):(this.times=$e,this.values=Se),this},clone:function(){var $e=AnimationUtils.arraySlice(this.times,0),Se=AnimationUtils.arraySlice(this.values,0),Be=this.constructor,De=new Be(this.name,$e,Se);return De.createInterpolant=this.createInterpolant,De}});function BooleanKeyframeTrack($e,Se,Be){KeyframeTrack.call(this,$e,Se,Be)}BooleanKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function ColorKeyframeTrack($e,Se,Be,De){KeyframeTrack.call(this,$e,Se,Be,De)}ColorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:ColorKeyframeTrack,ValueTypeName:"color"});function NumberKeyframeTrack($e,Se,Be,De){KeyframeTrack.call(this,$e,Se,Be,De)}NumberKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:NumberKeyframeTrack,ValueTypeName:"number"});function QuaternionLinearInterpolant($e,Se,Be,De){Interpolant.call(this,$e,Se,Be,De)}QuaternionLinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:QuaternionLinearInterpolant,interpolate_:function($e,Se,Be,De){for(var Ve=this.resultBuffer,Fe=this.sampleValues,Je=this.valueSize,Xe=$e*Je,Ke=(Be-Se)/(De-Se),Ye=Xe+Je;Xe!==Ye;Xe+=4)Quaternion.slerpFlat(Ve,0,Fe,Xe-Je,Fe,Xe,Ke);return Ve}});function QuaternionKeyframeTrack($e,Se,Be,De){KeyframeTrack.call(this,$e,Se,Be,De)}QuaternionKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:InterpolateLinear,InterpolantFactoryMethodLinear:function($e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),$e)},InterpolantFactoryMethodSmooth:void 0});function StringKeyframeTrack($e,Se,Be,De){KeyframeTrack.call(this,$e,Se,Be,De)}StringKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function VectorKeyframeTrack($e,Se,Be,De){KeyframeTrack.call(this,$e,Se,Be,De)}VectorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:VectorKeyframeTrack,ValueTypeName:"vector"});function AnimationClip($e,Se,Be,De){this.name=$e,this.tracks=Be,this.duration=Se!==void 0?Se:-1,this.blendMode=De!==void 0?De:NormalAnimationBlendMode,this.uuid=MathUtils.generateUUID(),this.duration<0&&this.resetDuration()}function getTrackTypeForValueTypeName($e){switch($e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+$e)}function parseKeyframeTrack($e){if($e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var Se=getTrackTypeForValueTypeName($e.type);if($e.times===void 0){var Be=[],De=[];AnimationUtils.flattenJSON($e.keys,Be,De,"value"),$e.times=Be,$e.values=De}return Se.parse!==void 0?Se.parse($e):new Se($e.name,$e.times,$e.values,$e.interpolation)}Object.assign(AnimationClip,{parse:function($e){for(var Se=[],Be=$e.tracks,De=1/($e.fps||1),Ve=0,Fe=Be.length;Ve!==Fe;++Ve)Se.push(parseKeyframeTrack(Be[Ve]).scale(De));return new AnimationClip($e.name,$e.duration,Se,$e.blendMode)},toJSON:function($e){for(var Se=[],Be=$e.tracks,De={name:$e.name,duration:$e.duration,tracks:Se,uuid:$e.uuid,blendMode:$e.blendMode},Ve=0,Fe=Be.length;Ve!==Fe;++Ve)Se.push(KeyframeTrack.toJSON(Be[Ve]));return De},CreateFromMorphTargetSequence:function($e,Se,Be,De){for(var Ve=Se.length,Fe=[],Je=0;Je<Ve;Je++){var Xe=[],Ke=[];Xe.push((Je+Ve-1)%Ve,Je,(Je+1)%Ve),Ke.push(0,1,0);var Ye=AnimationUtils.getKeyframeOrder(Xe);Xe=AnimationUtils.sortedArray(Xe,1,Ye),Ke=AnimationUtils.sortedArray(Ke,1,Ye),!De&&Xe[0]===0&&(Xe.push(Ve),Ke.push(Ke[0])),Fe.push(new NumberKeyframeTrack(".morphTargetInfluences["+Se[Je].name+"]",Xe,Ke).scale(1/Be))}return new AnimationClip($e,-1,Fe)},findByName:function($e,Se){var Be=$e;if(!Array.isArray($e)){var De=$e;Be=De.geometry&&De.geometry.animations||De.animations}for(var Ve=0;Ve<Be.length;Ve++)if(Be[Ve].name===Se)return Be[Ve];return null},CreateClipsFromMorphTargetSequences:function($e,Se,Be){for(var De={},Ve=/^([\w-]*?)([\d]+)$/,Fe=0,Je=$e.length;Fe<Je;Fe++){var Xe=$e[Fe],Ke=Xe.name.match(Ve);if(Ke&&Ke.length>1){var Ye=Ke[1],or=De[Ye];or||(De[Ye]=or=[]),or.push(Xe)}}var sr=[];for(var Ye in De)sr.push(AnimationClip.CreateFromMorphTargetSequence(Ye,De[Ye],Se,Be));return sr},parseAnimation:function($e,Se){if(!$e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var Be=function(ln,cn,hn,mn,An){if(hn.length!==0){var xn=[],pn=[];AnimationUtils.flattenJSON(hn,xn,pn,mn),xn.length!==0&&An.push(new ln(cn,xn,pn))}},De=[],Ve=$e.name||"default",Fe=$e.length||-1,Je=$e.fps||30,Xe=$e.blendMode,Ke=$e.hierarchy||[],Ye=0;Ye<Ke.length;Ye++){var or=Ke[Ye].keys;if(!(!or||or.length===0))if(or[0].morphTargets){for(var sr={},cr=0;cr<or.length;cr++)if(or[cr].morphTargets)for(var Br=0;Br<or[cr].morphTargets.length;Br++)sr[or[cr].morphTargets[Br]]=-1;for(var tn in sr){for(var en=[],an=[],Br=0;Br!==or[cr].morphTargets.length;++Br){var rn=or[cr];en.push(rn.time),an.push(rn.morphTarget===tn?1:0)}De.push(new NumberKeyframeTrack(".morphTargetInfluence["+tn+"]",en,an))}Fe=sr.length*Je}else{var on=".bones["+Se[Ye].name+"]";Be(VectorKeyframeTrack,on+".position",or,"pos",De),Be(QuaternionKeyframeTrack,on+".quaternion",or,"rot",De),Be(VectorKeyframeTrack,on+".scale",or,"scl",De)}}if(De.length===0)return null;var sn=new AnimationClip(Ve,Fe,De,Xe);return sn}});Object.assign(AnimationClip.prototype,{resetDuration:function(){for(var $e=this.tracks,Se=0,Be=0,De=$e.length;Be!==De;++Be){var Ve=this.tracks[Be];Se=Math.max(Se,Ve.times[Ve.times.length-1])}return this.duration=Se,this},trim:function(){for(var $e=0;$e<this.tracks.length;$e++)this.tracks[$e].trim(0,this.duration);return this},validate:function(){for(var $e=!0,Se=0;Se<this.tracks.length;Se++)$e=$e&&this.tracks[Se].validate();return $e},optimize:function(){for(var $e=0;$e<this.tracks.length;$e++)this.tracks[$e].optimize();return this},clone:function(){for(var $e=[],Se=0;Se<this.tracks.length;Se++)$e.push(this.tracks[Se].clone());return new AnimationClip(this.name,this.duration,$e,this.blendMode)}});var Cache={enabled:!1,files:{},add:function($e,Se){this.enabled!==!1&&(this.files[$e]=Se)},get:function($e){if(this.enabled!==!1)return this.files[$e]},remove:function($e){delete this.files[$e]},clear:function(){this.files={}}};function LoadingManager($e,Se,Be){var De=this,Ve=!1,Fe=0,Je=0,Xe=void 0,Ke=[];this.onStart=void 0,this.onLoad=$e,this.onProgress=Se,this.onError=Be,this.itemStart=function(Ye){Je++,Ve===!1&&De.onStart!==void 0&&De.onStart(Ye,Fe,Je),Ve=!0},this.itemEnd=function(Ye){Fe++,De.onProgress!==void 0&&De.onProgress(Ye,Fe,Je),Fe===Je&&(Ve=!1,De.onLoad!==void 0&&De.onLoad())},this.itemError=function(Ye){De.onError!==void 0&&De.onError(Ye)},this.resolveURL=function(Ye){return Xe?Xe(Ye):Ye},this.setURLModifier=function(Ye){return Xe=Ye,this},this.addHandler=function(Ye,or){return Ke.push(Ye,or),this},this.removeHandler=function(Ye){var or=Ke.indexOf(Ye);return or!==-1&&Ke.splice(or,2),this},this.getHandler=function(Ye){for(var or=0,sr=Ke.length;or<sr;or+=2){var cr=Ke[or],Br=Ke[or+1];if(cr.global&&(cr.lastIndex=0),cr.test(Ye))return Br}return null}}var DefaultLoadingManager=new LoadingManager;function Loader($e){this.manager=$e!==void 0?$e:DefaultLoadingManager,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Loader.prototype,{load:function(){},loadAsync:function($e,Se){var Be=this;return new Promise(function(De,Ve){Be.load($e,De,Se,Ve)})},parse:function(){},setCrossOrigin:function($e){return this.crossOrigin=$e,this},setPath:function($e){return this.path=$e,this},setResourcePath:function($e){return this.resourcePath=$e,this},setRequestHeader:function($e){return this.requestHeader=$e,this}});var loading={};function FileLoader($e){Loader.call(this,$e)}FileLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:FileLoader,load:function($e,Se,Be,De){$e===void 0&&($e=""),this.path!==void 0&&($e=this.path+$e),$e=this.manager.resolveURL($e);var Ve=this,Fe=Cache.get($e);if(Fe!==void 0)return Ve.manager.itemStart($e),setTimeout(function(){Se&&Se(Fe),Ve.manager.itemEnd($e)},0),Fe;if(loading[$e]!==void 0){loading[$e].push({onLoad:Se,onProgress:Be,onError:De});return}var Je=/^data:(.*?)(;base64)?,(.*)$/,Xe=$e.match(Je);if(Xe){var Ke=Xe[1],Ye=!!Xe[2],or=Xe[3];or=decodeURIComponent(or),Ye&&(or=atob(or));try{var sr,cr=(this.responseType||"").toLowerCase();switch(cr){case"arraybuffer":case"blob":for(var Br=new Uint8Array(or.length),tn=0;tn<or.length;tn++)Br[tn]=or.charCodeAt(tn);cr==="blob"?sr=new Blob([Br.buffer],{type:Ke}):sr=Br.buffer;break;case"document":var en=new DOMParser;sr=en.parseFromString(or,Ke);break;case"json":sr=JSON.parse(or);break;default:sr=or;break}setTimeout(function(){Se&&Se(sr),Ve.manager.itemEnd($e)},0)}catch(on){setTimeout(function(){De&&De(on),Ve.manager.itemError($e),Ve.manager.itemEnd($e)},0)}}else{loading[$e]=[],loading[$e].push({onLoad:Se,onProgress:Be,onError:De});var an=new XMLHttpRequest;an.open("GET",$e,!0),an.addEventListener("load",function(on){var sn=this.response,ln=loading[$e];if(delete loading[$e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Cache.add($e,sn);for(var cn=0,hn=ln.length;cn<hn;cn++){var mn=ln[cn];mn.onLoad&&mn.onLoad(sn)}Ve.manager.itemEnd($e)}else{for(var cn=0,hn=ln.length;cn<hn;cn++){var mn=ln[cn];mn.onError&&mn.onError(on)}Ve.manager.itemError($e),Ve.manager.itemEnd($e)}},!1),an.addEventListener("progress",function(on){for(var sn=loading[$e],ln=0,cn=sn.length;ln<cn;ln++){var hn=sn[ln];hn.onProgress&&hn.onProgress(on)}},!1),an.addEventListener("error",function(on){var sn=loading[$e];delete loading[$e];for(var ln=0,cn=sn.length;ln<cn;ln++){var hn=sn[ln];hn.onError&&hn.onError(on)}Ve.manager.itemError($e),Ve.manager.itemEnd($e)},!1),an.addEventListener("abort",function(on){var sn=loading[$e];delete loading[$e];for(var ln=0,cn=sn.length;ln<cn;ln++){var hn=sn[ln];hn.onError&&hn.onError(on)}Ve.manager.itemError($e),Ve.manager.itemEnd($e)},!1),this.responseType!==void 0&&(an.responseType=this.responseType),this.withCredentials!==void 0&&(an.withCredentials=this.withCredentials),an.overrideMimeType&&an.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var rn in this.requestHeader)an.setRequestHeader(rn,this.requestHeader[rn]);an.send(null)}return Ve.manager.itemStart($e),an},setResponseType:function($e){return this.responseType=$e,this},setWithCredentials:function($e){return this.withCredentials=$e,this},setMimeType:function($e){return this.mimeType=$e,this}});function AnimationLoader($e){Loader.call(this,$e)}AnimationLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:AnimationLoader,load:function($e,Se,Be,De){var Ve=this,Fe=new FileLoader(Ve.manager);Fe.setPath(Ve.path),Fe.load($e,function(Je){try{Se(Ve.parse(JSON.parse(Je)))}catch(Xe){De?De(Xe):console.error(Xe),Ve.manager.itemError($e)}},Be,De)},parse:function($e){for(var Se=[],Be=0;Be<$e.length;Be++){var De=AnimationClip.parse($e[Be]);Se.push(De)}return Se}});function CompressedTextureLoader($e){Loader.call(this,$e)}CompressedTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:CompressedTextureLoader,load:function($e,Se,Be,De){var Ve=this,Fe=[],Je=new CompressedTexture;Je.image=Fe;var Xe=new FileLoader(this.manager);Xe.setPath(this.path),Xe.setResponseType("arraybuffer");function Ke(cr){Xe.load($e[cr],function(Br){var tn=Ve.parse(Br,!0);Fe[cr]={width:tn.width,height:tn.height,format:tn.format,mipmaps:tn.mipmaps},Ye+=1,Ye===6&&(tn.mipmapCount===1&&(Je.minFilter=LinearFilter),Je.format=tn.format,Je.needsUpdate=!0,Se&&Se(Je))},Be,De)}if(Array.isArray($e))for(var Ye=0,or=0,sr=$e.length;or<sr;++or)Ke(or);else Xe.load($e,function(cr){var Br=Ve.parse(cr,!0);if(Br.isCubemap)for(var tn=Br.mipmaps.length/Br.mipmapCount,en=0;en<tn;en++){Fe[en]={mipmaps:[]};for(var an=0;an<Br.mipmapCount;an++)Fe[en].mipmaps.push(Br.mipmaps[en*Br.mipmapCount+an]),Fe[en].format=Br.format,Fe[en].width=Br.width,Fe[en].height=Br.height}else Je.image.width=Br.width,Je.image.height=Br.height,Je.mipmaps=Br.mipmaps;Br.mipmapCount===1&&(Je.minFilter=LinearFilter),Je.format=Br.format,Je.needsUpdate=!0,Se&&Se(Je)},Be,De);return Je}});function DataTextureLoader($e){Loader.call(this,$e)}DataTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:DataTextureLoader,load:function($e,Se,Be,De){var Ve=this,Fe=new DataTexture,Je=new FileLoader(this.manager);return Je.setResponseType("arraybuffer"),Je.setPath(this.path),Je.load($e,function(Xe){var Ke=Ve.parse(Xe);Ke&&(Ke.image!==void 0?Fe.image=Ke.image:Ke.data!==void 0&&(Fe.image.width=Ke.width,Fe.image.height=Ke.height,Fe.image.data=Ke.data),Fe.wrapS=Ke.wrapS!==void 0?Ke.wrapS:ClampToEdgeWrapping,Fe.wrapT=Ke.wrapT!==void 0?Ke.wrapT:ClampToEdgeWrapping,Fe.magFilter=Ke.magFilter!==void 0?Ke.magFilter:LinearFilter,Fe.minFilter=Ke.minFilter!==void 0?Ke.minFilter:LinearFilter,Fe.anisotropy=Ke.anisotropy!==void 0?Ke.anisotropy:1,Ke.format!==void 0&&(Fe.format=Ke.format),Ke.type!==void 0&&(Fe.type=Ke.type),Ke.mipmaps!==void 0&&(Fe.mipmaps=Ke.mipmaps,Fe.minFilter=LinearMipmapLinearFilter),Ke.mipmapCount===1&&(Fe.minFilter=LinearFilter),Fe.needsUpdate=!0,Se&&Se(Fe,Ke))},Be,De),Fe}});function ImageLoader($e){Loader.call(this,$e)}ImageLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ImageLoader,load:function($e,Se,Be,De){this.path!==void 0&&($e=this.path+$e),$e=this.manager.resolveURL($e);var Ve=this,Fe=Cache.get($e);if(Fe!==void 0)return Ve.manager.itemStart($e),setTimeout(function(){Se&&Se(Fe),Ve.manager.itemEnd($e)},0),Fe;var Je=document.createElementNS("http://www.w3.org/1999/xhtml","img");function Xe(){Je.removeEventListener("load",Xe,!1),Je.removeEventListener("error",Ke,!1),Cache.add($e,this),Se&&Se(this),Ve.manager.itemEnd($e)}function Ke(Ye){Je.removeEventListener("load",Xe,!1),Je.removeEventListener("error",Ke,!1),De&&De(Ye),Ve.manager.itemError($e),Ve.manager.itemEnd($e)}return Je.addEventListener("load",Xe,!1),Je.addEventListener("error",Ke,!1),$e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(Je.crossOrigin=this.crossOrigin),Ve.manager.itemStart($e),Je.src=$e,Je}});function CubeTextureLoader($e){Loader.call(this,$e)}CubeTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:CubeTextureLoader,load:function($e,Se,Be,De){var Ve=new CubeTexture,Fe=new ImageLoader(this.manager);Fe.setCrossOrigin(this.crossOrigin),Fe.setPath(this.path);var Je=0;function Xe(Ye){Fe.load($e[Ye],function(or){Ve.images[Ye]=or,Je++,Je===6&&(Ve.needsUpdate=!0,Se&&Se(Ve))},void 0,De)}for(var Ke=0;Ke<$e.length;++Ke)Xe(Ke);return Ve}});function TextureLoader$1($e){Loader.call(this,$e)}TextureLoader$1.prototype=Object.assign(Object.create(Loader.prototype),{constructor:TextureLoader$1,load:function($e,Se,Be,De){var Ve=new Texture,Fe=new ImageLoader(this.manager);return Fe.setCrossOrigin(this.crossOrigin),Fe.setPath(this.path),Fe.load($e,function(Je){Ve.image=Je;var Xe=$e.search(/\.jpe?g($|\?)/i)>0||$e.search(/^data\:image\/jpeg/)===0;Ve.format=Xe?RGBFormat:RGBAFormat,Ve.needsUpdate=!0,Se!==void 0&&Se(Ve)},Be,De),Ve}});function Curve(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(Curve.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function($e,Se){var Be=this.getUtoTmapping($e);return this.getPoint(Be,Se)},getPoints:function($e){$e===void 0&&($e=5);for(var Se=[],Be=0;Be<=$e;Be++)Se.push(this.getPoint(Be/$e));return Se},getSpacedPoints:function($e){$e===void 0&&($e=5);for(var Se=[],Be=0;Be<=$e;Be++)Se.push(this.getPointAt(Be/$e));return Se},getLength:function(){var $e=this.getLengths();return $e[$e.length-1]},getLengths:function($e){if($e===void 0&&($e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===$e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var Se=[],Be,De=this.getPoint(0),Ve,Fe=0;for(Se.push(0),Ve=1;Ve<=$e;Ve++)Be=this.getPoint(Ve/$e),Fe+=Be.distanceTo(De),Se.push(Fe),De=Be;return this.cacheArcLengths=Se,Se},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function($e,Se){var Be=this.getLengths(),De=0,Ve=Be.length,Fe;Se?Fe=Se:Fe=$e*Be[Ve-1];for(var Je=0,Xe=Ve-1,Ke;Je<=Xe;)if(De=Math.floor(Je+(Xe-Je)/2),Ke=Be[De]-Fe,Ke<0)Je=De+1;else if(Ke>0)Xe=De-1;else{Xe=De;break}if(De=Xe,Be[De]===Fe)return De/(Ve-1);var Ye=Be[De],or=Be[De+1],sr=or-Ye,cr=(Fe-Ye)/sr,Br=(De+cr)/(Ve-1);return Br},getTangent:function($e,Se){var Be=1e-4,De=$e-Be,Ve=$e+Be;De<0&&(De=0),Ve>1&&(Ve=1);var Fe=this.getPoint(De),Je=this.getPoint(Ve),Xe=Se||(Fe.isVector2?new Vector2:new Vector3);return Xe.copy(Je).sub(Fe).normalize(),Xe},getTangentAt:function($e,Se){var Be=this.getUtoTmapping($e);return this.getTangent(Be,Se)},computeFrenetFrames:function($e,Se){var Be=new Vector3,De=[],Ve=[],Fe=[],Je=new Vector3,Xe=new Matrix4,Ke,Ye,or;for(Ke=0;Ke<=$e;Ke++)Ye=Ke/$e,De[Ke]=this.getTangentAt(Ye,new Vector3),De[Ke].normalize();Ve[0]=new Vector3,Fe[0]=new Vector3;var sr=Number.MAX_VALUE,cr=Math.abs(De[0].x),Br=Math.abs(De[0].y),tn=Math.abs(De[0].z);for(cr<=sr&&(sr=cr,Be.set(1,0,0)),Br<=sr&&(sr=Br,Be.set(0,1,0)),tn<=sr&&Be.set(0,0,1),Je.crossVectors(De[0],Be).normalize(),Ve[0].crossVectors(De[0],Je),Fe[0].crossVectors(De[0],Ve[0]),Ke=1;Ke<=$e;Ke++)Ve[Ke]=Ve[Ke-1].clone(),Fe[Ke]=Fe[Ke-1].clone(),Je.crossVectors(De[Ke-1],De[Ke]),Je.length()>Number.EPSILON&&(Je.normalize(),or=Math.acos(MathUtils.clamp(De[Ke-1].dot(De[Ke]),-1,1)),Ve[Ke].applyMatrix4(Xe.makeRotationAxis(Je,or))),Fe[Ke].crossVectors(De[Ke],Ve[Ke]);if(Se===!0)for(or=Math.acos(MathUtils.clamp(Ve[0].dot(Ve[$e]),-1,1)),or/=$e,De[0].dot(Je.crossVectors(Ve[0],Ve[$e]))>0&&(or=-or),Ke=1;Ke<=$e;Ke++)Ve[Ke].applyMatrix4(Xe.makeRotationAxis(De[Ke],or*Ke)),Fe[Ke].crossVectors(De[Ke],Ve[Ke]);return{tangents:De,normals:Ve,binormals:Fe}},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.arcLengthDivisions=$e.arcLengthDivisions,this},toJSON:function(){var $e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return $e.arcLengthDivisions=this.arcLengthDivisions,$e.type=this.type,$e},fromJSON:function($e){return this.arcLengthDivisions=$e.arcLengthDivisions,this}});function EllipseCurve($e,Se,Be,De,Ve,Fe,Je,Xe){Curve.call(this),this.type="EllipseCurve",this.aX=$e||0,this.aY=Se||0,this.xRadius=Be||1,this.yRadius=De||1,this.aStartAngle=Ve||0,this.aEndAngle=Fe||2*Math.PI,this.aClockwise=Je||!1,this.aRotation=Xe||0}EllipseCurve.prototype=Object.create(Curve.prototype);EllipseCurve.prototype.constructor=EllipseCurve;EllipseCurve.prototype.isEllipseCurve=!0;EllipseCurve.prototype.getPoint=function($e,Se){for(var Be=Se||new Vector2,De=Math.PI*2,Ve=this.aEndAngle-this.aStartAngle,Fe=Math.abs(Ve)<Number.EPSILON;Ve<0;)Ve+=De;for(;Ve>De;)Ve-=De;Ve<Number.EPSILON&&(Fe?Ve=0:Ve=De),this.aClockwise===!0&&!Fe&&(Ve===De?Ve=-De:Ve=Ve-De);var Je=this.aStartAngle+$e*Ve,Xe=this.aX+this.xRadius*Math.cos(Je),Ke=this.aY+this.yRadius*Math.sin(Je);if(this.aRotation!==0){var Ye=Math.cos(this.aRotation),or=Math.sin(this.aRotation),sr=Xe-this.aX,cr=Ke-this.aY;Xe=sr*Ye-cr*or+this.aX,Ke=sr*or+cr*Ye+this.aY}return Be.set(Xe,Ke)};EllipseCurve.prototype.copy=function($e){return Curve.prototype.copy.call(this,$e),this.aX=$e.aX,this.aY=$e.aY,this.xRadius=$e.xRadius,this.yRadius=$e.yRadius,this.aStartAngle=$e.aStartAngle,this.aEndAngle=$e.aEndAngle,this.aClockwise=$e.aClockwise,this.aRotation=$e.aRotation,this};EllipseCurve.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);return $e.aX=this.aX,$e.aY=this.aY,$e.xRadius=this.xRadius,$e.yRadius=this.yRadius,$e.aStartAngle=this.aStartAngle,$e.aEndAngle=this.aEndAngle,$e.aClockwise=this.aClockwise,$e.aRotation=this.aRotation,$e};EllipseCurve.prototype.fromJSON=function($e){return Curve.prototype.fromJSON.call(this,$e),this.aX=$e.aX,this.aY=$e.aY,this.xRadius=$e.xRadius,this.yRadius=$e.yRadius,this.aStartAngle=$e.aStartAngle,this.aEndAngle=$e.aEndAngle,this.aClockwise=$e.aClockwise,this.aRotation=$e.aRotation,this};function ArcCurve($e,Se,Be,De,Ve,Fe){EllipseCurve.call(this,$e,Se,Be,Be,De,Ve,Fe),this.type="ArcCurve"}ArcCurve.prototype=Object.create(EllipseCurve.prototype);ArcCurve.prototype.constructor=ArcCurve;ArcCurve.prototype.isArcCurve=!0;function CubicPoly(){var $e=0,Se=0,Be=0,De=0;function Ve(Fe,Je,Xe,Ke){$e=Fe,Se=Xe,Be=-3*Fe+3*Je-2*Xe-Ke,De=2*Fe-2*Je+Xe+Ke}return{initCatmullRom:function(Fe,Je,Xe,Ke,Ye){Ve(Je,Xe,Ye*(Xe-Fe),Ye*(Ke-Je))},initNonuniformCatmullRom:function(Fe,Je,Xe,Ke,Ye,or,sr){var cr=(Je-Fe)/Ye-(Xe-Fe)/(Ye+or)+(Xe-Je)/or,Br=(Xe-Je)/or-(Ke-Je)/(or+sr)+(Ke-Xe)/sr;cr*=or,Br*=or,Ve(Je,Xe,cr,Br)},calc:function(Fe){var Je=Fe*Fe,Xe=Je*Fe;return $e+Se*Fe+Be*Je+De*Xe}}}var tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;function CatmullRomCurve3($e,Se,Be,De){Curve.call(this),this.type="CatmullRomCurve3",this.points=$e||[],this.closed=Se||!1,this.curveType=Be||"centripetal",this.tension=De||.5}CatmullRomCurve3.prototype=Object.create(Curve.prototype);CatmullRomCurve3.prototype.constructor=CatmullRomCurve3;CatmullRomCurve3.prototype.isCatmullRomCurve3=!0;CatmullRomCurve3.prototype.getPoint=function($e,Se){var Be=Se||new Vector3,De=this.points,Ve=De.length,Fe=(Ve-(this.closed?0:1))*$e,Je=Math.floor(Fe),Xe=Fe-Je;this.closed?Je+=Je>0?0:(Math.floor(Math.abs(Je)/Ve)+1)*Ve:Xe===0&&Je===Ve-1&&(Je=Ve-2,Xe=1);var Ke,Ye,or,sr;if(this.closed||Je>0?Ke=De[(Je-1)%Ve]:(tmp.subVectors(De[0],De[1]).add(De[0]),Ke=tmp),Ye=De[Je%Ve],or=De[(Je+1)%Ve],this.closed||Je+2<Ve?sr=De[(Je+2)%Ve]:(tmp.subVectors(De[Ve-1],De[Ve-2]).add(De[Ve-1]),sr=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){var cr=this.curveType==="chordal"?.5:.25,Br=Math.pow(Ke.distanceToSquared(Ye),cr),tn=Math.pow(Ye.distanceToSquared(or),cr),en=Math.pow(or.distanceToSquared(sr),cr);tn<1e-4&&(tn=1),Br<1e-4&&(Br=tn),en<1e-4&&(en=tn),px.initNonuniformCatmullRom(Ke.x,Ye.x,or.x,sr.x,Br,tn,en),py.initNonuniformCatmullRom(Ke.y,Ye.y,or.y,sr.y,Br,tn,en),pz.initNonuniformCatmullRom(Ke.z,Ye.z,or.z,sr.z,Br,tn,en)}else this.curveType==="catmullrom"&&(px.initCatmullRom(Ke.x,Ye.x,or.x,sr.x,this.tension),py.initCatmullRom(Ke.y,Ye.y,or.y,sr.y,this.tension),pz.initCatmullRom(Ke.z,Ye.z,or.z,sr.z,this.tension));return Be.set(px.calc(Xe),py.calc(Xe),pz.calc(Xe)),Be};CatmullRomCurve3.prototype.copy=function($e){Curve.prototype.copy.call(this,$e),this.points=[];for(var Se=0,Be=$e.points.length;Se<Be;Se++){var De=$e.points[Se];this.points.push(De.clone())}return this.closed=$e.closed,this.curveType=$e.curveType,this.tension=$e.tension,this};CatmullRomCurve3.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);$e.points=[];for(var Se=0,Be=this.points.length;Se<Be;Se++){var De=this.points[Se];$e.points.push(De.toArray())}return $e.closed=this.closed,$e.curveType=this.curveType,$e.tension=this.tension,$e};CatmullRomCurve3.prototype.fromJSON=function($e){Curve.prototype.fromJSON.call(this,$e),this.points=[];for(var Se=0,Be=$e.points.length;Se<Be;Se++){var De=$e.points[Se];this.points.push(new Vector3().fromArray(De))}return this.closed=$e.closed,this.curveType=$e.curveType,this.tension=$e.tension,this};function CatmullRom($e,Se,Be,De,Ve){var Fe=(De-Se)*.5,Je=(Ve-Be)*.5,Xe=$e*$e,Ke=$e*Xe;return(2*Be-2*De+Fe+Je)*Ke+(-3*Be+3*De-2*Fe-Je)*Xe+Fe*$e+Be}function QuadraticBezierP0($e,Se){var Be=1-$e;return Be*Be*Se}function QuadraticBezierP1($e,Se){return 2*(1-$e)*$e*Se}function QuadraticBezierP2($e,Se){return $e*$e*Se}function QuadraticBezier($e,Se,Be,De){return QuadraticBezierP0($e,Se)+QuadraticBezierP1($e,Be)+QuadraticBezierP2($e,De)}function CubicBezierP0($e,Se){var Be=1-$e;return Be*Be*Be*Se}function CubicBezierP1($e,Se){var Be=1-$e;return 3*Be*Be*$e*Se}function CubicBezierP2($e,Se){return 3*(1-$e)*$e*$e*Se}function CubicBezierP3($e,Se){return $e*$e*$e*Se}function CubicBezier($e,Se,Be,De,Ve){return CubicBezierP0($e,Se)+CubicBezierP1($e,Be)+CubicBezierP2($e,De)+CubicBezierP3($e,Ve)}function CubicBezierCurve($e,Se,Be,De){Curve.call(this),this.type="CubicBezierCurve",this.v0=$e||new Vector2,this.v1=Se||new Vector2,this.v2=Be||new Vector2,this.v3=De||new Vector2}CubicBezierCurve.prototype=Object.create(Curve.prototype);CubicBezierCurve.prototype.constructor=CubicBezierCurve;CubicBezierCurve.prototype.isCubicBezierCurve=!0;CubicBezierCurve.prototype.getPoint=function($e,Se){var Be=Se||new Vector2,De=this.v0,Ve=this.v1,Fe=this.v2,Je=this.v3;return Be.set(CubicBezier($e,De.x,Ve.x,Fe.x,Je.x),CubicBezier($e,De.y,Ve.y,Fe.y,Je.y)),Be};CubicBezierCurve.prototype.copy=function($e){return Curve.prototype.copy.call(this,$e),this.v0.copy($e.v0),this.v1.copy($e.v1),this.v2.copy($e.v2),this.v3.copy($e.v3),this};CubicBezierCurve.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);return $e.v0=this.v0.toArray(),$e.v1=this.v1.toArray(),$e.v2=this.v2.toArray(),$e.v3=this.v3.toArray(),$e};CubicBezierCurve.prototype.fromJSON=function($e){return Curve.prototype.fromJSON.call(this,$e),this.v0.fromArray($e.v0),this.v1.fromArray($e.v1),this.v2.fromArray($e.v2),this.v3.fromArray($e.v3),this};function CubicBezierCurve3($e,Se,Be,De){Curve.call(this),this.type="CubicBezierCurve3",this.v0=$e||new Vector3,this.v1=Se||new Vector3,this.v2=Be||new Vector3,this.v3=De||new Vector3}CubicBezierCurve3.prototype=Object.create(Curve.prototype);CubicBezierCurve3.prototype.constructor=CubicBezierCurve3;CubicBezierCurve3.prototype.isCubicBezierCurve3=!0;CubicBezierCurve3.prototype.getPoint=function($e,Se){var Be=Se||new Vector3,De=this.v0,Ve=this.v1,Fe=this.v2,Je=this.v3;return Be.set(CubicBezier($e,De.x,Ve.x,Fe.x,Je.x),CubicBezier($e,De.y,Ve.y,Fe.y,Je.y),CubicBezier($e,De.z,Ve.z,Fe.z,Je.z)),Be};CubicBezierCurve3.prototype.copy=function($e){return Curve.prototype.copy.call(this,$e),this.v0.copy($e.v0),this.v1.copy($e.v1),this.v2.copy($e.v2),this.v3.copy($e.v3),this};CubicBezierCurve3.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);return $e.v0=this.v0.toArray(),$e.v1=this.v1.toArray(),$e.v2=this.v2.toArray(),$e.v3=this.v3.toArray(),$e};CubicBezierCurve3.prototype.fromJSON=function($e){return Curve.prototype.fromJSON.call(this,$e),this.v0.fromArray($e.v0),this.v1.fromArray($e.v1),this.v2.fromArray($e.v2),this.v3.fromArray($e.v3),this};function LineCurve($e,Se){Curve.call(this),this.type="LineCurve",this.v1=$e||new Vector2,this.v2=Se||new Vector2}LineCurve.prototype=Object.create(Curve.prototype);LineCurve.prototype.constructor=LineCurve;LineCurve.prototype.isLineCurve=!0;LineCurve.prototype.getPoint=function($e,Se){var Be=Se||new Vector2;return $e===1?Be.copy(this.v2):(Be.copy(this.v2).sub(this.v1),Be.multiplyScalar($e).add(this.v1)),Be};LineCurve.prototype.getPointAt=function($e,Se){return this.getPoint($e,Se)};LineCurve.prototype.getTangent=function($e,Se){var Be=Se||new Vector2,Be=Be.copy(this.v2).sub(this.v1).normalize();return Be};LineCurve.prototype.copy=function($e){return Curve.prototype.copy.call(this,$e),this.v1.copy($e.v1),this.v2.copy($e.v2),this};LineCurve.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);return $e.v1=this.v1.toArray(),$e.v2=this.v2.toArray(),$e};LineCurve.prototype.fromJSON=function($e){return Curve.prototype.fromJSON.call(this,$e),this.v1.fromArray($e.v1),this.v2.fromArray($e.v2),this};function LineCurve3($e,Se){Curve.call(this),this.type="LineCurve3",this.v1=$e||new Vector3,this.v2=Se||new Vector3}LineCurve3.prototype=Object.create(Curve.prototype);LineCurve3.prototype.constructor=LineCurve3;LineCurve3.prototype.isLineCurve3=!0;LineCurve3.prototype.getPoint=function($e,Se){var Be=Se||new Vector3;return $e===1?Be.copy(this.v2):(Be.copy(this.v2).sub(this.v1),Be.multiplyScalar($e).add(this.v1)),Be};LineCurve3.prototype.getPointAt=function($e,Se){return this.getPoint($e,Se)};LineCurve3.prototype.copy=function($e){return Curve.prototype.copy.call(this,$e),this.v1.copy($e.v1),this.v2.copy($e.v2),this};LineCurve3.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);return $e.v1=this.v1.toArray(),$e.v2=this.v2.toArray(),$e};LineCurve3.prototype.fromJSON=function($e){return Curve.prototype.fromJSON.call(this,$e),this.v1.fromArray($e.v1),this.v2.fromArray($e.v2),this};function QuadraticBezierCurve($e,Se,Be){Curve.call(this),this.type="QuadraticBezierCurve",this.v0=$e||new Vector2,this.v1=Se||new Vector2,this.v2=Be||new Vector2}QuadraticBezierCurve.prototype=Object.create(Curve.prototype);QuadraticBezierCurve.prototype.constructor=QuadraticBezierCurve;QuadraticBezierCurve.prototype.isQuadraticBezierCurve=!0;QuadraticBezierCurve.prototype.getPoint=function($e,Se){var Be=Se||new Vector2,De=this.v0,Ve=this.v1,Fe=this.v2;return Be.set(QuadraticBezier($e,De.x,Ve.x,Fe.x),QuadraticBezier($e,De.y,Ve.y,Fe.y)),Be};QuadraticBezierCurve.prototype.copy=function($e){return Curve.prototype.copy.call(this,$e),this.v0.copy($e.v0),this.v1.copy($e.v1),this.v2.copy($e.v2),this};QuadraticBezierCurve.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);return $e.v0=this.v0.toArray(),$e.v1=this.v1.toArray(),$e.v2=this.v2.toArray(),$e};QuadraticBezierCurve.prototype.fromJSON=function($e){return Curve.prototype.fromJSON.call(this,$e),this.v0.fromArray($e.v0),this.v1.fromArray($e.v1),this.v2.fromArray($e.v2),this};function QuadraticBezierCurve3($e,Se,Be){Curve.call(this),this.type="QuadraticBezierCurve3",this.v0=$e||new Vector3,this.v1=Se||new Vector3,this.v2=Be||new Vector3}QuadraticBezierCurve3.prototype=Object.create(Curve.prototype);QuadraticBezierCurve3.prototype.constructor=QuadraticBezierCurve3;QuadraticBezierCurve3.prototype.isQuadraticBezierCurve3=!0;QuadraticBezierCurve3.prototype.getPoint=function($e,Se){var Be=Se||new Vector3,De=this.v0,Ve=this.v1,Fe=this.v2;return Be.set(QuadraticBezier($e,De.x,Ve.x,Fe.x),QuadraticBezier($e,De.y,Ve.y,Fe.y),QuadraticBezier($e,De.z,Ve.z,Fe.z)),Be};QuadraticBezierCurve3.prototype.copy=function($e){return Curve.prototype.copy.call(this,$e),this.v0.copy($e.v0),this.v1.copy($e.v1),this.v2.copy($e.v2),this};QuadraticBezierCurve3.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);return $e.v0=this.v0.toArray(),$e.v1=this.v1.toArray(),$e.v2=this.v2.toArray(),$e};QuadraticBezierCurve3.prototype.fromJSON=function($e){return Curve.prototype.fromJSON.call(this,$e),this.v0.fromArray($e.v0),this.v1.fromArray($e.v1),this.v2.fromArray($e.v2),this};function SplineCurve($e){Curve.call(this),this.type="SplineCurve",this.points=$e||[]}SplineCurve.prototype=Object.create(Curve.prototype);SplineCurve.prototype.constructor=SplineCurve;SplineCurve.prototype.isSplineCurve=!0;SplineCurve.prototype.getPoint=function($e,Se){var Be=Se||new Vector2,De=this.points,Ve=(De.length-1)*$e,Fe=Math.floor(Ve),Je=Ve-Fe,Xe=De[Fe===0?Fe:Fe-1],Ke=De[Fe],Ye=De[Fe>De.length-2?De.length-1:Fe+1],or=De[Fe>De.length-3?De.length-1:Fe+2];return Be.set(CatmullRom(Je,Xe.x,Ke.x,Ye.x,or.x),CatmullRom(Je,Xe.y,Ke.y,Ye.y,or.y)),Be};SplineCurve.prototype.copy=function($e){Curve.prototype.copy.call(this,$e),this.points=[];for(var Se=0,Be=$e.points.length;Se<Be;Se++){var De=$e.points[Se];this.points.push(De.clone())}return this};SplineCurve.prototype.toJSON=function(){var $e=Curve.prototype.toJSON.call(this);$e.points=[];for(var Se=0,Be=this.points.length;Se<Be;Se++){var De=this.points[Se];$e.points.push(De.toArray())}return $e};SplineCurve.prototype.fromJSON=function($e){Curve.prototype.fromJSON.call(this,$e),this.points=[];for(var Se=0,Be=$e.points.length;Se<Be;Se++){var De=$e.points[Se];this.points.push(new Vector2().fromArray(De))}return this};var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});function CurvePath(){Curve.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}CurvePath.prototype=Object.assign(Object.create(Curve.prototype),{constructor:CurvePath,add:function($e){this.curves.push($e)},closePath:function(){var $e=this.curves[0].getPoint(0),Se=this.curves[this.curves.length-1].getPoint(1);$e.equals(Se)||this.curves.push(new LineCurve(Se,$e))},getPoint:function($e){for(var Se=$e*this.getLength(),Be=this.getCurveLengths(),De=0;De<Be.length;){if(Be[De]>=Se){var Ve=Be[De]-Se,Fe=this.curves[De],Je=Fe.getLength(),Xe=Je===0?0:1-Ve/Je;return Fe.getPointAt(Xe)}De++}return null},getLength:function(){var $e=this.getCurveLengths();return $e[$e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var $e=[],Se=0,Be=0,De=this.curves.length;Be<De;Be++)Se+=this.curves[Be].getLength(),$e.push(Se);return this.cacheLengths=$e,$e},getSpacedPoints:function($e){$e===void 0&&($e=40);for(var Se=[],Be=0;Be<=$e;Be++)Se.push(this.getPoint(Be/$e));return this.autoClose&&Se.push(Se[0]),Se},getPoints:function($e){$e=$e||12;for(var Se=[],Be,De=0,Ve=this.curves;De<Ve.length;De++)for(var Fe=Ve[De],Je=Fe&&Fe.isEllipseCurve?$e*2:Fe&&(Fe.isLineCurve||Fe.isLineCurve3)?1:Fe&&Fe.isSplineCurve?$e*Fe.points.length:$e,Xe=Fe.getPoints(Je),Ke=0;Ke<Xe.length;Ke++){var Ye=Xe[Ke];Be&&Be.equals(Ye)||(Se.push(Ye),Be=Ye)}return this.autoClose&&Se.length>1&&!Se[Se.length-1].equals(Se[0])&&Se.push(Se[0]),Se},copy:function($e){Curve.prototype.copy.call(this,$e),this.curves=[];for(var Se=0,Be=$e.curves.length;Se<Be;Se++){var De=$e.curves[Se];this.curves.push(De.clone())}return this.autoClose=$e.autoClose,this},toJSON:function(){var $e=Curve.prototype.toJSON.call(this);$e.autoClose=this.autoClose,$e.curves=[];for(var Se=0,Be=this.curves.length;Se<Be;Se++){var De=this.curves[Se];$e.curves.push(De.toJSON())}return $e},fromJSON:function($e){Curve.prototype.fromJSON.call(this,$e),this.autoClose=$e.autoClose,this.curves=[];for(var Se=0,Be=$e.curves.length;Se<Be;Se++){var De=$e.curves[Se];this.curves.push(new Curves[De.type]().fromJSON(De))}return this}});function Path($e){CurvePath.call(this),this.type="Path",this.currentPoint=new Vector2,$e&&this.setFromPoints($e)}Path.prototype=Object.assign(Object.create(CurvePath.prototype),{constructor:Path,setFromPoints:function($e){this.moveTo($e[0].x,$e[0].y);for(var Se=1,Be=$e.length;Se<Be;Se++)this.lineTo($e[Se].x,$e[Se].y);return this},moveTo:function($e,Se){return this.currentPoint.set($e,Se),this},lineTo:function($e,Se){var Be=new LineCurve(this.currentPoint.clone(),new Vector2($e,Se));return this.curves.push(Be),this.currentPoint.set($e,Se),this},quadraticCurveTo:function($e,Se,Be,De){var Ve=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2($e,Se),new Vector2(Be,De));return this.curves.push(Ve),this.currentPoint.set(Be,De),this},bezierCurveTo:function($e,Se,Be,De,Ve,Fe){var Je=new CubicBezierCurve(this.currentPoint.clone(),new Vector2($e,Se),new Vector2(Be,De),new Vector2(Ve,Fe));return this.curves.push(Je),this.currentPoint.set(Ve,Fe),this},splineThru:function($e){var Se=[this.currentPoint.clone()].concat($e),Be=new SplineCurve(Se);return this.curves.push(Be),this.currentPoint.copy($e[$e.length-1]),this},arc:function($e,Se,Be,De,Ve,Fe){var Je=this.currentPoint.x,Xe=this.currentPoint.y;return this.absarc($e+Je,Se+Xe,Be,De,Ve,Fe),this},absarc:function($e,Se,Be,De,Ve,Fe){return this.absellipse($e,Se,Be,Be,De,Ve,Fe),this},ellipse:function($e,Se,Be,De,Ve,Fe,Je,Xe){var Ke=this.currentPoint.x,Ye=this.currentPoint.y;return this.absellipse($e+Ke,Se+Ye,Be,De,Ve,Fe,Je,Xe),this},absellipse:function($e,Se,Be,De,Ve,Fe,Je,Xe){var Ke=new EllipseCurve($e,Se,Be,De,Ve,Fe,Je,Xe);if(this.curves.length>0){var Ye=Ke.getPoint(0);Ye.equals(this.currentPoint)||this.lineTo(Ye.x,Ye.y)}this.curves.push(Ke);var or=Ke.getPoint(1);return this.currentPoint.copy(or),this},copy:function($e){return CurvePath.prototype.copy.call(this,$e),this.currentPoint.copy($e.currentPoint),this},toJSON:function(){var $e=CurvePath.prototype.toJSON.call(this);return $e.currentPoint=this.currentPoint.toArray(),$e},fromJSON:function($e){return CurvePath.prototype.fromJSON.call(this,$e),this.currentPoint.fromArray($e.currentPoint),this}});function Shape($e){Path.call(this,$e),this.uuid=MathUtils.generateUUID(),this.type="Shape",this.holes=[]}Shape.prototype=Object.assign(Object.create(Path.prototype),{constructor:Shape,getPointsHoles:function($e){for(var Se=[],Be=0,De=this.holes.length;Be<De;Be++)Se[Be]=this.holes[Be].getPoints($e);return Se},extractPoints:function($e){return{shape:this.getPoints($e),holes:this.getPointsHoles($e)}},copy:function($e){Path.prototype.copy.call(this,$e),this.holes=[];for(var Se=0,Be=$e.holes.length;Se<Be;Se++){var De=$e.holes[Se];this.holes.push(De.clone())}return this},toJSON:function(){var $e=Path.prototype.toJSON.call(this);$e.uuid=this.uuid,$e.holes=[];for(var Se=0,Be=this.holes.length;Se<Be;Se++){var De=this.holes[Se];$e.holes.push(De.toJSON())}return $e},fromJSON:function($e){Path.prototype.fromJSON.call(this,$e),this.uuid=$e.uuid,this.holes=[];for(var Se=0,Be=$e.holes.length;Se<Be;Se++){var De=$e.holes[Se];this.holes.push(new Path().fromJSON(De))}return this}});function Light($e,Se){Object3D.call(this),this.type="Light",this.color=new Color($e),this.intensity=Se!==void 0?Se:1,this.receiveShadow=void 0}Light.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Light,isLight:!0,copy:function($e){return Object3D.prototype.copy.call(this,$e),this.color.copy($e.color),this.intensity=$e.intensity,this},toJSON:function($e){var Se=Object3D.prototype.toJSON.call(this,$e);return Se.object.color=this.color.getHex(),Se.object.intensity=this.intensity,this.groundColor!==void 0&&(Se.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(Se.object.distance=this.distance),this.angle!==void 0&&(Se.object.angle=this.angle),this.decay!==void 0&&(Se.object.decay=this.decay),this.penumbra!==void 0&&(Se.object.penumbra=this.penumbra),this.shadow!==void 0&&(Se.object.shadow=this.shadow.toJSON()),Se}});function HemisphereLight($e,Se,Be){Light.call(this,$e,Be),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.groundColor=new Color(Se)}HemisphereLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:HemisphereLight,isHemisphereLight:!0,copy:function($e){return Light.prototype.copy.call(this,$e),this.groundColor.copy($e.groundColor),this}});function LightShadow($e){this.camera=$e,this.bias=0,this.radius=1,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}Object.assign(LightShadow.prototype,{_projScreenMatrix:new Matrix4,_lightPositionWorld:new Vector3,_lookTarget:new Vector3,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function($e){var Se=this.camera,Be=this.matrix,De=this._projScreenMatrix,Ve=this._lookTarget,Fe=this._lightPositionWorld;Fe.setFromMatrixPosition($e.matrixWorld),Se.position.copy(Fe),Ve.setFromMatrixPosition($e.target.matrixWorld),Se.lookAt(Ve),Se.updateMatrixWorld(),De.multiplyMatrices(Se.projectionMatrix,Se.matrixWorldInverse),this._frustum.setFromProjectionMatrix(De),Be.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Be.multiply(Se.projectionMatrix),Be.multiply(Se.matrixWorldInverse)},getViewport:function($e){return this._viewports[$e]},getFrameExtents:function(){return this._frameExtents},copy:function($e){return this.camera=$e.camera.clone(),this.bias=$e.bias,this.radius=$e.radius,this.mapSize.copy($e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var $e={};return this.bias!==0&&($e.bias=this.bias),this.radius!==1&&($e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&($e.mapSize=this.mapSize.toArray()),$e.camera=this.camera.toJSON(!1).object,delete $e.camera.matrix,$e}});function SpotLightShadow(){LightShadow.call(this,new PerspectiveCamera(50,1,.5,500))}SpotLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:SpotLightShadow,isSpotLightShadow:!0,updateMatrices:function($e){var Se=this.camera,Be=MathUtils.RAD2DEG*2*$e.angle,De=this.mapSize.width/this.mapSize.height,Ve=$e.distance||Se.far;(Be!==Se.fov||De!==Se.aspect||Ve!==Se.far)&&(Se.fov=Be,Se.aspect=De,Se.far=Ve,Se.updateProjectionMatrix()),LightShadow.prototype.updateMatrices.call(this,$e)}});function SpotLight($e,Se,Be,De,Ve,Fe){Light.call(this,$e,Se),this.type="SpotLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(Je){this.intensity=Je/Math.PI}}),this.distance=Be!==void 0?Be:0,this.angle=De!==void 0?De:Math.PI/3,this.penumbra=Ve!==void 0?Ve:0,this.decay=Fe!==void 0?Fe:1,this.shadow=new SpotLightShadow}SpotLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:SpotLight,isSpotLight:!0,copy:function($e){return Light.prototype.copy.call(this,$e),this.distance=$e.distance,this.angle=$e.angle,this.penumbra=$e.penumbra,this.decay=$e.decay,this.target=$e.target.clone(),this.shadow=$e.shadow.clone(),this}});function PointLightShadow(){LightShadow.call(this,new PerspectiveCamera(90,1,.5,500)),this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}PointLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:PointLightShadow,isPointLightShadow:!0,updateMatrices:function($e,Se){Se===void 0&&(Se=0);var Be=this.camera,De=this.matrix,Ve=this._lightPositionWorld,Fe=this._lookTarget,Je=this._projScreenMatrix;Ve.setFromMatrixPosition($e.matrixWorld),Be.position.copy(Ve),Fe.copy(Be.position),Fe.add(this._cubeDirections[Se]),Be.up.copy(this._cubeUps[Se]),Be.lookAt(Fe),Be.updateMatrixWorld(),De.makeTranslation(-Ve.x,-Ve.y,-Ve.z),Je.multiplyMatrices(Be.projectionMatrix,Be.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Je)}});function PointLight($e,Se,Be,De){Light.call(this,$e,Se),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(Ve){this.intensity=Ve/(4*Math.PI)}}),this.distance=Be!==void 0?Be:0,this.decay=De!==void 0?De:1,this.shadow=new PointLightShadow}PointLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:PointLight,isPointLight:!0,copy:function($e){return Light.prototype.copy.call(this,$e),this.distance=$e.distance,this.decay=$e.decay,this.shadow=$e.shadow.clone(),this}});function OrthographicCamera($e,Se,Be,De,Ve,Fe){Camera$1.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=$e!==void 0?$e:-1,this.right=Se!==void 0?Se:1,this.top=Be!==void 0?Be:1,this.bottom=De!==void 0?De:-1,this.near=Ve!==void 0?Ve:.1,this.far=Fe!==void 0?Fe:2e3,this.updateProjectionMatrix()}OrthographicCamera.prototype=Object.assign(Object.create(Camera$1.prototype),{constructor:OrthographicCamera,isOrthographicCamera:!0,copy:function($e,Se){return Camera$1.prototype.copy.call(this,$e,Se),this.left=$e.left,this.right=$e.right,this.top=$e.top,this.bottom=$e.bottom,this.near=$e.near,this.far=$e.far,this.zoom=$e.zoom,this.view=$e.view===null?null:Object.assign({},$e.view),this},setViewOffset:function($e,Se,Be,De,Ve,Fe){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=$e,this.view.fullHeight=Se,this.view.offsetX=Be,this.view.offsetY=De,this.view.width=Ve,this.view.height=Fe,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var $e=(this.right-this.left)/(2*this.zoom),Se=(this.top-this.bottom)/(2*this.zoom),Be=(this.right+this.left)/2,De=(this.top+this.bottom)/2,Ve=Be-$e,Fe=Be+$e,Je=De+Se,Xe=De-Se;if(this.view!==null&&this.view.enabled){var Ke=(this.right-this.left)/this.view.fullWidth/this.zoom,Ye=(this.top-this.bottom)/this.view.fullHeight/this.zoom;Ve+=Ke*this.view.offsetX,Fe=Ve+Ke*this.view.width,Je-=Ye*this.view.offsetY,Xe=Je-Ye*this.view.height}this.projectionMatrix.makeOrthographic(Ve,Fe,Je,Xe,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function($e){var Se=Object3D.prototype.toJSON.call(this,$e);return Se.object.zoom=this.zoom,Se.object.left=this.left,Se.object.right=this.right,Se.object.top=this.top,Se.object.bottom=this.bottom,Se.object.near=this.near,Se.object.far=this.far,this.view!==null&&(Se.object.view=Object.assign({},this.view)),Se}});function DirectionalLightShadow(){LightShadow.call(this,new OrthographicCamera(-5,5,5,-5,.5,500))}DirectionalLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:DirectionalLightShadow,isDirectionalLightShadow:!0,updateMatrices:function($e){LightShadow.prototype.updateMatrices.call(this,$e)}});function DirectionalLight($e,Se){Light.call(this,$e,Se),this.type="DirectionalLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}DirectionalLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:DirectionalLight,isDirectionalLight:!0,copy:function($e){return Light.prototype.copy.call(this,$e),this.target=$e.target.clone(),this.shadow=$e.shadow.clone(),this}});function AmbientLight($e,Se){Light.call(this,$e,Se),this.type="AmbientLight",this.castShadow=void 0}AmbientLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:AmbientLight,isAmbientLight:!0});function RectAreaLight($e,Se,Be,De){Light.call(this,$e,Se),this.type="RectAreaLight",this.width=Be!==void 0?Be:10,this.height=De!==void 0?De:10}RectAreaLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:RectAreaLight,isRectAreaLight:!0,copy:function($e){return Light.prototype.copy.call(this,$e),this.width=$e.width,this.height=$e.height,this},toJSON:function($e){var Se=Light.prototype.toJSON.call(this,$e);return Se.object.width=this.width,Se.object.height=this.height,Se}});function SphericalHarmonics3(){this.coefficients=[];for(var $e=0;$e<9;$e++)this.coefficients.push(new Vector3)}Object.assign(SphericalHarmonics3.prototype,{isSphericalHarmonics3:!0,set:function($e){for(var Se=0;Se<9;Se++)this.coefficients[Se].copy($e[Se]);return this},zero:function(){for(var $e=0;$e<9;$e++)this.coefficients[$e].set(0,0,0);return this},getAt:function($e,Se){var Be=$e.x,De=$e.y,Ve=$e.z,Fe=this.coefficients;return Se.copy(Fe[0]).multiplyScalar(.282095),Se.addScaledVector(Fe[1],.488603*De),Se.addScaledVector(Fe[2],.488603*Ve),Se.addScaledVector(Fe[3],.488603*Be),Se.addScaledVector(Fe[4],1.092548*(Be*De)),Se.addScaledVector(Fe[5],1.092548*(De*Ve)),Se.addScaledVector(Fe[6],.315392*(3*Ve*Ve-1)),Se.addScaledVector(Fe[7],1.092548*(Be*Ve)),Se.addScaledVector(Fe[8],.546274*(Be*Be-De*De)),Se},getIrradianceAt:function($e,Se){var Be=$e.x,De=$e.y,Ve=$e.z,Fe=this.coefficients;return Se.copy(Fe[0]).multiplyScalar(.886227),Se.addScaledVector(Fe[1],2*.511664*De),Se.addScaledVector(Fe[2],2*.511664*Ve),Se.addScaledVector(Fe[3],2*.511664*Be),Se.addScaledVector(Fe[4],2*.429043*Be*De),Se.addScaledVector(Fe[5],2*.429043*De*Ve),Se.addScaledVector(Fe[6],.743125*Ve*Ve-.247708),Se.addScaledVector(Fe[7],2*.429043*Be*Ve),Se.addScaledVector(Fe[8],.429043*(Be*Be-De*De)),Se},add:function($e){for(var Se=0;Se<9;Se++)this.coefficients[Se].add($e.coefficients[Se]);return this},addScaledSH:function($e,Se){for(var Be=0;Be<9;Be++)this.coefficients[Be].addScaledVector($e.coefficients[Be],Se);return this},scale:function($e){for(var Se=0;Se<9;Se++)this.coefficients[Se].multiplyScalar($e);return this},lerp:function($e,Se){for(var Be=0;Be<9;Be++)this.coefficients[Be].lerp($e.coefficients[Be],Se);return this},equals:function($e){for(var Se=0;Se<9;Se++)if(!this.coefficients[Se].equals($e.coefficients[Se]))return!1;return!0},copy:function($e){return this.set($e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function($e,Se){Se===void 0&&(Se=0);for(var Be=this.coefficients,De=0;De<9;De++)Be[De].fromArray($e,Se+De*3);return this},toArray:function($e,Se){$e===void 0&&($e=[]),Se===void 0&&(Se=0);for(var Be=this.coefficients,De=0;De<9;De++)Be[De].toArray($e,Se+De*3);return $e}});Object.assign(SphericalHarmonics3,{getBasisAt:function($e,Se){var Be=$e.x,De=$e.y,Ve=$e.z;Se[0]=.282095,Se[1]=.488603*De,Se[2]=.488603*Ve,Se[3]=.488603*Be,Se[4]=1.092548*Be*De,Se[5]=1.092548*De*Ve,Se[6]=.315392*(3*Ve*Ve-1),Se[7]=1.092548*Be*Ve,Se[8]=.546274*(Be*Be-De*De)}});function LightProbe($e,Se){Light.call(this,void 0,Se),this.type="LightProbe",this.sh=$e!==void 0?$e:new SphericalHarmonics3}LightProbe.prototype=Object.assign(Object.create(Light.prototype),{constructor:LightProbe,isLightProbe:!0,copy:function($e){return Light.prototype.copy.call(this,$e),this.sh.copy($e.sh),this},fromJSON:function($e){return this.intensity=$e.intensity,this.sh.fromArray($e.sh),this},toJSON:function($e){var Se=Light.prototype.toJSON.call(this,$e);return Se.object.sh=this.sh.toArray(),Se}});function MaterialLoader($e){Loader.call(this,$e),this.textures={}}MaterialLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:MaterialLoader,load:function($e,Se,Be,De){var Ve=this,Fe=new FileLoader(Ve.manager);Fe.setPath(Ve.path),Fe.load($e,function(Je){try{Se(Ve.parse(JSON.parse(Je)))}catch(Xe){De?De(Xe):console.error(Xe),Ve.manager.itemError($e)}},Be,De)},parse:function($e){var Se=this.textures;function Be(Ke){return Se[Ke]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",Ke),Se[Ke]}var De=new Materials[$e.type];if($e.uuid!==void 0&&(De.uuid=$e.uuid),$e.name!==void 0&&(De.name=$e.name),$e.color!==void 0&&De.color.setHex($e.color),$e.roughness!==void 0&&(De.roughness=$e.roughness),$e.metalness!==void 0&&(De.metalness=$e.metalness),$e.sheen!==void 0&&(De.sheen=new Color().setHex($e.sheen)),$e.emissive!==void 0&&De.emissive.setHex($e.emissive),$e.specular!==void 0&&De.specular.setHex($e.specular),$e.shininess!==void 0&&(De.shininess=$e.shininess),$e.clearcoat!==void 0&&(De.clearcoat=$e.clearcoat),$e.clearcoatRoughness!==void 0&&(De.clearcoatRoughness=$e.clearcoatRoughness),$e.fog!==void 0&&(De.fog=$e.fog),$e.flatShading!==void 0&&(De.flatShading=$e.flatShading),$e.blending!==void 0&&(De.blending=$e.blending),$e.combine!==void 0&&(De.combine=$e.combine),$e.side!==void 0&&(De.side=$e.side),$e.opacity!==void 0&&(De.opacity=$e.opacity),$e.transparent!==void 0&&(De.transparent=$e.transparent),$e.alphaTest!==void 0&&(De.alphaTest=$e.alphaTest),$e.depthTest!==void 0&&(De.depthTest=$e.depthTest),$e.depthWrite!==void 0&&(De.depthWrite=$e.depthWrite),$e.colorWrite!==void 0&&(De.colorWrite=$e.colorWrite),$e.stencilWrite!==void 0&&(De.stencilWrite=$e.stencilWrite),$e.stencilWriteMask!==void 0&&(De.stencilWriteMask=$e.stencilWriteMask),$e.stencilFunc!==void 0&&(De.stencilFunc=$e.stencilFunc),$e.stencilRef!==void 0&&(De.stencilRef=$e.stencilRef),$e.stencilFuncMask!==void 0&&(De.stencilFuncMask=$e.stencilFuncMask),$e.stencilFail!==void 0&&(De.stencilFail=$e.stencilFail),$e.stencilZFail!==void 0&&(De.stencilZFail=$e.stencilZFail),$e.stencilZPass!==void 0&&(De.stencilZPass=$e.stencilZPass),$e.wireframe!==void 0&&(De.wireframe=$e.wireframe),$e.wireframeLinewidth!==void 0&&(De.wireframeLinewidth=$e.wireframeLinewidth),$e.wireframeLinecap!==void 0&&(De.wireframeLinecap=$e.wireframeLinecap),$e.wireframeLinejoin!==void 0&&(De.wireframeLinejoin=$e.wireframeLinejoin),$e.rotation!==void 0&&(De.rotation=$e.rotation),$e.linewidth!==1&&(De.linewidth=$e.linewidth),$e.dashSize!==void 0&&(De.dashSize=$e.dashSize),$e.gapSize!==void 0&&(De.gapSize=$e.gapSize),$e.scale!==void 0&&(De.scale=$e.scale),$e.polygonOffset!==void 0&&(De.polygonOffset=$e.polygonOffset),$e.polygonOffsetFactor!==void 0&&(De.polygonOffsetFactor=$e.polygonOffsetFactor),$e.polygonOffsetUnits!==void 0&&(De.polygonOffsetUnits=$e.polygonOffsetUnits),$e.skinning!==void 0&&(De.skinning=$e.skinning),$e.morphTargets!==void 0&&(De.morphTargets=$e.morphTargets),$e.morphNormals!==void 0&&(De.morphNormals=$e.morphNormals),$e.dithering!==void 0&&(De.dithering=$e.dithering),$e.vertexTangents!==void 0&&(De.vertexTangents=$e.vertexTangents),$e.visible!==void 0&&(De.visible=$e.visible),$e.toneMapped!==void 0&&(De.toneMapped=$e.toneMapped),$e.userData!==void 0&&(De.userData=$e.userData),$e.vertexColors!==void 0&&(typeof $e.vertexColors=="number"?De.vertexColors=$e.vertexColors>0:De.vertexColors=$e.vertexColors),$e.uniforms!==void 0)for(var Ve in $e.uniforms){var Fe=$e.uniforms[Ve];switch(De.uniforms[Ve]={},Fe.type){case"t":De.uniforms[Ve].value=Be(Fe.value);break;case"c":De.uniforms[Ve].value=new Color().setHex(Fe.value);break;case"v2":De.uniforms[Ve].value=new Vector2().fromArray(Fe.value);break;case"v3":De.uniforms[Ve].value=new Vector3().fromArray(Fe.value);break;case"v4":De.uniforms[Ve].value=new Vector4().fromArray(Fe.value);break;case"m3":De.uniforms[Ve].value=new Matrix3().fromArray(Fe.value);case"m4":De.uniforms[Ve].value=new Matrix4().fromArray(Fe.value);break;default:De.uniforms[Ve].value=Fe.value}}if($e.defines!==void 0&&(De.defines=$e.defines),$e.vertexShader!==void 0&&(De.vertexShader=$e.vertexShader),$e.fragmentShader!==void 0&&(De.fragmentShader=$e.fragmentShader),$e.extensions!==void 0)for(var Je in $e.extensions)De.extensions[Je]=$e.extensions[Je];if($e.shading!==void 0&&(De.flatShading=$e.shading===1),$e.size!==void 0&&(De.size=$e.size),$e.sizeAttenuation!==void 0&&(De.sizeAttenuation=$e.sizeAttenuation),$e.map!==void 0&&(De.map=Be($e.map)),$e.matcap!==void 0&&(De.matcap=Be($e.matcap)),$e.alphaMap!==void 0&&(De.alphaMap=Be($e.alphaMap)),$e.bumpMap!==void 0&&(De.bumpMap=Be($e.bumpMap)),$e.bumpScale!==void 0&&(De.bumpScale=$e.bumpScale),$e.normalMap!==void 0&&(De.normalMap=Be($e.normalMap)),$e.normalMapType!==void 0&&(De.normalMapType=$e.normalMapType),$e.normalScale!==void 0){var Xe=$e.normalScale;Array.isArray(Xe)===!1&&(Xe=[Xe,Xe]),De.normalScale=new Vector2().fromArray(Xe)}return $e.displacementMap!==void 0&&(De.displacementMap=Be($e.displacementMap)),$e.displacementScale!==void 0&&(De.displacementScale=$e.displacementScale),$e.displacementBias!==void 0&&(De.displacementBias=$e.displacementBias),$e.roughnessMap!==void 0&&(De.roughnessMap=Be($e.roughnessMap)),$e.metalnessMap!==void 0&&(De.metalnessMap=Be($e.metalnessMap)),$e.emissiveMap!==void 0&&(De.emissiveMap=Be($e.emissiveMap)),$e.emissiveIntensity!==void 0&&(De.emissiveIntensity=$e.emissiveIntensity),$e.specularMap!==void 0&&(De.specularMap=Be($e.specularMap)),$e.envMap!==void 0&&(De.envMap=Be($e.envMap)),$e.envMapIntensity!==void 0&&(De.envMapIntensity=$e.envMapIntensity),$e.reflectivity!==void 0&&(De.reflectivity=$e.reflectivity),$e.refractionRatio!==void 0&&(De.refractionRatio=$e.refractionRatio),$e.lightMap!==void 0&&(De.lightMap=Be($e.lightMap)),$e.lightMapIntensity!==void 0&&(De.lightMapIntensity=$e.lightMapIntensity),$e.aoMap!==void 0&&(De.aoMap=Be($e.aoMap)),$e.aoMapIntensity!==void 0&&(De.aoMapIntensity=$e.aoMapIntensity),$e.gradientMap!==void 0&&(De.gradientMap=Be($e.gradientMap)),$e.clearcoatMap!==void 0&&(De.clearcoatMap=Be($e.clearcoatMap)),$e.clearcoatRoughnessMap!==void 0&&(De.clearcoatRoughnessMap=Be($e.clearcoatRoughnessMap)),$e.clearcoatNormalMap!==void 0&&(De.clearcoatNormalMap=Be($e.clearcoatNormalMap)),$e.clearcoatNormalScale!==void 0&&(De.clearcoatNormalScale=new Vector2().fromArray($e.clearcoatNormalScale)),De},setTextures:function($e){return this.textures=$e,this}});var LoaderUtils={decodeText:function($e){if(typeof TextDecoder<"u")return new TextDecoder().decode($e);for(var Se="",Be=0,De=$e.length;Be<De;Be++)Se+=String.fromCharCode($e[Be]);try{return decodeURIComponent(escape(Se))}catch{return Se}},extractUrlBase:function($e){var Se=$e.lastIndexOf("/");return Se===-1?"./":$e.substr(0,Se+1)}};function InstancedBufferGeometry(){BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}InstancedBufferGeometry.prototype=Object.assign(Object.create(BufferGeometry.prototype),{constructor:InstancedBufferGeometry,isInstancedBufferGeometry:!0,copy:function($e){return BufferGeometry.prototype.copy.call(this,$e),this.instanceCount=$e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var $e=BufferGeometry.prototype.toJSON.call(this);return $e.instanceCount=this.instanceCount,$e.isInstancedBufferGeometry=!0,$e}});function InstancedBufferAttribute($e,Se,Be,De){typeof Be=="number"&&(De=Be,Be=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),BufferAttribute.call(this,$e,Se,Be),this.meshPerAttribute=De||1}InstancedBufferAttribute.prototype=Object.assign(Object.create(BufferAttribute.prototype),{constructor:InstancedBufferAttribute,isInstancedBufferAttribute:!0,copy:function($e){return BufferAttribute.prototype.copy.call(this,$e),this.meshPerAttribute=$e.meshPerAttribute,this},toJSON:function(){var $e=BufferAttribute.prototype.toJSON.call(this);return $e.meshPerAttribute=this.meshPerAttribute,$e.isInstancedBufferAttribute=!0,$e}});function BufferGeometryLoader($e){Loader.call(this,$e)}BufferGeometryLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:BufferGeometryLoader,load:function($e,Se,Be,De){var Ve=this,Fe=new FileLoader(Ve.manager);Fe.setPath(Ve.path),Fe.load($e,function(Je){try{Se(Ve.parse(JSON.parse(Je)))}catch(Xe){De?De(Xe):console.error(Xe),Ve.manager.itemError($e)}},Be,De)},parse:function($e){var Se=$e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,Be=$e.data.index;if(Be!==void 0){var De=new TYPED_ARRAYS[Be.type](Be.array);Se.setIndex(new BufferAttribute(De,1))}var Ve=$e.data.attributes;for(var Fe in Ve){var Je=Ve[Fe],De=new TYPED_ARRAYS[Je.type](Je.array),Xe=Je.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute,Ke=new Xe(De,Je.itemSize,Je.normalized);Je.name!==void 0&&(Ke.name=Je.name),Se.setAttribute(Fe,Ke)}var Ye=$e.data.morphAttributes;if(Ye)for(var Fe in Ye){for(var or=Ye[Fe],sr=[],cr=0,Br=or.length;cr<Br;cr++){var Je=or[cr],De=new TYPED_ARRAYS[Je.type](Je.array),Ke=new BufferAttribute(De,Je.itemSize,Je.normalized);Je.name!==void 0&&(Ke.name=Je.name),sr.push(Ke)}Se.morphAttributes[Fe]=sr}var tn=$e.data.morphTargetsRelative;tn&&(Se.morphTargetsRelative=!0);var en=$e.data.groups||$e.data.drawcalls||$e.data.offsets;if(en!==void 0)for(var cr=0,an=en.length;cr!==an;++cr){var rn=en[cr];Se.addGroup(rn.start,rn.count,rn.materialIndex)}var on=$e.data.boundingSphere;if(on!==void 0){var sn=new Vector3;on.center!==void 0&&sn.fromArray(on.center),Se.boundingSphere=new Sphere(sn,on.radius)}return $e.name&&(Se.name=$e.name),$e.userData&&(Se.userData=$e.userData),Se}});var TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ObjectLoader($e){Loader.call(this,$e)}ObjectLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ObjectLoader,load:function($e,Se,Be,De){var Ve=this,Fe=this.path===""?LoaderUtils.extractUrlBase($e):this.path;this.resourcePath=this.resourcePath||Fe;var Je=new FileLoader(Ve.manager);Je.setPath(this.path),Je.load($e,function(Xe){var Ke=null;try{Ke=JSON.parse(Xe)}catch(or){De!==void 0&&De(or),console.error("THREE:ObjectLoader: Can't parse "+$e+".",or.message);return}var Ye=Ke.metadata;if(Ye===void 0||Ye.type===void 0||Ye.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+$e);return}Ve.parse(Ke,Se)},Be,De)},parse:function($e,Se){var Be=this.parseShape($e.shapes),De=this.parseGeometries($e.geometries,Be),Ve=this.parseImages($e.images,function(){Se!==void 0&&Se(Xe)}),Fe=this.parseTextures($e.textures,Ve),Je=this.parseMaterials($e.materials,Fe),Xe=this.parseObject($e.object,De,Je);return $e.animations&&(Xe.animations=this.parseAnimations($e.animations)),($e.images===void 0||$e.images.length===0)&&Se!==void 0&&Se(Xe),Xe},parseShape:function($e){var Se={};if($e!==void 0)for(var Be=0,De=$e.length;Be<De;Be++){var Ve=new Shape().fromJSON($e[Be]);Se[Ve.uuid]=Ve}return Se},parseGeometries:function($e,Se){var Be={};if($e!==void 0)for(var De=new BufferGeometryLoader,Ve=0,Fe=$e.length;Ve<Fe;Ve++){var Je,Xe=$e[Ve];switch(Xe.type){case"PlaneGeometry":case"PlaneBufferGeometry":Je=new Geometries[Xe.type](Xe.width,Xe.height,Xe.widthSegments,Xe.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":Je=new Geometries[Xe.type](Xe.width,Xe.height,Xe.depth,Xe.widthSegments,Xe.heightSegments,Xe.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":Je=new Geometries[Xe.type](Xe.radius,Xe.segments,Xe.thetaStart,Xe.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":Je=new Geometries[Xe.type](Xe.radiusTop,Xe.radiusBottom,Xe.height,Xe.radialSegments,Xe.heightSegments,Xe.openEnded,Xe.thetaStart,Xe.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":Je=new Geometries[Xe.type](Xe.radius,Xe.height,Xe.radialSegments,Xe.heightSegments,Xe.openEnded,Xe.thetaStart,Xe.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":Je=new Geometries[Xe.type](Xe.radius,Xe.widthSegments,Xe.heightSegments,Xe.phiStart,Xe.phiLength,Xe.thetaStart,Xe.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":Je=new Geometries[Xe.type](Xe.radius,Xe.detail);break;case"RingGeometry":case"RingBufferGeometry":Je=new Geometries[Xe.type](Xe.innerRadius,Xe.outerRadius,Xe.thetaSegments,Xe.phiSegments,Xe.thetaStart,Xe.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":Je=new Geometries[Xe.type](Xe.radius,Xe.tube,Xe.radialSegments,Xe.tubularSegments,Xe.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":Je=new Geometries[Xe.type](Xe.radius,Xe.tube,Xe.tubularSegments,Xe.radialSegments,Xe.p,Xe.q);break;case"TubeGeometry":case"TubeBufferGeometry":Je=new Geometries[Xe.type](new Curves[Xe.path.type]().fromJSON(Xe.path),Xe.tubularSegments,Xe.radius,Xe.radialSegments,Xe.closed);break;case"LatheGeometry":case"LatheBufferGeometry":Je=new Geometries[Xe.type](Xe.points,Xe.segments,Xe.phiStart,Xe.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":Je=new Geometries[Xe.type](Xe.vertices,Xe.indices,Xe.radius,Xe.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var sr=[],Ke=0,Ye=Xe.shapes.length;Ke<Ye;Ke++){var or=Se[Xe.shapes[Ke]];sr.push(or)}Je=new Geometries[Xe.type](sr,Xe.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(var sr=[],Ke=0,Ye=Xe.shapes.length;Ke<Ye;Ke++){var or=Se[Xe.shapes[Ke]];sr.push(or)}var cr=Xe.options.extrudePath;cr!==void 0&&(Xe.options.extrudePath=new Curves[cr.type]().fromJSON(cr)),Je=new Geometries[Xe.type](sr,Xe.options);break;case"BufferGeometry":case"InstancedBufferGeometry":Je=De.parse(Xe);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+Xe.type+'"');continue}Je.uuid=Xe.uuid,Xe.name!==void 0&&(Je.name=Xe.name),Je.isBufferGeometry===!0&&Xe.userData!==void 0&&(Je.userData=Xe.userData),Be[Xe.uuid]=Je}return Be},parseMaterials:function($e,Se){var Be={},De={};if($e!==void 0){var Ve=new MaterialLoader;Ve.setTextures(Se);for(var Fe=0,Je=$e.length;Fe<Je;Fe++){var Xe=$e[Fe];if(Xe.type==="MultiMaterial"){for(var Ke=[],Ye=0;Ye<Xe.materials.length;Ye++){var or=Xe.materials[Ye];Be[or.uuid]===void 0&&(Be[or.uuid]=Ve.parse(or)),Ke.push(Be[or.uuid])}De[Xe.uuid]=Ke}else Be[Xe.uuid]===void 0&&(Be[Xe.uuid]=Ve.parse(Xe)),De[Xe.uuid]=Be[Xe.uuid]}}return De},parseAnimations:function($e){for(var Se=[],Be=0;Be<$e.length;Be++){var De=$e[Be],Ve=AnimationClip.parse(De);De.uuid!==void 0&&(Ve.uuid=De.uuid),Se.push(Ve)}return Se},parseImages:function($e,Se){var Be=this,De={};function Ve(en){return Be.manager.itemStart(en),Je.load(en,function(){Be.manager.itemEnd(en)},void 0,function(){Be.manager.itemError(en),Be.manager.itemEnd(en)})}if($e!==void 0&&$e.length>0){var Fe=new LoadingManager(Se),Je=new ImageLoader(Fe);Je.setCrossOrigin(this.crossOrigin);for(var Xe=0,Ke=$e.length;Xe<Ke;Xe++){var Ye=$e[Xe],or=Ye.url;if(Array.isArray(or)){De[Ye.uuid]=[];for(var sr=0,cr=or.length;sr<cr;sr++){var Br=or[sr],tn=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Br)?Br:Be.resourcePath+Br;De[Ye.uuid].push(Ve(tn))}}else{var tn=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Ye.url)?Ye.url:Be.resourcePath+Ye.url;De[Ye.uuid]=Ve(tn)}}}return De},parseTextures:function($e,Se){function Be(Ke,Ye){return typeof Ke=="number"?Ke:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",Ke),Ye[Ke])}var De={};if($e!==void 0)for(var Ve=0,Fe=$e.length;Ve<Fe;Ve++){var Je=$e[Ve];Je.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',Je.uuid),Se[Je.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",Je.image);var Xe;Array.isArray(Se[Je.image])?Xe=new CubeTexture(Se[Je.image]):Xe=new Texture(Se[Je.image]),Xe.needsUpdate=!0,Xe.uuid=Je.uuid,Je.name!==void 0&&(Xe.name=Je.name),Je.mapping!==void 0&&(Xe.mapping=Be(Je.mapping,TEXTURE_MAPPING)),Je.offset!==void 0&&Xe.offset.fromArray(Je.offset),Je.repeat!==void 0&&Xe.repeat.fromArray(Je.repeat),Je.center!==void 0&&Xe.center.fromArray(Je.center),Je.rotation!==void 0&&(Xe.rotation=Je.rotation),Je.wrap!==void 0&&(Xe.wrapS=Be(Je.wrap[0],TEXTURE_WRAPPING),Xe.wrapT=Be(Je.wrap[1],TEXTURE_WRAPPING)),Je.format!==void 0&&(Xe.format=Je.format),Je.type!==void 0&&(Xe.type=Je.type),Je.encoding!==void 0&&(Xe.encoding=Je.encoding),Je.minFilter!==void 0&&(Xe.minFilter=Be(Je.minFilter,TEXTURE_FILTER)),Je.magFilter!==void 0&&(Xe.magFilter=Be(Je.magFilter,TEXTURE_FILTER)),Je.anisotropy!==void 0&&(Xe.anisotropy=Je.anisotropy),Je.flipY!==void 0&&(Xe.flipY=Je.flipY),Je.premultiplyAlpha!==void 0&&(Xe.premultiplyAlpha=Je.premultiplyAlpha),Je.unpackAlignment!==void 0&&(Xe.unpackAlignment=Je.unpackAlignment),De[Je.uuid]=Xe}return De},parseObject:function($e,Se,Be){var De;function Ve(an){return Se[an]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",an),Se[an]}function Fe(an){if(an!==void 0){if(Array.isArray(an)){for(var rn=[],on=0,sn=an.length;on<sn;on++){var ln=an[on];Be[ln]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",ln),rn.push(Be[ln])}return rn}return Be[an]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",an),Be[an]}}switch($e.type){case"Scene":De=new Scene$1,$e.background!==void 0&&Number.isInteger($e.background)&&(De.background=new Color($e.background)),$e.fog!==void 0&&($e.fog.type==="Fog"?De.fog=new Fog($e.fog.color,$e.fog.near,$e.fog.far):$e.fog.type==="FogExp2"&&(De.fog=new FogExp2($e.fog.color,$e.fog.density)));break;case"PerspectiveCamera":De=new PerspectiveCamera($e.fov,$e.aspect,$e.near,$e.far),$e.focus!==void 0&&(De.focus=$e.focus),$e.zoom!==void 0&&(De.zoom=$e.zoom),$e.filmGauge!==void 0&&(De.filmGauge=$e.filmGauge),$e.filmOffset!==void 0&&(De.filmOffset=$e.filmOffset),$e.view!==void 0&&(De.view=Object.assign({},$e.view));break;case"OrthographicCamera":De=new OrthographicCamera($e.left,$e.right,$e.top,$e.bottom,$e.near,$e.far),$e.zoom!==void 0&&(De.zoom=$e.zoom),$e.view!==void 0&&(De.view=Object.assign({},$e.view));break;case"AmbientLight":De=new AmbientLight($e.color,$e.intensity);break;case"DirectionalLight":De=new DirectionalLight($e.color,$e.intensity);break;case"PointLight":De=new PointLight($e.color,$e.intensity,$e.distance,$e.decay);break;case"RectAreaLight":De=new RectAreaLight($e.color,$e.intensity,$e.width,$e.height);break;case"SpotLight":De=new SpotLight($e.color,$e.intensity,$e.distance,$e.angle,$e.penumbra,$e.decay);break;case"HemisphereLight":De=new HemisphereLight($e.color,$e.groundColor,$e.intensity);break;case"LightProbe":De=new LightProbe().fromJSON($e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var Je=Ve($e.geometry),Xe=Fe($e.material);De=new Mesh(Je,Xe);break;case"InstancedMesh":var Je=Ve($e.geometry),Xe=Fe($e.material),Ke=$e.count,Ye=$e.instanceMatrix;De=new InstancedMesh(Je,Xe,Ke),De.instanceMatrix=new BufferAttribute(new Float32Array(Ye.array),16);break;case"LOD":De=new LOD;break;case"Line":De=new Line(Ve($e.geometry),Fe($e.material),$e.mode);break;case"LineLoop":De=new LineLoop(Ve($e.geometry),Fe($e.material));break;case"LineSegments":De=new LineSegments(Ve($e.geometry),Fe($e.material));break;case"PointCloud":case"Points":De=new Points(Ve($e.geometry),Fe($e.material));break;case"Sprite":De=new Sprite(Fe($e.material));break;case"Group":De=new Group$1;break;default:De=new Object3D}if(De.uuid=$e.uuid,$e.name!==void 0&&(De.name=$e.name),$e.matrix!==void 0?(De.matrix.fromArray($e.matrix),$e.matrixAutoUpdate!==void 0&&(De.matrixAutoUpdate=$e.matrixAutoUpdate),De.matrixAutoUpdate&&De.matrix.decompose(De.position,De.quaternion,De.scale)):($e.position!==void 0&&De.position.fromArray($e.position),$e.rotation!==void 0&&De.rotation.fromArray($e.rotation),$e.quaternion!==void 0&&De.quaternion.fromArray($e.quaternion),$e.scale!==void 0&&De.scale.fromArray($e.scale)),$e.castShadow!==void 0&&(De.castShadow=$e.castShadow),$e.receiveShadow!==void 0&&(De.receiveShadow=$e.receiveShadow),$e.shadow&&($e.shadow.bias!==void 0&&(De.shadow.bias=$e.shadow.bias),$e.shadow.radius!==void 0&&(De.shadow.radius=$e.shadow.radius),$e.shadow.mapSize!==void 0&&De.shadow.mapSize.fromArray($e.shadow.mapSize),$e.shadow.camera!==void 0&&(De.shadow.camera=this.parseObject($e.shadow.camera))),$e.visible!==void 0&&(De.visible=$e.visible),$e.frustumCulled!==void 0&&(De.frustumCulled=$e.frustumCulled),$e.renderOrder!==void 0&&(De.renderOrder=$e.renderOrder),$e.userData!==void 0&&(De.userData=$e.userData),$e.layers!==void 0&&(De.layers.mask=$e.layers),$e.children!==void 0)for(var or=$e.children,sr=0;sr<or.length;sr++)De.add(this.parseObject(or[sr],Se,Be));if($e.type==="LOD"){$e.autoUpdate!==void 0&&(De.autoUpdate=$e.autoUpdate);for(var cr=$e.levels,Br=0;Br<cr.length;Br++){var tn=cr[Br],en=De.getObjectByProperty("uuid",tn.object);en!==void 0&&De.addLevel(en,tn.distance)}}return De}});var TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,SphericalReflectionMapping,CubeUVReflectionMapping,CubeUVRefractionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};function ImageBitmapLoader($e){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Loader.call(this,$e),this.options=void 0}ImageBitmapLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ImageBitmapLoader,setOptions:function(Se){return this.options=Se,this},load:function($e,Se,Be,De){$e===void 0&&($e=""),this.path!==void 0&&($e=this.path+$e),$e=this.manager.resolveURL($e);var Ve=this,Fe=Cache.get($e);if(Fe!==void 0)return Ve.manager.itemStart($e),setTimeout(function(){Se&&Se(Fe),Ve.manager.itemEnd($e)},0),Fe;fetch($e).then(function(Je){return Je.blob()}).then(function(Je){return Ve.options===void 0?createImageBitmap(Je):createImageBitmap(Je,Ve.options)}).then(function(Je){Cache.add($e,Je),Se&&Se(Je),Ve.manager.itemEnd($e)}).catch(function(Je){De&&De(Je),Ve.manager.itemError($e),Ve.manager.itemEnd($e)}),Ve.manager.itemStart($e)}});function ShapePath(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}Object.assign(ShapePath.prototype,{moveTo:function($e,Se){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo($e,Se),this},lineTo:function($e,Se){return this.currentPath.lineTo($e,Se),this},quadraticCurveTo:function($e,Se,Be,De){return this.currentPath.quadraticCurveTo($e,Se,Be,De),this},bezierCurveTo:function($e,Se,Be,De,Ve,Fe){return this.currentPath.bezierCurveTo($e,Se,Be,De,Ve,Fe),this},splineThru:function($e){return this.currentPath.splineThru($e),this},toShapes:function($e,Se){function Be(gn){for(var Cn=[],Mn=0,Bn=gn.length;Mn<Bn;Mn++){var kn=gn[Mn],Ln=new Shape;Ln.curves=kn.curves,Cn.push(Ln)}return Cn}function De(gn,Cn){for(var Mn=Cn.length,Bn=!1,kn=Mn-1,Ln=0;Ln<Mn;kn=Ln++){var Pn=Cn[kn],Vn=Cn[Ln],Yn=Vn.x-Pn.x,ni=Vn.y-Pn.y;if(Math.abs(ni)>Number.EPSILON){if(ni<0&&(Pn=Cn[Ln],Yn=-Yn,Vn=Cn[kn],ni=-ni),gn.y<Pn.y||gn.y>Vn.y)continue;if(gn.y===Pn.y){if(gn.x===Pn.x)return!0}else{var Rn=ni*(gn.x-Pn.x)-Yn*(gn.y-Pn.y);if(Rn===0)return!0;if(Rn<0)continue;Bn=!Bn}}else{if(gn.y!==Pn.y)continue;if(Vn.x<=gn.x&&gn.x<=Pn.x||Pn.x<=gn.x&&gn.x<=Vn.x)return!0}}return Bn}var Ve=ShapeUtils.isClockWise,Fe=this.subPaths;if(Fe.length===0)return[];if(Se===!0)return Be(Fe);var Je,Xe,Ke,Ye=[];if(Fe.length===1)return Xe=Fe[0],Ke=new Shape,Ke.curves=Xe.curves,Ye.push(Ke),Ye;var or=!Ve(Fe[0].getPoints());or=$e?!or:or;var sr=[],cr=[],Br=[],tn=0,en;cr[tn]=void 0,Br[tn]=[];for(var an=0,rn=Fe.length;an<rn;an++)Xe=Fe[an],en=Xe.getPoints(),Je=Ve(en),Je=$e?!Je:Je,Je?(!or&&cr[tn]&&tn++,cr[tn]={s:new Shape,p:en},cr[tn].s.curves=Xe.curves,or&&tn++,Br[tn]=[]):Br[tn].push({h:Xe,p:en[0]});if(!cr[0])return Be(Fe);if(cr.length>1){for(var on=!1,sn=[],ln=0,cn=cr.length;ln<cn;ln++)sr[ln]=[];for(var ln=0,cn=cr.length;ln<cn;ln++)for(var hn=Br[ln],mn=0;mn<hn.length;mn++){for(var An=hn[mn],xn=!0,pn=0;pn<cr.length;pn++)De(An.p,cr[pn].p)&&(ln!==pn&&sn.push({froms:ln,tos:pn,hole:mn}),xn?(xn=!1,sr[pn].push(An)):on=!0);xn&&sr[ln].push(An)}sn.length>0&&(on||(Br=sr))}for(var dn,an=0,fn=cr.length;an<fn;an++){Ke=cr[an].s,Ye.push(Ke),dn=Br[an];for(var yn=0,Sn=dn.length;yn<Sn;yn++)Ke.holes.push(dn[yn].h)}return Ye}});function Font($e){this.type="Font",this.data=$e}Object.assign(Font.prototype,{isFont:!0,generateShapes:function($e,Se){Se===void 0&&(Se=100);for(var Be=[],De=createPaths($e,Se,this.data),Ve=0,Fe=De.length;Ve<Fe;Ve++)Array.prototype.push.apply(Be,De[Ve].toShapes());return Be}});function createPaths($e,Se,Be){for(var De=Array.from?Array.from($e):String($e).split(""),Ve=Se/Be.resolution,Fe=(Be.boundingBox.yMax-Be.boundingBox.yMin+Be.underlineThickness)*Ve,Je=[],Xe=0,Ke=0,Ye=0;Ye<De.length;Ye++){var or=De[Ye];if(or===`
`)Xe=0,Ke-=Fe;else{var sr=createPath(or,Ve,Xe,Ke,Be);Xe+=sr.offsetX,Je.push(sr.path)}}return Je}function createPath($e,Se,Be,De,Ve){var Fe=Ve.glyphs[$e]||Ve.glyphs["?"];if(!Fe){console.error('THREE.Font: character "'+$e+'" does not exists in font family '+Ve.familyName+".");return}var Je=new ShapePath,Xe,Ke,Ye,or,sr,cr,Br,tn;if(Fe.o)for(var en=Fe._cachedOutline||(Fe._cachedOutline=Fe.o.split(" ")),an=0,rn=en.length;an<rn;){var on=en[an++];switch(on){case"m":Xe=en[an++]*Se+Be,Ke=en[an++]*Se+De,Je.moveTo(Xe,Ke);break;case"l":Xe=en[an++]*Se+Be,Ke=en[an++]*Se+De,Je.lineTo(Xe,Ke);break;case"q":Ye=en[an++]*Se+Be,or=en[an++]*Se+De,sr=en[an++]*Se+Be,cr=en[an++]*Se+De,Je.quadraticCurveTo(sr,cr,Ye,or);break;case"b":Ye=en[an++]*Se+Be,or=en[an++]*Se+De,sr=en[an++]*Se+Be,cr=en[an++]*Se+De,Br=en[an++]*Se+Be,tn=en[an++]*Se+De,Je.bezierCurveTo(sr,cr,Br,tn,Ye,or);break}}return{offsetX:Fe.ha*Se,path:Je}}function FontLoader($e){Loader.call(this,$e)}FontLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:FontLoader,load:function($e,Se,Be,De){var Ve=this,Fe=new FileLoader(this.manager);Fe.setPath(this.path),Fe.load($e,function(Je){var Xe;try{Xe=JSON.parse(Je)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),Xe=JSON.parse(Je.substring(65,Je.length-2))}var Ke=Ve.parse(Xe);Se&&Se(Ke)},Be,De)},parse:function($e){return new Font($e)}});var _context,AudioContext={getContext:function(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context},setContext:function($e){_context=$e}};function AudioLoader($e){Loader.call(this,$e)}AudioLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:AudioLoader,load:function($e,Se,Be,De){var Ve=this,Fe=new FileLoader(Ve.manager);Fe.setResponseType("arraybuffer"),Fe.setPath(Ve.path),Fe.load($e,function(Je){try{var Xe=Je.slice(0),Ke=AudioContext.getContext();Ke.decodeAudioData(Xe,function(Ye){Se(Ye)})}catch(Ye){De?De(Ye):console.error(Ye),Ve.manager.itemError($e)}},Be,De)}});function HemisphereLightProbe($e,Se,Be){LightProbe.call(this,void 0,Be);var De=new Color().set($e),Ve=new Color().set(Se),Fe=new Vector3(De.r,De.g,De.b),Je=new Vector3(Ve.r,Ve.g,Ve.b),Xe=Math.sqrt(Math.PI),Ke=Xe*Math.sqrt(.75);this.sh.coefficients[0].copy(Fe).add(Je).multiplyScalar(Xe),this.sh.coefficients[1].copy(Fe).sub(Je).multiplyScalar(Ke)}HemisphereLightProbe.prototype=Object.assign(Object.create(LightProbe.prototype),{constructor:HemisphereLightProbe,isHemisphereLightProbe:!0,copy:function($e){return LightProbe.prototype.copy.call(this,$e),this},toJSON:function($e){var Se=LightProbe.prototype.toJSON.call(this,$e);return Se}});function AmbientLightProbe($e,Se){LightProbe.call(this,void 0,Se);var Be=new Color().set($e);this.sh.coefficients[0].set(Be.r,Be.g,Be.b).multiplyScalar(2*Math.sqrt(Math.PI))}AmbientLightProbe.prototype=Object.assign(Object.create(LightProbe.prototype),{constructor:AmbientLightProbe,isAmbientLightProbe:!0,copy:function($e){return LightProbe.prototype.copy.call(this,$e),this},toJSON:function($e){var Se=LightProbe.prototype.toJSON.call(this,$e);return Se}});var _eyeRight=new Matrix4,_eyeLeft=new Matrix4;function StereoCamera(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(StereoCamera.prototype,{update:function($e){var Se=this._cache,Be=Se.focus!==$e.focus||Se.fov!==$e.fov||Se.aspect!==$e.aspect*this.aspect||Se.near!==$e.near||Se.far!==$e.far||Se.zoom!==$e.zoom||Se.eyeSep!==this.eyeSep;if(Be){Se.focus=$e.focus,Se.fov=$e.fov,Se.aspect=$e.aspect*this.aspect,Se.near=$e.near,Se.far=$e.far,Se.zoom=$e.zoom,Se.eyeSep=this.eyeSep;var De=$e.projectionMatrix.clone(),Ve=Se.eyeSep/2,Fe=Ve*Se.near/Se.focus,Je=Se.near*Math.tan(MathUtils.DEG2RAD*Se.fov*.5)/Se.zoom,Xe,Ke;_eyeLeft.elements[12]=-Ve,_eyeRight.elements[12]=Ve,Xe=-Je*Se.aspect+Fe,Ke=Je*Se.aspect+Fe,De.elements[0]=2*Se.near/(Ke-Xe),De.elements[8]=(Ke+Xe)/(Ke-Xe),this.cameraL.projectionMatrix.copy(De),Xe=-Je*Se.aspect-Fe,Ke=Je*Se.aspect-Fe,De.elements[0]=2*Se.near/(Ke-Xe),De.elements[8]=(Ke+Xe)/(Ke-Xe),this.cameraR.projectionMatrix.copy(De)}this.cameraL.matrixWorld.copy($e.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy($e.matrixWorld).multiply(_eyeRight)}});function Clock($e){this.autoStart=$e!==void 0?$e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(Clock.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var $e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var Se=(typeof performance>"u"?Date:performance).now();$e=(Se-this.oldTime)/1e3,this.oldTime=Se,this.elapsedTime+=$e}return $e}});var _position$2=new Vector3,_quaternion$3=new Quaternion,_scale$1=new Vector3,_orientation=new Vector3;function AudioListener(){Object3D.call(this),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}AudioListener.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:AudioListener,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function($e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=$e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function($e){return this.gain.gain.setTargetAtTime($e,this.context.currentTime,.01),this},updateMatrixWorld:function($e){Object3D.prototype.updateMatrixWorld.call(this,$e);var Se=this.context.listener,Be=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$2,_quaternion$3,_scale$1),_orientation.set(0,0,-1).applyQuaternion(_quaternion$3),Se.positionX){var De=this.context.currentTime+this.timeDelta;Se.positionX.linearRampToValueAtTime(_position$2.x,De),Se.positionY.linearRampToValueAtTime(_position$2.y,De),Se.positionZ.linearRampToValueAtTime(_position$2.z,De),Se.forwardX.linearRampToValueAtTime(_orientation.x,De),Se.forwardY.linearRampToValueAtTime(_orientation.y,De),Se.forwardZ.linearRampToValueAtTime(_orientation.z,De),Se.upX.linearRampToValueAtTime(Be.x,De),Se.upY.linearRampToValueAtTime(Be.y,De),Se.upZ.linearRampToValueAtTime(Be.z,De)}else Se.setPosition(_position$2.x,_position$2.y,_position$2.z),Se.setOrientation(_orientation.x,_orientation.y,_orientation.z,Be.x,Be.y,Be.z)}});function Audio$1($e){Object3D.call(this),this.type="Audio",this.listener=$e,this.context=$e.context,this.gain=this.context.createGain(),this.gain.connect($e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}Audio$1.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Audio$1,getOutput:function(){return this.gain},setNodeSource:function($e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=$e,this.connect(),this},setMediaElementSource:function($e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource($e),this.connect(),this},setMediaStreamSource:function($e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource($e),this.connect(),this},setBuffer:function($e){return this.buffer=$e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function($e){if($e===void 0&&($e=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+$e;var Se=this.context.createBufferSource();return Se.buffer=this.buffer,Se.loop=this.loop,Se.loopStart=this.loopStart,Se.loopEnd=this.loopEnd,Se.onended=this.onEnded.bind(this),Se.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=Se,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var $e=1,Se=this.filters.length;$e<Se;$e++)this.filters[$e-1].connect(this.filters[$e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var $e=1,Se=this.filters.length;$e<Se;$e++)this.filters[$e-1].disconnect(this.filters[$e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function($e){return $e||($e=[]),this.isPlaying===!0?(this.disconnect(),this.filters=$e,this.connect()):this.filters=$e,this},setDetune:function($e){if(this.detune=$e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function($e){return this.setFilters($e?[$e]:[])},setPlaybackRate:function($e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=$e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function($e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=$e,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function($e){return this.loopStart=$e,this},setLoopEnd:function($e){return this.loopEnd=$e,this},getVolume:function(){return this.gain.gain.value},setVolume:function($e){return this.gain.gain.setTargetAtTime($e,this.context.currentTime,.01),this}});var _position$3=new Vector3,_quaternion$4=new Quaternion,_scale$2=new Vector3,_orientation$1=new Vector3;function PositionalAudio($e){Audio$1.call(this,$e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}PositionalAudio.prototype=Object.assign(Object.create(Audio$1.prototype),{constructor:PositionalAudio,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function($e){return this.panner.refDistance=$e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function($e){return this.panner.rolloffFactor=$e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function($e){return this.panner.distanceModel=$e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function($e){return this.panner.maxDistance=$e,this},setDirectionalCone:function($e,Se,Be){return this.panner.coneInnerAngle=$e,this.panner.coneOuterAngle=Se,this.panner.coneOuterGain=Be,this},updateMatrixWorld:function($e){if(Object3D.prototype.updateMatrixWorld.call(this,$e),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(_position$3,_quaternion$4,_scale$2),_orientation$1.set(0,0,1).applyQuaternion(_quaternion$4);var Se=this.panner;if(Se.positionX){var Be=this.context.currentTime+this.listener.timeDelta;Se.positionX.linearRampToValueAtTime(_position$3.x,Be),Se.positionY.linearRampToValueAtTime(_position$3.y,Be),Se.positionZ.linearRampToValueAtTime(_position$3.z,Be),Se.orientationX.linearRampToValueAtTime(_orientation$1.x,Be),Se.orientationY.linearRampToValueAtTime(_orientation$1.y,Be),Se.orientationZ.linearRampToValueAtTime(_orientation$1.z,Be)}else Se.setPosition(_position$3.x,_position$3.y,_position$3.z),Se.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z)}}});function AudioAnalyser($e,Se){this.analyser=$e.context.createAnalyser(),this.analyser.fftSize=Se!==void 0?Se:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),$e.getOutput().connect(this.analyser)}Object.assign(AudioAnalyser.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var $e=0,Se=this.getFrequencyData(),Be=0;Be<Se.length;Be++)$e+=Se[Be];return $e/Se.length}});function PropertyMixer($e,Se,Be){this.binding=$e,this.valueSize=Be;var De,Ve,Fe;switch(Se){case"quaternion":De=this._slerp,Ve=this._slerpAdditive,Fe=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(Be*6),this._workIndex=5;break;case"string":case"bool":De=this._select,Ve=this._select,Fe=this._setAdditiveIdentityOther,this.buffer=new Array(Be*5);break;default:De=this._lerp,Ve=this._lerpAdditive,Fe=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(Be*5)}this._mixBufferRegion=De,this._mixBufferRegionAdditive=Ve,this._setIdentity=Fe,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(PropertyMixer.prototype,{accumulate:function($e,Se){var Be=this.buffer,De=this.valueSize,Ve=$e*De+De,Fe=this.cumulativeWeight;if(Fe===0){for(var Je=0;Je!==De;++Je)Be[Ve+Je]=Be[Je];Fe=Se}else{Fe+=Se;var Xe=Se/Fe;this._mixBufferRegion(Be,Ve,0,Xe,De)}this.cumulativeWeight=Fe},accumulateAdditive:function($e){var Se=this.buffer,Be=this.valueSize,De=Be*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(Se,De,0,$e,Be),this.cumulativeWeightAdditive+=$e},apply:function($e){var Se=this.valueSize,Be=this.buffer,De=$e*Se+Se,Ve=this.cumulativeWeight,Fe=this.cumulativeWeightAdditive,Je=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,Ve<1){var Xe=Se*this._origIndex;this._mixBufferRegion(Be,De,Xe,1-Ve,Se)}Fe>0&&this._mixBufferRegionAdditive(Be,De,this._addIndex*Se,1,Se);for(var Ke=Se,Ye=Se+Se;Ke!==Ye;++Ke)if(Be[Ke]!==Be[Ke+Se]){Je.setValue(Be,De);break}},saveOriginalState:function(){var $e=this.binding,Se=this.buffer,Be=this.valueSize,De=Be*this._origIndex;$e.getValue(Se,De);for(var Ve=Be,Fe=De;Ve!==Fe;++Ve)Se[Ve]=Se[De+Ve%Be];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var $e=this.valueSize*3;this.binding.setValue(this.buffer,$e)},_setAdditiveIdentityNumeric:function(){for(var $e=this._addIndex*this.valueSize,Se=$e+this.valueSize,Be=$e;Be<Se;Be++)this.buffer[Be]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*4+3]=1},_setAdditiveIdentityOther:function(){for(var $e=this._origIndex*this.valueSize,Se=this._addIndex*this.valueSize,Be=0;Be<this.valueSize;Be++)this.buffer[Se+Be]=this.buffer[$e+Be]},_select:function($e,Se,Be,De,Ve){if(De>=.5)for(var Fe=0;Fe!==Ve;++Fe)$e[Se+Fe]=$e[Be+Fe]},_slerp:function($e,Se,Be,De){Quaternion.slerpFlat($e,Se,$e,Se,$e,Be,De)},_slerpAdditive:function($e,Se,Be,De,Ve){var Fe=this._workIndex*Ve;Quaternion.multiplyQuaternionsFlat($e,Fe,$e,Se,$e,Be),Quaternion.slerpFlat($e,Se,$e,Se,$e,Fe,De)},_lerp:function($e,Se,Be,De,Ve){for(var Fe=1-De,Je=0;Je!==Ve;++Je){var Xe=Se+Je;$e[Xe]=$e[Xe]*Fe+$e[Be+Je]*De}},_lerpAdditive:function($e,Se,Be,De,Ve){for(var Fe=0;Fe!==Ve;++Fe){var Je=Se+Fe;$e[Je]=$e[Je]+$e[Be+Fe]*De}}});var _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones"];function Composite($e,Se,Be){var De=Be||PropertyBinding.parseTrackName(Se);this._targetGroup=$e,this._bindings=$e.subscribe_(Se,De)}Object.assign(Composite.prototype,{getValue:function($e,Se){this.bind();var Be=this._targetGroup.nCachedObjects_,De=this._bindings[Be];De!==void 0&&De.getValue($e,Se)},setValue:function($e,Se){for(var Be=this._bindings,De=this._targetGroup.nCachedObjects_,Ve=Be.length;De!==Ve;++De)Be[De].setValue($e,Se)},bind:function(){for(var $e=this._bindings,Se=this._targetGroup.nCachedObjects_,Be=$e.length;Se!==Be;++Se)$e[Se].bind()},unbind:function(){for(var $e=this._bindings,Se=this._targetGroup.nCachedObjects_,Be=$e.length;Se!==Be;++Se)$e[Se].unbind()}});function PropertyBinding($e,Se,Be){this.path=Se,this.parsedPath=Be||PropertyBinding.parseTrackName(Se),this.node=PropertyBinding.findNode($e,this.parsedPath.nodeName)||$e,this.rootNode=$e}Object.assign(PropertyBinding,{Composite,create:function($e,Se,Be){return $e&&$e.isAnimationObjectGroup?new PropertyBinding.Composite($e,Se,Be):new PropertyBinding($e,Se,Be)},sanitizeNodeName:function($e){return $e.replace(/\s/g,"_").replace(_reservedRe,"")},parseTrackName:function($e){var Se=_trackRe.exec($e);if(!Se)throw new Error("PropertyBinding: Cannot parse trackName: "+$e);var Be={nodeName:Se[2],objectName:Se[3],objectIndex:Se[4],propertyName:Se[5],propertyIndex:Se[6]},De=Be.nodeName&&Be.nodeName.lastIndexOf(".");if(De!==void 0&&De!==-1){var Ve=Be.nodeName.substring(De+1);_supportedObjectNames.indexOf(Ve)!==-1&&(Be.nodeName=Be.nodeName.substring(0,De),Be.objectName=Ve)}if(Be.propertyName===null||Be.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+$e);return Be},findNode:function($e,Se){if(!Se||Se===""||Se==="."||Se===-1||Se===$e.name||Se===$e.uuid)return $e;if($e.skeleton){var Be=$e.skeleton.getBoneByName(Se);if(Be!==void 0)return Be}if($e.children){var De=function(Fe){for(var Je=0;Je<Fe.length;Je++){var Xe=Fe[Je];if(Xe.name===Se||Xe.uuid===Se)return Xe;var Ke=De(Xe.children);if(Ke)return Ke}return null},Ve=De($e.children);if(Ve)return Ve}return null}});Object.assign(PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(Se,Be){Se[Be]=this.node[this.propertyName]},function(Se,Be){for(var De=this.resolvedProperty,Ve=0,Fe=De.length;Ve!==Fe;++Ve)Se[Be++]=De[Ve]},function(Se,Be){Se[Be]=this.resolvedProperty[this.propertyIndex]},function(Se,Be){this.resolvedProperty.toArray(Se,Be)}],SetterByBindingTypeAndVersioning:[[function(Se,Be){this.targetObject[this.propertyName]=Se[Be]},function(Se,Be){this.targetObject[this.propertyName]=Se[Be],this.targetObject.needsUpdate=!0},function(Se,Be){this.targetObject[this.propertyName]=Se[Be],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Se,Be){for(var De=this.resolvedProperty,Ve=0,Fe=De.length;Ve!==Fe;++Ve)De[Ve]=Se[Be++]},function(Se,Be){for(var De=this.resolvedProperty,Ve=0,Fe=De.length;Ve!==Fe;++Ve)De[Ve]=Se[Be++];this.targetObject.needsUpdate=!0},function(Se,Be){for(var De=this.resolvedProperty,Ve=0,Fe=De.length;Ve!==Fe;++Ve)De[Ve]=Se[Be++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Se,Be){this.resolvedProperty[this.propertyIndex]=Se[Be]},function(Se,Be){this.resolvedProperty[this.propertyIndex]=Se[Be],this.targetObject.needsUpdate=!0},function(Se,Be){this.resolvedProperty[this.propertyIndex]=Se[Be],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Se,Be){this.resolvedProperty.fromArray(Se,Be)},function(Se,Be){this.resolvedProperty.fromArray(Se,Be),this.targetObject.needsUpdate=!0},function(Se,Be){this.resolvedProperty.fromArray(Se,Be),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(Se,Be){this.bind(),this.getValue(Se,Be)},setValue:function(Se,Be){this.bind(),this.setValue(Se,Be)},bind:function(){var $e=this.node,Se=this.parsedPath,Be=Se.objectName,De=Se.propertyName,Ve=Se.propertyIndex;if($e||($e=PropertyBinding.findNode(this.rootNode,Se.nodeName)||this.rootNode,this.node=$e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!$e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(Be){var Fe=Se.objectIndex;switch(Be){case"materials":if(!$e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!$e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}$e=$e.material.materials;break;case"bones":if(!$e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}$e=$e.skeleton.bones;for(var Je=0;Je<$e.length;Je++)if($e[Je].name===Fe){Fe=Je;break}break;default:if($e[Be]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}$e=$e[Be]}if(Fe!==void 0){if($e[Fe]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,$e);return}$e=$e[Fe]}}var Xe=$e[De];if(Xe===void 0){var Ke=Se.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+Ke+"."+De+" but it wasn't found.",$e);return}var Ye=this.Versioning.None;this.targetObject=$e,$e.needsUpdate!==void 0?Ye=this.Versioning.NeedsUpdate:$e.matrixWorldNeedsUpdate!==void 0&&(Ye=this.Versioning.MatrixWorldNeedsUpdate);var or=this.BindingType.Direct;if(Ve!==void 0){if(De==="morphTargetInfluences"){if(!$e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if($e.geometry.isBufferGeometry){if(!$e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}$e.morphTargetDictionary[Ve]!==void 0&&(Ve=$e.morphTargetDictionary[Ve])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}or=this.BindingType.ArrayElement,this.resolvedProperty=Xe,this.propertyIndex=Ve}else Xe.fromArray!==void 0&&Xe.toArray!==void 0?(or=this.BindingType.HasFromToArray,this.resolvedProperty=Xe):Array.isArray(Xe)?(or=this.BindingType.EntireArray,this.resolvedProperty=Xe):this.propertyName=De;this.getValue=this.GetterByBindingType[or],this.setValue=this.SetterByBindingTypeAndVersioning[or][Ye]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}});Object.assign(PropertyBinding.prototype,{_getValue_unbound:PropertyBinding.prototype.getValue,_setValue_unbound:PropertyBinding.prototype.setValue});function AnimationObjectGroup(){this.uuid=MathUtils.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var $e={};this._indicesByUUID=$e;for(var Se=0,Be=arguments.length;Se!==Be;++Se)$e[arguments[Se].uuid]=Se;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var De=this;this.stats={objects:{get total(){return De._objects.length},get inUse(){return this.total-De.nCachedObjects_}},get bindingsPerObject(){return De._bindings.length}}}Object.assign(AnimationObjectGroup.prototype,{isAnimationObjectGroup:!0,add:function(){for(var $e=this._objects,Se=$e.length,Be=this.nCachedObjects_,De=this._indicesByUUID,Ve=this._paths,Fe=this._parsedPaths,Je=this._bindings,Xe=Je.length,Ke=void 0,Ye=0,or=arguments.length;Ye!==or;++Ye){var sr=arguments[Ye],cr=sr.uuid,Br=De[cr];if(Br===void 0){Br=Se++,De[cr]=Br,$e.push(sr);for(var tn=0,en=Xe;tn!==en;++tn)Je[tn].push(new PropertyBinding(sr,Ve[tn],Fe[tn]))}else if(Br<Be){Ke=$e[Br];var an=--Be,rn=$e[an];De[rn.uuid]=Br,$e[Br]=rn,De[cr]=an,$e[an]=sr;for(var tn=0,en=Xe;tn!==en;++tn){var on=Je[tn],sn=on[an],ln=on[Br];on[Br]=sn,ln===void 0&&(ln=new PropertyBinding(sr,Ve[tn],Fe[tn])),on[an]=ln}}else $e[Br]!==Ke&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=Be},remove:function(){for(var $e=this._objects,Se=this.nCachedObjects_,Be=this._indicesByUUID,De=this._bindings,Ve=De.length,Fe=0,Je=arguments.length;Fe!==Je;++Fe){var Xe=arguments[Fe],Ke=Xe.uuid,Ye=Be[Ke];if(Ye!==void 0&&Ye>=Se){var or=Se++,sr=$e[or];Be[sr.uuid]=Ye,$e[Ye]=sr,Be[Ke]=or,$e[or]=Xe;for(var cr=0,Br=Ve;cr!==Br;++cr){var tn=De[cr],en=tn[or],an=tn[Ye];tn[Ye]=en,tn[or]=an}}}this.nCachedObjects_=Se},uncache:function(){for(var $e=this._objects,Se=$e.length,Be=this.nCachedObjects_,De=this._indicesByUUID,Ve=this._bindings,Fe=Ve.length,Je=0,Xe=arguments.length;Je!==Xe;++Je){var Ke=arguments[Je],Ye=Ke.uuid,or=De[Ye];if(or!==void 0)if(delete De[Ye],or<Be){var sr=--Be,cr=$e[sr],Br=--Se,tn=$e[Br];De[cr.uuid]=or,$e[or]=cr,De[tn.uuid]=sr,$e[sr]=tn,$e.pop();for(var en=0,an=Fe;en!==an;++en){var rn=Ve[en],on=rn[sr],sn=rn[Br];rn[or]=on,rn[sr]=sn,rn.pop()}}else{var Br=--Se,tn=$e[Br];De[tn.uuid]=or,$e[or]=tn,$e.pop();for(var en=0,an=Fe;en!==an;++en){var rn=Ve[en];rn[or]=rn[Br],rn.pop()}}}this.nCachedObjects_=Be},subscribe_:function($e,Se){var Be=this._bindingsIndicesByPath,De=Be[$e],Ve=this._bindings;if(De!==void 0)return Ve[De];var Fe=this._paths,Je=this._parsedPaths,Xe=this._objects,Ke=Xe.length,Ye=this.nCachedObjects_,or=new Array(Ke);De=Ve.length,Be[$e]=De,Fe.push($e),Je.push(Se),Ve.push(or);for(var sr=Ye,cr=Xe.length;sr!==cr;++sr){var Br=Xe[sr];or[sr]=new PropertyBinding(Br,$e,Se)}return or},unsubscribe_:function($e){var Se=this._bindingsIndicesByPath,Be=Se[$e];if(Be!==void 0){var De=this._paths,Ve=this._parsedPaths,Fe=this._bindings,Je=Fe.length-1,Xe=Fe[Je],Ke=$e[Je];Se[Ke]=Be,Fe[Be]=Xe,Fe.pop(),Ve[Be]=Ve[Je],Ve.pop(),De[Be]=De[Je],De.pop()}}});function AnimationAction($e,Se,Be,De){this._mixer=$e,this._clip=Se,this._localRoot=Be||null,this.blendMode=De||Se.blendMode;for(var Ve=Se.tracks,Fe=Ve.length,Je=new Array(Fe),Xe={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding},Ke=0;Ke!==Fe;++Ke){var Ye=Ve[Ke].createInterpolant(null);Je[Ke]=Ye,Ye.settings=Xe}this._interpolantSettings=Xe,this._interpolants=Je,this._propertyBindings=new Array(Fe),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}Object.assign(AnimationAction.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function($e){return this._startTime=$e,this},setLoop:function($e,Se){return this.loop=$e,this.repetitions=Se,this},setEffectiveWeight:function($e){return this.weight=$e,this._effectiveWeight=this.enabled?$e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function($e){return this._scheduleFading($e,0,1)},fadeOut:function($e){return this._scheduleFading($e,1,0)},crossFadeFrom:function($e,Se,Be){if($e.fadeOut(Se),this.fadeIn(Se),Be){var De=this._clip.duration,Ve=$e._clip.duration,Fe=Ve/De,Je=De/Ve;$e.warp(1,Fe,Se),this.warp(Je,1,Se)}return this},crossFadeTo:function($e,Se,Be){return $e.crossFadeFrom(this,Se,Be)},stopFading:function(){var $e=this._weightInterpolant;return $e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant($e)),this},setEffectiveTimeScale:function($e){return this.timeScale=$e,this._effectiveTimeScale=this.paused?0:$e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function($e){return this.timeScale=this._clip.duration/$e,this.stopWarping()},syncWith:function($e){return this.time=$e.time,this.timeScale=$e.timeScale,this.stopWarping()},halt:function($e){return this.warp(this._effectiveTimeScale,0,$e)},warp:function($e,Se,Be){var De=this._mixer,Ve=De.time,Fe=this._timeScaleInterpolant,Je=this.timeScale;Fe===null&&(Fe=De._lendControlInterpolant(),this._timeScaleInterpolant=Fe);var Xe=Fe.parameterPositions,Ke=Fe.sampleValues;return Xe[0]=Ve,Xe[1]=Ve+Be,Ke[0]=$e/Je,Ke[1]=Se/Je,this},stopWarping:function(){var $e=this._timeScaleInterpolant;return $e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant($e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function($e,Se,Be,De){if(!this.enabled){this._updateWeight($e);return}var Ve=this._startTime;if(Ve!==null){var Fe=($e-Ve)*Be;if(Fe<0||Be===0)return;this._startTime=null,Se=Be*Fe}Se*=this._updateTimeScale($e);var Je=this._updateTime(Se),Xe=this._updateWeight($e);if(Xe>0){var Ke=this._interpolants,Ye=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(var or=0,sr=Ke.length;or!==sr;++or)Ke[or].evaluate(Je),Ye[or].accumulateAdditive(Xe);break;case NormalAnimationBlendMode:default:for(var or=0,sr=Ke.length;or!==sr;++or)Ke[or].evaluate(Je),Ye[or].accumulate(De,Xe)}}},_updateWeight:function($e){var Se=0;if(this.enabled){Se=this.weight;var Be=this._weightInterpolant;if(Be!==null){var De=Be.evaluate($e)[0];Se*=De,$e>Be.parameterPositions[1]&&(this.stopFading(),De===0&&(this.enabled=!1))}}return this._effectiveWeight=Se,Se},_updateTimeScale:function($e){var Se=0;if(!this.paused){Se=this.timeScale;var Be=this._timeScaleInterpolant;if(Be!==null){var De=Be.evaluate($e)[0];Se*=De,$e>Be.parameterPositions[1]&&(this.stopWarping(),Se===0?this.paused=!0:this.timeScale=Se)}}return this._effectiveTimeScale=Se,Se},_updateTime:function($e){var Se=this.time+$e,Be=this._clip.duration,De=this.loop,Ve=this._loopCount,Fe=De===LoopPingPong;if($e===0)return Ve===-1?Se:Fe&&(Ve&1)===1?Be-Se:Se;if(De===LoopOnce){Ve===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(Se>=Be)Se=Be;else if(Se<0)Se=0;else{this.time=Se;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=Se,this._mixer.dispatchEvent({type:"finished",action:this,direction:$e<0?-1:1})}}else{if(Ve===-1&&($e>=0?(Ve=0,this._setEndings(!0,this.repetitions===0,Fe)):this._setEndings(this.repetitions===0,!0,Fe)),Se>=Be||Se<0){var Je=Math.floor(Se/Be);Se-=Be*Je,Ve+=Math.abs(Je);var Xe=this.repetitions-Ve;if(Xe<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,Se=$e>0?Be:0,this.time=Se,this._mixer.dispatchEvent({type:"finished",action:this,direction:$e>0?1:-1});else{if(Xe===1){var Ke=$e<0;this._setEndings(Ke,!Ke,Fe)}else this._setEndings(!1,!1,Fe);this._loopCount=Ve,this.time=Se,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:Je})}}else this.time=Se;if(Fe&&(Ve&1)===1)return Be-Se}return Se},_setEndings:function($e,Se,Be){var De=this._interpolantSettings;Be?(De.endingStart=ZeroSlopeEnding,De.endingEnd=ZeroSlopeEnding):($e?De.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:De.endingStart=WrapAroundEnding,Se?De.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:De.endingEnd=WrapAroundEnding)},_scheduleFading:function($e,Se,Be){var De=this._mixer,Ve=De.time,Fe=this._weightInterpolant;Fe===null&&(Fe=De._lendControlInterpolant(),this._weightInterpolant=Fe);var Je=Fe.parameterPositions,Xe=Fe.sampleValues;return Je[0]=Ve,Xe[0]=Se,Je[1]=Ve+$e,Xe[1]=Be,this}});function AnimationMixer($e){this._root=$e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}AnimationMixer.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:AnimationMixer,_bindAction:function($e,Se){var Be=$e._localRoot||this._root,De=$e._clip.tracks,Ve=De.length,Fe=$e._propertyBindings,Je=$e._interpolants,Xe=Be.uuid,Ke=this._bindingsByRootAndName,Ye=Ke[Xe];Ye===void 0&&(Ye={},Ke[Xe]=Ye);for(var or=0;or!==Ve;++or){var sr=De[or],cr=sr.name,Br=Ye[cr];if(Br!==void 0)Fe[or]=Br;else{if(Br=Fe[or],Br!==void 0){Br._cacheIndex===null&&(++Br.referenceCount,this._addInactiveBinding(Br,Xe,cr));continue}var tn=Se&&Se._propertyBindings[or].binding.parsedPath;Br=new PropertyMixer(PropertyBinding.create(Be,cr,tn),sr.ValueTypeName,sr.getValueSize()),++Br.referenceCount,this._addInactiveBinding(Br,Xe,cr),Fe[or]=Br}Je[or].resultBuffer=Br.buffer}},_activateAction:function($e){if(!this._isActiveAction($e)){if($e._cacheIndex===null){var Se=($e._localRoot||this._root).uuid,Be=$e._clip.uuid,De=this._actionsByClip[Be];this._bindAction($e,De&&De.knownActions[0]),this._addInactiveAction($e,Be,Se)}for(var Ve=$e._propertyBindings,Fe=0,Je=Ve.length;Fe!==Je;++Fe){var Xe=Ve[Fe];Xe.useCount++===0&&(this._lendBinding(Xe),Xe.saveOriginalState())}this._lendAction($e)}},_deactivateAction:function($e){if(this._isActiveAction($e)){for(var Se=$e._propertyBindings,Be=0,De=Se.length;Be!==De;++Be){var Ve=Se[Be];--Ve.useCount===0&&(Ve.restoreOriginalState(),this._takeBackBinding(Ve))}this._takeBackAction($e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var $e=this;this.stats={actions:{get total(){return $e._actions.length},get inUse(){return $e._nActiveActions}},bindings:{get total(){return $e._bindings.length},get inUse(){return $e._nActiveBindings}},controlInterpolants:{get total(){return $e._controlInterpolants.length},get inUse(){return $e._nActiveControlInterpolants}}}},_isActiveAction:function($e){var Se=$e._cacheIndex;return Se!==null&&Se<this._nActiveActions},_addInactiveAction:function($e,Se,Be){var De=this._actions,Ve=this._actionsByClip,Fe=Ve[Se];if(Fe===void 0)Fe={knownActions:[$e],actionByRoot:{}},$e._byClipCacheIndex=0,Ve[Se]=Fe;else{var Je=Fe.knownActions;$e._byClipCacheIndex=Je.length,Je.push($e)}$e._cacheIndex=De.length,De.push($e),Fe.actionByRoot[Be]=$e},_removeInactiveAction:function($e){var Se=this._actions,Be=Se[Se.length-1],De=$e._cacheIndex;Be._cacheIndex=De,Se[De]=Be,Se.pop(),$e._cacheIndex=null;var Ve=$e._clip.uuid,Fe=this._actionsByClip,Je=Fe[Ve],Xe=Je.knownActions,Ke=Xe[Xe.length-1],Ye=$e._byClipCacheIndex;Ke._byClipCacheIndex=Ye,Xe[Ye]=Ke,Xe.pop(),$e._byClipCacheIndex=null;var or=Je.actionByRoot,sr=($e._localRoot||this._root).uuid;delete or[sr],Xe.length===0&&delete Fe[Ve],this._removeInactiveBindingsForAction($e)},_removeInactiveBindingsForAction:function($e){for(var Se=$e._propertyBindings,Be=0,De=Se.length;Be!==De;++Be){var Ve=Se[Be];--Ve.referenceCount===0&&this._removeInactiveBinding(Ve)}},_lendAction:function($e){var Se=this._actions,Be=$e._cacheIndex,De=this._nActiveActions++,Ve=Se[De];$e._cacheIndex=De,Se[De]=$e,Ve._cacheIndex=Be,Se[Be]=Ve},_takeBackAction:function($e){var Se=this._actions,Be=$e._cacheIndex,De=--this._nActiveActions,Ve=Se[De];$e._cacheIndex=De,Se[De]=$e,Ve._cacheIndex=Be,Se[Be]=Ve},_addInactiveBinding:function($e,Se,Be){var De=this._bindingsByRootAndName,Ve=De[Se],Fe=this._bindings;Ve===void 0&&(Ve={},De[Se]=Ve),Ve[Be]=$e,$e._cacheIndex=Fe.length,Fe.push($e)},_removeInactiveBinding:function($e){var Se=this._bindings,Be=$e.binding,De=Be.rootNode.uuid,Ve=Be.path,Fe=this._bindingsByRootAndName,Je=Fe[De],Xe=Se[Se.length-1],Ke=$e._cacheIndex;Xe._cacheIndex=Ke,Se[Ke]=Xe,Se.pop(),delete Je[Ve],Object.keys(Je).length===0&&delete Fe[De]},_lendBinding:function($e){var Se=this._bindings,Be=$e._cacheIndex,De=this._nActiveBindings++,Ve=Se[De];$e._cacheIndex=De,Se[De]=$e,Ve._cacheIndex=Be,Se[Be]=Ve},_takeBackBinding:function($e){var Se=this._bindings,Be=$e._cacheIndex,De=--this._nActiveBindings,Ve=Se[De];$e._cacheIndex=De,Se[De]=$e,Ve._cacheIndex=Be,Se[Be]=Ve},_lendControlInterpolant:function(){var $e=this._controlInterpolants,Se=this._nActiveControlInterpolants++,Be=$e[Se];return Be===void 0&&(Be=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),Be.__cacheIndex=Se,$e[Se]=Be),Be},_takeBackControlInterpolant:function($e){var Se=this._controlInterpolants,Be=$e.__cacheIndex,De=--this._nActiveControlInterpolants,Ve=Se[De];$e.__cacheIndex=De,Se[De]=$e,Ve.__cacheIndex=Be,Se[Be]=Ve},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function($e,Se,Be){var De=Se||this._root,Ve=De.uuid,Fe=typeof $e=="string"?AnimationClip.findByName(De,$e):$e,Je=Fe!==null?Fe.uuid:$e,Xe=this._actionsByClip[Je],Ke=null;if(Be===void 0&&(Fe!==null?Be=Fe.blendMode:Be=NormalAnimationBlendMode),Xe!==void 0){var Ye=Xe.actionByRoot[Ve];if(Ye!==void 0&&Ye.blendMode===Be)return Ye;Ke=Xe.knownActions[0],Fe===null&&(Fe=Ke._clip)}if(Fe===null)return null;var or=new AnimationAction(this,Fe,Se,Be);return this._bindAction(or,Ke),this._addInactiveAction(or,Je,Ve),or},existingAction:function($e,Se){var Be=Se||this._root,De=Be.uuid,Ve=typeof $e=="string"?AnimationClip.findByName(Be,$e):$e,Fe=Ve?Ve.uuid:$e,Je=this._actionsByClip[Fe];return Je!==void 0&&Je.actionByRoot[De]||null},stopAllAction:function(){for(var $e=this._actions,Se=this._nActiveActions,Be=Se-1;Be>=0;--Be)$e[Be].stop();return this},update:function($e){$e*=this.timeScale;for(var Se=this._actions,Be=this._nActiveActions,De=this.time+=$e,Ve=Math.sign($e),Fe=this._accuIndex^=1,Je=0;Je!==Be;++Je){var Xe=Se[Je];Xe._update(De,$e,Ve,Fe)}for(var Ke=this._bindings,Ye=this._nActiveBindings,Je=0;Je!==Ye;++Je)Ke[Je].apply(Fe);return this},setTime:function($e){this.time=0;for(var Se=0;Se<this._actions.length;Se++)this._actions[Se].time=0;return this.update($e)},getRoot:function(){return this._root},uncacheClip:function($e){var Se=this._actions,Be=$e.uuid,De=this._actionsByClip,Ve=De[Be];if(Ve!==void 0){for(var Fe=Ve.knownActions,Je=0,Xe=Fe.length;Je!==Xe;++Je){var Ke=Fe[Je];this._deactivateAction(Ke);var Ye=Ke._cacheIndex,or=Se[Se.length-1];Ke._cacheIndex=null,Ke._byClipCacheIndex=null,or._cacheIndex=Ye,Se[Ye]=or,Se.pop(),this._removeInactiveBindingsForAction(Ke)}delete De[Be]}},uncacheRoot:function($e){var Se=$e.uuid,Be=this._actionsByClip;for(var De in Be){var Ve=Be[De].actionByRoot,Fe=Ve[Se];Fe!==void 0&&(this._deactivateAction(Fe),this._removeInactiveAction(Fe))}var Je=this._bindingsByRootAndName,Xe=Je[Se];if(Xe!==void 0)for(var Ke in Xe){var Ye=Xe[Ke];Ye.restoreOriginalState(),this._removeInactiveBinding(Ye)}},uncacheAction:function($e,Se){var Be=this.existingAction($e,Se);Be!==null&&(this._deactivateAction(Be),this._removeInactiveAction(Be))}});function Uniform($e){typeof $e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),$e=arguments[1]),this.value=$e}Uniform.prototype.clone=function(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())};function InstancedInterleavedBuffer($e,Se,Be){InterleavedBuffer.call(this,$e,Se),this.meshPerAttribute=Be||1}InstancedInterleavedBuffer.prototype=Object.assign(Object.create(InterleavedBuffer.prototype),{constructor:InstancedInterleavedBuffer,isInstancedInterleavedBuffer:!0,copy:function($e){return InterleavedBuffer.prototype.copy.call(this,$e),this.meshPerAttribute=$e.meshPerAttribute,this}});function Raycaster($e,Se,Be,De){this.ray=new Ray($e,Se),this.near=Be||0,this.far=De||1/0,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ascSort($e,Se){return $e.distance-Se.distance}function intersectObject($e,Se,Be,De){if($e.layers.test(Se.layers)&&$e.raycast(Se,Be),De===!0)for(var Ve=$e.children,Fe=0,Je=Ve.length;Fe<Je;Fe++)intersectObject(Ve[Fe],Se,Be,!0)}Object.assign(Raycaster.prototype,{set:function($e,Se){this.ray.set($e,Se)},setFromCamera:function($e,Se){Se&&Se.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(Se.matrixWorld),this.ray.direction.set($e.x,$e.y,.5).unproject(Se).sub(this.ray.origin).normalize(),this.camera=Se):Se&&Se.isOrthographicCamera?(this.ray.origin.set($e.x,$e.y,(Se.near+Se.far)/(Se.near-Se.far)).unproject(Se),this.ray.direction.set(0,0,-1).transformDirection(Se.matrixWorld),this.camera=Se):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function($e,Se,Be){var De=Be||[];return intersectObject($e,this,De,Se),De.sort(ascSort),De},intersectObjects:function($e,Se,Be){var De=Be||[];if(Array.isArray($e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),De;for(var Ve=0,Fe=$e.length;Ve<Fe;Ve++)intersectObject($e[Ve],this,De,Se);return De.sort(ascSort),De}});function Spherical($e,Se,Be){return this.radius=$e!==void 0?$e:1,this.phi=Se!==void 0?Se:0,this.theta=Be!==void 0?Be:0,this}Object.assign(Spherical.prototype,{set:function($e,Se,Be){return this.radius=$e,this.phi=Se,this.theta=Be,this},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.radius=$e.radius,this.phi=$e.phi,this.theta=$e.theta,this},makeSafe:function(){var $e=1e-6;return this.phi=Math.max($e,Math.min(Math.PI-$e,this.phi)),this},setFromVector3:function($e){return this.setFromCartesianCoords($e.x,$e.y,$e.z)},setFromCartesianCoords:function($e,Se,Be){return this.radius=Math.sqrt($e*$e+Se*Se+Be*Be),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2($e,Be),this.phi=Math.acos(MathUtils.clamp(Se/this.radius,-1,1))),this}});function Cylindrical($e,Se,Be){return this.radius=$e!==void 0?$e:1,this.theta=Se!==void 0?Se:0,this.y=Be!==void 0?Be:0,this}Object.assign(Cylindrical.prototype,{set:function($e,Se,Be){return this.radius=$e,this.theta=Se,this.y=Be,this},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.radius=$e.radius,this.theta=$e.theta,this.y=$e.y,this},setFromVector3:function($e){return this.setFromCartesianCoords($e.x,$e.y,$e.z)},setFromCartesianCoords:function($e,Se,Be){return this.radius=Math.sqrt($e*$e+Be*Be),this.theta=Math.atan2($e,Be),this.y=Se,this}});var _vector$7=new Vector2;function Box2($e,Se){this.min=$e!==void 0?$e:new Vector2(1/0,1/0),this.max=Se!==void 0?Se:new Vector2(-1/0,-1/0)}Object.assign(Box2.prototype,{set:function($e,Se){return this.min.copy($e),this.max.copy(Se),this},setFromPoints:function($e){this.makeEmpty();for(var Se=0,Be=$e.length;Se<Be;Se++)this.expandByPoint($e[Se]);return this},setFromCenterAndSize:function($e,Se){var Be=_vector$7.copy(Se).multiplyScalar(.5);return this.min.copy($e).sub(Be),this.max.copy($e).add(Be),this},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.min.copy($e.min),this.max.copy($e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function($e){return $e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),$e=new Vector2),this.isEmpty()?$e.set(0,0):$e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function($e){return $e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),$e=new Vector2),this.isEmpty()?$e.set(0,0):$e.subVectors(this.max,this.min)},expandByPoint:function($e){return this.min.min($e),this.max.max($e),this},expandByVector:function($e){return this.min.sub($e),this.max.add($e),this},expandByScalar:function($e){return this.min.addScalar(-$e),this.max.addScalar($e),this},containsPoint:function($e){return!($e.x<this.min.x||$e.x>this.max.x||$e.y<this.min.y||$e.y>this.max.y)},containsBox:function($e){return this.min.x<=$e.min.x&&$e.max.x<=this.max.x&&this.min.y<=$e.min.y&&$e.max.y<=this.max.y},getParameter:function($e,Se){return Se===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),Se=new Vector2),Se.set(($e.x-this.min.x)/(this.max.x-this.min.x),($e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function($e){return!($e.max.x<this.min.x||$e.min.x>this.max.x||$e.max.y<this.min.y||$e.min.y>this.max.y)},clampPoint:function($e,Se){return Se===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),Se=new Vector2),Se.copy($e).clamp(this.min,this.max)},distanceToPoint:function($e){var Se=_vector$7.copy($e).clamp(this.min,this.max);return Se.sub($e).length()},intersect:function($e){return this.min.max($e.min),this.max.min($e.max),this},union:function($e){return this.min.min($e.min),this.max.max($e.max),this},translate:function($e){return this.min.add($e),this.max.add($e),this},equals:function($e){return $e.min.equals(this.min)&&$e.max.equals(this.max)}});var _startP=new Vector3,_startEnd=new Vector3;function Line3($e,Se){this.start=$e!==void 0?$e:new Vector3,this.end=Se!==void 0?Se:new Vector3}Object.assign(Line3.prototype,{set:function($e,Se){return this.start.copy($e),this.end.copy(Se),this},clone:function(){return new this.constructor().copy(this)},copy:function($e){return this.start.copy($e.start),this.end.copy($e.end),this},getCenter:function($e){return $e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),$e=new Vector3),$e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function($e){return $e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),$e=new Vector3),$e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function($e,Se){return Se===void 0&&(console.warn("THREE.Line3: .at() target is now required"),Se=new Vector3),this.delta(Se).multiplyScalar($e).add(this.start)},closestPointToPointParameter:function($e,Se){_startP.subVectors($e,this.start),_startEnd.subVectors(this.end,this.start);var Be=_startEnd.dot(_startEnd),De=_startEnd.dot(_startP),Ve=De/Be;return Se&&(Ve=MathUtils.clamp(Ve,0,1)),Ve},closestPointToPoint:function($e,Se,Be){var De=this.closestPointToPointParameter($e,Se);return Be===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),Be=new Vector3),this.delta(Be).multiplyScalar(De).add(this.start)},applyMatrix4:function($e){return this.start.applyMatrix4($e),this.end.applyMatrix4($e),this},equals:function($e){return $e.start.equals(this.start)&&$e.end.equals(this.end)}});function ImmediateRenderObject($e){Object3D.call(this),this.material=$e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}ImmediateRenderObject.prototype=Object.create(Object3D.prototype);ImmediateRenderObject.prototype.constructor=ImmediateRenderObject;ImmediateRenderObject.prototype.isImmediateRenderObject=!0;var _vector$8=new Vector3;function SpotLightHelper($e,Se){Object3D.call(this),this.light=$e,this.light.updateMatrixWorld(),this.matrix=$e.matrixWorld,this.matrixAutoUpdate=!1,this.color=Se;for(var Be=new BufferGeometry,De=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],Ve=0,Fe=1,Je=32;Ve<Je;Ve++,Fe++){var Xe=Ve/Je*Math.PI*2,Ke=Fe/Je*Math.PI*2;De.push(Math.cos(Xe),Math.sin(Xe),1,Math.cos(Ke),Math.sin(Ke),1)}Be.setAttribute("position",new Float32BufferAttribute(De,3));var Ye=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(Be,Ye),this.add(this.cone),this.update()}SpotLightHelper.prototype=Object.create(Object3D.prototype);SpotLightHelper.prototype.constructor=SpotLightHelper;SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()};SpotLightHelper.prototype.update=function(){this.light.updateMatrixWorld();var $e=this.light.distance?this.light.distance:1e3,Se=$e*Math.tan(this.light.angle);this.cone.scale.set(Se,Se,$e),_vector$8.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$8),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var _vector$9=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;function getBoneList($e){var Se=[];$e&&$e.isBone&&Se.push($e);for(var Be=0;Be<$e.children.length;Be++)Se.push.apply(Se,getBoneList($e.children[Be]));return Se}function SkeletonHelper($e){for(var Se=getBoneList($e),Be=new BufferGeometry,De=[],Ve=[],Fe=new Color(0,0,1),Je=new Color(0,1,0),Xe=0;Xe<Se.length;Xe++){var Ke=Se[Xe];Ke.parent&&Ke.parent.isBone&&(De.push(0,0,0),De.push(0,0,0),Ve.push(Fe.r,Fe.g,Fe.b),Ve.push(Je.r,Je.g,Je.b))}Be.setAttribute("position",new Float32BufferAttribute(De,3)),Be.setAttribute("color",new Float32BufferAttribute(Ve,3));var Ye=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});LineSegments.call(this,Be,Ye),this.type="SkeletonHelper",this.root=$e,this.bones=Se,this.matrix=$e.matrixWorld,this.matrixAutoUpdate=!1}SkeletonHelper.prototype=Object.create(LineSegments.prototype);SkeletonHelper.prototype.constructor=SkeletonHelper;SkeletonHelper.prototype.isSkeletonHelper=!0;SkeletonHelper.prototype.updateMatrixWorld=function($e){var Se=this.bones,Be=this.geometry,De=Be.getAttribute("position");_matrixWorldInv.getInverse(this.root.matrixWorld);for(var Ve=0,Fe=0;Ve<Se.length;Ve++){var Je=Se[Ve];Je.parent&&Je.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,Je.matrixWorld),_vector$9.setFromMatrixPosition(_boneMatrix),De.setXYZ(Fe,_vector$9.x,_vector$9.y,_vector$9.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,Je.parent.matrixWorld),_vector$9.setFromMatrixPosition(_boneMatrix),De.setXYZ(Fe+1,_vector$9.x,_vector$9.y,_vector$9.z),Fe+=2)}Be.getAttribute("position").needsUpdate=!0,Object3D.prototype.updateMatrixWorld.call(this,$e)};function PointLightHelper($e,Se,Be){this.light=$e,this.light.updateMatrixWorld(),this.color=Be;var De=new SphereBufferGeometry(Se,4,2),Ve=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});Mesh.call(this,De,Ve),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}PointLightHelper.prototype=Object.create(Mesh.prototype);PointLightHelper.prototype.constructor=PointLightHelper;PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()};PointLightHelper.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var _vector$a=new Vector3,_color1=new Color,_color2=new Color;function HemisphereLightHelper($e,Se,Be){Object3D.call(this),this.light=$e,this.light.updateMatrixWorld(),this.matrix=$e.matrixWorld,this.matrixAutoUpdate=!1,this.color=Be;var De=new OctahedronBufferGeometry(Se);De.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);var Ve=De.getAttribute("position"),Fe=new Float32Array(Ve.count*3);De.setAttribute("color",new BufferAttribute(Fe,3)),this.add(new Mesh(De,this.material)),this.update()}HemisphereLightHelper.prototype=Object.create(Object3D.prototype);HemisphereLightHelper.prototype.constructor=HemisphereLightHelper;HemisphereLightHelper.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()};HemisphereLightHelper.prototype.update=function(){var $e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var Se=$e.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(var Be=0,De=Se.count;Be<De;Be++){var Ve=Be<De/2?_color1:_color2;Se.setXYZ(Be,Ve.r,Ve.g,Ve.b)}Se.needsUpdate=!0}$e.lookAt(_vector$a.setFromMatrixPosition(this.light.matrixWorld).negate())};function GridHelper($e,Se,Be,De){$e=$e||10,Se=Se||10,Be=new Color(Be!==void 0?Be:4473924),De=new Color(De!==void 0?De:8947848);for(var Ve=Se/2,Fe=$e/Se,Je=$e/2,Xe=[],Ke=[],Ye=0,or=0,sr=-Je;Ye<=Se;Ye++,sr+=Fe){Xe.push(-Je,0,sr,Je,0,sr),Xe.push(sr,0,-Je,sr,0,Je);var cr=Ye===Ve?Be:De;cr.toArray(Ke,or),or+=3,cr.toArray(Ke,or),or+=3,cr.toArray(Ke,or),or+=3,cr.toArray(Ke,or),or+=3}var Br=new BufferGeometry;Br.setAttribute("position",new Float32BufferAttribute(Xe,3)),Br.setAttribute("color",new Float32BufferAttribute(Ke,3));var tn=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});LineSegments.call(this,Br,tn),this.type="GridHelper"}GridHelper.prototype=Object.assign(Object.create(LineSegments.prototype),{constructor:GridHelper,copy:function($e){return LineSegments.prototype.copy.call(this,$e),this.geometry.copy($e.geometry),this.material.copy($e.material),this},clone:function(){return new this.constructor().copy(this)}});function PolarGridHelper($e,Se,Be,De,Ve,Fe){$e=$e||10,Se=Se||16,Be=Be||8,De=De||64,Ve=new Color(Ve!==void 0?Ve:4473924),Fe=new Color(Fe!==void 0?Fe:8947848);var Je=[],Xe=[],Ke,Ye,or,sr,cr,Br,tn;for(sr=0;sr<=Se;sr++)or=sr/Se*(Math.PI*2),Ke=Math.sin(or)*$e,Ye=Math.cos(or)*$e,Je.push(0,0,0),Je.push(Ke,0,Ye),tn=sr&1?Ve:Fe,Xe.push(tn.r,tn.g,tn.b),Xe.push(tn.r,tn.g,tn.b);for(sr=0;sr<=Be;sr++)for(tn=sr&1?Ve:Fe,Br=$e-$e/Be*sr,cr=0;cr<De;cr++)or=cr/De*(Math.PI*2),Ke=Math.sin(or)*Br,Ye=Math.cos(or)*Br,Je.push(Ke,0,Ye),Xe.push(tn.r,tn.g,tn.b),or=(cr+1)/De*(Math.PI*2),Ke=Math.sin(or)*Br,Ye=Math.cos(or)*Br,Je.push(Ke,0,Ye),Xe.push(tn.r,tn.g,tn.b);var en=new BufferGeometry;en.setAttribute("position",new Float32BufferAttribute(Je,3)),en.setAttribute("color",new Float32BufferAttribute(Xe,3));var an=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});LineSegments.call(this,en,an),this.type="PolarGridHelper"}PolarGridHelper.prototype=Object.create(LineSegments.prototype);PolarGridHelper.prototype.constructor=PolarGridHelper;var _v1$5=new Vector3,_v2$3=new Vector3,_v3$1=new Vector3;function DirectionalLightHelper($e,Se,Be){Object3D.call(this),this.light=$e,this.light.updateMatrixWorld(),this.matrix=$e.matrixWorld,this.matrixAutoUpdate=!1,this.color=Be,Se===void 0&&(Se=1);var De=new BufferGeometry;De.setAttribute("position",new Float32BufferAttribute([-Se,Se,0,Se,Se,0,Se,-Se,0,-Se,-Se,0,-Se,Se,0],3));var Ve=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(De,Ve),this.add(this.lightPlane),De=new BufferGeometry,De.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(De,Ve),this.add(this.targetLine),this.update()}DirectionalLightHelper.prototype=Object.create(Object3D.prototype);DirectionalLightHelper.prototype.constructor=DirectionalLightHelper;DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()};DirectionalLightHelper.prototype.update=function(){_v1$5.setFromMatrixPosition(this.light.matrixWorld),_v2$3.setFromMatrixPosition(this.light.target.matrixWorld),_v3$1.subVectors(_v2$3,_v1$5),this.lightPlane.lookAt(_v2$3),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2$3),this.targetLine.scale.z=_v3$1.length()};var _vector$b=new Vector3,_camera=new Camera$1;function CameraHelper($e){var Se=new BufferGeometry,Be=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),De=[],Ve=[],Fe={},Je=new Color(16755200),Xe=new Color(16711680),Ke=new Color(43775),Ye=new Color(16777215),or=new Color(3355443);sr("n1","n2",Je),sr("n2","n4",Je),sr("n4","n3",Je),sr("n3","n1",Je),sr("f1","f2",Je),sr("f2","f4",Je),sr("f4","f3",Je),sr("f3","f1",Je),sr("n1","f1",Je),sr("n2","f2",Je),sr("n3","f3",Je),sr("n4","f4",Je),sr("p","n1",Xe),sr("p","n2",Xe),sr("p","n3",Xe),sr("p","n4",Xe),sr("u1","u2",Ke),sr("u2","u3",Ke),sr("u3","u1",Ke),sr("c","t",Ye),sr("p","c",or),sr("cn1","cn2",or),sr("cn3","cn4",or),sr("cf1","cf2",or),sr("cf3","cf4",or);function sr(Br,tn,en){cr(Br,en),cr(tn,en)}function cr(Br,tn){De.push(0,0,0),Ve.push(tn.r,tn.g,tn.b),Fe[Br]===void 0&&(Fe[Br]=[]),Fe[Br].push(De.length/3-1)}Se.setAttribute("position",new Float32BufferAttribute(De,3)),Se.setAttribute("color",new Float32BufferAttribute(Ve,3)),LineSegments.call(this,Se,Be),this.type="CameraHelper",this.camera=$e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=$e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=Fe,this.update()}CameraHelper.prototype=Object.create(LineSegments.prototype);CameraHelper.prototype.constructor=CameraHelper;CameraHelper.prototype.update=function(){var $e=this.geometry,Se=this.pointMap,Be=1,De=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",Se,$e,_camera,0,0,-1),setPoint("t",Se,$e,_camera,0,0,1),setPoint("n1",Se,$e,_camera,-1,-1,-1),setPoint("n2",Se,$e,_camera,Be,-1,-1),setPoint("n3",Se,$e,_camera,-1,De,-1),setPoint("n4",Se,$e,_camera,Be,De,-1),setPoint("f1",Se,$e,_camera,-1,-1,1),setPoint("f2",Se,$e,_camera,Be,-1,1),setPoint("f3",Se,$e,_camera,-1,De,1),setPoint("f4",Se,$e,_camera,Be,De,1),setPoint("u1",Se,$e,_camera,Be*.7,De*1.1,-1),setPoint("u2",Se,$e,_camera,-1*.7,De*1.1,-1),setPoint("u3",Se,$e,_camera,0,De*2,-1),setPoint("cf1",Se,$e,_camera,-1,0,1),setPoint("cf2",Se,$e,_camera,Be,0,1),setPoint("cf3",Se,$e,_camera,0,-1,1),setPoint("cf4",Se,$e,_camera,0,De,1),setPoint("cn1",Se,$e,_camera,-1,0,-1),setPoint("cn2",Se,$e,_camera,Be,0,-1),setPoint("cn3",Se,$e,_camera,0,-1,-1),setPoint("cn4",Se,$e,_camera,0,De,-1),$e.getAttribute("position").needsUpdate=!0};function setPoint($e,Se,Be,De,Ve,Fe,Je){_vector$b.set(Ve,Fe,Je).unproject(De);var Xe=Se[$e];if(Xe!==void 0)for(var Ke=Be.getAttribute("position"),Ye=0,or=Xe.length;Ye<or;Ye++)Ke.setXYZ(Xe[Ye],_vector$b.x,_vector$b.y,_vector$b.z)}var _box$3=new Box3;function BoxHelper($e,Se){this.object=$e,Se===void 0&&(Se=16776960);var Be=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),De=new Float32Array(8*3),Ve=new BufferGeometry;Ve.setIndex(new BufferAttribute(Be,1)),Ve.setAttribute("position",new BufferAttribute(De,3)),LineSegments.call(this,Ve,new LineBasicMaterial({color:Se,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}BoxHelper.prototype=Object.create(LineSegments.prototype);BoxHelper.prototype.constructor=BoxHelper;BoxHelper.prototype.update=function($e){if($e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box$3.setFromObject(this.object),!_box$3.isEmpty()){var Se=_box$3.min,Be=_box$3.max,De=this.geometry.attributes.position,Ve=De.array;Ve[0]=Be.x,Ve[1]=Be.y,Ve[2]=Be.z,Ve[3]=Se.x,Ve[4]=Be.y,Ve[5]=Be.z,Ve[6]=Se.x,Ve[7]=Se.y,Ve[8]=Be.z,Ve[9]=Be.x,Ve[10]=Se.y,Ve[11]=Be.z,Ve[12]=Be.x,Ve[13]=Be.y,Ve[14]=Se.z,Ve[15]=Se.x,Ve[16]=Be.y,Ve[17]=Se.z,Ve[18]=Se.x,Ve[19]=Se.y,Ve[20]=Se.z,Ve[21]=Be.x,Ve[22]=Se.y,Ve[23]=Se.z,De.needsUpdate=!0,this.geometry.computeBoundingSphere()}};BoxHelper.prototype.setFromObject=function($e){return this.object=$e,this.update(),this};BoxHelper.prototype.copy=function($e){return LineSegments.prototype.copy.call(this,$e),this.object=$e.object,this};BoxHelper.prototype.clone=function(){return new this.constructor().copy(this)};function Box3Helper($e,Se){this.type="Box3Helper",this.box=$e,Se=Se||16776960;var Be=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),De=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],Ve=new BufferGeometry;Ve.setIndex(new BufferAttribute(Be,1)),Ve.setAttribute("position",new Float32BufferAttribute(De,3)),LineSegments.call(this,Ve,new LineBasicMaterial({color:Se,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}Box3Helper.prototype=Object.create(LineSegments.prototype);Box3Helper.prototype.constructor=Box3Helper;Box3Helper.prototype.updateMatrixWorld=function($e){var Se=this.box;Se.isEmpty()||(Se.getCenter(this.position),Se.getSize(this.scale),this.scale.multiplyScalar(.5),Object3D.prototype.updateMatrixWorld.call(this,$e))};function PlaneHelper($e,Se,Be){this.plane=$e,this.size=Se===void 0?1:Se;var De=Be!==void 0?Be:16776960,Ve=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],Fe=new BufferGeometry;Fe.setAttribute("position",new Float32BufferAttribute(Ve,3)),Fe.computeBoundingSphere(),Line.call(this,Fe,new LineBasicMaterial({color:De,toneMapped:!1})),this.type="PlaneHelper";var Je=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],Xe=new BufferGeometry;Xe.setAttribute("position",new Float32BufferAttribute(Je,3)),Xe.computeBoundingSphere(),this.add(new Mesh(Xe,new MeshBasicMaterial({color:De,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}PlaneHelper.prototype=Object.create(Line.prototype);PlaneHelper.prototype.constructor=PlaneHelper;PlaneHelper.prototype.updateMatrixWorld=function($e){var Se=-this.plane.constant;Math.abs(Se)<1e-8&&(Se=1e-8),this.scale.set(.5*this.size,.5*this.size,Se),this.children[0].material.side=Se<0?BackSide:FrontSide,this.lookAt(this.plane.normal),Object3D.prototype.updateMatrixWorld.call(this,$e)};var _axis=new Vector3,_lineGeometry,_coneGeometry;function ArrowHelper($e,Se,Be,De,Ve,Fe){Object3D.call(this),this.type="ArrowHelper",$e===void 0&&($e=new Vector3(0,0,1)),Se===void 0&&(Se=new Vector3(0,0,0)),Be===void 0&&(Be=1),De===void 0&&(De=16776960),Ve===void 0&&(Ve=.2*Be),Fe===void 0&&(Fe=.2*Ve),_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderBufferGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(Se),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:De,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:De,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection($e),this.setLength(Be,Ve,Fe)}ArrowHelper.prototype=Object.create(Object3D.prototype);ArrowHelper.prototype.constructor=ArrowHelper;ArrowHelper.prototype.setDirection=function($e){if($e.y>.99999)this.quaternion.set(0,0,0,1);else if($e.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set($e.z,0,-$e.x).normalize();var Se=Math.acos($e.y);this.quaternion.setFromAxisAngle(_axis,Se)}};ArrowHelper.prototype.setLength=function($e,Se,Be){Se===void 0&&(Se=.2*$e),Be===void 0&&(Be=.2*Se),this.line.scale.set(1,Math.max(1e-4,$e-Se),1),this.line.updateMatrix(),this.cone.scale.set(Be,Se,Be),this.cone.position.y=$e,this.cone.updateMatrix()};ArrowHelper.prototype.setColor=function($e){this.line.material.color.set($e),this.cone.material.color.set($e)};ArrowHelper.prototype.copy=function($e){return Object3D.prototype.copy.call(this,$e,!1),this.line.copy($e.line),this.cone.copy($e.cone),this};ArrowHelper.prototype.clone=function(){return new this.constructor().copy(this)};function AxesHelper($e){$e=$e||1;var Se=[0,0,0,$e,0,0,0,0,0,0,$e,0,0,0,0,0,0,$e],Be=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],De=new BufferGeometry;De.setAttribute("position",new Float32BufferAttribute(Se,3)),De.setAttribute("color",new Float32BufferAttribute(Be,3));var Ve=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});LineSegments.call(this,De,Ve),this.type="AxesHelper"}AxesHelper.prototype=Object.create(LineSegments.prototype);AxesHelper.prototype.constructor=AxesHelper;var LOD_MIN=4,LOD_MAX=8,SIZE_MAX=Math.pow(2,LOD_MAX),EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],TOTAL_LODS=LOD_MAX-LOD_MIN+1+EXTRA_LOD_SIGMA.length,MAX_SAMPLES=20,ENCODINGS={[LinearEncoding]:0,[sRGBEncoding]:1,[RGBEEncoding]:2,[RGBM7Encoding]:3,[RGBM16Encoding]:4,[RGBDEncoding]:5,[GammaEncoding]:6},_flatCamera=new OrthographicCamera,{_lodPlanes,_sizeLods,_sigmas}=_createPlanes(),_oldTarget=null,PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];function PMREMGenerator($e){this._renderer=$e,this._pingPongRenderTarget=null,this._blurMaterial=_getBlurShader(MAX_SAMPLES),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}PMREMGenerator.prototype={constructor:PMREMGenerator,fromScene:function($e,Se=0,Be=.1,De=100){_oldTarget=this._renderer.getRenderTarget();var Ve=this._allocateTargets();return this._sceneToCubeUV($e,Be,De,Ve),Se>0&&this._blur(Ve,0,0,Se),this._applyPMREM(Ve),this._cleanup(Ve),Ve},fromEquirectangular:function($e){return $e.magFilter=NearestFilter,$e.minFilter=NearestFilter,$e.generateMipmaps=!1,this.fromCubemap($e)},fromCubemap:function($e){_oldTarget=this._renderer.getRenderTarget();var Se=this._allocateTargets($e);return this._textureToCubeUV($e,Se),this._applyPMREM(Se),this._cleanup(Se),Se},compileCubemapShader:function(){this._cubemapShader===null&&(this._cubemapShader=_getCubemapShader(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){this._equirectShader===null&&(this._equirectShader=_getEquirectShader(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var $e=0;$e<_lodPlanes.length;$e++)_lodPlanes[$e].dispose()},_cleanup:function($e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(_oldTarget),$e.scissorTest=!1,$e.setSize($e.width,$e.height)},_allocateTargets:function($e){var Se={magFilter:NearestFilter,minFilter:NearestFilter,generateMipmaps:!1,type:UnsignedByteType,format:RGBEFormat,encoding:_isLDR($e)?$e.encoding:RGBEEncoding,depthBuffer:!1,stencilBuffer:!1},Be=_createRenderTarget(Se);return Be.depthBuffer=!$e,this._pingPongRenderTarget=_createRenderTarget(Se),Be},_compileMaterial:function($e){var Se=new Mesh(_lodPlanes[0],$e);this._renderer.compile(Se,_flatCamera)},_sceneToCubeUV:function($e,Se,Be,De){var Ve=90,Fe=1,Je=new PerspectiveCamera(Ve,Fe,Se,Be),Xe=[1,-1,1,1,1,1],Ke=[1,1,1,-1,-1,-1],Ye=this._renderer,or=Ye.outputEncoding,sr=Ye.toneMapping,cr=Ye.toneMappingExposure,Br=Ye.getClearColor(),tn=Ye.getClearAlpha();Ye.toneMapping=LinearToneMapping,Ye.toneMappingExposure=1,Ye.outputEncoding=LinearEncoding;var en=$e.background;if(en&&en.isColor){en.convertSRGBToLinear();var an=Math.max(en.r,en.g,en.b),rn=Math.min(Math.max(Math.ceil(Math.log2(an)),-128),127);en=en.multiplyScalar(Math.pow(2,-rn));var on=(rn+128)/255;Ye.setClearColor(en,on),$e.background=null}for(var sn=0;sn<6;sn++){var ln=sn%3;ln==0?(Je.up.set(0,Xe[sn],0),Je.lookAt(Ke[sn],0,0)):ln==1?(Je.up.set(0,0,Xe[sn]),Je.lookAt(0,Ke[sn],0)):(Je.up.set(0,Xe[sn],0),Je.lookAt(0,0,Ke[sn])),_setViewport(De,ln*SIZE_MAX,sn>2?SIZE_MAX:0,SIZE_MAX,SIZE_MAX),Ye.setRenderTarget(De),Ye.render($e,Je)}Ye.toneMapping=sr,Ye.toneMappingExposure=cr,Ye.outputEncoding=or,Ye.setClearColor(Br,tn)},_textureToCubeUV:function($e,Se){var Be=this._renderer;$e.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=_getCubemapShader()):this._equirectShader==null&&(this._equirectShader=_getEquirectShader());var De=$e.isCubeTexture?this._cubemapShader:this._equirectShader,Ve=new Mesh(_lodPlanes[0],De),Fe=De.uniforms;Fe.envMap.value=$e,$e.isCubeTexture||Fe.texelSize.value.set(1/$e.image.width,1/$e.image.height),Fe.inputEncoding.value=ENCODINGS[$e.encoding],Fe.outputEncoding.value=ENCODINGS[Se.texture.encoding],_setViewport(Se,0,0,3*SIZE_MAX,2*SIZE_MAX),Be.setRenderTarget(Se),Be.render(Ve,_flatCamera)},_applyPMREM:function($e){var Se=this._renderer,Be=Se.autoClear;Se.autoClear=!1;for(var De=1;De<TOTAL_LODS;De++){var Ve=Math.sqrt(_sigmas[De]*_sigmas[De]-_sigmas[De-1]*_sigmas[De-1]),Fe=_axisDirections[(De-1)%_axisDirections.length];this._blur($e,De-1,De,Ve,Fe)}Se.autoClear=Be},_blur:function($e,Se,Be,De,Ve){var Fe=this._pingPongRenderTarget;this._halfBlur($e,Fe,Se,Be,De,"latitudinal",Ve),this._halfBlur(Fe,$e,Be,Be,De,"longitudinal",Ve)},_halfBlur:function($e,Se,Be,De,Ve,Fe,Je){var Xe=this._renderer,Ke=this._blurMaterial;Fe!=="latitudinal"&&Fe!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var Ye=3,or=new Mesh(_lodPlanes[De],Ke),sr=Ke.uniforms,cr=_sizeLods[Be]-1,Br=isFinite(Ve)?Math.PI/(2*cr):2*Math.PI/(2*MAX_SAMPLES-1),tn=Ve/Br,en=isFinite(Ve)?1+Math.floor(Ye*tn):MAX_SAMPLES;en>MAX_SAMPLES&&console.warn(`sigmaRadians, ${Ve}, is too large and will clip, as it requested ${en} samples when the maximum is set to ${MAX_SAMPLES}`);for(var an=[],rn=0,on=0;on<MAX_SAMPLES;++on){var cn=on/tn,sn=Math.exp(-cn*cn/2);an.push(sn),on==0?rn+=sn:on<en&&(rn+=2*sn)}for(var on=0;on<an.length;on++)an[on]=an[on]/rn;sr.envMap.value=$e.texture,sr.samples.value=en,sr.weights.value=an,sr.latitudinal.value=Fe==="latitudinal",Je&&(sr.poleAxis.value=Je),sr.dTheta.value=Br,sr.mipInt.value=LOD_MAX-Be,sr.inputEncoding.value=ENCODINGS[$e.texture.encoding],sr.outputEncoding.value=ENCODINGS[$e.texture.encoding];var ln=_sizeLods[De],cn=3*Math.max(0,SIZE_MAX-2*ln),hn=(De===0?0:2*SIZE_MAX)+2*ln*(De>LOD_MAX-LOD_MIN?De-LOD_MAX+LOD_MIN:0);_setViewport(Se,cn,hn,3*ln,2*ln),Xe.setRenderTarget(Se),Xe.render(or,_flatCamera)}};function _isLDR($e){return $e===void 0||$e.type!==UnsignedByteType?!1:$e.encoding===LinearEncoding||$e.encoding===sRGBEncoding||$e.encoding===GammaEncoding}function _createPlanes(){for(var $e=[],Se=[],Be=[],De=LOD_MAX,Ve=0;Ve<TOTAL_LODS;Ve++){var Fe=Math.pow(2,De);Se.push(Fe);var Je=1/Fe;Ve>LOD_MAX-LOD_MIN?Je=EXTRA_LOD_SIGMA[Ve-LOD_MAX+LOD_MIN-1]:Ve==0&&(Je=0),Be.push(Je);for(var Xe=1/(Fe-1),Ke=-Xe/2,Ye=1+Xe/2,or=[Ke,Ke,Ye,Ke,Ye,Ye,Ke,Ke,Ye,Ye,Ke,Ye],sr=6,cr=6,Br=3,tn=2,en=1,an=new Float32Array(Br*cr*sr),rn=new Float32Array(tn*cr*sr),on=new Float32Array(en*cr*sr),sn=0;sn<sr;sn++){var ln=sn%3*2/3-1,cn=sn>2?0:-1,hn=[ln,cn,0,ln+2/3,cn,0,ln+2/3,cn+1,0,ln,cn,0,ln+2/3,cn+1,0,ln,cn+1,0];an.set(hn,Br*cr*sn),rn.set(or,tn*cr*sn);var mn=[sn,sn,sn,sn,sn,sn];on.set(mn,en*cr*sn)}var An=new BufferGeometry;An.setAttribute("position",new BufferAttribute(an,Br)),An.setAttribute("uv",new BufferAttribute(rn,tn)),An.setAttribute("faceIndex",new BufferAttribute(on,en)),$e.push(An),De>LOD_MIN&&De--}return{_lodPlanes:$e,_sizeLods:Se,_sigmas:Be}}function _createRenderTarget($e){var Se=new WebGLRenderTarget(3*SIZE_MAX,3*SIZE_MAX,$e);return Se.texture.mapping=CubeUVReflectionMapping,Se.texture.name="PMREM.cubeUv",Se.scissorTest=!0,Se}function _setViewport($e,Se,Be,De,Ve){$e.viewport.set(Se,Be,De,Ve),$e.scissor.set(Se,Be,De,Ve)}function _getBlurShader($e){var Se=new Float32Array($e),Be=new Vector3(0,1,0),De=new RawShaderMaterial({defines:{n:$e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:Se},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:Be},inputEncoding:{value:ENCODINGS[LinearEncoding]},outputEncoding:{value:ENCODINGS[LinearEncoding]}},vertexShader:_getCommonVertexShader(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;

${_getEncodings()}

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

vec3 getSample(float theta, vec3 axis) {
	float cosTheta = cos(theta);
	// Rodrigues' axis-angle rotation
	vec3 sampleDirection = vOutputDirection * cosTheta
		+ cross(axis, vOutputDirection) * sin(theta)
		+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
	return bilinearCubeUV(envMap, sampleDirection, mipInt);
}

void main() {
	vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
	if (all(equal(axis, vec3(0.0))))
		axis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);
	axis = normalize(axis);
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb += weights[0] * getSample(0.0, axis);
	for (int i = 1; i < n; i++) {
		if (i >= samples)
			break;
		float theta = dTheta * float(i);
		gl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);
		gl_FragColor.rgb += weights[i] * getSample(theta, axis);
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1});return De.type="SphericalGaussianBlur",De}function _getEquirectShader(){var $e=new Vector2(1,1),Se=new RawShaderMaterial({uniforms:{envMap:{value:null},texelSize:{value:$e},inputEncoding:{value:ENCODINGS[LinearEncoding]},outputEncoding:{value:ENCODINGS[LinearEncoding]}},vertexShader:_getCommonVertexShader(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;

${_getEncodings()}

#include <common>

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv = equirectUv( outputDirection );
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1});return Se.type="EquirectangularToCubeUV",Se}function _getCubemapShader(){var $e=new RawShaderMaterial({uniforms:{envMap:{value:null},inputEncoding:{value:ENCODINGS[LinearEncoding]},outputEncoding:{value:ENCODINGS[LinearEncoding]}},vertexShader:_getCommonVertexShader(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;

${_getEncodings()}

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1});return $e.type="CubemapToCubeUV",$e}function _getCommonVertexShader(){return`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;

// RH coordinate system; PMREM face-indexing convention
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx; // ( 1, v, u ) pos x
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.xz *= -1.0; // ( -u, 1, -v ) pos y
	} else if (face == 2.0) {
		direction.x *= -1.0; // ( -u, v, 1 ) pos z
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.xz *= -1.0; // ( -1, v, -u ) neg x
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.xy *= -1.0; // ( -u, -1, v ) neg y
	} else if (face == 5.0) {
		direction.z *= -1.0; // ( u, v, -1 ) neg z
	}
	return direction;
}

void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`}function _getEncodings(){return`
uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	`}Curve.create=function($e,Se){return console.log("THREE.Curve.create() has been deprecated"),$e.prototype=Object.create(Curve.prototype),$e.prototype.constructor=$e,$e.prototype.getPoint=Se,$e};Object.assign(CurvePath.prototype,{createPointsGeometry:function($e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var Se=this.getPoints($e);return this.createGeometry(Se)},createSpacedPointsGeometry:function($e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var Se=this.getSpacedPoints($e);return this.createGeometry(Se)},createGeometry:function($e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var Se=new Geometry,Be=0,De=$e.length;Be<De;Be++){var Ve=$e[Be];Se.vertices.push(new Vector3(Ve.x,Ve.y,Ve.z||0))}return Se}});Object.assign(Path.prototype,{fromPoints:function($e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints($e)}});Object.create(CatmullRomCurve3.prototype);Object.create(CatmullRomCurve3.prototype);function Spline($e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),CatmullRomCurve3.call(this,$e),this.type="catmullrom"}Spline.prototype=Object.create(CatmullRomCurve3.prototype);Object.assign(Spline.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});GridHelper.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};SkeletonHelper.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(Loader.prototype,{extractUrlBase:function($e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),LoaderUtils.extractUrlBase($e)}});Loader.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};Object.assign(ObjectLoader.prototype,{setTexturePath:function($e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath($e)}});Object.assign(Box2.prototype,{center:function($e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter($e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function($e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox($e)},size:function($e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize($e)}});Object.assign(Box3.prototype,{center:function($e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter($e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function($e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox($e)},isIntersectionSphere:function($e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere($e)},size:function($e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize($e)}});Object.assign(Sphere.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}});Frustum.prototype.setFromMatrix=function($e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix($e)};Line3.prototype.center=function($e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter($e)};Object.assign(MathUtils,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function($e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),MathUtils.floorPowerOfTwo($e)},nextPowerOfTwo:function($e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),MathUtils.ceilPowerOfTwo($e)}});Object.assign(Matrix3.prototype,{flattenToArrayOffset:function($e,Se){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray($e,Se)},multiplyVector3:function($e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),$e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function($e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),$e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(Matrix4.prototype,{extractPosition:function($e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition($e)},flattenToArrayOffset:function($e,Se){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray($e,Se)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new Vector3().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function($e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion($e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function($e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),$e.applyMatrix4(this)},multiplyVector4:function($e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),$e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function($e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),$e.transformDirection(this)},crossVector:function($e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),$e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function($e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),$e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function($e,Se,Be,De,Ve,Fe){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective($e,Se,De,Be,Ve,Fe)}});Plane.prototype.isIntersectionLine=function($e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine($e)};Quaternion.prototype.multiplyVector3=function($e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),$e.applyQuaternion(this)};Object.assign(Ray.prototype,{isIntersectionBox:function($e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox($e)},isIntersectionPlane:function($e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane($e)},isIntersectionSphere:function($e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere($e)}});Object.assign(Triangle.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function($e,Se){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord($e,Se)},midpoint:function($e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint($e)},normal:function($e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal($e)},plane:function($e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane($e)}});Object.assign(Triangle,{barycoordFromPoint:function($e,Se,Be,De,Ve){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Triangle.getBarycoord($e,Se,Be,De,Ve)},normal:function($e,Se,Be,De){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Triangle.getNormal($e,Se,Be,De)}});Object.assign(Shape.prototype,{extractAllPoints:function($e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints($e)},extrude:function($e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ExtrudeGeometry(this,$e)},makeGeometry:function($e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ShapeGeometry(this,$e)}});Object.assign(Vector2.prototype,{fromAttribute:function($e,Se,Be){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute($e,Se,Be)},distanceToManhattan:function($e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo($e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(Vector3.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function($e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition($e)},getScaleFromMatrix:function($e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale($e)},getColumnFromMatrix:function($e,Se){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(Se,$e)},applyProjection:function($e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4($e)},fromAttribute:function($e,Se,Be){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute($e,Se,Be)},distanceToManhattan:function($e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo($e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(Vector4.prototype,{fromAttribute:function($e,Se,Be){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute($e,Se,Be)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(Geometry.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function($e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4($e)}});Object.assign(Object3D.prototype,{getChildByName:function($e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName($e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function($e,Se){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(Se,$e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function($e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4($e)}});Object.defineProperties(Object3D.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function($e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=$e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Object.assign(Mesh.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}});Object.defineProperties(Mesh.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),TrianglesDrawMode},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});Object.defineProperties(LOD.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}});Object.defineProperty(Skeleton.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});SkinnedMesh.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};Object.defineProperty(Curve.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function($e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=$e}});PerspectiveCamera.prototype.setLens=function($e,Se){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),Se!==void 0&&(this.filmGauge=Se),this.setFocalLength($e)};Object.defineProperties(Light.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function($e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=$e}},shadowCameraLeft:{set:function($e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=$e}},shadowCameraRight:{set:function($e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=$e}},shadowCameraTop:{set:function($e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=$e}},shadowCameraBottom:{set:function($e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=$e}},shadowCameraNear:{set:function($e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=$e}},shadowCameraFar:{set:function($e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=$e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function($e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=$e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function($e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=$e}},shadowMapHeight:{set:function($e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=$e}}});Object.defineProperties(BufferAttribute.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===DynamicDrawUsage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(DynamicDrawUsage)}}});Object.assign(BufferAttribute.prototype,{setDynamic:function($e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage($e===!0?DynamicDrawUsage:StaticDrawUsage),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(BufferGeometry.prototype,{addIndex:function($e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex($e)},addAttribute:function($e,Se){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(Se&&Se.isBufferAttribute)&&!(Se&&Se.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute($e,new BufferAttribute(arguments[1],arguments[2]))):$e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(Se),this):this.setAttribute($e,Se)},addDrawCall:function($e,Se,Be){Be!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup($e,Se)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function($e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute($e)},applyMatrix:function($e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4($e)}});Object.defineProperties(BufferGeometry.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});Object.defineProperties(InstancedBufferGeometry.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function($e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=$e}}});Object.defineProperties(Raycaster.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function($e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=$e}}});Object.defineProperties(InterleavedBuffer.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===DynamicDrawUsage},set:function($e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage($e)}}});Object.assign(InterleavedBuffer.prototype,{setDynamic:function($e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage($e===!0?DynamicDrawUsage:StaticDrawUsage),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(ExtrudeBufferGeometry.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.defineProperties(Uniform.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}});Object.defineProperties(Material.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Color}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function($e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=$e===FlatShading}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function($e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=$e}}});Object.defineProperties(MeshPhongMaterial.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function($e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=$e}}});Object.assign(WebGLRenderer.prototype,{clearTarget:function($e,Se,Be,De){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget($e),this.clear(Se,Be,De)},animate:function($e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop($e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function($e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest($e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}});Object.defineProperties(WebGLRenderer.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function($e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=$e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function($e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=$e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function($e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=$e===!0?sRGBEncoding:LinearEncoding}}});Object.defineProperties(WebGLShadowMap.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function($e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=$e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function($e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=$e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function($e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=$e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function($e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=$e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function($e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=$e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function($e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=$e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function($e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=$e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function($e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=$e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function($e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=$e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function($e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=$e}}});Object.defineProperties(Audio$1.prototype,{load:{value:function($e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var Se=this,Be=new AudioLoader;return Be.load($e,function(De){Se.setBuffer(De)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}});AudioAnalyser.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};CubeCamera.prototype.updateCubeMap=function($e,Se){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update($e,Se)};ImageUtils.crossOrigin=void 0;ImageUtils.loadTexture=function($e,Se,Be,De){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var Ve=new TextureLoader$1;Ve.setCrossOrigin(this.crossOrigin);var Fe=Ve.load($e,Be,void 0,De);return Se&&(Fe.mapping=Se),Fe};ImageUtils.loadTextureCube=function($e,Se,Be,De){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var Ve=new CubeTextureLoader;Ve.setCrossOrigin(this.crossOrigin);var Fe=Ve.load($e,Be,void 0,De);return Se&&(Fe.mapping=Se),Fe};ImageUtils.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};ImageUtils.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));var version=Number(REVISION);if(version<115||version>117)throw new Error('"Five" needs "THREE.js" version between 125 - 117.');/**
 * @license
 * The 'jsrsasign'(RSA-Sign JavaScript Library) License
 *
 * Copyright (c) 2010-2021 Kenji Urushima
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * LICENSE: MIT License
 *//**
 * @license
 * RSA and ECC in JavaScript
 *
 * Copyright (c) 2003-2005  Tom Wu All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 *
 * http://www-cs-students.stanford.edu/~tjw/jsbn/
 * LICENSE: BSD License
 * PART: ext/{base64,jsbn,jsbn2,prgn4,rng,rsa,rsa2}
 *//**
 * @license
 * CryptoJS
 *
 * Copyright (c) 2009-2013 Jeff Mott
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * https://code.google.com/p/crypto-js/wiki/License
 * PART: ext/cryptojs
 */var KJUR={},CryptoJS=CryptoJS||function($e,Se){var Be={},De=Be.lib={},Ve=De.Base=function(){function cr(){}return{extend:function(Br){cr.prototype=this;var tn=new cr;return Br&&tn.mixIn(Br),tn.hasOwnProperty("init")||(tn.init=function(){tn.$super.init.apply(this,arguments)}),tn.init.prototype=tn,tn.$super=this,tn},create:function(){var Br=this.extend();return Br.init.apply(Br,arguments),Br},init:function(){},mixIn:function(Br){for(var tn in Br)Br.hasOwnProperty(tn)&&(this[tn]=Br[tn]);Br.hasOwnProperty("toString")&&(this.toString=Br.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),Fe=De.WordArray=Ve.extend({init:function(cr,Br){cr=this.words=cr||[],Br!=Se?this.sigBytes=Br:this.sigBytes=cr.length*4},toString:function(cr){return(cr||Xe).stringify(this)},concat:function(cr){var Br=this.words,tn=cr.words,en=this.sigBytes,an=cr.sigBytes;if(this.clamp(),en%4)for(var rn=0;rn<an;rn++){var on=tn[rn>>>2]>>>24-rn%4*8&255;Br[en+rn>>>2]|=on<<24-(en+rn)%4*8}else for(var rn=0;rn<an;rn+=4)Br[en+rn>>>2]=tn[rn>>>2];return this.sigBytes+=an,this},clamp:function(){var cr=this.words,Br=this.sigBytes;cr[Br>>>2]&=4294967295<<32-Br%4*8,cr.length=$e.ceil(Br/4)},clone:function(){var cr=Ve.clone.call(this);return cr.words=this.words.slice(0),cr},random:function(cr){for(var Br=[],tn=0;tn<cr;tn+=4)Br.push($e.random()*4294967296|0);return new Fe.init(Br,cr)}}),Je=Be.enc={},Xe=Je.Hex={stringify:function(cr){for(var Br=cr.words,tn=cr.sigBytes,en=[],an=0;an<tn;an++){var rn=Br[an>>>2]>>>24-an%4*8&255;en.push((rn>>>4).toString(16)),en.push((rn&15).toString(16))}return en.join("")},parse:function(cr){for(var Br=cr.length,tn=[],en=0;en<Br;en+=2)tn[en>>>3]|=parseInt(cr.substr(en,2),16)<<24-en%8*4;return new Fe.init(tn,Br/2)}},Ke=Je.Latin1={stringify:function(cr){for(var Br=cr.words,tn=cr.sigBytes,en=[],an=0;an<tn;an++){var rn=Br[an>>>2]>>>24-an%4*8&255;en.push(String.fromCharCode(rn))}return en.join("")},parse:function(cr){for(var Br=cr.length,tn=[],en=0;en<Br;en++)tn[en>>>2]|=(cr.charCodeAt(en)&255)<<24-en%4*8;return new Fe.init(tn,Br)}},Ye=Je.Utf8={stringify:function(cr){try{return decodeURIComponent(escape(Ke.stringify(cr)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(cr){return Ke.parse(unescape(encodeURIComponent(cr)))}},or=De.BufferedBlockAlgorithm=Ve.extend({reset:function(){this._data=new Fe.init,this._nDataBytes=0},_append:function(cr){typeof cr=="string"&&(cr=Ye.parse(cr)),this._data.concat(cr),this._nDataBytes+=cr.sigBytes},_process:function(cr){var Br=this._data,tn=Br.words,en=Br.sigBytes,an=this.blockSize,rn=an*4,on=en/rn;cr?on=$e.ceil(on):on=$e.max((on|0)-this._minBufferSize,0);var sn=on*an,ln=$e.min(sn*4,en);if(sn){for(var cn=0;cn<sn;cn+=an)this._doProcessBlock(tn,cn);var hn=tn.splice(0,sn);Br.sigBytes-=ln}return new Fe.init(hn,ln)},clone:function(){var cr=Ve.clone.call(this);return cr._data=this._data.clone(),cr},_minBufferSize:0});De.Hasher=or.extend({cfg:Ve.extend(),init:function(cr){this.cfg=this.cfg.extend(cr),this.reset()},reset:function(){or.reset.call(this),this._doReset()},update:function(cr){return this._append(cr),this._process(),this},finalize:function(cr){cr&&this._append(cr);var Br=this._doFinalize();return Br},blockSize:512/32,_createHelper:function(cr){return function(Br,tn){return new cr.init(tn).finalize(Br)}},_createHmacHelper:function(cr){return function(Br,tn){return new sr.HMAC.init(cr,tn).finalize(Br)}}});var sr=Be.algo={};return Be}(Math);(function($e){for(var Se=CryptoJS,Br=Se.lib,Be=Br.WordArray,De=Br.Hasher,Br=Se.algo,Ve=[],Fe=[],Je=function(en){return 4294967296*(en-(en|0))|0},Xe=2,Ke=0;64>Ke;){var Ye;e:{Ye=Xe;for(var or=$e.sqrt(Ye),sr=2;sr<=or;sr++)if(!(Ye%sr)){Ye=!1;break e}Ye=!0}Ye&&(8>Ke&&(Ve[Ke]=Je($e.pow(Xe,.5))),Fe[Ke]=Je($e.pow(Xe,1/3)),Ke++),Xe++}var cr=[],Br=Br.SHA256=De.extend({_doReset:function(){this._hash=new Be.init(Ve.slice(0))},_doProcessBlock:function(tn,en){for(var an=this._hash.words,rn=an[0],on=an[1],sn=an[2],ln=an[3],cn=an[4],hn=an[5],mn=an[6],An=an[7],xn=0;64>xn;xn++){if(16>xn)cr[xn]=tn[en+xn]|0;else{var pn=cr[xn-15],dn=cr[xn-2];cr[xn]=((pn<<25|pn>>>7)^(pn<<14|pn>>>18)^pn>>>3)+cr[xn-7]+((dn<<15|dn>>>17)^(dn<<13|dn>>>19)^dn>>>10)+cr[xn-16]}pn=An+((cn<<26|cn>>>6)^(cn<<21|cn>>>11)^(cn<<7|cn>>>25))+(cn&hn^~cn&mn)+Fe[xn]+cr[xn],dn=((rn<<30|rn>>>2)^(rn<<19|rn>>>13)^(rn<<10|rn>>>22))+(rn&on^rn&sn^on&sn),An=mn,mn=hn,hn=cn,cn=ln+pn|0,ln=sn,sn=on,on=rn,rn=pn+dn|0}an[0]=an[0]+rn|0,an[1]=an[1]+on|0,an[2]=an[2]+sn|0,an[3]=an[3]+ln|0,an[4]=an[4]+cn|0,an[5]=an[5]+hn|0,an[6]=an[6]+mn|0,an[7]=an[7]+An|0},_doFinalize:function(){var tn=this._data,en=tn.words,an=8*this._nDataBytes,rn=8*tn.sigBytes;return en[rn>>>5]|=128<<24-rn%32,en[(rn+64>>>9<<4)+14]=$e.floor(an/4294967296),en[(rn+64>>>9<<4)+15]=an,tn.sigBytes=4*en.length,this._process(),this._hash},clone:function(){var tn=De.clone.call(this);return tn._hash=this._hash.clone(),tn}});Se.SHA256=De._createHelper(Br),Se.HmacSHA256=De._createHmacHelper(Br)})(Math);CryptoJS.lib.Cipher||function($e){var Br=CryptoJS,Se=Br.lib,Be=Se.Base,De=Se.WordArray,Ve=Se.BufferedBlockAlgorithm,Fe=Br.enc.Base64,Je=Br.algo.EvpKDF,Xe=Se.Cipher=Ve.extend({cfg:Be.extend(),createEncryptor:function(en,an){return this.create(this._ENC_XFORM_MODE,en,an)},createDecryptor:function(en,an){return this.create(this._DEC_XFORM_MODE,en,an)},init:function(en,an,rn){this.cfg=this.cfg.extend(rn),this._xformMode=en,this._key=an,this.reset()},reset:function(){Ve.reset.call(this),this._doReset()},process:function(en){return this._append(en),this._process()},finalize:function(en){return en&&this._append(en),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(en){return{encrypt:function(an,rn,on){return(typeof rn=="string"?tn:cr).encrypt(en,an,rn,on)},decrypt:function(an,rn,on){return(typeof rn=="string"?tn:cr).decrypt(en,an,rn,on)}}}});Se.StreamCipher=Xe.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var sr=Br.mode={},Ke=function(en,an,rn){var on=this._iv;on?this._iv=$e:on=this._prevBlock;for(var sn=0;sn<rn;sn++)en[an+sn]^=on[sn]},Ye=(Se.BlockCipherMode=Be.extend({createEncryptor:function(en,an){return this.Encryptor.create(en,an)},createDecryptor:function(en,an){return this.Decryptor.create(en,an)},init:function(en,an){this._cipher=en,this._iv=an}})).extend();Ye.Encryptor=Ye.extend({processBlock:function(en,an){var rn=this._cipher,on=rn.blockSize;Ke.call(this,en,an,on),rn.encryptBlock(en,an),this._prevBlock=en.slice(an,an+on)}}),Ye.Decryptor=Ye.extend({processBlock:function(en,an){var rn=this._cipher,on=rn.blockSize,sn=en.slice(an,an+on);rn.decryptBlock(en,an),Ke.call(this,en,an,on),this._prevBlock=sn}}),sr=sr.CBC=Ye,Ye=(Br.pad={}).Pkcs7={pad:function(en,an){for(var rn=4*an,rn=rn-en.sigBytes%rn,on=rn<<24|rn<<16|rn<<8|rn,sn=[],ln=0;ln<rn;ln+=4)sn.push(on);rn=De.create(sn,rn),en.concat(rn)},unpad:function(en){en.sigBytes-=en.words[en.sigBytes-1>>>2]&255}},Se.BlockCipher=Xe.extend({cfg:Xe.cfg.extend({mode:sr,padding:Ye}),reset:function(){Xe.reset.call(this);var an=this.cfg,en=an.iv,an=an.mode;if(this._xformMode==this._ENC_XFORM_MODE)var rn=an.createEncryptor;else rn=an.createDecryptor,this._minBufferSize=1;this._mode=rn.call(an,this,en&&en.words)},_doProcessBlock:function(en,an){this._mode.processBlock(en,an)},_doFinalize:function(){var en=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){en.pad(this._data,this.blockSize);var an=this._process(!0)}else an=this._process(!0),en.unpad(an);return an},blockSize:4});var or=Se.CipherParams=Be.extend({init:function(en){this.mixIn(en)},toString:function(en){return(en||this.formatter).stringify(this)}}),sr=(Br.format={}).OpenSSL={stringify:function(en){var an=en.ciphertext;return en=en.salt,(en?De.create([1398893684,1701076831]).concat(en).concat(an):an).toString(Fe)},parse:function(en){en=Fe.parse(en);var an=en.words;if(an[0]==1398893684&&an[1]==1701076831){var rn=De.create(an.slice(2,4));an.splice(0,4),en.sigBytes-=16}return or.create({ciphertext:en,salt:rn})}},cr=Se.SerializableCipher=Be.extend({cfg:Be.extend({format:sr}),encrypt:function(en,an,rn,on){on=this.cfg.extend(on);var sn=en.createEncryptor(rn,on);return an=sn.finalize(an),sn=sn.cfg,or.create({ciphertext:an,key:rn,iv:sn.iv,algorithm:en,mode:sn.mode,padding:sn.padding,blockSize:en.blockSize,formatter:on.format})},decrypt:function(en,an,rn,on){return on=this.cfg.extend(on),an=this._parse(an,on.format),en.createDecryptor(rn,on).finalize(an.ciphertext)},_parse:function(en,an){return typeof en=="string"?an.parse(en,this):en}}),Br=(Br.kdf={}).OpenSSL={execute:function(en,an,rn,on){return on||(on=De.random(8)),en=Je.create({keySize:an+rn}).compute(en,on),rn=De.create(en.words.slice(an),4*rn),en.sigBytes=4*an,or.create({key:en,iv:rn,salt:on})}},tn=Se.PasswordBasedCipher=cr.extend({cfg:cr.cfg.extend({kdf:Br}),encrypt:function(en,an,rn,on){return on=this.cfg.extend(on),rn=on.kdf.execute(rn,en.keySize,en.ivSize),on.iv=rn.iv,en=cr.encrypt.call(this,en,an,rn.key,on),en.mixIn(rn),en},decrypt:function(en,an,rn,on){return on=this.cfg.extend(on),an=this._parse(an,on.format),rn=on.kdf.execute(rn,en.keySize,en.ivSize,an.salt),on.iv=rn.iv,cr.decrypt.call(this,en,an,rn.key,on)}})}();(function(){for(var $e=CryptoJS,Se=$e.lib.BlockCipher,hn=$e.algo,Be=[],De=[],Ve=[],Fe=[],Je=[],Xe=[],Ke=[],Ye=[],or=[],sr=[],cr=[],Br=0;256>Br;Br++)cr[Br]=128>Br?Br<<1:Br<<1^283;for(var tn=0,en=0,Br=0;256>Br;Br++){var an=en^en<<1^en<<2^en<<3^en<<4,an=an>>>8^an&255^99;Be[tn]=an,De[an]=tn;var rn=cr[tn],on=cr[rn],sn=cr[on],ln=257*cr[an]^16843008*an;Ve[tn]=ln<<24|ln>>>8,Fe[tn]=ln<<16|ln>>>16,Je[tn]=ln<<8|ln>>>24,Xe[tn]=ln,ln=16843009*sn^65537*on^257*rn^16843008*tn,Ke[an]=ln<<24|ln>>>8,Ye[an]=ln<<16|ln>>>16,or[an]=ln<<8|ln>>>24,sr[an]=ln,tn?(tn=rn^cr[cr[cr[sn^rn]]],en^=cr[cr[en]]):tn=en=1}var cn=[0,1,2,4,8,16,32,64,128,27,54],hn=hn.AES=Se.extend({_doReset:function(){for(var xn=this._key,mn=xn.words,An=xn.sigBytes/4,xn=4*((this._nRounds=An+6)+1),pn=this._keySchedule=[],dn=0;dn<xn;dn++)if(dn<An)pn[dn]=mn[dn];else{var fn=pn[dn-1];dn%An?6<An&&dn%An==4&&(fn=Be[fn>>>24]<<24|Be[fn>>>16&255]<<16|Be[fn>>>8&255]<<8|Be[fn&255]):(fn=fn<<8|fn>>>24,fn=Be[fn>>>24]<<24|Be[fn>>>16&255]<<16|Be[fn>>>8&255]<<8|Be[fn&255],fn^=cn[dn/An|0]<<24),pn[dn]=pn[dn-An]^fn}for(mn=this._invKeySchedule=[],An=0;An<xn;An++)dn=xn-An,fn=An%4?pn[dn]:pn[dn-4],mn[An]=4>An||4>=dn?fn:Ke[Be[fn>>>24]]^Ye[Be[fn>>>16&255]]^or[Be[fn>>>8&255]]^sr[Be[fn&255]]},encryptBlock:function(mn,An){this._doCryptBlock(mn,An,this._keySchedule,Ve,Fe,Je,Xe,Be)},decryptBlock:function(mn,An){var xn=mn[An+1];mn[An+1]=mn[An+3],mn[An+3]=xn,this._doCryptBlock(mn,An,this._invKeySchedule,Ke,Ye,or,sr,De),xn=mn[An+1],mn[An+1]=mn[An+3],mn[An+3]=xn},_doCryptBlock:function(mn,An,xn,pn,dn,fn,yn,Sn){for(var gn=this._nRounds,Vn=mn[An]^xn[0],Yn=mn[An+1]^xn[1],ni=mn[An+2]^xn[2],Pn=mn[An+3]^xn[3],Cn=4,Mn=1;Mn<gn;Mn++)var Bn=pn[Vn>>>24]^dn[Yn>>>16&255]^fn[ni>>>8&255]^yn[Pn&255]^xn[Cn++],kn=pn[Yn>>>24]^dn[ni>>>16&255]^fn[Pn>>>8&255]^yn[Vn&255]^xn[Cn++],Ln=pn[ni>>>24]^dn[Pn>>>16&255]^fn[Vn>>>8&255]^yn[Yn&255]^xn[Cn++],Pn=pn[Pn>>>24]^dn[Vn>>>16&255]^fn[Yn>>>8&255]^yn[ni&255]^xn[Cn++],Vn=Bn,Yn=kn,ni=Ln;Bn=(Sn[Vn>>>24]<<24|Sn[Yn>>>16&255]<<16|Sn[ni>>>8&255]<<8|Sn[Pn&255])^xn[Cn++],kn=(Sn[Yn>>>24]<<24|Sn[ni>>>16&255]<<16|Sn[Pn>>>8&255]<<8|Sn[Vn&255])^xn[Cn++],Ln=(Sn[ni>>>24]<<24|Sn[Pn>>>16&255]<<16|Sn[Vn>>>8&255]<<8|Sn[Yn&255])^xn[Cn++],Pn=(Sn[Pn>>>24]<<24|Sn[Vn>>>16&255]<<16|Sn[Yn>>>8&255]<<8|Sn[ni&255])^xn[Cn++],mn[An]=Bn,mn[An+1]=kn,mn[An+2]=Ln,mn[An+3]=Pn},keySize:8});$e.AES=Se._createHelper(hn)})();/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */var dbits;function BigInteger($e,Se,Be){$e!=null&&(typeof $e=="number"?this.fromNumber($e,Se,Be):Se==null&&typeof $e!="string"?this.fromString($e,256):this.fromString($e,Se))}function nbi(){return new BigInteger(null)}function am1($e,Se,Be,De,Ve,Fe){for(;--Fe>=0;){var Je=Se*this[$e++]+Be[De]+Ve;Ve=Math.floor(Je/67108864),Be[De++]=Je&67108863}return Ve}function am2($e,Se,Be,De,Ve,Fe){for(var Je=Se&32767,Xe=Se>>15;--Fe>=0;){var Ke=this[$e]&32767,Ye=this[$e++]>>15,or=Xe*Ke+Ye*Je;Ke=Je*Ke+((or&32767)<<15)+Be[De]+(Ve&1073741823),Ve=(Ke>>>30)+(or>>>15)+Xe*Ye+(Ve>>>30),Be[De++]=Ke&1073741823}return Ve}function am3($e,Se,Be,De,Ve,Fe){for(var Je=Se&16383,Xe=Se>>14;--Fe>=0;){var Ke=this[$e]&16383,Ye=this[$e++]>>14,or=Xe*Ke+Ye*Je;Ke=Je*Ke+((or&16383)<<14)+Be[De]+Ve,Ve=(Ke>>28)+(or>>14)+Xe*Ye,Be[De++]=Ke&268435455}return Ve}typeof navigator<"u"&&navigator.appName=="Microsoft Internet Explorer"?(BigInteger.prototype.am=am2,dbits=30):typeof navigator<"u"&&navigator.appName!="Netscape"?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28);BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr$2,vv;rr$2=48;for(vv=0;vv<=9;++vv)BI_RC[rr$2++]=vv;rr$2=97;for(vv=10;vv<36;++vv)BI_RC[rr$2++]=vv;rr$2=65;for(vv=10;vv<36;++vv)BI_RC[rr$2++]=vv;function int2char($e){return BI_RM.charAt($e)}function intAt($e,Se){var Be=BI_RC[$e.charCodeAt(Se)];return Be??-1}function bnpCopyTo($e){for(var Se=this.t-1;Se>=0;--Se)$e[Se]=this[Se];$e.t=this.t,$e.s=this.s}function bnpFromInt($e){this.t=1,this.s=$e<0?-1:0,$e>0?this[0]=$e:$e<-1?this[0]=$e+this.DV:this.t=0}function nbv($e){var Se=nbi();return Se.fromInt($e),Se}function bnpFromString($e,Se){var Be;if(Se==16)Be=4;else if(Se==8)Be=3;else if(Se==256)Be=8;else if(Se==2)Be=1;else if(Se==32)Be=5;else if(Se==4)Be=2;else{this.fromRadix($e,Se);return}this.t=0,this.s=0;for(var De=$e.length,Ve=!1,Fe=0;--De>=0;){var Je=Be==8?$e[De]&255:intAt($e,De);if(Je<0){$e.charAt(De)=="-"&&(Ve=!0);continue}Ve=!1,Fe==0?this[this.t++]=Je:Fe+Be>this.DB?(this[this.t-1]|=(Je&(1<<this.DB-Fe)-1)<<Fe,this[this.t++]=Je>>this.DB-Fe):this[this.t-1]|=Je<<Fe,Fe+=Be,Fe>=this.DB&&(Fe-=this.DB)}Be==8&&$e[0]&128&&(this.s=-1,Fe>0&&(this[this.t-1]|=(1<<this.DB-Fe)-1<<Fe)),this.clamp(),Ve&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var $e=this.s&this.DM;this.t>0&&this[this.t-1]==$e;)--this.t}function bnToString($e){if(this.s<0)return"-"+this.negate().toString($e);var Se;if($e==16)Se=4;else if($e==8)Se=3;else if($e==2)Se=1;else if($e==32)Se=5;else if($e==4)Se=2;else return this.toRadix($e);var Be=(1<<Se)-1,De,Ve=!1,Fe="",Je=this.t,Xe=this.DB-Je*this.DB%Se;if(Je-- >0)for(Xe<this.DB&&(De=this[Je]>>Xe)>0&&(Ve=!0,Fe=int2char(De));Je>=0;)Xe<Se?(De=(this[Je]&(1<<Xe)-1)<<Se-Xe,De|=this[--Je]>>(Xe+=this.DB-Se)):(De=this[Je]>>(Xe-=Se)&Be,Xe<=0&&(Xe+=this.DB,--Je)),De>0&&(Ve=!0),Ve&&(Fe+=int2char(De));return Ve?Fe:"0"}function bnNegate(){var $e=nbi();return BigInteger.ZERO.subTo(this,$e),$e}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo($e){var Se=this.s-$e.s;if(Se!=0)return Se;var Be=this.t;if(Se=Be-$e.t,Se!=0)return this.s<0?-Se:Se;for(;--Be>=0;)if((Se=this[Be]-$e[Be])!=0)return Se;return 0}function nbits($e){var Se=1,Be;return(Be=$e>>>16)!=0&&($e=Be,Se+=16),(Be=$e>>8)!=0&&($e=Be,Se+=8),(Be=$e>>4)!=0&&($e=Be,Se+=4),(Be=$e>>2)!=0&&($e=Be,Se+=2),(Be=$e>>1)!=0&&($e=Be,Se+=1),Se}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo($e,Se){var Be;for(Be=this.t-1;Be>=0;--Be)Se[Be+$e]=this[Be];for(Be=$e-1;Be>=0;--Be)Se[Be]=0;Se.t=this.t+$e,Se.s=this.s}function bnpDRShiftTo($e,Se){for(var Be=$e;Be<this.t;++Be)Se[Be-$e]=this[Be];Se.t=Math.max(this.t-$e,0),Se.s=this.s}function bnpLShiftTo($e,Se){var Be=$e%this.DB,De=this.DB-Be,Ve=(1<<De)-1,Fe=Math.floor($e/this.DB),Je=this.s<<Be&this.DM,Xe;for(Xe=this.t-1;Xe>=0;--Xe)Se[Xe+Fe+1]=this[Xe]>>De|Je,Je=(this[Xe]&Ve)<<Be;for(Xe=Fe-1;Xe>=0;--Xe)Se[Xe]=0;Se[Fe]=Je,Se.t=this.t+Fe+1,Se.s=this.s,Se.clamp()}function bnpRShiftTo($e,Se){Se.s=this.s;var Be=Math.floor($e/this.DB);if(Be>=this.t){Se.t=0;return}var De=$e%this.DB,Ve=this.DB-De,Fe=(1<<De)-1;Se[0]=this[Be]>>De;for(var Je=Be+1;Je<this.t;++Je)Se[Je-Be-1]|=(this[Je]&Fe)<<Ve,Se[Je-Be]=this[Je]>>De;De>0&&(Se[this.t-Be-1]|=(this.s&Fe)<<Ve),Se.t=this.t-Be,Se.clamp()}function bnpSubTo($e,Se){for(var Be=0,De=0,Ve=Math.min($e.t,this.t);Be<Ve;)De+=this[Be]-$e[Be],Se[Be++]=De&this.DM,De>>=this.DB;if($e.t<this.t){for(De-=$e.s;Be<this.t;)De+=this[Be],Se[Be++]=De&this.DM,De>>=this.DB;De+=this.s}else{for(De+=this.s;Be<$e.t;)De-=$e[Be],Se[Be++]=De&this.DM,De>>=this.DB;De-=$e.s}Se.s=De<0?-1:0,De<-1?Se[Be++]=this.DV+De:De>0&&(Se[Be++]=De),Se.t=Be,Se.clamp()}function bnpMultiplyTo($e,Se){var Be=this.abs(),De=$e.abs(),Ve=Be.t;for(Se.t=Ve+De.t;--Ve>=0;)Se[Ve]=0;for(Ve=0;Ve<De.t;++Ve)Se[Ve+Be.t]=Be.am(0,De[Ve],Se,Ve,0,Be.t);Se.s=0,Se.clamp(),this.s!=$e.s&&BigInteger.ZERO.subTo(Se,Se)}function bnpSquareTo($e){for(var Se=this.abs(),Be=$e.t=2*Se.t;--Be>=0;)$e[Be]=0;for(Be=0;Be<Se.t-1;++Be){var De=Se.am(Be,Se[Be],$e,2*Be,0,1);($e[Be+Se.t]+=Se.am(Be+1,2*Se[Be],$e,2*Be+1,De,Se.t-Be-1))>=Se.DV&&($e[Be+Se.t]-=Se.DV,$e[Be+Se.t+1]=1)}$e.t>0&&($e[$e.t-1]+=Se.am(Be,Se[Be],$e,2*Be,0,1)),$e.s=0,$e.clamp()}function bnpDivRemTo($e,Se,Be){var De=$e.abs();if(!(De.t<=0)){var Ve=this.abs();if(Ve.t<De.t){Se?.fromInt(0),Be!=null&&this.copyTo(Be);return}Be==null&&(Be=nbi());var Fe=nbi(),Je=this.s,Xe=$e.s,Ke=this.DB-nbits(De[De.t-1]);Ke>0?(De.lShiftTo(Ke,Fe),Ve.lShiftTo(Ke,Be)):(De.copyTo(Fe),Ve.copyTo(Be));var Ye=Fe.t,or=Fe[Ye-1];if(or!=0){var sr=or*(1<<this.F1)+(Ye>1?Fe[Ye-2]>>this.F2:0),cr=this.FV/sr,Br=(1<<this.F1)/sr,tn=1<<this.F2,en=Be.t,an=en-Ye,rn=Se??nbi();for(Fe.dlShiftTo(an,rn),Be.compareTo(rn)>=0&&(Be[Be.t++]=1,Be.subTo(rn,Be)),BigInteger.ONE.dlShiftTo(Ye,rn),rn.subTo(Fe,Fe);Fe.t<Ye;)Fe[Fe.t++]=0;for(;--an>=0;){var on=Be[--en]==or?this.DM:Math.floor(Be[en]*cr+(Be[en-1]+tn)*Br);if((Be[en]+=Fe.am(0,on,Be,an,0,Ye))<on)for(Fe.dlShiftTo(an,rn),Be.subTo(rn,Be);Be[en]<--on;)Be.subTo(rn,Be)}Se!=null&&(Be.drShiftTo(Ye,Se),Je!=Xe&&BigInteger.ZERO.subTo(Se,Se)),Be.t=Ye,Be.clamp(),Ke>0&&Be.rShiftTo(Ke,Be),Je<0&&BigInteger.ZERO.subTo(Be,Be)}}}function bnMod($e){var Se=nbi();return this.abs().divRemTo($e,null,Se),this.s<0&&Se.compareTo(BigInteger.ZERO)>0&&$e.subTo(Se,Se),Se}function Classic($e){this.m=$e}function cConvert($e){return $e.s<0||$e.compareTo(this.m)>=0?$e.mod(this.m):$e}function cRevert($e){return $e}function cReduce($e){$e.divRemTo(this.m,null,$e)}function cMulTo($e,Se,Be){$e.multiplyTo(Se,Be),this.reduce(Be)}function cSqrTo($e,Se){$e.squareTo(Se),this.reduce(Se)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var $e=this[0];if(!($e&1))return 0;var Se=$e&3;return Se=Se*(2-($e&15)*Se)&15,Se=Se*(2-($e&255)*Se)&255,Se=Se*(2-(($e&65535)*Se&65535))&65535,Se=Se*(2-$e*Se%this.DV)%this.DV,Se>0?this.DV-Se:-Se}function Montgomery($e){this.m=$e,this.mp=$e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<$e.DB-15)-1,this.mt2=2*$e.t}function montConvert($e){var Se=nbi();return $e.abs().dlShiftTo(this.m.t,Se),Se.divRemTo(this.m,null,Se),$e.s<0&&Se.compareTo(BigInteger.ZERO)>0&&this.m.subTo(Se,Se),Se}function montRevert($e){var Se=nbi();return $e.copyTo(Se),this.reduce(Se),Se}function montReduce($e){for(;$e.t<=this.mt2;)$e[$e.t++]=0;for(var Se=0;Se<this.m.t;++Se){var Be=$e[Se]&32767,De=Be*this.mpl+((Be*this.mph+($e[Se]>>15)*this.mpl&this.um)<<15)&$e.DM;for(Be=Se+this.m.t,$e[Be]+=this.m.am(0,De,$e,Se,0,this.m.t);$e[Be]>=$e.DV;)$e[Be]-=$e.DV,$e[++Be]++}$e.clamp(),$e.drShiftTo(this.m.t,$e),$e.compareTo(this.m)>=0&&$e.subTo(this.m,$e)}function montSqrTo($e,Se){$e.squareTo(Se),this.reduce(Se)}function montMulTo($e,Se,Be){$e.multiplyTo(Se,Be),this.reduce(Be)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this[0]&1:this.s)==0}function bnpExp($e,Se){if($e>4294967295||$e<1)return BigInteger.ONE;var Be=nbi(),De=nbi(),Ve=Se.convert(this),Fe=nbits($e)-1;for(Ve.copyTo(Be);--Fe>=0;)if(Se.sqrTo(Be,De),($e&1<<Fe)>0)Se.mulTo(De,Ve,Be);else{var Je=Be;Be=De,De=Je}return Se.revert(Be)}function bnModPowInt($e,Se){var Be;return $e<256||Se.isEven()?Be=new Classic(Se):Be=new Montgomery(Se),this.exp($e,Be)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/ */function bnIntValue(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnpChunkSize($e){return Math.floor(Math.LN2*this.DB/Math.log($e))}function bnSigNum(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function bnpToRadix($e){if($e==null&&($e=10),this.signum()==0||$e<2||$e>36)return"0";var Se=this.chunkSize($e),Be=Math.pow($e,Se),De=nbv(Be),Ve=nbi(),Fe=nbi(),Je="";for(this.divRemTo(De,Ve,Fe);Ve.signum()>0;)Je=(Be+Fe.intValue()).toString($e).substr(1)+Je,Ve.divRemTo(De,Ve,Fe);return Fe.intValue().toString($e)+Je}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.signum=bnSigNum;/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/ */var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=";function hex2b64($e){var Se,Be,De="";for(Se=0;Se+3<=$e.length;Se+=3)Be=parseInt($e.substring(Se,Se+3),16),De+=b64map.charAt(Be>>6)+b64map.charAt(Be&63);for(Se+1==$e.length?(Be=parseInt($e.substring(Se,Se+1),16),De+=b64map.charAt(Be<<2)):Se+2==$e.length&&(Be=parseInt($e.substring(Se,Se+2),16),De+=b64map.charAt(Be>>2)+b64map.charAt((Be&3)<<4));(De.length&3)>0;)De+=b64pad;return De}function b64tohex($e){var Se="",Be,De=0,Ve,Fe;for(Be=0;Be<$e.length&&$e.charAt(Be)!=b64pad;++Be)Fe=b64map.indexOf($e.charAt(Be)),!(Fe<0)&&(De==0?(Se+=int2char(Fe>>2),Ve=Fe&3,De=1):De==1?(Se+=int2char(Ve<<2|Fe>>4),Ve=Fe&15,De=2):De==2?(Se+=int2char(Ve),Se+=int2char(Fe>>2),Ve=Fe&3,De=3):(Se+=int2char(Ve<<2|Fe>>4),Se+=int2char(Fe&15),De=0));return De==1&&(Se+=int2char(Ve<<2)),Se}/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/ */function parseBigInt($e,Se){return new BigInteger($e,Se)}function pkcs1pad2($e,Se){if(Se<$e.length+11)throw"Message too long for RSA";for(var Be=new Array,De=$e.length-1;De>=0&&Se>0;){var Ve=$e.charCodeAt(De--);Ve<128?Be[--Se]=Ve:Ve>127&&Ve<2048?(Be[--Se]=Ve&63|128,Be[--Se]=Ve>>6|192):(Be[--Se]=Ve&63|128,Be[--Se]=Ve>>6&63|128,Be[--Se]=Ve>>12|224)}Be[--Se]=0;for(var Fe=new SecureRandom,Je=new Array;Se>2;){for(Je[0]=0;Je[0]==0;)Fe.nextBytes(Je);Be[--Se]=Je[0]}return Be[--Se]=2,Be[--Se]=0,new BigInteger(Be)}function oaep_mgf1_arr($e,Se,Be){for(var De="",Ve=0;De.length<Se;)De+=Be(String.fromCharCode.apply(String,$e.concat([(Ve&4278190080)>>24,(Ve&16711680)>>16,(Ve&65280)>>8,Ve&255]))),Ve+=1;return De}function oaep_pad($e,Se,Be,De){var Ve=KJUR.crypto.MessageDigest,Fe=KJUR.crypto.Util,Je=null;if(Be||(Be="sha1"),typeof Be=="string"&&(Je=Ve.getCanonicalAlgName(Be),De=Ve.getHashLength(Je),Be=function(en){return hextorstr(Fe.hashHex(rstrtohex(en),Je))}),$e.length+2*De+2>Se)throw"Message too long for RSA";var Xe="",Ke;for(Ke=0;Ke<Se-$e.length-2*De-2;Ke+=1)Xe+="\0";var Ye=Be("")+Xe+""+$e,or=new Array(De);new SecureRandom().nextBytes(or);var sr=oaep_mgf1_arr(or,Ye.length,Be),cr=[];for(Ke=0;Ke<Ye.length;Ke+=1)cr[Ke]=Ye.charCodeAt(Ke)^sr.charCodeAt(Ke);var Br=oaep_mgf1_arr(cr,or.length,Be),tn=[0];for(Ke=0;Ke<or.length;Ke+=1)tn[Ke+1]=or[Ke]^Br.charCodeAt(Ke);return new BigInteger(tn.concat(cr))}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic($e,Se){if(this.isPublic=!0,this.isPrivate=!1,typeof $e!="string")this.n=$e,this.e=Se;else if($e!=null&&Se!=null&&$e.length>0&&Se.length>0)this.n=parseBigInt($e,16),this.e=parseInt(Se,16);else throw"Invalid RSA public key"}function RSADoPublic($e){return $e.modPowInt(this.e,this.n)}function RSAEncrypt($e){var Se=pkcs1pad2($e,this.n.bitLength()+7>>3);if(Se==null)return null;var Be=this.doPublic(Se);if(Be==null)return null;var De=Be.toString(16);return De.length&1?"0"+De:De}function RSAEncryptOAEP($e,Se,Be){var De=oaep_pad($e,this.n.bitLength()+7>>3,Se,Be);if(De==null)return null;var Ve=this.doPublic(De);if(Ve==null)return null;var Fe=Ve.toString(16);return Fe.length&1?"0"+Fe:Fe}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;RSAKey.prototype.type="RSA";/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/ */function pkcs1unpad2($e,Se){for(var Be=$e.toByteArray(),De=0;De<Be.length&&Be[De]==0;)++De;if(Be.length-De!=Se-1||Be[De]!=2)return null;for(++De;Be[De]!=0;)if(++De>=Be.length)return null;for(var Ve="";++De<Be.length;){var Fe=Be[De]&255;Fe<128?Ve+=String.fromCharCode(Fe):Fe>191&&Fe<224?(Ve+=String.fromCharCode((Fe&31)<<6|Be[De+1]&63),++De):(Ve+=String.fromCharCode((Fe&15)<<12|(Be[De+1]&63)<<6|Be[De+2]&63),De+=2)}return Ve}function oaep_mgf1_str($e,Se,Be){for(var De="",Ve=0;De.length<Se;)De+=Be($e+String.fromCharCode.apply(String,[(Ve&4278190080)>>24,(Ve&16711680)>>16,(Ve&65280)>>8,Ve&255])),Ve+=1;return De}function oaep_unpad($e,Se,Be,De){var Ve=KJUR.crypto.MessageDigest,Fe=KJUR.crypto.Util,Je=null;Be||(Be="sha1"),typeof Be=="string"&&(Je=Ve.getCanonicalAlgName(Be),De=Ve.getHashLength(Je),Be=function(an){return hextorstr(Fe.hashHex(rstrtohex(an),Je))}),$e=$e.toByteArray();var sr;for(sr=0;sr<$e.length;sr+=1)$e[sr]&=255;for(;$e.length<Se;)$e.unshift(0);if($e=String.fromCharCode.apply(String,$e),$e.length<2*De+2)throw"Cipher too short";var Xe=$e.substr(1,De),Ke=$e.substr(De+1),Ye=oaep_mgf1_str(Ke,De,Be),or=[],sr;for(sr=0;sr<Xe.length;sr+=1)or[sr]=Xe.charCodeAt(sr)^Ye.charCodeAt(sr);var cr=oaep_mgf1_str(String.fromCharCode.apply(String,or),$e.length-De,Be),Br=[];for(sr=0;sr<Ke.length;sr+=1)Br[sr]=Ke.charCodeAt(sr)^cr.charCodeAt(sr);if(Br=String.fromCharCode.apply(String,Br),Br.substr(0,De)!==Be(""))throw"Hash mismatch";Br=Br.substr(De);var tn=Br.indexOf(""),en=tn!=-1?Br.substr(0,tn).lastIndexOf("\0"):-1;if(en+1!=tn)throw"Malformed data";return Br.substr(tn+1)}function RSASetPrivate($e,Se,Be){if(this.isPrivate=!0,typeof $e!="string")this.n=$e,this.e=Se,this.d=Be;else if($e!=null&&Se!=null&&$e.length>0&&Se.length>0)this.n=parseBigInt($e,16),this.e=parseInt(Se,16),this.d=parseBigInt(Be,16);else throw"Invalid RSA private key"}function RSASetPrivateEx($e,Se,Be,De,Ve,Fe,Je,Xe){if(this.isPrivate=!0,this.isPublic=!1,$e==null)throw"RSASetPrivateEx N == null";if(Se==null)throw"RSASetPrivateEx E == null";if($e.length==0)throw"RSASetPrivateEx N.length == 0";if(Se.length==0)throw"RSASetPrivateEx E.length == 0";if($e!=null&&Se!=null&&$e.length>0&&Se.length>0)this.n=parseBigInt($e,16),this.e=parseInt(Se,16),this.d=parseBigInt(Be,16),this.p=parseBigInt(De,16),this.q=parseBigInt(Ve,16),this.dmp1=parseBigInt(Fe,16),this.dmq1=parseBigInt(Je,16),this.coeff=parseBigInt(Xe,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function RSADoPrivate($e){if(this.p==null||this.q==null)return $e.modPow(this.d,this.n);for(var Se=$e.mod(this.p).modPow(this.dmp1,this.p),Be=$e.mod(this.q).modPow(this.dmq1,this.q);Se.compareTo(Be)<0;)Se=Se.add(this.p);return Se.subtract(Be).multiply(this.coeff).mod(this.p).multiply(this.q).add(Be)}function RSADecrypt($e){if($e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var Se=parseBigInt($e,16),Be=this.doPrivate(Se);return Be==null?null:pkcs1unpad2(Be,this.n.bitLength()+7>>3)}function RSADecryptOAEP($e,Se,Be){if($e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var De=parseBigInt($e,16),Ve=this.doPrivate(De);return Ve==null?null:oaep_unpad(Ve,this.n.bitLength()+7>>3,Se,Be)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.decryptOAEP=RSADecryptOAEP;(typeof KJUR.lang>"u"||!KJUR.lang)&&(KJUR.lang={});KJUR.lang.String=function(){};function b64utob64($e){return $e.length%4==2?$e=$e+"==":$e.length%4==3&&($e=$e+"="),$e=$e.replace(/-/g,"+"),$e=$e.replace(/_/g,"/"),$e}function b64utohex($e){return b64tohex(b64utob64($e))}function hextoutf8($e){return decodeURIComponent(hextouricmp($e))}function hextorstr($e){for(var Se="",Be=0;Be<$e.length-1;Be+=2)Se+=String.fromCharCode(parseInt($e.substr(Be,2),16));return Se}function rstrtohex($e){for(var Se="",Be=0;Be<$e.length;Be++)Se+=("0"+$e.charCodeAt(Be).toString(16)).slice(-2);return Se}function hextob64($e){return hex2b64($e)}function hextob64nl($e){var Se=hextob64($e),Be=Se.replace(/(.{64})/g,`$1\r
`);return Be=Be.replace(/\r\n$/,""),Be}function b64nltohex($e){var Se=$e.replace(/[^0-9A-Za-z\/+=]*/g,""),Be=b64tohex(Se);return Be}function hextopem($e,Se){var Be=hextob64nl($e);return"-----BEGIN "+Se+`-----\r
`+Be+`\r
-----END `+Se+`-----\r
`}function pemtohex($e,Se){if($e.indexOf("-----BEGIN ")==-1)throw"can't find PEM header: "+Se;return Se!==void 0?($e=$e.replace(new RegExp("^[^]*-----BEGIN "+Se+"-----"),""),$e=$e.replace(new RegExp("-----END "+Se+"-----[^]*$"),"")):($e=$e.replace(/^[^]*-----BEGIN [^-]+-----/,""),$e=$e.replace(/-----END [^-]+-----[^]*$/,"")),b64nltohex($e)}function hextouricmp($e){return $e.replace(/(..)/g,"%$1")}function hextoipv6($e){if(!$e.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";$e=$e.toLowerCase();for(var Se=$e.match(/.{1,4}/g),Be=0;Be<8;Be++)Se[Be]=Se[Be].replace(/^0+/,""),Se[Be]==""&&(Se[Be]="0");$e=":"+Se.join(":")+":";var De=$e.match(/:(0:){2,}/g);if(De===null)return $e.slice(1,-1);for(var Ve="",Be=0;Be<De.length;Be++)De[Be].length>Ve.length&&(Ve=De[Be]);return $e=$e.replace(Ve,"::"),$e.slice(1,-1)}function hextoip($e){var Se="malformed hex value";if(!$e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw Se;if($e.length==8){var Be;try{return Be=parseInt($e.substr(0,2),16)+"."+parseInt($e.substr(2,2),16)+"."+parseInt($e.substr(4,2),16)+"."+parseInt($e.substr(6,2),16),Be}catch{throw Se}}else return $e.length==32?hextoipv6($e):$e}function ucs2hextoutf8($e){function Se(Ve){var Fe=parseInt(Ve.substr(0,2),16),Je=parseInt(Ve.substr(2),16);if(Fe==0&Je<128)return String.fromCharCode(Je);if(Fe<8){var Xe=192|(Fe&7)<<3|(Je&192)>>6,Ke=128|Je&63;return hextoutf8(Xe.toString(16)+Ke.toString(16))}var Xe=224|(Fe&240)>>4,Ke=128|(Fe&15)<<2|(Je&192)>>6,Ye=128|Je&63;return hextoutf8(Xe.toString(16)+Ke.toString(16)+Ye.toString(16))}var Be=$e.match(/.{4}/g),De=Be.map(Se);return De.join("")}KJUR.lang.String.isHex=function($e){return ishex($e)};function ishex($e){return!!($e.length%2==0&&($e.match(/^[0-9a-f]+$/)||$e.match(/^[0-9A-F]+$/)))}KJUR.lang.String.isMail=function($e){return $e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function hextoposhex($e){return $e.length%2==1?"0"+$e:$e.substr(0,1)>"7"?"00"+$e:$e}function hextooid($e){if(!ishex($e))return null;try{var Se=[],Be=$e.substr(0,2),De=parseInt(Be,16);Se[0]=new String(Math.floor(De/40)),Se[1]=new String(De%40);for(var Ve=$e.substr(2),Fe=[],Je=0;Je<Ve.length/2;Je++)Fe.push(parseInt(Ve.substr(Je*2,2),16));for(var Xe=[],Ke="",Je=0;Je<Fe.length;Je++)Fe[Je]&128?Ke=Ke+strpad((Fe[Je]&127).toString(2),7):(Ke=Ke+strpad((Fe[Je]&127).toString(2),7),Xe.push(new String(parseInt(Ke,2))),Ke="");var Ye=Se.join(".");return Xe.length>0&&(Ye=Ye+"."+Xe.join(".")),Ye}catch{return null}}var strpad=function($e,Se,Be){return Be==null&&(Be="0"),$e.length>=Se?$e:new Array(Se-$e.length+1).join(Be)+$e};function bitstrtoint($e){try{var Se=$e.substr(0,2);if(Se=="00")return parseInt($e.substr(2),16);var Be=parseInt(Se,16),De=$e.substr(2),Ve=parseInt(De,16).toString(2);return Ve=="0"&&(Ve="00000000"),Ve=Ve.slice(0,0-Be),parseInt(Ve,2)}catch{return-1}}(typeof KJUR.crypto>"u"||!KJUR.crypto)&&(KJUR.crypto={});KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:CryptoJS.algo.MD5,sha1:CryptoJS.algo.SHA1,sha224:CryptoJS.algo.SHA224,sha256:CryptoJS.algo.SHA256,sha384:CryptoJS.algo.SHA384,sha512:CryptoJS.algo.SHA512,ripemd160:CryptoJS.algo.RIPEMD160},this.hashString=function($e,Se){var Be=new KJUR.crypto.MessageDigest({alg:Se});return Be.digestString($e)},this.hashHex=function($e,Se){var Be=new KJUR.crypto.MessageDigest({alg:Se});return Be.digestHex($e)},this.sha1=function($e){return this.hashString($e,"sha1")},this.sha256=function($e){return this.hashString($e,"sha256")},this.sha256Hex=function($e){return this.hashHex($e,"sha256")},this.sha512=function($e){return this.hashString($e,"sha512")},this.sha512Hex=function($e){return this.hashHex($e,"sha512")}};KJUR.crypto.MessageDigest=function($e){this.setAlgAndProvider=function(Se,Be){if(Se=KJUR.crypto.MessageDigest.getCanonicalAlgName(Se),Se!==null&&Be===void 0&&(Be=KJUR.crypto.Util.DEFAULTPROVIDER[Se]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(Se)!=-1&&Be=="cryptojs"){try{this.md=KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[Se].create()}catch(De){throw"setAlgAndProvider hash alg set fail alg="+Se+"/"+De}this.updateString=function(De){this.md.update(De)},this.updateHex=function(De){var Ve=CryptoJS.enc.Hex.parse(De);this.md.update(Ve)},this.digest=function(){var De=this.md.finalize();return De.toString(CryptoJS.enc.Hex)},this.digestString=function(De){return this.updateString(De),this.digest()},this.digestHex=function(De){return this.updateHex(De),this.digest()}}if(":sha256:".indexOf(Se)!=-1&&Be=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(De){throw"setAlgAndProvider hash alg set fail alg="+Se+"/"+De}this.updateString=function(De){this.md.update(De)},this.updateHex=function(De){var Ve=sjcl.codec.hex.toBits(De);this.md.update(Ve)},this.digest=function(){var De=this.md.finalize();return sjcl.codec.hex.fromBits(De)},this.digestString=function(De){return this.updateString(De),this.digest()},this.digestHex=function(De){return this.updateHex(De),this.digest()}}},this.updateString=function(Se){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(Se){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(Se){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(Se){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},$e!==void 0&&$e.alg!==void 0&&(this.algName=$e.alg,$e.prov===void 0&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};KJUR.crypto.MessageDigest.getCanonicalAlgName=function($e){return typeof $e=="string"&&($e=$e.toLowerCase(),$e=$e.replace(/-/,"")),$e};KJUR.crypto.MessageDigest.getHashLength=function($e){var Se=KJUR.crypto.MessageDigest,Be=Se.getCanonicalAlgName($e);if(Se.HASHLENGTH[Be]===void 0)throw"not supported algorithm: "+$e;return Se.HASHLENGTH[Be]};KJUR.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};KJUR.crypto.Signature=function($e){var Se=null;if(this._setAlgNames=function(){var Be=this.algName.match(/^(.+)with(.+)$/);Be&&(this.mdAlgName=Be[1].toLowerCase(),this.pubkeyAlgName=Be[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(Be,De){for(var Ve="",Fe=De/4-Be.length,Je=0;Je<Fe;Je++)Ve=Ve+"0";return Ve+Be},this.setAlgAndProvider=function(Be,De){if(this._setAlgNames(),De!="cryptojs/jsrsa")throw new Error("provider not supported: "+De);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(Ve){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+Ve)}this.init=function(Ve,Fe){var Je=null;try{Fe===void 0?Je=KEYUTIL.getKey(Ve):Je=KEYUTIL.getKey(Ve,Fe)}catch(Xe){throw"init failed:"+Xe}if(Je.isPrivate===!0)this.prvKey=Je,this.state="SIGN";else if(Je.isPublic===!0)this.pubKey=Je,this.state="VERIFY";else throw"init failed.:"+Je},this.updateString=function(Ve){this.md.updateString(Ve)},this.updateHex=function(Ve){this.md.updateHex(Ve)},this.verify=function(Ve){if(this.sHashHex=this.md.digest(),this.pubKey instanceof RSAKey&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,Ve,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof RSAKey&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,Ve);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(Be,De){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(Be){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(Be){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(Be){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=$e,$e!==void 0&&($e.alg!==void 0&&(this.algName=$e.alg,$e.prov===void 0?this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=$e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),$e.psssaltlen!==void 0&&(this.pssSaltLen=$e.psssaltlen),$e.prvkeypem!==void 0)){if($e.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var Se=KEYUTIL.getKey($e.prvkeypem);this.init(Se)}catch(Be){throw"fatal error to load pem private key: "+Be}}};KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};var KEYUTIL=function(){var $e=function(tn,en,an){return De(CryptoJS.AES,tn,en,an)},Se=function(tn,en,an){return De(CryptoJS.TripleDES,tn,en,an)},Be=function(tn,en,an){return De(CryptoJS.DES,tn,en,an)},De=function(tn,en,an,rn){var on=CryptoJS.enc.Hex.parse(en),sn=CryptoJS.enc.Hex.parse(an),ln=CryptoJS.enc.Hex.parse(rn),cn={};cn.key=sn,cn.iv=ln,cn.ciphertext=on;var hn=tn.decrypt(cn,sn,{iv:ln});return CryptoJS.enc.Hex.stringify(hn)},Ve=function(tn,en,an){return Xe(CryptoJS.AES,tn,en,an)},Fe=function(tn,en,an){return Xe(CryptoJS.TripleDES,tn,en,an)},Je=function(tn,en,an){return Xe(CryptoJS.DES,tn,en,an)},Xe=function(tn,en,an,rn){var on=CryptoJS.enc.Hex.parse(en),sn=CryptoJS.enc.Hex.parse(an),ln=CryptoJS.enc.Hex.parse(rn),cn=tn.encrypt(on,sn,{iv:ln}),hn=CryptoJS.enc.Hex.parse(cn.toString()),mn=CryptoJS.enc.Base64.stringify(hn);return mn},Ke={"AES-256-CBC":{proc:$e,eproc:Ve,keylen:32,ivlen:16},"AES-192-CBC":{proc:$e,eproc:Ve,keylen:24,ivlen:16},"AES-128-CBC":{proc:$e,eproc:Ve,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:Se,eproc:Fe,keylen:24,ivlen:8},"DES-CBC":{proc:Be,eproc:Je,keylen:8,ivlen:8}},Ye=function(tn){var en=CryptoJS.lib.WordArray.random(tn),an=CryptoJS.enc.Hex.stringify(en);return an},or=function(tn){var en={},an=tn.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));an&&(en.cipher=an[1],en.ivsalt=an[2]);var rn=tn.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));rn&&(en.type=rn[1]);var on=-1,sn=0;tn.indexOf(`\r
\r
`)!=-1&&(on=tn.indexOf(`\r
\r
`),sn=2),tn.indexOf(`

`)!=-1&&(on=tn.indexOf(`

`),sn=1);var ln=tn.indexOf("-----END");if(on!=-1&&ln!=-1){var cn=tn.substring(on+sn*2,ln-sn);cn=cn.replace(/\s+/g,""),en.data=cn}return en},sr=function(tn,en,an){for(var rn=an.substring(0,16),on=CryptoJS.enc.Hex.parse(rn),sn=CryptoJS.enc.Utf8.parse(en),ln=Ke[tn].keylen+Ke[tn].ivlen,cn="",hn=null;;){var mn=CryptoJS.algo.MD5.create();if(hn!=null&&mn.update(hn),mn.update(sn),mn.update(on),hn=mn.finalize(),cn=cn+CryptoJS.enc.Hex.stringify(hn),cn.length>=ln*2)break}var An={};return An.keyhex=cn.substr(0,Ke[tn].keylen*2),An.ivhex=cn.substr(Ke[tn].keylen*2,Ke[tn].ivlen*2),An},cr=function(tn,en,an,rn){var on=CryptoJS.enc.Base64.parse(tn),sn=CryptoJS.enc.Hex.stringify(on),ln=Ke[en].proc,cn=ln(sn,an,rn);return cn},Br=function(tn,en,an,rn){var on=Ke[en].eproc,sn=on(tn,an,rn);return sn};return{version:"1.0.0",parsePKCS5PEM:function(tn){return or(tn)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(tn,en,an){return sr(tn,en,an)},decryptKeyB64:function(tn,en,an,rn){return cr(tn,en,an,rn)},getDecryptedKeyHex:function(tn,en){var an=or(tn),rn=an.cipher,on=an.ivsalt,sn=an.data,ln=sr(rn,en,on),cn=ln.keyhex,hn=cr(sn,rn,cn,on);return hn},getEncryptedPKCS5PEMFromPrvKeyHex:function(tn,en,an,rn,on){var xn="";if((typeof rn>"u"||rn==null)&&(rn="AES-256-CBC"),typeof Ke[rn]>"u")throw"KEYUTIL unsupported algorithm: "+rn;if(typeof on>"u"||on==null){var sn=Ke[rn].ivlen,ln=Ye(sn);on=ln.toUpperCase()}var cn=sr(rn,an,on),hn=cn.keyhex,mn=Br(en,rn,hn,on),An=mn.replace(/(.{64})/g,`$1\r
`),xn="-----BEGIN "+tn+` PRIVATE KEY-----\r
`;return xn+=`Proc-Type: 4,ENCRYPTED\r
`,xn+="DEK-Info: "+rn+","+on+`\r
`,xn+=`\r
`,xn+=An,xn+=`\r
-----END `+tn+` PRIVATE KEY-----\r
`,xn},parseHexOfEncryptedPKCS8:function(tn){var en=ASN1HEX,an=en.getChildIdx,rn=en.getV,on={},sn=an(tn,0);if(sn.length!=2)throw"malformed format: SEQUENCE(0).items != 2: "+sn.length;on.ciphertext=rn(tn,sn[1]);var ln=an(tn,sn[0]);if(ln.length!=2)throw"malformed format: SEQUENCE(0.0).items != 2: "+ln.length;if(rn(tn,ln[0])!="2a864886f70d01050d")throw"this only supports pkcs5PBES2";var cn=an(tn,ln[1]);if(ln.length!=2)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+cn.length;var hn=an(tn,cn[1]);if(hn.length!=2)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+hn.length;if(rn(tn,hn[0])!="2a864886f70d0307")throw"this only supports TripleDES";on.encryptionSchemeAlg="TripleDES",on.encryptionSchemeIV=rn(tn,hn[1]);var mn=an(tn,cn[0]);if(mn.length!=2)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+mn.length;if(rn(tn,mn[0])!="2a864886f70d01050c")throw"this only supports pkcs5PBKDF2";var An=an(tn,mn[1]);if(An.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+An.length;on.pbkdf2Salt=rn(tn,An[0]);var xn=rn(tn,An[1]);try{on.pbkdf2Iter=parseInt(xn,16)}catch{throw"malformed format pbkdf2Iter: "+xn}return on},getPBKDF2KeyHexFromParam:function(tn,en){var an=CryptoJS.enc.Hex.parse(tn.pbkdf2Salt),rn=tn.pbkdf2Iter,on=CryptoJS.PBKDF2(en,an,{keySize:192/32,iterations:rn}),sn=CryptoJS.enc.Hex.stringify(on);return sn},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(tn,en){var an=pemtohex(tn,"ENCRYPTED PRIVATE KEY"),rn=this.parseHexOfEncryptedPKCS8(an),on=KEYUTIL.getPBKDF2KeyHexFromParam(rn,en),sn={};sn.ciphertext=CryptoJS.enc.Hex.parse(rn.ciphertext);var ln=CryptoJS.enc.Hex.parse(on),cn=CryptoJS.enc.Hex.parse(rn.encryptionSchemeIV),hn=CryptoJS.TripleDES.decrypt(sn,ln,{iv:cn}),mn=CryptoJS.enc.Hex.stringify(hn);return mn},getKeyFromEncryptedPKCS8PEM:function(tn,en){var an=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(tn,en),rn=this.getKeyFromPlainPrivatePKCS8Hex(an);return rn},parsePlainPrivatePKCS8Hex:function(tn){var en=ASN1HEX,an=en.getChildIdx,rn=en.getV,on={};if(on.algparam=null,tn.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var sn=an(tn,0);if(sn.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(tn.substr(sn[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var ln=an(tn,sn[1]);if(ln.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(tn.substr(ln[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(on.algoid=rn(tn,ln[0]),tn.substr(ln[1],2)=="06"&&(on.algparam=rn(tn,ln[1])),tn.substr(sn[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return on.keyidx=en.getVidx(tn,sn[2]),on},getKeyFromPlainPrivatePKCS8PEM:function(tn){var en=pemtohex(tn,"PRIVATE KEY"),an=this.getKeyFromPlainPrivatePKCS8Hex(en);return an},getKeyFromPlainPrivatePKCS8Hex:function(tn){var en=this.parsePlainPrivatePKCS8Hex(tn),an;if(en.algoid=="2a864886f70d010101")an=new RSAKey;else if(KJUR.crypto.DSA&&en.algoid=="2a8648ce380401")an=new KJUR.crypto.DSA;else if(KJUR.crypto.ECDSA&&en.algoid=="2a8648ce3d0201")an=new KJUR.crypto.ECDSA;else throw"unsupported private key algorithm";return an.readPKCS8PrvKeyHex(tn),an},_getKeyFromPublicPKCS8Hex:function(tn){var en,an=ASN1HEX.getVbyList(tn,0,[0,0],"06");if(an==="2a864886f70d010101")en=new RSAKey;else if(KJUR.crypto.DSA&&an==="2a8648ce380401")en=new KJUR.crypto.DSA;else if(KJUR.crypto.ECDSA&&an==="2a8648ce3d0201")en=new KJUR.crypto.ECDSA;else throw"unsupported PKCS#8 public key hex";return en.readPKCS8PubKeyHex(tn),en},parsePublicRawRSAKeyHex:function(tn){var en=ASN1HEX,an=en.getChildIdx,rn=en.getV,on={};if(tn.substr(0,2)!="30")throw"malformed RSA key(code:001)";var sn=an(tn,0);if(sn.length!=2)throw"malformed RSA key(code:002)";if(tn.substr(sn[0],2)!="02")throw"malformed RSA key(code:003)";if(on.n=rn(tn,sn[0]),tn.substr(sn[1],2)!="02")throw"malformed RSA key(code:004)";return on.e=rn(tn,sn[1]),on},parsePublicPKCS8Hex:function(tn){var en=ASN1HEX,an=en.getChildIdx,rn=en.getV,on={};on.algparam=null;var sn=an(tn,0);if(sn.length!=2)throw"outer DERSequence shall have 2 elements: "+sn.length;var ln=sn[0];if(tn.substr(ln,2)!="30")throw"malformed PKCS8 public key(code:001)";var cn=an(tn,ln);if(cn.length!=2)throw"malformed PKCS8 public key(code:002)";if(tn.substr(cn[0],2)!="06")throw"malformed PKCS8 public key(code:003)";if(on.algoid=rn(tn,cn[0]),tn.substr(cn[1],2)=="06"?on.algparam=rn(tn,cn[1]):tn.substr(cn[1],2)=="30"&&(on.algparam={},on.algparam.p=en.getVbyList(tn,cn[1],[0],"02"),on.algparam.q=en.getVbyList(tn,cn[1],[1],"02"),on.algparam.g=en.getVbyList(tn,cn[1],[2],"02")),tn.substr(sn[1],2)!="03")throw"malformed PKCS8 public key(code:004)";return on.key=rn(tn,sn[1]).substr(2),on}}}();KEYUTIL.getKey=function($e,Se,Be){var De=ASN1HEX,Ve=De.getChildIdx;De.getV;var Fe=De.getVbyList,Je=KJUR.crypto,Xe=Je.ECDSA,Ke=Je.DSA,Ye=RSAKey,or=pemtohex,sr=KEYUTIL;if(typeof Ye<"u"&&$e instanceof Ye||typeof Xe<"u"&&$e instanceof Xe||typeof Ke<"u"&&$e instanceof Ke)return $e;if($e.curve!==void 0&&$e.xy!==void 0&&$e.d===void 0)return new Xe({pub:$e.xy,curve:$e.curve});if($e.curve!==void 0&&$e.d!==void 0)return new Xe({prv:$e.d,curve:$e.curve});if($e.kty===void 0&&$e.n!==void 0&&$e.e!==void 0&&$e.d===void 0){var cr=new Ye;return cr.setPublic($e.n,$e.e),cr}if($e.kty===void 0&&$e.n!==void 0&&$e.e!==void 0&&$e.d!==void 0&&$e.p!==void 0&&$e.q!==void 0&&$e.dp!==void 0&&$e.dq!==void 0&&$e.co!==void 0&&$e.qi===void 0){var cr=new Ye;return cr.setPrivateEx($e.n,$e.e,$e.d,$e.p,$e.q,$e.dp,$e.dq,$e.co),cr}if($e.kty===void 0&&$e.n!==void 0&&$e.e!==void 0&&$e.d!==void 0&&$e.p===void 0){var cr=new Ye;return cr.setPrivate($e.n,$e.e,$e.d),cr}if($e.p!==void 0&&$e.q!==void 0&&$e.g!==void 0&&$e.y!==void 0&&$e.x===void 0){var cr=new Ke;return cr.setPublic($e.p,$e.q,$e.g,$e.y),cr}if($e.p!==void 0&&$e.q!==void 0&&$e.g!==void 0&&$e.y!==void 0&&$e.x!==void 0){var cr=new Ke;return cr.setPrivate($e.p,$e.q,$e.g,$e.y,$e.x),cr}if($e.kty==="RSA"&&$e.n!==void 0&&$e.e!==void 0&&$e.d===void 0){var cr=new Ye;return cr.setPublic(b64utohex($e.n),b64utohex($e.e)),cr}if($e.kty==="RSA"&&$e.n!==void 0&&$e.e!==void 0&&$e.d!==void 0&&$e.p!==void 0&&$e.q!==void 0&&$e.dp!==void 0&&$e.dq!==void 0&&$e.qi!==void 0){var cr=new Ye;return cr.setPrivateEx(b64utohex($e.n),b64utohex($e.e),b64utohex($e.d),b64utohex($e.p),b64utohex($e.q),b64utohex($e.dp),b64utohex($e.dq),b64utohex($e.qi)),cr}if($e.kty==="RSA"&&$e.n!==void 0&&$e.e!==void 0&&$e.d!==void 0){var cr=new Ye;return cr.setPrivate(b64utohex($e.n),b64utohex($e.e),b64utohex($e.d)),cr}if($e.kty==="EC"&&$e.crv!==void 0&&$e.x!==void 0&&$e.y!==void 0&&$e.d===void 0){var Br=new Xe({curve:$e.crv}),tn=Br.ecparams.keylen/4,en=("0000000000"+b64utohex($e.x)).slice(-tn),an=("0000000000"+b64utohex($e.y)).slice(-tn),rn="04"+en+an;return Br.setPublicKeyHex(rn),Br}if($e.kty==="EC"&&$e.crv!==void 0&&$e.x!==void 0&&$e.y!==void 0&&$e.d!==void 0){var Br=new Xe({curve:$e.crv}),tn=Br.ecparams.keylen/4,en=("0000000000"+b64utohex($e.x)).slice(-tn),an=("0000000000"+b64utohex($e.y)).slice(-tn),rn="04"+en+an,on=("0000000000"+b64utohex($e.d)).slice(-tn);return Br.setPublicKeyHex(rn),Br.setPrivateKeyHex(on),Br}if(Be==="pkcs5prv"){var sn=$e,De=ASN1HEX,ln,cr;if(ln=Ve(sn,0),ln.length===9)cr=new Ye,cr.readPKCS5PrvKeyHex(sn);else if(ln.length===6)cr=new Ke,cr.readPKCS5PrvKeyHex(sn);else if(ln.length>2&&sn.substr(ln[1],2)==="04")cr=new Xe,cr.readPKCS5PrvKeyHex(sn);else throw"unsupported PKCS#1/5 hexadecimal key";return cr}if(Be==="pkcs8prv"){var cr=sr.getKeyFromPlainPrivatePKCS8Hex($e);return cr}if(Be==="pkcs8pub")return sr._getKeyFromPublicPKCS8Hex($e);if(Be==="x509pub")return X509.getPublicKeyFromCertHex($e);if($e.indexOf("-END CERTIFICATE-",0)!=-1||$e.indexOf("-END X509 CERTIFICATE-",0)!=-1||$e.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return X509.getPublicKeyFromCertPEM($e);if($e.indexOf("-END PUBLIC KEY-")!=-1){var cn=pemtohex($e,"PUBLIC KEY");return sr._getKeyFromPublicPKCS8Hex(cn)}if($e.indexOf("-END RSA PRIVATE KEY-")!=-1&&$e.indexOf("4,ENCRYPTED")==-1){var hn=or($e,"RSA PRIVATE KEY");return sr.getKey(hn,null,"pkcs5prv")}if($e.indexOf("-END DSA PRIVATE KEY-")!=-1&&$e.indexOf("4,ENCRYPTED")==-1){var mn=or($e,"DSA PRIVATE KEY"),An=Fe(mn,0,[1],"02"),xn=Fe(mn,0,[2],"02"),pn=Fe(mn,0,[3],"02"),dn=Fe(mn,0,[4],"02"),fn=Fe(mn,0,[5],"02"),cr=new Ke;return cr.setPrivate(new BigInteger(An,16),new BigInteger(xn,16),new BigInteger(pn,16),new BigInteger(dn,16),new BigInteger(fn,16)),cr}if($e.indexOf("-END EC PRIVATE KEY-")!=-1&&$e.indexOf("4,ENCRYPTED")==-1){var hn=or($e,"EC PRIVATE KEY");return sr.getKey(hn,null,"pkcs5prv")}if($e.indexOf("-END PRIVATE KEY-")!=-1)return sr.getKeyFromPlainPrivatePKCS8PEM($e);if($e.indexOf("-END RSA PRIVATE KEY-")!=-1&&$e.indexOf("4,ENCRYPTED")!=-1){var yn=sr.getDecryptedKeyHex($e,Se),Sn=new RSAKey;return Sn.readPKCS5PrvKeyHex(yn),Sn}if($e.indexOf("-END EC PRIVATE KEY-")!=-1&&$e.indexOf("4,ENCRYPTED")!=-1){var mn=sr.getDecryptedKeyHex($e,Se),cr=Fe(mn,0,[1],"04"),gn=Fe(mn,0,[2,0],"06"),Cn=Fe(mn,0,[3,0],"03").substr(2),Mn="";if(KJUR.crypto.OID.oidhex2name[gn]!==void 0)Mn=KJUR.crypto.OID.oidhex2name[gn];else throw"undefined OID(hex) in KJUR.crypto.OID: "+gn;var Br=new Xe({curve:Mn});return Br.setPublicKeyHex(Cn),Br.setPrivateKeyHex(cr),Br.isPublic=!1,Br}if($e.indexOf("-END DSA PRIVATE KEY-")!=-1&&$e.indexOf("4,ENCRYPTED")!=-1){var mn=sr.getDecryptedKeyHex($e,Se),An=Fe(mn,0,[1],"02"),xn=Fe(mn,0,[2],"02"),pn=Fe(mn,0,[3],"02"),dn=Fe(mn,0,[4],"02"),fn=Fe(mn,0,[5],"02"),cr=new Ke;return cr.setPrivate(new BigInteger(An,16),new BigInteger(xn,16),new BigInteger(pn,16),new BigInteger(dn,16),new BigInteger(fn,16)),cr}if($e.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return sr.getKeyFromEncryptedPKCS8PEM($e,Se);throw new Error("not supported argument")};(typeof KJUR.asn1>"u"||!KJUR.asn1)&&(KJUR.asn1={});KJUR.asn1.ASN1Util={};KJUR.asn1.ASN1Util.oidHexToInt=function($e){for(var Ve="",Se=parseInt($e.substr(0,2),16),Be=Math.floor(Se/40),De=Se%40,Ve=Be+"."+De,Fe="",Je=2;Je<$e.length;Je+=2){var Xe=parseInt($e.substr(Je,2),16),Ke=("00000000"+Xe.toString(2)).slice(-8);if(Fe=Fe+Ke.substr(1,7),Ke.substr(0,1)=="0"){var Ye=new BigInteger(Fe,2);Ve=Ve+"."+Ye.toString(10),Fe=""}}return Ve};var ASN1HEX=new function(){};ASN1HEX.getLblen=function($e,Se){if($e.substr(Se+2,1)!="8")return 1;var Be=parseInt($e.substr(Se+3,1));return Be==0?-1:0<Be&&Be<10?Be+1:-2};ASN1HEX.getL=function($e,Se){var Be=ASN1HEX.getLblen($e,Se);return Be<1?"":$e.substr(Se+2,Be*2)};ASN1HEX.getVblen=function($e,Se){var Be,De;return Be=ASN1HEX.getL($e,Se),Be==""?-1:(Be.substr(0,1)==="8"?De=new BigInteger(Be.substr(2),16):De=new BigInteger(Be,16),De.intValue())};ASN1HEX.getVidx=function($e,Se){var Be=ASN1HEX.getLblen($e,Se);return Be<0?Be:Se+(Be+1)*2};ASN1HEX.getV=function($e,Se){var Be=ASN1HEX.getVidx($e,Se),De=ASN1HEX.getVblen($e,Se);return $e.substr(Be,De*2)};ASN1HEX.getTLV=function($e,Se){return $e.substr(Se,2)+ASN1HEX.getL($e,Se)+ASN1HEX.getV($e,Se)};ASN1HEX.getTLVblen=function($e,Se){return 2+ASN1HEX.getLblen($e,Se)*2+ASN1HEX.getVblen($e,Se)*2};ASN1HEX.getNextSiblingIdx=function($e,Se){var Be=ASN1HEX.getVidx($e,Se),De=ASN1HEX.getVblen($e,Se);return Be+De*2};ASN1HEX.getChildIdx=function($e,Se){var Be=ASN1HEX,De=[],Ve,Fe,Je;Ve=Be.getVidx($e,Se),Fe=Be.getVblen($e,Se)*2,$e.substr(Se,2)=="03"&&(Ve+=2,Fe-=2),Je=0;for(var Xe=Ve;Je<=Fe;){var Ke=Be.getTLVblen($e,Xe);if(Je+=Ke,Je<=Fe&&De.push(Xe),Xe+=Ke,Je>=Fe)break}return De};ASN1HEX.getNthChildIdx=function($e,Se,Be){var De=ASN1HEX.getChildIdx($e,Se);return De[Be]};ASN1HEX.getIdxbyList=function($e,Se,Be,De){var Ve=ASN1HEX,Fe,Je;return Be.length==0?De!==void 0&&$e.substr(Se,2)!==De?-1:Se:(Fe=Be.shift(),Je=Ve.getChildIdx($e,Se),Fe>=Je.length?-1:Ve.getIdxbyList($e,Je[Fe],Be,De))};ASN1HEX.getIdxbyListEx=function($e,Se,Be,De){var Ve=ASN1HEX,Fe,Je;if(Be.length==0)return De!==void 0&&$e.substr(Se,2)!==De?-1:Se;Fe=Be.shift(),Je=Ve.getChildIdx($e,Se);for(var Xe=0,Ke=0;Ke<Je.length;Ke++){var Ye=$e.substr(Je[Ke],2);if(typeof Fe=="number"&&!Ve.isContextTag(Ye)&&Xe==Fe||typeof Fe=="string"&&Ve.isContextTag(Ye,Fe))return Ve.getIdxbyListEx($e,Je[Ke],Be,De);Ve.isContextTag(Ye)||Xe++}return-1};ASN1HEX.getTLVbyList=function($e,Se,Be,De){var Ve=ASN1HEX,Fe=Ve.getIdxbyList($e,Se,Be,De);return Fe==-1||Fe>=$e.length?null:Ve.getTLV($e,Fe)};ASN1HEX.getTLVbyListEx=function($e,Se,Be,De){var Ve=ASN1HEX,Fe=Ve.getIdxbyListEx($e,Se,Be,De);return Fe==-1?null:Ve.getTLV($e,Fe)};ASN1HEX.getVbyList=function($e,Se,Be,De,Ve){var Fe=ASN1HEX,Je,Xe;return Je=Fe.getIdxbyList($e,Se,Be,De),Je==-1||Je>=$e.length?null:(Xe=Fe.getV($e,Je),Ve===!0&&(Xe=Xe.substr(2)),Xe)};ASN1HEX.getVbyListEx=function($e,Se,Be,De,Ve){var Fe=ASN1HEX,Je,Xe;return Je=Fe.getIdxbyListEx($e,Se,Be,De),Je==-1?null:(Xe=Fe.getV($e,Je),$e.substr(Je,2)=="03"&&Ve!==!1&&(Xe=Xe.substr(2)),Xe)};ASN1HEX.getInt=function($e,Se,Be){Be==null&&(Be=-1);try{var De=$e.substr(Se,2);if(De!="02"&&De!="03")return Be;var Ve=ASN1HEX.getV($e,Se);return De=="02"?parseInt(Ve,16):bitstrtoint(Ve)}catch{return Be}};ASN1HEX.getOID=function($e,Se,Be){Be==null&&(Be=null);try{if($e.substr(Se,2)!="06")return Be;var De=ASN1HEX.getV($e,Se);return hextooid(De)}catch{return Be}};ASN1HEX.getOIDName=function($e,Se,Be){Be==null&&(Be=null);try{var De=ASN1HEX.getOID($e,Se,Be);if(De==Be)return Be;var Ve=KJUR.asn1.x509.OID.oid2name(De);return Ve==""?De:Ve}catch{return Be}};ASN1HEX.getString=function($e,Se,Be){Be==null&&(Be=null);try{var De=ASN1HEX.getV($e,Se);return hextorstr(De)}catch{return Be}};ASN1HEX.hextooidstr=function($e){var Se=function(sr,cr){return sr.length>=cr?sr:new Array(cr-sr.length+1).join("0")+sr},Be=[],De=$e.substr(0,2),Ve=parseInt(De,16);Be[0]=new String(Math.floor(Ve/40)),Be[1]=new String(Ve%40);for(var Fe=$e.substr(2),Je=[],Xe=0;Xe<Fe.length/2;Xe++)Je.push(parseInt(Fe.substr(Xe*2,2),16));for(var Ke=[],Ye="",Xe=0;Xe<Je.length;Xe++)Je[Xe]&128?Ye=Ye+Se((Je[Xe]&127).toString(2),7):(Ye=Ye+Se((Je[Xe]&127).toString(2),7),Ke.push(new String(parseInt(Ye,2))),Ye="");var or=Be.join(".");return Ke.length>0&&(or=or+"."+Ke.join(".")),or};ASN1HEX.isContextTag=function($e,Se){$e=$e.toLowerCase();var Be,De;try{Be=parseInt($e,16)}catch{return-1}if(Se===void 0)return(Be&192)==128;try{var Ve=Se.match(/^\[[0-9]+\]$/);return Ve==null||(De=parseInt(Se.substr(1,Se.length-1),10),De>31)?!1:(Be&192)==128&&(Be&31)==De}catch{return!1}};ASN1HEX.isASN1HEX=function($e){var Se=ASN1HEX;if($e.length%2==1)return!1;var Be=Se.getVblen($e,0),De=$e.substr(0,2),Ve=Se.getL($e,0),Fe=$e.length-De.length-Ve.length;return Fe==Be*2};ASN1HEX.checkStrictDER=function($e,Se,Be,De,Ve){var Fe=ASN1HEX;if(Be===void 0){if(typeof $e!="string")throw new Error("not hex string");if($e=$e.toLowerCase(),!KJUR.lang.String.isHex($e))throw new Error("not hex string");Be=$e.length,De=$e.length/2,De<128?Ve=1:Ve=Math.ceil(De.toString(16))+1}var Je=Fe.getL($e,Se);if(Je.length>Ve*2)throw new Error("L of TLV too long: idx="+Se);var Xe=Fe.getVblen($e,Se);if(Xe>De)throw new Error("value of L too long than hex: idx="+Se);var Ke=Fe.getTLV($e,Se),Ye=Ke.length-2-Fe.getL($e,Se).length;if(Ye!==Xe*2)throw new Error("V string length and L's value not the same:"+Ye+"/"+Xe*2);if(Se===0&&$e.length!=Ke.length)throw new Error("total length and TLV length unmatch:"+$e.length+"!="+Ke.length);var or=$e.substr(Se,2);if(or==="02"){var sr=Fe.getVidx($e,Se);if($e.substr(sr,2)=="00"&&$e.charCodeAt(sr+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(or,16)&32){for(var cr=Fe.getVblen($e,Se),Br=0,tn=Fe.getChildIdx($e,Se),en=0;en<tn.length;en++){var an=Fe.getTLV($e,tn[en]);Br+=an.length,Fe.checkStrictDER($e,tn[en],Be,De,Ve)}if(cr*2!=Br)throw new Error("sum of children's TLV length and L unmatch: "+cr*2+"!="+Br)}};ASN1HEX.oidname=function($e){var Se=KJUR.asn1;KJUR.lang.String.isHex($e)&&($e=Se.ASN1Util.oidHexToInt($e));var Be=Se.x509.OID.oid2name($e);return Be===""&&(Be=$e),Be};(typeof KJUR.asn1>"u"||!KJUR.asn1)&&(KJUR.asn1={});(typeof KJUR.asn1.x509>"u"||!KJUR.asn1.x509)&&(KJUR.asn1.x509={});KJUR.asn1.x509.AlgorithmIdentifier={};KJUR.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};KJUR.asn1.x509.OID=new function($e){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1"},this.objCache={},this.name2obj=function(Se){if(typeof this.objCache[Se]<"u")return this.objCache[Se];if(typeof this.name2oidList[Se]>"u")throw"Name of ObjectIdentifier not defined: "+Se;var Be=this.name2oidList[Se],De=new KJUR.asn1.DERObjectIdentifier({oid:Be});return this.objCache[Se]=De,De},this.atype2obj=function(Se){if(this.objCache[Se]!==void 0)return this.objCache[Se];var Be;if(Se.match(/^\d+\.\d+\.[0-9.]+$/))Be=Se;else if(this.atype2oidList[Se]!==void 0)Be=this.atype2oidList[Se];else if(this.name2oidList[Se]!==void 0)Be=this.name2oidList[Se];else throw"AttributeType name undefined: "+Se;var De=new KJUR.asn1.DERObjectIdentifier({oid:Be});return this.objCache[Se]=De,De}};KJUR.asn1.x509.OID.oid2name=function($e){var Se=KJUR.asn1.x509.OID.name2oidList;for(var Be in Se)if(Se[Be]==$e)return Be;return""};KJUR.asn1.x509.OID.oid2atype=function($e){var Se=KJUR.asn1.x509.OID.atype2oidList;for(var Be in Se)if(Se[Be]==$e)return Be;return $e};KJUR.asn1.x509.OID.name2oid=function($e){if($e.match(/^[0-9.]+$/))return $e;var Se=KJUR.asn1.x509.OID.name2oidList;return Se[$e]===void 0?"":Se[$e]};RSAKey.getPosArrayOfChildrenFromHex=function($e){return ASN1HEX.getChildIdx($e,0)};RSAKey.getHexValueArrayOfChildrenFromHex=function($e){var Se=ASN1HEX,Be=Se.getV,cr=RSAKey.getPosArrayOfChildrenFromHex($e),De=Be($e,cr[0]),Ve=Be($e,cr[1]),Fe=Be($e,cr[2]),Je=Be($e,cr[3]),Xe=Be($e,cr[4]),Ke=Be($e,cr[5]),Ye=Be($e,cr[6]),or=Be($e,cr[7]),sr=Be($e,cr[8]),cr=new Array;return cr.push(De,Ve,Fe,Je,Xe,Ke,Ye,or,sr),cr};RSAKey.prototype.readPrivateKeyFromPEMString=function($e){var Se=pemtohex($e),Be=RSAKey.getHexValueArrayOfChildrenFromHex(Se);this.setPrivateEx(Be[1],Be[2],Be[3],Be[4],Be[5],Be[6],Be[7],Be[8])};RSAKey.prototype.readPKCS5PrvKeyHex=function($e){var Se=RSAKey.getHexValueArrayOfChildrenFromHex($e);this.setPrivateEx(Se[1],Se[2],Se[3],Se[4],Se[5],Se[6],Se[7],Se[8])};RSAKey.prototype.readPKCS8PrvKeyHex=function($e){var Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye=ASN1HEX,or=Ye.getVbyListEx;if(Ye.isASN1HEX($e)===!1)throw new Error("not ASN.1 hex string");try{Se=or($e,0,[2,0,1],"02"),Be=or($e,0,[2,0,2],"02"),De=or($e,0,[2,0,3],"02"),Ve=or($e,0,[2,0,4],"02"),Fe=or($e,0,[2,0,5],"02"),Je=or($e,0,[2,0,6],"02"),Xe=or($e,0,[2,0,7],"02"),Ke=or($e,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(Se,Be,De,Ve,Fe,Je,Xe,Ke)};RSAKey.prototype.readPKCS5PubKeyHex=function($e){var Se=ASN1HEX,Be=Se.getV;if(Se.isASN1HEX($e)===!1)throw new Error("keyHex is not ASN.1 hex string");var De=Se.getChildIdx($e,0);if(De.length!==2||$e.substr(De[0],2)!=="02"||$e.substr(De[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var Ve=Be($e,De[0]),Fe=Be($e,De[1]);this.setPublic(Ve,Fe)};RSAKey.prototype.readPKCS8PubKeyHex=function($e){var Se=ASN1HEX;if(Se.isASN1HEX($e)===!1)throw new Error("not ASN.1 hex string");if(Se.getTLVbyListEx($e,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var Be=Se.getTLVbyListEx($e,0,[1,0]);this.readPKCS5PubKeyHex(Be)};RSAKey.prototype.readCertPubKeyHex=function($e,Se){var Be,De;Be=new X509,Be.readCertHex($e),De=Be.getPublicKeyHex(),this.readPKCS8PubKeyHex(De)};function _rsasign_getAlgNameAndHashFromHexDisgestInfo($e){for(var Se in KJUR.crypto.Util.DIGESTINFOHEAD){var Be=KJUR.crypto.Util.DIGESTINFOHEAD[Se],De=Be.length;if($e.substring(0,De)==Be){var Ve=[Se,$e.substring(De)];return Ve}}return[]}RSAKey.prototype.verify=function($e,Se){if(Se=Se.toLowerCase(),Se.match(/^[0-9a-f]+$/)==null)return!1;var Be=parseBigInt(Se,16),De=this.n.bitLength();if(Be.bitLength()>De)return!1;var Ve=this.doPublic(Be),Fe=Ve.toString(16);if(Fe.length+3!=De/4)return!1;var Je=Fe.replace(/^1f+00/,""),Xe=_rsasign_getAlgNameAndHashFromHexDisgestInfo(Je);if(Xe.length==0)return!1;var Ke=Xe[0],Ye=Xe[1],or=function(cr){return KJUR.crypto.Util.hashString(cr,Ke)},sr=or($e);return Ye==sr};RSAKey.prototype.verifyWithMessageHash=function($e,Se){if(Se.length!=Math.ceil(this.n.bitLength()/4))return!1;var Be=parseBigInt(Se,16);if(Be.bitLength()>this.n.bitLength())return 0;var De=this.doPublic(Be),Ve=De.toString(16).replace(/^1f+00/,""),Fe=_rsasign_getAlgNameAndHashFromHexDisgestInfo(Ve);if(Fe.length==0)return!1;Fe[0];var Je=Fe[1];return Je==$e};RSAKey.prototype.verifyPSS=function($e,Se,Be,De){var Ve=function(Je){return KJUR.crypto.Util.hashHex(Je,Be)},Fe=Ve(rstrtohex($e));return De===void 0&&(De=-1),this.verifyWithMessageHashPSS(Fe,Se,Be,De)};RSAKey.prototype.verifyWithMessageHashPSS=function($e,Se,Be,De){if(Se.length!=Math.ceil(this.n.bitLength()/4))return!1;var Ve=new BigInteger(Se,16),Fe=function(on){return KJUR.crypto.Util.hashHex(on,Be)},Je=hextorstr($e),Xe=Je.length,Ke=this.n.bitLength()-1,Ye=Math.ceil(Ke/8),or;if(De===-1||De===void 0)De=Xe;else if(De===-2)De=Ye-Xe-2;else if(De<-2)throw new Error("invalid salt length");if(Ye<Xe+De+2)throw new Error("data too long");var sr=this.doPublic(Ve).toByteArray();for(or=0;or<sr.length;or+=1)sr[or]&=255;for(;sr.length<Ye;)sr.unshift(0);if(sr[Ye-1]!==188)throw new Error("encoded message does not end in 0xbc");sr=String.fromCharCode.apply(String,sr);var cr=sr.substr(0,Ye-Xe-1),Br=sr.substr(cr.length,Xe),tn=65280>>8*Ye-Ke&255;if(cr.charCodeAt(0)&tn)throw new Error("bits beyond keysize not zero");var en=pss_mgf1_str(Br,cr.length,Fe),an=[];for(or=0;or<cr.length;or+=1)an[or]=cr.charCodeAt(or)^en.charCodeAt(or);an[0]&=~tn;var rn=Ye-Xe-De-2;for(or=0;or<rn;or+=1)if(an[or]!==0)throw new Error("leftmost octets not zero");if(an[rn]!==1)throw new Error("0x01 marker not found");return Br===hextorstr(Fe(rstrtohex("\0\0\0\0\0\0\0\0"+Je+String.fromCharCode.apply(String,an.slice(-De)))))};RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.SALT_LEN_RECOVER=-2;function X509($e){var Se=ASN1HEX,Be=Se.getChildIdx,De=Se.getV,Ve=Se.getTLV,Fe=Se.getVbyList,Je=Se.getVbyListEx,Xe=Se.getTLVbyList,Ke=Se.getTLVbyListEx,Ye=Se.getIdxbyList,or=Se.getIdxbyListEx,sr=Se.getVidx,cr=Se.getInt,Br=Se.oidname,tn=Se.hextooidstr,en=pemtohex,an;try{an=KJUR.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var rn=Xe(this.hex,0,[0,0]);if(rn.substr(0,2)=="a0"){var on=Xe(rn,0,[0]),sn=cr(on,0);if(sn<0||2<sn)throw new Error("malformed version field");return this.version=sn+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return Je(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var rn=Ke(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(rn)},this.getAlgorithmIdentifierName=function(rn){for(var on in an)if(rn===an[on])return on;return Br(Je(rn,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return Xe(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var rn=this.getIssuer();return rn.str},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return Xe(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var rn=this.getSubject();return rn.str},this.getNotBefore=function(){var rn=Fe(this.hex,0,[0,4+this.foffset,0]);return rn=rn.replace(/(..)/g,"%$1"),rn=decodeURIComponent(rn),rn},this.getNotAfter=function(){var rn=Fe(this.hex,0,[0,4+this.foffset,1]);return rn=rn.replace(/(..)/g,"%$1"),rn=decodeURIComponent(rn),rn},this.getPublicKeyHex=function(){return Se.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return Ye(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var rn=this.getPublicKeyIdx();return Ye(this.hex,rn,[1,0],"30")},this.getPublicKey=function(){return KEYUTIL.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var rn=Xe(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(rn)},this.getSignatureValueHex=function(){return Fe(this.hex,0,[2],"03",!0)},this.verifySignature=function(rn){var on=this.getSignatureAlgorithmField(),sn=this.getSignatureValueHex(),ln=Xe(this.hex,0,[0],"30"),cn=new KJUR.crypto.Signature({alg:on});return cn.init(rn),cn.updateHex(ln),cn.verify(sn)},this.parseExt=function(rn){var on,sn,ln;if(rn===void 0){if(ln=this.hex,this.version!==3)return-1;on=Ye(ln,0,[0,7,0],"30"),sn=Be(ln,on)}else{ln=pemtohex(rn);var cn=Ye(ln,0,[0,3,0,0],"06");if(De(ln,cn)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}on=Ye(ln,0,[0,3,0,1,0],"30"),sn=Be(ln,on),this.hex=ln}this.aExtInfo=new Array;for(var hn=0;hn<sn.length;hn++){var mn={};mn.critical=!1;var An=Be(ln,sn[hn]),xn=0;An.length===3&&(mn.critical=!0,xn=1),mn.oid=Se.hextooidstr(Fe(ln,sn[hn],[0],"06"));var pn=Ye(ln,sn[hn],[1+xn]);mn.vidx=sr(ln,pn),this.aExtInfo.push(mn)}},this.getExtInfo=function(rn){var on=this.aExtInfo,sn=rn;if(rn.match(/^[0-9.]+$/)||(sn=KJUR.asn1.x509.OID.name2oid(rn)),sn!==""){for(var ln=0;ln<on.length;ln++)if(on[ln].oid===sn)return on[ln]}},this.getExtBasicConstraints=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("basicConstraints");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"basicConstraints"};if(on&&(ln.critical=!0),rn==="3000")return ln;if(rn==="30030101ff")return ln.cA=!0,ln;if(rn.substr(0,12)==="30060101ff02"){var cn=De(rn,10),hn=parseInt(cn,16);return ln.cA=!0,ln.pathLen=hn,ln}throw new Error("hExtV parse error: "+rn)},this.getExtKeyUsage=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("keyUsage");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"keyUsage"};return on&&(ln.critical=!0),ln.names=this.getExtKeyUsageString(rn).split(","),ln},this.getExtKeyUsageBin=function(rn){if(rn===void 0){var on=this.getExtInfo("keyUsage");if(on===void 0)return"";rn=Ve(this.hex,on.vidx)}if(rn.length!=8&&rn.length!=10)throw new Error("malformed key usage value: "+rn);var sn="000000000000000"+parseInt(rn.substr(6),16).toString(2);return rn.length==8&&(sn=sn.slice(-8)),rn.length==10&&(sn=sn.slice(-16)),sn=sn.replace(/0+$/,""),sn==""&&(sn="0"),sn},this.getExtKeyUsageString=function(rn){for(var on=this.getExtKeyUsageBin(rn),sn=new Array,ln=0;ln<on.length;ln++)on.substr(ln,1)=="1"&&sn.push(X509.KEYUSAGE_NAME[ln]);return sn.join(",")},this.getExtSubjectKeyIdentifier=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("subjectKeyIdentifier");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"subjectKeyIdentifier"};on&&(ln.critical=!0);var cn=De(rn,0);return ln.kid={hex:cn},ln},this.getExtAuthorityKeyIdentifier=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("authorityKeyIdentifier");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"authorityKeyIdentifier"};on&&(ln.critical=!0);for(var cn=Be(rn,0),hn=0;hn<cn.length;hn++){var mn=rn.substr(cn[hn],2);if(mn==="80"&&(ln.kid={hex:De(rn,cn[hn])}),mn==="a1"){var An=Ve(rn,cn[hn]),xn=this.getGeneralNames(An);ln.issuer=xn[0].dn}mn==="82"&&(ln.sn={hex:De(rn,cn[hn])})}return ln},this.getExtExtKeyUsage=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("extKeyUsage");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"extKeyUsage",array:[]};on&&(ln.critical=!0);for(var cn=Be(rn,0),hn=0;hn<cn.length;hn++)ln.array.push(Br(De(rn,cn[hn])));return ln},this.getExtExtKeyUsageName=function(){var rn=this.getExtInfo("extKeyUsage");if(rn===void 0)return rn;var on=new Array,sn=Ve(this.hex,rn.vidx);if(sn==="")return on;for(var ln=Be(sn,0),cn=0;cn<ln.length;cn++)on.push(Br(De(sn,ln[cn])));return on},this.getExtSubjectAltName=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("subjectAltName");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"subjectAltName",array:[]};return on&&(ln.critical=!0),ln.array=this.getGeneralNames(rn),ln},this.getExtIssuerAltName=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("issuerAltName");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"issuerAltName",array:[]};return on&&(ln.critical=!0),ln.array=this.getGeneralNames(rn),ln},this.getGeneralNames=function(rn){for(var on=Be(rn,0),sn=[],ln=0;ln<on.length;ln++){var cn=this.getGeneralName(Ve(rn,on[ln]));cn!==void 0&&sn.push(cn)}return sn},this.getGeneralName=function(rn){var on=rn.substr(0,2),sn=De(rn,0),ln=hextorstr(sn);if(on=="81")return{rfc822:ln};if(on=="82")return{dns:ln};if(on=="86")return{uri:ln};if(on=="87")return{ip:hextoip(sn)};if(on=="a4")return{dn:this.getX500Name(sn)}},this.getExtSubjectAltName2=function(){var rn,on,sn,ln=this.getExtInfo("subjectAltName");if(ln===void 0)return ln;for(var cn=new Array,hn=Ve(this.hex,ln.vidx),mn=Be(hn,0),An=0;An<mn.length;An++)sn=hn.substr(mn[An],2),rn=De(hn,mn[An]),sn==="81"&&(on=hextoutf8(rn),cn.push(["MAIL",on])),sn==="82"&&(on=hextoutf8(rn),cn.push(["DNS",on])),sn==="84"&&(on=X509.hex2dn(rn,0),cn.push(["DN",on])),sn==="86"&&(on=hextoutf8(rn),cn.push(["URI",on])),sn==="87"&&(on=hextoip(rn),cn.push(["IP",on]));return cn},this.getExtCRLDistributionPoints=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("cRLDistributionPoints");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"cRLDistributionPoints",array:[]};on&&(ln.critical=!0);for(var cn=Be(rn,0),hn=0;hn<cn.length;hn++){var mn=Ve(rn,cn[hn]);ln.array.push(this.getDistributionPoint(mn))}return ln},this.getDistributionPoint=function(rn){for(var on={},sn=Be(rn,0),ln=0;ln<sn.length;ln++){var cn=rn.substr(sn[ln],2),hn=Ve(rn,sn[ln]);cn=="a0"&&(on.dpname=this.getDistributionPointName(hn))}return on},this.getDistributionPointName=function(rn){for(var on={},sn=Be(rn,0),ln=0;ln<sn.length;ln++){var cn=rn.substr(sn[ln],2),hn=Ve(rn,sn[ln]);cn=="a0"&&(on.full=this.getGeneralNames(hn))}return on},this.getExtCRLDistributionPointsURI=function(){var rn=this.getExtInfo("cRLDistributionPoints");if(rn===void 0)return rn;for(var on=new Array,sn=Be(this.hex,rn.vidx),ln=0;ln<sn.length;ln++)try{var cn=Fe(this.hex,sn[ln],[0,0,0],"86"),hn=hextoutf8(cn);on.push(hn)}catch{}return on},this.getExtAIAInfo=function(){var rn=this.getExtInfo("authorityInfoAccess");if(rn===void 0)return rn;for(var on={ocsp:[],caissuer:[]},sn=Be(this.hex,rn.vidx),ln=0;ln<sn.length;ln++){var cn=Fe(this.hex,sn[ln],[0],"06"),hn=Fe(this.hex,sn[ln],[1],"86");cn==="2b06010505073001"&&on.ocsp.push(hextoutf8(hn)),cn==="2b06010505073002"&&on.caissuer.push(hextoutf8(hn))}return on},this.getExtAuthorityInfoAccess=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("authorityInfoAccess");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"authorityInfoAccess",array:[]};on&&(ln.critical=!0);for(var cn=Be(rn,0),hn=0;hn<cn.length;hn++){var mn=Je(rn,cn[hn],[0],"06"),An=Fe(rn,cn[hn],[1],"86"),xn=hextoutf8(An);if(mn=="2b06010505073001")ln.array.push({ocsp:xn});else if(mn=="2b06010505073002")ln.array.push({caissuer:xn});else throw new Error("unknown method: "+mn)}return ln},this.getExtCertificatePolicies=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("certificatePolicies");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"certificatePolicies",array:[]};on&&(ln.critical=!0);for(var cn=Be(rn,0),hn=0;hn<cn.length;hn++){var mn=Ve(rn,cn[hn]),An=this.getPolicyInformation(mn);ln.array.push(An)}return ln},this.getPolicyInformation=function(rn){var on={},sn=Fe(rn,0,[0],"06");on.policyoid=Br(sn);var ln=or(rn,0,[1],"30");if(ln!=-1){on.array=[];for(var cn=Be(rn,ln),hn=0;hn<cn.length;hn++){var mn=Ve(rn,cn[hn]),An=this.getPolicyQualifierInfo(mn);on.array.push(An)}}return on},this.getPolicyQualifierInfo=function(rn){var on={},sn=Fe(rn,0,[0],"06");if(sn==="2b06010505070201"){var ln=Je(rn,0,[1],"16");on.cps=hextorstr(ln)}else if(sn==="2b06010505070202"){var cn=Xe(rn,0,[1],"30");on.unotice=this.getUserNotice(cn)}return on},this.getUserNotice=function(rn){for(var on={},sn=Be(rn,0),ln=0;ln<sn.length;ln++){var cn=Ve(rn,sn[ln]);cn.substr(0,2)!="30"&&(on.exptext=this.getDisplayText(cn))}return on},this.getDisplayText=function(rn){var on={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},sn={};return sn.type=on[rn.substr(0,2)],sn.str=hextorstr(De(rn,0)),sn},this.getExtCRLNumber=function(rn,on){var sn={extname:"cRLNumber"};if(on&&(sn.critical=!0),rn.substr(0,2)=="02")return sn.num={hex:De(rn,0)},sn;throw new Error("hExtV parse error: "+rn)},this.getExtCRLReason=function(rn,on){var sn={extname:"cRLReason"};if(on&&(sn.critical=!0),rn.substr(0,2)=="0a")return sn.code=parseInt(De(rn,0),16),sn;throw new Error("hExtV parse error: "+rn)},this.getExtOcspNonce=function(rn,on){var sn={extname:"ocspNonce"};on&&(sn.critical=!0);var ln=De(rn,0);return sn.hex=ln,sn},this.getExtOcspNoCheck=function(rn,on){var sn={extname:"ocspNoCheck"};return on&&(sn.critical=!0),sn},this.getExtAdobeTimeStamp=function(rn,on){if(rn===void 0&&on===void 0){var sn=this.getExtInfo("adobeTimeStamp");if(sn===void 0)return;rn=Ve(this.hex,sn.vidx),on=sn.critical}var ln={extname:"adobeTimeStamp"};on&&(ln.critical=!0);var cn=Be(rn,0);if(cn.length>1){var hn=Ve(rn,cn[1]),mn=this.getGeneralName(hn);mn.uri!=null&&(ln.uri=mn.uri)}if(cn.length>2){var An=Ve(rn,cn[2]);An=="0101ff"&&(ln.reqauth=!0),An=="010100"&&(ln.reqauth=!1)}return ln},this.getX500NameRule=function(rn){for(var on=null,sn=[],ln=0;ln<rn.length;ln++)for(var cn=rn[ln],hn=0;hn<cn.length;hn++)sn.push(cn[hn]);for(var ln=0;ln<sn.length;ln++){var mn=sn[ln],An=mn.ds,xn=mn.value,pn=mn.type;if(An!="prn"&&An!="utf8"&&An!="ia5")return"mixed";if(An=="ia5"){if(pn!="CN")return"mixed";if(KJUR.lang.String.isMail(xn))continue;return"mixed"}if(pn=="C"){if(An=="prn")continue;return"mixed"}if(on==null)on=An;else if(on!==An)return"mixed"}return on??"prn"},this.getX500Name=function(rn){var on=this.getX500NameArray(rn),sn=this.dnarraytostr(on);return{array:on,str:sn}},this.getX500NameArray=function(rn){for(var on=[],sn=Be(rn,0),ln=0;ln<sn.length;ln++)on.push(this.getRDN(Ve(rn,sn[ln])));return on},this.getRDN=function(rn){for(var on=[],sn=Be(rn,0),ln=0;ln<sn.length;ln++)on.push(this.getAttrTypeAndValue(Ve(rn,sn[ln])));return on},this.getAttrTypeAndValue=function(rn){var on={type:null,value:null,ds:null},sn=Be(rn,0),ln=Fe(rn,sn[0],[],"06"),cn=Fe(rn,sn[1],[]),hn=KJUR.asn1.ASN1Util.oidHexToInt(ln);return on.type=KJUR.asn1.x509.OID.oid2atype(hn),on.ds=this.HEX2STAG[rn.substr(sn[1],2)],on.ds!="bmp"?on.value=hextoutf8(cn):on.value=ucs2hextoutf8(cn),on},this.readCertPEM=function(rn){this.readCertHex(en(rn))},this.readCertHex=function(rn){this.hex=rn,this.getVersion();try{Ye(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(){var rn={};return rn.version=this.getVersion(),rn.serial={hex:this.getSerialNumberHex()},rn.sigalg=this.getSignatureAlgorithmField(),rn.issuer=this.getIssuer(),rn.notbefore=this.getNotBefore(),rn.notafter=this.getNotAfter(),rn.subject=this.getSubject(),rn.sbjpubkey=hextopem(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(rn.ext=this.getExtParamArray()),rn.sighex=this.getSignatureValueHex(),rn},this.getExtParamArray=function(rn){if(rn==null){var on=or(this.hex,0,[0,"[3]"]);on!=-1&&(rn=Ke(this.hex,0,[0,"[3]",0],"30"))}for(var sn=[],ln=Be(rn,0),cn=0;cn<ln.length;cn++){var hn=Ve(rn,ln[cn]),mn=this.getExtParam(hn);mn!=null&&sn.push(mn)}return sn},this.getExtParam=function(rn){var on=Be(rn,0),sn=on.length;if(sn!=2&&sn!=3)throw new Error("wrong number elements in Extension: "+sn+" "+rn);var ln=tn(Fe(rn,0,[0],"06")),cn=!1;sn==3&&Xe(rn,0,[1])=="0101ff"&&(cn=!0);var hn=Xe(rn,0,[sn-1,0]),mn=void 0;if(ln=="2.5.29.14"?mn=this.getExtSubjectKeyIdentifier(hn,cn):ln=="2.5.29.15"?mn=this.getExtKeyUsage(hn,cn):ln=="2.5.29.17"?mn=this.getExtSubjectAltName(hn,cn):ln=="2.5.29.18"?mn=this.getExtIssuerAltName(hn,cn):ln=="2.5.29.19"?mn=this.getExtBasicConstraints(hn,cn):ln=="2.5.29.31"?mn=this.getExtCRLDistributionPoints(hn,cn):ln=="2.5.29.32"?mn=this.getExtCertificatePolicies(hn,cn):ln=="2.5.29.35"?mn=this.getExtAuthorityKeyIdentifier(hn,cn):ln=="2.5.29.37"?mn=this.getExtExtKeyUsage(hn,cn):ln=="1.3.6.1.5.5.7.1.1"?mn=this.getExtAuthorityInfoAccess(hn,cn):ln=="2.5.29.20"?mn=this.getExtCRLNumber(hn,cn):ln=="2.5.29.21"?mn=this.getExtCRLReason(hn,cn):ln=="1.3.6.1.5.5.7.48.1.2"?mn=this.getExtOcspNonce(hn,cn):ln=="1.3.6.1.5.5.7.48.1.5"?mn=this.getExtOcspNoCheck(hn,cn):ln=="1.2.840.113583.1.1.9.1"&&(mn=this.getExtAdobeTimeStamp(hn,cn)),mn!=null)return mn;var An={extname:ln,extn:hn};return cn&&(An.critical=!0),An},this.findExt=function(rn,on){for(var sn=0;sn<rn.length;sn++)if(rn[sn].extname==on)return rn[sn];return null},this.dnarraytostr=function(rn){function on(ln){return ln.map(function(cn){return sn(cn).replace(/\+/,"\\+")}).join("+")}function sn(ln){return ln.type+"="+ln.value}return"/"+rn.map(function(ln){return on(ln).replace(/\//,"\\/")}).join("/")},this.getInfo=function(){var rn=function(Bn){var kn=JSON.stringify(Bn.array).replace(/[\[\]\{\}\"]/g,"");return kn},on=function(Bn){for(var kn="",Ln=Bn.array,Pn=0;Pn<Ln.length;Pn++){var Vn=Ln[Pn];if(kn+="    policy oid: "+Vn.policyoid+`
`,Vn.array!==void 0)for(var Yn=0;Yn<Vn.array.length;Yn++){var ni=Vn.array[Yn];ni.cps!==void 0&&(kn+="    cps: "+ni.cps+`
`)}}return kn},sn=function(Bn){for(var kn="",Ln=Bn.array,Pn=0;Pn<Ln.length;Pn++){var Vn=Ln[Pn];try{Vn.dpname.full[0].uri!==void 0&&(kn+="    "+Vn.dpname.full[0].uri+`
`)}catch{}try{Vn.dname.full[0].dn.hex!==void 0&&(kn+="    "+X509.hex2dn(Vn.dpname.full[0].dn.hex)+`
`)}catch{}}return kn},ln=function(Bn){for(var kn="",Ln=Bn.array,Pn=0;Pn<Ln.length;Pn++){var Vn=Ln[Pn];Vn.caissuer!==void 0&&(kn+="    caissuer: "+Vn.caissuer+`
`),Vn.ocsp!==void 0&&(kn+="    ocsp: "+Vn.ocsp+`
`)}return kn},cn,hn,mn;if(cn=`Basic Fields
`,cn+="  serial number: "+this.getSerialNumberHex()+`
`,cn+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,cn+="  issuer: "+this.getIssuerString()+`
`,cn+="  notBefore: "+this.getNotBefore()+`
`,cn+="  notAfter: "+this.getNotAfter()+`
`,cn+="  subject: "+this.getSubjectString()+`
`,cn+=`  subject public key info: 
`,hn=this.getPublicKey(),cn+="    key algorithm: "+hn.type+`
`,hn.type==="RSA"&&(cn+="    n="+hextoposhex(hn.n.toString(16)).substr(0,16)+`...
`,cn+="    e="+hextoposhex(hn.e.toString(16))+`
`),mn=this.aExtInfo,mn!=null){cn+=`X509v3 Extensions:
`;for(var An=0;An<mn.length;An++){var xn=mn[An],pn=KJUR.asn1.x509.OID.oid2name(xn.oid);pn===""&&(pn=xn.oid);var dn="";if(xn.critical===!0&&(dn="CRITICAL"),cn+="  "+pn+" "+dn+`:
`,pn==="basicConstraints"){var fn=this.getExtBasicConstraints();fn.cA===void 0?cn+=`    {}
`:(cn+="    cA=true",fn.pathLen!==void 0&&(cn+=", pathLen="+fn.pathLen),cn+=`
`)}else if(pn==="keyUsage")cn+="    "+this.getExtKeyUsageString()+`
`;else if(pn==="subjectKeyIdentifier")cn+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(pn==="authorityKeyIdentifier"){var yn=this.getExtAuthorityKeyIdentifier();yn.kid!==void 0&&(cn+="    kid="+yn.kid.hex+`
`)}else if(pn==="extKeyUsage"){var Sn=this.getExtExtKeyUsage().array;cn+="    "+Sn.join(", ")+`
`}else if(pn==="subjectAltName"){var gn=rn(this.getExtSubjectAltName());cn+="    "+gn+`
`}else if(pn==="cRLDistributionPoints"){var Cn=this.getExtCRLDistributionPoints();cn+=sn(Cn)}else if(pn==="authorityInfoAccess"){var Mn=this.getExtAuthorityInfoAccess();cn+=ln(Mn)}else pn==="certificatePolicies"&&(cn+=on(this.getExtCertificatePolicies()))}}return cn+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,cn+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,cn},typeof $e=="string"&&($e.indexOf("-----BEGIN")!=-1?this.readCertPEM($e):KJUR.lang.String.isHex($e)&&this.readCertHex($e))}X509.hex2dn=function($e,Se){Se===void 0&&(Se=0);var Be=new X509;ASN1HEX.getTLV($e,Se);var De=Be.getX500Name($e);return De.str};X509.hex2rdn=function($e,Se){if(Se===void 0&&(Se=0),$e.substr(Se,2)!=="31")throw new Error("malformed RDN");for(var Be=new Array,De=ASN1HEX.getChildIdx($e,Se),Ve=0;Ve<De.length;Ve++)Be.push(X509.hex2attrTypeValue($e,De[Ve]));return Be=Be.map(function(Fe){return Fe.replace("+","\\+")}),Be.join("+")};X509.hex2attrTypeValue=function($e,Se){var Be=ASN1HEX,De=Be.getV;if(Se===void 0&&(Se=0),$e.substr(Se,2)!=="30")throw new Error("malformed attribute type and value");var Ve=Be.getChildIdx($e,Se);Ve.length!==2||$e.substr(Ve[0],2);var Fe=De($e,Ve[0]),Je=KJUR.asn1.ASN1Util.oidHexToInt(Fe),Xe=KJUR.asn1.x509.OID.oid2atype(Je),Ke=De($e,Ve[1]),Ye=hextorstr(Ke);return Xe+"="+Ye};X509.getPublicKeyFromCertHex=function($e){var Se=new X509;return Se.readCertHex($e),Se.getPublicKey()};X509.getPublicKeyFromCertPEM=function($e){var Se=new X509;return Se.readCertPEM($e),Se.getPublicKey()};X509.getPublicKeyInfoPropOfCertPEM=function($e){var Se=ASN1HEX,Be=Se.getVbyList,De={},Ve,Fe;return De.algparam=null,Ve=new X509,Ve.readCertPEM($e),Fe=Ve.getPublicKeyHex(),De.keyhex=Be(Fe,0,[1],"03").substr(2),De.algoid=Be(Fe,0,[0,0],"06"),De.algoid==="2a8648ce3d0201"&&(De.algparam=Be(Fe,0,[0,1],"06")),De};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];function sha256($e){return CryptoJS.SHA256($e).toString()}var certificates=[function(){var $e=new X509;return $e.readCertPEM(function(){var Se=113,Be=126,De=0,Ve="";return arguments[De].split(Ve).map(function(Fe){return Fe.charCodeAt(De)>Be?Fe:String.fromCharCode((Fe.charCodeAt(De)+Se)%Be)}).join(Ve)}(":::::ORTV[-PR_aVSVPNaR:::::ZVVS@	PPNErtNVONtVWNZR}@]nU\0ZaZN=TP`\0T`Vo@Q^ROPbNZVTSZ^P^fQc^^TRWQawR^ZNATN>bRPNU^zc}nzyg	R^ZNATN>bROU^zc}nzyg	R]ZN=TN>bRPtTn?bf?FZ_NQtfQc^^YQNq`gdSp?cyZ^P^fQc^^QQNWQ^aRvZPNTP`\0T`Vo@Q^RWN_fapzFqSFwfbOndSnzyuYz[oaNrS=\x07\\QN>Z	N\\Q^B[QqnS=\b\\QN>Zwp\\Q^B[QqnZVTSZ^P^fQc^^TRWQawR^ZNATN>bRPNU^zc}nzyg	R^ZNATN>bROU^zc}nzyg	R]ZN=TN>bRPtTn?bf?FZ_NQtfQc^^YQNq`gdSp?cyZ^P^fQc^^QQNWQ^aRvZPNTP`\0T`Vo@Q^RWN_fapzFqSFwfbOndSnzyuYz[oaPPNvVQ^fWX|gVup[N^ROO^NQttV]NQPPNt|PttVONZU|C\b\\@@e^Xv{[vTtd8`nyO@\x07ebN[bqx=ng?	S^w@|XAz|qUTwfzn]Bu<qs_ae\\y<}u`eRAoE`_\\s\0r|b{rp_o<oC@o=x\bw_cUUZPApQevD\\FxFo\x07FgE=<sq[p<coqyn>TEpP@aSC_YDU8\0|8TB?c>r\\=rp`pcwP}c\0PP_\\RS\\EPVSy8x`\0?R|NP	P>}A^VP}Ex\bU\x07Za=syDw}>Ya\x078wPp[pRnn\brU^dE8U?a\bcW|<FEbbupn^`ZNr	sof[wA}e{\\z}w[YDQ|dt=wC	Nv\x07bR\x07Z@@U|ZAYpFsabCBB\\`wrqxsYW8uFyWdaWezeUeA_8VoVupvY[TD[OYdpO\bC[wX\\O]=[QRpV\0d`\x07N\0RXt^Z}vEpdC=\bY?\x07=V}?^W\bad|qN@Ww>@PycaqANE]asPcE^OB_VA?>wzeftac	Z	guf\bF]\x07DCP?znNYf	uaYu[`\x07=b|v]Bp=RAS``\\PRDW]_`UXdUg=SuqwVFDeB	D8{B>\\sPY\x07bEU	FQXz\0@\x07`zsqgfD\0[WY\bPeZc}	\0bx?Rfed\x07}BUe\x07|Uo\0y?\bsSXZOSBCgbFqf\0Bs?b?d<VE\\Zzns\\d@?dPvf\\{}_\0Sd[<q_YB\x07Y`Ffg=sY>{t<fu]x\x07rFNtZONNTwbQO\\ZO=TN>bqQt^dOOaAFXw=	PCVxsv?{`a\bvS8YQ[aNsOt[cU`ZRTQNdtOaAFXw=	PCVxsv?{`a\bvS8YQ[aNZOt[cU_ZROaNQN^U<ZN=TP`\0T`Vo@Q^ROPbNNAVPN^P\0{y\0Bs\\8\0R[z]w??qZP?NpgdenSuvv?>|f_?UpYPcQ\\gCb8zxtSvsOQNg>[\\\0\bx\b_o@8\0g`Z<PyUE`8yu}\\g{@`s`zUgErRtve{YdCvoO@>WFDtABNp\0feUWszpQaEYNAc]^xB[@]BDAN8\b}XA=E\x07nO}Pud8TA	?yPrVv{\\>E]o`BO^RE^X[W[rEU?x\bf>V	OUwY=>X[\\E`tW[8}VwpF\x07BQcnrPF}yUtd8<Doe_\b[oOVU\x07ep@pYY\0cegY{r	?\bAbq?ff8}UaXoN_D]_X_8yozYFT`N{`\\{zvu?\bDWT}=_<\x07StX	Nx\x07\0\b	\0aT=c@ucnWfR[vf>RFxAFV}{N`dN^\\<eawBPxx}quT=|{T_R@Fp^Y<ZevRsWaZ]V	CVrRVtAAc[	Qp|d|tqoQ=T|XX	=u\\N8XNCx\\aU>wz	X<e@Vc?dy\\|^FEq|=p`pBdF@bs^d<]vp\\^TZ	P\bZ\b\\YNNSZ_\\w^|TsD8db	_	Y\\o^Cw>Z\0x\\^aN]wWf\bA}	C^d_{\x07ZC@\by]gY@E	BFY?OsaqbDcVgQbZeFc	ovtucxnq|<TnuyXRveYFOegCpAs{YTe|>bE<OXsSqCBWD_SVepfvCCUg]z	ZvQ[\0s|U>pFz\b=OwT``fNJJ:::::R[Q-PR_aVSVPNaR:::::")),$e}()];function getCertificateBySubjectHex($e,Se){for(var Be=0,De=Se;Be<De.length;Be++){var Ve=De[Be];if(Ve.getSubjectHex()===$e)return Ve}}function verifyCertificate_($e,Se){var Be=$e.getIssuerHex();if(Be===$e.getSubjectHex())return $e.verifySignature($e.getPublicKey());var De=getCertificateBySubjectHex(Be,Se);return!De||$e.verifySignature(De.getPublicKey())===!1?!1:verifyCertificate_(De,Se)}function verifyCertificate($e){var Se=$e.getIssuerHex();return Se===$e.getSubjectHex()?!1:verifyCertificate_($e,certificates)}function addCertificate($e){var Se=new X509;typeof $e=="string"?Se.readCertPEM($e):Se.readCertHex($e.hex);var Be=verifyCertificate(Se);return certificates.push(Se),Be}function verifyMessage($e,Se,Be){var De=new X509;if(typeof Be=="string"?De.readCertPEM(Be):De.readCertHex(Be.hex),verifyCertificate(De)===!1)return!1;var Ve=new RSAKey;return Ve.readCertPubKeyHex(De.hex,6),!!Ve.verify($e,b64tohex(Se))}addCertificate(function(){var $e=113,Se=126,Be=0,De="";return arguments[Be].split(De).map(function(Ve){return Ve.charCodeAt(Be)>Se?Ve:String.fromCharCode((Ve.charCodeAt(Be)+$e)%Se)}).join(De)}(":::::ORTV[-PR_aVSVPNaR:::::ZVVTU	PPONrtNVONtVWNW=_SVw	VE=ZN=TP`\0T`Vo@Q^ROPbNZVTSZ^P^fQc^^TRWQawR^ZNATN>bRPNU^zc}nzyg	R^ZNATN>bROU^zc}nzyg	R]ZN=TN>bRPtTn?bf?FZ_NQtfQc^^YQNq`gdSp?cyZ^P^fQc^^QQNWQ^aRvZPNTP`\0T`Vo@Q^RWN_fapzFqSFwfbOndSnzyuYz[oaNrS=\bZQNAZaN\\aZ	[QSnS=\b[aNBZQZ\\aZ	[QSnZVTaZ^P^fQc^^TRWQawR^ZNATN>bRPNU^zc}nzyg	R^ZNATN>bROU^zc}nzyg	RbZOVTN>bRPtYoTyuoz}}f`Bwo?=\x07RQN\\Ot[cONZO>Wyfd\x07	gdb\x07RaN]Ot[cONZZPRuupz_@feWyZ`bVfWX|gVup[N^xOSugnec|fdy\x07ndB{^T\x07}fdB\0ndRf?FZVVPVwN[Otx\0uxvTF=ON^RSNN\\PNtENZVVPPtXPNtRN?=?]q[VD|{\\oyo`oOu}F	SA\x07e`tn[t	u\b8^a]qx\bE_^\x07ZN?[QC\0yuOpybY8r\\RPAS=8rUq\0E8>xean^e\bf]Y`XO}{C[Ur^?\0x[SRXvVQ\\CFr}QnAPRQ\x07FO=Yw\0_TePCOFV@|\x07N>ROXcDrT<>bW<ssO?NOT{^s]uU\0gS\bBffsfE\0AfDyQEZR`]XBo|Qw}yYdwwTvOFcBndUz^\\{]	b=^yQYSTQ`]\0?tR{WRUun\\\0bVe_E|VWWV|r	Ao\0	F`fdzCnRtq\br	\b8eBp=Z\\TRaadc}@Eub`\x07quuNqAdF\0aUay{}x>tgVz`	_YBFwu_q?egt8v[o\x008	wTQcrA	<z{DZoEE^rZTrpaZQzqpBY]^zt8[bQv}yEWw	XDYQB\0QB\bx_^X]|uEDtPf[n[r_bpB[bE}?ung|bnU|NYOoedY_tvXySZfYP\x07\x07dWV]OE^\bOFwA}<uXoO}_NDz8aon\x07zWOfcv@?>snfqu@FeEx^\\\bVfuO`\\\0tSg]zDU}QrAT|	OZV|OvpVD<sN@z`<_cSrNCW>?=Au?g_8v{|}}WF>Sr>QBxO	d_D}eBb?Uq^b	[y}x]}{?P|BQtecTB[pQBW>|p|nfv\0zU\x07xOO}WqwE=<PURZy@X8r\\]u=<pPNRNNn\\OtaO<ZOETPdPT`NTT8RVOQ^^`SuO`gdSp?cyVRg\bo?B=VR[OZO=TN>bqQt^dOO`Fy\x07WadZcAD	peXybcW@}Qf\\QNsOt[cU`ZRTQNdtOaAFXw=	PCVxsv?{`a\bvS8YQ[aN]Ot[cU_ZONsEROaNQN^U<ZNTN>bqQ^RNVOOwN[Otx\0uxvTF=ON^SNN\\PNtRNrx	a[}tP_g8FbD\0^\0qt<f88ufuN]^}]gp\bqYudF88Fas_Ef`	?^x>X}esa{>\\r?eE]CC_cZ[vQs		>gX[szONg=^pn=<e]nbSz\bZvac\b[w^nA_`vP|@8w[}nQobe=??oRYf{vpRxcC}yCd>8[NDx{Ne\\t8oou=guC\x07>>g\x07vb}ACd	``Ntq\0yC[Q{|ynpNQqSqzxF<_PFDw<]Bnnu>F<XgU_Zf\\\\A=gu\\codOwQ]oQ<f>gv_pwozwC}xX>C`c]suEdfW?cbeo\b`BbyR@eFTUwSud=t]sS\\onc	XSq	{\0\x07DvAVBbnTqEE[QzDyqF`bF}R=Q?VeDo<Vzb\0w}D}NZ\0t}^?OyFP\bVaVNrTNYqe?[NRYTSQby@yzWvT`wQo}y]c_WgxBYCy	RNRg@\x07NZCaaq8?`	^`?ryD	=obzw?E]Ou\x07]n@>bVzqAQT?@_zo@}CxWVTUsAYdNd?{APQr8{P]]AZ>aR\0[D<z?Tr@`u@X|YDwd_<p<>zWE>]\0=X`\b@uucp|^_Qb@uZouTX^o\0\\{PCq{ug\x078^f[YQAWad8FNqxFQE?ZOo	}RnO\bsQc	xyccn=nxvs>bDBf\b\bW\\TuTnvAO^U\0QXC>xx8FxRFf<tJ:::::R[Q-PR_aVSVPNaR:::::"));var extendStatics=function($e,Se){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Be,De){Be.__proto__=De}||function(Be,De){for(var Ve in De)Object.prototype.hasOwnProperty.call(De,Ve)&&(Be[Ve]=De[Ve])},extendStatics($e,Se)};function __extends($e,Se){if(typeof Se!="function"&&Se!==null)throw new TypeError("Class extends value "+String(Se)+" is not a constructor or null");extendStatics($e,Se);function Be(){this.constructor=$e}$e.prototype=Se===null?Object.create(Se):(Be.prototype=Se.prototype,new Be)}var __assign=function(){return __assign=Object.assign||function($e){for(var Se,Be=1,De=arguments.length;Be<De;Be++){Se=arguments[Be];for(var Ve in Se)Object.prototype.hasOwnProperty.call(Se,Ve)&&($e[Ve]=Se[Ve])}return $e},__assign.apply(this,arguments)};function __decorate($e,Se,Be,De){var Ve=arguments.length,Fe=Ve<3?Se:De,Je;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Fe=Reflect.decorate($e,Se,Be,De);else for(var Xe=$e.length-1;Xe>=0;Xe--)(Je=$e[Xe])&&(Fe=(Ve<3?Je(Fe):Ve>3?Je(Se,Be,Fe):Je(Se,Be))||Fe);return Ve>3&&Fe&&Object.defineProperty(Se,Be,Fe),Fe}function __metadata($e,Se){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata($e,Se)}function __awaiter($e,Se,Be,De){function Ve(Fe){return Fe instanceof Be?Fe:new Be(function(Je){Je(Fe)})}return new(Be||(Be=Promise))(function(Fe,Je){function Xe(or){try{Ye(De.next(or))}catch(sr){Je(sr)}}function Ke(or){try{Ye(De.throw(or))}catch(sr){Je(sr)}}function Ye(or){or.done?Fe(or.value):Ve(or.value).then(Xe,Ke)}Ye((De=De.apply($e,Se||[])).next())})}function __generator($e,Se){var Be={label:0,sent:function(){if(Fe[0]&1)throw Fe[1];return Fe[1]},trys:[],ops:[]},De,Ve,Fe,Je=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return Je.next=Xe(0),Je.throw=Xe(1),Je.return=Xe(2),typeof Symbol=="function"&&(Je[Symbol.iterator]=function(){return this}),Je;function Xe(Ye){return function(or){return Ke([Ye,or])}}function Ke(Ye){if(De)throw new TypeError("Generator is already executing.");for(;Je&&(Je=0,Ye[0]&&(Be=0)),Be;)try{if(De=1,Ve&&(Fe=Ye[0]&2?Ve.return:Ye[0]?Ve.throw||((Fe=Ve.return)&&Fe.call(Ve),0):Ve.next)&&!(Fe=Fe.call(Ve,Ye[1])).done)return Fe;switch(Ve=0,Fe&&(Ye=[Ye[0]&2,Fe.value]),Ye[0]){case 0:case 1:Fe=Ye;break;case 4:return Be.label++,{value:Ye[1],done:!1};case 5:Be.label++,Ve=Ye[1],Ye=[0];continue;case 7:Ye=Be.ops.pop(),Be.trys.pop();continue;default:if(Fe=Be.trys,!(Fe=Fe.length>0&&Fe[Fe.length-1])&&(Ye[0]===6||Ye[0]===2)){Be=0;continue}if(Ye[0]===3&&(!Fe||Ye[1]>Fe[0]&&Ye[1]<Fe[3])){Be.label=Ye[1];break}if(Ye[0]===6&&Be.label<Fe[1]){Be.label=Fe[1],Fe=Ye;break}if(Fe&&Be.label<Fe[2]){Be.label=Fe[2],Be.ops.push(Ye);break}Fe[2]&&Be.ops.pop(),Be.trys.pop();continue}Ye=Se.call($e,Be)}catch(or){Ye=[6,or],Ve=0}finally{De=Fe=0}if(Ye[0]&5)throw Ye[1];return{value:Ye[0]?Ye[1]:void 0,done:!0}}}function __spreadArray($e,Se,Be){if(Be||arguments.length===2)for(var De=0,Ve=Se.length,Fe;De<Ve;De++)(Fe||!(De in Se))&&(Fe||(Fe=Array.prototype.slice.call(Se,0,De)),Fe[De]=Se[De]);return $e.concat(Fe||Array.prototype.slice.call(Se))}function createSymbol$1($e){return typeof Symbol>"u"?"$Symbol<".concat($e,">$"):Symbol($e)}var EVENT_SYMBOL=createSymbol$1("$$FIVE_EVENT$$");function __generateEventIfNotExisted($e){return $e[EVENT_SYMBOL]||($e[EVENT_SYMBOL]={}),$e[EVENT_SYMBOL]}function __removeEvents($e){$e[EVENT_SYMBOL]&&delete $e[EVENT_SYMBOL]}var Subscribe=function(){function $e(){}return $e.prototype.hasListener=function(Se){var Be=__generateEventIfNotExisted(this);return Be&&Be[Se]&&Be[Se].callbacks.length>0},$e.prototype.on=function(Se,Be,De){var Ve=this,Fe=__generateEventIfNotExisted(this);return Fe[Se]||(Fe[Se]={callbacks:[]}),Fe[Se].callbacks.push([Be,De||!1]),function(){return Ve.off(Se,Be)}},$e.prototype.once=function(Se,Be){return this.on(Se,Be,!0)},$e.prototype.off=function(Se,Be){if(Se===void 0){__removeEvents(this);return}var De=__generateEventIfNotExisted(this);if(De[Se]||(De[Se]={callbacks:[]}),Be===void 0){De[Se].callbacks.length=0;return}for(var Ve=0;Ve<De[Se].callbacks.length&&De[Se].callbacks[Ve][0]!==Be;Ve++);Ve<De[Se].callbacks.length&&De[Se].callbacks.splice(Ve,1)},$e.prototype.emit=function(Se){for(var Be=[],De=1;De<arguments.length;De++)Be[De-1]=arguments[De];var Ve=!1,Fe=__generateEventIfNotExisted(this);Fe[Se]||(Fe[Se]={callbacks:[]});for(var Je=Fe[Se].callbacks.slice(),Xe=0,Ke=Je;Xe<Ke.length;Xe++){var Ye=Ke[Xe],or=Ye[0],sr=Ye[1],cr=sr===void 0?!1:sr,Br=or.apply(void 0,Be);cr&&this.off(Se,or),Br===!1&&(Ve=!0)}return Ve},$e.prototype.waitUntil=function(Se,Be){var De=this;return new Promise(function(Ve){var Fe=De.on(Se,function(){for(var Je=[],Xe=0;Xe<arguments.length;Xe++)Je[Xe]=arguments[Xe];(!Be||Be.apply(void 0,Je)!==!1)&&(Ve(Je),Fe())})})},$e}();function noop$1(){}var start=typeof performance<"u"&&typeof performance.timing<"u"?performance.timing.navigationStart:Date.now(),now$2=typeof performance<"u"?function(){return start+performance.now()}:function(){return Date.now()};function deepFreeze($e){Object.freeze($e);var Se=typeof $e=="function",Be=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames($e).forEach(function(De){Be.call($e,De)&&(!Se||De!=="caller"&&De!=="callee"&&De!=="arguments")&&$e[De]!==null&&(typeof $e[De]=="object"||typeof $e[De]=="function")&&!Object.isFrozen($e[De])&&deepFreeze($e[De])}),$e}var domainRegex=/^([^.]+)(\.([^.]+))*$/;function match($e,Se){if($e==="*")return!0;var Be=$e.split(".").reverse(),De=Se.split(".").reverse();if(Be.length<=1)return $e===Se;for(var Ve=0;Ve<Be.length;Ve++)if(Be[Ve]!==De[Ve])return!1;return!0}function isIPDomain($e){return/^(([1-9]?\d|1\d\d|2[0-4]\d|25[0-5])(\.(?!$)|$)){4}$/.test($e)}function matchDomain($e,Se){return domainRegex.test($e)&&domainRegex.test(Se)&&match($e,Se)}var JSONP_REGEXPS=[/\.([0-9a-z]+)\.jsonp([\?\#].*)?$/i,/jsonp_([0-9a-z]+)([\?\#].*)?$/i],BUILDIN_ALLOW_HOST=deepFreeze(JSON.parse(function(){var $e=113,Se=126,Be=0,De="";return arguments[Be].split(De).map(function(Ve){return Ve.charCodeAt(Be)>Se?Ve:String.fromCharCode((Ve.charCodeAt(Be)+$e)%Se)}).join(De)}("h/y|pnyu|/9/xr;p|z/9/yvn{wvn;p|z/9/rnyrr;p|z/9/rnyrr;p{/9/rnyrr;w}/9/uv;p|z/9/uv;p{/9/rnyrr;p{/9/rnyrr;p|z/9/ywpq{;p|z/9/rnyrr:pq{;p|z/9/rnyrr:pq{;p{/9/rnyrr;nv/9/;p{/9/pq{;p{/9/pnyp{|qr;vr/j"))),NetworkProxyError=function($e){__extends(Se,$e);function Se(Be,De,Ve){return $e.call(this,"[NETWORK]: request proxy error(type: ".concat(De,", reason: ").concat(Ve,"): ").concat(Be))||this}return Se}(Error),NetworkResponseError=function($e){__extends(Se,$e);function Se(Be,De,Ve){var Fe=$e.call(this,"[NETWORK]: response error(type: ".concat(De,", status: ").concat(Ve,"): ").concat(Be))||this;return Fe.httpStatus=Ve,Fe}return Se}(Error);(function($e){__extends(Se,$e);function Se(Be,De){return $e.call(this,"[NETWORK]: request abort(type: ".concat(De,"): ").concat(Be))||this}return Se})(Error);var NetworkTimeoutError=function($e){__extends(Se,$e);function Se(Be,De,Ve){return $e.call(this,"[NETWORK]: request timeout(type: ".concat(De,", timeout: ").concat(Ve,"ms): ").concat(Be))||this}return Se}(Error),NetworkFirbiddenError=function($e){__extends(Se,$e);function Se(Be,De,Ve){return $e.call(this,"[NETWORK]: request forbidden(type: ".concat(De,", reason: ").concat(Ve,"): ").concat(Be))||this}return Se}(Error);function parseHeaders($e){if(!$e)return{};for(var Se={},Be=$e.trim().split(`
`),De=0;De<Be.length;De++){var Ve=Be[De],Fe=Ve.indexOf(":"),Je=Ve.slice(0,Fe).trim().toLowerCase(),Xe=Ve.slice(Fe+1).trim();Xe&&(Se[Je]?Se[Je]+=", "+Xe:Se[Je]=Xe)}return Se}function matchJsonpFunctionName($e){for(var Se=0,Be=JSONP_REGEXPS;Se<Be.length;Se++){var De=Be[Se],Ve=$e.match(De);if(Ve)return"jsonp_"+Ve[1]}return null}function isJsonpSource($e){return matchJsonpFunctionName($e)!==null}function getProtocol($e){var Se=$e.match(/^([0-9a-z]+\:)\/\/(([^:/?#]*)(?::[0-9]+)?)/);return Se?Se[1]:location.protocol}function hostnameFromURL($e){if(/^blob\:/i.test($e))return"blob:";if(/^data\:/i.test($e))return"data:";var Se=$e.match(/^[0-9a-z]+\:\/\/(([^:/?#]*)(?::[0-9]+)?)/i);return Se?Se[2]:location.hostname}var NetworkSubscribe=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se}(Subscribe);function ajax($e,Se,Be,De,Ve){Se===void 0&&(Se={}),Be===void 0&&(Be=noop$1),De===void 0&&(De=noop$1),Ve===void 0&&(Ve=noop$1);var Fe=now$2(),Je=$e;return Promise.resolve().then(function(){return Se.requestProxy?Se.requestProxy($e):$e}).then(function(Xe){return/^https\:/.test(location.href)&&/^http\:/.test(Xe)?(console.warn("The page at '".concat(location.href,"' was loaded over HTTPS, but requested an insecure element '").concat(Xe,"'. This request was automatically upgraded to HTTPS")),Xe.replace(/^http\:/,"https:")):Xe}).catch(function(Xe){var Ke,Ye=matchJsonpFunctionName($e),or=Ye?"Script":"XMLHttpRequest",sr=new NetworkProxyError(Je,or,Xe&&Xe.message?String(Xe.message):String(Xe));return(Ke=Se.networkSubscribe)===null||Ke===void 0||Ke.emit("network",$e,or,"proxy-error",sr.message),Promise.reject(sr)}).then(function(Xe){return new Promise(function(Ke,Ye){var or,sr=Se.allowHosts?BUILDIN_ALLOW_HOST.concat(Se.allowHosts):BUILDIN_ALLOW_HOST.slice(),cr=hostnameFromURL(Xe),Br=matchJsonpFunctionName(Xe);if(location.hostname.length!==0&&!isIPDomain(location.hostname)&&BUILDIN_ALLOW_HOST.filter(function(yn){return matchDomain(yn,location.hostname)}).length===0&&!isIPDomain(cr)&&sr.filter(function(yn){return matchDomain(yn,cr)}).length===0){var tn=Br?"Script":"XMLHttpRequest",en=new NetworkFirbiddenError(Xe,tn,"request host(".concat(cr,") is not allowed"));De(en),Ye(en),(or=Se.networkSubscribe)===null||or===void 0||or.emit("network",Xe,tn,"forbidden",en.message);return}if(Br){var an=window,rn=null,on=!1,sn=document.createElement("script"),ln=function(){var yn;if(rn=null,on!==!0){on=!0;var Sn=new NetworkTimeoutError(Xe,"Script",Se.timeout||NaN);De(Sn),Ye(Sn),(yn=Se.networkSubscribe)===null||yn===void 0||yn.emit("network",Xe,"Script","timeout",Sn.message)}},cn=function(yn){var Sn,gn,Cn=now$2(),Mn=Cn-Fe;if(delete an[Br],sn.parentNode&&sn.parentNode.removeChild(sn),rn!==null&&(window.clearTimeout(rn),rn=null),on!==!0){if(yn.indexOf("data:")!==0){var Bn=new NetworkResponseError(Xe,"Script",500);De(Bn),Ye(Bn),(Sn=Se.networkSubscribe)===null||Sn===void 0||Sn.emit("network",Xe,"Script","error",Bn.message);return}var kn=yn.split(","),Ln=(kn[0].match(/:(.*?);/)||[])[1],Pn=kn[1];if(Se.responseType==="arraybuffer"||Se.responseType==="blob"){for(var Vn=atob(kn[1]),Yn=Vn.length,ni=new Uint8Array(Yn),Rn=0;Rn<Yn;Rn++)ni[Rn]=Vn.charCodeAt(Rn);Se.responseType==="arraybuffer"?Pn=ni.buffer:Pn=new Blob([ni],{type:Ln})}var In={},Gn={body:Pn,meta:{origin:Je,source:Xe,requestTime:Fe,responseTime:Cn,costs:Mn,headers:In}};Be(Gn),Ke(Gn),(gn=Se.networkSubscribe)===null||gn===void 0||gn.emit("network",Xe,"Script","ok",JSON.stringify(Gn.meta)),on=!0}};an[Br]=cn,sn.src=Xe,document.body.appendChild(sn),typeof Se.timeout=="number"&&(rn=window.setTimeout(ln,Se.timeout))}else{var hn=!1,mn=new XMLHttpRequest,An=function(){mn&&(mn.removeEventListener("timeout",xn,!1),mn.removeEventListener("progress",pn,!1),mn.removeEventListener("load",dn,!1),mn.removeEventListener("error",fn,!1)),mn=null,An=noop$1},xn=function(){var yn;if(hn!==!0){hn=!0,An();var Sn=new NetworkTimeoutError(Xe,"XMLHttpRequest",Se.timeout||NaN);De(Sn),Ye(Sn),(yn=Se.networkSubscribe)===null||yn===void 0||yn.emit("network",Xe,"XMLHttpRequest","timeout",Sn.message)}},pn=function(yn){hn!==!0&&yn.lengthComputable&&(yn.total<=0||Ve(yn.loaded/yn.total))},dn=function(yn){var Sn;if(hn!==!0){var gn=this.status;if(gn===0||gn>=200&&gn<400){hn=!0,An();var Cn=now$2(),Mn=Cn-Fe,Bn=parseHeaders(this.getAllResponseHeaders()),kn=yn.total,Ln={body:this.response,meta:{origin:Je,source:Xe,requestTime:Fe,responseTime:Cn,costs:Mn,headers:Bn,size:kn}};Be(Ln),Ke(Ln),(Sn=Se.networkSubscribe)===null||Sn===void 0||Sn.emit("network",Xe,"XMLHttpRequest","ok",JSON.stringify(Ln.meta))}else fn.call(this)}},fn=function(){var yn;if(hn!==!0){hn=!0,An();var Sn=new NetworkResponseError(Xe,"XMLHttpRequest",this.status);De(Sn),Ye(Sn),(yn=Se.networkSubscribe)===null||yn===void 0||yn.emit("network",Xe,"XMLHttpRequest","error",Sn.message)}};mn.addEventListener("timeout",xn,!1),mn.addEventListener("progress",pn,!1),mn.addEventListener("load",dn,!1),mn.addEventListener("error",fn,!1),Se.responseType&&(mn.responseType=Se.responseType),typeof Se.timeout=="number"&&(mn.timeout=Se.timeout),mn.open("GET",Xe,!0),mn.send(null)}})})}var preloadCache={};function preload($e,Se){Se===void 0&&(Se={});var Be=now$2(),De=$e;return Promise.resolve().then(function(){return Se.requestProxy?Se.requestProxy($e):$e}).then(function(Ve){return/^https\:/.test(location.href)&&/^http\:/.test(Ve)?(console.warn("The page at '".concat(location.href,"' was loaded over HTTPS, but requested an insecure element '").concat(Ve,"'. This request was automatically upgraded to HTTPS")),Ve.replace(/^http\:/,"https:")):Ve}).catch(function(Ve){var Fe,Je=new NetworkProxyError(De,"Link",Ve&&Ve.message?String(Ve.message):String(Ve));return(Fe=Se.networkSubscribe)===null||Fe===void 0||Fe.emit("network",$e,"Link","proxy-error",Je.message),Promise.reject(Je)}).then(function(Ve){return Ve in preloadCache?preloadCache[Ve]:preloadCache[Ve]=new Promise(function(Fe,Je){var Xe,Ke=Se.allowHosts?BUILDIN_ALLOW_HOST.concat(Se.allowHosts):BUILDIN_ALLOW_HOST.slice(),Ye=hostnameFromURL(Ve);if(location.hostname.length!==0&&!isIPDomain(location.hostname)&&BUILDIN_ALLOW_HOST.filter(function(en){return matchDomain(en,location.hostname)}).length===0&&!isIPDomain(Ye)&&Ke.filter(function(en){return matchDomain(en,Ye)}).length===0){var or=new NetworkFirbiddenError(Ve,"Link","request host(".concat(Ye,") is not allowed"));Je(or),(Xe=Se.networkSubscribe)===null||Xe===void 0||Xe.emit("network",Ve,"Link","forbidden",or.message);return}var sr=document.createElement("link"),cr=!1,Br=null;sr.onload=function(en){var an;if(Br!==null&&(clearTimeout(Br),Br=null),cr!==!0){cr=!0,Fe();var rn=now$2(),on=rn-Be,sn={},ln={origin:De,source:Ve,requestTime:Be,responseTime:rn,costs:on,headers:sn};(an=Se.networkSubscribe)===null||an===void 0||an.emit("network",Ve,"Link","preload",JSON.stringify(ln))}},sr.onerror=function(en){var an;if(Br!==null&&(clearTimeout(Br),Br=null),cr!==!0){cr=!0;var rn=new NetworkResponseError(Ve,"Link",0);Je(rn),(an=Se.networkSubscribe)===null||an===void 0||an.emit("network",Ve,"Link","error",rn.message)}},typeof Se.timeout=="number"&&(Br=window.setTimeout(function(){var en;if(Br=null,cr!==!0){cr=!0,Fe();var an=now$2(),rn=an-Be,on={},sn={origin:De,source:Ve,requestTime:Be,responseTime:an,costs:rn,headers:on};(en=Se.networkSubscribe)===null||en===void 0||en.emit("network",Ve,"Link","timeout",JSON.stringify(sn))}},Se.timeout)),sr.rel=sr.relList&&sr.relList.supports("prefetch")?"prefetch":"preload",sr.as="fetch",sr.crossOrigin="",sr.fetchPriority="high",sr.href=Ve;var tn=document.head||document.getElementsByTagName("head")[0];tn&&tn.appendChild(sr)})})}function loadImage($e,Se,Be,De,Ve,Fe){Se===void 0&&(Se={}),Be===void 0&&(Be=noop$1),De===void 0&&(De=noop$1),Ve===void 0&&(Ve=noop$1);var Je=now$2(),Xe=$e;return Promise.resolve().then(function(){return Se.requestProxy?Se.requestProxy($e):$e}).then(function(Ke){return/^https\:/.test(location.href)&&/^http\:/.test(Ke)?(console.warn("The page at '".concat(location.href,"' was loaded over HTTPS, but requested an insecure element '").concat(Ke,"'. This request was automatically upgraded to HTTPS")),Ke.replace(/^http\:/,"https:")):Ke}).catch(function(Ke){var Ye,or=new NetworkProxyError(Xe,"Image",Ke&&Ke.message?String(Ke.message):String(Ke));return(Ye=Se.networkSubscribe)===null||Ye===void 0||Ye.emit("network",$e,"Image","proxy-error",or.message),Promise.reject(or)}).then(function(Ke){return new Promise(function(Ye,or){var sr,cr=Se.allowHosts?BUILDIN_ALLOW_HOST.concat(Se.allowHosts):BUILDIN_ALLOW_HOST.slice(),Br=hostnameFromURL(Ke);if(location.hostname.length!==0&&!isIPDomain(location.hostname)&&BUILDIN_ALLOW_HOST.filter(function(ln){return matchDomain(ln,location.hostname)}).length===0&&!isIPDomain(Br)&&cr.filter(function(ln){return matchDomain(ln,Br)}).length===0){var tn=new NetworkFirbiddenError(Ke,"Image","request host(".concat(Br,") is not allowed"));De(tn),or(tn),(sr=Se.networkSubscribe)===null||sr===void 0||sr.emit("network",Ke,"Image","forbidden",tn.message);return}var en=Fe??new Image,an=!1,rn=null,on=function(){var ln;if(en.onload=noop$1,en.onerror=noop$1,rn!==null&&(clearTimeout(rn),rn=null),an!==!0){var cn=now$2(),hn={headers:{},origin:Xe,source:Ke,requestTime:Je,responseTime:cn,costs:cn-Je};an=!0;var mn={body:en,meta:hn};Ve(1),Be(mn),Ye(mn),(ln=Se.networkSubscribe)===null||ln===void 0||ln.emit("network",Ke,"Image","ok",JSON.stringify(mn.meta))}},sn=function(){var ln;if(en.onload=noop$1,en.onerror=noop$1,rn!==null&&(clearTimeout(rn),rn=null),an!==!0){an=!0;var cn=new NetworkResponseError(Ke,"Image",0);De(cn),or(cn),(ln=Se.networkSubscribe)===null||ln===void 0||ln.emit("network",Ke,"Image","ok",cn.message)}};typeof Se.timeout=="number"&&(rn=window.setTimeout(function(){var ln;if(en.onload=noop$1,en.onerror=noop$1,rn=null,an!==!0){an=!0;var cn=new NetworkTimeoutError(Ke,"Image",Se.timeout);De(cn),or(cn),(ln=Se.networkSubscribe)===null||ln===void 0||ln.emit("network",Ke,"Image","timeout",cn.message)}},Se.timeout)),en.onload=on,en.onerror=sn,Ve(0),en.src=Ke})})}var Fetcher=function(){function $e(Se){Se===void 0&&(Se={}),this.options=Object.freeze(Se),this.options.allowHosts&&Object.freeze(this.options.allowHosts)}return $e.prototype.ajax=function(Se,Be,De,Ve,Fe){var Je;Be===void 0&&(Be={}),De===void 0&&(De=noop$1),Ve===void 0&&(Ve=noop$1),Fe===void 0&&(Fe=noop$1);var Xe=this.options,Ke={responseType:Be.responseType,timeout:(Je=Be.timeout)!==null&&Je!==void 0?Je:Xe.timeout,get allowHosts(){var Ye;return(Ye=Be.allowHosts)!==null&&Ye!==void 0?Ye:Xe.allowHosts},get requestProxy(){var Ye;return(Ye=Be.requestProxy)!==null&&Ye!==void 0?Ye:Xe.requestProxy},get networkSubscribe(){var Ye;return(Ye=Be.networkSubscribe)!==null&&Ye!==void 0?Ye:Xe.networkSubscribe}};return ajax(Se,Ke,De,Ve,Fe)},$e.prototype.loadImage=function(Se,Be,De,Ve,Fe,Je){var Xe;Be===void 0&&(Be={}),De===void 0&&(De=noop$1),Ve===void 0&&(Ve=noop$1),Fe===void 0&&(Fe=noop$1);var Ke=this.options,Ye={timeout:(Xe=Be.timeout)!==null&&Xe!==void 0?Xe:Ke.timeout,get allowHosts(){var or;return(or=Be.allowHosts)!==null&&or!==void 0?or:Ke.allowHosts},get requestProxy(){var or;return(or=Be.requestProxy)!==null&&or!==void 0?or:Ke.requestProxy},get networkSubscribe(){var or;return(or=Be.networkSubscribe)!==null&&or!==void 0?or:Ke.networkSubscribe}};return loadImage(Se,Ye,De,Ve,Fe,Je)},$e.prototype.preload=function(Se,Be){var De;Be===void 0&&(Be={});var Ve=this.options,Fe={timeout:(De=Be.timeout)!==null&&De!==void 0?De:Ve.timeout,get allowHosts(){var Je;return(Je=Be.allowHosts)!==null&&Je!==void 0?Je:Ve.allowHosts},get requestProxy(){var Je;return(Je=Be.requestProxy)!==null&&Je!==void 0?Je:Ve.requestProxy},get networkSubscribe(){var Je;return(Je=Be.networkSubscribe)!==null&&Je!==void 0?Je:Ve.networkSubscribe}};return preload(Se,Fe)},$e}(),internalFetcher=new Fetcher;function clamp$1($e,Se,Be){return $e<Se?Se:$e>Be?Be:$e}var windowSTOContext=function(){var $e=now$2();return{requestAnimationFrame:function(Se){var Be=now$2(),De=clamp$1(16+(Be-$e),16,33),Ve=setTimeout(function(){Se(Be+De)},De);return $e=Be+De,Ve},cancelAnimationFrame:function(Se){return clearTimeout(Se)}}}(),windowRAFContext=function(){if(typeof window<"u"){var $e=window;if($e.requestAnimationFrame)return{requestAnimationFrame:$e.requestAnimationFrame.bind($e),cancelAnimationFrame:$e.cancelAnimationFrame.bind($e)};if($e.mozRequestAnimationFrame)return{requestAnimationFrame:$e.mozRequestAnimationFrame.bind($e),cancelAnimationFrame:$e.mozCancelAnimationFrame.bind($e)};if($e.webkitRequestAnimationFrame)return{requestAnimationFrame:$e.webkitRequestAnimationFrame.bind($e),cancelAnimationFrame:$e.webkitCancelAnimationFrame.bind($e)};if($e.msRequestAnimationFrame)return{requestAnimationFrame:$e.msRequestAnimationFrame.bind($e),cancelAnimationFrame:$e.msCancelAnimationFrame.bind($e)}}return windowSTOContext}(),DEFAULT_ORDER=5,deviceFrameTime=16,AnimationFrameLoop=function(){function $e(){this.loopType="raf",this.frames=[],this.isAnimating=!1,this.context=null;var Se=now$2();this.loop=function(){for(var Be=[],De=0;De<arguments.length;De++)Be[De]=arguments[De];if(this.isAnimating!==!1){var Ve=now$2(),Fe=Ve-Se;Se=Ve,deviceFrameTime=Fe;for(var Je=0;Je<this.frames.length;Je++){var Xe=this.frames[Je];if(Xe.delay>0){Xe.delay=Xe.delay-1;continue}try{Xe.callback.apply(Xe,__spreadArray([Ve,Fe],Be,!1))}catch(Ke){console.error(Ke)}Xe.once&&(this.frames.splice(Je,1),Je--)}this.requestId=this.requestAnimationFrame(this.loop)}}.bind(this),this.start()}return Object.defineProperty($e,"shared",{get:function(){return this.sharedInstance||(this.sharedInstance=new $e),this.sharedInstance},enumerable:!1,configurable:!0}),$e.getFrameTime=function(){return deviceFrameTime},$e.prototype.start=function(){this.isAnimating!==!0&&(this.isAnimating=!0,this.requestId=this.requestAnimationFrame(this.loop))},$e.prototype.stop=function(){this.isAnimating=!1,this.cancelAnimationFrame(this.requestId)},$e.prototype.setContext=function(Se){Se!==this.context&&(this.stop(),this.context=Se,this.start())},$e.prototype.getContext=function(){return this.context},$e.prototype.setLoopType=function(Se){Se!==this.loopType&&(this.stop(),this.loopType=Se,this.start())},$e.prototype.getLoopType=function(){return this.loopType},$e.prototype.requestAnimationFrame=function(Se){if(this.context)return this.context.requestAnimationFrame(Se);if(this.loopType==="raf")return windowRAFContext.requestAnimationFrame(Se);if(this.loopType==="sto")return windowSTOContext.requestAnimationFrame(Se)},$e.prototype.cancelAnimationFrame=function(Se){if(this.context)this.context.cancelAnimationFrame(Se);else if(this.loopType==="raf")windowRAFContext.cancelAnimationFrame(Se);else if(this.loopType==="sto")return windowSTOContext.cancelAnimationFrame(Se)},$e.prototype.remove=function(Se){var Be=this.frames.indexOf(Se);Be>=0&&this.frames.splice(Be,1)},$e.prototype.add=function(Se,Be,De,Ve){var Fe=this;Be===void 0&&(Be=!1),De===void 0&&(De=0),Ve===void 0&&(Ve=DEFAULT_ORDER);for(var Je={callback:Se,once:Be,delay:De,order:Ve},Xe=this.frames.length;--Xe>=0;)if(this.frames[Xe].order<=Ve){this.frames.splice(Xe+1,0,Je);break}return Xe<0&&this.frames.unshift(Je),function(){return Fe.remove(Je)}},$e.prototype.clear=function(){this.frames.length=0},$e}(),webp="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoCAAIAAUAmJaQAA3AA/vz0AAA=",avif="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAAGhbWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAsaWxvYwAAAABEAAACAAEAAAABAAAB3gAAABkAAgAAAAEAAAHJAAAAFQAAAEJpaW5mAAAAAAACAAAAGmluZmUCAAAAAAEAAGF2MDFDb2xvcgAAAAAaaW5mZQIAAAAAAgAAYXYwMUFscGhhAAAAABppcmVmAAAAAAAAAA5hdXhsAAIAAQABAAAA12lwcnAAAACxaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIAAoAAAAAUaXNwZQAAAAAAAAACAAAAAgAAAA5waXhpAAAAAAEIAAAADGF2MUOBABwAAAAAOGF1eEMAAAAAdXJuOm1wZWc6bXBlZ0I6Y2ljcDpzeXN0ZW1zOmF1eGlsaWFyeTphbHBoYQAAAAAeaXBtYQAAAAAAAAACAAEEAQKDBAACBAUGhwgAAAA2bWRhdBIACgQYADLVMgsWQBhhIAQqrNj/+BIACgUYADLEoDIOFkADDDDCQAACDaqCCb4=",heif="data:image/heif;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAABL21ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAAAAAAAAAAAAAAAAAAAAADnBpdG0AAAAAAAEAAAAjaWluZgAAAAAAAQAAABVpbmZlAgAAAAABAABodmMxAAAAAK9pcHJwAAAAkmlwY28AAAB2aHZjQwEBYAAAAAAAAAAAAADwAPz9+PgAACcDoAABAB5AAQwG//8BYAAAAwAAAwAAAwAAAwAAAwAAreTLgSChAAEAI0IBBwFgAAADAAADAAADAAADAAADAAChInJJlreTLySZNdggogABAAdEAcA98DMkAAAAFGlzcGUAAAAAAAAAAgAAAAIAAAAVaXBtYQAAAAAAAAABAAECgQIAAAAiaWxvYwAAAABEQAABAAEAAAAAAU8AAQAAAAAAAAAOAAAAFm1kYXQAAAAKJgGvLvkQwuWM4A==";function checkImage($e){return new Promise(function(Se){if(typeof Image>"u"){Se(!1);return}var Be=new Image,De=setTimeout(function(){Be.onload=Be.onerror=function(){},clearTimeout(De),Se(!1)},100);Be.onload=Be.onerror=function(){Be.onload=Be.onerror=function(){},clearTimeout(De),Se(Be.height===2)},Be.src=$e})}var imageSupportCache=null;function imageSupport(){return imageSupportCache||(imageSupportCache=Promise.all([checkImage(webp),checkImage(avif),checkImage(heif)]).then(function($e){return{webp:$e[0],avif:$e[1],heif:$e[2]}}))}var supportAvif=!1,supportWebp=!1,supportHeif=!1;imageSupport().then(function($e){supportAvif=$e.avif,supportWebp=$e.webp,supportHeif=$e.heif});var IMAGE_FORMATS=["jpg","jpeg","png","heif","heic","webp","avif"];function isImageExt($e){return IMAGE_FORMATS.indexOf($e)>=0}var DEFAULT_IMAGE_URL_MAPPINGS={"vrlab-public.ljcdn.com":{type:"tencentCloud",pano:["vrlab-image1.ljcdn.com","vrlab-image2.ljcdn.com"],texture:["vrlab-image3.ljcdn.com"],tile:["vr-tile-1.realsee-cdn.cn","vr-tile-2.realsee-cdn.cn"],model:["vr-model-1.realsee-cdn.cn","vr-model-2.realsee-cdn.cn"],default:["vrlab-image4.ljcdn.com"]},"vr-public.realsee-cdn.cn":{type:"tencentCloud",pano:["vr-image-1.realsee-cdn.cn","vr-image-2.realsee-cdn.cn"],texture:["vr-image-3.realsee-cdn.cn"],tile:["vr-tile-1.realsee-cdn.cn","vr-tile-2.realsee-cdn.cn"],model:["vr-model-1.realsee-cdn.cn","vr-model-2.realsee-cdn.cn"],default:["vr-image-4.realsee-cdn.cn"]},"vr-public.rscdn.cn":{type:"tencentCloud",pano:["vr-image-1.rscdn.cn","vr-image-2.rscdn.cn"],texture:["vr-image-3.rscdn.cn"],tile:["vr-tile-1.rscdn.cn","vr-tile-2.rscdn.cn"],model:["vr-model-1.rscdn.cn","vr-model-2.rscdn.cn"],default:["vr-image-4.rscdn.cn"]},"mars-public.realsee-cdn.cn":{type:"aliyun",pano:["mars-image-1.realsee-cdn.cn","mars-image-2.realsee-cdn.cn"],texture:["mars-image-3.realsee-cdn.cn"],tile:["mars-tile-1.realsee-cdn.cn","mars-tile-2.realsee-cdn.cn"],model:["mars-model-1.realsee-cdn.cn","mars-model-2.realsee-cdn.cn"],default:["mars-image-4.realsee-cdn.cn"]},"global-public.realsee-cdn.com":{type:"tencentCloud",pano:["global-image-1.realsee-cdn.com","global-image-2.realsee-cdn.com"],texture:["global-image-3.realsee-cdn.com"],tile:["global-tile-1.realsee-cdn.com","global-tile-2.realsee-cdn.com"],model:["global-model-1.realsee-cdn.com","global-model-2.realsee-cdn.com"],default:["global-image-4.realsee-cdn.com"]},"earth-ga-public.realsee-cdn.cn":{type:"tencentCloud",pano:["earth-ga-image-1.realsee-cdn.cn","earth-ga-image-2.realsee-cdn.cn"],texture:["earth-ga-image-3.realsee-cdn.cn"],tile:["earth-ga-tile-1.realsee-cdn.cn","earth-ga-tile-2.realsee-cdn.cn"],model:["earth-ga-model-1.realsee-cdn.cn","earth-ga-model-2.realsee-cdn.cn"],default:["earth-ga-image-4.realsee-cdn.cn"]},"test-vr-public.realsee-cdn.com":{type:"tencentCloud",pano:["test-vr-image.realsee-cdn.com","test-vr-image.realsee-cdn.com"],texture:["test-vr-image.realsee-cdn.com"],tile:["test-vr-image.realsee-cdn.com","test-vr-image.realsee-cdn.com"],model:["test-vr-image.realsee-cdn.com","test-vr-image.realsee-cdn.com"],default:["test-vr-image.realsee-cdn.com"]},"test-vr-public.realsee-cdn.cn":{type:"tencentCloud",pano:["test-vr-image.realsee-cdn.cn","test-vr-image.realsee-cdn.cn"],texture:["test-vr-image.realsee-cdn.cn"],tile:["test-vr-image.realsee-cdn.cn","test-vr-image.realsee-cdn.cn"],model:["test-vr-image.realsee-cdn.cn","test-vr-image.realsee-cdn.cn"],default:["test-vr-image.realsee-cdn.cn"]}},URL_DOMAIN_REGEX=/^https?\:\/\/?([^\/]+)/;function getDomain($e){var Se=$e.match(URL_DOMAIN_REGEX);return Se===null?null:Se[1]}function replaceDomain($e,Se){return $e.replace(URL_DOMAIN_REGEX,function(Be,De){return Be.slice(0,Be.length-De.length)+Se})}function route($e,Se,Be){var De=Se.split("."),Ve=De[0],Fe=De.slice(1);if(Ve==="texture")return replaceDomain($e,Be.texture[0]);if(Ve==="pano"||Ve==="pano_luminance"){Fe[0];var Je=Fe[1];switch(Je){case"front":case"left":case"up":return replaceDomain($e,Be.pano[0]);case"down":case"right":case"back":return replaceDomain($e,Be.pano[1])}}else if(Ve==="pano_tile"||Ve==="pano_tile_luminance"){Fe[0],Fe[1];var Xe=Fe[2],Ke=Fe[3],Ye=Fe[4],or=Math.pow(2,Number(Xe))*Number(Ke)+Number(Ye);if(!isNaN(or))return replaceDomain($e,Be.tile[or%2])}else if(Ve==="model"){var sr=Fe[0],or=Number(sr);if(!isNaN(or))return replaceDomain($e,Be.model[or%2])}return replaceDomain($e,Be.default[0])}var tencentCloudImageProcesser=function($e,Se){var Be=$e.split("?")[0],De=Be.split(".").pop();if(De==="jpeg"&&(De="jpg"),De==="heif"&&(De="heic"),De&&!isImageExt(De))return $e;var Ve=[],Fe=Se.format,Je=Se.cut,Xe=Se.quality,Ke=Se.size,Ye=Se.sharpen;if(Fe==="jpeg"&&(Fe="jpg"),Fe==="heif"&&(Fe="heic"),(!supportAvif&&(Fe??De)==="avif"||!supportWebp&&(Fe??De)==="webp"||!supportHeif&&(Fe??De)==="heic")&&(Fe="jpg"),Fe!==void 0&&Fe!==De&&Ve.push("format/".concat(Fe)),Je!==void 0&&Ve.push("cut/".concat(Je[2],"x").concat(Je[3],"x").concat(Je[0],"x").concat(Je[1])),Xe!==void 0){var or=Fe??De;or&&["jpg","webp","heic","avif"].indexOf(or)>=0&&Ve.push("quality/".concat(Xe))}if(Ke!==void 0){var sr=$e.match(/\/cube_(\d+)\//),cr=sr?Number(sr[1]):NaN;cr!==Number(Ke)&&Ve.push("thumbnail/".concat(Ke,"x"))}Ye!==void 0&&Ve.push("sharpen/".concat(Ye));var Br="";return Ve.length&&(Br="?imageMogr2/"+Ve.join("/")),Be+Br},aliyunOOSImageProcesser=function($e,Se){var Be=$e.split("?")[0],De=Be.split(".").pop();if(De==="jpeg"&&(De="jpg"),De==="heif"&&(De="heic"),De&&!isImageExt(De))return $e;var Ve=[],Fe=Se.format,Je=Se.cut,Xe=Se.quality,Ke=Se.size,Ye=Se.sharpen;if(Fe==="jpeg"&&(Fe="jpg"),Fe==="heif"&&(Fe="heic"),(!supportAvif&&(Fe??De)==="avif"||!supportWebp&&(Fe??De)==="webp"||!supportHeif&&(Fe??De)==="heic")&&(Fe="jpg"),Fe!==void 0&&Fe!==De&&Ve.push("format,".concat(Fe)),Je!==void 0){var or=Je[0],sr=Je[1],cr=Je[2],Br=Je[3];Ve.push("crop,x_".concat(or,",y_").concat(sr,",w_").concat(cr,",h_").concat(Br,",g_nw"))}if(Xe!==void 0&&Xe!==100){var tn=Fe??De;tn&&["jpg","webp","heic","avif"].indexOf(tn)>=0&&Ve.push("quality,Q_".concat(Xe))}Ke&&Ke!==2048&&Ve.push("resize,w_".concat(Ke)),Ye!==void 0&&Ve.push("sharpen,".concat(Ye));var en="";return Ve.length&&(en="?x-oss-process=image/"+Ve.join("/")),Be+en},MAX_SAFE_INTEGER=9007199254740991;function formatNumber($e){var Se=Math.round($e);return Math.abs(Se-$e)<.001?Se:Math.floor($e)}function formatOptions($e){return $e=Object.assign({},$e),$e.size!==void 0&&($e.size=formatNumber(clamp$1($e.size,0,MAX_SAFE_INTEGER))),$e.quality!==void 0&&($e.quality=formatNumber(clamp$1($e.quality,0,100))),$e.cut!==void 0&&($e.cut=[formatNumber(clamp$1($e.cut[0],0,MAX_SAFE_INTEGER)),formatNumber(clamp$1($e.cut[1],0,MAX_SAFE_INTEGER)),formatNumber(clamp$1($e.cut[2],0,MAX_SAFE_INTEGER)),formatNumber(clamp$1($e.cut[3],0,MAX_SAFE_INTEGER))]),$e.sharpen!==void 0&&($e.sharpen=formatNumber(clamp$1($e.sharpen,0,MAX_SAFE_INTEGER))),$e}function imageURL($e,Se){var Be=__assign(__assign({},DEFAULT_IMAGE_URL_MAPPINGS),Se.mappings),De=getDomain($e);if(De===null)return $e;Se=formatOptions(Se);var Ve=Be[De];return Ve?($e=route($e,Se.key,Ve),/\.basis(\?|$)/.test($e)&&($e=$e.replace(/\.basis(\?|$)/,".jpg$1")),Ve.type==="tencentCloud"?tencentCloudImageProcesser($e,Se):Ve.type==="aliyun"?aliyunOOSImageProcesser($e,Se):$e):$e}function applyImageURLOptions($e,Se,Be){Se===void 0&&(Se=imageURL);var De=Se($e,Be);if(De===$e&&Be.cut)throw new Error("ImageURL: cut option not applied.");return De}var IMAGE_SIZE_REG=/\/cube_(\d+)\//;function getImageSizeFromURL($e){var Se=$e.match(IMAGE_SIZE_REG);return Se?Number(Se[1]):null}function replaceImageSize($e,Se){return $e.replace(IMAGE_SIZE_REG,"/cube_".concat(Se,"/"))}var PANO_ID_REG=/^(.*)\[(\d+)\]$/;function panoStringify($e){if(!isNaN($e.panoIndex)&&isFinite($e.panoIndex))return"".concat($e.workCode,"[").concat($e.panoIndex,"]");throw new Error("Invalid Pano")}function panoParse($e){var Se=$e.match(PANO_ID_REG);if(Se){Se[0];var Be=Se[1],De=Se[2],Ve=Math.floor(Number(De));if(!isNaN(Ve)&&isFinite(Ve))return{workCode:Be,panoIndex:Ve}}throw new Error("Invalid PanoId")}function panoEqual($e,Se){return panoStringify($e)===panoStringify(Se)}function isPanoId($e){return typeof $e=="string"&&PANO_ID_REG.test($e)}(function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se})(Group$1);var PBMMesh=function($e){__extends(Se,$e);function Se(Be,De){var Ve=$e.call(this,Be,De)||this;return Ve.castShadow=!0,Ve.receiveShadow=!0,Ve}return Se.prototype.update=function(Be,De,Ve,Fe){for(var Je=0,Xe=this.material;Je<Xe.length;Je++){var Ke=Xe[Je];Ke.update(Be,De,Ve)}},Se}(Mesh),PBMSkinnedMesh=function($e){__extends(Se,$e);function Se(Be,De,Ve){var Fe=$e.call(this,Be,De,Ve)||this;return Fe.castShadow=!0,Fe.receiveShadow=!0,Fe}return Se.prototype.update=function(Be,De,Ve,Fe){for(var Je=0,Xe=this.material;Je<Xe.length;Je++){var Ke=Xe[Je];Ke.update(Be,De,Ve)}},Se}(SkinnedMesh);function jsonStableStrinfiy_($e,Se){Se===void 0&&(Se=!1);var Be=typeof $e;if(Be==="string")return JSON.stringify($e);if($e===!0)return"true";if($e===!1)return"false";if($e===null)return"null";if($e instanceof Array){for(var De="[",Ve=$e.length-1,Fe=0;Fe<Ve;Fe++)De+=jsonStableStrinfiy_($e[Fe],!1)+",";return Ve>-1&&(De+=jsonStableStrinfiy_($e[Fe],!1)),De+"]"}if($e instanceof Object){if(typeof $e.toJSON=="function")return jsonStableStrinfiy_($e.toJSON(),Se);for(var Je=Object.keys($e).sort(),Xe=Je.length,De="",Fe=0;Fe<Xe;){var Ke=Je[Fe],Ye=jsonStableStrinfiy_($e[Ke],!0);Ye!==void 0&&(Fe&&De!==""&&(De+=","),De+=JSON.stringify(Ke)+":"+Ye),Fe++}return"{"+De+"}"}switch(Be){case"function":return JSON.stringify($e.toString());case"undefined":return Se?void 0:null;case"number":return $e;default:return isFinite($e)?$e:null}}function jsonHash($e){return"hash::".concat(jsonStableStrinfiy_($e,!1))}var gradientTexture=function(){return typeof document<"u"?new TextureLoader$1().load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAABCAYAAACouxZ2AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAACAKADAAQAAAABAAAAAQAAAAB7UD0+AAACA0lEQVRIDXWUW3YjIQxEwdnV/GT/q8kO3FO3pAJst3PSAaR6Cbszf//9XeMxxpjXmI+pVXudp2s6PC4dqHff9e6D7/PZLy46xQvG+sZvrfK8xgXUeq85yINe9bdmtOK1+kun5vjgq58a+eZPna9jvmjiserqG/+Whathvo3L3WhV89L9sXI/m18z2uene9ap/ftsuT9WZxoHXzW56/fpj8l7+tTw7P011NdpqnY19sRsfuHMA9u8oZWfDz4+fra/dfG1V60ydZ7qba1g7UNAeK0JP7ydD7/OqH6wO2f7HTq+B/lbL9qsB3/N1/UzR81XfPzw4tp5OPvRneacteq8Xo0xR3vuv/kPz0KtX0Nhg0eHuaNXdWI3X/ld427h++vzyp99V6VPrzWFhbv4ayay4oFecm198MmUXN/mL+x7npq/uJXBGb/MTw4+t+SvbLoTZnUW5uHhz7nWcTxT73OwXV7cxT9wbBf/0LnDBgcnHmtPLYba32Hp808sMy1u88yhr58n70/v4xX92GSN19l/2UsqGmiH94Hpxjcs+DO/ccpIVNVp62PUWXu//ur1GQy1Cf+GZ13rtNYN1po3/NI79fGXibHkq4z25xvV2pW3szpneXsW8SsreTe/NIPrtXMnH7wPf+LEN6tqhUVHj3XKD/72p9eafCeYB3zuonnbv7yqP8d/o4K6gRb1wbYAAAAASUVORK5CYII="):new Texture}();gradientTexture.minFilter=NearestFilter;gradientTexture.magFilter=NearestFilter;gradientTexture.wrapS=RepeatWrapping;gradientTexture.wrapT=RepeatWrapping;var defaultPbmParameters={customShaders:[],pano0:null,pano1:null,floorStyle:"OPACITY",colorStyle:"RGB",constantColor:new Vector3(.6,.6,.6),shownFloorIndex:-1,modelAlpha:1,opacity:1,progress:0,transition:"FADE",clippers:null,brightness:1,useEDL:!1,useHQWeight:!1,useHQDepth:!1,pointSize:"ATTENUATION",pointBack:"DARK",pointShape:"CIRCLE",pointScale:.03,pointMaxPixel:40,pointMinPixel:1,gradientTexture,colorSaturation:0,colorBrightness:0,outlineGain:0,distanceGain:0,useAddBlend:!1};function isEqualClipperParameters($e,Se){var Be=$e??[],De=Se??[];if(De.length!==Be.length)return!1;for(var Ve=0;Ve<De.length;Ve++)if(!Be[Ve].clippingBoxMatrix.equals(De[Ve].clippingBoxMatrix)||Be[Ve].floorIndex!==De[Ve].floorIndex)return!1;return!0}function isEqualPBMPanoPicture($e,Se){return $e&&Se?$e.luminanceMap===Se.luminanceMap&&$e.map===Se.map&&$e.zoom===Se.zoom&&$e.matrix.equals(Se.matrix):!$e&&!Se}function updatePBMParameters($e,Se){var Be=!1;for(var De in Se)if(Se[De]!==void 0)switch(De){case"clippers":isEqualClipperParameters($e[De],Se[De])||($e[De]=Se[De],Be=!0);break;case"pano0":case"pano1":isEqualPBMPanoPicture($e[De],Se[De])||($e[De]=Se[De],Be=!0);break;default:$e[De]!==Se[De]&&($e[De]=Se[De],Be=!0);break}return Be}function mixNumber($e,Se,Be){return $e+(Se-$e)*Be}function value($e,Se,Be,De){var Ve=(Se*Be+2*$e)/Math.pow(Be,3),Fe=-(2*Se*Be+3*$e)/Math.pow(Be,2),Je=Se,Xe=$e;return Ve*Math.pow(De,3)+Fe*Math.pow(De,2)+Je*De+Xe}function velocity($e,Se,Be,De){var Ve=(Se*Be+2*$e)/Math.pow(Be,3),Fe=-(2*Se*Be+3*$e)/Math.pow(Be,2),Je=Se;return 3*Ve*Math.pow(De,2)+2*Fe*De+Je}function mixCircle($e,Se,Be,De){var Ve=De[1]-De[0];return $e=circleValue($e,De),Se=circleValue(Se,De),Se-$e>Ve/2?mixNumber($e+Ve,Se,Be):$e-Se>Ve/2?mixNumber($e-Ve,Se,Be):mixNumber($e,Se,Be)}function circleValue($e,Se){var Be=Se[1]-Se[0];return $e<Se[0]?circleValue($e+Be,Se):$e>=Se[1]?circleValue($e-Be,Se):$e}function mixValue($e,Se,Be,De){return De?mixCircle($e,Se,Be,De):mixNumber($e,Se,Be)}function toNumber($e){var Se=Number($e);return isNaN(Se)||!isFinite(Se)?0:Se}var Motion=function(){function $e(Se){this.config={},this.progress=1,this.ended=!0,this.value={},this.startTime=now$2(),this.startVelocity=0,this.duration=0,this.keyframes=[];for(var Be in Se){var De=Se[Be];typeof De=="object"?(this.value[Be]=toNumber(De.value),this.config[Be]={circle:De.circle}):(this.value[Be]=toNumber(De),this.config[Be]={circle:!1})}this.keyframes=[{progress:0,value:__assign({},this.value)},{progress:1,value:__assign({},this.value)}]}return $e.prototype.getProgress=function(Se){var Be=Se-this.startTime;return Be<0?0:Be>=this.duration?1:1-value(1,this.startVelocity,this.duration,Be)},$e.prototype.getValue=function(Se){for(var Be=1;Be<this.keyframes.length;Be++)if(this.keyframes[Be].progress>Se){var De=this.keyframes[Be-1],Ve=this.keyframes[Be],Fe={};for(var Je in this.config){var Xe=(Se-De.progress)/(Ve.progress-De.progress);Fe[Je]=mixValue(De.value[Je],Ve.value[Je],Xe,this.config[Je].circle)}return Fe}return __assign({},this.keyframes[this.keyframes.length-1].value)},$e.prototype.getProgressVelocity=function(Se){var Be=Se-this.startTime;return Be>=this.duration?0:velocity(1,this.startVelocity,this.duration,Be)},$e.prototype.update=function(Se){return this.ended?!0:(this.progress=Math.min(1,Math.max(0,this.progress,this.getProgress(Se))),this.value=this.getValue(this.progress),this.ended=this.progress>=1,this.ended&&this.callbacks&&(this.callbacks[0](),this.callbacks=void 0),this.ended)},$e.prototype.getKeyFrameSegment=function(Se){for(var Be=this.getProgress(Se),De=1;De<this.keyframes.length;De++)if(this.keyframes[De].progress>Be)return[this.keyframes[De-1],this.keyframes[De]];return[this.keyframes[this.keyframes.length-2],this.keyframes[this.keyframes.length-1]]},$e.prototype.getTargetKeyframe=function(){return this.keyframes[this.keyframes.length-1]},$e.prototype.set=function(Se,Be,De,Ve){var Fe;De===void 0&&(De=0),isNaN(Be)&&(Be=0),isNaN(De)&&(De=0),Ve=Ve??now$2();var Je=this.getProgress(Ve),Xe=this.getValue(Je),Ke={};for(var Ye in this.config)Ke[Ye]=(Fe=Se[Ye])!==null&&Fe!==void 0?Fe:Xe[Ye];var or=[{progress:0,value:Xe},{progress:1,value:Ke}];return this.setKeyframes(or,Be,De,Ve)},$e.prototype.setKeyframes=function(Se,Be,De,Ve){var Fe=this;if(De===void 0&&(De=0),Se.length<2)throw new Error("keyframes invalid.");return isNaN(Be)&&(Be=0),isNaN(De)&&(De=0),this.callbacks&&(this.callbacks[1](new Error("motion aborted.")),this.callbacks=void 0),new Promise(function(Je,Xe){Ve=Ve??now$2(),Fe.progress=0,Fe.ended=!1,Fe.startTime=Ve,Fe.startVelocity=De,Fe.keyframes=Se,Fe.duration=Be,Be===0?(Fe.progress=1,Fe.value=__assign({},Se[Se.length-1].value)):Fe.value=__assign({},Se[0].value),Fe.callbacks=[Je,Xe]})},$e.prototype.dispose=function(){this.callbacks&&(this.callbacks[1](new Error("motion dispose.")),this.callbacks=void 0)},$e}(),APPEAR_ANIMATION_DURATION=500;function easeInCubic($e){return $e*$e*$e}var PBMPointCloud=function($e){__extends(Se,$e);function Se(Be,De){var Ve=$e.call(this,Be,De)||this;return Ve.appearMotion=new Motion({appear:0}),Ve}return Se.prototype.update=function(Be,De,Ve,Fe){var Je,Xe;if(this.material.update(Be,De,Ve),Fe&&Fe.refine==="ADD"&&Fe.tileset.rootMeta.pntsOrder==="RANDOM"){var Ke=this.geometry,Ye=this.appearMotion,or=Ve.visible&&Fe.state.selectedFrameNumber===Fe.tileset.frameNumber,sr=Fe.tileset.currentMaxScreenSpaceError,cr=Fe.state.screenSpaceError,Br=(Xe=(Je=Fe.parent)===null||Je===void 0?void 0:Je.state.screenSpaceError)!==null&&Xe!==void 0?Xe:cr,tn=1;if(Br!==cr&&(tn=(Br-sr)/(Br-cr)),tn=clamp$1(tn,0,1),tn=easeInCubic(tn),or){var en=1;Ye.getTargetKeyframe().value.appear!==en&&Ye.set({appear:en},APPEAR_ANIMATION_DURATION).catch(noop$1)}else{var en=0;Ye.getTargetKeyframe().value.appear!==en&&Ye.set({appear:en},0).catch(noop$1)}Ye.ended!==!0&&Ye.update(De.time);var an=Ke.index?Ke.index.count:Ke.attributes.position?Ke.attributes.position.count:1/0,rn=Math.floor(an*tn*Ye.value.appear);Ke.drawRange.count!==rn&&(this.geometry.setDrawRange(0,rn),Ve.needsRender=!0)}},Se}(Points),scratchMaterialSet=new Set;(function($e){__extends(Se,$e);function Se(){var Be=$e.call(this)||this;return Be.needsRender=!0,Be.pbmMaterialParametersVersion=0,Be.materialParameters=__assign({},defaultPbmParameters),Be}return Se.prototype.getMaterial=function(){return __assign({},this.materialParameters)},Se.prototype.setMaterial=function(Be){var De=this;Object.assign(this.materialParameters,Be),scratchMaterialSet.clear(),this.traverse(function(Ve){if(Ve instanceof PBMMesh||Ve instanceof PBMSkinnedMesh)for(var Fe=0,Je=Ve.material;Fe<Je.length;Fe++){var Xe=Je[Fe];scratchMaterialSet.has(Xe)||(Object.assign(Xe,De.materialParameters),scratchMaterialSet.add(Xe))}Ve instanceof PBMPointCloud&&(scratchMaterialSet.has(Ve.material)||(Object.assign(Ve.material,De.materialParameters),scratchMaterialSet.add(Ve.material)))}),scratchMaterialSet.clear(),this.needsRender=!0},Se})(Group$1);var FACE_ORDER$1=["right","left","up","down","front","back"];function getBox($e,Se,Be,De){var Ve=new Box3;switch($e){case"up":Ve.min.y=.5,Ve.max.y=.5,Ve.min.x=+Se-.5,Ve.max.x=+Se-.5+De,Ve.min.z=-Be+.5-De,Ve.max.z=-Be+.5;break;case"down":Ve.min.y=-.5,Ve.max.y=-.5,Ve.min.x=+Se-.5,Ve.max.x=+Se-.5+De,Ve.min.z=+Be-.5,Ve.max.z=+Be-.5+De;break;case"left":Ve.min.x=-.5,Ve.max.x=-.5,Ve.min.z=-Se+.5-De,Ve.max.z=-Se+.5,Ve.min.y=-Be+.5-De,Ve.max.y=-Be+.5;break;case"right":Ve.min.x=.5,Ve.max.x=.5,Ve.min.z=+Se-.5,Ve.max.z=+Se-.5+De,Ve.min.y=-Be+.5-De,Ve.max.y=-Be+.5;break;case"front":Ve.min.z=-.5,Ve.max.z=-.5,Ve.min.x=+Se-.5,Ve.max.x=+Se-.5+De,Ve.min.y=-Be+.5-De,Ve.max.y=-Be+.5;break;case"back":Ve.min.z=.5,Ve.max.z=.5,Ve.min.x=-Se+.5-De,Ve.max.x=-Se+.5,Ve.min.y=-Be+.5-De,Ve.max.y=-Be+.5;break}return Ve.applyMatrix4(new Matrix4().makeRotationY(Math.PI))}var createChildren=function($e,Se){if(!($e.level>=Se))for(var Be=$e.level+1,De=$e.size/2,Ve=[new Vector2($e.position.x,$e.position.y),new Vector2($e.position.x+De,$e.position.y),new Vector2($e.position.x,$e.position.y+De),new Vector2($e.position.x+De,$e.position.y+De)],Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe],Ke={face:$e.face,level:Be,size:De,position:Xe,box:getBox($e.face,Xe.x,Xe.y,De),parent:$e,children:[]};$e.children.push(Ke),createChildren(Ke,Se)}};function createTileCubeNode($e,Se){var Be={level:0,face:$e,position:new Vector2(0,0),size:1,box:getBox($e,0,0,1),parent:null,children:[]};return createChildren(Be,Se),Be}function createTileCubeTree($e){var Se=FACE_ORDER$1.map(function(Be){return createTileCubeNode(Be,$e)});return{children:Se}}function traverseTileCubeNode($e,Se){for(var Be=0,De=$e.children;Be<De.length;Be++){var Ve=De[Be],Fe=Se(Ve);Fe!==!1&&traverseTileCubeNode(Ve,Se)}}function pick($e,Se){for(var Be={},De=0,Ve=Se;De<Ve.length;De++){var Fe=Ve[De];Fe in $e&&(Be[Fe]=$e[Fe])}return Be}function omit($e,Se){for(var Be=__assign({},$e),De=0,Ve=Se;De<Ve.length;De++){var Fe=Ve[De];Fe in Be&&delete Be[Fe]}return Be}var CUBE_GEOMETRY=new BoxBufferGeometry(1,1,1,1,1);CUBE_GEOMETRY.deleteAttribute("uv");CUBE_GEOMETRY.deleteAttribute("normal");CUBE_GEOMETRY.groups=[];CUBE_GEOMETRY.scale(-1,1,1);var CUBE_VERTEX_SHADER=`
varying vec3 worldPosition;
void main() {
  vec4 transform = vec4(position, 1.0);
  worldPosition = (modelMatrix * transform).xyz;
  gl_Position = projectionMatrix * modelViewMatrix * transform;
}
`,CUBE_RAGMENT_SHADER=`
uniform samplerCube map;
varying vec3 worldPosition;
void main() {
  gl_FragColor = textureCube(map, worldPosition);
}
`,CUBE_MATERIAL=new ShaderMaterial({uniforms:{map:{value:null}},vertexShader:CUBE_VERTEX_SHADER,fragmentShader:CUBE_RAGMENT_SHADER,depthTest:!1,depthWrite:!1,stencilWrite:!1,blending:NoBlending,lights:!1,toneMapped:!1,fog:!1}),scene$3=new Scene$1;scene$3.matrixAutoUpdate=!1;var mesh$5=new Mesh(CUBE_GEOMETRY,CUBE_MATERIAL);mesh$5.matrixAutoUpdate=!1;scene$3.add(mesh$5);function renderCubeTextureToCubeRenderTarget($e,Se,Be){CUBE_MATERIAL.uniforms.map.value=$e;var De=Be.autoClear;Be.autoClear=!1;var Ve=new CubeCamera(.1,2,Se);Ve.matrixAutoUpdate=!1,Ve.update(Be,scene$3),Be.autoClear=De,CUBE_MATERIAL.uniforms.map.value=null}var _a$5,SQRT1_2$1=(_a$5=Math.SQRT1_2)!==null&&_a$5!==void 0?_a$5:Math.sqrt(2),QUATERNION={up:new Quaternion(SQRT1_2$1,0,0,SQRT1_2$1),down:new Quaternion(-SQRT1_2$1,0,0,SQRT1_2$1),left:new Quaternion(0,SQRT1_2$1,0,SQRT1_2$1),right:new Quaternion(0,-SQRT1_2$1,0,SQRT1_2$1),front:new Quaternion(0,0,0,1),back:new Quaternion(0,1,0,0)},PLAME_GEOMETRY=function(){var $e=new Float32Array([-.5,-.5,0,.5,-.5,0,-.5,.5,0,.5,.5,0]),Se=new Float32Array([0,0,1,0,0,1,1,1]),Be=new Uint8Array([0,1,2,1,3,2]),De=new BufferGeometry;return De.setAttribute("position",new BufferAttribute($e,3)),De.setAttribute("uv",new BufferAttribute(Se,2)),De.setIndex(new BufferAttribute(Be,1)),De}(),PLANE_VERTEX_SHADER=`
varying vec2 vUv;
uniform float flipY;
void main() {
  vUv = vec2(uv.x, mix(uv.y, (1.0 - uv.y), flipY));
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,PLANE_FRAGMENT_SHADER=`
uniform sampler2D map;
varying vec2 vUv;
void main() {
  gl_FragColor = texture2D(map, vUv);
}
`,cacheMaterials=[],cameraPX=new PerspectiveCamera(90,1,.1,2);cameraPX.up.set(0,-1,0);cameraPX.lookAt(new Vector3(1,0,0));cameraPX.updateMatrix();cameraPX.matrixAutoUpdate=!1;var cameraNX=new PerspectiveCamera(90,1,.1,2);cameraNX.up.set(0,-1,0);cameraNX.lookAt(new Vector3(-1,0,0));cameraNX.updateMatrix();cameraNX.matrixAutoUpdate=!1;var cameraPY=new PerspectiveCamera(90,1,.1,2);cameraPY.up.set(0,0,1);cameraPY.lookAt(new Vector3(0,1,0));cameraPY.updateMatrix();cameraPY.matrixAutoUpdate=!1;var cameraNY=new PerspectiveCamera(90,1,.1,2);cameraNY.up.set(0,0,-1);cameraNY.lookAt(new Vector3(0,-1,0));cameraNY.updateMatrix();cameraNY.matrixAutoUpdate=!1;var cameraPZ=new PerspectiveCamera(90,1,.1,2);cameraPZ.up.set(0,-1,0);cameraPZ.lookAt(new Vector3(0,0,1));cameraPZ.updateMatrix();cameraPZ.matrixAutoUpdate=!1;var cameraNZ=new PerspectiveCamera(90,1,.1,2);cameraNZ.up.set(0,-1,0);cameraNZ.lookAt(new Vector3(0,0,-1));cameraNZ.updateMatrix();cameraNZ.matrixAutoUpdate=!1;var FACES={front:{camera:cameraPZ,index:4},back:{camera:cameraNZ,index:5},up:{camera:cameraPY,index:2},down:{camera:cameraNY,index:3},left:{camera:cameraNX,index:1},right:{camera:cameraPX,index:0}};function getMaterial(){var $e=cacheMaterials.pop();return $e||new ShaderMaterial({uniforms:{map:{value:null},flipY:{value:0}},vertexShader:PLANE_VERTEX_SHADER,fragmentShader:PLANE_FRAGMENT_SHADER,depthTest:!1,depthWrite:!1,stencilWrite:!1,blending:NoBlending,lights:!1,toneMapped:!1,fog:!1})}function releaseMaterial($e){$e.uniforms.map.value=null,cacheMaterials.push($e)}function renderTexturesToCubeRenderTarget($e,Se,Be){var De=new Scene$1;De.matrixAutoUpdate=!1;var Ve=new Group$1;Ve.scale.set(1,1,-1),De.add(Ve);for(var Fe=[],Je=new Set,Xe=0,Ke=$e;Xe<Ke.length;Xe++){var Ye=Ke[Xe];Je.add(Ye.face);var or=getMaterial();Fe.push(or),or.uniforms.map.value=Ye.texture,or.uniforms.flipY.value=Ye.flipY?1:0;var sr=new Group$1,cr=new Mesh(PLAME_GEOMETRY,or);cr.position.set(Ye.position.x+Ye.size.x/2-.5,1-(Ye.position.y+Ye.size.y/2)-.5,-.5),cr.scale.set(Ye.size.x,Ye.size.y,1),sr.quaternion.copy(QUATERNION[Ye.face]),sr.add(cr),Ve.add(sr)}var Br=Be.autoClear,tn=Be.sortObjects,en=Be.xr.enabled,an=Se.texture.generateMipmaps;Be.autoClear=!1,Be.sortObjects=!1,Be.xr.enabled=!1,Se.texture.generateMipmaps=!1;var rn=Be.getRenderTarget(),on=0;Je.forEach(function(cn){++on===Je.size&&(Se.texture.generateMipmaps=an),Be.setRenderTarget(Se,FACES[cn].index),Be.render(De,FACES[cn].camera)}),Be.setRenderTarget(rn),Be.autoClear=Br,Be.sortObjects=tn,Be.xr.enabled=en;for(var sn=0,ln=Fe;sn<ln.length;sn++){var or=ln[sn];releaseMaterial(or)}}var canUseNativeImageBitmap=function(){return!1}();function createImageBitmapLikeImage($e){$e===void 0&&($e={});var Se=Object.assign(document.createElementNS("http://www.w3.org/1999/xhtml","img"),{crossOrigin:"",close:function(){$e.onClose&&$e.onClose.call(this),this.onerror=this.onload=this.close=noop$1,this.removeAttribute("src")}});return Se}function createImageBitmapLike($e){return new Promise(function(Se,Be){var De=URL.createObjectURL($e),Ve=createImageBitmapLikeImage({onClose:function(){this.src===De&&URL.revokeObjectURL(De)}});Ve.onload=function(){Ve.src===De&&URL.revokeObjectURL(De),Ve.onload=Ve.onerror=noop$1,setTimeout(function(){Se(Ve)},10)},Ve.onerror=function(){var Fe=Ve.src;Ve.onload=Ve.onerror=noop$1,Ve.close(),Be(new Error("image load error: ".concat(Fe)))},Ve.decoding="async",Ve.src=De})}var canvasPool=[];function createCanvas($e,Se){var Be=canvasPool.shift();if(Be)return Be.width=$e,Be.height=Se,Be;var De=Object.assign(document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),{close:function(){De.close=noop$1,canvasPool.push(De)}});return De}function poolImageToTexture($e,Se){if(Se&&($e.width>Se.width||$e.height>Se.height)){var Be=createCanvas(Math.min($e.width,Se.width),Math.min($e.height,Se.height)),De=Be.getContext("2d");De.clearRect(0,0,Be.width,Be.height),De.drawImage($e,0,0,Be.width,Be.height),$e.close();var Ve=new Texture(Be);Ve.needsUpdate=!0,Ve.flipY=!0;var Fe=Ve.dispose;return Ve.dispose=function(){Be.close(),Fe.call(Ve),Ve.dispose=Fe},Ve}else{var Je=new Texture($e);Je.needsUpdate=!0,typeof ImageBitmap<"u"&&$e instanceof ImageBitmap?Je.flipY=!1:Je.flipY=!0;var Xe=Je.dispose;return Je.dispose=function(){$e.close(),Xe.call(Je),Je.dispose=Xe},Je}}function poolImagesToCubeTexture($e){var Se=new CubeTexture($e);Se.needsUpdate=!0,Se.flipY=!1;var Be=Se.dispose;return Se.dispose=function(){for(var De=0,Ve=$e;De<Ve.length;De++){var Fe=Ve[De];Fe.close()}Be.call(Se),Se.dispose=Be},Se}var sharedSortVector3$1=new Vector3,FACE_ORDER=["right","left","up","down","front","back"],TileCubeTextureTarget=function(){function $e(Se,Be,De,Ve,Fe){var Je,Xe,Ke;this.tileTree=Be,this.tileSources=De,this.options=Ve,this.renderer=Fe,this.name="",this.needsRender=!1,this.baseLevel=0,this.maxRequest=$e.DEFAULT_MAX_REQUEST,this.disposed=!1,this.loadedCubeNodes=new Set,this.loadingCubeNodes=new Set,this.drawedCubeNodes=new Set,this.baseCubeTexture=null,this._cubeRenderTarget=null,this.prepareToRender=[],this.baseCubeTexture=Se;var Ye=(Je=this.baseCubeTexture.images)!==null&&Je!==void 0?Je:[],or=Array.isArray(Ye)&&Ye[0]&&Ye[0].width||((Ke=(Xe=Ve.imageURL)===null||Xe===void 0?void 0:Xe.options)===null||Ke===void 0?void 0:Ke.size);typeof or!="number"&&(or=2048),this.baseLevel=Math.floor(or/512)-1}return Object.defineProperty($e.prototype,"cubeRenderTarget",{get:function(){return this._cubeRenderTarget},set:function(Se){var Be,De,Ve,Fe,Je,Xe;if(Se===null)throw new Error("cannot set cubeRenderTarget to null.");Se.width!==this.options.textureSize&&Se.setSize(this.options.textureSize,this.options.textureSize),Se.texture.format=(Be=this.options.format)!==null&&Be!==void 0?Be:RGBAFormat,Se.texture.minFilter=(De=this.options.minFilter)!==null&&De!==void 0?De:LinearFilter,Se.texture.magFilter=(Ve=this.options.magFilter)!==null&&Ve!==void 0?Ve:LinearFilter,Se.texture.wrapS=(Fe=this.options.wrapS)!==null&&Fe!==void 0?Fe:ClampToEdgeWrapping,Se.texture.wrapT=(Je=this.options.wrapT)!==null&&Je!==void 0?Je:ClampToEdgeWrapping,Se.texture.generateMipmaps=(Xe=this.options.generateMipmaps)!==null&&Xe!==void 0?Xe:!0,this.baseCubeTexture&&(renderCubeTextureToCubeRenderTarget(this.baseCubeTexture,Se,this.renderer),this.baseCubeTexture.dispose(),this.baseCubeTexture=null),this._cubeRenderTarget&&renderCubeTextureToCubeRenderTarget(this._cubeRenderTarget.texture,Se,this.renderer),this._cubeRenderTarget=Se},enumerable:!1,configurable:!0}),$e.prototype.requestTile=function(Se){var Be=this,De,Ve,Fe,Je,Xe,Ke,Ye=this.tileSources.filter(function(en){return en.level===Se.level})[0];if(this.baseLevel>=Se.level||!Ye)return this.loadedCubeNodes.add(Se),this.prepareToRender.push({node:Se,texture:null}),!1;var or=Ye.size,sr=Math.pow(2,Se.level)*Se.position.y,cr=Math.pow(2,Se.level)*Se.position.x,Br="".concat(((Fe=(Ve=(De=this.options.imageURL)===null||De===void 0?void 0:De.options)===null||Ve===void 0?void 0:Ve.key)!==null&&Fe!==void 0?Fe:"pano.0").replace(/^pano/,"pano_tile"),".").concat(Se.face,".").concat(Se.level,".").concat(sr,".").concat(cr),tn=__assign(__assign({},pick((Xe=(Je=this.options.imageURL)===null||Je===void 0?void 0:Je.options)!==null&&Xe!==void 0?Xe:{key:"unknown"},["format","sharpen","mappings"])),{key:Br,size:Ye.scale>=1?void 0:or*Se.size*Ye.scale,cut:Se.size===1?void 0:[or*Se.position.x,or*Se.position.y,or*Se.size,or*Se.size]});return Se.size===1&&console.warn("tile: ".concat(tn.key," should not appear.")),Se.level===1&&Ye.scale>=.5&&(tn.format==="jpg"||/\.jpg$/.test(Ye[Se.face]))&&(tn.size=void 0,tn.quality||(tn.quality=70)),this.loadingCubeNodes.add(Se),this.options.textureLoader.loadTexture(Ye[Se.face],{imageURL:{transform:(Ke=this.options.imageURL)===null||Ke===void 0?void 0:Ke.transform,options:__assign({},tn)},format:RGBAFormat,timeout:this.options.timeout,magFilter:this.options.magFilter,minFilter:this.options.minFilter,fetcher:this.options.fetcher}).then(function(en){if(Be.disposed){en.body.dispose();return}Be.prepareToRender.push({node:Se,texture:en.body}),Be.loadedCubeNodes.add(Se)}).catch(noop$1).then(function(){Be.disposed||Be.loadingCubeNodes.delete(Se)}),!0},$e.prototype.update=function(Se,Be){var De=this;if(!this.disposed){var Ve=Se.planes[5].normal,Fe=Math.max(this.maxRequest-this.loadingCubeNodes.size,0),Je=[];traverseTileCubeNode(this.tileTree,function(rn){if(rn.level>Be||!Se.intersectsBox(rn.box))return!1;!De.loadedCubeNodes.has(rn)&&!De.loadingCubeNodes.has(rn)&&Je.push(rn)}),Je.sort(function(rn,on){return rn.level!==on.level?rn.level-on.level:rn.box.getCenter(sharedSortVector3$1).angleTo(Ve)-on.box.getCenter(sharedSortVector3$1).angleTo(Ve)});for(var Xe=0,Ke=Je;Xe<Ke.length;Xe++){var Ye=Ke[Xe];if(Fe<=0)break;var or=this.requestTile(Ye);or&&Fe--}if(this.cubeRenderTarget&&this.prepareToRender.length){this.prepareToRender.sort(function(rn,on){return rn.node.level-on.node.level});for(var sr=[],cr=0;cr<this.prepareToRender.length;cr++){var Br=this.prepareToRender[cr],Ye=Br.node,tn=Br.texture;(Ye.parent===null||this.drawedCubeNodes.has(Ye.parent))&&(this.drawedCubeNodes.add(Ye),tn&&sr.push({face:Ye.face,position:Ye.position,size:new Vector2(Ye.size,Ye.size),texture:tn,flipY:!tn.flipY}),this.prepareToRender.splice(cr,1),cr--)}if(sr.length){renderTexturesToCubeRenderTarget(sr,this.cubeRenderTarget,this.renderer);for(var en=0,an=sr;en<an.length;en++){var tn=an[en];tn.texture.dispose()}this.needsRender=!0}}}},Object.defineProperty($e.prototype,"tilePending",{get:function(){return this.loadingCubeNodes.size},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"texture",{get:function(){if(!this._cubeRenderTarget)throw new Error("cubeRenderTarget never set.");return this._cubeRenderTarget.texture},enumerable:!1,configurable:!0}),$e.prototype.dispose=function(){if(!this.disposed){this.disposed=!0,this.baseCubeTexture&&(this.baseCubeTexture.dispose(),this.baseCubeTexture=null),this.loadingCubeNodes.clear(),this.loadedCubeNodes.clear();for(var Se=0,Be=this.prepareToRender;Se<Be.length;Se++){var De=Be[Se];De.texture&&De.texture.dispose()}this.prepareToRender.length=0}},$e.DEFAULT_MAX_REQUEST=3,$e}(),TextureLoader=function(){function $e(){}return $e.prototype.loadTexture=function(Se,Be,De,Ve,Fe,Je){var Xe,Ke,Ye,or,sr,cr,Br;De===void 0&&(De=noop$1),Ve===void 0&&(Ve=noop$1),Fe===void 0&&(Fe=noop$1);var tn={};typeof Be.flipY<"u"&&(tn.flipY=Be.flipY),typeof Be.format<"u"&&(tn.format=Be.format),typeof Be.encoding<"u"&&(tn.encoding=Be.encoding),tn.generateMipmaps=(Xe=Be.generateMipmaps)!==null&&Xe!==void 0?Xe:!1,tn.minFilter=(Ke=Be.minFilter)!==null&&Ke!==void 0?Ke:LinearFilter,tn.magFilter=(Ye=Be.magFilter)!==null&&Ye!==void 0?Ye:LinearFilter;var en=(sr=(or=Be.imageURL)===null||or===void 0?void 0:or.options)!==null&&sr!==void 0?sr:{key:"unknown"};Se=applyImageURLOptions(Se,(cr=Be.imageURL)===null||cr===void 0?void 0:cr.transform,en);var an=getProtocol(Se),rn=(Br=Be.viaAjax)!==null&&Br!==void 0?Br:canUseNativeImageBitmap,on=isJsonpSource(Se),sn=/^https?:/.test(an);if(on?rn=!0:sn||(rn=!1),rn){var ln=null,cn="blob";return Be.fetcher.ajax(Se,{timeout:Be.timeout,responseType:cn},void 0,void 0,Fe).then(function(An){return createImageBitmapLike(An.body)}).then(function(An){return poolImageToTexture(An,Be.maxSize)}).then(function(An){return Object.assign(An,tn),An}).then(function(An){var xn={meta:ln,body:An};return De(xn),xn}).catch(function(An){return Ve(An),Promise.reject(An)})}else{var hn=null,mn;return Promise.resolve().then(function(){return createImageBitmapLikeImage()}).then(function(An){return mn=An,Be.fetcher.loadImage(Se,{timeout:Be.timeout},void 0,void 0,Fe,An)}).then(function(An){return hn=An.meta,poolImageToTexture(An.body,Be.maxSize)}).then(function(An){return Object.assign(An,tn),An}).then(function(An){var xn={meta:hn,body:An};return De(xn),xn}).catch(function(An){return mn&&mn.close(),Ve(An),Promise.reject(An)})}},$e.prototype.loadCubeTexture=function(Se,Be,De,Ve,Fe,Je){var Xe,Ke,Ye,or,sr,cr,Br;De===void 0&&(De=noop$1),Ve===void 0&&(Ve=noop$1),Fe===void 0&&(Fe=noop$1);var tn={};typeof Be.format<"u"&&(tn.format=Be.format),tn.generateMipmaps=(Xe=Be.generateMipmaps)!==null&&Xe!==void 0?Xe:!1,tn.minFilter=(Ke=Be.minFilter)!==null&&Ke!==void 0?Ke:LinearFilter,tn.magFilter=(Ye=Be.magFilter)!==null&&Ye!==void 0?Ye:LinearFilter;for(var en=[Se[FACE_ORDER[0]],Se[FACE_ORDER[1]],Se[FACE_ORDER[2]],Se[FACE_ORDER[3]],Se[FACE_ORDER[4]],Se[FACE_ORDER[5]]],an=[],rn=[0,0,0,0,0,0],on=[],sn=function(cn){var hn=(sr=(or=Be.imageURL)===null||or===void 0?void 0:or.options)!==null&&sr!==void 0?sr:{key:"unknown"},mn=applyImageURLOptions(en[cn],(cr=Be.imageURL)===null||cr===void 0?void 0:cr.transform,__assign(__assign({},hn),{key:hn.key+"."+FACE_ORDER[cn]})),An=getProtocol(mn),xn=function(Cn){rn[cn]=Cn,Fe(rn.reduce(function(Mn,Bn){return Mn+Bn},0)/6)},pn=(Br=Be.viaAjax)!==null&&Br!==void 0?Br:!1,dn=/^https?:$/.test(An),fn=isJsonpSource(mn);if(fn?pn=!0:dn||(pn=!1),pn){var yn="blob",Sn=Be.fetcher.ajax(mn,{timeout:Be.timeout,responseType:yn},void 0,void 0,xn).then(function(Cn){return on[cn]=Cn.meta,createImageBitmapLike(Cn.body)});an.push(Sn)}else{var gn,Sn=Promise.resolve().then(function(){return createImageBitmapLikeImage()}).then(function(Mn){return gn=Mn,Be.fetcher.loadImage(mn,{timeout:Be.timeout},void 0,void 0,xn,Mn)}).then(function(Mn){return on[cn]=Mn.meta,Mn.body}).catch(function(Mn){return gn&&gn.close(),Promise.reject(Mn)});an.push(Sn)}},ln=0;ln<6;ln++)sn(ln);return Promise.all(an).then(function(cn){return poolImagesToCubeTexture(cn)}).then(function(cn){return Object.assign(cn,__assign({encoding:sRGBEncoding},tn)),cn}).then(function(cn){var hn={body:cn,meta:on};return De(hn),hn}).catch(function(cn){for(var hn=0,mn=an;hn<mn.length;hn++){var An=mn[hn];An.then(function(xn){return xn.close()}).catch(noop$1)}return Ve(cn),Promise.reject(cn)})},$e.prototype.loadTiledCubeTexture=function(Se,Be,De,Ve,Fe,Je,Xe){var Ke=this;return Ve===void 0&&(Ve=noop$1),Fe===void 0&&(Fe=noop$1),Je===void 0&&(Je=noop$1),new Promise(function(Ye,or){var sr,cr;Ke.loadCubeTexture(Se,{imageURL:{transform:(sr=De.imageURL)===null||sr===void 0?void 0:sr.transform,options:(cr=De.imageURL)===null||cr===void 0?void 0:cr.options},format:RGBAFormat,viaAjax:De.viaAjax,timeout:De.timeout,fetcher:De.fetcher,magFilter:De.magFilter,minFilter:De.minFilter,generateMipmaps:De.generateMipmaps},function(Br){var tn,en=Br.meta,an=Br.body,rn=(tn=De.tileMaxLevel)!==null&&tn!==void 0?tn:2,on=Math.max(1024*rn,512),sn=createTileCubeTree(rn),ln=new TileCubeTextureTarget(an,sn,Be,{textureSize:on,textureLoader:Ke,imageURL:De.imageURL,magFilter:De.magFilter,minFilter:De.minFilter,generateMipmaps:De.generateMipmaps,timeout:De.timeout,fetcher:De.fetcher},Xe),cn={meta:en,body:ln};Ve(cn),Ye(cn)},function(Br){Fe(Br),or(Br)},Je,Xe).catch(noop$1)})},$e}();const meshNoneVertexShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("n\bv{t-rpA-Sv{ny]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{H0v{pyqr-Ip|zz|{K0v{pyqr-Iz|}untrl}nlrr\x07K0v{pyqr-Ixv{{v{tl}nlrr\x07K0v{pyqr-Iy|tqr}uosl}nlrr\x07K0v{pyqr-Ipyv}}v{tl}yn{rl}nlrr\x07KZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--0v{pyqr-Ixv{onrlrr\x07K--0v{pyqr-Iortv{lrr\x07K--0v{pyqr-Iz|}untrlrr\x07K--0v{pyqr-Ixv{{v{tlrr\x07K--0v{pyqr-I}|wrplrr\x07K--0v{pyqr-Iy|tqr}uoslrr\x07K--0v{pyqr-Ipyv}}v{tl}yn{rlrr\x07K--Sv{ny]|vv|{-J-rpA5n{s|zrq9->;=6H--0vsqrs-b`RlV[`aN[PV[T----Sv{ny]|vv|{-J-v{n{prZnv\x07-7-Sv{ny]|vv|{H--0r{qvs--Sv{ny]|vv|{-J-z|qryZnv\x07-7-Sv{ny]|vv|{H--zn@-pnzrn_|nv|{Znv\x07-J-zn@5vrZnv\x07h=jh=j9-vrZnv\x07h>jh=j9-vrZnv\x07h?jh=j9-vrZnv\x07h=jh>j9-vrZnv\x07h>jh>j9-vrZnv\x07h?jh>j9-vrZnv\x07h=jh?j9-vrZnv\x07h>jh?j9-vrZnv\x07h?jh?j6H--PnzrnQvrpv|{-J-{|znyv	r5pnzrn_|nv|{Znv\x07-7-rp@5=;=9-=;=9-:>;=66H--0v{pyqr-I|yq}|lrr\x07K--0v{pyqr-Is|tlrr\x07K--ZNV[lR[Q\f"),meshNoneFragmentShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("0qrsv{r-OYNPXlP\\Y\\_-rpA5=;=EC9-=;>=C9-=;>AF9->;=6{vs|z-nz}yrPor-}n{|=lzn}H{vs|z-znA-}n{|=lznv\x07H{vs|z-sy|n-}n{|=l	||zH0vs-qrsv{rq5b`RlYbZV[N[PR6--{vs|z-nz}yrPor-}n{|=lyzv{n{prZn}H0r{qvs{vs|z-nz}yrPor-}n{|>lzn}H{vs|z-znA-}n{|>lznv\x07H{vs|z-sy|n-}n{|>l	||zH0vs-qrsv{rq5b`RlYbZV[N[PR6--{vs|z-nz}yrPor-}n{|>lyzv{n{prZn}H0r{qvs{vs|z-sy|n-z|qryNy}unH{vs|z-sy|n-}|trHn\bv{t-rpA-Sv{ny]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{H{vs|z-sy|n-u|{Sy||V{qr\x07H{vs|z-rp?-r|yv|{H{vs|z-sy|n-}v\x07ry_nv|H0vs{qrs-SYNal`UNQRQ--n\bv{t-rp@-[|znyH0r{qvs0v{pyqr-Ip|zz|{K0v{pyqr-Iqvurv{tl}nlsntzr{K0v{pyqr-Is|tl}nlsntzr{K0v{pyqr-I}rpynzn}l}nlsntzr{K0v{pyqr-Iy|tqr}uosl}nlsntzr{K0v{pyqr-Ipyv}}v{tl}yn{rl}nlsntzr{Krp@-	||zcrp|5rp@-qvrpv|{9-rp@-rp|9-sy|n-	||z6-\n--sy|n-urn-J-q|5qvrpv|{9-rp|6H--rp@-q-J-qvrpv|{-7-urnH--rp@-}-J-rp|-:-qH--rp@-\0-J-}-7-	||zH--r{-{|znyv	r5q-8-\x006H\fZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--0v{pyqr-Ipyv}}v{tl}yn{rlsntzr{K--<<-JJJ-全景图-JJJ--rp@-}n{|=a|crr\x07-J-{|znyv	r5Sv{ny]|vv|{;\x07\b	-:-}n{|=lznv\x07h@j;\x07\b	6H--}n{|=a|crr\x07-J-	||zcrp|5PnzrnQvrpv|{9-}n{|=a|crr\x079-}n{|=l	||z6H--}n{|=a|crr\x07-J-}n{|=a|crr\x07-7-zn@5}n{|=lznv\x076H--rp@-}n{|>a|crr\x07-J-{|znyv	r5Sv{ny]|vv|{;\x07\b	-:-}n{|>lznv\x07h@j;\x07\b	6H--}n{|>a|crr\x07-J-	||zcrp|5PnzrnQvrpv|{9-}n{|>a|crr\x079-}n{|>l	||z6H--}n{|>a|crr\x07-J-}n{|>a|crr\x07-7-zn@5}n{|>lznv\x076H--rpA-}n{|P|y|H--rpA-}n{|=P|y|-J-r\x07rPor5}n{|=lzn}9-}n{|=a|crr\x076H--rpA-}n{|>P|y|-J-r\x07rPor5}n{|>lzn}9-}n{|>a|crr\x076H--0vs-qrsv{rq5b`RlYbZV[N[PR6----}n{|=P|y|;n-J->;=-:-r\x07rPor5}n{|=lyzv{n{prZn}9-}n{|=a|crr\x076;H----}n{|>P|y|;n-J->;=-:-r\x07rPor5}n{|>lyzv{n{prZn}9-}n{|>a|crr\x076;H--0r{qvs--0vs-qrsv{rq5b`RlOYNPXla_N[`VaV\\[6----sy|n-oynpx]|tr-J-np|5:?;=-7-}|tr-8->;=6H----}n{|P|y|-J-zv\x075}n{|=P|y|9-OYNPXlP\\Y\\_9-zv{5>;=9-oynpx]|tr66H----}n{|P|y|-J-zv\x075}n{|P|y|9-}n{|>P|y|9-zn\x075=;=9-oynpx]|tr-:-]V-8->;=66H--0ryvs-qrsv{rq5b`Rl`]_RNQla_N[`VaV\\[6----rp?-prr{Pr{rP||q-J-r|yv|{-7-}v\x07ry_nv|-<-?;=H----sy|n-n{vv|{_nqv-J-qvn{pr5rp?5=;=9-=;=69-prr{Pr{rP||q6-7->;?H----sy|n-n{vv|{]|tr-J--qvn{pr5tylSntP||q;\x07\b9-prr{Pr{rP||q6-<-n{vv|{_nqvH----}n{|P|y|-J-zv\x075}n{|=P|y|9-}n{|>P|y|9-z||ur}5=;=9-=;?9-}|tr-:-n{vv|{]|tr66H--0ryr----}n{|P|y|-J-zv\x075}n{|=P|y|9-}n{|>P|y|9-}|tr6H--0r{qvs--tylSntP|y|-J-zv\x075}n{|P|y|9-rpA5}n{|P|y|;to9-=;=69-pynz}5z|qryNy}un-7-@=;=9-=;=9->;=66H--<<-JJJJJJJJJJJJJJJJ--ZNV[lZ\\QRYlP\\Y\\_--0v{pyqr-Is|tlsntzr{K--0v{pyqr-I}rzyv}yvrqlny}unlsntzr{K--0v{pyqr-Iqvurv{tlsntzr{K--ZNV[lR[Q\f"),meshBasicVertexShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("0vs-qrsv{rq5b`RlRQY6--n\bv{t-sy|n-Y|tQr}uH0r{qvs0vs-qrsv{rq5b`RlcR_aRelZN_X6--nvor-sy|n-znxH0r{qvsn\bv{t-sy|n-V_||sZnxHn\bv{t-rpA-Sv{ny]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{Hn\bv{t-rp@-cvr]|vv|{H0vs{qrs-SYNal`UNQRQ--n\bv{t-rp@-[|znyH--0vsqrs-b`RlaN[TR[a----n\bv{t-rp@-an{tr{H----n\bv{t-rp@-Ovn{tr{H--0r{qvs0r{qvs0v{pyqr-Ip|zz|{K0v{pyqr-Il}nlrr\x07K0v{pyqr-I?l}nlrr\x07K0v{pyqr-Ir{zn}l}nlrr\x07K0v{pyqr-Ip|y|l}nlrr\x07K0v{pyqr-Is|tl}nlrr\x07K0v{pyqr-Iz|}untrl}nlrr\x07K0v{pyqr-Ixv{{v{tl}nlrr\x07K0v{pyqr-Iy|tqr}uosl}nlrr\x07K0v{pyqr-Ipyv}}v{tl}yn{rl}nlrr\x07KZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--0v{pyqr-Ilrr\x07K--0v{pyqr-I?lrr\x07K--0v{pyqr-Ip|y|lrr\x07K--0v{pyqr-Ixv{onrlrr\x07K--0v{pyqr-Iortv{{|znylrr\x07K--0v{pyqr-Iz|}u{|znylrr\x07K--0v{pyqr-Ixv{{|znylrr\x07K--0v{pyqr-Iqrsny{|znylrr\x07K--0vs{qrs-SYNal`UNQRQ-<<-[|zny-p|z}rq-vu-qrvnvr-ur{-SYNal`UNQRQ--[|zny-J-{|znyv	r5-n{s|zrq[|zny-6H--0r{qvs--0v{pyqr-Iortv{lrr\x07K--0v{pyqr-Iz|}untrlrr\x07K--0v{pyqr-Ixv{{v{tlrr\x07K--0v{pyqr-I}|wrplrr\x07K--0v{pyqr-Iy|tqr}uoslrr\x07K--0v{pyqr-Ipyv}}v{tl}yn{rlrr\x07K--cvr]|vv|{-J-:z]|vv|{;\x07\b	H--Sv{ny]|vv|{-J-rpA5n{s|zrq9->;=6H--0vsqrs-b`RlV[`aN[PV[T----Sv{ny]|vv|{-J-v{n{prZnv\x07-7-Sv{ny]|vv|{H--0r{qvs--Sv{ny]|vv|{-J-z|qryZnv\x07-7-Sv{ny]|vv|{H--zn@-pnzrn_|nv|{Znv\x07-J-zn@5vrZnv\x07h=jh=j9-vrZnv\x07h>jh=j9-vrZnv\x07h?jh=j9-vrZnv\x07h=jh>j9-vrZnv\x07h>jh>j9-vrZnv\x07h?jh>j9-vrZnv\x07h=jh?j9-vrZnv\x07h>jh?j9-vrZnv\x07h?jh?j6H--PnzrnQvrpv|{-J-{|znyv	r5pnzrn_|nv|{Znv\x07-7-rp@5=;=9-=;=9-:>;=66H--0vs-qrsv{rq5b`RlRQY6----Y|tQr}u-J-y|t?5:z]|vv|{;	6H--0r{qvs--V_||sZnx-J-=;=H--0vs-qrsv{rq5b`RlcR_aRelZN_X6----V_||sZnx-J-r}5no5znx-:->;=69-=;>6H--0r{qvs--0v{pyqr-I|yq}|lrr\x07K--0v{pyqr-Ir{zn}lrr\x07K--0v{pyqr-Is|tlrr\x07K--ZNV[lR[Q\f"),meshBasicFragmentShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("0qrsv{r-OYNPXlP\\Y\\_-rpA5=;=EC9-=;>=C9-=;>AF9->;=6{vs|z-sy|n-sy||V{qr\x07H{vs|z-nz}yrPor-}n{|=lzn}H{vs|z-znA-}n{|=lznv\x07H{vs|z-sy|n-}n{|=l	||zH0vs-qrsv{rq5b`RlYbZV[N[PR6--{vs|z-nz}yrPor-}n{|=lyzv{n{prZn}H0r{qvs{vs|z-nz}yrPor-}n{|>lzn}H{vs|z-znA-}n{|>lznv\x07H{vs|z-sy|n-}n{|>l	||zH0vs-qrsv{rq5b`RlYbZV[N[PR6--{vs|z-nz}yrPor-}n{|>lyzv{n{prZn}H0r{qvs{vs|z-sy|n-z|qryNy}unH{vs|z-sy|n-}|trH0vs-qrsv{rq5b`RlP\\Y\\_lP\\[`aN[a6--{vs|z-rp@-p|{n{P|y|H0r{qvs0vs-qrsv{rq5b`RlP\\Y\\_lNYaVabQR6--{vs|z-nz}yr?Q-tnqvr{ar\x07rH0r{qvsp-Pyv}}r-\n--znA-znv\x07V{rrH--sy|n-sy||V{qr\x07H\fH0vs-[bZlPYV]]R_`-K-=--{vs|z-Pyv}}r-pyv}}rh[bZlPYV]]R_`jH0r{qvs0vs-qrsv{rq5b`RlRQY6--n\bv{t-sy|n-Y|tQr}uH0r{qvsn\bv{t-rpA-Sv{ny]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{Hn\bv{t-rp@-cvr]|vv|{Hn\bv{t-sy|n-V_||sZnxH{vs|z-sy|n-u|{Sy||V{qr\x07H{vs|z-rp?-r|yv|{H{vs|z-sy|n-}v\x07ry_nv|H{vs|z-rp@-qvssrH{vs|z-sy|n-p|y|Ny}unH{vs|z-sy|n-|}npv\bH{vs|z-sy|n-ovtu{rH{vs|z-rp@-z|qryO|{qv{tZn\x07H{vs|z-rp@-z|qryO|{qv{tZv{H<<u调整{vs|z-sy|n-p|y|`nnv|{H{vs|z-sy|n-p|y|Ovtu{rH0vs{qrs-SYNal`UNQRQ--n\bv{t-rp@-[|znyH--0vsqrs-b`RlaN[TR[a----n\bv{t-rp@-an{tr{H----n\bv{t-rp@-Ovn{tr{H--0r{qvs0r{qvs0v{pyqr-Ip|zz|{K0v{pyqr-Iqvurv{tl}nlsntzr{K0v{pyqr-Ip|y|l}nlsntzr{K0v{pyqr-Il}nlsntzr{K0v{pyqr-I?l}nlsntzr{K0v{pyqr-Izn}l}nlsntzr{K0v{pyqr-Iny}unzn}l}nlsntzr{K0v{pyqr-In|zn}l}nlsntzr{K0v{pyqr-Iyvtuzn}l}nlsntzr{K0v{pyqr-Ir{zn}lp|zz|{l}nlsntzr{K0v{pyqr-Ir{zn}l}nlsntzr{K0v{pyqr-Iporllrsyrpv|{lsntzr{K0v{pyqr-Is|tl}nlsntzr{K0v{pyqr-I}rpynzn}l}nlsntzr{K0v{pyqr-Iy|tqr}uosl}nlsntzr{K0v{pyqr-Ipyv}}v{tl}yn{rl}nlsntzr{Krp@-	||zcrp|5rp@-qvrpv|{9-rp@-rp|9-sy|n-	||z6-\n--sy|n-urn-J-q|5qvrpv|{9-rp|6H--rp@-q-J-qvrpv|{-7-urnH--rp@-}-J-rp|-:-qH--rp@-\0-J-}-7-	||zH--r{-{|znyv	r5q-8-\x006H\frp@-to?u5rp@-p6-\n----rpA-X-J-rpA5=;=9-:>;=-<-@;=9-?;=-<-@;=9-:>;=6H----rpA-}-J-zv\x075rpA5p;ot9-X;	69-rpA5p;to9-X;\x07\b69-r}5p;o9-p;t66H----rpA-\0-J-zv\x075rpA5};\x07\b9-p;69-rpA5p;9-};\b	\x0769-r}5};\x079-p;66H----sy|n-q-J-\0;\x07-:-zv{5\0;9-\0;\b6H----sy|n-r-J->;=r:>=H----r{-rp@5no5\0;	-8-5\0;-:-\0;\b6-<-5C;=-7-q-8-r669-q-<-5\0;\x07-8-r69-\0;\x076H\frp@-u?to5rp@-p6-\n----rpA-X-J-rpA5>;=9-?;=-<-@;=9->;=-<-@;=9-@;=6H----rp@-}-J-no5snp5p;\x07\x07\x07-8-X;\x07\b	6-7-C;=-:-X;6H----r{-p;	-7-zv\x075X;\x07\x07\x079-pynz}5}-:-X;\x07\x07\x079-=;=9->;=69-p;\b6H\frp@-trP|y|O\bUrvtu5nz}yr?Q-tnqvr{ar\x07r9-rpA-Sv{ny]|vv|{6-\n--sy|n--J-5Sv{ny]|vv|{;\b-:-z|qryO|{qv{tZv{;\b6-<-5z|qryO|{qv{tZn\x07;\b-:-z|qryO|{qv{tZv{;\b6H--r{-r\x07r?Q5tnqvr{ar\x07r9-rp?59-=;B66;toH\fZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--<<-JJJ-顶部裁切-JJJ--sy|n-||sP]|tr-J-}|5pynz}5:PnzrnQvrpv|{;\b9-=;=9->;=69-@;=6H--vs-5----V_||sZnx-K-=;B-33----Sv{ny]|vv|{;\b-K-z|qryO|{qv{tZn\x07;\b-:-||sP]|tr-7-5z|qryO|{qv{tZn\x07;\b-:-z|qryO|{qv{tZv{;\b6--6-\n----qvpnqH--\f--<<-JJJJJJJJJJJJJJ--<<-JJJ-前置裁切计算-JJJ--0vs-[bZlPYV]]R_`-K-=----o||y-pyv}}rqH----rpA-pyv}}r]|vv|{H----0}ntzn-{|yyly||}ln----s|-5-v{-v-J-=H-v-I-[bZlPYV]]R_`H-v-88-6-\n------pyv}}r]|vv|{-J-pyv}}rh-v-j;znv\x07V{rr-7-Sv{ny]|vv|{H------pyv}}rq-J-5pyv}}rh-v-j;sy||V{qr\x07-I-=;=-\v\v-no5sy||V{qr\x07-:-pyv}}rh-v-j;sy||V{qr\x076-I->;=6H------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;\x07-K-:=;B-33-pyv}}r]|vv|{;\x07-I-=;BH------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;\b-K-:=;B-33-pyv}}r]|vv|{;\b-I-=;BH------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;	-K-:=;B-33-pyv}}r]|vv|{;	-I-=;BH------vs-5pyv}}rq6-\n--------qvpnqH------\f----\f----0}ntzn-{|yyly||}lr{q--0r{qvs--<<-JJJJJJJJJJJJJJJJJJ--0v{pyqr-Ipyv}}v{tl}yn{rlsntzr{K--rpA-qvssrP|y|-J-rpA5-qvssr9-p|y|Ny}un-7-|}npv\b-6H--<<-JJJ-高度色-JJJ--0vs-qrsv{rq5b`RlP\\Y\\_lNYaVabQR6----qvssrP|y|;to-J-trP|y|O\bUrvtu5tnqvr{ar\x07r9-Sv{ny]|vv|{6H--0r{qvs--<<-JJJJJJJJJJJ--<<-JJJ-纯色-JJJ--0vs-qrsv{rq5b`RlP\\Y\\_lP\\[`aN[a6----qvssrP|y|;to-J-p|{n{P|y|H--0r{qvs--<<-JJJJJJJJJJJ--0v{pyqr-Iy|tqr}uoslsntzr{K--0v{pyqr-Izn}lsntzr{K--0v{pyqr-Ip|y|lsntzr{K--0v{pyqr-Iny}unzn}lsntzr{K--0v{pyqr-Iny}unrlsntzr{K--0v{pyqr-I}rpynzn}lsntzr{K--0v{pyqr-I{|znylsntzr{lortv{K--_rsyrprqYvtu-rsyrprqYvtu-J-_rsyrprqYvtu5-rp@5-=;=-69-rp@5-=;=-69-rp@5-=;=-69-rp@5-=;=-6-6H--<<-nppzynv|{-5onxrq-v{qvrp-yvtuv{t-|{y\b6--0vsqrs-b`RlYVTUaZN]----rpA-yvtuZn}ar\x07ryJ-r\x07r?Q5-yvtuZn}9-b?-6H----rsyrprqYvtu;v{qvrpQvssr-8J-yvtuZn}ar\x07rya|Yv{rn5-yvtuZn}ar\x07ry-6;to-7-yvtuZn}V{r{v\bH--0ryr----rsyrprqYvtu;v{qvrpQvssr-8J-rp@5->;=-6H--0r{qvs--<<-z|qynv|{--0v{pyqr-In|zn}lsntzr{K--rsyrprqYvtu;v{qvrpQvssr-7J-qvssrP|y|;toH--rp@-|t|v{tYvtu-J-rsyrprqYvtu;v{qvrpQvssrH--0v{pyqr-Ir{zn}lsntzr{K--tylSntP|y|-J-rpA5-|t|v{tYvtu9-qvssrP|y|;n-6H--<<-JJJ-楼层显示-JJJ--sy|n-sy||\\}npv\b-J->;=H--vs-5u|{Sy||V{qr\x07-K-:=;=>-33-no5sy||V{qr\x07-:-u|{Sy||V{qr\x076-K-=;FF6-\n----sy||\\}npv\b-J-=;?-7-zv{55>;=-8-PnzrnQvrpv|{;\b69->;=6H--\f--tylSntP|y|;n-J-tylSntP|y|;n-7-sy||\\}npv\b-7-ovtu{rH--<<-JJJJJJJJJJJJJJ--ZNV[lZ\\QRYlP\\Y\\_--<<色调映射-色彩空间转换--0v{pyqr-I|{rzn}}v{tlsntzr{K--0v{pyqr-Ir{p|qv{tlsntzr{K--<<-JJJ-颜色增益调整-JJJ--rp@-toP|y|-J-tylSntP|y|;toH--rp@-uP|y|-J-to?u5toP|y|6H--uP|y|;\b-8J-p|y|`nnv|{H--uP|y|;	-8J-p|y|Ovtu{rH--tylSntP|y|;to-J-u?to5uP|y|6H--<<-JJJ-全景图-JJJ--rp@-}n{|=a|crr\x07-J-{|znyv	r5Sv{ny]|vv|{;\x07\b	-:-}n{|=lznv\x07h@j;\x07\b	6H--}n{|=a|crr\x07-J-	||zcrp|5PnzrnQvrpv|{9-}n{|=a|crr\x079-}n{|=l	||z6H--}n{|=a|crr\x07-J-}n{|=a|crr\x07-7-zn@5}n{|=lznv\x076H--rp@-}n{|>a|crr\x07-J-{|znyv	r5Sv{ny]|vv|{;\x07\b	-:-}n{|>lznv\x07h@j;\x07\b	6H--}n{|>a|crr\x07-J-	||zcrp|5PnzrnQvrpv|{9-}n{|>a|crr\x079-}n{|>l	||z6H--}n{|>a|crr\x07-J-}n{|>a|crr\x07-7-zn@5}n{|>lznv\x076H--rpA-}n{|P|y|H--rpA-}n{|=P|y|-J-r\x07rPor5}n{|=lzn}9-}n{|=a|crr\x076H--rpA-}n{|>P|y|-J-r\x07rPor5}n{|>lzn}9-}n{|>a|crr\x076H--0vs-qrsv{rq5b`RlYbZV[N[PR6----}n{|=P|y|;n-J->;=-:-r\x07rPor5}n{|=lyzv{n{prZn}9-}n{|=a|crr\x076;H----}n{|>P|y|;n-J->;=-:-r\x07rPor5}n{|>lyzv{n{prZn}9-}n{|>a|crr\x076;H--0r{qvs--0vs-qrsv{rq5b`RlOYNPXla_N[`VaV\\[6----sy|n-oynpx]|tr-J-np|5:?;=-7-}|tr-8->;=6H----}n{|P|y|-J-zv\x075}n{|=P|y|9-OYNPXlP\\Y\\_9-zv{5>;=9-oynpx]|tr66H----}n{|P|y|-J-zv\x075}n{|P|y|9-}n{|>P|y|9-zn\x075=;=9-oynpx]|tr-:-]V-8->;=66H--0ryvs-qrsv{rq5b`Rl`]_RNQla_N[`VaV\\[6----rp?-prr{Pr{rP||q-J-r|yv|{-7-}v\x07ry_nv|-<-?;=H----sy|n-n{vv|{_nqv-J-qvn{pr5rp?5=;=9-=;=69-prr{Pr{rP||q6-7->;?H----sy|n-n{vv|{]|tr-J-qvn{pr5tylSntP||q;\x07\b9-prr{Pr{rP||q6-<-n{vv|{_nqvH----}n{|P|y|-J-zv\x075}n{|=P|y|9-}n{|>P|y|9-z||ur}5=;=9-=;?9-}|tr-:-n{vv|{]|tr66H--0ryr----}n{|P|y|-J-zv\x075}n{|=P|y|9-}n{|>P|y|9-}|tr6H--0r{qvs--tylSntP|y|-J-zv\x075}n{|P|y|9-tylSntP|y|9-z|qryNy}un6H--<<-JJJJJJJJJJJJJ--0v{pyqr-Is|tlsntzr{K--0v{pyqr-I}rzyv}yvrqlny}unlsntzr{K--0v{pyqr-Iqvurv{tlsntzr{K--0vs-qrsv{rq5b`RlRQY6----tylSntP|y|;n-J-Y|tQr}uH--0r{qvs--ZNV[lR[Q\f"),meshPhongVertexShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("0qrsv{r-]U\\[T0vs-qrsv{rq5b`RlRQY6--n\bv{t-sy|n-Y|tQr}uH0r{qvs0vs-qrsv{rq5b`RlcR_aRelZN_X6--nvor-sy|n-znxH0r{qvsn\bv{t-sy|n-V_||sZnxHn\bv{t-rpA-Sv{ny]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{Hn\bv{t-rp@-cvr]|vv|{H0vs{qrs-SYNal`UNQRQ--n\bv{t-rp@-[|znyH--0vsqrs-b`RlaN[TR[a----n\bv{t-rp@-an{tr{H----n\bv{t-rp@-Ovn{tr{H--0r{qvs0r{qvs0v{pyqr-Ip|zz|{K0v{pyqr-Il}nlrr\x07K0v{pyqr-I?l}nlrr\x07K0v{pyqr-Iqv}ynprzr{zn}l}nlrr\x07K0v{pyqr-Ir{zn}l}nlrr\x07K0v{pyqr-Ip|y|l}nlrr\x07K0v{pyqr-Is|tl}nlrr\x07K0v{pyqr-Iz|}untrl}nlrr\x07K0v{pyqr-Ixv{{v{tl}nlrr\x07K0v{pyqr-Iunq|zn}l}nlrr\x07K0v{pyqr-Iy|tqr}uosl}nlrr\x07K0v{pyqr-Ipyv}}v{tl}yn{rl}nlrr\x07KZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--0v{pyqr-Ilrr\x07K--0v{pyqr-I?lrr\x07K--0v{pyqr-Ip|y|lrr\x07K--0v{pyqr-Iortv{{|znylrr\x07K--0v{pyqr-Iz|}u{|znylrr\x07K--0v{pyqr-Ixv{onrlrr\x07K--0v{pyqr-Ixv{{|znylrr\x07K--0v{pyqr-Iqrsny{|znylrr\x07K--0vs{qrs-SYNal`UNQRQ-<<-[|zny-p|z}rq-vu-qrvnvr-ur{-SYNal`UNQRQ----[|zny-J-{|znyv	r5-n{s|zrq[|zny-6H----0vsqrs-b`RlaN[TR[a------an{tr{-J-{|znyv	r5-n{s|zrqan{tr{-6H------Ovn{tr{-J-{|znyv	r5-p|5-[|zny9-an{tr{-6-7-n{tr{;-6H----0r{qvs--0r{qvs--0v{pyqr-Iortv{lrr\x07K--0v{pyqr-Iz|}untrlrr\x07K--0v{pyqr-Ixv{{v{tlrr\x07K--0v{pyqr-Iqv}ynprzr{zn}lrr\x07K--0v{pyqr-I}|wrplrr\x07K--0v{pyqr-Iy|tqr}uoslrr\x07K--0v{pyqr-Ipyv}}v{tl}yn{rlrr\x07K--cvr]|vv|{-J-:-z]|vv|{;\x07\b	H--Sv{ny]|vv|{-J-rpA5n{s|zrq9->;=6H--0vsqrs-b`RlV[`aN[PV[T----Sv{ny]|vv|{-J-v{n{prZnv\x07-7-Sv{ny]|vv|{H--0r{qvs--Sv{ny]|vv|{-J-z|qryZnv\x07-7-Sv{ny]|vv|{H--zn@-pnzrn_|nv|{Znv\x07-J-zn@5vrZnv\x07h=jh=j9-vrZnv\x07h>jh=j9-vrZnv\x07h?jh=j9-vrZnv\x07h=jh>j9-vrZnv\x07h>jh>j9-vrZnv\x07h?jh>j9-vrZnv\x07h=jh?j9-vrZnv\x07h>jh?j9-vrZnv\x07h?jh?j6H--PnzrnQvrpv|{-J-{|znyv	r5pnzrn_|nv|{Znv\x07-7-rp@5=;=9-=;=9-:>;=66H--0vs-qrsv{rq5b`RlRQY6----Y|tQr}u-J-y|t?5:z]|vv|{;	6H--0r{qvs--V_||sZnx-J-=;=H--0vs-qrsv{rq5b`RlcR_aRelZN_X6----V_||sZnx-J-r}5no5znx-:->;=69-=;>6H--0r{qvs--0v{pyqr-I|yq}|lrr\x07K--0v{pyqr-Ir{zn}lrr\x07K--0v{pyqr-Iunq|zn}lrr\x07K--0v{pyqr-Is|tlrr\x07K--ZNV[lR[Q\f"),meshPhongFragmentShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("0qrsv{r-]U\\[T0qrsv{r-OYNPXlP\\Y\\_-rpA5=;=EC9-=;>=C9-=;>AF9->;=6{vs|z-sy|n-sy||V{qr\x07H{vs|z-nz}yrPor-}n{|=lzn}H{vs|z-znA-}n{|=lznv\x07H{vs|z-sy|n-}n{|=l	||zH0vs-qrsv{rq5b`RlYbZV[N[PR6--{vs|z-nz}yrPor-}n{|=lyzv{n{prZn}H0r{qvs{vs|z-nz}yrPor-}n{|>lzn}H{vs|z-znA-}n{|>lznv\x07H{vs|z-sy|n-}n{|>l	||zH0vs-qrsv{rq5b`RlYbZV[N[PR6--{vs|z-nz}yrPor-}n{|>lyzv{n{prZn}H0r{qvs{vs|z-sy|n-z|qryNy}unH{vs|z-sy|n-}|trH0vs-qrsv{rq5b`RlP\\Y\\_lP\\[`aN[a6--{vs|z-rp@-p|{n{P|y|H0r{qvs0vs-qrsv{rq5b`RlP\\Y\\_lNYaVabQR6--{vs|z-nz}yr?Q-tnqvr{ar\x07rH0r{qvsp-Pyv}}r-\n--znA-znv\x07V{rrH--sy|n-sy||V{qr\x07H\fH0vs-[bZlPYV]]R_`-K-=--{vs|z-Pyv}}r-pyv}}rh[bZlPYV]]R_`jH0r{qvs0vs-qrsv{rq5b`RlRQY6--n\bv{t-sy|n-Y|tQr}uH0r{qvsn\bv{t-rpA-Sv{ny]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{Hn\bv{t-sy|n-V_||sZnxH{vs|z-sy|n-u|{Sy||V{qr\x07H{vs|z-rp?-r|yv|{H{vs|z-sy|n-}v\x07ry_nv|H{vs|z-rp@-qvssrH{vs|z-sy|n-p|y|Ny}unH{vs|z-rp@-rzvvrH{vs|z-rp@-}rpynH{vs|z-sy|n-uv{v{rH{vs|z-sy|n-|}npv\bH{vs|z-sy|n-ovtu{rH{vs|z-rp@-z|qryO|{qv{tZn\x07H{vs|z-rp@-z|qryO|{qv{tZv{H<<u调整{vs|z-sy|n-p|y|`nnv|{H{vs|z-sy|n-p|y|Ovtu{rH0vs{qrs-SYNal`UNQRQ--0vsqrs-b`RlaN[TR[a----n\bv{t-rp@-an{tr{H----n\bv{t-rp@-Ovn{tr{H--0r{qvs0r{qvs0v{pyqr-Ip|zz|{K0v{pyqr-I}npxv{tK0v{pyqr-Iqvurv{tl}nlsntzr{K0v{pyqr-Ip|y|l}nlsntzr{K0v{pyqr-Il}nlsntzr{K0v{pyqr-I?l}nlsntzr{K0v{pyqr-Izn}l}nlsntzr{K0v{pyqr-Iny}unzn}l}nlsntzr{K0v{pyqr-In|zn}l}nlsntzr{K0v{pyqr-Iyvtuzn}l}nlsntzr{K0v{pyqr-Irzvvrzn}l}nlsntzr{K0v{pyqr-IoqsK0v{pyqr-Iporllrsyrpv|{lsntzr{K0v{pyqr-Ir{zn}lp|zz|{l}nlsntzr{K0v{pyqr-Ir{zn}l}nlsntzr{K0v{pyqr-Is|tl}nlsntzr{K0v{pyqr-Iyvtul}nlortv{K0v{pyqr-Iyvtul}u|{tl}nlsntzr{K0v{pyqr-Iunq|zn}l}nlsntzr{K0v{pyqr-Ioz}zn}l}nlsntzr{K0v{pyqr-I{|znyzn}l}nlsntzr{K0v{pyqr-I}rpynzn}l}nlsntzr{K0v{pyqr-Iy|tqr}uosl}nlsntzr{K0v{pyqr-Ipyv}}v{tl}yn{rl}nlsntzr{Krp@-	||zcrp|5rp@-qvrpv|{9-rp@-rp|9-sy|n-	||z6-\n--sy|n-urn-J-q|5qvrpv|{9-rp|6H--rp@-q-J-qvrpv|{-7-urnH--rp@-}-J-rp|-:-qH--rp@-\0-J-}-7-	||zH--r{-{|znyv	r5q-8-\x006H\frp@-to?u5rp@-p6-\n----rpA-X-J-rpA5=;=9-:>;=-<-@;=9-?;=-<-@;=9-:>;=6H----rpA-}-J-zv\x075rpA5p;ot9-X;	69-rpA5p;to9-X;\x07\b69-r}5p;o9-p;t66H----rpA-\0-J-zv\x075rpA5};\x07\b9-p;69-rpA5p;9-};\b	\x0769-r}5};\x079-p;66H----sy|n-q-J-\0;\x07-:-zv{5\0;9-\0;\b6H----sy|n-r-J->;=r:>=H----r{-rp@5no5\0;	-8-5\0;-:-\0;\b6-<-5C;=-7-q-8-r669-q-<-5\0;\x07-8-r69-\0;\x076H\frp@-u?to5rp@-p6-\n----rpA-X-J-rpA5>;=9-?;=-<-@;=9->;=-<-@;=9-@;=6H----rp@-}-J-no5snp5p;\x07\x07\x07-8-X;\x07\b	6-7-C;=-:-X;6H----r{-p;	-7-zv\x075X;\x07\x07\x079-pynz}5}-:-X;\x07\x07\x079-=;=9->;=69-p;\b6H\frp@-trP|y|O\bUrvtu5nz}yr?Q-tnqvr{ar\x07r9-rpA-Sv{ny]|vv|{6-\n--sy|n--J-5Sv{ny]|vv|{;\b-:-z|qryO|{qv{tZv{;\b6-<-5z|qryO|{qv{tZn\x07;\b-:-z|qryO|{qv{tZv{;\b6H--r{-r\x07r?Q5tnqvr{ar\x07r9-rp?59-=;B66;toH\fZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--<<-JJJ-顶部裁切-JJJ--sy|n-||sP]|tr-J-}|5pynz}5:PnzrnQvrpv|{;\b9-=;=9->;=69-@;=6H--vs-5----V_||sZnx-K-=;B-33----Sv{ny]|vv|{;\b-K-z|qryO|{qv{tZn\x07;\b-:-||sP]|tr-7-5z|qryO|{qv{tZn\x07;\b-:-z|qryO|{qv{tZv{;\b6--6-\n----qvpnqH--\f--<<-JJJJJJJJJJJJJJ--<<-JJJ-前置裁切计算-JJJ--0vs-[bZlPYV]]R_`-K-=----o||y-pyv}}rqH----rpA-pyv}}r]|vv|{H----0}ntzn-{|yyly||}ln----s|-5-v{-v-J-=H-v-I-[bZlPYV]]R_`H-v-88-6-\n------pyv}}r]|vv|{-J-pyv}}rh-v-j;znv\x07V{rr-7-Sv{ny]|vv|{H------pyv}}rq-J-5pyv}}rh-v-j;sy||V{qr\x07-I-=;=-\v\v-no5sy||V{qr\x07-:-pyv}}rh-v-j;sy||V{qr\x076-I->;=6H------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;\x07-K-:=;B-33-pyv}}r]|vv|{;\x07-I-=;BH------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;\b-K-:=;B-33-pyv}}r]|vv|{;\b-I-=;BH------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;	-K-:=;B-33-pyv}}r]|vv|{;	-I-=;BH------vs-5pyv}}rq6-\n--------qvpnqH------\f----\f----0}ntzn-{|yyly||}lr{q--0r{qvs--<<-JJJJJJJJJJJJJJJJ--0v{pyqr-Ipyv}}v{tl}yn{rlsntzr{K--rpA-qvssrP|y|-J-rpA5-qvssr9-p|y|Ny}un-7-|}npv\b-6H--<<-JJJ-高度色-JJJ--0vs-qrsv{rq5b`RlP\\Y\\_lNYaVabQR6----qvssrP|y|;to-J-trP|y|O\bUrvtu5tnqvr{ar\x07r9-Sv{ny]|vv|{6H--0r{qvs--<<-JJJJJJJJJJJ--<<-JJJ-纯色-JJJ--0vs-qrsv{rq5b`RlP\\Y\\_lP\\[`aN[a6----qvssrP|y|;to-J-p|{n{P|y|H--0r{qvs--<<-JJJJJJJJJJJ--_rsyrprqYvtu-rsyrprqYvtu-J-_rsyrprqYvtu5-rp@5-=;=-69-rp@5-=;=-69-rp@5-=;=-69-rp@5-=;=-6-6H--rp@-|nyRzvvr_nqvn{pr-J-rzvvrH--0v{pyqr-Iy|tqr}uoslsntzr{K--0v{pyqr-Izn}lsntzr{K--0v{pyqr-Ip|y|lsntzr{K--0v{pyqr-Iny}unzn}lsntzr{K--0v{pyqr-Iny}unrlsntzr{K--0v{pyqr-I}rpynzn}lsntzr{K--0v{pyqr-I{|znylsntzr{lortv{K--0v{pyqr-I{|znylsntzr{lzn}K--0v{pyqr-Irzvvrzn}lsntzr{K--<<-nppzynv|{--0v{pyqr-Iyvtul}u|{tlsntzr{K--0v{pyqr-Iyvtulsntzr{lortv{K--0v{pyqr-Iyvtulsntzr{lzn}K--0v{pyqr-Iyvtulsntzr{lr{qK--<<-z|qynv|{--0v{pyqr-In|zn}lsntzr{K--rp@-|t|v{tYvtu-J-rsyrprqYvtu;qvrpQvssr-8-rsyrprqYvtu;v{qvrpQvssr-8-rsyrprqYvtu;qvrp`}rpyn-8-rsyrprqYvtu;v{qvrp`}rpyn-8-|nyRzvvr_nqvn{prH--0v{pyqr-Ir{zn}lsntzr{K--tylSntP|y|-J-rpA5-|t|v{tYvtu9-qvssrP|y|;n-6H--<<-JJJ-楼层显示-JJJ--sy|n-sy||\\}npv\b-J->;=H--vs-5u|{Sy||V{qr\x07-K-:=;=>-33-no5sy||V{qr\x07-:-u|{Sy||V{qr\x076-K-=;FF6-\n----sy||\\}npv\b-J-=;?-7-zv{55>;=-8-PnzrnQvrpv|{;\b69->;=6H--\f--tylSntP|y|;n-J-tylSntP|y|;n-7-sy||\\}npv\b-7-ovtu{rH--<<-JJJJJJJJJJJJJJ--ZNV[lZ\\QRYlP\\Y\\_--<<色调映射-色彩空间转换--0v{pyqr-I|{rzn}}v{tlsntzr{K--0v{pyqr-Ir{p|qv{tlsntzr{K--<<-JJJ-颜色增益调整-JJJ--rp@-toP|y|-J-tylSntP|y|;toH--rp@-uP|y|-J-to?u5toP|y|6H--uP|y|;\b-8J-p|y|`nnv|{H--uP|y|;	-8J-p|y|Ovtu{rH--tylSntP|y|;to-J-u?to5uP|y|6H--<<-JJJ-全景图-JJJ--rp@-}n{|=a|crr\x07-J-{|znyv	r5Sv{ny]|vv|{;\x07\b	-:-}n{|=lznv\x07h@j;\x07\b	6H--}n{|=a|crr\x07-J-	||zcrp|5PnzrnQvrpv|{9-}n{|=a|crr\x079-}n{|=l	||z6H--}n{|=a|crr\x07-J-}n{|=a|crr\x07-7-zn@5}n{|=lznv\x076H--rp@-}n{|>a|crr\x07-J-{|znyv	r5Sv{ny]|vv|{;\x07\b	-:-}n{|>lznv\x07h@j;\x07\b	6H--}n{|>a|crr\x07-J-	||zcrp|5PnzrnQvrpv|{9-}n{|>a|crr\x079-}n{|>l	||z6H--}n{|>a|crr\x07-J-}n{|>a|crr\x07-7-zn@5}n{|>lznv\x076H--rpA-}n{|P|y|H--rpA-}n{|=P|y|-J-r\x07rPor5}n{|=lzn}9-}n{|=a|crr\x076H--rpA-}n{|>P|y|-J-r\x07rPor5}n{|>lzn}9-}n{|>a|crr\x076H--0vs-qrsv{rq5b`RlYbZV[N[PR6----}n{|=P|y|;n-J->;=-:-r\x07rPor5}n{|=lyzv{n{prZn}9-}n{|=a|crr\x076;H----}n{|>P|y|;n-J->;=-:-r\x07rPor5}n{|>lyzv{n{prZn}9-}n{|>a|crr\x076;H--0r{qvs--0vs-qrsv{rq5b`RlOYNPXla_N[`VaV\\[6----sy|n-oynpx]|tr-J-np|5:?;=-7-}|tr-8->;=6H----}n{|P|y|-J-zv\x075}n{|=P|y|9-OYNPXlP\\Y\\_9-zv{5>;=9-oynpx]|tr66H----}n{|P|y|-J-zv\x075}n{|P|y|9-}n{|>P|y|9-zn\x075=;=9-oynpx]|tr-:-]V-8->;=66H--0ryvs-qrsv{rq5b`Rl`]_RNQla_N[`VaV\\[6----rp?-prr{Pr{rP||q-J-r|yv|{-7-}v\x07ry_nv|-<-?;=H----sy|n-n{vv|{_nqv-J-qvn{pr5rp?5=;=9-=;=69-prr{Pr{rP||q6-7->;?H----sy|n-n{vv|{]|tr-J-qvn{pr5tylSntP||q;\x07\b9-prr{Pr{rP||q6-<-n{vv|{_nqvH----}n{|P|y|-J-zv\x075}n{|=P|y|9-}n{|>P|y|9-z||ur}5=;=9-=;?9-}|tr-:-n{vv|{]|tr66H--0ryr----}n{|P|y|-J-zv\x075}n{|=P|y|9-}n{|>P|y|9-}|tr6H--0r{qvs--tylSntP|y|-J-zv\x075}n{|P|y|9-tylSntP|y|9-z|qryNy}un6H--<<-JJJJJJJJJJJJJJ--0v{pyqr-Is|tlsntzr{K--0v{pyqr-I}rzyv}yvrqlny}unlsntzr{K--0v{pyqr-Iqvurv{tlsntzr{K--0vs-qrsv{rq5b`RlRQY6----tylSntP|y|;n-J-Y|tQr}uH--0r{qvs--ZNV[lR[Q\f"),meshStandardVertexShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("0qrsv{r-`aN[QN_Q0vs-qrsv{rq5b`RlRQY6--n\bv{t-sy|n-Y|tQr}uH0r{qvs0vs-qrsv{rq5b`RlcR_aRelZN_X6--nvor-sy|n-znxH0r{qvsn\bv{t-sy|n-V_||sZnxHn\bv{t-rpA-Sv{ny]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{Hn\bv{t-rp@-cvr]|vv|{H0vs{qrs-SYNal`UNQRQ--n\bv{t-rp@-[|znyH--0vsqrs-b`RlaN[TR[a----n\bv{t-rp@-an{tr{H----n\bv{t-rp@-Ovn{tr{H--0r{qvs0r{qvs0v{pyqr-Ip|zz|{K0v{pyqr-Il}nlrr\x07K0v{pyqr-I?l}nlrr\x07K0v{pyqr-Iqv}ynprzr{zn}l}nlrr\x07K0v{pyqr-Ir{zn}l}nlrr\x07K0v{pyqr-Ip|y|l}nlrr\x07K0v{pyqr-Is|tl}nlrr\x07K0v{pyqr-Iz|}untrl}nlrr\x07K0v{pyqr-Ixv{{v{tl}nlrr\x07K0v{pyqr-Iunq|zn}l}nlrr\x07K0v{pyqr-Iy|tqr}uosl}nlrr\x07K0v{pyqr-Ipyv}}v{tl}yn{rl}nlrr\x07KZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--0v{pyqr-Ilrr\x07K--0v{pyqr-I?lrr\x07K--0v{pyqr-Ip|y|lrr\x07K--0v{pyqr-Iortv{{|znylrr\x07K--0v{pyqr-Iz|}u{|znylrr\x07K--0v{pyqr-Ixv{onrlrr\x07K--0v{pyqr-Ixv{{|znylrr\x07K--0v{pyqr-Iqrsny{|znylrr\x07K0vs{qrs-SYNal`UNQRQ-<<-[|zny-p|z}rq-vu-qrvnvr-ur{-SYNal`UNQRQ--[|zny-J-{|znyv	r5-n{s|zrq[|zny-6H--0vsqrs-b`RlaN[TR[a----an{tr{-J-{|znyv	r5-n{s|zrqan{tr{-6H----Ovn{tr{-J-{|znyv	r5-p|5-[|zny9-an{tr{-6-7-n{tr{;-6H--0r{qvs0r{qvs--0v{pyqr-Iortv{lrr\x07K--0v{pyqr-Iz|}untrlrr\x07K--0v{pyqr-Ixv{{v{tlrr\x07K--0v{pyqr-Iqv}ynprzr{zn}lrr\x07K--0v{pyqr-I}|wrplrr\x07K--0v{pyqr-Iy|tqr}uoslrr\x07K--0v{pyqr-Ipyv}}v{tl}yn{rlrr\x07K--cvr]|vv|{-J-:-z]|vv|{;\x07\b	H--Sv{ny]|vv|{-J-rpA5n{s|zrq9->;=6H--0vsqrs-b`RlV[`aN[PV[T----Sv{ny]|vv|{-J-v{n{prZnv\x07-7-Sv{ny]|vv|{H--0r{qvs--Sv{ny]|vv|{-J-z|qryZnv\x07-7-Sv{ny]|vv|{H--zn@-pnzrn_|nv|{Znv\x07-J-zn@5vrZnv\x07h=jh=j9-vrZnv\x07h>jh=j9-vrZnv\x07h?jh=j9-vrZnv\x07h=jh>j9-vrZnv\x07h>jh>j9-vrZnv\x07h?jh>j9-vrZnv\x07h=jh?j9-vrZnv\x07h>jh?j9-vrZnv\x07h?jh?j6H--PnzrnQvrpv|{-J-{|znyv	r5pnzrn_|nv|{Znv\x07-7-rp@5=;=9-=;=9-:>;=66H--0vs-qrsv{rq5b`RlRQY6----Y|tQr}u-J-y|t?5:z]|vv|{;	6H--0r{qvs--V_||sZnx-J-=;=H--0vs-qrsv{rq5b`RlcR_aRelZN_X6----V_||sZnx-J-r}5no5znx-:->;=69-=;>6H--0r{qvs--0v{pyqr-I|yq}|lrr\x07K--0v{pyqr-Ir{zn}lrr\x07K--0v{pyqr-Iunq|zn}lrr\x07K--0v{pyqr-Is|tlrr\x07K--ZNV[lR[Q\f"),meshStandardFragmentShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("0qrsv{r-`aN[QN_Q0qrsv{r-_RSYRPaVcVaf0qrsv{r-OYNPXlP\\Y\\_-rpA5=;=EC9-=;>=C9-=;>AF9->;=6{vs|z-sy|n-sy||V{qr\x07H{vs|z-nz}yrPor-}n{|=lzn}H{vs|z-znA-}n{|=lznv\x07H{vs|z-sy|n-}n{|=l	||zH0vs-qrsv{rq5b`RlYbZV[N[PR6--{vs|z-nz}yrPor-}n{|=lyzv{n{prZn}H0r{qvs{vs|z-nz}yrPor-}n{|>lzn}H{vs|z-znA-}n{|>lznv\x07H{vs|z-sy|n-}n{|>l	||zH0vs-qrsv{rq5b`RlYbZV[N[PR6--{vs|z-nz}yrPor-}n{|>lyzv{n{prZn}H0r{qvs{vs|z-sy|n-z|qryNy}unH{vs|z-sy|n-}|trH0vs-qrsv{rq5b`RlP\\Y\\_lP\\[`aN[a6--{vs|z-rp@-p|{n{P|y|H0r{qvs0vs-qrsv{rq5b`RlP\\Y\\_lNYaVabQR6--{vs|z-nz}yr?Q-tnqvr{ar\x07rH0r{qvsp-Pyv}}r-\n--znA-znv\x07V{rrH--sy|n-sy||V{qr\x07H\fH0vs-[bZlPYV]]R_`-K-=--{vs|z-Pyv}}r-pyv}}rh[bZlPYV]]R_`jH0r{qvs0vs-qrsv{rq5b`RlRQY6--n\bv{t-sy|n-Y|tQr}uH0r{qvsn\bv{t-rpA-Sv{ny]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{Hn\bv{t-sy|n-V_||sZnxH{vs|z-sy|n-u|{Sy||V{qr\x07H{vs|z-rp?-r|yv|{H{vs|z-sy|n-}v\x07ry_nv|H{vs|z-rp@-qvssrH{vs|z-sy|n-p|y|Ny}unH{vs|z-rp@-rzvvrH{vs|z-sy|n-|tu{rH{vs|z-sy|n-zrny{rH{vs|z-sy|n-|}npv\bH{vs|z-sy|n-ovtu{rH0vsqrs-_RSYRPaVcVaf--{vs|z-sy|n-rsyrpvv\bH0r{qvs{vs|z-rp@-z|qryO|{qv{tZn\x07H{vs|z-rp@-z|qryO|{qv{tZv{H<<u调整{vs|z-sy|n-p|y|`nnv|{H{vs|z-sy|n-p|y|Ovtu{rHn\bv{t-rp@-cvr]|vv|{H0vs{qrs-SYNal`UNQRQ--n\bv{t-rp@-[|znyH--0vsqrs-b`RlaN[TR[a----n\bv{t-rp@-an{tr{H----n\bv{t-rp@-Ovn{tr{H--0r{qvs0r{qvs0v{pyqr-Ip|zz|{K0v{pyqr-I}npxv{tK0v{pyqr-Iqvurv{tl}nlsntzr{K0v{pyqr-Ip|y|l}nlsntzr{K0v{pyqr-Il}nlsntzr{K0v{pyqr-I?l}nlsntzr{K0v{pyqr-Izn}l}nlsntzr{K0v{pyqr-Iny}unzn}l}nlsntzr{K0v{pyqr-In|zn}l}nlsntzr{K0v{pyqr-Iyvtuzn}l}nlsntzr{K0v{pyqr-Irzvvrzn}l}nlsntzr{K0v{pyqr-IoqsK0v{pyqr-Iporllrsyrpv|{lsntzr{K0v{pyqr-Ir{zn}lp|zz|{l}nlsntzr{K0v{pyqr-Ir{zn}l}u\bvpnyl}nlsntzr{K0v{pyqr-Is|tl}nlsntzr{K0v{pyqr-Iyvtul}nlortv{K0v{pyqr-Iyvtul}u\bvpnyl}nlsntzr{K0v{pyqr-Iunq|zn}l}nlsntzr{K0v{pyqr-Ioz}zn}l}nlsntzr{K0v{pyqr-I{|znyzn}l}nlsntzr{K0v{pyqr-I|tu{rzn}l}nlsntzr{K0v{pyqr-Izrny{rzn}l}nlsntzr{K0v{pyqr-Iy|tqr}uosl}nlsntzr{K0v{pyqr-Ipyv}}v{tl}yn{rl}nlsntzr{Krp@-	||zcrp|5rp@-qvrpv|{9-rp@-rp|9-sy|n-	||z6-\n--sy|n-urn-J-q|5qvrpv|{9-rp|6H--rp@-q-J-qvrpv|{-7-urnH--rp@-}-J-rp|-:-qH--rp@-\0-J-}-7-	||zH--r{-{|znyv	r5q-8-\x006H\frp@-to?u5rp@-p6-\n----rpA-X-J-rpA5=;=9-:>;=-<-@;=9-?;=-<-@;=9-:>;=6H----rpA-}-J-zv\x075rpA5p;ot9-X;	69-rpA5p;to9-X;\x07\b69-r}5p;o9-p;t66H----rpA-\0-J-zv\x075rpA5};\x07\b9-p;69-rpA5p;9-};\b	\x0769-r}5};\x079-p;66H----sy|n-q-J-\0;\x07-:-zv{5\0;9-\0;\b6H----sy|n-r-J->;=r:>=H----r{-rp@5no5\0;	-8-5\0;-:-\0;\b6-<-5C;=-7-q-8-r669-q-<-5\0;\x07-8-r69-\0;\x076H\frp@-u?to5rp@-p6-\n----rpA-X-J-rpA5>;=9-?;=-<-@;=9->;=-<-@;=9-@;=6H----rp@-}-J-no5snp5p;\x07\x07\x07-8-X;\x07\b	6-7-C;=-:-X;6H----r{-p;	-7-zv\x075X;\x07\x07\x079-pynz}5}-:-X;\x07\x07\x079-=;=9->;=69-p;\b6H\frp@-trP|y|O\bUrvtu5nz}yr?Q-tnqvr{ar\x07r9-rpA-Sv{ny]|vv|{6-\n--sy|n--J-5Sv{ny]|vv|{;\b-:-z|qryO|{qv{tZv{;\b6-<-5z|qryO|{qv{tZn\x07;\b-:-z|qryO|{qv{tZv{;\b6H--r{-r\x07r?Q5tnqvr{ar\x07r9-rp?59-=;B66;toH\fZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--<<-JJJ-顶部裁切-JJJ--sy|n-||sP]|tr-J-}|5pynz}5:PnzrnQvrpv|{;\b9-=;=9->;=69-@;=6H--vs-5----V_||sZnx-K-=;B-33----Sv{ny]|vv|{;\b-K-z|qryO|{qv{tZn\x07;\b-:-||sP]|tr-7-5z|qryO|{qv{tZn\x07;\b-:-z|qryO|{qv{tZv{;\b6--6-\n----qvpnqH--\f--<<-JJJJJJJJJJJJJJ--<<-JJJ-前置裁切计算-JJJ--0vs-[bZlPYV]]R_`-K-=----o||y-pyv}}rqH----rpA-pyv}}r]|vv|{H----0}ntzn-{|yyly||}ln----s|-5-v{-v-J-=H-v-I-[bZlPYV]]R_`H-v-88-6-\n------pyv}}r]|vv|{-J-pyv}}rh-v-j;znv\x07V{rr-7-Sv{ny]|vv|{H------pyv}}rq-J-5pyv}}rh-v-j;sy||V{qr\x07-I-=;=-\v\v-no5sy||V{qr\x07-:-pyv}}rh-v-j;sy||V{qr\x076-I->;=6H------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;\x07-K-:=;B-33-pyv}}r]|vv|{;\x07-I-=;BH------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;\b-K-:=;B-33-pyv}}r]|vv|{;\b-I-=;BH------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;	-K-:=;B-33-pyv}}r]|vv|{;	-I-=;BH------vs-5pyv}}rq6-\n--------qvpnqH------\f----\f----0}ntzn-{|yyly||}lr{q--0r{qvs--<<-JJJJJJJJJJJJJJJJ--0v{pyqr-Ipyv}}v{tl}yn{rlsntzr{K--rpA-qvssrP|y|-J-rpA5-qvssr9-p|y|Ny}un-7-|}npv\b-6H--<<-JJJ-高度色-JJJ--0vs-qrsv{rq5b`RlP\\Y\\_lNYaVabQR6----qvssrP|y|;to-J-trP|y|O\bUrvtu5tnqvr{ar\x07r9-Sv{ny]|vv|{6H--0r{qvs--<<-JJJJJJJJJJJ--<<-JJJ-纯色-JJJ--0vs-qrsv{rq5b`RlP\\Y\\_lP\\[`aN[a6----qvssrP|y|;to-J-p|{n{P|y|H--0r{qvs--<<-JJJJJJJJJJJ--_rsyrprqYvtu-rsyrprqYvtu-J-_rsyrprqYvtu5-rp@5-=;=-69-rp@5-=;=-69-rp@5-=;=-69-rp@5-=;=-6-6H--rp@-|nyRzvvr_nqvn{pr-J-rzvvrH--0v{pyqr-Iy|tqr}uoslsntzr{K--0v{pyqr-Izn}lsntzr{K--0v{pyqr-Ip|y|lsntzr{K--0v{pyqr-Iny}unzn}lsntzr{K--0v{pyqr-Iny}unrlsntzr{K--0v{pyqr-I|tu{rzn}lsntzr{K0v{pyqr-Izrny{rzn}lsntzr{K--0v{pyqr-I{|znylsntzr{lortv{K--0v{pyqr-I{|znylsntzr{lzn}K--0v{pyqr-Irzvvrzn}lsntzr{K--<<-nppzynv|{--0v{pyqr-Iyvtul}u\bvpnylsntzr{K--0v{pyqr-Iyvtulsntzr{lortv{K--0v{pyqr-Iyvtulsntzr{lzn}K--0v{pyqr-Iyvtulsntzr{lr{qK--<<-z|qynv|{--0v{pyqr-In|zn}lsntzr{K--rp@-|t|v{tYvtu-J-rsyrprqYvtu;qvrpQvssr-8-rsyrprqYvtu;v{qvrpQvssr-8-rsyrprqYvtu;qvrp`}rpyn-8-rsyrprqYvtu;v{qvrp`}rpyn-8-|nyRzvvr_nqvn{prH--tylSntP|y|-J-rpA5-|t|v{tYvtu9-qvssrP|y|;n-6H--<<-JJJ-楼层显示-JJJ--sy|n-sy||\\}npv\b-J->;=H--vs-5u|{Sy||V{qr\x07-K-:=;=>-33-no5sy||V{qr\x07-:-u|{Sy||V{qr\x076-K-=;FF6-\n----sy||\\}npv\b-J-=;?-7-zv{55>;=-8-PnzrnQvrpv|{;\b69->;=6H--\f--tylSntP|y|;n-J-tylSntP|y|;n-7-sy||\\}npv\b-7-ovtu{rH--<<-JJJJJJJJJJJJJJ--ZNV[lZ\\QRYlP\\Y\\_--<<色调映射-色彩空间转换--0v{pyqr-I|{rzn}}v{tlsntzr{K--0v{pyqr-Ir{p|qv{tlsntzr{K--<<-JJJ-颜色增益调整-JJJ--rp@-toP|y|-J-tylSntP|y|;toH--rp@-uP|y|-J-to?u5toP|y|6H--uP|y|;\b-8J-p|y|`nnv|{H--uP|y|;	-8J-p|y|Ovtu{rH--tylSntP|y|;to-J-u?to5uP|y|6H--<<-JJJ-全景图-JJJ--rp@-}n{|=a|crr\x07-J-{|znyv	r5Sv{ny]|vv|{;\x07\b	-:-}n{|=lznv\x07h@j;\x07\b	6H--}n{|=a|crr\x07-J-	||zcrp|5PnzrnQvrpv|{9-}n{|=a|crr\x079-}n{|=l	||z6H--}n{|=a|crr\x07-J-}n{|=a|crr\x07-7-zn@5}n{|=lznv\x076H--rp@-}n{|>a|crr\x07-J-{|znyv	r5Sv{ny]|vv|{;\x07\b	-:-}n{|>lznv\x07h@j;\x07\b	6H--}n{|>a|crr\x07-J-	||zcrp|5PnzrnQvrpv|{9-}n{|>a|crr\x079-}n{|>l	||z6H--}n{|>a|crr\x07-J-}n{|>a|crr\x07-7-zn@5}n{|>lznv\x076H--rpA-}n{|P|y|H--rpA-}n{|=P|y|-J-r\x07rPor5}n{|=lzn}9-}n{|=a|crr\x076H--rpA-}n{|>P|y|-J-r\x07rPor5}n{|>lzn}9-}n{|>a|crr\x076H--0vs-qrsv{rq5b`RlYbZV[N[PR6----}n{|=P|y|;n-J->;=-:-r\x07rPor5}n{|=lyzv{n{prZn}9-}n{|=a|crr\x076;H----}n{|>P|y|;n-J->;=-:-r\x07rPor5}n{|>lyzv{n{prZn}9-}n{|>a|crr\x076;H--0r{qvs--0vs-qrsv{rq5b`RlOYNPXla_N[`VaV\\[6----sy|n-oynpx]|tr-J-np|5:?;=-7-}|tr-8->;=6H----}n{|P|y|-J-zv\x075}n{|=P|y|9-OYNPXlP\\Y\\_9-zv{5>;=9-oynpx]|tr66H----}n{|P|y|-J-zv\x075}n{|P|y|9-}n{|>P|y|9-zn\x075=;=9-oynpx]|tr-:-]V-8->;=66H--0ryvs-qrsv{rq5b`Rl`]_RNQla_N[`VaV\\[6----rp?-prr{Pr{rP||q-J-r|yv|{-7-}v\x07ry_nv|-<-?;=H----sy|n-n{vv|{_nqv-J-qvn{pr5rp?5=;=9-=;=69-prr{Pr{rP||q6-7->;?H----sy|n-n{vv|{]|tr-J-qvn{pr5tylSntP||q;\x07\b9-prr{Pr{rP||q6-<-n{vv|{_nqvH----}n{|P|y|-J-zv\x075}n{|=P|y|9-}n{|>P|y|9-z||ur}5=;=9-=;?9-}|tr-:-n{vv|{]|tr66H--0ryr----}n{|P|y|-J-zv\x075}n{|=P|y|9-}n{|>P|y|9-}|tr6H--0r{qvs--tylSntP|y|-J-zv\x075}n{|P|y|9-tylSntP|y|9-z|qryNy}un6H--<<-JJJJJJJJJJJJJJ--0v{pyqr-Is|tlsntzr{K--0v{pyqr-I}rzyv}yvrqlny}unlsntzr{K--0v{pyqr-Iqvurv{tlsntzr{K--0vs-qrsv{rq5b`RlRQY6----tylSntP|y|;n-J-Y|tQr}uH--0r{qvs--ZNV[lR[Q\f");var pbmUniforms$1={colorAlpha:new Uniform(0),modelAlpha:new Uniform(0),progress:new Uniform(0),pano0_map:new Uniform(null),pano0_luminanceMap:new Uniform(null),pano0_matrix:new Uniform(new Matrix4),pano0_zoom:new Uniform(1),pano1_map:new Uniform(null),pano1_luminanceMap:new Uniform(null),pano1_matrix:new Uniform(new Matrix4),pano1_zoom:new Uniform(1),gradientTexture:new Uniform(null),clippers:new Uniform([]),shownFloorIndex:new Uniform(-1),constantColor:new Uniform(new Vector3),geometricError:new Uniform(0),pixelRatio:new Uniform(1),resolution:new Uniform(new Vector2(512,512)),floorIndex:new Uniform(0),brightness:new Uniform(1),modelBoundingMin:new Uniform(new Vector3),modelBoundingMax:new Uniform(new Vector3),colorSaturation:new Uniform(0),colorBrightness:new Uniform(0),outlineGain:new Uniform(0),distanceGain:new Uniform(0)},shaderLib={none:{vertexShader:meshNoneVertexShader,fragmentShader:meshNoneFragmentShader,uniforms:UniformsUtils.merge([pbmUniforms$1,{opacity:{value:1}},UniformsLib.fog]),lights:!1,clipping:!1},basic:{vertexShader:meshBasicVertexShader,fragmentShader:meshBasicFragmentShader,uniforms:UniformsUtils.merge([pbmUniforms$1,ShaderLib.basic.uniforms]),lights:!1,clipping:!0},phong:{vertexShader:meshPhongVertexShader,fragmentShader:meshPhongFragmentShader,uniforms:UniformsUtils.merge([pbmUniforms$1,ShaderLib.phong.uniforms]),lights:!0,clipping:!0},standard:{vertexShader:meshStandardVertexShader,fragmentShader:meshStandardFragmentShader,uniforms:UniformsUtils.merge([pbmUniforms$1,ShaderLib.standard.uniforms]),lights:!0,clipping:!0}},PBMMeshMaterial=function($e){__extends(Se,$e);function Se(Be,De){Be===void 0&&(Be="basic"),De===void 0&&(De={});var Ve=this,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an,rn,on,sn,ln,cn,hn,mn,An,xn,pn,dn,fn,yn,Sn,gn,Cn,Mn=shaderLib[Be];Ve=$e.call(this,{vertexShader:Mn.vertexShader,fragmentShader:Mn.fragmentShader,uniforms:UniformsUtils.clone(Mn.uniforms),lights:Mn.lights,clipping:Mn.clipping,defines:{USE_COLOR_CONSTANT:!1,USE_COLOR_ALTITUDE:!1,USE_EDL:!1,USE_HQ_WEIGHT:!1,USE_HQ_DEPTH:!1,NUM_CLIPPING_BOX:!1,USE_CLIPFLOOR:!1,USE_VERTEX_MARK:!1,USE_LUMINANCE:!1,USE_BLACK_TRANSITION:!1,USE_SPREAD_TRANSITION:!1,USE_POINT_NORMAL:!1,USE_POINT_CIRCLE:!1,USE_POINT_ADAPTIVE_SIZE:!1,USE_POINT_COLOR_ALTITUDE:!1}})||this,Ve.shaderType=Be,Ve.vertexTangents=!1,Ve.color=new Color(16777215),Ve.colorAlpha=1,Ve.map=null,Ve.lightMap=null,Ve.lightMapIntensity=1,Ve.aoMap=null,Ve.aoMapIntensity=1,Ve.specularMap=null,Ve.specular=new Color(1118481),Ve.roughnessMap=null,Ve.roughness=1,Ve.metalnessMap=null,Ve.metalness=0,Ve.alphaMap=null,Ve.alphaMode="OPAQUE",Ve.combine=null,Ve.envMap=null,Ve.envMapIntensity=1,Ve.reflectivity=.4,Ve.refractionRatio=.98,Ve.emissiveMap=null,Ve.emissive=new Color(0),Ve.emissiveIntensity=1,Ve.bumpMap=null,Ve.bumpScale=1,Ve.normalMap=null,Ve.normalMapType=TangentSpaceNormalMap,Ve.normalScale=new Vector2(1,1),Ve.displacementMap=null,Ve.displacementScale=1,Ve.displacementBias=0,Ve.shininess=30;var Bn,kn=null,Ln=null;return Ve.shaderType==="phong"&&(Ve.combine=MultiplyOperation),Object.defineProperties(Ve,{pano0:{get:function(){return kn},set:function(Pn){if(kn!==Pn){kn=Pn,Pn===null?(this.uniforms.pano0_map.value=null,this.uniforms.pano0_luminanceMap.value=null,this.uniforms.pano0_matrix.value.identity(),this.uniforms.pano0_zoom.value=1):(this.uniforms.pano0_map.value=Pn.map instanceof TileCubeTextureTarget?Pn.map.texture:Pn.map,this.uniforms.pano0_luminanceMap.value=Pn.luminanceMap instanceof TileCubeTextureTarget?Pn.luminanceMap.texture:Pn.luminanceMap,this.uniforms.pano0_matrix.value.copy(Pn.matrix),this.uniforms.pano0_zoom.value=Pn.zoom);var Vn=this.uniforms.pano0_luminanceMap.value!==null&&this.uniforms.pano1_luminanceMap.value!==null,Yn=this.defines.USE_LUMINANCE;Yn!==Vn&&(this.defines.USE_LUMINANCE=Vn,this.needsUpdate=!0)}}},pano1:{get:function(){return Ln},set:function(Pn){if(Ln!==Pn){Ln=Pn,Pn===null?(this.uniforms.pano1_map.value=null,this.uniforms.pano1_luminanceMap.value=null,this.uniforms.pano1_matrix.value.identity(),this.uniforms.pano1_zoom.value=1):(this.uniforms.pano1_map.value=Pn.map instanceof TileCubeTextureTarget?Pn.map.texture:Pn.map,this.uniforms.pano1_luminanceMap.value=Pn.luminanceMap instanceof TileCubeTextureTarget?Pn.luminanceMap.texture:Pn.luminanceMap,this.uniforms.pano1_matrix.value.copy(Pn.matrix),this.uniforms.pano1_zoom.value=Pn.zoom);var Vn=this.uniforms.pano0_luminanceMap.value!==null&&this.uniforms.pano1_luminanceMap.value!==null,Yn=this.defines.USE_LUMINANCE;Yn!==Vn&&(this.defines.USE_LUMINANCE=Vn,this.needsUpdate=!0)}}},modelAlpha:{get:function(){return this.uniforms.modelAlpha.value},set:function(Pn){this.uniforms.modelAlpha.value=Pn}},progress:{get:function(){return this.uniforms.progress.value},set:function(Pn){this.uniforms.progress.value=Pn}},transition:{get:function(){return this.defines.USE_BLACK_TRANSITION?"BLACK":this.defines.USE_SPREAD_TRANSITION?"SPREAD":"FADE"},set:function(Pn){var Vn=this.defines.USE_BLACK_TRANSITION,Yn=this.defines.USE_SPREAD_TRANSITION;this.defines.USE_BLACK_TRANSITION=!1,this.defines.USE_SPREAD_TRANSITION=!1,this.defines["USE_".concat(Pn,"_TRANSITION")]=!0;var ni=!1;Vn!==this.defines.USE_BLACK_TRANSITION&&(ni=!0),Yn!==this.defines.USE_SPREAD_TRANSITION&&(ni=!0),ni&&(this.needsUpdate=!0)}},colorStyle:{get:function(){return this.defines.USE_COLOR_CONSTANT?"CONSTANT":this.defines.USE_COLOR_ALTITUDE?"ALTITUDE":"RGB"},set:function(Pn){var Vn=Pn==="CONSTANT",Yn=Pn==="ALTITUDE";this.defines.USE_COLOR_CONSTANT!==Vn&&(this.defines.USE_COLOR_CONSTANT=Vn,this.needsUpdate=!0),this.defines.USE_COLOR_ALTITUDE!==Yn&&(this.defines.USE_COLOR_ALTITUDE=Yn,this.needsUpdate=!0)}},constantColor:{get:function(){return this.uniforms.constantColor.value},set:function(Pn){this.uniforms.constantColor.value=Pn}},opacity:{get:function(){return this.uniforms.opacity.value},set:function(Pn){this.uniforms.opacity.value=Pn}},shownFloorIndex:{get:function(){return this.uniforms.shownFloorIndex.value},set:function(Pn){this.uniforms.shownFloorIndex.value=Pn}},gradientTexture:{get:function(){return this.uniforms.gradientTexture.value},set:function(Pn){this.uniforms.gradientTexture.value=Pn}},brightness:{get:function(){return this.uniforms.brightness.value},set:function(Pn){this.uniforms.brightness.value=Pn}},clippers:{get:function(){return Bn},set:function(Pn){Bn!==Pn&&(Bn=Pn,this.uniforms.clippers.value=(Bn||[]).map(function(Vn){var Yn=typeof Vn.floorIndex=="number"?Vn.floorIndex:-1,ni=new Matrix4().getInverse(Vn.clippingBoxMatrix);return{matrixInverse:ni,floorIndex:Yn}}),this.needsUpdate=!0)}},useEDL:{get:function(){return this.defines.USE_EDL},set:function(Pn){Pn!==this.defines.USE_EDL&&(this.defines.USE_EDL=Pn,this.needsUpdate=!0)}},useHQWeight:{get:function(){return this.defines.USE_HQ_WEIGHT},set:function(Pn){Pn!==this.defines.USE_HQ_WEIGHT&&(this.defines.USE_HQ_WEIGHT=Pn,this.needsUpdate=!0)}},useHQDepth:{get:function(){return this.defines.USE_HQ_DEPTH},set:function(Pn){Pn!==this.defines.USE_HQ_DEPTH&&(this.defines.USE_HQ_DEPTH=Pn,this.needsUpdate=!0)}},floorIndex:{get:function(){return this.uniforms.floorIndex.value},set:function(Pn){this.uniforms.floorIndex.value=Pn}},colorSaturation:{get:function(){return this.uniforms.colorSaturation.value},set:function(Pn){this.uniforms.colorSaturation.value=Pn}},colorBrightness:{get:function(){return this.uniforms.colorBrightness.value},set:function(Pn){this.uniforms.colorBrightness.value=Pn}},outlineGain:{get:function(){return this.uniforms.outlineGain.value},set:function(Pn){this.uniforms.outlineGain.value=Pn}},distanceGain:{get:function(){return this.uniforms.distanceGain.value},set:function(Pn){this.uniforms.distanceGain.value=Pn}}}),Ve.pano0=(Fe=De.pano0)!==null&&Fe!==void 0?Fe:defaultPbmParameters.pano0,Ve.pano1=(Je=De.pano1)!==null&&Je!==void 0?Je:defaultPbmParameters.pano1,Ve.modelAlpha=(Xe=De.modelAlpha)!==null&&Xe!==void 0?Xe:defaultPbmParameters.modelAlpha,Ve.progress=(Ke=De.progress)!==null&&Ke!==void 0?Ke:defaultPbmParameters.progress,Ve.transition=(Ye=De.transition)!==null&&Ye!==void 0?Ye:defaultPbmParameters.transition,Ve.constantColor=(or=De.constantColor)!==null&&or!==void 0?or:defaultPbmParameters.constantColor,Ve.opacity=(sr=De.opacity)!==null&&sr!==void 0?sr:defaultPbmParameters.opacity,Ve.floorStyle=(cr=De.floorStyle)!==null&&cr!==void 0?cr:defaultPbmParameters.floorStyle,Ve.shownFloorIndex=(Br=De.shownFloorIndex)!==null&&Br!==void 0?Br:defaultPbmParameters.shownFloorIndex,Ve.clippers=(tn=De.clippers)!==null&&tn!==void 0?tn:defaultPbmParameters.clippers,Ve.useEDL=(en=De.useEDL)!==null&&en!==void 0?en:defaultPbmParameters.useEDL,Ve.useHQWeight=(an=De.useHQWeight)!==null&&an!==void 0?an:defaultPbmParameters.useHQWeight,Ve.useHQDepth=(rn=De.useHQDepth)!==null&&rn!==void 0?rn:defaultPbmParameters.useHQDepth,Ve.pointSize=(on=De.pointSize)!==null&&on!==void 0?on:defaultPbmParameters.pointSize,Ve.colorStyle=(sn=De.colorStyle)!==null&&sn!==void 0?sn:defaultPbmParameters.colorStyle,Ve.pointShape=(ln=De.pointShape)!==null&&ln!==void 0?ln:defaultPbmParameters.pointShape,Ve.pointScale=(cn=De.pointScale)!==null&&cn!==void 0?cn:defaultPbmParameters.pointScale,Ve.pointBack=(hn=De.pointBack)!==null&&hn!==void 0?hn:defaultPbmParameters.pointBack,Ve.pointMinPixel=(mn=De.pointMinPixel)!==null&&mn!==void 0?mn:defaultPbmParameters.pointMinPixel,Ve.pointMaxPixel=(An=De.pointMaxPixel)!==null&&An!==void 0?An:defaultPbmParameters.pointMaxPixel,Ve.gradientTexture=(xn=De.gradientTexture)!==null&&xn!==void 0?xn:defaultPbmParameters.gradientTexture,Ve.brightness=(pn=De.brightness)!==null&&pn!==void 0?pn:defaultPbmParameters.brightness,Ve.colorSaturation=(dn=De.colorSaturation)!==null&&dn!==void 0?dn:defaultPbmParameters.colorSaturation,Ve.colorBrightness=(fn=De.colorBrightness)!==null&&fn!==void 0?fn:defaultPbmParameters.colorBrightness,Ve.customShaders=(yn=De.customShaders)!==null&&yn!==void 0?yn:defaultPbmParameters.customShaders,Ve.outlineGain=(Sn=De.outlineGain)!==null&&Sn!==void 0?Sn:defaultPbmParameters.outlineGain,Ve.distanceGain=(gn=De.distanceGain)!==null&&gn!==void 0?gn:defaultPbmParameters.distanceGain,Ve.useAddBlend=(Cn=De.useAddBlend)!==null&&Cn!==void 0?Cn:defaultPbmParameters.useAddBlend,Ve.customShaderHash="",Ve.customShaderUniforms={},Ve.customShaderDefines={},Ve.floorIndex=0,Ve.transparent=!1,Ve}return Se.prototype.onBeforeCompile=function(Be,De){var Ve=this,Fe,Je,Xe=this.customShaders.filter(function(an){return an.type.includes(Ve.shaderType)}),Ke=Xe.reduce(function(an,rn){return an+rn.vertex.mainBefore},""),Ye=Xe.reduce(function(an,rn){return an+rn.vertex.mainStart},""),or=Xe.reduce(function(an,rn){return an+rn.vertex.mainEnd},""),sr=Xe.reduce(function(an,rn){return an+rn.fragment.mainBefore},""),cr=Xe.reduce(function(an,rn){return an+rn.fragment.mainStart},""),Br=Xe.reduce(function(an,rn){return an+rn.fragment.mainModelColor},""),tn=Xe.reduce(function(an,rn){return an+rn.fragment.mainEnd},"");Be.vertexShader=Be.vertexShader.replace(/MAIN_BEFORE/g,Ke),Be.fragmentShader=Be.fragmentShader.replace(/MAIN_BEFORE/g,sr),Be.vertexShader=Be.vertexShader.replace(/MAIN_START/g,Ye),Be.fragmentShader=Be.fragmentShader.replace(/MAIN_START/g,cr),Be.vertexShader=Be.vertexShader.replace(/MAIN_END/g,or),Be.fragmentShader=Be.fragmentShader.replace(/MAIN_END/g,tn),Be.fragmentShader=Be.fragmentShader.replace(/MAIN_MODEL_COLOR/g,Br);var en=String((Je=(Fe=this.clippers)===null||Fe===void 0?void 0:Fe.length)!==null&&Je!==void 0?Je:0);Be.vertexShader=Be.vertexShader.replace(/NUM_CLIPPERS/g,en),Be.fragmentShader=Be.fragmentShader.replace(/NUM_CLIPPERS/g,en),Xe.forEach(function(an){an.onBeforeCompile(Be,De)})},Se.prototype.refreshUniforms=function(Be){var De,Ve,Fe=this.uniforms;Fe.diffuse&&Fe.diffuse.value.copy(this.color),Fe.opacity&&(Fe.opacity.value=this.opacity),Fe.color&&Fe.diffuse.value.copy(this.color),Fe.colorAlpha&&(Fe.colorAlpha.value=this.colorAlpha),Fe.emissive&&Fe.emissive.value.copy(this.emissive).multiplyScalar(this.emissiveIntensity),Fe.roughness&&(Fe.roughness.value=this.roughness),Fe.metalness&&(Fe.metalness.value=this.metalness),Fe.map&&(Fe.map.value=this.map),Fe.alphaMap&&(Fe.alphaMap.value=this.alphaMap),Fe.specularMap&&(Fe.specularMap.value=this.specularMap),Fe.roughnessMap&&(Fe.roughnessMap.value=this.roughnessMap),Fe.metalnessMap&&(Fe.metalnessMap.value=this.metalnessMap),Fe.envMap&&(Fe.envMap.value=this.envMap,Fe.flipEnvMap.value=!((De=this.envMap)===null||De===void 0)&&De.isCubeTexture?-1:1,Fe.reflectivity.value=this.reflectivity,Fe.refractionRatio.value=this.refractionRatio,Fe.maxMipLevel.value=this.envMap&&(Ve=Be?.properties.get(this.envMap).__maxMipLevel)!==null&&Ve!==void 0?Ve:0,Fe.envMapIntensity&&(Fe.envMapIntensity.value=this.envMapIntensity)),Fe.lightMap&&(Fe.lightMap.value=this.lightMap,Fe.lightMapIntensity.value=this.lightMapIntensity),Fe.aoMap&&(Fe.aoMap.value=this.aoMap,Fe.aoMapIntensity.value=this.aoMapIntensity),Fe.specular&&Fe.specular.value.copy(this.specular),Fe.shininess&&(Fe.shininess.value=Math.max(this.shininess,1e-4)),Fe.emissiveMap&&(Fe.emissiveMap.value=this.emissiveMap),Fe.bumpMap&&(Fe.bumpMap.value=this.bumpMap,Fe.bumpScale.value=this.bumpScale,this.side===BackSide&&(Fe.bumpScale.value*=-1)),Fe.normalMap&&(Fe.normalMap.value=this.normalMap,Fe.normalScale.value.copy(this.normalScale),this.side===BackSide&&Fe.normalScale.value.negate()),Fe.displacementMap&&(Fe.displacementMap.value=this.displacementMap,Fe.displacementScale.value=this.displacementScale,Fe.displacementBias.value=this.displacementBias);var Je;this.map?Je=this.map:this.specularMap?Je=this.specularMap:this.displacementMap?Je=this.displacementMap:this.normalMap?Je=this.normalMap:this.bumpMap?Je=this.bumpMap:this.alphaMap?Je=this.alphaMap:this.emissiveMap&&(Je=this.emissiveMap),Je!==void 0&&(Je.matrixAutoUpdate===!0&&Je.updateMatrix(),Fe.uvTransform.value.copy(Je.matrix));var Xe;this.aoMap?Xe=this.aoMap:this.lightMap&&(Xe=this.lightMap),Xe!==void 0&&(Xe.matrixAutoUpdate===!0&&Xe.updateMatrix(),Fe.uv2Transform.value.copy(Xe.matrix))},Se.prototype.update=function(Be,De,Ve){var Fe="".concat(Ve.id,":").concat(Ve.materialVersion);Fe!==this.syncModelVersion&&(Object.assign(this,Ve.getMaterial()),this.syncModelVersion=Fe);var Je=this.customShaders.map(function(rn){return rn.getHash()}).join("");this.customShaderHash!==Je&&(this.customShaderHash=Je,this.needsUpdate=!0);for(var Xe=this.customShaders.reduce(function(rn,on){return Object.assign(rn,on.defines)},{}),Ke=Object.keys(this.customShaderDefines),Ye=0,or=Ke;Ye<or.length;Ye++){var sr=or[Ye];delete this.defines[sr]}this.customShaderDefines=Xe,Object.assign(this.defines,this.customShaderDefines);for(var cr=this.customShaders.reduce(function(rn,on){return Object.assign(rn,on.uniforms)},{}),Br=Object.keys(this.customShaderUniforms),tn=0,en=Br;tn<en.length;tn++){var an=en[tn];delete this.uniforms[an]}this.customShaderUniforms=cr,Object.assign(this.uniforms,this.customShaderUniforms),this.visible=!0,this.envMap||(this.envMap=De.environment),this.refreshUniforms(Be),this.useAddBlend?(this.depthWrite=!1,this.depthTest=!1,this.blending=AdditiveBlending):(this.depthWrite=!0,this.depthTest=!0,this.blending=NormalBlending),this.shaderType==="none"?(this.depthWrite=!1,this.transparent=!0):(this.transparent=this.alphaMode==="BLEND",this.depthWrite=!0,this.shownFloorIndex>-1&&this.shownFloorIndex!==this.floorIndex&&(this.transparent=!0),this.opacity*this.colorAlpha<1&&(this.transparent=!0),this.alphaMap&&(this.transparent=!0),this.brightness<1&&(this.transparent=!0),this.transparent&&(this.depthWrite=!1),this.floorStyle==="VISIBILITY"&&this.shownFloorIndex!==-1&&this.floorIndex!==this.shownFloorIndex&&(this.visible=!1)),this.uniforms.pixelRatio.value=De.pixelRatio,this.uniforms.resolution.value.copy(De.resolution),this.uniforms.modelBoundingMax.value.copy(Ve.bounding.max),this.uniforms.modelBoundingMin.value.copy(Ve.bounding.min)},Se.prototype.copy=function(Be){return $e.prototype.copy.call(this,Be),this.color.copy(Be.color),this.colorAlpha=Be.colorAlpha,this.map=Be.map,this.lightMap=Be.lightMap,this.lightMapIntensity=Be.lightMapIntensity,this.aoMap=Be.aoMap,this.aoMapIntensity=Be.aoMapIntensity,this.specularMap=Be.specularMap,this.specular.copy(Be.specular),this.alphaMap=Be.alphaMap,this.envMap=Be.envMap,this.reflectivity=Be.reflectivity,this.refractionRatio=Be.refractionRatio,this.emissiveMap=Be.emissiveMap,this.emissive.copy(Be.emissive),this.emissiveIntensity=Be.emissiveIntensity,this.bumpMap=Be.bumpMap,this.bumpScale=Be.bumpScale,this.normalMap=Be.normalMap,this.normalMapType=Be.normalMapType,this.normalScale.copy(Be.normalScale),this.displacementMap=Be.displacementMap,this.displacementScale=Be.displacementScale,this.displacementBias=Be.displacementBias,this.shininess=Be.shininess,this.customShaders=Be.customShaders,this.pano0=Be.pano0,this.pano1=Be.pano1,this.modelAlpha=Be.modelAlpha,this.progress=Be.progress,this.transition=Be.transition,this.opacity=Be.opacity,this.floorStyle=Be.floorStyle,this.colorStyle=Be.colorStyle,this.constantColor=Be.constantColor,this.shownFloorIndex=Be.shownFloorIndex,this.brightness=Be.brightness,this.clippers=Be.clippers,this.useEDL=Be.useEDL,this.useHQWeight=Be.useHQWeight,this.useHQDepth=Be.useHQDepth,this.pointSize=Be.pointSize,this.pointShape=Be.pointShape,this.pointScale=Be.pointScale,this.pointBack=Be.pointBack,this.pointMinPixel=Be.pointMinPixel,this.pointMaxPixel=Be.pointMaxPixel,this.gradientTexture=Be.gradientTexture,this.floorIndex=Be.floorIndex,this.colorSaturation=Be.colorSaturation,this.colorBrightness=Be.colorBrightness,this.outlineGain=Be.outlineGain,this.distanceGain=Be.distanceGain,this.useAddBlend=Be.useAddBlend,this.refreshUniforms(),this},Se.prototype.clone=function(){return new this.constructor(this.shaderType).copy(this)},Se}(ShaderMaterial);const pointCloudFragmentShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("{vs|z-sy|n-sy||V{qr\x07H0vs-qrsv{rq5b`Rl]\\V[al[\\_ZNY6--n\bv{t-rp@-[|znyH0r{qvs0vs-qrsv{rq5b`RlRQY6--n\bv{t-sy|n-Y|tQr}uH0r{qvsp-Pyv}}r-\n--znA-znv\x07V{rrH--sy|n-sy||V{qr\x07H\fH0vs-[bZlPYV]]R_`-K-=--{vs|z-Pyv}}r-pyv}}rh[bZlPYV]]R_`jH0r{qvsn\bv{t-rpA-d|yq]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{Hn\bv{t-rp@-P|y|Hn\bv{t-sy|n-]|v{`v	rH{vs|z-sy|n-|}npv\bH{vs|z-sy|n-z|qryNy}unH{vs|z-sy|n-u|{Sy||V{qr\x07H<<u调整{vs|z-sy|n-p|y|`nnv|{H{vs|z-sy|n-p|y|Ovtu{rH{vs|z-rp@-z|qryO|{qv{tZn\x07H{vs|z-rp@-z|qryO|{qv{tZv{H<<-边缘增益{vs|z-sy|n-|yv{rTnv{H{vs|z-sy|n-qvn{prTnv{H0v{pyqr-Ip|zz|{K0v{pyqr-Is|tl}nlsntzr{K0v{pyqr-Iy|tqr}uosl}nlsntzr{K0v{pyqr-Ipyv}}v{tl}yn{rl}nlsntzr{Krp@-nqwP|y|arz}rnr5rp@-p|y|9-sy|n-rz}rnr6\n----<<-将色温范围从-:>;=-到->;=-映射到实际的色温范围----sy|n-rz}-J-5rz}rnr-8->;=6-7-B===;=H-<<-范围从-=-到->====----<<-计算色温系数----sy|n-lsnp|9-tlsnp|9-olsnp|H----vs-5rz}-IJ-CC==;=6-\n--------lsnp|-J->;=H--------tlsnp|-J-=;@F==E>BDEDCF=>FC=DEA-7-y|t5rz}-<->==;=6-:-=;C@>EA>AA@DEEC?DAB=FEH--------olsnp|-J-rz}-IJ->F==;=-L-=;=-G-=;BA@?=CDEF>>=>FC=DEA@-7-y|t5rz}-<->==;=-:->=;=6-:->;>FC?BA=EF>AH----\f-ryr-\n--------lsnp|-J->;?F?F@C>EC=C?DAB=FE=A-7-}|5rz}-<->==;=-:-C=;=9-:=;>@@?=ADBF?6H--------tlsnp|-J->;>?FEF=EC=EFB?FA>>DCB-7-}|5rz}-<->==;=-:-C=;=9-:=;=DBB>AEAF?6H--------olsnp|-J->;=H----\f----<<-调整颜色----rp@-nqwrqP|y|H----nqwrqP|y|;-J-pynz}5p|y|;-7-lsnp|9-=;=9->;=6H----nqwrqP|y|;t-J-pynz}5p|y|;t-7-tlsnp|9-=;=9->;=6H----nqwrqP|y|;o-J-pynz}5p|y|;o-7-olsnp|9-=;=9->;=6H----r{-nqwrqP|y|H\frp@-to?u5rp@-p6-\n----rpA-X-J-rpA5=;=9-:>;=-<-@;=9-?;=-<-@;=9-:>;=6H----rpA-}-J-zv\x075rpA5p;ot9-X;	69-rpA5p;to9-X;\x07\b69-r}5p;o9-p;t66H----rpA-\0-J-zv\x075rpA5};\x07\b9-p;69-rpA5p;9-};\b	\x0769-r}5};\x079-p;66H----sy|n-q-J-\0;\x07-:-zv{5\0;9-\0;\b6H----sy|n-r-J->;=r:>=H----r{-rp@5no5\0;	-8-5\0;-:-\0;\b6-<-5C;=-7-q-8-r669-q-<-5\0;\x07-8-r69-\0;\x076H\frp@-u?to5rp@-p6-\n----rpA-X-J-rpA5>;=9-?;=-<-@;=9->;=-<-@;=9-@;=6H----rp@-}-J-no5snp5p;\x07\x07\x07-8-X;\x07\b	6-7-C;=-:-X;6H----r{-p;	-7-zv\x075X;\x07\x07\x079-pynz}5}-:-X;\x07\x07\x079-=;=9->;=69-p;\b6H\fZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--<<-JJJ-点大小剔除-JJJ--vs-5]|v{`v	r-I-=;==>6-\n----qvpnqH--\f--<<-JJJ-前置裁切计算-JJJ--0vs-[bZlPYV]]R_`-K-=----o||y-pyv}}rqH----rpA-pyv}}r]|vv|{H----0}ntzn-{|yyly||}ln----s|-5-v{-v-J-=H-v-I-[bZlPYV]]R_`H-v-88-6-\n------pyv}}r]|vv|{-J-pyv}}rh-v-j;znv\x07V{rr-7-d|yq]|vv|{H------pyv}}rq-J-5pyv}}rh-v-j;sy||V{qr\x07-I-=;=-\v\v-no5sy||V{qr\x07-:-pyv}}rh-v-j;sy||V{qr\x076-I->;=6H------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;\x07-K-:=;B-33-pyv}}r]|vv|{;\x07-I-=;BH------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;\b-K-:=;B-33-pyv}}r]|vv|{;\b-I-=;BH------pyv}}rq-J-pyv}}rq-33-pyv}}r]|vv|{;	-K-:=;B-33-pyv}}r]|vv|{;	-I-=;BH------vs-5pyv}}rq6-\n--------qvpnqH------\f----\f----0}ntzn-{|yyly||}lr{q--0r{qvs--<<-JJJJJJJJJJJJJJJJ--sy|n-}-J-?;=-7-tyl]|v{P||q;\x07-:->;=H--sy|n-}-J-?;=-7-tyl]|v{P||q;\b-:->;=H--sy|n-}-J-}-7-}-8-}-7-}H--<<-JJJ-形状裁切-JJJ--0vs-qrsv{rq5b`Rl]\\V[al`UN]RlPV_PYR6----vs-5]|v{`v	r-K-@;=-33-}-K->;=6-\n------qvpnqH----\f--0r{qvs--<<-JJJJJJJJJJJJJ--0v{pyqr-Ipyv}}v{tl}yn{rlsntzr{K--0v{pyqr-Iy|tqr}uoslsntzr{K--<<-JJJ-颜色-JJJ--rpA-sv{nyP|y|-J-_TOa|Yv{rn5rpA5P|y|9-|}npv\b66H--0vs-qrsv{rq5b`Rl]\\V[al[\\_ZNY6----0vs-qrsv{rq5b`Rl]\\V[alONPXlUVQQR[6------rp@-pnzrnQvrpv|{-J-{|znyv	r5pnzrn]|vv|{-:-d|yq]|vv|{;\x07\b	6H------vs-5q|5pnzrnQvrpv|{9-[|zny6-I-=;=6-\n--------qvpnqH------\f----0ryvs-qrsv{rq5b`Rl]\\V[alONPXlQN_X6------rp@-pnzrnQvrpv|{-J-{|znyv	r5pnzrn]|vv|{-:-d|yq]|vv|{;\x07\b	6H------vs-5q|5pnzrnQvrpv|{9-[|zny6-I-=;=6-\n--------sv{nyP|y|;\x07\b	-J-sv{nyP|y|;\x07\b	-7-=;EH------\f----0r{qvs--0r{qvs--tylSntP|y|-J-sv{nyP|y|H--<<-JJJJJJJJJJJ--<<-JJJ-楼层显示-JJJ--sy|n-sy||\\}npv\b-J->;=H--vs-5u|{Sy||V{qr\x07-K-:=;=>-33-no5sy||V{qr\x07-:-u|{Sy||V{qr\x076-K-=;FF6-\n----sy||\\}npv\b-J-=;>-7-zv{55>;=-8-PnzrnQvrpv|{;\b69->;=6H--\f--tylSntP|y|;n-J-tylSntP|y|;n-7-sy||\\}npv\bH--<<-JJJJJJJJJJJJJJ--tylSntP|y|;n-J-tylSntP|y|;n-7-z|qryNy}unH--ZNV[lZ\\QRYlP\\Y\\_--0v{pyqr-I|{rzn}}v{tlsntzr{K--0v{pyqr-Ir{p|qv{tlsntzr{K--<<-JJJ-颜色增益调整-JJJ--rp@-toP|y|-J-tylSntP|y|;toH--rp@-uP|y|-J-to?u5toP|y|6H--uP|y|;\b-8J-p|y|`nnv|{H--uP|y|;	-8J-p|y|Ovtu{rH--tylSntP|y|;to-J-u?to5uP|y|6H--0v{pyqr-Is|tlsntzr{K--0v{pyqr-I}rzyv}yvrqlny}unlsntzr{K--<<-边缘增强--0vs-qrsv{rq5b`Rl]\\V[al[\\_ZNY6----rp@-toP|y|?-J-tylSntP|y|;toH----rp@-uP|y|?-J-to?u5toP|y|?6H----rp@-vrQv-J-{|znyv	r5v\\u|tn}uvp-L-PnzrnQvrpv|{-G-d|yq]|vv|{;\x07\b	-:-pnzrn]|vv|{6H----<<-计算边缘增益----sy|n-p|aurn-J-q|5{|znyv	r5[|zny69-vrQv6H----sy|n-n{tyr-J-np|5p|aurn6H----sy|n-|yv{rSnp|-J-}|5>;=-:-no5n{tyr-:-]VlUNYS6-<-]VlUNYS9-B;=6H----uP|y|?;	-8J-|yv{rTnv{-7-|yv{rSnp|H-<<-增加亮度----uP|y|?;	-J-pynz}5uP|y|?;	9-=;=9->;=6H------<<-距离增益----rp@-o|{qv{tPr{r-J-5z|qryO|{qv{tZn\x07-8-z|qryO|{qv{tZv{6-<-?;=H----sy|n-o|{qv{tYr{tu-J-yr{tu5z|qryO|{qv{tZn\x07;\b-:-z|qryO|{qv{tZv{;\b6-7->;BH----sy|n-nrntrQvn{pr-J->=;=H-<<-设定一个平均距离----rp@-pnzrna|]|v{-J-d|yq]|vv|{;\x07\b	-:-pnzrn]|vv|{H----sy|n-pnzrnO|{qv{tQvn{pr-J-zn\x075=;=9-yr{tu5pnzrn]|vv|{-:-o|{qv{tPr{r6-:-o|{qv{tYr{tu-<-?;=6H----sy|n-pnzrnQvn{pr-J-yr{tu5v\\u|tn}uvp-L-vrQv-7-q|5vrQv9-pnzrna|]|v{6-G-pnzrna|]|v{6-:-pnzrnO|{qv{tQvn{prH----sy|n-qvn{prSnp|-J-pynz}5zn\x075pnzrnQvn{pr-:-nrntrQvn{pr9-=;=6-<-o|{qv{tYr{tu9-=;=9->;=6H----qvn{prSnp|-J-5=;E-:-pynz}5>;=-:-}|5>;=-:-qvn{prSnp|9-@;=69-=;=9->;=66-7->?;=H----tylSntP|y|;n-8J-zv\x075tylSntP|y|;n-7-qvn{prTnv{-7-qvn{prSnp|9-=;=9-|yv{rSnp|6H-<<-增加透明度----tylSntP|y|;n-J-pynz}5tylSntP|y|;n9-=;=9->;=6H----tylSntP|y|;to-J-u?to5uP|y|?6H--0r{qvs--0vs-qrsv{rq5b`RlRQY6----tylSntP|y|;n-J-Y|tQr}uH--0r{qvs--0vs-qrsv{rq5b`RlU^ldRVTUa6----sy|n-qvn{pr-J-?;=-7-yr{tu5tyl]|v{P||q;\x07\b-:-=;B6H----sy|n-rvtu-J-zn\x075=;=9->;=-:-qvn{pr6H----rvtu-J-}|5rvtu9->;B6H----tylSntP|y|;n-J-rvtuH----tylSntP|y|;\x07\b	-J-tylSntP|y|;\x07\b	-7-rvtuH--0r{qvs--ZNV[lR[Q\f"),pointCloudVertexShader=function(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=113,De=126,Ve=0,Fe="";return $e[Ve].split(Fe).map(function(Je){return Je.charCodeAt(Ve)>De?Je:String.fromCharCode((Je.charCodeAt(Ve)+Be)%De)}).join(Fe)}("nvor-rp@-p|y|H0vs-qrsv{rq5b`RlP\\Y\\_lP\\[`aN[a6--{vs|z-rp@-p|{n{P|y|H0r{qvs0vs-qrsv{rq5b`RlP\\Y\\_lNYaVabQR6--{vs|z-nz}yr?Q-tnqvr{ar\x07rH0r{qvs0vs-qrsv{rq5b`RlRQY6--n\bv{t-sy|n-Y|tQr}uH0r{qvs{vs|z-rp?-r|yv|{H{vs|z-sy|n-}v\x07ry_nv|H{vs|z-sy|n-}|v{`pnyrH{vs|z-sy|n-}|v{Zv{]v\x07ryH{vs|z-sy|n-}|v{Zn\x07]v\x07ryH{vs|z-sy|n-|}npv\bH{vs|z-sy|n-tr|zrvpR|H{vs|z-rp@-z|qryO|{qv{tZn\x07H{vs|z-rp@-z|qryO|{qv{tZv{Hn\bv{t-rpA-d|yq]|vv|{Hn\bv{t-rp@-PnzrnQvrpv|{Hn\bv{t-rp@-P|y|Hn\bv{t-sy|n-]|v{`v	rH0vs-qrsv{rq5b`Rl]\\V[al[\\_ZNY6--n\bv{t-rp@-[|znyH0r{qvs0v{pyqr-Ip|zz|{K0v{pyqr-Is|tl}nlrr\x07K0v{pyqr-Iz|}untrl}nlrr\x07K0v{pyqr-Iy|tqr}uosl}nlrr\x07K0v{pyqr-Ipyv}}v{tl}yn{rl}nlrr\x07Krp@-trP|y|O\bUrvtu5nz}yr?Q-tnqvr{ar\x07r9-rpA-d|yq]|vv|{6-\n--sy|n--J-5d|yq]|vv|{;\b-:-z|qryO|{qv{tZv{;\b6-<-5z|qryO|{qv{tZn\x07;\b-:-z|qryO|{qv{tZv{;\b6H--r{-r\x07r?Q5tnqvr{ar\x07r9-rp?59-=;B66;toH\fZNV[lORS\\_R|vq-znv{56-\n--ZNV[l`aN_a--0v{pyqr-Iortv{lrr\x07K--d|yq]|vv|{-J-rpA5n{s|zrq9->;=6H--0vsqrs-b`RlV[`aN[PV[T----d|yq]|vv|{-J-v{n{prZnv\x07-7-d|yq]|vv|{H--0r{qvs--d|yq]|vv|{-J-z|qryZnv\x07-7-d|yq]|vv|{H--rpA-z]|vv|{-J-vrZnv\x07-7-d|yq]|vv|{H--tyl]|vv|{-J-}|wrpv|{Znv\x07-7-z]|vv|{H--0v{pyqr-Iy|tqr}uoslrr\x07K--0v{pyqr-Ipyv}}v{tl}yn{rlrr\x07K--zn@-pnzrn_|nv|{Znv\x07-J-zn@5vrZnv\x07h=jh=j9-vrZnv\x07h>jh=j9-vrZnv\x07h?jh=j9-vrZnv\x07h=jh>j9-vrZnv\x07h>jh>j9-vrZnv\x07h?jh>j9-vrZnv\x07h=jh?j9-vrZnv\x07h>jh?j9-vrZnv\x07h?jh?j6H--PnzrnQvrpv|{-J-{|znyv	r5pnzrn_|nv|{Znv\x07-7-rp@5=;=9-=;=9-:>;=66H--<<传递nvor的p|y|到s里使用--<<动态调整}|v{`v	r--sy|n-rny]|v{`v	r-J-}|v{`pnyr-7-}v\x07ry_nv|H--0vs-qrsv{rq5b`Rl]\\V[al`VgRlTR\\ZRa_VP6----rny]|v{`v	r-7J-tr|zrvpR|H----sy|n-urvtu-J->;=-<-}|wrpv|{Znv\x07h>jh>j-7-zv\x075>;=9-:z]|vv|{;	9-:}|wrpv|{Znv\x07h?jh@j6-7-?;=H----rny]|v{`v	r-J-r|yv|{;\b-7-rny]|v{`v	r-<-urvtuH--0ryvs-qrsv{rq5b`Rl]\\V[al`VgRlNaaR[bNaV\\[6----sy|n-urvtu-J->;=-<-}|wrpv|{Znv\x07h>jh>j-7-zv\x075>;=9-:z]|vv|{;	9-:}|wrpv|{Znv\x07h?jh@j6-7-?;=H----rny]|v{`v	r-J-r|yv|{;\b-7-rny]|v{`v	r-<-urvtuH--0r{qvs--tyl]|v{`v	r-J-pynz}5rny]|v{`v	r9-}|v{Zv{]v\x07ry-7-}v\x07ry_nv|9-}|v{Zn\x07]v\x07ry-7-}v\x07ry_nv|6H--]|v{`v	r-J-tyl]|v{`v	rH--P|y|-J-p|y|H--<<-JJJ-高度色-JJJ--0vs-qrsv{rq5b`RlP\\Y\\_lNYaVabQR6----P|y|-J-trP|y|O\bUrvtu5tnqvr{ar\x07r9-d|yq]|vv|{6H--0r{qvs--<<-JJJJJJJJJJJ--<<-JJJ-纯色-JJJ--0vs-qrsv{rq5b`RlP\\Y\\_lP\\[`aN[a6----P|y|-J-p|{n{P|y|H--0r{qvs--<<-JJJJJJJJJJJ--0vs-qrsv{rq5b`Rl]\\V[al[\\_ZNY6----[|zny-J-{|znyv	r5zn@5z|qryZnv\x076-7-{|zny6H--0r{qvs--0vs-qrsv{rq5b`RlRQY6----Y|tQr}u-J-y|t?5:z]|vv|{;	6H--0r{qvs--0vs-qrsv{rq5b`RlU^lQR]aU6----<<-sy|n-}|wSnp|-J-:=;B-7-r|yv|{;\b-<-5n{5s|-<-?;=6-7-z]|vv|{;	6H----<<-sy|n-_nqv-J-rny]|v{`v	r-<-}|wSnp|H----sy|n-|vtv{nyQr}u-J-tyl]|vv|{;H----sy|n-nqwrqQr}u-J-|vtv{nyQr}u-8-=;>H----sy|n-nqw-J-nqwrqQr}u-<-|vtv{nyQr}uH----z]|vv|{;\x07\b	-J-z]|vv|{;\x07\b	-7-nqwH----tyl]|vv|{-J-}|wrpv|{Znv\x07-7-z]|vv|{H--0r{qvs--0v{pyqr-I|yq}|lrr\x07K--0v{pyqr-Is|tlrr\x07K--ZNV[lR[Q\f");var pbmUniforms=Object.assign({pointScale:new Uniform(1),pointMinPixel:new Uniform(1),pointMaxPixel:new Uniform(1),opacity:new Uniform(1),gradientTexture:new Uniform(null),modelAlpha:new Uniform(0),clippers:new Uniform([]),shownFloorIndex:new Uniform(-1),constantColor:new Uniform(new Vector3),geometricError:new Uniform(0),pixelRatio:new Uniform(1),resolution:new Uniform(new Vector2(512,512)),floorIndex:new Uniform(0),brightness:new Uniform(1),modelBoundingMin:new Uniform(new Vector3),modelBoundingMax:new Uniform(new Vector3),colorSaturation:new Uniform(0),colorBrightness:new Uniform(0),outlineGain:new Uniform(0),distanceGain:new Uniform(0)},UniformsUtils.clone(UniformsLib.fog)),PBMPointCloudMaterial=function($e){__extends(Se,$e);function Se(Be){Be===void 0&&(Be={});var De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an,rn,on,sn,ln,cn,hn,mn,An,xn,pn,dn,fn,yn,Sn,gn=$e.call(this,{vertexShader:pointCloudVertexShader,fragmentShader:pointCloudFragmentShader,uniforms:UniformsUtils.clone(pbmUniforms),lights:!1,clipping:!0,defines:{USE_COLOR_CONSTANT:!1,USE_COLOR_ALTITUDE:!1,USE_EDL:!1,USE_HQ_WEIGHT:!1,USE_HQ_DEPTH:!1,NUM_CLIPPING_BOX:!1,USE_CLIPFLOOR:!1,USE_VERTEX_MARK:!1,USE_MAP:!0,USE_UV:!0,USE_LUMINANCE:!1,USE_BLACK_TRANSITION:!1,USE_POINT_NORMAL:!1,USE_POINT_SHAPE_CIRCLE:!1,USE_POINT_SIZE_ATTENUATION:!1,USE_POINT_SIZE_GEOMETRIC:!1,USE_POINT_BACK_HIDDEN:!1,USE_POINT_BACK_DARK:!1}})||this,Cn;return gn.customShaderHash="",gn.customShaderUniforms={},gn.customShaderDefines={},Object.defineProperties(gn,{constantColor:{get:function(){return this.uniforms.constantColor.value},set:function(Mn){this.uniforms.constantColor.value=Mn}},opacity:{get:function(){return this.uniforms.opacity.value},set:function(Mn){this.uniforms.opacity.value=Mn}},modelAlpha:{get:function(){return this.uniforms.modelAlpha.value},set:function(Mn){this.uniforms.modelAlpha.value=Mn}},shownFloorIndex:{get:function(){return this.uniforms.shownFloorIndex.value},set:function(Mn){this.uniforms.shownFloorIndex.value=Mn}},clippers:{get:function(){return Cn},set:function(Mn){Cn!==Mn&&(Cn=Mn,this.uniforms.clippers.value=(Cn||[]).map(function(Bn){var kn=typeof Bn.floorIndex=="number"?Bn.floorIndex:-1,Ln=new Matrix4().getInverse(Bn.clippingBoxMatrix);return{matrixInverse:Ln,floorIndex:kn}}),this.needsUpdate=!0)}},colorStyle:{get:function(){return this.defines.USE_COLOR_CONSTANT?"CONSTANT":this.defines.USE_COLOR_ALTITUDE?"ALTITUDE":"RGB"},set:function(Mn){var Bn=Mn==="CONSTANT",kn=Mn==="ALTITUDE";this.defines.USE_COLOR_CONSTANT!==Bn&&(this.defines.USE_COLOR_CONSTANT=Bn,this.needsUpdate=!0),this.defines.USE_COLOR_ALTITUDE!==kn&&(this.defines.USE_COLOR_ALTITUDE=kn,this.needsUpdate=!0)}},pointSize:{get:function(){return this.defines.USE_POINT_SIZE_GEOMETRIC===!0?"GEOMETRIC":this.defines.USE_POINT_SIZE_ATTENUATION===!0?"ATTENUATION":"FIXED"},set:function(Mn){var Bn=Mn==="ATTENUATION",kn=Mn==="GEOMETRIC";this.defines.USE_POINT_SIZE_GEOMETRIC!==kn&&(this.defines.USE_POINT_SIZE_GEOMETRIC=kn,this.needsUpdate=!0),this.defines.USE_POINT_SIZE_ATTENUATION!==Bn&&(this.defines.USE_POINT_SIZE_ATTENUATION=Bn,this.needsUpdate=!0)}},pointShape:{get:function(){return this.defines.USE_POINT_SHAPE_CIRCLE===!0?"CIRCLE":"SQUARE"},set:function(Mn){var Bn=Mn==="CIRCLE";this.defines.USE_POINT_SHAPE_CIRCLE!==Bn&&(this.defines.USE_POINT_SHAPE_CIRCLE=Bn,this.needsUpdate=!0)}},pointScale:{get:function(){return this.uniforms.pointScale.value},set:function(Mn){this.uniforms.pointScale.value=Mn}},pointBack:{get:function(){return this.defines.USE_POINT_BACK_HIDDEN===!0?"HIDDEN":this.defines.USE_POINT_BACK_DARK===!0?"DARK":"VISIBLE"},set:function(Mn){var Bn=Mn==="HIDDEN",kn=Mn==="DARK";this.defines.USE_POINT_BACK_HIDDEN!==Bn&&(this.defines.USE_POINT_BACK_HIDDEN=Bn,this.needsUpdate=!0),this.defines.USE_POINT_BACK_DARK!==kn&&(this.defines.USE_POINT_BACK_DARK=kn,this.needsUpdate=!0)}},pointMinPixel:{get:function(){return this.uniforms.pointMinPixel.value},set:function(Mn){this.uniforms.pointMinPixel.value=Mn}},pointMaxPixel:{get:function(){return this.uniforms.pointMaxPixel.value},set:function(Mn){this.uniforms.pointMaxPixel.value=Mn}},useEDL:{get:function(){return this.defines.USE_EDL},set:function(Mn){Mn!==this.defines.USE_EDL&&(this.defines.USE_EDL=Mn,this.needsUpdate=!0)}},useHQWeight:{get:function(){return this.defines.USE_HQ_WEIGHT},set:function(Mn){Mn!==this.defines.USE_HQ_WEIGHT&&(this.defines.USE_HQ_WEIGHT=Mn,this.needsUpdate=!0)}},useHQDepth:{get:function(){return this.defines.USE_HQ_DEPTH},set:function(Mn){Mn!==this.defines.USE_HQ_DEPTH&&(this.defines.USE_HQ_DEPTH=Mn,this.needsUpdate=!0)}},gradientTexture:{get:function(){return this.uniforms.gradientTexture.value},set:function(Mn){this.uniforms.gradientTexture.value=Mn}},floorIndex:{get:function(){return this.uniforms.floorIndex.value},set:function(Mn){this.uniforms.floorIndex.value=Mn}},brightness:{get:function(){return this.uniforms.brightness.value},set:function(Mn){this.uniforms.brightness.value=Mn}},colorSaturation:{get:function(){return this.uniforms.colorSaturation.value},set:function(Mn){this.uniforms.colorSaturation.value=Mn}},colorBrightness:{get:function(){return this.uniforms.colorBrightness.value},set:function(Mn){this.uniforms.colorBrightness.value=Mn}},outlineGain:{get:function(){return this.uniforms.outlineGain.value},set:function(Mn){this.uniforms.outlineGain.value=Mn}},distanceGain:{get:function(){return this.uniforms.distanceGain.value},set:function(Mn){this.uniforms.distanceGain.value=Mn}}}),gn.pano0=(De=Be.pano0)!==null&&De!==void 0?De:defaultPbmParameters.pano0,gn.pano1=(Ve=Be.pano1)!==null&&Ve!==void 0?Ve:defaultPbmParameters.pano1,gn.modelAlpha=(Fe=Be.modelAlpha)!==null&&Fe!==void 0?Fe:defaultPbmParameters.modelAlpha,gn.progress=(Je=Be.progress)!==null&&Je!==void 0?Je:defaultPbmParameters.progress,gn.transition=(Xe=Be.transition)!==null&&Xe!==void 0?Xe:defaultPbmParameters.transition,gn.colorStyle=(Ke=Be.colorStyle)!==null&&Ke!==void 0?Ke:defaultPbmParameters.colorStyle,gn.constantColor=(Ye=Be.constantColor)!==null&&Ye!==void 0?Ye:defaultPbmParameters.constantColor,gn.opacity=(or=Be.opacity)!==null&&or!==void 0?or:defaultPbmParameters.opacity,gn.floorStyle=(sr=Be.floorStyle)!==null&&sr!==void 0?sr:defaultPbmParameters.floorStyle,gn.shownFloorIndex=(cr=Be.shownFloorIndex)!==null&&cr!==void 0?cr:defaultPbmParameters.shownFloorIndex,gn.clippers=(Br=Be.clippers)!==null&&Br!==void 0?Br:defaultPbmParameters.clippers,gn.useEDL=(tn=Be.useEDL)!==null&&tn!==void 0?tn:defaultPbmParameters.useEDL,gn.useHQWeight=(en=Be.useHQWeight)!==null&&en!==void 0?en:defaultPbmParameters.useHQWeight,gn.useHQDepth=(an=Be.useHQDepth)!==null&&an!==void 0?an:defaultPbmParameters.useHQDepth,gn.pointShape=(rn=Be.pointShape)!==null&&rn!==void 0?rn:defaultPbmParameters.pointShape,gn.pointSize=(on=Be.pointSize)!==null&&on!==void 0?on:defaultPbmParameters.pointSize,gn.pointScale=(sn=Be.pointScale)!==null&&sn!==void 0?sn:defaultPbmParameters.pointScale,gn.pointBack=(ln=Be.pointBack)!==null&&ln!==void 0?ln:defaultPbmParameters.pointBack,gn.pointMinPixel=(cn=Be.pointMinPixel)!==null&&cn!==void 0?cn:defaultPbmParameters.pointMinPixel,gn.pointMaxPixel=(hn=Be.pointMaxPixel)!==null&&hn!==void 0?hn:defaultPbmParameters.pointMaxPixel,gn.gradientTexture=(mn=Be.gradientTexture)!==null&&mn!==void 0?mn:defaultPbmParameters.gradientTexture,gn.brightness=(An=Be.brightness)!==null&&An!==void 0?An:defaultPbmParameters.brightness,gn.colorSaturation=(xn=Be.colorSaturation)!==null&&xn!==void 0?xn:defaultPbmParameters.colorSaturation,gn.colorBrightness=(pn=Be.colorBrightness)!==null&&pn!==void 0?pn:defaultPbmParameters.colorBrightness,gn.outlineGain=(dn=Be.outlineGain)!==null&&dn!==void 0?dn:defaultPbmParameters.outlineGain,gn.distanceGain=(fn=Be.distanceGain)!==null&&fn!==void 0?fn:defaultPbmParameters.distanceGain,gn.customShaders=(yn=Be.customShaders)!==null&&yn!==void 0?yn:defaultPbmParameters.customShaders,gn.useAddBlend=(Sn=Be.useAddBlend)!==null&&Sn!==void 0?Sn:defaultPbmParameters.useAddBlend,gn.customShaderHash="",gn.floorIndex=0,gn.transparent=!0,gn}return Se.prototype.onBeforeCompile=function(Be,De){var Ve,Fe,Je=this.customShaders.filter(function(en){return en.type.includes("pointcloud")}),Xe=Je.reduce(function(en,an){return en+an.vertex.mainBefore},""),Ke=Je.reduce(function(en,an){return en+an.vertex.mainStart},""),Ye=Je.reduce(function(en,an){return en+an.vertex.mainEnd},""),or=Je.reduce(function(en,an){return en+an.fragment.mainBefore},""),sr=Je.reduce(function(en,an){return en+an.fragment.mainStart},""),cr=Je.reduce(function(en,an){return en+an.fragment.mainModelColor},""),Br=Je.reduce(function(en,an){return en+an.fragment.mainEnd},"");Be.vertexShader=Be.vertexShader.replace(/MAIN_BEFORE/g,Xe),Be.fragmentShader=Be.fragmentShader.replace(/MAIN_BEFORE/g,or),Be.vertexShader=Be.vertexShader.replace(/MAIN_START/g,Ke),Be.fragmentShader=Be.fragmentShader.replace(/MAIN_START/g,sr),Be.vertexShader=Be.vertexShader.replace(/MAIN_END/g,Ye),Be.fragmentShader=Be.fragmentShader.replace(/MAIN_END/g,Br),Be.fragmentShader=Be.fragmentShader.replace(/MAIN_MODEL_COLOR/g,cr);var tn=String((Fe=(Ve=this.clippers)===null||Ve===void 0?void 0:Ve.length)!==null&&Fe!==void 0?Fe:0);Be.vertexShader=Be.vertexShader.replace(/NUM_CLIPPERS/g,tn),Be.fragmentShader=Be.fragmentShader.replace(/NUM_CLIPPERS/g,tn),Je.forEach(function(en){en.onBeforeCompile(Be,De)})},Se.prototype.update=function(Be,De,Ve){var Fe="".concat(Ve.id,":").concat(Ve.materialVersion);Fe!==this.syncModelVersion&&(Object.assign(this,Ve.getMaterial()),this.syncModelVersion=Fe);var Je=this.customShaders.map(function(rn){return rn.getHash()}).join("");this.customShaderHash!==Je&&(this.customShaderHash=Je,this.needsUpdate=!0);for(var Xe=this.customShaders.reduce(function(rn,on){return Object.assign(rn,on.defines)},{}),Ke=Object.keys(this.customShaderDefines),Ye=0,or=Ke;Ye<or.length;Ye++){var sr=or[Ye];delete this.defines[sr]}this.customShaderDefines=Xe,Object.assign(this.defines,this.customShaderDefines);for(var cr=this.customShaders.reduce(function(rn,on){return Object.assign(rn,on.uniforms)},{}),Br=Object.keys(this.customShaderUniforms),tn=0,en=Br;tn<en.length;tn++){var an=en[tn];delete this.uniforms[an]}this.customShaderUniforms=cr,Object.assign(this.uniforms,this.customShaderUniforms),this.visible=!0,this.transparent=!1,this.shownFloorIndex>-1&&(this.transparent=this.shownFloorIndex!==this.floorIndex),this.modelAlpha<1&&(this.transparent=!0),this.opacity<1&&(this.transparent=!0),this.brightness<1&&(this.transparent=!0),this.useAddBlend?(this.depthWrite=!1,this.depthTest=!1,this.blending=AdditiveBlending):(this.depthWrite=!0,this.depthTest=!0,this.blending=NormalBlending),this.useEDL&&(this.transparent=!1),this.useHQWeight?(this.depthWrite=!1,this.blending=CustomBlending,this.blendSrc=SrcAlphaFactor,this.blendSrcAlpha=SrcAlphaFactor,this.blendDst=OneFactor,this.blendDstAlpha=OneFactor):(this.blending=NormalBlending,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null),this.floorStyle==="VISIBILITY"&&this.shownFloorIndex!==-1&&this.floorIndex!==this.shownFloorIndex&&(this.visible=!1),this.uniforms.pixelRatio.value=De.pixelRatio,this.uniforms.resolution.value.copy(De.resolution),this.uniforms.modelBoundingMax.value.copy(Ve.bounding.max),this.uniforms.modelBoundingMin.value.copy(Ve.bounding.min)},Se.prototype.copy=function(Be){return $e.prototype.copy.call(this,this),this.customShaders=Be.customShaders,this.pano0=Be.pano0,this.pano1=Be.pano1,this.progress=Be.progress,this.transition=Be.transition,this.floorStyle=Be.floorStyle,this.shownFloorIndex=Be.shownFloorIndex,this.brightness=Be.brightness,this.clippers=Be.clippers,this.constantColor=Be.constantColor,this.modelAlpha=Be.modelAlpha,this.useEDL=Be.useEDL,this.useHQWeight=Be.useHQWeight,this.useHQDepth=Be.useHQDepth,this.colorStyle=Be.colorStyle,this.pointSize=Be.pointSize,this.pointShape=Be.pointShape,this.pointScale=Be.pointScale,this.pointBack=Be.pointBack,this.pointMinPixel=Be.pointMinPixel,this.pointMaxPixel=Be.pointMaxPixel,this.gradientTexture=Be.gradientTexture,this.colorSaturation=Be.colorSaturation,this.colorBrightness=Be.colorBrightness,this.outlineGain=Be.outlineGain,this.distanceGain=Be.distanceGain,this.useAddBlend=Be.useAddBlend,this},Se}(ShaderMaterial),InternalWebGLRenderer=function($e){__extends(Se,$e);function Se(Be){var De=Be.preserveDrawingBuffer,Ve=De===void 0?!0:De,Fe=Be.premultipliedAlpha,Je=Fe===void 0?!0:Fe,Xe=Be.stencil,Ke=Xe===void 0?!0:Xe,Ye=Be.backgroundColor,or=Ye===void 0?1579548:Ye,sr=Be.backgroundAlpha,cr=sr===void 0?1:sr,Br=Be.pixelRatio,tn=Br===void 0?1:Br,en=Be.antialias,an=en===void 0?!1:en,rn=Be.webgl2,on=Be.logarithmicDepthBuffer,sn=Be.precision,ln=Be.powerPreference,cn=this,hn={antialias:an,alpha:!0,depth:!0,preserveDrawingBuffer:Ve,stencil:Ke,premultipliedAlpha:Je,powerPreference:ln},mn={logarithmicDepthBuffer:on,precision:sn};if(rn){var An=document.createElement("canvas"),xn=An.getContext("webgl2",hn);xn?cn=$e.call(this,__assign(__assign(__assign({},hn),mn),{antialias:!0,canvas:An,context:xn}))||this:(console.error("error occurred when getting webgl2 canvas context, mybe webgl2 not support, fallback to webgl."),cn=$e.call(this,__assign(__assign({},hn),mn))||this)}else cn=$e.call(this,__assign(__assign({},hn),mn))||this;return cn.setPixelRatio(tn),cn.setClearColor(or,cr),cn.outputEncoding=sRGBEncoding,cn.autoClear=!0,cn}return Se}(WebGLRenderer),Scene=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.add=function(){for(var Be=[],De=0;De<arguments.length;De++)Be[De]=arguments[De];return $e.prototype.add.apply(this,Be)},Se.prototype.remove=function(){for(var Be=[],De=0;De<arguments.length;De++)Be[De]=arguments[De];return $e.prototype.remove.apply(this,Be)},Se}(Scene$1);function coordinatesToVector($e,Se){var Be=Math.abs(Math.cos($e.latitude)),De=-Math.sin($e.longitude)*Be,Ve=-Math.sin($e.latitude),Fe=-Math.cos($e.longitude)*Be;return Se?Se.set(De,Ve,Fe):new Vector3(De,Ve,Fe)}var DEFAULT_ASPECT=1,DEFAULT_NEAR=.1,DEFAULT_FAR=2e3,TAU$2=Math.PI*2,PI_2$2=Math.PI/2;function formatRad$1($e){return $e>0&&$e<=TAU$2?$e:($e%TAU$2+TAU$2)%TAU$2}function matrixLerp($e,Se,Be,De){Be=Math.pow(Be,4);for(var Ve=0;Ve<16;Ve++)De.elements[Ve]=$e.elements[Ve]+(Se.elements[Ve]-$e.elements[Ve])*Be;return De}var Camera=function($e){__extends(Se,$e);function Se(Be,De,Ve,Fe,Je,Xe,Ke){De===void 0&&(De=DEFAULT_ASPECT),Ve===void 0&&(Ve=DEFAULT_NEAR),Fe===void 0&&(Fe=DEFAULT_FAR),Je===void 0&&(Je=new Vector2),Xe===void 0&&(Xe=new Vector2(512,512)),Ke===void 0&&(Ke=1);var Ye=$e.call(this)||this;Ye.fov=Be,Ye.aspect=De,Ye.near=Ve,Ye.far=Fe,Ye.perspToOrtho=Je,Ye.resolution=Xe,Ye.pixelRatio=Ke,Ye.time=0,Ye.needsRender=!0,Ye.refineModel=!0,Ye.pose={longitude:0,latitude:0,fov:Be,distance:0,offset:new Vector3},Ye.computePose(),Ye.perspectiveCamera=new PerspectiveCamera(Ye.fov,Ye.aspect,.001,Ye.far);var or=Math.max(Ye.orthoDistance,.01)*Math.tan(.5*Ye.fov/180*Math.PI),sr=-.5*Ye.aspect*2*or;return Ye.orthographicCamera=new OrthographicCamera(sr,-sr,or,-or,.001,Ye.far),Ye.computeProjectionMatrix(),Ye.lastValues={position:Ye.position.clone(),quaternion:Ye.quaternion.clone(),scale:Ye.scale.clone(),fov:Ye.fov,aspect:Ye.aspect,near:Ye.near,far:Ye.far,orthoDistance:Ye.orthoDistance,perspToOrtho:Ye.perspToOrtho.clone()},Ye.type=Ye.perspToOrtho.x<1?"PerspectiveCamera":"OrthographicCamera",Ye.autoNearFar=!0,Ye.environment=null,Ye}return Object.defineProperty(Se.prototype,"orthoDistance",{get:function(){return this.pose.distance>1?this.pose.distance:1+(this.pose.distance-1)*this.perspToOrtho.x},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"zoom",{get:function(){return this.type==="OrthographicCamera"?this.orthographicCamera.zoom:this.type==="PerspectiveCamera"?this.perspectiveCamera.zoom:1},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"top",{get:function(){return this.type==="OrthographicCamera"?this.orthographicCamera.top:0},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"bottom",{get:function(){return this.type==="OrthographicCamera"?this.orthographicCamera.bottom:0},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"left",{get:function(){return this.type==="OrthographicCamera"?this.orthographicCamera.left:0},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"right",{get:function(){return this.type==="OrthographicCamera"?this.orthographicCamera.right:0},enumerable:!1,configurable:!0}),Se.prototype.getDirection=function(Be){return coordinatesToVector(this.pose,Be)},Se.prototype.computePose=function(Be){Be===void 0&&(Be=0),this.updateMatrix();var De=this.matrix.elements;return this.pose.latitude=Math.asin(clamp$1(De[9],-1,1)),Math.abs(De[9])<.9999999?this.pose.longitude=formatRad$1(Math.atan2(De[8],De[10])):this.pose.longitude=formatRad$1(Math.atan2(-De[2],De[0])),this.pose.fov=this.fov,this.pose.distance=Be,this.pose.offset=new Vector3(-De[8],-De[9],-De[10]).setLength(this.pose.distance).add(this.position),this},Se.prototype.setFromPose=function(Be){var De,Ve,Fe,Je,Xe,Ke=formatRad$1((De=Be.longitude)!==null&&De!==void 0?De:this.pose.longitude),Ye=Math.max(-PI_2$2+1e-4,Math.min(PI_2$2-1e-4,(Ve=Be.latitude)!==null&&Ve!==void 0?Ve:this.pose.latitude)),or=(Fe=Be.fov)!==null&&Fe!==void 0?Fe:this.pose.fov,sr=(Je=Be.distance)!==null&&Je!==void 0?Je:this.pose.distance,cr=(Xe=Be.offset)!==null&&Xe!==void 0?Xe:this.pose.offset,Br=coordinatesToVector({longitude:Ke,latitude:Ye}).normalize();return this.position.set(0,0,0),this.lookAt(Br),this.position.add(cr).sub(Br.clone().setLength(sr)),this.fov!==or&&(this.fov=or,this.updateProjectionMatrix()),this.updateMatrixWorld(!0),this.pose.longitude=Ke,this.pose.latitude=Ye,this.pose.fov=or,this.pose.distance=sr,this.pose.offset.copy(cr),this.needsRender=!0,this},Se.prototype.copyPose=function(){return{longitude:this.pose.longitude,latitude:this.pose.latitude,fov:this.pose.fov,distance:this.pose.distance,offset:this.pose.offset.clone()}},Se.prototype.computeProjectionMatrix=function(){matrixLerp(this.orthographicCamera.projectionMatrix,this.perspectiveCamera.projectionMatrix,1-this.perspToOrtho.x,this.projectionMatrix),this.projectionMatrixInverse.getInverse(this.projectionMatrix),this.needsRender=!0},Se.prototype.setViewOffset=function(Be,De,Ve,Fe,Je,Xe){this.perspectiveCamera.setViewOffset(Be,De,Ve,Fe,Je,Xe),this.orthographicCamera.setViewOffset(Be,De,Ve,Fe,Je,Xe),this.computeProjectionMatrix()},Se.prototype.clearViewOffset=function(){this.perspectiveCamera.clearViewOffset(),this.orthographicCamera.clearViewOffset(),this.computeProjectionMatrix()},Se.prototype.updateProjectionMatrix=function(){this.perspectiveCamera.updateProjectionMatrix(),this.orthographicCamera.updateProjectionMatrix(),this.computeProjectionMatrix()},Object.defineProperty(Se.prototype,"perspectiveProjectionMatrix",{get:function(){return this.perspectiveCamera.projectionMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"perspectiveProjectionMatrixInverse",{get:function(){return this.perspectiveCamera.projectionMatrixInverse},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"orthographicProjectionMatrix",{get:function(){return this.orthographicCamera.projectionMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"orthographicProjectionMatrixInverse",{get:function(){return this.orthographicCamera.projectionMatrixInverse},enumerable:!1,configurable:!0}),Se.prototype.updateTime=function(Be){this.time=Be;var De=!1;if((this.lastValues.fov!==this.fov||this.lastValues.near!==this.near||this.lastValues.far!==this.far||this.lastValues.aspect!==this.aspect)&&(this.perspectiveCamera.fov=this.fov,this.perspectiveCamera.near=this.near,this.perspectiveCamera.far=this.far,this.perspectiveCamera.aspect=this.aspect,this.perspectiveCamera.updateProjectionMatrix(),De=!0),!this.lastValues.position.equals(this.position)||!this.lastValues.quaternion.equals(this.quaternion)||!this.lastValues.scale.equals(this.scale)||!this.lastValues.perspToOrtho.equals(this.perspToOrtho)||this.lastValues.fov!==this.fov||this.lastValues.near!==this.near||this.lastValues.far!==this.far||this.lastValues.orthoDistance!==this.orthoDistance||this.lastValues.aspect!==this.aspect){var Ve=Math.max(this.orthoDistance,.01)*Math.tan(.5*this.fov/180*Math.PI),Fe=-.5*this.aspect*2*Ve;this.orthographicCamera.left=Fe,this.orthographicCamera.right=-Fe,this.orthographicCamera.top=Ve,this.orthographicCamera.bottom=-Ve,this.orthographicCamera.near=this.near,this.orthographicCamera.far=this.far,this.orthographicCamera.updateProjectionMatrix(),De=!0}De&&this.computeProjectionMatrix(),this.lastValues.position.copy(this.position),this.lastValues.quaternion.copy(this.quaternion),this.lastValues.scale.copy(this.scale),this.lastValues.fov=this.fov,this.lastValues.aspect=this.aspect,this.lastValues.near=this.near,this.lastValues.far=this.far,this.lastValues.orthoDistance=this.orthoDistance,this.lastValues.perspToOrtho.copy(this.perspToOrtho),this.type=this.perspToOrtho.x<1?"PerspectiveCamera":"OrthographicCamera"},Object.defineProperty(Se.prototype,"isPerspectiveCamera",{get:function(){return this.perspToOrtho.x<1},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"isOrthographicCamera",{get:function(){return this.perspToOrtho.x>=1},enumerable:!1,configurable:!0}),Se.prototype.copy=function(Be,De){return $e.prototype.copy.call(this,Be,De),this.fov=Be.fov,this.aspect=Be.aspect,this.near=Be.near,this.far=Be.far,this.perspToOrtho.copy(Be.perspToOrtho),this.updateTime(now$2()),this},Se}(Camera$1),VolumePlaneIntersect;(function($e){$e[$e.Outside=-1]="Outside",$e[$e.Intersecting=0]="Intersecting",$e[$e.Inside=1]="Inside"})(VolumePlaneIntersect||(VolumePlaneIntersect={}));var EPSILON$2=1e-6,scratchVector=new Vector3,scratchMatrix4$4=new Matrix4,scratchXAxis=new Vector3,scratchYAxis=new Vector3,scratchZAxis=new Vector3,scratchSize=new Vector3,scratchBox3=new Box3,scratchSphere$1=new Sphere,scratchMatrix4Inverse$1=new Matrix4,scratchRay$1=new Ray,scratchObject3D=new Object3D,scratchFrustum=new Frustum;function quaternionFromMatrix3($e,Se){var Be=$e.elements;return Se.setFromRotationMatrix(scratchMatrix4$4.set(Be[0],Be[3],Be[6],0,Be[1],Be[4],Be[7],0,Be[2],Be[5],Be[8],0,0,0,0,1)),Se}var CullingVolume=function(){function $e(Se){Se===void 0&&(Se=[]),this.planes=Se}return Object.defineProperty($e,"MASK_OUTSIDE",{get:function(){return 4294967295},enumerable:!1,configurable:!0}),Object.defineProperty($e,"MASK_INSIDE",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty($e,"MASK_INDETERMINATE",{get:function(){return 2147483647},enumerable:!1,configurable:!0}),$e.prototype.setFromFrustum=function(Se){return this.planes=Se.planes.map(function(Be){return Be.clone()}),this},$e.prototype.setFromCamera=function(Se){return scratchMatrix4$4.multiplyMatrices(Se.projectionMatrix,Se.matrixWorldInverse),scratchFrustum.setFromProjectionMatrix(scratchMatrix4$4),this.setFromFrustum(scratchFrustum),this},$e.prototype.applyMatrix4=function(Se){for(var Be=0,De=this.planes;Be<De.length;Be++){var Ve=De[Be];Ve.applyMatrix4(Se)}},$e.prototype.copy=function(Se){return this.planes=Se.planes.map(function(Be){return Be.clone()}),this},$e.prototype.clone=function(){return new $e().copy(this)},$e.prototype.computeVisibility=function(Se){for(var Be=VolumePlaneIntersect.Inside,De=0,Ve=this.planes;De<Ve.length;De++){var Fe=Ve[De],Je=Se.intersectPlane(Fe);switch(Je){case VolumePlaneIntersect.Outside:return VolumePlaneIntersect.Outside;case VolumePlaneIntersect.Intersecting:Be=VolumePlaneIntersect.Intersecting;break}}return Be},$e.prototype.computeVisibilityWithPlaneMask=function(Se,Be){if(Be===$e.MASK_OUTSIDE||Be===$e.MASK_INSIDE)return Be;for(var De=$e.MASK_INSIDE,Ve=Math.min(32,this.planes.length),Fe=0;Fe<Ve;++Fe){var Je=1<<Fe;if(Be&Je){var Xe=this.planes[Fe],Ke=Se.intersectPlane(Xe);if(Ke===VolumePlaneIntersect.Outside)return $e.MASK_OUTSIDE;Ke===VolumePlaneIntersect.Intersecting&&(De|=Je)}}return De},$e}(),BoxBoundingVolume=function(){function $e(){this.type="box",this.center=new Vector3,this.halfSize=new Vector3,this.rotation=new Matrix3}return $e.prototype.fromJson=function(Se){var Be=Se.box;this.center.set(Be[0],Be[1],Be[2]);var De=Be[3],Ve=Be[4],Fe=Be[5],Je=Be[6],Xe=Be[7],Ke=Be[8],Ye=Be[9],or=Be[10],sr=Be[11],cr=Math.max(Math.sqrt(De*De+Ve*Ve+Fe*Fe),.001),Br=Math.max(Math.sqrt(Je*Je+Xe*Xe+Ke*Ke),.001),tn=Math.max(Math.sqrt(Ye*Ye+or*or+sr*sr),.001);this.halfSize.set(cr,Br,tn);var en=this.halfSize.toArray().reduce(function(an,rn){return an+rn},0);return(isNaN(en)||en<=0)&&this.halfSize.setScalar(EPSILON$2),this.rotation.fromArray([De/cr,Ve/cr,Fe/cr,Je/Br,Xe/Br,Ke/Br,Ye/tn,or/tn,sr/tn]),isNaN(this.rotation.toArray().reduce(function(an,rn){return an+rn},0))&&this.rotation.identity(),this},$e.prototype.toJson=function(){return this.rotation.extractBasis(scratchXAxis,scratchYAxis,scratchZAxis),{box:__spreadArray(__spreadArray(__spreadArray(__spreadArray([],this.center.toArray(),!0),scratchXAxis.multiplyScalar(this.halfSize.x).toArray(),!0),scratchYAxis.multiplyScalar(this.halfSize.y).toArray(),!0),scratchZAxis.multiplyScalar(this.halfSize.z).toArray(),!0)}},$e.prototype.copy=function(Se){return this.center.copy(Se.center),this.halfSize.copy(Se.halfSize),this.rotation.copy(Se.rotation),this},$e.prototype.clone=function(){return new $e().copy(this)},$e.prototype.applyMatrix4=function(Se){return scratchObject3D.position.copy(this.center),quaternionFromMatrix3(this.rotation,scratchObject3D.quaternion),scratchObject3D.scale.copy(this.halfSize),scratchObject3D.matrix.compose(scratchObject3D.position,scratchObject3D.quaternion,scratchObject3D.scale),scratchObject3D.matrix.premultiply(Se),scratchObject3D.matrix.decompose(scratchObject3D.position,scratchObject3D.quaternion,scratchObject3D.scale),this.center.copy(scratchObject3D.position),this.rotation.setFromMatrix4(scratchMatrix4$4.makeRotationFromQuaternion(scratchObject3D.quaternion)),this.halfSize.copy(scratchObject3D.scale),this},$e.prototype.getCenter=function(Se){return Se.copy(this.center)},$e.prototype.distanceSquaredToPoint=function(Se){var Be=this.rotation.elements,De=Se.x-this.center.x,Ve=Se.y-this.center.y,Fe=Se.z-this.center.z,Je=0,Xe;return Xe=De*Be[0]+Ve*Be[1]+Fe*Be[2],Xe<0&&(Xe=-Xe),Xe-=this.halfSize.x,Xe>0&&(Je+=Xe*Xe),Xe=De*Be[3]+Ve*Be[4]+Fe*Be[5],Xe<0&&(Xe=-Xe),Xe-=this.halfSize.y,Xe>0&&(Je+=Xe*Xe),Xe=De*Be[6]+Ve*Be[7]+Fe*Be[8],Xe<0&&(Xe=-Xe),Xe-=this.halfSize.z,Xe>0&&(Je+=Xe*Xe),Je},$e.prototype.distanceToPoint=function(Se){return Math.sqrt(this.distanceSquaredToPoint(Se))},$e.prototype.distanceToPlane=function(Se){var Be=Se.projectPoint(this.center,new Vector3);return this.distanceToPoint(Be)},$e.prototype.getBoundingBox=function(Se){return Se.makeEmpty(),this.rotation.extractBasis(scratchXAxis,scratchYAxis,scratchZAxis),scratchXAxis.setLength(this.halfSize.x),scratchYAxis.setLength(this.halfSize.y),scratchZAxis.setLength(this.halfSize.z),Se.expandByPoint(scratchVector.copy(this.center).add(scratchXAxis)),Se.expandByPoint(scratchVector.copy(this.center).sub(scratchXAxis)),Se.expandByPoint(scratchVector.copy(this.center).add(scratchYAxis)),Se.expandByPoint(scratchVector.copy(this.center).sub(scratchYAxis)),Se.expandByPoint(scratchVector.copy(this.center).add(scratchZAxis)),Se.expandByPoint(scratchVector.copy(this.center).sub(scratchZAxis)),Se},$e.prototype.toGeometry=function(){var Se=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),Be=new Float32Array(8*3);scratchVector.set(this.halfSize.x,this.halfSize.y,this.halfSize.z).applyMatrix3(this.rotation).add(this.center).toArray(Be,0),scratchVector.set(-this.halfSize.x,this.halfSize.y,this.halfSize.z).applyMatrix3(this.rotation).add(this.center).toArray(Be,3),scratchVector.set(-this.halfSize.x,-this.halfSize.y,this.halfSize.z).applyMatrix3(this.rotation).add(this.center).toArray(Be,6),scratchVector.set(this.halfSize.x,-this.halfSize.y,this.halfSize.z).applyMatrix3(this.rotation).add(this.center).toArray(Be,9),scratchVector.set(this.halfSize.x,this.halfSize.y,-this.halfSize.z).applyMatrix3(this.rotation).add(this.center).toArray(Be,12),scratchVector.set(-this.halfSize.x,this.halfSize.y,-this.halfSize.z).applyMatrix3(this.rotation).add(this.center).toArray(Be,15),scratchVector.set(-this.halfSize.x,-this.halfSize.y,-this.halfSize.z).applyMatrix3(this.rotation).add(this.center).toArray(Be,18),scratchVector.set(this.halfSize.x,-this.halfSize.y,-this.halfSize.z).applyMatrix3(this.rotation).add(this.center).toArray(Be,21);var De=new BufferGeometry;return De.setIndex(new BufferAttribute(Se,1)),De.setAttribute("position",new BufferAttribute(Be,3)),De.computeBoundingBox(),De.computeBoundingSphere(),De},$e.prototype.intersectPlane=function(Se){var Be=this.center,De=Se.normal,Ve=this.rotation.elements,Fe=this.halfSize,Je=De.x,Xe=De.y,Ke=De.z,Ye=Math.abs(Je*Ve[0]*Fe.x+Xe*Ve[1]*Fe.x+Ke*Ve[2]*Fe.x)+Math.abs(Je*Ve[3]*Fe.y+Xe*Ve[4]*Fe.y+Ke*Ve[5]*Fe.y)+Math.abs(Je*Ve[6]*Fe.z+Xe*Ve[7]*Fe.z+Ke*Ve[8]*Fe.z),or=De.dot(Be)+Se.constant;return or<=-Ye?VolumePlaneIntersect.Outside:or>=Ye?VolumePlaneIntersect.Inside:VolumePlaneIntersect.Intersecting},$e.prototype.intersectRay=function(Se,Be){if(scratchSize.copy(this.halfSize).multiplyScalar(2),scratchBox3.setFromCenterAndSize(scratchVector.set(0,0,0),scratchSize),this.rotation.extractBasis(scratchXAxis,scratchYAxis,scratchZAxis),scratchMatrix4$4.makeBasis(scratchXAxis,scratchYAxis,scratchZAxis),scratchMatrix4$4.setPosition(this.center),scratchMatrix4Inverse$1.getInverse(scratchMatrix4$4),scratchRay$1.copy(Se).applyMatrix4(scratchMatrix4Inverse$1),scratchBox3.containsPoint(scratchRay$1.origin))return!0;var De=scratchRay$1.intersectBox(scratchBox3,scratchVector);return De?Be!==void 0?De.applyMatrix4(scratchMatrix4$4).distanceTo(Se.origin)<Be:!0:!1},$e}(),SphereBoundingVolume=function(){function $e(){this.type="sphere",this.center=new Vector3,this.radius=-1}return $e.prototype.fromJson=function(Se){var Be=Se.sphere;return this.center.set(Be[0],Be[1],Be[2]),this.radius=Math.max(Be[3],EPSILON$2),this},$e.prototype.toJson=function(){return{sphere:__spreadArray(__spreadArray([],this.center.toArray(),!0),[this.radius],!1)}},$e.prototype.copy=function(Se){return this.center.copy(Se.center),this.radius=Se.radius,this},$e.prototype.clone=function(){return new $e().copy(this)},$e.prototype.getBoundingBox=function(Se){return Se.setFromCenterAndSize(this.center,scratchSize.set(1,1,1).multiplyScalar(this.radius*2)),Se},$e.prototype.toGeometry=function(){for(var Se=32,Be=new Float32Array(Se*3*2*2),De=0;De<=Se;De++){var Ve=0;Ve=De/Se*Math.PI*2,Be[De*6+0]=this.center.x+Math.cos(Ve)*this.radius,Be[De*6+1]=this.center.y+Math.sin(Ve)*this.radius,Be[De*6+2]=this.center.z+0,Ve=(De+1)/Se*Math.PI*2,Be[De*6+3]=this.center.x+Math.cos(Ve)*this.radius,Be[De*6+4]=this.center.y+Math.sin(Ve)*this.radius,Be[De*6+5]=this.center.z+0}for(var De=Se;De<=Se*2;De++){var Ve=0;Ve=De/Se*Math.PI*2,Be[De*6+0]=this.center.x+Math.cos(Ve)*this.radius,Be[De*6+1]=this.center.y+0,Be[De*6+2]=this.center.z+Math.sin(Ve)*this.radius,Ve=(De+1)/Se*Math.PI*2,Be[De*6+3]=this.center.x+Math.cos(Ve)*this.radius,Be[De*6+4]=this.center.y+0,Be[De*6+5]=this.center.z+Math.sin(Ve)*this.radius}var Fe=new BufferGeometry;return Fe.setAttribute("position",new BufferAttribute(Be,3)),Fe.computeBoundingBox(),Fe.computeBoundingSphere(),Fe},$e.prototype.applyMatrix4=function(Se){return this.center.applyMatrix4(Se),this.radius=this.radius*Se.getMaxScaleOnAxis(),this},$e.prototype.getCenter=function(Se){return Se.copy(this.center)},$e.prototype.distanceSquaredToPoint=function(Se){var Be=this.distanceToPoint(Se);return Be*Be},$e.prototype.distanceToPoint=function(Se){var Be=this.center.distanceTo(Se)-this.radius;return Be<=0?0:Be},$e.prototype.distanceToPlane=function(Se){var Be=Math.abs(Se.distanceToPoint(this.center));return Math.max(0,Be-this.radius)},$e.prototype.intersectPlane=function(Se){var Be=this.center,De=this.radius,Ve=Se.normal,Fe=Ve.dot(Be)+Se.constant;return Fe<-De?VolumePlaneIntersect.Outside:Fe<De?VolumePlaneIntersect.Intersecting:VolumePlaneIntersect.Inside},$e.prototype.intersectRay=function(Se,Be){if(scratchSphere$1.set(this.center,this.radius),scratchSphere$1.containsPoint(Se.origin))return!0;var De=Se.intersectSphere(scratchSphere$1,scratchVector);return De?Be!==void 0?Se.origin.distanceTo(De)<Be:!0:!1},$e}(),RegionBoundingVolume=function(){function $e(){throw this.type="regin",this.west=0,this.south=0,this.east=0,this.north=0,this.minHeight=0,this.maxHeight=0,new Error("Region bounding volume not supported.")}return $e.prototype.fromJson=function(Se){var Be=Se.region;return this.west=Be[0],this.south=Be[1],this.east=Be[2],this.north=Be[3],this.minHeight=Be[4],this.maxHeight=Be[5],this},$e.prototype.toJson=function(){return{region:[this.west,this.south,this.east,this.north,this.minHeight,this.maxHeight]}},$e.prototype.copy=function(Se){return this.west=Se.west,this.south=Se.south,this.east=Se.east,this.north=Se.north,this.minHeight=Se.minHeight,this.maxHeight=Se.maxHeight,this},$e.prototype.clone=function(){return new $e().copy(this)},$e.prototype.getBoundingBox=function(Se){throw new Error("not implemented")},$e.prototype.toGeometry=function(){throw new Error("not implemented")},$e.prototype.applyMatrix4=function(Se){throw new Error("not implemented")},$e.prototype.getCenter=function(Se){throw new Error("not implemented")},$e.prototype.distanceToPoint=function(Se){throw new Error("not implemented")},$e.prototype.distanceSquaredToPoint=function(Se){throw new Error("not implemented")},$e.prototype.distanceToPlane=function(Se){throw new Error("not implemented")},$e.prototype.intersectPlane=function(Se){throw new Error("not implemented")},$e.prototype.intersectRay=function(Se){throw new Error("not implemented")},$e}();function isBoundingVolume($e){return $e instanceof BoxBoundingVolume||$e instanceof SphereBoundingVolume||$e instanceof RegionBoundingVolume}function makeBoundingVolume($e){if("box"in $e)return new BoxBoundingVolume().fromJson($e);if("sphere"in $e)return new SphereBoundingVolume().fromJson($e);if("region"in $e)return new RegionBoundingVolume().fromJson($e);throw new Error("BoundingVolume ".concat(JSON.stringify($e)," never suppored."))}var debugMaterials=[4821759,8191922,16637280,16739958,5822969,376977,16747077,9259235,14514687].map(function($e){return new LineBasicMaterial({color:$e,depthWrite:!1,depthTest:!1,transparent:!0})}),debugBoxGeometry=function(){var $e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),Se=new Float32Array(8*3);scratchVector.set(1,1,1).toArray(Se,0),scratchVector.set(-1,1,1).toArray(Se,3),scratchVector.set(-1,-1,1).toArray(Se,6),scratchVector.set(1,-1,1).toArray(Se,9),scratchVector.set(1,1,-1).toArray(Se,12),scratchVector.set(-1,1,-1).toArray(Se,15),scratchVector.set(-1,-1,-1).toArray(Se,18),scratchVector.set(1,-1,-1).toArray(Se,21);var Be=new BufferGeometry;return Be.setIndex(new BufferAttribute($e,1)),Be.setAttribute("position",new BufferAttribute(Se,3)),Be.computeBoundingBox(),Be.computeBoundingSphere(),Be}(),debugSphereGeometry=function(){for(var $e=32,Se=new Float32Array($e*3*2*2),Be=0;Be<=$e;Be++){var De=0;De=Be/$e*Math.PI*2,Se[Be*6+0]=Math.cos(De),Se[Be*6+1]=Math.sin(De),Se[Be*6+2]=0,De=(Be+1)/$e*Math.PI*2,Se[Be*6+3]=Math.cos(De),Se[Be*6+4]=Math.sin(De),Se[Be*6+5]=0}for(var Be=$e;Be<=$e*2;Be++){var De=0;De=Be/$e*Math.PI*2,Se[Be*6+0]=Math.cos(De),Se[Be*6+1]=0,Se[Be*6+2]=Math.sin(De),De=(Be+1)/$e*Math.PI*2,Se[Be*6+3]=Math.cos(De),Se[Be*6+4]=0,Se[Be*6+5]=Math.sin(De)}var Ve=new BufferGeometry;return Ve.setAttribute("position",new BufferAttribute(Se,3)),Ve.computeBoundingBox(),Ve.computeBoundingSphere(),Ve}();function createDebugBoundingMesh($e,Se){if($e instanceof BoxBoundingVolume){var Be=new LineSegments(debugBoxGeometry,debugMaterials[Math.min(Se,debugMaterials.length-1)]);return Be.position.copy($e.center),quaternionFromMatrix3($e.rotation,Be.quaternion),Be.scale.set($e.halfSize.x,$e.halfSize.y,$e.halfSize.z),Be.matrix.compose(Be.position,Be.quaternion,Be.scale),Be}else if($e instanceof SphereBoundingVolume){var Be=new LineSegments(debugSphereGeometry,debugMaterials[Math.min(Se,debugMaterials.length-1)]);return Be.position.copy($e.center),Be.scale.set($e.radius,$e.radius,$e.radius),Be.matrix.compose(Be.position,Be.quaternion,Be.scale),Be}throw new Error("never")}var scratchVector3$4=new Vector3,Tile=function(){function $e(Se,Be,De,Ve){var Fe=this,Je,Xe,Ke,Ye;this.parent=null,this.contentParent=null,this.floor=0,this.id=Se,this.state={visible:!1,frameNumber:0,selectedFrameNumber:0,requestedFrameNumber:0,touchedFrameNumber:0,distanceToCamera:0,centerZDepth:0,centerScreenY:0,screenSpaceError:0,visibilityPlaneMask:0,inRequestVolume:!1,shouldRefine:!1,stackLength:0,finalResolution:!0,selectionDepth:0,shouldSelect:!1,lastSelect:!1,ancestorWithContent:null,ancestorWithContentAvailable:null},this.parent=Ve??null,this.contentParent=Ve?Ve.hasRenderContent?Ve:Ve.contentParent:null,this.level=this.parent?this.parent.level+1:0,this.tileset=De,this.refine=(Je=Be.refine)!==null&&Je!==void 0?Je:this.parent?this.parent.refine:"REPLACE",this.transform=new Matrix4,Be.transform&&this.transform.fromArray(Be.transform),this.parent&&this.transform.premultiply(this.parent.transform),typeof Be.geometricError=="number"?this.geometricError=Be.geometricError*this.transform.getMaxScaleOnAxis():this.geometricError=(Ke=(Xe=this.parent)===null||Xe===void 0?void 0:Xe.geometricError)!==null&&Ke!==void 0?Ke:0,Be.content&&Be.content.uri?(this.content={uri:Be.content.uri,loadState:"UNLOADED",loadStateUpdateTime:now$2(),loadfailRetryDelay:0,byteLength:0,memoryUsage:0},Be.content.group!==void 0&&(this.content.group=Be.content.group),Be.content.boundingVolume&&(this.content.boundingVolume=makeBoundingVolume(Be.content.boundingVolume).applyMatrix4(this.transform)),/\.json$/.test(this.content.uri)?this.type="TILESET":this.type="SCENEGRAPH"):(this.content=null,this.type="EMPTY"),this.levelOfContent=this.parent?this.parent.levelOfContent:-1,this.type==="SCENEGRAPH"&&(this.levelOfContent=this.levelOfContent+1),Be.boundingVolume&&(this.boundingVolume=makeBoundingVolume(Be.boundingVolume).applyMatrix4(this.transform)),Be.viewerRequestVolume&&(this.viewerRequestVolume=makeBoundingVolume(Be.viewerRequestVolume).applyMatrix4(this.transform)),this.extras=(Ye=Be.extras)!==null&&Ye!==void 0?Ye:{},typeof this.extras.floor!="number"&&Ve&&typeof Ve.extras.floor=="number"&&(this.extras.floor=Ve.extras.floor),typeof this.extras.floor=="number"&&(this.floor=this.extras.floor,this.tileset.floorLength=Math.max(this.tileset.floorLength,this.floor+1)),this.boundingVolume&&(this.boundingVolumeDebugObject=createDebugBoundingMesh(this.boundingVolume,this.levelOfContent)),Be.children?this.children=Be.children.map(function(or,sr){return new $e("".concat(Fe.id,".").concat(sr),or,De,Fe)}):this.children=[]}return $e.prototype.traverse=function(Se){Se(this);for(var Be=0,De=this.children;Be<De.length;Be++){var Ve=De[Be];Ve.traverse(Se)}},$e.prototype.updateState=function(Se){this.state.frameNumber=Se.frameNumber;var Be=this.tileset.transformIsIdentity?null:this.tileset.transform;if(this.boundingVolume){var De=Be?this.boundingVolume.clone().applyMatrix4(Be):this.boundingVolume;if(Se.camera.type==="OrthographicCamera"){var Ve=new Plane().setFromNormalAndCoplanarPoint(Se.camera.direction,Se.camera.position);this.state.distanceToCamera=De.distanceToPlane(Ve)}else this.state.distanceToCamera=De.distanceToPoint(Se.camera.position);var Fe=De.getCenter(scratchVector3$4).sub(Se.camera.position);this.state.centerZDepth=Se.camera.direction.dot(Fe),this.state.centerScreenY=Se.camera.up.dot(Fe);var Je=this.parent?this.parent.state.visibilityPlaneMask:CullingVolume.MASK_INDETERMINATE;this.state.visibilityPlaneMask=Se.cullingVolume.computeVisibilityWithPlaneMask(De,Je),this.state.visible=this.state.visibilityPlaneMask!==CullingVolume.MASK_OUTSIDE}else this.state.distanceToCamera=0,this.state.centerZDepth=0,this.state.visibilityPlaneMask=CullingVolume.MASK_INDETERMINATE,this.state.visible=!0;if((this.levelOfContent<=Se.minLevelOfDetail||this.geometricError>=Se.maxGeometricError)&&(this.state.visible=!0),this.viewerRequestVolume){var Xe=Be?this.viewerRequestVolume.clone().applyMatrix4(Be):this.viewerRequestVolume;this.state.inRequestVolume=Xe.distanceSquaredToPoint(Se.camera.position)<=0}else this.state.inRequestVolume=!0;this.state.screenSpaceError=this.getScreenSpaceError(Se,this.state.distanceToCamera,!1)},Object.defineProperty($e.prototype,"selected",{get:function(){return this.state.selectedFrameNumber===this.tileset.frameNumber},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"hasChildren",{get:function(){return this.children.length>0},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"siblingIndex",{get:function(){var Se,Be;return(Be=(Se=this.parent)===null||Se===void 0?void 0:Se.children.indexOf(this))!==null&&Be!==void 0?Be:0},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"hasTilesetContent",{get:function(){return this.children.length>0&&this.type==="TILESET"},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"hasRenderContent",{get:function(){return this.type==="SCENEGRAPH"},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"contentAvailable",{get:function(){var Se;return this.hasRenderContent&&((Se=this.content)===null||Se===void 0?void 0:Se.loadState)==="READY"},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"hasUnloadedContent",{get:function(){var Se;return((Se=this.content)===null||Se===void 0?void 0:Se.loadState)==="UNLOADED"},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"hasEmptyContent",{get:function(){return this.type==="EMPTY"},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"contentReady",{get:function(){var Se;return((Se=this.content)===null||Se===void 0?void 0:Se.loadState)==="READY"||this.hasEmptyContent},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"contentByteLength",{get:function(){return this.content?this.content.byteLength:0},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"contentMemoryUsage",{get:function(){return this.content?this.content.memoryUsage:0},enumerable:!1,configurable:!0}),$e.prototype.getScreenSpaceError=function(Se,Be,De){var Ve=this.tileset.transformIsIdentity?1:this.tileset.transform.getMaxScaleOnAxis(),Fe=this.parent?this.parent.geometricError:this.tileset.geometricError,Je=Ve*(De?Fe:this.geometricError);if(Je===0)return 0;var Xe=Se.height,Ke=Se.sseDenominator;if(Se.camera.type==="OrthographicCamera"){var Ye=Se.camera.projectionMatrix.elements,or=1/(Ye[5]/2),sr=.9,cr=or/Xe*sr,Br=Je/cr;return Br}else{var tn=Math.max(Be,.001),cr=tn*Ke/Xe,Br=Je/cr;return Br}},$e.prototype.getPriority=function(){var Se=this.refine==="ADD"||this.tileset.skipLevelOfDetail;if(Se&&!this.state.visible||this.tileset.frameNumber-this.state.touchedFrameNumber>=1)return-1;var Be=this.parent,De=Be&&(!Se||this.state.screenSpaceError===0),Ve=De?Be.state.screenSpaceError:this.state.screenSpaceError,Fe=this.tileset.root?this.tileset.root.state.screenSpaceError:0,Je=Math.max(Fe-Ve,0);return Je},$e}(),priorityCache=new Map;function getPriority($e,Se){if(Se&&Se.has($e))return Se.get($e);var Be=$e.refine==="ADD"||$e.tileset.skipLevelOfDetail,De=$e.parent,Ve=De&&(!Be||$e.state.screenSpaceError===0),Fe=Ve?De.state.screenSpaceError:$e.state.screenSpaceError,Je=$e.tileset.root?$e.tileset.root.state.screenSpaceError:0,Xe=Math.max(Je-Fe,0);return Se&&Se.set($e,Xe),Xe}var TileRequestScheduler=function(){function $e(Se,Be){this.tileset=Se,this.options=Be,this.activeRequests=0,this.requestQueue=[]}return $e.prototype.reset=function(){for(var Se=0,Be=this.requestQueue;Se<Be.length;Se++){var De=Be[Se];this.options.onTileSkip&&this.options.onTileSkip(De.tile)}this.requestQueue.length=0},$e.prototype.update=function(Se,Be,De){for(var Ve=this,Fe=De.time,Je=this.requestQueue,Xe=new Set(Se),Ke=0;Ke<Je.length;Ke++){var Ye=Je[Ke];if(Xe.has(Ye.tile)){Xe.delete(Ye.tile);continue}Ye.status==="WAITING"&&(Je.splice(Ke,1),Ke--,this.options.onTileSkip&&this.options.onTileSkip(Ye.tile))}Xe.size>0&&(Xe.forEach(function(rn){Je.push({tile:rn,status:"WAITING",time:Fe,error:null})}),Xe.clear());for(var or=this.tileset.maxRequests,Ke=0;Ke<Je.length&&or>0;Ke++){var Ye=Je[Ke];if(Ye.status==="DONE")Ye.error!==null?this.options.onTileError&&this.options.onTileError(Ye.tile,Ye.error):(or--,Ye.tile.content&&(Ye.tile.content.loadState="READY"),this.options.onTileLoad&&this.options.onTileLoad(Ye.tile)),Je.splice(Ke,1),Ke--;else if(Ye.status==="PENDING"&&Fe-Ye.time<1e3)break}switch(priorityCache.clear(),Be){case"SCREEN_SPACE_ERROR":{Je.sort(function(rn,on){if(rn.tile.state.requestedFrameNumber!==on.tile.state.requestedFrameNumber)return on.tile.state.requestedFrameNumber-rn.tile.state.requestedFrameNumber;if(rn.tile.state.requestedFrameNumber===De.frameNumber){var sn=getPriority(rn.tile,priorityCache),ln=getPriority(on.tile,priorityCache);return sn-ln}else return rn.tile.level!==on.tile.level?rn.tile.level-on.tile.level:rn.tile.state.distanceToCamera-on.tile.state.distanceToCamera});break}case"SCREEN_VERTICAL":{Je.sort(function(rn,on){return rn.tile.state.requestedFrameNumber!==on.tile.state.requestedFrameNumber?on.tile.state.requestedFrameNumber-rn.tile.state.requestedFrameNumber:rn.tile.state.requestedFrameNumber===De.frameNumber?rn.tile.state.centerScreenY!==on.tile.state.centerScreenY?rn.tile.state.centerScreenY-on.tile.state.centerScreenY:rn.tile.state.centerZDepth!==on.tile.state.centerZDepth?rn.tile.state.centerZDepth-on.tile.state.centerZDepth:rn.tile.level!==on.tile.level?rn.tile.level-on.tile.level:rn.tile.state.distanceToCamera-on.tile.state.distanceToCamera:rn.tile.level!==on.tile.level?rn.tile.level-on.tile.level:rn.tile.state.distanceToCamera-on.tile.state.distanceToCamera});break}case"SCREEN_LEVEL_VERTICAL":{Je.sort(function(rn,on){return rn.tile.state.requestedFrameNumber!==on.tile.state.requestedFrameNumber?on.tile.state.requestedFrameNumber-rn.tile.state.requestedFrameNumber:rn.tile.state.requestedFrameNumber===De.frameNumber?rn.tile.level!==on.tile.level?rn.tile.level-on.tile.level:rn.tile.state.centerScreenY!==on.tile.state.centerScreenY?rn.tile.state.centerScreenY-on.tile.state.centerScreenY:rn.tile.state.centerZDepth!==on.tile.state.centerZDepth?rn.tile.state.centerZDepth-on.tile.state.centerZDepth:rn.tile.state.distanceToCamera-on.tile.state.distanceToCamera:rn.tile.level!==on.tile.level?rn.tile.level-on.tile.level:rn.tile.state.distanceToCamera-on.tile.state.distanceToCamera});break}}if(or=Math.max(this.tileset.maxRequests-this.activeRequests,0),!this.tileset.skipLevelOfDetail)for(var sr=0,cr=Je.length,Ke=0;Ke<cr;Ke++){var Br=Je[Ke].tile;if(Br.hasTilesetContent||Br.contentParent===null||Br.contentParent.state.selectedFrameNumber===this.tileset.frameNumber){var tn=Je.splice(Ke,1);Je.splice.apply(Je,__spreadArray([sr++,0],tn,!1))}}for(var en=function(on){var sn=Je[on];sn.status==="WAITING"&&(or--,sn.status="PENDING",sn.time=Fe,an.activeRequests++,an.tileset.options.tileLoader(sn.tile).catch(function(ln){sn.error=ln}).then(function(){sn.status="DONE",sn.tile.content&&sn.tile.content.loadState==="READY"&&(sn.tile.content.loadState="LOADING"),Ve.activeRequests--}))},an=this,Ke=0;Ke<Je.length&&or>0;Ke++)en(Ke)},$e}(),CacheNode=function(){function $e(Se,Be,De){this.item=Se,this.previous=Be,this.next=De}return $e}(),CacheNodeList=function(){function $e(){this.head=null,this.tail=null,this._length=0}return Object.defineProperty($e.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),$e.prototype.add=function(Se){var Be=new CacheNode(Se,this.tail,null);return this.tail?(this.tail.next=Be,this.tail=Be):(this.head=Be,this.tail=Be),this._length++,Be},$e.prototype.remove=function(Se){Se.previous&&Se.next?(Se.previous.next=Se.next,Se.next.previous=Se.previous):Se.previous?(Se.previous.next=null,this.tail=Se.previous):Se.next?(Se.next.previous=null,this.head=Se.next):(this.head=null,this.tail=null),Se.next=null,Se.previous=null,this._length--},$e.prototype.splice=function(Se,Be){Se!==Be&&(this.remove(Be),this.insert(Se,Be))},$e.prototype.insert=function(Se,Be){var De=Se.next;Se.next=Be,this.tail===Se?this.tail=Be:De.previous=Be,Be.next=De,Be.previous=Se,this._length++},$e.prototype.toArray=function(){for(var Se=[],Be=this.head;Be;)Se.push(Be),Be=Be.next;return Se},$e}(),TileCache=function(){function $e(Se){Se===void 0&&(Se={}),this.options=Se,this.cacheNodeMap=new Map,this.list=new CacheNodeList,this.sentinel=this.list.add("sentinel")}return $e.prototype.reset=function(){this.list.tail&&this.list.splice(this.list.tail,this.sentinel)},$e.prototype.touchTile=function(Se){var Be=this.cacheNodeMap.get(Se);Be&&this.list.splice(this.sentinel,Be)},$e.prototype.loadTile=function(Se){if(!this.cacheNodeMap.has(Se)){var Be=this.list.add(Se);this.cacheNodeMap.set(Se,Be),this.options.onTileLoad&&this.options.onTileLoad(Se)}},$e.prototype.unloadTile=function(Se){var Be=this.cacheNodeMap.get(Se);Be&&(this.list.remove(Be),this.cacheNodeMap.delete(Se),this.options.onTileUnload&&this.options.onTileUnload(Se))},$e.prototype.unloadTiles=function(Se){for(var Be=this.list.head;Be!==this.sentinel&&Se();){var De=Be.item;Be=Be.next,this.unloadTile(De)}},$e.prototype.toArray=function(){for(var Se=[],Be=0,De=this.list.toArray();Be<De.length;Be++){var Ve=De[Be];Ve.item!=="sentinel"&&Se.push(Ve.item)}return Se},$e}(),ManagedArray=function(){function $e(){this.map=new Map,this.array=[],this._length=0}return Object.defineProperty($e.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),$e.prototype.get=function(Se){return this.array[Se]},$e.prototype.set=function(Se,Be){Se>=this.length&&(this._length=Se+1),this.map.has(this.array[Se])&&this.map.delete(this.array[Se]),this.array[Se]=Be,this.map.set(Be,Se)},$e.prototype.delete=function(Se){var Be=this.map.get(Se);Be!==void 0&&Be>=0&&(this.array.splice(Be,1),this.map.delete(Se),this._length--)},$e.prototype.push=function(Se){if(!this.map.has(Se)){var Be=this._length++;this.array[Be]=Se,this.map.set(Se,Be)}},$e.prototype.pop=function(){var Se=this.array[--this._length];return this.map.delete(Se),this.array[this._length]=void 0,Se},$e.prototype.reset=function(){this.array=[],this.map=new Map,this._length=0},$e.prototype.find=function(Se){return this.map.has(Se)},$e.prototype.peek=function(){return this.array[this._length-1]},$e}(),TilesetBaseTraverser=function(){function $e(Se){this.tileset=Se,this._canSelectTile=!0,this._loadAllTilesTraversalStack=new ManagedArray,this.root=null}return $e.prototype.traverse=function(Se,Be,De){this.root=Se,this.reset()},$e.prototype.reset=function(){this._loadAllTilesTraversalStack.reset(),this.tileset.hasMixedContent=!1,this.tileset.needsRefinedTiles.clear(),this.tileset.requestedTiles.length=0,this.tileset.selectedTiles.length=0},$e.prototype.updateTile=function(Se,Be){this.updateTileVisibility(Se,Be),Se.state.shouldSelect=!1,Se.state.finalResolution=!0},$e.prototype.selectTile=function(Se,Be){var De=Se.contentAvailable&&this._canSelectTile;De&&Se.state.selectedFrameNumber<Be.frameNumber&&(Se.state.selectedFrameNumber=Be.frameNumber,this.tileset.selectedTiles.push(Se),this.tileset.needsRefinedTiles.add(Se))},$e.prototype.loadTile=function(Se,Be){Se.state.requestedFrameNumber<Be.frameNumber&&(Se.state.requestedFrameNumber=Be.frameNumber,Se.content&&(Se.content.loadState==="FAILED"&&Be.time-Se.content.loadStateUpdateTime>Se.content.loadfailRetryDelay&&(Se.content.loadState="UNLOADED",Se.content.loadStateUpdateTime=Be.time),Se.content.loadState==="UNLOADED"&&this.tileset.requestedTiles.push(Se))),this.tileset.needsRefinedTiles.add(Se)},$e.prototype.touchTile=function(Se,Be){this.tileset.cache.touchTile(Se),Se.state.touchedFrameNumber=Be.frameNumber},$e.prototype.canTraverse=function(Se,Be){return!Se.state.inRequestVolume||Se.levelOfContent>=Be.maxLevelOfDetail||Se.levelOfContent>=0&&Se.geometricError<=Be.minGeometricError||Se.children.length===0?!1:Se.levelOfContent<=Be.minLevelOfDetail||Se.geometricError>=Be.maxGeometricError||Se.hasTilesetContent?!0:Se.state.screenSpaceError>this.tileset.currentMaxScreenSpaceError},$e.prototype.updateTileVisibility=function(Se,Be){if(Se.updateState(Be),!(!Se.state.visible||!Se.state.inRequestVolume)){var De=Se.children.length>0;if(Se.hasTilesetContent&&De){var Ve=Se.children[0];this.updateTileVisibility(Ve,Be),Se.state.visible=Ve.state.visible;return}if(this.meetsScreenSpaceErrorEarly(Se,Be)){Se.state.visible=!1;return}var Fe=Se.refine==="REPLACE";if(Fe&&De&&!this.anyChildrenVisible(Se,Be)){Se.state.visible=!1;return}}},$e.prototype.anyChildrenVisible=function(Se,Be){for(var De=!1,Ve=Se.children,Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe];Xe.updateState(Be),De=De||Xe.state.visible}return De},$e.prototype.meetsScreenSpaceErrorEarly=function(Se,Be){var De=Se.parent;return!De||De.refine!=="ADD"||De.levelOfContent<Be.minLevelOfDetail||De.geometricError>Be.maxGeometricError?!1:De.levelOfContent>Be.maxLevelOfDetail||De.levelOfContent>=0&&De.geometricError<Be.minGeometricError?!0:Se.getScreenSpaceError(Be,Se.state.distanceToCamera,!0)<this.tileset.currentMaxScreenSpaceError},$e.prototype.sortTilesByDistanceToCamera=function(Se){Se.sort(function(Be,De){return De.state.distanceToCamera===0&&Be.state.distanceToCamera===0?De.state.centerZDepth-Be.state.centerZDepth:De.state.distanceToCamera-Be.state.distanceToCamera})},$e.prototype.loadAllTiles=function(Se,Be){var De=this._loadAllTilesTraversalStack;for(De.push(Se);De.length>0;){var Ve=De.pop();Ve.content&&Ve.content.loadState==="UNLOADED"&&Ve.state.requestedFrameNumber<Be.frameNumber&&this.tileset.requestedTiles.push(Ve),this.touchTile(Ve,Be);for(var Fe=0,Je=Ve.children;Fe<Je.length;Fe++){var Xe=Je[Fe];De.push(Xe)}}},$e}(),TilesetNormalTraverser=function($e){__extends(Se,$e);function Se(Be){var De=$e.call(this,Be)||this;return De.tileset=Be,De._traversalStack=new ManagedArray,De._emptyTraversalStack=new ManagedArray,De}return Se.prototype.traverse=function(Be,De,Ve){Ve===void 0&&(Ve=[]),$e.prototype.traverse.call(this,Be,De,Ve);for(var Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe];this._traversalStack.reset(),this._emptyTraversalStack.reset(),Xe.camera.refine&&(this._canSelectTile=Xe.camera.visible,this.updateTile(Be,Xe),this.executeTraversal(Be,Xe))}this._traversalStack.reset(),this._emptyTraversalStack.reset(),De.camera.refine&&(this._canSelectTile=De.camera.visible,this.updateTile(Be,De),this.executeTraversal(Be,De)),this.tileset.loadAll&&this.loadAllTiles(Be,De)},Se.prototype.reset=function(){$e.prototype.reset.call(this),this._traversalStack.reset(),this._emptyTraversalStack.reset()},Se.prototype.executeTraversal=function(Be,De){var Ve=this._traversalStack;for(Be.state.visible&&Be.state.inRequestVolume&&Ve.push(Be);Ve.length>0;){var Fe=Ve.pop(),Je=Fe.parent,Xe=!Je||Je.state.shouldRefine,Ke=!1;this.canTraverse(Fe,De)&&(Ke=this.updateAndPushChildren(Fe,De,Ve)&&Xe);var Ye=!Ke&&Xe;Fe.hasRenderContent?Fe.refine==="ADD"?(this.loadTile(Fe,De),this.selectDesiredTile(Fe,De)):Fe.refine==="REPLACE"&&(this.loadTile(Fe,De),Ye&&this.selectDesiredTile(Fe,De)):(this.loadTile(Fe,De),Ye&&this.selectDesiredTile(Fe,De)),this.touchTile(Fe,De),Fe.state.shouldRefine=Ke}},Se.prototype.updateAndPushChildren=function(Be,De,Ve){for(var Fe=Be.children,Je=0,Xe=Fe;Je<Xe.length;Je++){var Ke=Xe[Je];this.updateTile(Ke,De)}this.sortTilesByDistanceToCamera(Fe);for(var Ye=Be.refine==="REPLACE"&&Be.hasRenderContent,or=!1,sr=!0,cr=0,Br=Fe;cr<Br.length;cr++){var Ke=Br[cr];if(Ke.levelOfContent<=De.minLevelOfDetail||Ke.geometricError>=De.maxGeometricError||Ke.state.visible&&Ke.state.inRequestVolume?(Ve.find(Ke)&&Ve.delete(Ke),Ve.push(Ke),or===!1&&(or=!0)):(Ye||this.tileset.loadSiblings)&&(this.loadTile(Ke,De),this.touchTile(Ke,De)),Ye){var tn=void 0;Ke.state.inRequestVolume?Ke.hasRenderContent?tn=Ke.contentAvailable:tn=this.executeEmptyTraversal(Ke,De):tn=!1,sr=sr&&tn}}return or||(sr=!1),sr},Se.prototype.selectDesiredTile=function(Be,De){Be.contentAvailable&&$e.prototype.selectTile.call(this,Be,De)},Se.prototype.executeEmptyTraversal=function(Be,De){var Ve=!0,Fe=this._emptyTraversalStack;for(Fe.push(Be);Fe.length>0&&Ve;){var Je=Fe.pop(),Xe=!Je.hasRenderContent&&this.canTraverse(Je,De);if(!Xe&&!Je.contentAvailable&&(Ve=!1),this.updateTile(Je,De),Je.state.visible||(this.loadTile(Je,De),this.touchTile(Je,De)),Xe)for(var Ke=Je.children,Ye=0,or=Ke;Ye<or.length;Ye++){var sr=or[Ye];Fe.find(sr)&&Fe.delete(sr),Fe.push(sr)}}return Ve},Se}(TilesetBaseTraverser),TilesetSkipTraverser=function($e){__extends(Se,$e);function Se(Be){var De=$e.call(this,Be)||this;return De.tileset=Be,De.baseScreenSpaceError=1024,De.skipScreenSpaceErrorFactor=16,De.skipLevels=1,De._traversalStack=new ManagedArray,De._descendantTraversalStack=new ManagedArray,De._selectionTraversalStack=new ManagedArray,De._selectionTraversalancestorStack=new ManagedArray,De}return Se.prototype.traverse=function(Be,De,Ve){Ve===void 0&&(Ve=[]),$e.prototype.traverse.call(this,Be,De,Ve);for(var Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe];this._traversalStack.reset(),Xe.camera.refine&&(this._canSelectTile=Xe.camera.visible,this.updateTile(Be,Xe),this.executeTraversal(Be,Xe),this.traverseAndSelect(Be,Xe))}this.tileset.hasMixedContent=!1,this._traversalStack.reset(),this._descendantTraversalStack.reset(),this._selectionTraversalStack.reset(),this._selectionTraversalancestorStack.reset(),De.camera.refine&&(this._canSelectTile=De.camera.visible,this.updateTile(Be,De),this.executeTraversal(Be,De),this.traverseAndSelect(Be,De)),this.tileset.loadAll&&this.loadAllTiles(Be,De)},Se.prototype.reset=function(){$e.prototype.reset.call(this),this._traversalStack.reset(),this._descendantTraversalStack.reset(),this._selectionTraversalStack.reset(),this._selectionTraversalancestorStack.reset()},Se.prototype.executeTraversal=function(Be,De){var Ve=this._traversalStack;for(Be.state.visible&&Be.state.inRequestVolume&&Ve.push(Be);Ve.length>0;){var Fe=Ve.pop();this.updateTileAncestorContentLinks(Fe,De);var Je=Fe.parent,Xe=!Je||Je.state.shouldRefine,Ke=!1;this.canTraverse(Fe,De)&&(Ke=this.updateAndPushChildren(Fe,De,Ve)&&Xe);var Ye=!Ke&&Xe;Fe.hasRenderContent?Fe.refine==="ADD"?(this.loadTile(Fe,De),this.selectDesiredTile(Fe,De)):Fe.refine==="REPLACE"&&(this.inBaseTraversal(Fe,this.baseScreenSpaceError)?(this.loadTile(Fe,De),Ye&&this.selectDesiredTile(Fe,De)):Ye?(this.loadTile(Fe,De),this.selectDesiredTile(Fe,De)):this.reachedSkippingThreshold(Fe)&&this.loadTile(Fe,De)):(this.loadTile(Fe,De),Ye&&this.selectDesiredTile(Fe,De)),this.touchTile(Fe,De),Fe.state.shouldRefine=Ke}},Se.prototype.updateAndPushChildren=function(Be,De,Ve){for(var Fe=Be.children,Je=0,Xe=Fe;Je<Xe.length;Je++){var Ke=Xe[Je];this.updateTile(Ke,De)}this.sortTilesByDistanceToCamera(Fe);for(var Ye=!1,or=0,sr=Fe;or<sr.length;or++){var Ke=sr[or];Ke.levelOfContent<=De.minLevelOfDetail||Ke.geometricError>=De.maxGeometricError||Ke.state.visible&&Ke.state.inRequestVolume?(Ve.push(Ke),Ye===!1&&(Ye=!0)):this.tileset.loadSiblings&&(this.loadTile(Ke,De),this.touchTile(Ke,De))}return Ye},Se.prototype.selectDesiredTile=function(Be,De){var Ve=Be.contentAvailable?Be:Be.state.ancestorWithContentAvailable;Ve&&(Ve.state.shouldSelect=!0),Be.contentAvailable||this.selectDescendants(Be,De)},Se.prototype.selectDescendants=function(Be,De){var Ve=this._descendantTraversalStack;for(Ve.push(Be);Ve.length>0;)for(var Fe=Ve.pop(),Je=Fe.children,Xe=0,Ke=Je;Xe<Ke.length;Xe++){var Ye=Ke[Xe];Ye.state.visible&&(Ye.contentAvailable?(this.updateTile(Ye,De),this.touchTile(Ye,De),this.selectTile(Ye,De)):Ve.push(Ye))}},Se.prototype.reachedSkippingThreshold=function(Be){var De=Be.state.ancestorWithContent,Ve=De!==null&&Be.state.screenSpaceError<De.state.screenSpaceError/this.skipScreenSpaceErrorFactor&&Be.levelOfContent>De.levelOfContent+this.skipLevels;return Ve},Se.prototype.updateTileAncestorContentLinks=function(Be,De){Be.state.ancestorWithContent=null,Be.state.ancestorWithContentAvailable=null;var Ve=Be.parent;if(Ve){var Fe=!(Ve.hasRenderContent&&Ve.hasUnloadedContent)||Ve.state.requestedFrameNumber===De.frameNumber;Be.state.ancestorWithContent=Fe?Ve:Ve.state.ancestorWithContent,Be.state.ancestorWithContentAvailable=Ve.contentAvailable?Ve:Ve.state.ancestorWithContentAvailable}},Se.prototype.inBaseTraversal=function(Be,De){return Be.state.ancestorWithContent?Be.parent&&Be.state.screenSpaceError===0?Be.parent.state.screenSpaceError>De:Be.state.screenSpaceError>De:!0},Se.prototype.traverseAndSelect=function(Be,De){var Ve=this._selectionTraversalStack,Fe=this._selectionTraversalancestorStack,Je;for(Ve.push(Be);Ve.length>0||Fe.length>0;){if(Fe.length>0){var Xe=Fe.peek();if(Xe.state.stackLength===Ve.length){Fe.pop(),Xe!==Je&&(Xe.state.finalResolution=!1),this.selectTile(Xe,De);continue}}var Ke=Ve.pop();if(Ke){var Ye=this.canTraverse(Ke,De);if(Ke.state.shouldSelect)if(Ke.refine==="ADD")this.selectTile(Ke,De);else{if(Ke.state.selectionDepth=Fe.length,Ke.state.selectionDepth>0&&(Ke.tileset.hasMixedContent=!0),Je=Ke,!Ye){this.selectTile(Ke,De);continue}Fe.push(Ke),Ke.state.stackLength=Ve.length}if(Ye)for(var or=0,sr=Ke.children;or<sr.length;or++){var cr=sr[or];cr.state.visible&&Ve.push(cr)}}}},Se}(TilesetBaseTraverser),TilesetMostDetailTraverser=function($e){__extends(Se,$e);function Se(Be){var De=$e.call(this,Be)||this;return De.tileset=Be,De._traversalStack=new ManagedArray,De}return Se.prototype.canTraverse=function(Be,De){return!(!Be.state.inRequestVolume||Be.levelOfContent>=De.maxLevelOfDetail||Be.levelOfContent>=0&&Be.geometricError<=De.minGeometricError||Be.children.length===0)},Se.prototype.traverse=function(Be,De,Ve){$e.prototype.traverse.call(this,Be,De,[]),this._traversalStack.reset(),Be.updateState(De);for(var Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe];this._traversalStack.reset(),Xe.camera.refine&&(this._canSelectTile=Xe.camera.visible,Be.updateState(Xe),this.executeTraversal(Be,Xe))}this._traversalStack.reset(),De.camera.refine&&(this._canSelectTile=De.camera.visible,Be.updateState(De),this.executeTraversal(Be,De)),this.tileset.loadAll&&this.loadAllTiles(Be,De)},Se.prototype.reset=function(){$e.prototype.reset.call(this),this._traversalStack.reset()},Se.prototype.executeTraversal=function(Be,De){var Ve=this._traversalStack;for(Ve.push(Be);Ve.length>0;){var Fe=Ve.pop(),Je=Fe.refine==="ADD",Xe=Fe.refine==="REPLACE",Ke=this.canTraverse(Fe,De);Ke&&this.updateAndPushChildren(Fe,De,Ve),(Je||Xe&&!Ke)&&(this.loadTile(Fe,De),this.touchTile(Fe,De),this.selectDesiredTile(Fe,De))}},Se.prototype.updateAndPushChildren=function(Be,De,Ve){for(var Fe=Be.children,Je=0;Je<Fe.length;++Je){var Xe=Fe[Je];Xe.updateState(De),Xe.state.visible&&Ve.push(Xe)}},Se.prototype.selectDesiredTile=function(Be,De){Be.contentAvailable&&$e.prototype.selectTile.call(this,Be,De)},Se}(TilesetBaseTraverser),Trajectory=function(){function $e(Se,Be,De){this.index=Se,this.name=Be.name,this.visible=!1,this.tileset=De,this.transform=new Matrix4,Be.transform&&this.transform.fromArray(Be.transform),this.transform.premultiply(this.tileset.root.transform),this.content={uri:Be.file,byteLength:0,memoryUsage:0,loadState:"UNLOADED",loadStateUpdateTime:now$2(),loadfailRetryDelay:0,data:void 0}}return $e}(),identityMatrix4=new Matrix4,Tileset=function(){function $e(Se,Be,De){var Ve=this,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br;if(this.id=Se,this.transform=new Matrix4,this.transformIsIdentity=!0,this.hasMixedContent=!1,this.url=(Fe=De.url)!==null&&Fe!==void 0?Fe:"",this.referer=(Je=De.referer)!==null&&Je!==void 0?Je:"",this.asset={version:Be.asset.version,tilesetVersion:Be.asset.tilesetVersion||"",gltfUpAxis:(Xe=Be.asset.gltfUpAxis)!==null&&Xe!==void 0?Xe:"Y",overview:Be.asset.overview,trajectories:(Ye=(Ke=Be.asset.trajectories)===null||Ke===void 0?void 0:Ke.list)!==null&&Ye!==void 0?Ye:[],extras:Be.asset.extras},this.rootMeta=(or=Be.rootMeta)!==null&&or!==void 0?or:{},this.pointLength=(sr=this.rootMeta.numTotalPoints)!==null&&sr!==void 0?sr:1/0,this.floorLength=(cr=this.rootMeta.numFloors)!==null&&cr!==void 0?cr:1,this.properties=(Br=Be.properties)!==null&&Br!==void 0?Br:{},this.options=De,this.memoryOverflow=$e.DEFAULT_MEMORY_OVERFLOW,this.maxMemoryUsage=$e.DEFAULT_MAX_MEMORY_USAGE,this.memoryAdjustedScreenSpaceError=$e.DEFAULT_MEMORY_ADJUSTED_SCREEN_SPACE_ERROR,this.maxScreenSpaceError=$e.DEFAULT_MAX_SCREEN_SPACE_ERROR,this.skipLevelOfDetail=$e.DEFAULT_SKIP_LEVEL_OF_DETAIL,this.mostDetail=$e.DEFAULT_MOST_DETAIL,this.loadSiblings=$e.DEFAULT_LOAD_SIBLINGS,this.loadAll=$e.DEFAULT_LOAD_ALL,this.maxRequests=$e.DEFAULT_MAX_REQUESTS,this.tileRequestOrder=$e.DEFAULT_REQUEST_ORDER,this.requestedTiles=[],this.selectedTiles=[],this.unloadTiles=[],this.needsRefinedTiles=new Set,this.selectedTrajectories=[],this.normalTraverser=new TilesetNormalTraverser(this),this.skipTraverser=new TilesetSkipTraverser(this),this.mostDetailTraverser=new TilesetMostDetailTraverser(this),this.cache=new TileCache({onTileLoad:function(an){Ve.cacheMemoryUsageInBytes+=an.contentMemoryUsage},onTileUnload:function(an){Ve.cacheMemoryUsageInBytes-=an.contentMemoryUsage,Ve.unloadTiles.push(an)}}),this.requestScheduler=new TileRequestScheduler(this,{onTileSkip:function(an){},onTileLoad:function(an){var rn;!((rn=an.content)===null||rn===void 0)&&rn.data&&(Ve.loadedTiles.add(an),Ve.cache.loadTile(an)),Ve.options.onTileLoad(an)},onTileError:function(an,rn){Ve.options.onTileError(an,rn)}}),this.frameNumber=0,this.maxLevelOfDetail=0,this.minLevelOfDetail=0,this.minGeometricError=0,this.maxGeometricError=0,this.loadedTiles=new Set,this.cacheMemoryUsageInBytes=0,this.currentMaxScreenSpaceError=this.maxScreenSpaceError,this.root=new Tile("".concat(this.id,".0"),Be.root,this),this.geometricError=Be.geometricError,this.trajectories=[],this.asset.trajectories)for(var tn=0;tn<this.asset.trajectories.length;tn++){var en=new Trajectory(tn,this.asset.trajectories[tn],this);this.trajectories.push(en)}}return $e.prototype.adjustScreenSpaceError=function(){if(this.memoryAdjustedScreenSpaceError){var Se=0;this.needsRefinedTiles.forEach(function(Ve){Ve.content&&(Se+=Ve.content.memoryUsage)});var Be=(this.maxMemoryUsage-this.memoryOverflow)*1024*1024,De=this.maxMemoryUsage*1024*1024;Se<Be?this.currentMaxScreenSpaceError=Math.max(this.currentMaxScreenSpaceError/1.02,this.maxScreenSpaceError):Se>De&&this.selectedTiles.length>0&&(this.currentMaxScreenSpaceError*=1.02)}else this.currentMaxScreenSpaceError=this.maxScreenSpaceError},Object.defineProperty($e.prototype,"traverser",{get:function(){return this.mostDetail?this.mostDetailTraverser:this.skipLevelOfDetail?this.skipTraverser:this.normalTraverser},enumerable:!1,configurable:!0}),$e.prototype.reset=function(){for(var Se=this,Be=[this.root],De;De=Be.pop();){for(var Ve=0,Fe=De.children.length;Ve<Fe;Ve++)Be.push(De.children[Ve]);this.cache.unloadTile(De)}for(var Je=function(){var or=Xe.unloadTiles.pop();or&&(Xe.loadedTiles.delete(or),Xe.cacheMemoryUsageInBytes-=or.contentMemoryUsage,Xe.options.tileUnloader(or).catch(function(){}).then(function(){Se.options.onTileUnload&&Se.options.onTileUnload(or)}))},Xe=this;this.unloadTiles.length;)Je();this.cache.reset(),this.traverser.reset(),this.requestScheduler.reset(),this.loadedTiles.clear();for(var Ke=function(){var or=Ye.trajectories.pop();or&&Ye.options.trajectoryUnloader(or).catch(function(){}).then(function(){Se.options.onTrajectoryUnload&&Se.options.onTrajectoryUnload(or)})},Ye=this;this.trajectories.length;)Ke()},$e.prototype.update=function(Se,Be){var De=this,Ve;Be===void 0&&(Be=[]),this.frameNumber=Se.frameNumber,this.minLevelOfDetail=Se.minLevelOfDetail,this.maxLevelOfDetail=Se.maxLevelOfDetail,this.minGeometricError=Se.minGeometricError,this.maxGeometricError=Se.maxGeometricError,this.adjustScreenSpaceError(),this.transformIsIdentity=this.transform.equals(identityMatrix4),this.traverser.traverse(this.root,Se,Be),this.cache.unloadTiles(function(){var cr=De.cacheMemoryUsageInBytes>De.maxMemoryUsage*1024*1024;return cr}),this.requestScheduler.update(this.requestedTiles,this.tileRequestOrder,Se);for(var Fe=function(){var cr=Je.unloadTiles.pop();cr&&(Je.loadedTiles.delete(cr),Je.options.tileUnloader(cr).catch(function(){}).then(function(){De.options.onTileUnload&&De.options.onTileUnload(cr)}))},Je=this;this.unloadTiles.length;)Fe();this.selectedTrajectories.length=0;for(var Xe=function(cr){cr.visible===!0&&cr.content.loadState==="READY"&&!((Ve=cr.content.data)===null||Ve===void 0)&&Ve.object?Ke.selectedTrajectories.push(cr):cr.visible===!0&&(cr.content.loadState==="FAILED"&&Se.time-cr.content.loadStateUpdateTime>cr.content.loadfailRetryDelay&&(cr.content.loadState="UNLOADED",cr.content.loadStateUpdateTime=Se.time),cr.content.loadState==="UNLOADED"&&Ke.options.trajectoryLoader(cr).then(function(){De.options.onTrajectoryLoad(cr)}).catch(function(Br){De.options.onTrajectoryError(cr,Br)}))},Ke=this,Ye=0,or=this.trajectories;Ye<or.length;Ye++){var sr=or[Ye];Xe(sr)}},$e.DEFAULT_MAX_MEMORY_USAGE=16,$e.DEFAULT_MEMORY_OVERFLOW=4,$e.DEFAULT_MEMORY_ADJUSTED_SCREEN_SPACE_ERROR=!1,$e.DEFAULT_MAX_SCREEN_SPACE_ERROR=4,$e.DEFAULT_SKIP_LEVEL_OF_DETAIL=!1,$e.DEFAULT_MOST_DETAIL=!1,$e.DEFAULT_LOAD_SIBLINGS=!1,$e.DEFAULT_LOAD_ALL=!1,$e.DEFAULT_MAX_REQUESTS=6,$e.DEFAULT_REQUEST_ORDER="SCREEN_SPACE_ERROR",$e}(),BVHObject=function(){function $e(Se,Be){this.position=Se,this.indices=Be}return $e.prototype.getPositionCount=function(){var Se,Be,De=this.indices,Ve=this.position;return De?De.array.length/((Se=De.stride)!==null&&Se!==void 0?Se:1):Ve.array.length/((Be=Ve.stride)!==null&&Be!==void 0?Be:3)},$e.prototype.getPositionByIndex=function(Se,Be){var De,Ve,Fe,Je,Xe=this.indices,Ke=this.position,Ye=Se;if(Xe){var or=Xe.array,sr=(De=Xe.stride)!==null&&De!==void 0?De:1,cr=(Ve=Xe.offset)!==null&&Ve!==void 0?Ve:0;Ye=or[Se*sr+cr]}var Br=Ke.array,tn=(Fe=Ke.stride)!==null&&Fe!==void 0?Fe:3,en=(Je=Ke.offset)!==null&&Je!==void 0?Je:0;return Ye=Ye*tn+en,Be.x=Br[Ye],Be.y=Br[Ye+1],Be.z=Br[Ye+2],Be},$e.prototype.createTree=function(Se,Be,De){throw new Error("not implemented")},$e.prototype.trianglesInSphere=function(Se,Be){throw new Error("not implemented")},$e.prototype.intersectRay=function(Se,Be,De,Ve){throw new Error("not implemented")},$e}(),BVHNode=function(){function $e(Se,Be,De,Ve,Fe){this.id=Se,this.extents=Be,this.startIndex=De,this.endIndex=Ve,this.deepth=Fe}return $e}(),BYTES_PER_NODE=6*4+4+4+2+2;function packBVHNode($e,Se){for(var Be=new ArrayBuffer(Se*BYTES_PER_NODE),De=new Float32Array(Be),Ve=new Uint32Array(Be),Fe=new Uint16Array(Be),Je=[$e],Xe,Ke;Xe=Je.pop();)Ke=Xe.id*BYTES_PER_NODE/4,De[Ke]=Xe.extents[0],De[Ke+1]=Xe.extents[1],De[Ke+2]=Xe.extents[2],De[Ke+3]=Xe.extents[3],De[Ke+4]=Xe.extents[4],De[Ke+5]=Xe.extents[5],Ve[Ke+6]=Xe.startIndex,Ve[Ke+7]=Xe.endIndex,Ke=Xe.id*BYTES_PER_NODE/2,Xe.node0&&(Fe[Ke+16]=Xe.node0.id,Je.push(Xe.node0)),Xe.node1&&(Fe[Ke+17]=Xe.node1.id,Je.push(Xe.node1));return Be}function intersectNodeBox($e,Se,Be,De,Ve,Fe,Je,Xe,Ke){Ke===void 0&&(Ke=0),Be=Be-Ke,De=De-Ke,Ve=Ve-Ke,Fe=Fe+Ke,Je=Je+Ke,Xe=Xe+Ke;var Ye=0,or=0,sr=0,cr=0,Br=0,tn=0;return Se.x>=0?(Ye=(Be-$e.x)*Se.x,or=(Fe-$e.x)*Se.x):(Ye=(Fe-$e.x)*Se.x,or=(Be-$e.x)*Se.x),Se.y>=0?(sr=(De-$e.y)*Se.y,cr=(Je-$e.y)*Se.y):(sr=(Je-$e.y)*Se.y,cr=(De-$e.y)*Se.y),!(Ye>cr||sr>or||(sr>Ye&&(Ye=sr),cr<or&&(or=cr),Se.z>=0?(Br=(Ve-$e.z)*Se.z,tn=(Xe-$e.z)*Se.z):(Br=(Xe-$e.z)*Se.z,tn=(Ve-$e.z)*Se.z),Ye>tn||Br>or)||(Br>Ye&&(Ye=Br),tn<or&&(or=tn),or<0))}var BVHVector3=function(){function $e(Se,Be,De){this.x=Se,this.y=Be,this.z=De}return $e.prototype.copy=function(Se){return this.x=Se.x,this.y=Se.y,this.z=Se.z,this},$e.prototype.set=function(Se,Be,De){return this.x=Se,this.y=Be,this.z=De,this},$e.prototype.fromArray=function(Se,Be){return Be===void 0&&(Be=0),this.x=Se[Be],this.y=Se[Be+1],this.z=Se[Be+2],this},$e.prototype.toArray=function(Se,Be){return Se===void 0&&(Se=[]),Be===void 0&&(Be=0),Se[Be]=this.x,Se[Be+1]=this.y,Se[Be+2]=this.z,Se},$e.prototype.add=function(Se){return this.x+=Se.x,this.y+=Se.y,this.z+=Se.z,this},$e.prototype.multiplyScalar=function(Se){return this.x*=Se,this.y*=Se,this.z*=Se,this},$e.prototype.subVectors=function(Se,Be){return this.x=Se.x-Be.x,this.y=Se.y-Be.y,this.z=Se.z-Be.z,this},$e.prototype.addScaledVector=function(Se,Be){return this.x+=Se.x*Be,this.y+=Se.y*Be,this.z+=Se.z*Be,this},$e.prototype.dot=function(Se){return this.x*Se.x+this.y*Se.y+this.z*Se.z},$e.prototype.cross=function(Se){var Be=this.x,De=this.y,Ve=this.z;return this.x=De*Se.z-Ve*Se.y,this.y=Ve*Se.x-Be*Se.z,this.z=Be*Se.y-De*Se.x,this},$e.prototype.crossVectors=function(Se,Be){var De=Se.x,Ve=Se.y,Fe=Se.z,Je=Be.x,Xe=Be.y,Ke=Be.z;return this.x=Ve*Ke-Fe*Xe,this.y=Fe*Je-De*Ke,this.z=De*Xe-Ve*Je,this},$e.prototype.distanceTo=function(Se){return Math.sqrt(this.distanceToSquared(Se))},$e.prototype.distanceToSquared=function(Se){var Be=this.x-Se.x,De=this.y-Se.y,Ve=this.z-Se.z;return Be*Be+De*De+Ve*Ve},$e.prototype.clone=function(){return new $e(this.x,this.y,this.z)},$e}(),BVHIntersect=function(){function $e(Se,Be,De){this.triangle=Se,this.intersectionPoint=Be,this.index=De}return $e}(),EPSILON$1=1e-6,scratchVector3$3=new BVHVector3(0,0,0),scratchVector3A=new BVHVector3(0,0,0),scratchVector3B=new BVHVector3(0,0,0),scratchVector3C=new BVHVector3(0,0,0),BVHMesh=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.createTree=function(Be,De,Ve){De=Math.min(De,16);var Fe=this.getPositionCount()/3,Je=Fe>65535?new Uint32Array(Fe):new Uint16Array(Fe),Xe=new Float32Array(Fe*6),Ke=[],Ye=0,or=-1;if(Ve)for(var sr=0,cr=0,Br=0,tn=void 0,en=void 0,an=void 0,rn=void 0,on=void 0,sn=void 0,ln=void 0;sr<Fe;sr+=1,cr+=3,Br+=6)Je[sr]=sr,this.getPositionByIndex(cr,scratchVector3A),this.getPositionByIndex(cr+1,scratchVector3B),this.getPositionByIndex(cr+2,scratchVector3C),tn=rn=scratchVector3A.x,ln=scratchVector3B.x,ln<tn&&(tn=ln),ln>rn&&(rn=ln),ln=scratchVector3C.x,ln<tn&&(tn=ln),ln>rn&&(rn=ln),en=on=scratchVector3A.y,ln=scratchVector3B.y,ln<en&&(en=ln),ln>on&&(on=ln),ln=scratchVector3C.y,ln<en&&(en=ln),ln>on&&(on=ln),an=sn=scratchVector3A.z,ln=scratchVector3B.z,ln<an&&(an=ln),ln>sn&&(sn=ln),ln=scratchVector3C.z,ln<an&&(an=ln),ln>sn&&(sn=ln),Xe[Br]=tn,Xe[Br+1]=en,Xe[Br+2]=an,Xe[Br+3]=rn,Xe[Br+4]=on,Xe[Br+5]=sn;else{for(var cn=1/0,hn=1/0,mn=1/0,An=-1/0,xn=-1/0,pn=-1/0,sr=0,cr=0,Br=0,tn=void 0,en=void 0,an=void 0,rn=void 0,on=void 0,sn=void 0,ln=void 0;sr<Fe;sr+=1,cr+=3,Br+=6)Je[sr]=sr,this.getPositionByIndex(cr,scratchVector3A),this.getPositionByIndex(cr+1,scratchVector3B),this.getPositionByIndex(cr+2,scratchVector3C),tn=rn=scratchVector3A.x,ln=scratchVector3B.x,ln<tn&&(tn=ln),ln>rn&&(rn=ln),ln=scratchVector3C.x,ln<tn&&(tn=ln),ln>rn&&(rn=ln),en=on=scratchVector3A.y,ln=scratchVector3B.y,ln<en&&(en=ln),ln>on&&(on=ln),ln=scratchVector3C.y,ln<en&&(en=ln),ln>on&&(on=ln),an=sn=scratchVector3A.z,ln=scratchVector3B.z,ln<an&&(an=ln),ln>sn&&(sn=ln),ln=scratchVector3C.z,ln<an&&(an=ln),ln>sn&&(sn=ln),Xe[Br]=tn,Xe[Br+1]=en,Xe[Br+2]=an,Xe[Br+3]=rn,Xe[Br+4]=on,Xe[Br+5]=sn,tn<cn&&(cn=tn),rn>An&&(An=rn),en<hn&&(hn=en),on>xn&&(xn=on),an<mn&&(mn=an),sn>pn&&(pn=sn);Ve=[cn,hn,mn,An,xn,pn]}var dn=new BVHNode(++or,Ve,0,Fe,0);Ke[Ye++]=dn;var fn=[],yn=[0,1,2],Sn=function(Cn,Mn){return fn[Mn]-fn[Cn]};function gn(Cn){var Mn=Cn.startIndex,Bn=Cn.endIndex,kn=Cn.extents;fn[0]=kn[3]-kn[0],fn[1]=kn[4]-kn[1],fn[2]=kn[5]-kn[2],yn.sort(Sn);for(var Ln=0;Ln<3;Ln++){for(var Pn=yn[Ln],Vn=kn[Pn]+kn[Pn+3],Yn=Mn,ni=Bn-1,Rn=-1,In=void 0;Yn<=ni;)Rn===-1?(In=Je[Yn],Xe[In*6+Pn]+Xe[In*6+Pn+3]<Vn?Yn++:Rn=In):(In=Je[ni],Xe[In*6+Pn]+Xe[In*6+Pn+3]>=Vn||(Je[Yn]=In,Je[ni]=Rn,Rn=-1,Yn++),ni--);if(Yn>Mn&&Yn<Bn){var Gn=new BVHNode(++or,calcExtents(Je,Xe,Mn,Yn,EPSILON$1),Mn,Yn,Cn.deepth+1);Gn.deepth<De&&Gn.endIndex-Gn.startIndex>Be&&(Ke[Ye++]=Gn);var Fn=new BVHNode(++or,calcExtents(Je,Xe,Yn,Bn,EPSILON$1),Yn,Bn,Cn.deepth+1);Fn.deepth<De&&Fn.endIndex-Fn.startIndex>Be&&(Ke[Ye++]=Fn),Cn.node0=Gn,Cn.node1=Fn,Cn.startIndex=0,Cn.endIndex=0;break}}}for(;Ye;)gn(Ke[--Ye]);return this.offsetArray=Je,this.rootNodePacked=packBVHNode(dn,or+1),Ke.length=0,this},Se.prototype.trianglesInSphere=function(Be,De){for(var Ve=this.offsetArray,Fe=this.rootNodePacked,Je=new Float32Array(Fe),Xe=new Uint32Array(Fe),Ke=new Uint16Array(Fe),Ye=[0],or=[],sr,cr,Br,tn;(sr=Ye.pop())!==void 0;){tn=sr*BYTES_PER_NODE/4;var en=clamp(Be.x,Je[tn],Je[tn+3])-Be.x,an=clamp(Be.y,Je[tn+1],Je[tn+4])-Be.y,rn=clamp(Be.z,Je[tn+2],Je[tn+5])-Be.z;if(en*en+an*an+rn*rn<=De*De){for(var on=Xe[tn+6];on<Xe[tn+7];on++)or.push(Ve[on]);tn=sr*BYTES_PER_NODE/2,cr=Ke[tn+16],Br=Ke[tn+17],cr&&Ye.push(cr),Br&&Ye.push(Br)}}for(var sn=or.length,ln=new Float32Array(sn*9),on=0;on<sn;on++){var cn=or[on];this.getPositionByIndex(cn,scratchVector3$3),ln[on*9]=scratchVector3$3.x,ln[on*9+1]=scratchVector3$3.y,ln[on*9+2]=scratchVector3$3.z,this.getPositionByIndex(cn+1,scratchVector3$3),ln[on*9+3]=scratchVector3$3.x,ln[on*9+4]=scratchVector3$3.y,ln[on*9+5]=scratchVector3$3.z,this.getPositionByIndex(cn+2,scratchVector3$3),ln[on*9+6]=scratchVector3$3.x,ln[on*9+7]=scratchVector3$3.y,ln[on*9+8]=scratchVector3$3.z}return ln},Se.prototype.intersectRay=function(Be,De,Ve,Fe){for(var Je=this.offsetArray,Xe=this.rootNodePacked,Ke=new Float32Array(Xe),Ye=new Uint32Array(Xe),or=new Uint16Array(Xe),sr=new BVHVector3(1/De.x,1/De.y,1/De.z),cr=[0],Br,tn,en,an;(Br=cr.pop())!==void 0;)if(an=Br*BYTES_PER_NODE/4,intersectNodeBox(Be,sr,Ke[an],Ke[an+1],Ke[an+2],Ke[an+3],Ke[an+4],Ke[an+5])){for(var rn=Ye[an+6],on=Ye[an+7],sn=void 0,ln=void 0,cn=void 0,hn=Be.x,mn=Be.y,An=Be.z,xn=De.x,pn=De.y,dn=De.z,fn=void 0,yn=void 0,Sn=void 0,gn=void 0,Cn=void 0,Mn=void 0,Bn=void 0,kn=void 0,Ln=void 0,Pn=void 0,Vn=void 0,Yn=void 0,ni=void 0,Rn=void 0,In=void 0,Gn=void 0,Fn=void 0,Hn=void 0,Dn=void 0,zn=void 0,Qn=void 0,Zn=void 0,si=void 0,ei=void 0,hi=void 0,Un=void 0,Wn=void 0;rn<on;rn++){if(sn=Je[rn],ln=sn*3,this.getPositionByIndex(ln,scratchVector3$3),fn=scratchVector3$3.x,yn=scratchVector3$3.y,Sn=scratchVector3$3.z,this.getPositionByIndex(ln+1,scratchVector3$3),gn=scratchVector3$3.x,Cn=scratchVector3$3.y,Mn=scratchVector3$3.z,this.getPositionByIndex(ln+2,scratchVector3$3),Bn=scratchVector3$3.x,kn=scratchVector3$3.y,Ln=scratchVector3$3.z,Pn=gn-fn,Vn=Cn-yn,Yn=Mn-Sn,ni=Bn-fn,Rn=kn-yn,In=Ln-Sn,Gn=Vn*In-Yn*Rn,Fn=Yn*ni-Pn*In,Hn=Pn*Rn-Vn*ni,si=xn*Gn+pn*Fn+dn*Hn,si>0)Zn=1;else if(si<0)Zn=-1,si=-si;else continue;Dn=hn-fn,zn=mn-yn,Qn=An-Sn,ei=Zn*(xn*(zn*In-Qn*Rn)+pn*(Qn*ni-Dn*In)+dn*(Dn*Rn-zn*ni)),!(ei<0)&&(hi=Zn*(xn*(Vn*Qn-Yn*zn)+pn*(Yn*Dn-Pn*Qn)+dn*(Pn*zn-Vn*Dn)),!(hi<0)&&(ei+hi>si||(Un=-Zn*(Dn*Gn+zn*Fn+Qn*Hn),!(Un<0)&&(Wn=Un/si,Fe.push(new BVHIntersect([fn,yn,Sn,gn,Cn,Mn,Bn,kn,Ln],[hn+xn*Wn,mn+pn*Wn,An+dn*Wn],sn))))))}an=Br*BYTES_PER_NODE/2,tn=or[an+16],en=or[an+17],tn&&cr.push(tn),en&&cr.push(en)}return Fe},Se}(BVHObject);function clamp($e,Se,Be){return $e<Se?Se:$e>Be?Be:$e}function calcExtents($e,Se,Be,De,Ve){if(Be>=De)return[0,0,0,0,0,0];for(var Fe=1/0,Je=1/0,Xe=1/0,Ke=-1/0,Ye=-1/0,or=-1/0,sr=Be,cr=void 0,Br=void 0;sr<De;sr++)cr=$e[sr]*6,Br=Se[cr],Br<Fe&&(Fe=Br),Br=Se[cr+1],Br<Je&&(Je=Br),Br=Se[cr+2],Br<Xe&&(Xe=Br),Br=Se[cr+3],Br>Ke&&(Ke=Br),Br=Se[cr+4],Br>Ye&&(Ye=Br),Br=Se[cr+5],Br>or&&(or=Br);return[Fe-Ve,Je-Ve,Xe-Ve,Ke+Ve,Ye+Ve,or+Ve]}var EPSILON=1e-6,ORDER_AXISES=["x","y","z"],scratchVector3$2=new BVHVector3(0,0,0),BVHPoints=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.createTree=function(Be,De,Ve){De=Math.min(De,16);var Fe=this.getPositionByIndex.bind(this),Je=this.getPositionCount(),Xe=Je>65535?new Uint32Array(Je):new Uint16Array(Je),Ke=[],Ye=0,or=-1;if(Ve)for(var sr=0;sr<Je;sr+=1)Xe[sr]=sr;else{Fe(0,scratchVector3$2);for(var cr=scratchVector3$2.x,Br=scratchVector3$2.y,tn=scratchVector3$2.z,en=cr,an=Br,rn=tn,sr=0,on=void 0,sn=void 0,ln=void 0;sr<Je;sr+=1)Xe[sr]=sr,Fe(sr,scratchVector3$2),on=scratchVector3$2.x,sn=scratchVector3$2.y,ln=scratchVector3$2.z,on<cr?cr=on:on>en&&(en=on),sn<Br?Br=sn:sn>an&&(an=sn),ln<tn?tn=ln:ln>rn&&(rn=ln);Ve=[cr,Br,tn,en,an,rn]}var cn=new BVHNode(++or,Ve,0,Je,0);Ke[Ye++]=cn;var hn=[],mn=[0,1,2],An=function(pn,dn){return hn[dn]-hn[pn]};function xn(pn){var dn=pn.startIndex,fn=pn.endIndex,yn=pn.extents;hn[0]=yn[3]-yn[0],hn[1]=yn[4]-yn[1],hn[2]=yn[5]-yn[2];for(var Sn=mn.sort(An)[0],gn=ORDER_AXISES[Sn],Cn=(yn[Sn]+yn[Sn+3])/2,Mn=dn,Bn=fn-1,kn=-1,Ln;Mn<=Bn;)kn===-1?(Ln=Xe[Mn],Fe(Ln,scratchVector3$2),scratchVector3$2[gn]<Cn?Mn++:kn=Ln):(Ln=Xe[Bn],Fe(Ln,scratchVector3$2),scratchVector3$2[gn]>=Cn||(Xe[Mn]=Ln,Xe[Bn]=kn,kn=-1,Mn++),Bn--);if(Mn>dn){var Pn=yn.slice();Pn[Sn+3]=Cn+EPSILON;var Vn=new BVHNode(++or,Pn,dn,Mn,pn.deepth+1);Vn.deepth<De&&Vn.endIndex-Vn.startIndex>Be&&(Ke[Ye++]=Vn),pn.node0=Vn}if(fn>Mn){var Yn=yn.slice();Yn[Sn]=Cn-EPSILON;var ni=new BVHNode(++or,Yn,Mn,fn,pn.deepth+1);ni.deepth<De&&ni.endIndex-ni.startIndex>Be&&(Ke[Ye++]=ni),pn.node1=ni}pn.startIndex=0,pn.endIndex=0}for(;Ye;)xn(Ke[--Ye]);return this.offsetArray=Xe,this.rootNodePacked=packBVHNode(cn,or+1),Ke.length=0,this},Se.prototype.intersectRay=function(Be,De,Ve,Fe){for(var Je=this.offsetArray,Xe=this.rootNodePacked,Ke=new Float32Array(Xe),Ye=new Uint32Array(Xe),or=new Uint16Array(Xe),sr=Ve*Ve,cr=new BVHVector3(1/De.x,1/De.y,1/De.z),Br=[0],tn,en,an,rn;(tn=Br.pop())!==void 0;)if(rn=tn*BYTES_PER_NODE/4,intersectNodeBox(Be,cr,Ke[rn],Ke[rn+1],Ke[rn+2],Ke[rn+3],Ke[rn+4],Ke[rn+5],Ve)){for(var on=Ye[rn+6],sn=Ye[rn+7],ln=void 0,cn=void 0,hn=void 0,mn=void 0,An=void 0,xn=void 0,pn=void 0,dn=void 0,fn=void 0,yn=void 0,Sn=void 0,gn=void 0;on<sn;on++)ln=Je[on],this.getPositionByIndex(ln,scratchVector3$2),cn=scratchVector3$2.x,hn=scratchVector3$2.y,mn=scratchVector3$2.z,An=Be.x,xn=Be.y,pn=Be.z,dn=De.x,fn=De.y,yn=De.z,Sn=dn*(cn-An)+fn*(hn-xn)+yn*(mn-pn),Sn>0&&(An+=dn*Sn,xn+=fn*Sn,pn+=yn*Sn),dn=cn-An,fn=hn-xn,yn=mn-pn,Sn=dn*dn+fn*fn+yn*yn,Sn<=sr&&Fe.push(new BVHIntersect([cn,hn,mn,cn,hn,mn,cn,hn,mn],[An,xn,pn],ln));rn=tn*BYTES_PER_NODE/2,en=or[rn+16],an=or[rn+17],en&&Br.push(en),an&&Br.push(an)}return Fe},Se}(BVHObject);const encodedJs$1="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO3ZhciBlcj1mdW5jdGlvbihlLHIpe3JldHVybiBlcj1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24odCxvKXt0Ll9fcHJvdG9fXz1vfXx8ZnVuY3Rpb24odCxvKXtmb3IodmFyIGYgaW4gbylPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobyxmKSYmKHRbZl09b1tmXSl9LGVyKGUscil9O2Z1bmN0aW9uIGhyKGUscil7aWYodHlwZW9mIHIhPSJmdW5jdGlvbiImJnIhPT1udWxsKXRocm93IG5ldyBUeXBlRXJyb3IoIkNsYXNzIGV4dGVuZHMgdmFsdWUgIitTdHJpbmcocikrIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsIik7ZXIoZSxyKTtmdW5jdGlvbiB0KCl7dGhpcy5jb25zdHJ1Y3Rvcj1lfWUucHJvdG90eXBlPXI9PT1udWxsP09iamVjdC5jcmVhdGUocik6KHQucHJvdG90eXBlPXIucHJvdG90eXBlLG5ldyB0KX10eXBlb2YgU3VwcHJlc3NlZEVycm9yPT0iZnVuY3Rpb24iJiZTdXBwcmVzc2VkRXJyb3I7dmFyIGRyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShyLHQpe3RoaXMucG9zaXRpb249cix0aGlzLmluZGljZXM9dH1yZXR1cm4gZS5wcm90b3R5cGUuZ2V0UG9zaXRpb25Db3VudD1mdW5jdGlvbigpe3ZhciByLHQsbz10aGlzLmluZGljZXMsZj10aGlzLnBvc2l0aW9uO3JldHVybiBvP28uYXJyYXkubGVuZ3RoLygocj1vLnN0cmlkZSkhPT1udWxsJiZyIT09dm9pZCAwP3I6MSk6Zi5hcnJheS5sZW5ndGgvKCh0PWYuc3RyaWRlKSE9PW51bGwmJnQhPT12b2lkIDA/dDozKX0sZS5wcm90b3R5cGUuZ2V0UG9zaXRpb25CeUluZGV4PWZ1bmN0aW9uKHIsdCl7dmFyIG8sZixkLHYsbj10aGlzLmluZGljZXMscz10aGlzLnBvc2l0aW9uLHU9cjtpZihuKXt2YXIgdz1uLmFycmF5LHk9KG89bi5zdHJpZGUpIT09bnVsbCYmbyE9PXZvaWQgMD9vOjEscD0oZj1uLm9mZnNldCkhPT1udWxsJiZmIT09dm9pZCAwP2Y6MDt1PXdbcip5K3BdfXZhciBhPXMuYXJyYXksaD0oZD1zLnN0cmlkZSkhPT1udWxsJiZkIT09dm9pZCAwP2Q6MyxBPSh2PXMub2Zmc2V0KSE9PW51bGwmJnYhPT12b2lkIDA/djowO3JldHVybiB1PXUqaCtBLHQueD1hW3VdLHQueT1hW3UrMV0sdC56PWFbdSsyXSx0fSxlLnByb3RvdHlwZS5jcmVhdGVUcmVlPWZ1bmN0aW9uKHIsdCxvKXt0aHJvdyBuZXcgRXJyb3IoIm5vdCBpbXBsZW1lbnRlZCIpfSxlLnByb3RvdHlwZS50cmlhbmdsZXNJblNwaGVyZT1mdW5jdGlvbihyLHQpe3Rocm93IG5ldyBFcnJvcigibm90IGltcGxlbWVudGVkIil9LGUucHJvdG90eXBlLmludGVyc2VjdFJheT1mdW5jdGlvbihyLHQsbyxmKXt0aHJvdyBuZXcgRXJyb3IoIm5vdCBpbXBsZW1lbnRlZCIpfSxlfSgpLG09ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHIsdCxvLGYsZCl7dGhpcy5pZD1yLHRoaXMuZXh0ZW50cz10LHRoaXMuc3RhcnRJbmRleD1vLHRoaXMuZW5kSW5kZXg9Zix0aGlzLmRlZXB0aD1kfXJldHVybiBlfSgpLFE9Nio0KzQrNCsyKzI7ZnVuY3Rpb24geXIoZSxyKXtmb3IodmFyIHQ9bmV3IEFycmF5QnVmZmVyKHIqUSksbz1uZXcgRmxvYXQzMkFycmF5KHQpLGY9bmV3IFVpbnQzMkFycmF5KHQpLGQ9bmV3IFVpbnQxNkFycmF5KHQpLHY9W2VdLG4scztuPXYucG9wKCk7KXM9bi5pZCpRLzQsb1tzXT1uLmV4dGVudHNbMF0sb1tzKzFdPW4uZXh0ZW50c1sxXSxvW3MrMl09bi5leHRlbnRzWzJdLG9bcyszXT1uLmV4dGVudHNbM10sb1tzKzRdPW4uZXh0ZW50c1s0XSxvW3MrNV09bi5leHRlbnRzWzVdLGZbcys2XT1uLnN0YXJ0SW5kZXgsZltzKzddPW4uZW5kSW5kZXgscz1uLmlkKlEvMixuLm5vZGUwJiYoZFtzKzE2XT1uLm5vZGUwLmlkLHYucHVzaChuLm5vZGUwKSksbi5ub2RlMSYmKGRbcysxN109bi5ub2RlMS5pZCx2LnB1c2gobi5ub2RlMSkpO3JldHVybiB0fWZ1bmN0aW9uIGNyKGUscix0LG8sZixkLHYsbixzKXtzPT09dm9pZCAwJiYocz0wKSx0PXQtcyxvPW8tcyxmPWYtcyxkPWQrcyx2PXYrcyxuPW4rczt2YXIgdT0wLHc9MCx5PTAscD0wLGE9MCxoPTA7cmV0dXJuIHIueD49MD8odT0odC1lLngpKnIueCx3PShkLWUueCkqci54KToodT0oZC1lLngpKnIueCx3PSh0LWUueCkqci54KSxyLnk+PTA/KHk9KG8tZS55KSpyLnkscD0odi1lLnkpKnIueSk6KHk9KHYtZS55KSpyLnkscD0oby1lLnkpKnIueSksISh1PnB8fHk+d3x8KHk+dSYmKHU9eSkscDx3JiYodz1wKSxyLno+PTA/KGE9KGYtZS56KSpyLnosaD0obi1lLnopKnIueik6KGE9KG4tZS56KSpyLnosaD0oZi1lLnopKnIueiksdT5ofHxhPncpfHwoYT51JiYodT1hKSxoPHcmJih3PWgpLHc8MCkpfXZhciBZPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShyLHQsbyl7dGhpcy54PXIsdGhpcy55PXQsdGhpcy56PW99cmV0dXJuIGUucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24ocil7cmV0dXJuIHRoaXMueD1yLngsdGhpcy55PXIueSx0aGlzLno9ci56LHRoaXN9LGUucHJvdG90eXBlLnNldD1mdW5jdGlvbihyLHQsbyl7cmV0dXJuIHRoaXMueD1yLHRoaXMueT10LHRoaXMuej1vLHRoaXN9LGUucHJvdG90eXBlLmZyb21BcnJheT1mdW5jdGlvbihyLHQpe3JldHVybiB0PT09dm9pZCAwJiYodD0wKSx0aGlzLng9clt0XSx0aGlzLnk9clt0KzFdLHRoaXMuej1yW3QrMl0sdGhpc30sZS5wcm90b3R5cGUudG9BcnJheT1mdW5jdGlvbihyLHQpe3JldHVybiByPT09dm9pZCAwJiYocj1bXSksdD09PXZvaWQgMCYmKHQ9MCksclt0XT10aGlzLngsclt0KzFdPXRoaXMueSxyW3QrMl09dGhpcy56LHJ9LGUucHJvdG90eXBlLmFkZD1mdW5jdGlvbihyKXtyZXR1cm4gdGhpcy54Kz1yLngsdGhpcy55Kz1yLnksdGhpcy56Kz1yLnosdGhpc30sZS5wcm90b3R5cGUubXVsdGlwbHlTY2FsYXI9ZnVuY3Rpb24ocil7cmV0dXJuIHRoaXMueCo9cix0aGlzLnkqPXIsdGhpcy56Kj1yLHRoaXN9LGUucHJvdG90eXBlLnN1YlZlY3RvcnM9ZnVuY3Rpb24ocix0KXtyZXR1cm4gdGhpcy54PXIueC10LngsdGhpcy55PXIueS10LnksdGhpcy56PXIuei10LnosdGhpc30sZS5wcm90b3R5cGUuYWRkU2NhbGVkVmVjdG9yPWZ1bmN0aW9uKHIsdCl7cmV0dXJuIHRoaXMueCs9ci54KnQsdGhpcy55Kz1yLnkqdCx0aGlzLnorPXIueip0LHRoaXN9LGUucHJvdG90eXBlLmRvdD1mdW5jdGlvbihyKXtyZXR1cm4gdGhpcy54KnIueCt0aGlzLnkqci55K3RoaXMueipyLnp9LGUucHJvdG90eXBlLmNyb3NzPWZ1bmN0aW9uKHIpe3ZhciB0PXRoaXMueCxvPXRoaXMueSxmPXRoaXMuejtyZXR1cm4gdGhpcy54PW8qci56LWYqci55LHRoaXMueT1mKnIueC10KnIueix0aGlzLno9dCpyLnktbypyLngsdGhpc30sZS5wcm90b3R5cGUuY3Jvc3NWZWN0b3JzPWZ1bmN0aW9uKHIsdCl7dmFyIG89ci54LGY9ci55LGQ9ci56LHY9dC54LG49dC55LHM9dC56O3JldHVybiB0aGlzLng9ZipzLWQqbix0aGlzLnk9ZCp2LW8qcyx0aGlzLno9bypuLWYqdix0aGlzfSxlLnByb3RvdHlwZS5kaXN0YW5jZVRvPWZ1bmN0aW9uKHIpe3JldHVybiBNYXRoLnNxcnQodGhpcy5kaXN0YW5jZVRvU3F1YXJlZChyKSl9LGUucHJvdG90eXBlLmRpc3RhbmNlVG9TcXVhcmVkPWZ1bmN0aW9uKHIpe3ZhciB0PXRoaXMueC1yLngsbz10aGlzLnktci55LGY9dGhpcy56LXIuejtyZXR1cm4gdCp0K28qbytmKmZ9LGUucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlKHRoaXMueCx0aGlzLnksdGhpcy56KX0sZX0oKSxwcj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUocix0LG8pe3RoaXMudHJpYW5nbGU9cix0aGlzLmludGVyc2VjdGlvblBvaW50PXQsdGhpcy5pbmRleD1vfXJldHVybiBlfSgpLGxyPTFlLTYsUz1uZXcgWSgwLDAsMCksRD1uZXcgWSgwLDAsMCksZz1uZXcgWSgwLDAsMCksWD1uZXcgWSgwLDAsMCksQXI9ZnVuY3Rpb24oZSl7aHIocixlKTtmdW5jdGlvbiByKCl7cmV0dXJuIGUhPT1udWxsJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31yZXR1cm4gci5wcm90b3R5cGUuY3JlYXRlVHJlZT1mdW5jdGlvbih0LG8sZil7bz1NYXRoLm1pbihvLDE2KTt2YXIgZD10aGlzLmdldFBvc2l0aW9uQ291bnQoKS8zLHY9ZD42NTUzNT9uZXcgVWludDMyQXJyYXkoZCk6bmV3IFVpbnQxNkFycmF5KGQpLG49bmV3IEZsb2F0MzJBcnJheShkKjYpLHM9W10sdT0wLHc9LTE7aWYoZilmb3IodmFyIHk9MCxwPTAsYT0wLGg9dm9pZCAwLEE9dm9pZCAwLGw9dm9pZCAwLEk9dm9pZCAwLGM9dm9pZCAwLHo9dm9pZCAwLGk9dm9pZCAwO3k8ZDt5Kz0xLHArPTMsYSs9Nil2W3ldPXksdGhpcy5nZXRQb3NpdGlvbkJ5SW5kZXgocCxEKSx0aGlzLmdldFBvc2l0aW9uQnlJbmRleChwKzEsZyksdGhpcy5nZXRQb3NpdGlvbkJ5SW5kZXgocCsyLFgpLGg9ST1ELngsaT1nLngsaTxoJiYoaD1pKSxpPkkmJihJPWkpLGk9WC54LGk8aCYmKGg9aSksaT5JJiYoST1pKSxBPWM9RC55LGk9Zy55LGk8QSYmKEE9aSksaT5jJiYoYz1pKSxpPVgueSxpPEEmJihBPWkpLGk+YyYmKGM9aSksbD16PUQueixpPWcueixpPGwmJihsPWkpLGk+eiYmKHo9aSksaT1YLnosaTxsJiYobD1pKSxpPnomJih6PWkpLG5bYV09aCxuW2ErMV09QSxuW2ErMl09bCxuW2ErM109SSxuW2ErNF09YyxuW2ErNV09ejtlbHNle2Zvcih2YXIgaz0xLzAsSD0xLzAsaj0xLzAscT0tMS8wLE09LTEvMCxQPS0xLzAseT0wLHA9MCxhPTAsaD12b2lkIDAsQT12b2lkIDAsbD12b2lkIDAsST12b2lkIDAsYz12b2lkIDAsej12b2lkIDAsaT12b2lkIDA7eTxkO3krPTEscCs9MyxhKz02KXZbeV09eSx0aGlzLmdldFBvc2l0aW9uQnlJbmRleChwLEQpLHRoaXMuZ2V0UG9zaXRpb25CeUluZGV4KHArMSxnKSx0aGlzLmdldFBvc2l0aW9uQnlJbmRleChwKzIsWCksaD1JPUQueCxpPWcueCxpPGgmJihoPWkpLGk+SSYmKEk9aSksaT1YLngsaTxoJiYoaD1pKSxpPkkmJihJPWkpLEE9Yz1ELnksaT1nLnksaTxBJiYoQT1pKSxpPmMmJihjPWkpLGk9WC55LGk8QSYmKEE9aSksaT5jJiYoYz1pKSxsPXo9RC56LGk9Zy56LGk8bCYmKGw9aSksaT56JiYoej1pKSxpPVgueixpPGwmJihsPWkpLGk+eiYmKHo9aSksblthXT1oLG5bYSsxXT1BLG5bYSsyXT1sLG5bYSszXT1JLG5bYSs0XT1jLG5bYSs1XT16LGg8ayYmKGs9aCksST5xJiYocT1JKSxBPEgmJihIPUEpLGM+TSYmKE09YyksbDxqJiYoaj1sKSx6PlAmJihQPXopO2Y9W2ssSCxqLHEsTSxQXX12YXIgVD1uZXcgbSgrK3csZiwwLGQsMCk7c1t1KytdPVQ7dmFyIE49W10sQj1bMCwxLDJdLFY9ZnVuY3Rpb24oVSxfKXtyZXR1cm4gTltfXS1OW1VdfTtmdW5jdGlvbiBSKFUpe3ZhciBfPVUuc3RhcnRJbmRleCwkPVUuZW5kSW5kZXgsRj1VLmV4dGVudHM7TlswXT1GWzNdLUZbMF0sTlsxXT1GWzRdLUZbMV0sTlsyXT1GWzVdLUZbMl0sQi5zb3J0KFYpO2Zvcih2YXIgVz0wO1c8MztXKyspe2Zvcih2YXIgTD1CW1ddLEc9RltMXStGW0wrM10seD1fLEM9JC0xLEs9LTEsSj12b2lkIDA7eDw9QzspSz09PS0xPyhKPXZbeF0sbltKKjYrTF0rbltKKjYrTCszXTxHP3grKzpLPUopOihKPXZbQ10sbltKKjYrTF0rbltKKjYrTCszXT49R3x8KHZbeF09Six2W0NdPUssSz0tMSx4KyspLEMtLSk7aWYoeD5fJiZ4PCQpe3ZhciBiPW5ldyBtKCsrdyxJcih2LG4sXyx4LGxyKSxfLHgsVS5kZWVwdGgrMSk7Yi5kZWVwdGg8byYmYi5lbmRJbmRleC1iLnN0YXJ0SW5kZXg+dCYmKHNbdSsrXT1iKTt2YXIgTz1uZXcgbSgrK3csSXIodixuLHgsJCxscikseCwkLFUuZGVlcHRoKzEpO08uZGVlcHRoPG8mJk8uZW5kSW5kZXgtTy5zdGFydEluZGV4PnQmJihzW3UrK109TyksVS5ub2RlMD1iLFUubm9kZTE9TyxVLnN0YXJ0SW5kZXg9MCxVLmVuZEluZGV4PTA7YnJlYWt9fX1mb3IoO3U7KVIoc1stLXVdKTtyZXR1cm4gdGhpcy5vZmZzZXRBcnJheT12LHRoaXMucm9vdE5vZGVQYWNrZWQ9eXIoVCx3KzEpLHMubGVuZ3RoPTAsdGhpc30sci5wcm90b3R5cGUudHJpYW5nbGVzSW5TcGhlcmU9ZnVuY3Rpb24odCxvKXtmb3IodmFyIGY9dGhpcy5vZmZzZXRBcnJheSxkPXRoaXMucm9vdE5vZGVQYWNrZWQsdj1uZXcgRmxvYXQzMkFycmF5KGQpLG49bmV3IFVpbnQzMkFycmF5KGQpLHM9bmV3IFVpbnQxNkFycmF5KGQpLHU9WzBdLHc9W10seSxwLGEsaDsoeT11LnBvcCgpKSE9PXZvaWQgMDspe2g9eSpRLzQ7dmFyIEE9c3IodC54LHZbaF0sdltoKzNdKS10LngsbD1zcih0LnksdltoKzFdLHZbaCs0XSktdC55LEk9c3IodC56LHZbaCsyXSx2W2grNV0pLXQuejtpZihBKkErbCpsK0kqSTw9bypvKXtmb3IodmFyIGM9bltoKzZdO2M8bltoKzddO2MrKyl3LnB1c2goZltjXSk7aD15KlEvMixwPXNbaCsxNl0sYT1zW2grMTddLHAmJnUucHVzaChwKSxhJiZ1LnB1c2goYSl9fWZvcih2YXIgej13Lmxlbmd0aCxpPW5ldyBGbG9hdDMyQXJyYXkoeio5KSxjPTA7Yzx6O2MrKyl7dmFyIGs9d1tjXTt0aGlzLmdldFBvc2l0aW9uQnlJbmRleChrLFMpLGlbYyo5XT1TLngsaVtjKjkrMV09Uy55LGlbYyo5KzJdPVMueix0aGlzLmdldFBvc2l0aW9uQnlJbmRleChrKzEsUyksaVtjKjkrM109Uy54LGlbYyo5KzRdPVMueSxpW2MqOSs1XT1TLnosdGhpcy5nZXRQb3NpdGlvbkJ5SW5kZXgoaysyLFMpLGlbYyo5KzZdPVMueCxpW2MqOSs3XT1TLnksaVtjKjkrOF09Uy56fXJldHVybiBpfSxyLnByb3RvdHlwZS5pbnRlcnNlY3RSYXk9ZnVuY3Rpb24odCxvLGYsZCl7Zm9yKHZhciB2PXRoaXMub2Zmc2V0QXJyYXksbj10aGlzLnJvb3ROb2RlUGFja2VkLHM9bmV3IEZsb2F0MzJBcnJheShuKSx1PW5ldyBVaW50MzJBcnJheShuKSx3PW5ldyBVaW50MTZBcnJheShuKSx5PW5ldyBZKDEvby54LDEvby55LDEvby56KSxwPVswXSxhLGgsQSxsOyhhPXAucG9wKCkpIT09dm9pZCAwOylpZihsPWEqUS80LGNyKHQseSxzW2xdLHNbbCsxXSxzW2wrMl0sc1tsKzNdLHNbbCs0XSxzW2wrNV0pKXtmb3IodmFyIEk9dVtsKzZdLGM9dVtsKzddLHo9dm9pZCAwLGk9dm9pZCAwLGs9dm9pZCAwLEg9dC54LGo9dC55LHE9dC56LE09by54LFA9by55LFQ9by56LE49dm9pZCAwLEI9dm9pZCAwLFY9dm9pZCAwLFI9dm9pZCAwLFU9dm9pZCAwLF89dm9pZCAwLCQ9dm9pZCAwLEY9dm9pZCAwLFc9dm9pZCAwLEw9dm9pZCAwLEc9dm9pZCAwLHg9dm9pZCAwLEM9dm9pZCAwLEs9dm9pZCAwLEo9dm9pZCAwLGI9dm9pZCAwLE89dm9pZCAwLGFyPXZvaWQgMCxycj12b2lkIDAsdHI9dm9pZCAwLG9yPXZvaWQgMCxpcj12b2lkIDAsWj12b2lkIDAsdnI9dm9pZCAwLGZyPXZvaWQgMCx1cj12b2lkIDAsbnI9dm9pZCAwO0k8YztJKyspe2lmKHo9dltJXSxpPXoqMyx0aGlzLmdldFBvc2l0aW9uQnlJbmRleChpLFMpLE49Uy54LEI9Uy55LFY9Uy56LHRoaXMuZ2V0UG9zaXRpb25CeUluZGV4KGkrMSxTKSxSPVMueCxVPVMueSxfPVMueix0aGlzLmdldFBvc2l0aW9uQnlJbmRleChpKzIsUyksJD1TLngsRj1TLnksVz1TLnosTD1SLU4sRz1VLUIseD1fLVYsQz0kLU4sSz1GLUIsSj1XLVYsYj1HKkoteCpLLE89eCpDLUwqSixhcj1MKkstRypDLFo9TSpiK1AqTytUKmFyLFo+MClpcj0xO2Vsc2UgaWYoWjwwKWlyPS0xLFo9LVo7ZWxzZSBjb250aW51ZTtycj1ILU4sdHI9ai1CLG9yPXEtVix2cj1pciooTSoodHIqSi1vcipLKStQKihvcipDLXJyKkopK1QqKHJyKkstdHIqQykpLCEodnI8MCkmJihmcj1pciooTSooRypvci14KnRyKStQKih4KnJyLUwqb3IpK1QqKEwqdHItRypycikpLCEoZnI8MCkmJih2citmcj5afHwodXI9LWlyKihycipiK3RyKk8rb3IqYXIpLCEodXI8MCkmJihucj11ci9aLGQucHVzaChuZXcgcHIoW04sQixWLFIsVSxfLCQsRixXXSxbSCtNKm5yLGorUCpucixxK1QqbnJdLHopKSkpKSl9bD1hKlEvMixoPXdbbCsxNl0sQT13W2wrMTddLGgmJnAucHVzaChoKSxBJiZwLnB1c2goQSl9cmV0dXJuIGR9LHJ9KGRyKTtmdW5jdGlvbiBzcihlLHIsdCl7cmV0dXJuIGU8cj9yOmU+dD90OmV9ZnVuY3Rpb24gSXIoZSxyLHQsbyxmKXtpZih0Pj1vKXJldHVyblswLDAsMCwwLDAsMF07Zm9yKHZhciBkPTEvMCx2PTEvMCxuPTEvMCxzPS0xLzAsdT0tMS8wLHc9LTEvMCx5PXQscD12b2lkIDAsYT12b2lkIDA7eTxvO3krKylwPWVbeV0qNixhPXJbcF0sYTxkJiYoZD1hKSxhPXJbcCsxXSxhPHYmJih2PWEpLGE9cltwKzJdLGE8biYmKG49YSksYT1yW3ArM10sYT5zJiYocz1hKSxhPXJbcCs0XSxhPnUmJih1PWEpLGE9cltwKzVdLGE+dyYmKHc9YSk7cmV0dXJuW2QtZix2LWYsbi1mLHMrZix1K2YsdytmXX12YXIgd3I9MWUtNix6cj1bIngiLCJ5IiwieiJdLEU9bmV3IFkoMCwwLDApLFByPWZ1bmN0aW9uKGUpe2hyKHIsZSk7ZnVuY3Rpb24gcigpe3JldHVybiBlIT09bnVsbCYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9cmV0dXJuIHIucHJvdG90eXBlLmNyZWF0ZVRyZWU9ZnVuY3Rpb24odCxvLGYpe289TWF0aC5taW4obywxNik7dmFyIGQ9dGhpcy5nZXRQb3NpdGlvbkJ5SW5kZXguYmluZCh0aGlzKSx2PXRoaXMuZ2V0UG9zaXRpb25Db3VudCgpLG49dj42NTUzNT9uZXcgVWludDMyQXJyYXkodik6bmV3IFVpbnQxNkFycmF5KHYpLHM9W10sdT0wLHc9LTE7aWYoZilmb3IodmFyIHk9MDt5PHY7eSs9MSluW3ldPXk7ZWxzZXtkKDAsRSk7Zm9yKHZhciBwPUUueCxhPUUueSxoPUUueixBPXAsbD1hLEk9aCx5PTAsYz12b2lkIDAsej12b2lkIDAsaT12b2lkIDA7eTx2O3krPTEpblt5XT15LGQoeSxFKSxjPUUueCx6PUUueSxpPUUueixjPHA/cD1jOmM+QSYmKEE9YyksejxhP2E9ejp6PmwmJihsPXopLGk8aD9oPWk6aT5JJiYoST1pKTtmPVtwLGEsaCxBLGwsSV19dmFyIGs9bmV3IG0oKyt3LGYsMCx2LDApO3NbdSsrXT1rO3ZhciBIPVtdLGo9WzAsMSwyXSxxPWZ1bmN0aW9uKFAsVCl7cmV0dXJuIEhbVF0tSFtQXX07ZnVuY3Rpb24gTShQKXt2YXIgVD1QLnN0YXJ0SW5kZXgsTj1QLmVuZEluZGV4LEI9UC5leHRlbnRzO0hbMF09QlszXS1CWzBdLEhbMV09Qls0XS1CWzFdLEhbMl09Qls1XS1CWzJdO2Zvcih2YXIgVj1qLnNvcnQocSlbMF0sUj16cltWXSxVPShCW1ZdK0JbViszXSkvMixfPVQsJD1OLTEsRj0tMSxXO188PSQ7KUY9PT0tMT8oVz1uW19dLGQoVyxFKSxFW1JdPFU/XysrOkY9Vyk6KFc9blskXSxkKFcsRSksRVtSXT49VXx8KG5bX109VyxuWyRdPUYsRj0tMSxfKyspLCQtLSk7aWYoXz5UKXt2YXIgTD1CLnNsaWNlKCk7TFtWKzNdPVUrd3I7dmFyIEc9bmV3IG0oKyt3LEwsVCxfLFAuZGVlcHRoKzEpO0cuZGVlcHRoPG8mJkcuZW5kSW5kZXgtRy5zdGFydEluZGV4PnQmJihzW3UrK109RyksUC5ub2RlMD1HfWlmKE4+Xyl7dmFyIHg9Qi5zbGljZSgpO3hbVl09VS13cjt2YXIgQz1uZXcgbSgrK3cseCxfLE4sUC5kZWVwdGgrMSk7Qy5kZWVwdGg8byYmQy5lbmRJbmRleC1DLnN0YXJ0SW5kZXg+dCYmKHNbdSsrXT1DKSxQLm5vZGUxPUN9UC5zdGFydEluZGV4PTAsUC5lbmRJbmRleD0wfWZvcig7dTspTShzWy0tdV0pO3JldHVybiB0aGlzLm9mZnNldEFycmF5PW4sdGhpcy5yb290Tm9kZVBhY2tlZD15cihrLHcrMSkscy5sZW5ndGg9MCx0aGlzfSxyLnByb3RvdHlwZS5pbnRlcnNlY3RSYXk9ZnVuY3Rpb24odCxvLGYsZCl7Zm9yKHZhciB2PXRoaXMub2Zmc2V0QXJyYXksbj10aGlzLnJvb3ROb2RlUGFja2VkLHM9bmV3IEZsb2F0MzJBcnJheShuKSx1PW5ldyBVaW50MzJBcnJheShuKSx3PW5ldyBVaW50MTZBcnJheShuKSx5PWYqZixwPW5ldyBZKDEvby54LDEvby55LDEvby56KSxhPVswXSxoLEEsbCxJOyhoPWEucG9wKCkpIT09dm9pZCAwOylpZihJPWgqUS80LGNyKHQscCxzW0ldLHNbSSsxXSxzW0krMl0sc1tJKzNdLHNbSSs0XSxzW0krNV0sZikpe2Zvcih2YXIgYz11W0krNl0sej11W0krN10saT12b2lkIDAsaz12b2lkIDAsSD12b2lkIDAsaj12b2lkIDAscT12b2lkIDAsTT12b2lkIDAsUD12b2lkIDAsVD12b2lkIDAsTj12b2lkIDAsQj12b2lkIDAsVj12b2lkIDAsUj12b2lkIDA7Yzx6O2MrKylpPXZbY10sdGhpcy5nZXRQb3NpdGlvbkJ5SW5kZXgoaSxFKSxrPUUueCxIPUUueSxqPUUueixxPXQueCxNPXQueSxQPXQueixUPW8ueCxOPW8ueSxCPW8ueixWPVQqKGstcSkrTiooSC1NKStCKihqLVApLFY+MCYmKHErPVQqVixNKz1OKlYsUCs9QipWKSxUPWstcSxOPUgtTSxCPWotUCxWPVQqVCtOKk4rQipCLFY8PXkmJmQucHVzaChuZXcgcHIoW2ssSCxqLGssSCxqLGssSCxqXSxbcSxNLFBdLGkpKTtJPWgqUS8yLEE9d1tJKzE2XSxsPXdbSSsxN10sQSYmYS5wdXNoKEEpLGwmJmEucHVzaChsKX1yZXR1cm4gZH0scn0oZHIpO2Z1bmN0aW9uIEJyKGUpe29ubWVzc2FnZT1mdW5jdGlvbihyKXtQcm9taXNlLnJlc29sdmUoci5kYXRhKS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBlKHQpfSkudGhlbihmdW5jdGlvbih0KXt2YXIgbz10Lm91dHB1dCxmPXQudHJhbnNmZXI7cmV0dXJuIHBvc3RNZXNzYWdlKG8sZil9KS5jYXRjaChmdW5jdGlvbih0KXtyZXR1cm4gcG9zdE1lc3NhZ2UoeyQkZXJyb3I6dH0pfSl9fUJyKGZ1bmN0aW9uKGUpe3JldHVybiBQcm9taXNlLnJlc29sdmUoZSkudGhlbihmdW5jdGlvbihyKXtmb3IodmFyIHQ9W10sbz1uZXcgU2V0LGY9MCxkPXI7ZjxkLmxlbmd0aDtmKyspe3ZhciB2PWRbZl0sbj12b2lkIDA7aWYodi50eXBlPT09Im1lc2giKW49bmV3IEFyKHYuYXR0cmlidXRlcy5wb3NpdGlvbix2LmluZGljZXMpO2Vsc2UgaWYodi50eXBlPT09InBvaW50cyIpbj1uZXcgUHIodi5hdHRyaWJ1dGVzLnBvc2l0aW9uLHYuaW5kaWNlcyk7ZWxzZSB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgVHlwZSIpO24uY3JlYXRlVHJlZSh2Lm1heEl0ZW1QZXJOb2RlLHYubWF4VHJlZURlcHRoLHYuZXh0ZW50cyk7dmFyIHM9e3R5cGU6di50eXBlLGF0dHJpYnV0ZXM6di5hdHRyaWJ1dGVzLGluZGljZXM6di5pbmRpY2VzLG9mZnNldEFycmF5Om4ub2Zmc2V0QXJyYXkscm9vdE5vZGVQYWNrZWQ6bi5yb290Tm9kZVBhY2tlZH07dC5wdXNoKHMpO3ZhciB1PXZvaWQgMDtmb3IodmFyIHcgaW4gcy5hdHRyaWJ1dGVzKXt2YXIgeT1zLmF0dHJpYnV0ZXNbd107eSYmeS5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciYmby5hZGQoeS5idWZmZXIpfXU9cy5pbmRpY2VzLHUmJnUuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXImJm8uYWRkKHUuYnVmZmVyKSx1PXMub2Zmc2V0QXJyYXksdSYmdS5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciYmby5hZGQodS5idWZmZXIpLG8uYWRkKHMucm9vdE5vZGVQYWNrZWQpfXJldHVybntvdXRwdXQ6dCx0cmFuc2ZlcjpBcnJheS5mcm9tKG8pfX0pfSl9KSgpOwo=",decodeBase64$1=$e=>Uint8Array.from(atob($e),Se=>Se.charCodeAt(0)),blob$2=typeof self<"u"&&self.Blob&&new Blob([decodeBase64$1(encodedJs$1)],{type:"text/javascript;charset=utf-8"});function WorkerWrapper$1($e){let Se;try{if(Se=blob$2&&(self.URL||self.webkitURL).createObjectURL(blob$2),!Se)throw"";const Be=new Worker(Se,{name:$e?.name});return Be.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(Se)}),Be}catch{return new Worker("data:text/javascript;base64,"+encodedJs$1,{name:$e?.name})}finally{Se&&(self.URL||self.webkitURL).revokeObjectURL(Se)}}var WorkerPool$1=function(){function $e(Se,Be){this.pool=Be,this.workerCreator=Se,this.queue=[],this.workers=[],this.workersResolver=[],this.workerStatus=0}return $e.prototype.initWorker=function(Se){if(this.workerCreator&&!this.workers[Se]){var Be=this.workerCreator();Be.addEventListener("message",this.onMessage.bind(this,Se)),this.workers[Se]=Be}},$e.prototype.getIdleWorker=function(){for(var Se=0;Se<this.pool;Se++)if(!(this.workerStatus&1<<Se))return Se;return-1},$e.prototype.onMessage=function(Se,Be){var De=this.workersResolver[Se],Ve=De.resolve,Fe=De.reject;if(Be.data&&"$$error"in Be.data?Fe(Be.data.$$error):Ve(Be.data),this.queue.length){var Je=this.queue.shift(),Xe=Je.resolve,Ke=Je.reject,Ye=Je.input,or=Je.transfer;this.workersResolver[Se]={resolve:Xe,reject:Ke},this.workers[Se].postMessage(Ye,or)}else this.workerStatus^=1<<Se},$e.prototype.postMessage=function(Se,Be){var De=this;return Be===void 0&&(Be=[]),new Promise(function(Ve,Fe){var Je=De.getIdleWorker();Je!==-1?(De.initWorker(Je),De.workerStatus|=1<<Je,De.workersResolver[Je]={resolve:Ve,reject:Fe},De.workers[Je].postMessage(Se,Be)):De.queue.push({resolve:Ve,reject:Fe,input:Se,transfer:Be})})},$e.prototype.dispose=function(){this.workers.forEach(function(Se){return Se.terminate()}),this.workersResolver.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0},$e}(),bvhWorkerPool=new WorkerPool$1(function(){return new WorkerWrapper$1},4),bvhMeshMap=new Map,scratchRay=new Ray,scratchNormalMatrix=new Matrix3,scratchInverseMatrix=new Matrix4,scratchIntersectionFaceA=new Vector3,scratchIntersectionFaceB=new Vector3,scratchIntersectionFaceC=new Vector3,scratchIntersectionTriangle=new Triangle;function raycastMesh($e,Se,Be,De){var Ve,Fe=$e.matrixWorld;scratchInverseMatrix.getInverse(Fe),scratchRay.copy(Be.ray).applyMatrix4(scratchInverseMatrix);for(var Je=Se.intersectRay(scratchRay.origin,scratchRay.direction,0,[]),Xe=$e.geometry,Ke=$e.material,Ye=Xe.groups,or=Xe.index,sr=0,cr=Je.length;sr<cr;sr++){var Br=Je[sr],tn=Br.triangle,en=Br.index,an=Br.intersectionPoint,rn=new Vector3(an[0],an[1],an[2]).applyMatrix4(Fe),on=Be.ray.origin.distanceTo(rn);if(!(on<Be.near||on>Be.far)){var sn=void 0;if(Array.isArray(Ke)){if(Ye)for(var ln=en*3,cn=0,hn=Ye;cn<hn.length;cn++){var mn=hn[cn];if(ln>=mn.start&&ln-mn.start<mn.count){sn=Ke[(Ve=mn.materialIndex)!==null&&Ve!==void 0?Ve:0];break}}}else sn=Ke;if(sn){var An=scratchIntersectionTriangle.set(scratchIntersectionFaceA.set(tn[0],tn[1],tn[2]).applyMatrix4(Fe),scratchIntersectionFaceB.set(tn[3],tn[4],tn[5]).applyMatrix4(Fe),scratchIntersectionFaceC.set(tn[6],tn[7],tn[8]).applyMatrix4(Fe)).getNormal(new Vector3),xn=en*3,pn=new Face3(or?or.array[xn]:xn,or?or.array[xn+1]:xn+1,or?or.array[xn+2]:xn+2,An),dn=Be.ray.direction.dot(An);sn.side===FrontSide&&dn>=0||sn.side===BackSide&&dn<=0||De.push({distance:on,object:$e,face:pn,point:rn,distanceToRay:0,faceIndex:en})}}}}function raycastPoints($e,Se,Be,De){var Ve,Fe,Je=$e.matrixWorld;scratchNormalMatrix.getNormalMatrix(Je),scratchInverseMatrix.getInverse(Je);var Xe=((Fe=(Ve=Be.params.Points)===null||Ve===void 0?void 0:Ve.threshold)!==null&&Fe!==void 0?Fe:1)*scratchInverseMatrix.getMaxScaleOnAxis();scratchRay.copy(Be.ray).applyMatrix4(scratchInverseMatrix);for(var Ke=Se.intersectRay(scratchRay.origin,scratchRay.direction,Xe,[]),Ye=$e.geometry,or=Ye.index,sr=Ye.getAttribute("normal"),cr=0,Br=Ke.length;cr<Br;cr++){var tn=Ke[cr],en=tn.triangle,an=tn.index,rn=tn.intersectionPoint,on=new Vector3(rn[0],rn[1],rn[2]).applyMatrix4(Je),sn=Be.ray.origin.distanceTo(on);if(!(sn<Be.near||sn>Be.far)){var ln=scratchIntersectionFaceA.set(en[0],en[1],en[2]).applyMatrix4(Je),cn=or?or.array[an]:an,hn=void 0;if(sr instanceof BufferAttribute){var mn=new Vector3().fromBufferAttribute(sr,cn).applyNormalMatrix(scratchNormalMatrix);hn=new Face3(cn,cn,cn,mn)}De.push({distance:sn,object:$e,face:hn,point:on,distanceToRay:on.distanceTo(ln),index:an})}}}var BVH_MESH_PROP="__bvh_mesh__",originMeshRaycast=Mesh.prototype.raycast;function overrideMeshRaycast($e,Se){var Be=getBvhTreeForMesh(this);Be?raycastMesh(this,Be,$e,Se):originMeshRaycast.call(this,$e,Se)}function getBvhTreeForMesh($e){var Se=$e[BVH_MESH_PROP];return Se}function bindBvhTreeForMesh($e,Se){var Be;Object.assign($e,(Be={},Be[BVH_MESH_PROP]=Se,Be.raycast=overrideMeshRaycast,Be))}var BVH_POINTS_PROP="__bvh_points__",originPointsRaycast=Points.prototype.raycast;function overridePointsRaycast($e,Se){var Be=getBvhTreeForPoints(this);Be?raycastPoints(this,Be,$e,Se):originPointsRaycast.call(this,$e,Se)}function getBvhTreeForPoints($e){var Se=$e[BVH_POINTS_PROP];return Se}function bindBvhTreeForPoints($e,Se){var Be;Object.assign($e,(Be={},Be[BVH_POINTS_PROP]=Se,Be.raycast=overridePointsRaycast,Be))}function generateBvhTree($e,Se,Be,De){var Ve=[];return $e.traverse(function(Fe){(Fe instanceof Mesh||Fe instanceof Points)&&Fe.geometry instanceof BufferGeometry&&Ve.push(Fe)}),Promise.resolve().then(function(){for(var Fe=[],Je=new Set,Xe=null,Ke=0;Ke<Ve.length;Ke++){var Ye=Ve[Ke],or=Ye.geometry;if(or instanceof BufferGeometry){var sr=void 0;if(Ye instanceof Mesh?sr="mesh":Ye instanceof Points&&(sr="points"),!!sr){var cr=or.boundingBox,Br=cr?[cr.min.x,cr.min.y,cr.min.z,cr.max.x,cr.max.y,cr.max.z]:void 0,tn={};for(var en in or.attributes){var an=or.attributes[en];an instanceof InterleavedBufferAttribute?(tn[en]={array:an.data.array,stride:an.data.stride,offset:an.offset},Xe=an.data.array,Xe&&Xe.buffer instanceof ArrayBuffer&&Je.add(Xe.buffer)):(tn[en]={array:an.array},Xe=an.array,Xe&&Xe.buffer instanceof ArrayBuffer&&Je.add(Xe.buffer))}var rn=void 0,on=or.getIndex();on&&(on instanceof InterleavedBufferAttribute?(rn={array:on.data.array,stride:on.data.stride,offset:on.offset},Xe=on.data.array,Xe&&Xe.buffer instanceof ArrayBuffer&&Je.add(Xe.buffer)):(rn={array:on.array},Xe=on.array,Xe&&Xe.buffer instanceof ArrayBuffer&&Je.add(Xe.buffer)));var sn={type:sr,attributes:tn,indices:rn,maxItemPerNode:Be,maxTreeDepth:De,extents:Br};Fe.push(sn)}}}return bvhWorkerPool.postMessage(Fe,Array.from(Je))}).then(function(Fe){for(var Je=0;Je<Ve.length;Je++){var Xe=Ve[Je],Ke=Xe.geometry,Ye=Fe[Je];if(Ke instanceof BufferGeometry){for(var or in Ye.attributes){var sr=Ye.attributes[or].array,cr=Ke.attributes[or];cr instanceof InterleavedBufferAttribute?cr.data.array=sr:cr.array=sr}var Br=Ke.getIndex();if(Br&&Ye.indices){var sr=Ye.indices.array;Br instanceof InterleavedBufferAttribute?Br.data.array=sr:Br.array=sr}if(Xe instanceof Mesh){var tn=new BVHMesh(Ye.attributes.position,Ye.indices);tn.offsetArray=Ye.offsetArray,tn.rootNodePacked=Ye.rootNodePacked,bindBvhTreeForMesh(Xe,tn)}else if(Xe instanceof Points){var tn=new BVHPoints(Ye.attributes.position,Ye.indices);tn.offsetArray=Ye.offsetArray,tn.rootNodePacked=Ye.rootNodePacked,bindBvhTreeForPoints(Xe,tn)}}}return $e})}var TileNode=function($e){__extends(Se,$e);function Se(Be,De,Ve){Ve===void 0&&(Ve=noop$1);var Fe=$e.call(this)||this;return Fe.contentObject=De,Fe.name=Be,Fe.materials=[],Fe.pbmObjects=[],Fe.disposers=[Ve],Fe.add(De),De.traverse(function(Je){var Xe;if(Je instanceof Mesh||Je instanceof Points){var Ke=Je.material;Array.isArray(Ke)?(Xe=Fe.materials).push.apply(Xe,Ke):Fe.materials.push(Ke)}(Je instanceof PBMMesh||Je instanceof PBMSkinnedMesh||Je instanceof PBMPointCloud)&&Fe.pbmObjects.push(Je)}),Fe}return Se.prototype.generateBvhTree=function(){return generateBvhTree(this,!0,200,10)},Se.prototype.intersectRaycaster=function(Be,De,Ve){De===void 0&&(De=!0),Ve===void 0&&(Ve=[]);for(var Fe=this.children.slice(),Je,Xe=[];Je=Fe.pop();)if(Je.visible){Je.raycast(Be,Xe);for(var Ke=0,Ye=Je.children.length;Ke<Ye;Ke++)Fe.push(Je.children[Ke])}return Xe.forEach(function(or){var sr=0;if((or.object instanceof PBMMesh||or.object instanceof PBMSkinnedMesh||or.object instanceof PBMPointCloud)&&or.face){var cr=Array.isArray(or.object.material)?or.object.material[or.face.materialIndex]:or.object.material;cr&&(sr=cr.floorIndex)}or.floor=sr}),De&&Xe.sort(function(or,sr){return or.distance-sr.distance}),Ve.push.apply(Ve,Xe),Ve},Se.prototype.update=function(Be,De,Ve,Fe){for(var Je=0,Xe=this.pbmObjects;Je<Xe.length;Je++){var Ke=Xe[Je];Ke.update(Be,De,Ve,Fe)}},Se.prototype.dispose=function(){for(var Be=0,De=this.disposers;Be<De.length;Be++){var Ve=De[Be];Ve()}this.disposers.length=0,this.pbmObjects.length=0},Se.prototype.clone=function(){return new Se(this.name,this.contentObject.clone())},Se}(Object3D);function pathJoin(){for(var $e=[],Se=0;Se<arguments.length;Se++)$e[Se]=arguments[Se];var Be=[];$e=$e.map(function(Xe){return(Xe??"").trim()}).filter(function(Xe){return Xe.length>0&&!/^\/+$/.test(Xe)});for(var De=0;De<$e.length;De++){var Ve=De===0,Fe=De===$e.length-1,Je=$e[De];Ve||(Je=Je.replace(/^\.\//,"").replace(/^\/+/,"")),Fe||(Je=Je.replace(/\/+$/,"")),Be.push(Je)}return Be.join("/")}function normalizeURL($e){var Se,Be=/^(http\:|https\:|file\:)?\/\/[^/]/.exec($e);if(!Be)return $e;var De=Be[1]||"",Ve=$e.slice(De.length+2),Fe=Ve.indexOf("#");Fe>=0&&($e.slice(Fe),Ve=$e.slice(0,Fe));var Je=Ve.indexOf("?");Je>=0&&($e.slice(Je),Ve=$e.slice(0,Je));for(var Xe=Ve.split("/"),Ke=Xe.shift(),Ye=(Se=Xe.pop())!==null&&Se!==void 0?Se:"",or=[],sr=0,cr=Xe;sr<cr.length;sr++){var Br=cr[sr];if(!(Br===""||Br===".")){if(Br===".."){or.pop();continue}or.push(Br)}}return De+"//"+Ke+"/"+or.join("/")+"/"+Ye}function isAbsoluteURL($e){return $e.indexOf("//")===0||/^[0-9a-z]+\:/i.test($e)}function normalizeTileHeader($e,Se,Be){var De;if($e.content){var Ve=(De=$e.content.uri)!==null&&De!==void 0?De:$e.content.url;typeof Ve=="string"&&!isAbsoluteURL(Ve)&&($e.content.uri=normalizeURL(pathJoin(Se,Ve)))}if($e.transform){for(var Fe=!1,Je=0;Je<16;Je++){var Xe=$e.transform[Je];if(typeof Xe!="number"||isNaN(Xe)||!isFinite(Xe)){Fe=!0;break}}if($e.transform[15]===0&&(Fe=!0),Fe)throw new Error("Invalid Tile Transform: "+JSON.stringify($e.transform))}if($e.children)for(var Ke=0,Ye=$e.children;Ke<Ye.length;Ke++){var or=Ye[Ke];normalizeTileHeader(or,Se)}return $e}function normalizeTilesetHeader($e,Se){if($e.asset||($e.asset={}),$e.rootMeta||($e.rootMeta={}),$e.rootMeta.taskParameters||($e.rootMeta.taskParameters={}),$e.asset.overview){var Be=$e.asset.overview;isAbsoluteURL(Be.imageFile)||(Be.imageFile=normalizeURL(pathJoin(Se,Be.imageFile))),isAbsoluteURL(Be.worldFile)||(Be.worldFile=normalizeURL(pathJoin(Se,Be.worldFile)))}if($e.asset.trajectories)for(var De=0;De<$e.asset.trajectories.list.length;De++){var Ve=$e.asset.trajectories.list[De];Ve.file=normalizeURL(pathJoin(Se,Ve.file))}return normalizeTileHeader($e.root,Se),$e}function initTextures($e,Se,Be){for(var De,Ve,Fe=Promise.resolve(),Je=$e.slice(),Xe=function(){for(var Ke=[],Ye=0,or=void 0;or=Je.shift();){Ke.push(or);var sr=((De=or.image)===null||De===void 0?void 0:De.width)*((Ve=or.image)===null||Ve===void 0?void 0:Ve.height);if(!isNaN(sr)&&isFinite(sr)&&(Ye+=sr),Ye>=Be)break}Fe=Fe.then(function(){return new Promise(function(cr){AnimationFrameLoop.shared.add(function(){for(var Br=0,tn=Ke;Br<tn.length;Br++){var en=tn[Br];Se.initTexture(en)}cr()},!0)})}).catch(function(){})};Je.length>0;)Xe();return Fe}function appendSearch($e,Se){if(Se===void 0&&(Se=""),(Se[0]==="?"||Se[0]==="&")&&(Se=Se.slice(1)),!Se)return $e;var Be=$e.indexOf("#"),De="";return Be>=0&&(De=$e.slice(Be),$e=$e.slice(0,Be)),($e[$e.length-1]==="?"||$e[$e.length-1]==="&")&&($e=$e.slice(0,-1)),$e.indexOf("?")>=0?"".concat($e,"&").concat(Se).concat(De):"".concat($e,"?").concat(Se).concat(De)}var SIZEOF_UINT32$1=4;function parseHeader$1($e,Se,Be){var De=new DataView(Se);if($e.magic=De.getUint32(Be,!0),Be+=SIZEOF_UINT32$1,$e.version=De.getUint32(Be,!0),Be+=SIZEOF_UINT32$1,$e.byteLength=De.getUint32(Be,!0),Be+=SIZEOF_UINT32$1,$e.version!==1)throw new Error("3D Tile Version ".concat($e.version," not supported"));return Be}var _a$4,GL_TYPE;(function($e){$e[$e.BYTE=5120]="BYTE",$e[$e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",$e[$e.SHORT=5122]="SHORT",$e[$e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",$e[$e.INT=5124]="INT",$e[$e.UNSIGNED_INT=5125]="UNSIGNED_INT",$e[$e.FLOAT=5126]="FLOAT",$e[$e.DOUBLE=5130]="DOUBLE"})(GL_TYPE||(GL_TYPE={}));var GL_TYPE_TO_ARRAY_TYPE=(_a$4={},_a$4[GL_TYPE.DOUBLE]=Float64Array,_a$4[GL_TYPE.FLOAT]=Float32Array,_a$4[GL_TYPE.UNSIGNED_SHORT]=Uint16Array,_a$4[GL_TYPE.UNSIGNED_INT]=Uint32Array,_a$4[GL_TYPE.UNSIGNED_BYTE]=Uint8Array,_a$4[GL_TYPE.BYTE]=Int8Array,_a$4[GL_TYPE.SHORT]=Int16Array,_a$4[GL_TYPE.INT]=Int32Array,_a$4),NAME_TO_GL_TYPE={DOUBLE:GL_TYPE.DOUBLE,FLOAT:GL_TYPE.FLOAT,UNSIGNED_SHORT:GL_TYPE.UNSIGNED_SHORT,UNSIGNED_INT:GL_TYPE.UNSIGNED_INT,UNSIGNED_BYTE:GL_TYPE.UNSIGNED_BYTE,BYTE:GL_TYPE.BYTE,SHORT:GL_TYPE.SHORT,INT:GL_TYPE.INT};function getArrayType($e){var Se=GL_TYPE_TO_ARRAY_TYPE[$e];if(!Se)throw new Error("Failed to convert GL type");return Se}function getByteSize($e){var Se=getArrayType($e);return Se.BYTES_PER_ELEMENT}function createTypedArray($e,Se,Be,De){Be===void 0&&(Be=0);var Ve=getArrayType($e);if(Be%getByteSize($e)!==0){var Fe=De?Se.slice(Be,Be+De*getByteSize($e)):Se.slice(Be);return new Ve(Fe)}else return new Ve(Se,Be,De??(Se.byteLength-Be)/getByteSize($e))}function glTypeFromName($e){var Se=NAME_TO_GL_TYPE[$e];if(!Se)throw new Error("Failed to convert GL type");return Se}var FeatureTable=function(){function $e(Se,Be){this.featuresLength=0,this.cachedTypedArrays={},this.json=Se,this.buffer=Be;var De=this.getGlobalProperty("POINTS_LENGTH",GL_TYPE.UNSIGNED_INT,1);De&&De.length&&(this.featuresLength=De[0])}return $e.prototype.getExtension=function(Se){return this.json.extensions&&this.json.extensions[Se]},$e.prototype.hasProperty=function(Se){return!!this.json[Se]},$e.prototype.getGlobalProperty=function(Se,Be,De){var Ve=this.json[Se];if(typeof Ve=="number"){var Fe=getArrayType(Be);return new Fe([Ve])}else if(Array.isArray(Ve)){var Fe=getArrayType(Be);return new Fe(Ve)}else if(Ve&&Number.isFinite(Ve.byteOffset))return this.getTypedArrayFromBinary(Se,Be,De,1,Ve.byteOffset);return null},$e.prototype.getPropertyArray=function(Se,Be,De){var Ve=this.json[Se];return Ve&&Number.isFinite(Ve.byteOffset)?("componentType"in Ve&&(Be=glTypeFromName(Ve.componentType)),this.getTypedArrayFromBinary(Se,Be,De,this.featuresLength,Ve.byteOffset)):this.getTypedArrayFromArray(Se,Be,Ve)},$e.prototype.getProperty=function(Se,Be,De,Ve,Fe){var Je=this.json[Se];if(!Je)return null;var Xe=this.getPropertyArray(Se,Be,De);if(De===1)return Fe[0]=Xe[Ve],Fe;for(var Ke=0;Ke<De;++Ke)Fe[Ke]=Xe[De*Ve+Ke];return Fe},$e.prototype.getTypedArrayFromBinary=function(Se,Be,De,Ve,Fe){var Je=this.cachedTypedArrays,Xe=Je[Se];return Xe||(Xe=createTypedArray(Be,this.buffer.buffer,this.buffer.byteOffset+Fe,Ve*De),Je[Se]=Xe),Xe},$e.prototype.getTypedArrayFromArray=function(Se,Be,De){var Ve=this.cachedTypedArrays,Fe=Ve[Se];return Fe||(Fe=createTypedArray(Be,De),Ve[Se]=Fe),Fe},$e}(),SIZEOF_UINT32=4,DEPRECATION_WARNING="b3dm tile in legacy format.";function getStringFromArrayBuffer($e,Se,Be){var De=new TextDecoder("utf8"),Ve=new Uint8Array($e,Se,Be),Fe=De.decode(Ve);return Fe}function parseTable($e,Se,Be){return Be=parseTablesHeader($e,Se,Be),Be=parseFeatureTable($e,Se,Be),Be=parseBatchTable($e,Se,Be),Be}function parseTablesHeader($e,Se,Be){var De=new DataView(Se),Ve=0;$e.header=$e.header||{};var Fe=De.getUint32(Be,!0);Be+=SIZEOF_UINT32;var Je=De.getUint32(Be,!0);Be+=SIZEOF_UINT32;var Xe=De.getUint32(Be,!0);Be+=SIZEOF_UINT32;var Ke=De.getUint32(Be,!0);return Be+=SIZEOF_UINT32,Xe>=570425344?(Be-=SIZEOF_UINT32*2,Ve=Fe,Xe=Je,Ke=0,Fe=0,Je=0,console.warn(DEPRECATION_WARNING)):Ke>=570425344&&(Be-=SIZEOF_UINT32,Ve=Xe,Xe=Fe,Ke=Je,Fe=0,Je=0,console.warn(DEPRECATION_WARNING)),$e.header.featureTableJsonByteLength=Fe,$e.header.featureTableBinaryByteLength=Je,$e.header.batchTableJsonByteLength=Xe,$e.header.batchTableBinaryByteLength=Ke,$e.header.batchLength=Ve,Be}function parseFeatureTable($e,Se,Be){var De=$e.header||{},Ve=De.featureTableJsonByteLength,Fe=De.featureTableBinaryByteLength,Je=De.batchLength;if($e.featureTableJson={BATCH_LENGTH:Je||0},Ve&&Ve>0){var Xe=getStringFromArrayBuffer(Se,Be,Ve);$e.featureTableJson=JSON.parse(Xe)}Be+=Ve||0,$e.featureTableBinary=new Uint8Array(Se,Be,Fe),Be+=Fe||0,$e.rtcCenter=[0,0,0];var Ke=new FeatureTable($e.featureTableJson,$e.featureTableBinary);if(Array.isArray(Ke.json.RTC_CENTER)){var Ye=Ke.json.RTC_CENTER;$e.rtcCenter[0]=Ye[0],$e.rtcCenter[1]=Ye[1],$e.rtcCenter[2]=Ye[2]}else{var Ye=Ke.getGlobalProperty("RTC_CENTER",GL_TYPE.FLOAT,3);Ye&&($e.rtcCenter[0]=Ye[0],$e.rtcCenter[1]=Ye[1],$e.rtcCenter[2]=Ye[2])}return Be}function parseBatchTable($e,Se,Be){var De=$e.header||{},Ve=De.batchTableJsonByteLength,Fe=De.batchTableBinaryByteLength;if(Ve&&Ve>0){var Je=getStringFromArrayBuffer(Se,Be,Ve);$e.batchTableJson=JSON.parse(Je),Be+=Ve,Fe&&Fe>0&&($e.batchTableBinary=new Uint8Array(Se,Be,Fe),$e.batchTableBinary=new Uint8Array($e.batchTableBinary),Be+=Fe)}return Be}function sliceArrayBuffer($e,Se,Be){var De=Be!==void 0?new Uint8Array($e).subarray(Se,Se+Be):new Uint8Array($e).subarray(Se),Ve=new Uint8Array(De);return Ve.buffer}function parseGlTFArrayBuffer($e,Se,Be){var De=$e.byteLength-Be;if(De===0)throw new Error("glTF byte length must be greater than 0.");return Be%4!==0&&console.warn("".concat($e.type,": embedded glb is not aligned to a 4-byte boundary.")),$e.gltfArrayBuffer=sliceArrayBuffer(Se,Be,De),$e.byteLength}function decodeText($e){if(typeof TextDecoder<"u")return new TextDecoder().decode($e);for(var Se="",Be=0,De=$e.length;Be<De;Be++)Se+=String.fromCharCode($e[Be]);try{return decodeURIComponent(escape(Se))}catch{return Se}}var WEBGL_CONSTANTS={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function values($e){var Se=[];for(var Be in $e)Se.push($e[Be]);return Se}function composeDsiposeSet($e){var Se=Array.from($e);return function(){for(var Be=0,De=Se;Be<De.length;Be++){var Ve=De[Be];typeof Ve.dispose=="function"&&Ve.dispose(),typeof Ve.close=="function"&&Ve.close()}}}var Parser=function(){function $e(Se,Be,De){this.json=Se,this.extensions=Be,this.options=De,this.cache=new Map,this.disposeSet=new Set,this.textureSet=new Set,this.nodeNamesUsed={}}return $e.prototype.dispose=function(){this.cache.clear(),this.disposeSet.forEach(function(Se){typeof Se.dispose=="function"&&Se.dispose(),typeof Se.close=="function"&&Se.close()}),this.disposeSet.clear(),this.textureSet.clear(),this.extensions={},this.json={asset:{version:"unknown"}}},$e.prototype.markDefs=function(){for(var Se=this.json.nodes||[],Be=this.json.skins||[],De=this.json.meshes||[],Ve=0,Fe=Be.length;Ve<Fe;Ve++)for(var Je=Be[Ve].joints,Xe=0,Ke=Je.length;Xe<Ke;Xe++)Se[Je[Xe]].isBone=!0;for(var Ye=0,or=Se.length;Ye<or;Ye++){var sr=Se[Ye];sr.mesh!==void 0&&sr.skin!==void 0&&(De[sr.mesh].isSkinnedMesh=!0)}},$e.prototype.parse=function(){var Se=this,Be=this.json,De=this.extensions;this.markDefs();for(var Ve=0,Fe=values(De);Ve<Fe.length;Ve++){var Je=Fe[Ve];Je.markDefs(this)}return Promise.all(values(De).map(function(Xe){return Xe.prepare(Se)})).then(function(){var Xe,Ke,Ye;return Promise.all([Promise.all(((Xe=Be.scenes)!==null&&Xe!==void 0?Xe:[]).map(function(or,sr){return Se.loadScene(sr)})),Promise.all(((Ke=Be.animations)!==null&&Ke!==void 0?Ke:[]).map(function(or,sr){return Se.loadAnimation(sr)})),Promise.all(((Ye=Be.cameras)!==null&&Ye!==void 0?Ye:[]).map(function(or,sr){return Se.loadCamera(sr)}))])}).then(function(Xe){var Ke=Xe[0],Ye=Xe[1],or=Xe[2],sr={json:Be,scene:Ke[Be.scene||0],scenes:Ke,animations:Ye,cameras:or,textures:[],dispose:noop$1};return sr}).then(function(Xe){return Promise.all(values(De).map(function(Ke){return Ke.emitResult(Xe,Se)})).then(function(){return Xe})}).then(function(Xe){var Ke=Array.from(Se.textureSet),Ye=composeDsiposeSet(Se.disposeSet);return Object.assign(Xe,{textures:Ke,dispose:Ye}),Se.textureSet.clear(),Se.disposeSet.clear(),Se.dispose(),Xe})},$e.prototype.loadCamera=function(Se){var Be="camera:"+Se,De=this.cache.get(Be);if(De)return De;for(var Ve=null,Fe=0,Je=values(this.extensions);Fe<Je.length;Fe++){var Xe=Je[Fe];if(Ve=Xe.loadCamera(Se,this),Ve)break}if(!Ve){var Ke=void 0,Ye=this.json.cameras[Se],or=Ye[Ye.type];or?Ye.type==="perspective"?Ke=new PerspectiveCamera(MathUtils.radToDeg(or.yfov),or.aspectRatio||1,or.znear||1,or.zfar||2e6):Ye.type==="orthographic"?Ke=new OrthographicCamera(-or.xmag,or.xmag,or.ymag,-or.ymag,or.znear,or.zfar):(console.warn("glTF: Invalid camera type ".concat(Ye.type,".")),Ke=new Camera$1):(console.warn("glTF: Missing camera parameters."),Ke=new Camera$1),Ye.name&&(Ke.name=this.createUniqueName(Ye.name)),Ve=Promise.resolve(Ke)}return this.cache.set(Be,Ve),Ve},$e.prototype.loadSkin=function(Se){var Be="animation:"+Se,De=this.cache.get(Be);if(De)return De;var Ve,Fe=this.json.skins[Se],Je={joints:Fe.joints};return Fe.inverseBindMatrices===void 0?Ve=Promise.resolve(Je):Ve=this.loadAccessor(Fe.inverseBindMatrices).then(function(Xe){return Xe&&(Je.inverseBindMatrices=Xe),Je}),this.cache.set(Be,Ve),Ve},$e.prototype.loadAnimation=function(Se){var Be="animation:"+Se,De=this.cache.get(Be);if(De)return De;for(var Ve=null,Fe=0,Je=values(this.extensions);Fe<Je.length;Fe++){var Xe=Je[Fe];if(Ve=Xe.loadAnimation(Se,this),Ve)break}if(!Ve){for(var Ke=this.json,Ye=Ke.animations[Se],or=[],sr=[],cr=[],Br=[],tn=[],en=0,an=Ye.channels.length;en<an;en++){var rn=Ye.channels[en],on=Ye.samplers[rn.sampler],sn=rn.target,ln=sn.node!==void 0?sn.node:sn.id,cn=Ye.parameters!==void 0?Ye.parameters[on.input]:on.input,hn=Ye.parameters!==void 0?Ye.parameters[on.output]:on.output;or.push(this.loadNode(ln)),sr.push(this.loadAccessor(cn)),cr.push(this.loadAccessor(hn)),Br.push(on),tn.push(sn)}Ve=Promise.all([Promise.all(or),Promise.all(sr),Promise.all(cr),Promise.all(Br),Promise.all(tn)]).then(function(mn){for(var An=mn[0],xn=mn[1],pn=mn[2],dn=mn[3],fn=mn[4],yn=[],Sn=function(Bn,kn){var Ln=An[Bn],Pn=xn[Bn],Vn=pn[Bn],Yn=dn[Bn],ni=fn[Bn];if(Ln===void 0)return"continue";Ln.updateMatrix(),Ln.matrixAutoUpdate=!0;var Rn=void 0;switch(PATH_PROPERTIES[ni.path]){case PATH_PROPERTIES.weights:Rn=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:Rn=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:default:Rn=VectorKeyframeTrack;break}var In=Ln.name?Ln.name:Ln.uuid,Gn=Yn.interpolation!==void 0?INTERPOLATION[Yn.interpolation]:InterpolateLinear,Fn=[];PATH_PROPERTIES[ni.path]===PATH_PROPERTIES.weights?Ln.traverse(function(ei){ei.morphTargetInfluences&&Fn.push(ei.name?ei.name:ei.uuid)}):Fn.push(In);var Hn=Vn.array;if(Vn.normalized){for(var Dn=getNormalizedComponentScale(Hn.constructor),zn=new Float32Array(Hn.length),Qn=0,Zn=Hn.length;Qn<Zn;Qn++)zn[Qn]=Hn[Qn]*Dn;Hn=zn}for(var Qn=0,Zn=Fn.length;Qn<Zn;Qn++){var si=new Rn(Fn[Qn]+"."+PATH_PROPERTIES[ni.path],Pn.array,Hn,Gn);yn.push(si)}},gn=0,Cn=An.length;gn<Cn;gn++)Sn(gn);var Mn=Ye.name?Ye.name:"animation_"+Se;return new AnimationClip(Mn,void 0,yn)})}return this.cache.set(Be,Ve),Ve},$e.prototype.loadBuffer=function(Se){var Be=this.json.buffers[Se];if(Be.type&&Be.type!=="arraybuffer")throw new Error("glTF: "+Be.type+" buffer type is not supported.");var De="buffer:"+Se,Ve=this.cache.get(De);if(Ve)return Ve;for(var Fe=null,Je=0,Xe=values(this.extensions);Je<Xe.length;Je++){var Ke=Xe[Je];if(Fe=Ke.loadBuffer(Se,this),Fe)break}if(!Fe){var Ye=this.json.buffers[Se];Fe=this.options.fetcher.ajax(this.resolveResouce(Ye.uri),{responseType:"arraybuffer"}).then(function(or){return or.body})}return this.cache.set(De,Fe),Fe},$e.prototype.loadBufferView=function(Se){var Be="bufferView:"+Se,De=this.cache.get(Be);if(De)return De;for(var Ve=null,Fe=0,Je=values(this.extensions);Fe<Je.length;Fe++){var Xe=Je[Fe];if(Ve=Xe.loadBufferView(Se,this),Ve)break}if(!Ve){var Ke=this.json.bufferViews[Se];Ve=this.loadBuffer(Ke.buffer).then(function(Ye){var or=Ke.byteLength||0,sr=Ke.byteOffset||0;return Ye.slice(sr,sr+or)})}return this.cache.set(Be,Ve),Ve},$e.prototype.loadAccessor=function(Se){var Be=this,De="accessor:"+Se,Ve=this.cache.get(De);if(Ve)return Ve;var Fe=null;if(!Fe){var Je=this.json.accessors[Se];if(Je.bufferView===void 0&&Je.sparse===void 0)Fe=Promise.resolve(null);else{var Xe=[];Je.bufferView!==void 0?Xe.push(this.loadBufferView(Je.bufferView)):Xe.push(Promise.resolve(null)),Je.sparse!==void 0&&(Xe.push(this.loadBufferView(Je.sparse.indices.bufferView)),Xe.push(this.loadBufferView(Je.sparse.values.bufferView))),Fe=Promise.all(Xe).then(function(Ke){var Ye=Ke[0],or=WEBGL_TYPE_SIZES[Je.type],sr=WEBGL_COMPONENT_TYPES[Je.componentType],cr=sr.BYTES_PER_ELEMENT,Br=cr*or,tn=Je.byteOffset||0,en=Je.bufferView!==void 0?Be.json.bufferViews[Je.bufferView].byteStride:void 0,an=Je.normalized===!0,rn,on;if(en&&en!==Br){var sn=Math.floor(tn/en),ln="InterleavedBuffer:"+Je.bufferView+":"+Je.componentType+":"+sn+":"+Je.count,cn=Be.cache.get(ln);cn||(rn=new sr(Ye,sn*en,Je.count*en/cr),cn=new InterleavedBuffer(rn,en/cr),Be.cache.set(ln,cn)),on=new InterleavedBufferAttribute(cn,or,tn%en/cr,an)}else Ye===null?rn=new sr(Je.count*or):rn=new sr(Ye,tn,Je.count*or),on=new BufferAttribute(rn,or,an);if(Je.sparse!==void 0){var hn=WEBGL_TYPE_SIZES.SCALAR,mn=WEBGL_COMPONENT_TYPES[Je.sparse.indices.componentType],An=Je.sparse.indices.byteOffset||0,xn=Je.sparse.values.byteOffset||0,pn=new mn(Ke[1],An,Je.sparse.count*hn),dn=new sr(Ke[2],xn,Je.sparse.count*or);Ye!==null&&(on=new BufferAttribute(on.array.slice(),on.itemSize,on.normalized));for(var fn=0,yn=pn.length;fn<yn;fn++){var Sn=pn[fn];if(on.setX(Sn,dn[fn*or]),or>=2&&on.setY(Sn,dn[fn*or+1]),or>=3&&on.setZ(Sn,dn[fn*or+2]),or>=4&&on.setW(Sn,dn[fn*or+3]),or>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return on})}}return this.cache.set(De,Fe),Fe},$e.prototype.createPrimitiveKey=function(Se){for(var Be=0,De=values(this.extensions);Be<De.length;Be++){var Ve=De[Be],Fe=Ve.createPrimitiveKey(Se,this);if(Fe)return Fe}for(var Je="",Xe=Object.keys(Se.attributes).sort(),Ke=0,Ye=Xe.length;Ke<Ye;Ke++)Je+=Xe[Ke]+":"+Se.attributes[Xe[Ke]]+";";return Se.indices+":"+Je+":"+Se.mode},$e.prototype.loadGeometry=function(Se){for(var Be=this,De=null,Ve=0,Fe=values(this.extensions);Ve<Fe.length;Ve++){var Je=Fe[Ve];if(De=Je.loadGeometry(Se,this),De)break}return De||(De=this.addGeometryPrimitiveAttributes(new BufferGeometry,Se)),De=De.then(function(Xe){return Be.disposeSet.add(Xe),Xe}),De},$e.prototype.loadImage=function(Se){for(var Be=this,De=null,Ve=0,Fe=values(this.extensions);Ve<Fe.length;Ve++){var Je=Fe[Ve];if(De=Je.loadImage(Se,this),De)break}if(!De){var Xe=this.json.images[Se];if(Xe.bufferView!==void 0){var Ke=this.json.bufferViews[Xe.bufferView];De=this.loadBuffer(Ke.buffer).then(function(or){var sr=Ke.byteOffset||0,cr=Ke.byteLength||0,Br=new Uint8Array(or,sr,cr),tn=new Blob([Br],{type:Xe.mimeType});return createImageBitmapLike(tn)})}else if(Xe.uri){var Ye=this.resolveResouce(Xe.uri);De=this.options.fetcher.loadImage(Ye,{},void 0,void 0,void 0,createImageBitmapLikeImage()).then(function(or){return or.body})}else throw new Error("glTF: Invalid image defs.")}return De=De.then(function(or){return Be.disposeSet.add(or),or}),De},$e.prototype.loadMaterialAsMeshStandardMaterial=function(Se){var Be=this,De=[],Ve=new MeshStandardMaterial;if(Ve.color=new Color(1,1,1),Ve.opacity=1,Object.keys(Se.attributes).filter(function(or){return ATTRIBUTES[or]==="color"}).length>0&&(Ve.vertexColors=!0),Object.keys(Se.attributes).filter(function(or){return ATTRIBUTES[or]==="normal"}).length===0&&(Ve.flatShading=!0),Object.keys(Se.attributes).filter(function(or){return ATTRIBUTES[or]==="tangent"}).length===0?(Ve.normalScale&&(Ve.normalScale.y*=-1),Ve.clearcoatNormalScale&&(Ve.clearcoatNormalScale.y*=-1)):Ve.vertexTangents=!0,Se.material!==void 0){var Fe=this.json.materials[Se.material];Fe.name&&(Ve.name=Fe.name);var Je=Fe.pbrMetallicRoughness||{};if(Array.isArray(Je.baseColorFactor)){var Xe=Je.baseColorFactor;Ve.color.fromArray(Xe),Ve.opacity=Xe[3]}Je.baseColorTexture!==void 0&&De.push(this.createMaterialTexture(Je.baseColorTexture).then(function(or){or.encoding=sRGBEncoding,Ve.map=or,Be.disposeSet.add(or)})),Ve.metalness=Je.metallicFactor!==void 0?Je.metallicFactor:1,Ve.roughness=Je.roughnessFactor!==void 0?Je.roughnessFactor:1,Je.metallicRoughnessTexture!==void 0&&De.push(this.createMaterialTexture(Je.metallicRoughnessTexture).then(function(or){Ve.metalnessMap=or,Ve.roughnessMap=or,Be.disposeSet.add(or)})),Fe.doubleSided===!0&&(Ve.side=DoubleSide);var Ke=Fe.alphaMode||ALPHA_MODES.OPAQUE;if(Ke===ALPHA_MODES.BLEND?(Ve.transparent=!0,Ve.depthWrite=!1):(Ve.transparent=!1,Ke===ALPHA_MODES.MASK&&(Ve.alphaTest=Fe.alphaCutoff!==void 0?Fe.alphaCutoff:.5)),Fe.normalTexture!==void 0&&(De.push(this.createMaterialTexture(Fe.normalTexture).then(function(or){Ve.normalMap=or,Be.disposeSet.add(or)})),Ve.normalScale=new Vector2(1,1),Fe.normalTexture.scale!==void 0)){var Ye=Fe.normalTexture.scale;Ve.normalScale.set(Ye,Ye)}Fe.occlusionTexture!==void 0&&(De.push(this.createMaterialTexture(Fe.occlusionTexture).then(function(or){Ve.aoMap=or,Be.disposeSet.add(or)})),Fe.occlusionTexture.strength!==void 0&&(Ve.aoMapIntensity=Fe.occlusionTexture.strength)),Fe.emissiveFactor!==void 0&&(Ve.emissive=new Color().fromArray(Fe.emissiveFactor)),Fe.emissiveTexture!==void 0&&De.push(this.createMaterialTexture(Fe.emissiveTexture).then(function(or){Ve.emissiveMap=or,Be.disposeSet.add(or)}))}return this.disposeSet.add(Ve),Promise.all(De).then(function(){return Ve})},$e.prototype.loadMaterialAsMeshBasicMaterial=function(Se){var Be=this,De=[],Ve=new MeshBasicMaterial;if(Ve.color=new Color(1,1,1),Ve.opacity=1,Object.keys(Se.attributes).filter(function(Ye){return ATTRIBUTES[Ye]==="color"}).length>0&&(Ve.vertexColors=!0),Object.keys(Se.attributes).filter(function(Ye){return ATTRIBUTES[Ye]==="normal"}).length===0&&(Ve.flatShading=!0),Object.keys(Se.attributes).filter(function(Ye){return ATTRIBUTES[Ye]==="tangent"}).length===0&&(Ve.normalScale&&(Ve.normalScale.y*=-1),Ve.clearcoatNormalScale&&(Ve.clearcoatNormalScale.y*=-1)),Se.material!==void 0){var Fe=this.json.materials[Se.material];Fe.name&&(Ve.name=Fe.name);var Je=Fe.pbrMetallicRoughness||{};if(Array.isArray(Je.baseColorFactor)){var Xe=Je.baseColorFactor;Ve.color.fromArray(Xe),Ve.opacity=Xe[3]}Je.baseColorTexture!==void 0&&De.push(this.createMaterialTexture(Je.baseColorTexture).then(function(Ye){Ve.map=Ye,Be.disposeSet.add(Ye)})),Fe.doubleSided===!0&&(Ve.side=DoubleSide);var Ke=Fe.alphaMode||ALPHA_MODES.OPAQUE;Ke===ALPHA_MODES.BLEND?(Ve.transparent=!0,Ve.depthWrite=!1):(Ve.transparent=!1,Ke===ALPHA_MODES.MASK&&(Ve.alphaTest=Fe.alphaCutoff!==void 0?Fe.alphaCutoff:.5)),Fe.occlusionTexture!==void 0&&(De.push(this.createMaterialTexture(Fe.occlusionTexture).then(function(Ye){Ve.aoMap=Ye,Be.disposeSet.add(Ye)})),Fe.occlusionTexture.strength!==void 0&&(Ve.aoMapIntensity=Fe.occlusionTexture.strength))}return this.disposeSet.add(Ve),Promise.all(De).then(function(){return Ve})},$e.prototype.loadMaterialAsLineBasicMaterial=function(Se){var Be=[],De=new LineBasicMaterial;if(De.color=new Color(1,1,1),De.opacity=1,Object.keys(Se.attributes).filter(function(Ke){return ATTRIBUTES[Ke]==="color"}).length>0&&(De.vertexColors=!0),Object.keys(Se.attributes).filter(function(Ke){return ATTRIBUTES[Ke]==="tangent"}).length===0&&(De.normalScale&&(De.normalScale.y*=-1),De.clearcoatNormalScale&&(De.clearcoatNormalScale.y*=-1)),Se.material!==void 0){var Ve=this.json.materials[Se.material];Ve.name&&(De.name=Ve.name);var Fe=Ve.pbrMetallicRoughness||{};if(Array.isArray(Fe.baseColorFactor)){var Je=Fe.baseColorFactor;De.color.fromArray(Je),De.opacity=Je[3]}Ve.doubleSided===!0&&(De.side=DoubleSide);var Xe=Ve.alphaMode||ALPHA_MODES.OPAQUE;Xe===ALPHA_MODES.BLEND?(De.transparent=!0,De.depthWrite=!1):(De.transparent=!1,Xe===ALPHA_MODES.MASK&&(De.alphaTest=Ve.alphaCutoff!==void 0?Ve.alphaCutoff:.5))}return this.disposeSet.add(De),Promise.all(Be).then(function(){return De})},$e.prototype.loadMaterialAsPointsMaterial=function(Se){var Be=this,De=[],Ve=new PointsMaterial;if(Ve.color=new Color(1,1,1),Ve.opacity=1,Ve.sizeAttenuation=!1,Object.keys(Se.attributes).filter(function(Ye){return ATTRIBUTES[Ye]==="color"}).length>0&&(Ve.vertexColors=!0),Object.keys(Se.attributes).filter(function(Ye){return ATTRIBUTES[Ye]==="tangent"}).length===0&&(Ve.normalScale&&(Ve.normalScale.y*=-1),Ve.clearcoatNormalScale&&(Ve.clearcoatNormalScale.y*=-1)),Se.material!==void 0){var Fe=this.json.materials[Se.material];Fe.name&&(Ve.name=Fe.name);var Je=Fe.pbrMetallicRoughness||{};if(Array.isArray(Je.baseColorFactor)){var Xe=Je.baseColorFactor;Ve.color.fromArray(Xe),Ve.opacity=Xe[3]}Je.baseColorTexture!==void 0&&De.push(this.createMaterialTexture(Je.baseColorTexture).then(function(Ye){Ye.encoding=sRGBEncoding,Ve.map=Ye,Be.disposeSet.add(Ye)})),Fe.doubleSided===!0&&(Ve.side=DoubleSide);var Ke=Fe.alphaMode||ALPHA_MODES.OPAQUE;Ke===ALPHA_MODES.BLEND?(Ve.transparent=!0,Ve.depthWrite=!1):(Ve.transparent=!1,Ke===ALPHA_MODES.MASK&&(Ve.alphaTest=Fe.alphaCutoff!==void 0?Fe.alphaCutoff:.5))}return this.disposeSet.add(Ve),Promise.all(De).then(function(){return Ve})},$e.prototype.loadMaterial=function(Se){var Be=this,De,Ve=(De=Se.mode)!==null&&De!==void 0?De:WEBGL_CONSTANTS.TRIANGLES,Fe="material:"+this.createPrimitiveKey(Se),Je=this.cache.get(Fe);if(Je)return Je;for(var Xe=null,Ke=0,Ye=values(this.extensions);Ke<Ye.length;Ke++){var or=Ye[Ke];if(Xe=or.loadMaterial(Se,this),Xe)break}if(!Xe)if(Ve===WEBGL_CONSTANTS.TRIANGLES||Ve===WEBGL_CONSTANTS.TRIANGLE_STRIP||Ve===WEBGL_CONSTANTS.TRIANGLE_FAN)Xe=this.loadMaterialAsMeshStandardMaterial(Se);else if(Ve===WEBGL_CONSTANTS.LINES||Ve===WEBGL_CONSTANTS.LINE_STRIP||Ve===WEBGL_CONSTANTS.LINE_LOOP)Xe=this.loadMaterialAsLineBasicMaterial(Se);else if(Ve===WEBGL_CONSTANTS.POINTS)Xe=this.loadMaterialAsPointsMaterial(Se);else throw new Error("glTF: Primitive mode unsupported: "+Ve);return Xe=Xe.then(function(sr){return Promise.all(values(Be.extensions).map(function(cr){return cr.extendMaterial(sr,Se,Be)})).then(function(){return sr})}),this.cache.set(Fe,Xe),Xe},$e.prototype.loadTexture=function(Se){var Be=this,De="texture:"+Se,Ve=this.cache.get(De);if(Ve)return Ve;for(var Fe=null,Je=0,Xe=values(this.extensions);Je<Xe.length;Je++){var Ke=Xe[Je];if(Fe=Ke.loadTexture(Se,this),Fe)break}if(!Fe){var Ye=this.json.textures[Se];Fe=this.loadImage(Ye.source).then(function(or){var sr=new Texture(or);sr.needsUpdate=!0,sr.flipY=!1,Ye.name&&(sr.name=Ye.name);var cr=Be.json.samplers||{},Br=cr[Ye.sampler]||{};return sr.magFilter=WEBGL_FILTERS[Br.magFilter]||LinearFilter,sr.minFilter=WEBGL_FILTERS[Br.minFilter]||LinearMipmapLinearFilter,sr.wrapS=WEBGL_WRAPPINGS[Br.wrapS]||RepeatWrapping,sr.wrapT=WEBGL_WRAPPINGS[Br.wrapT]||RepeatWrapping,sr.onUpdate=function(){or.close()},sr})}return Fe=Fe.then(function(or){return Be.disposeSet.add(or),or}),this.cache.set(De,Fe),Fe},$e.prototype.loadMesh=function(Se){for(var Be=this,De=null,Ve=0,Fe=values(this.extensions);Ve<Fe.length;Ve++){var Je=Fe[Ve];if(De=Je.loadMesh(Se,this),De)break}if(!De){var Xe=this.json.meshes[Se],Ke=Xe.primitives,Ye=Promise.all(Ke.map(function(sr){return Be.loadGeometry(sr)})),or=Promise.all(Ke.map(function(sr){return Be.loadMaterial(sr)}));De=Promise.all([Ye,or]).then(function(sr){for(var cr=sr[0],Br=sr[1],tn=[],en=0;en<Ke.length;en++){var an=Ke[en],rn=cr[en],on=Br[en],sn=an.mode||WEBGL_CONSTANTS.TRIANGLES,ln=void 0;if(sn===WEBGL_CONSTANTS.TRIANGLES||sn===WEBGL_CONSTANTS.TRIANGLE_STRIP||sn===WEBGL_CONSTANTS.TRIANGLE_FAN)if(sn===WEBGL_CONSTANTS.TRIANGLE_STRIP?rn=Be.toGeometryTrianglesDrawMode(rn,TriangleStripDrawMode):sn===WEBGL_CONSTANTS.TRIANGLE_FAN&&(rn=Be.toGeometryTrianglesDrawMode(rn,TriangleFanDrawMode)),Be.disposeSet.add(rn),Xe.isSkinnedMesh){var cn=new SkinnedMesh(rn,on);rn.attributes.skinWeight.normalized||cn.normalizeSkinWeights(),ln=cn}else ln=new Mesh(rn,on);else if(sn===WEBGL_CONSTANTS.POINTS)ln=new Points(rn,on);else if(sn===WEBGL_CONSTANTS.LINES)ln=new LineSegments(rn,on);else if(sn===WEBGL_CONSTANTS.LINE_STRIP)ln=new Line(rn,on);else if(sn===WEBGL_CONSTANTS.LINE_LOOP)ln=new LineLoop(rn,on);else throw new Error("glTF: Primitive mode unsupported: "+sn);if(Object.keys(rn.morphAttributes).length>0){if(Xe.weights!==void 0)for(var hn=0,mn=Xe.weights.length;hn<mn;hn++)ln.morphTargetInfluences[hn]=Xe.weights[hn];if(Xe.extras&&Array.isArray(Xe.extras.targetNames)){var An=Xe.extras.targetNames;if(ln.morphTargetInfluences.length===An.length){ln.morphTargetDictionary={};for(var hn=0,mn=An.length;hn<mn;hn++)ln.morphTargetDictionary[An[hn]]=hn}else console.warn("glTF: Invalid extras.targetNames length. Ignoring names.")}}ln.name=Be.createUniqueName(Xe.name||"mesh_"+Se),tn.push(ln)}if(tn.length===1)return tn[0];for(var xn=new Group$1,pn=0,dn=tn;pn<dn.length;pn++){var ln=dn[pn];xn.add(ln)}return xn})}return De},$e.prototype.loadNodeAttachments=function(Se){for(var Be=[],De=0,Ve=values(this.extensions);De<Ve.length;De++){var Fe=Ve[De],Je=Fe.loadNodeAttachments(Se,this);Je&&Be.push(Je)}return Be},$e.prototype.loadNode=function(Se){var Be="node:"+Se,De=this.cache.get(Be);if(De)return De;var Ve=this.json,Fe=Ve.nodes[Se],Je=Fe.name?this.createUniqueName(Fe.name):"",Xe=[];Fe.mesh!==void 0&&Xe.push(this.loadMesh(Fe.mesh).then(function(cr){if(Fe.weights!==void 0){var Br=Fe.weights;cr.traverse(function(tn){if(tn instanceof Mesh||tn instanceof Line||tn instanceof Points)for(var en=0,an=Br.length;en<an;en++)tn.morphTargetInfluences[en]=Br[en]})}return cr})),Fe.camera!==void 0&&Xe.push(this.loadCamera(Fe.camera));for(var Ke=this.loadNodeAttachments(Se),Ye=0,or=Ke;Ye<or.length;Ye++){var sr=or[Ye];Xe.push(sr)}return Promise.all(Xe).then(function(cr){var Br;if(Fe.isBone===!0?Br=new Bone:cr.length>1?Br=new Group$1:cr.length===1?Br=cr[0]:Br=new Object3D,Br!==cr[0])for(var tn=0,en=cr.length;tn<en;tn++)Br.add(cr[tn]);if(Fe.name&&(Br.name=Je),Fe.matrix!==void 0){var an=new Matrix4;an.fromArray(Fe.matrix),Br.applyMatrix4(an)}else Fe.translation!==void 0&&Br.position.fromArray(Fe.translation),Fe.rotation!==void 0&&Br.quaternion.fromArray(Fe.rotation),Fe.scale!==void 0&&Br.scale.fromArray(Fe.scale);return Br})},$e.prototype.loadScene=function(Se){var Be=this.json,De=Be.scenes[Se],Ve=new Group$1;De.name&&(Ve.name=this.createUniqueName(De.name));for(var Fe=De.nodes||[],Je=[],Xe=0,Ke=Fe.length;Xe<Ke;Xe++)Je.push(this.buildNodeHierarchy(Fe[Xe],Ve));return Promise.all(Je).then(function(){return Ve})},$e.prototype.createMaterialTexture=function(Se){var Be=this;return this.loadTexture(Se.index).then(function(De){for(var Ve=0,Fe=values(Be.extensions);Ve<Fe.length;Ve++){var Je=Fe[Ve],Xe=Je.extendTexture(De,Se,Be);Xe&&(De=Xe)}return Be.textureSet.add(De),Be.disposeSet.add(De),De})},$e.prototype.addGeometryPrimitiveAttributes=function(Se,Be){var De=this,Ve=Be.attributes,Fe=[],Je=function(cn){var hn=ATTRIBUTES[cn]||cn.toLowerCase();if(hn in Se.attributes)return"continue";Fe.push(Xe.loadAccessor(Ve[cn]).then(function(mn){mn&&Se.setAttribute(hn,mn)}))},Xe=this;for(var Ke in Ve)Je(Ke);Be.indices!==void 0&&!Se.index&&Fe.push(this.loadAccessor(Be.indices).then(function(cn){cn&&Se.setIndex(cn)}));var Ye=new Box3;if(Ve.POSITION!==void 0){var or=this.json.accessors[Ve.POSITION],sr=or.min,cr=or.max;if(sr!==void 0&&cr!==void 0){if(Ye.set(new Vector3(sr[0],sr[1],sr[2]),new Vector3(cr[0],cr[1],cr[2])),or.normalized){var Br=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[or.componentType]);Ye.min.multiplyScalar(Br),Ye.max.multiplyScalar(Br)}}else console.warn("glTF: Missing min/max properties for accessor POSITION.")}var tn=Be.targets;if(tn!==void 0){for(var en=new Vector3,an=new Vector3,rn=0,on=tn.length;rn<on;rn++){var sn=tn[rn];if(sn.POSITION!==void 0){var or=this.json.accessors[sn.POSITION],sr=or.min,cr=or.max;if(sr!==void 0&&cr!==void 0){if(an.setX(Math.max(Math.abs(sr[0]),Math.abs(cr[0]))),an.setY(Math.max(Math.abs(sr[1]),Math.abs(cr[1]))),an.setZ(Math.max(Math.abs(sr[2]),Math.abs(cr[2]))),or.normalized){var Br=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[or.componentType]);an.multiplyScalar(Br)}en.max(an)}else console.warn("glTF: Missing min/max properties for accessor POSITION.")}}Ye.expandByVector(en)}Se.boundingBox=Ye;var ln=new Sphere;return Ye.getCenter(ln.center),ln.radius=Ye.min.distanceTo(Ye.max)/2,Se.boundingSphere=ln,Promise.all(Fe).then(function(){if(Se.attributes.uv&&!Se.attributes.uv2&&De.options.copyUV2&&Se.setAttribute("uv2",Se.attributes.uv),Be.targets){for(var cn=!1,hn=!1,mn=0,An=Be.targets.length;mn<An;mn++){var xn=Be.targets[mn];if(xn.POSITION!==void 0&&(cn=!0),xn.NORMAL!==void 0&&(hn=!0),cn&&hn)break}if(!cn&&!hn)return Se;var pn=[];Se.morphTargetsRelative=!0;for(var dn=function(Sn,gn){var Cn=Be.targets[Sn];cn?pn.push(De.loadAccessor(Cn.POSITION).then(function(Mn){Mn&&(Se.morphAttributes.position[Sn]=Mn)})):Se.morphAttributes.position[Sn]=Se.attributes.position,hn?pn.push(De.loadAccessor(Cn.NORMAL).then(function(Mn){Mn&&(Se.morphAttributes.normal[Sn]=Mn)})):Se.morphAttributes.normal[Sn]=Se.attributes.normal},mn=0,An=Be.targets.length;mn<An;mn++)dn(mn,An);return Promise.all(pn).then(function(){return Se})}else return Se})},$e.prototype.buildNodeHierarchy=function(Se,Be){var De=this,Ve=this.json.nodes[Se];return this.loadNode(Se).then(function(Fe){if(Ve.skin===void 0)return Fe;var Je;return De.loadSkin(Ve.skin).then(function(Xe){Je=Xe;for(var Ke=[],Ye=0,or=Je.joints.length;Ye<or;Ye++)Ke.push(De.loadNode(Je.joints[Ye]));return Promise.all(Ke)}).then(function(Xe){return Fe.traverse(function(Ke){if(Ke instanceof SkinnedMesh){for(var Ye=[],or=[],sr=0,cr=Xe.length;sr<cr;sr++){var Br=Xe[sr];if(Br instanceof Bone){Ye.push(Br);var tn=new Matrix4;Je.inverseBindMatrices!==void 0&&tn.fromArray(Je.inverseBindMatrices.array,sr*16),or.push(tn)}else console.warn('glTF: Joint "%s" could not be found.',Je.joints[sr])}Ke.bind(new Skeleton(Ye,or),Ke.matrixWorld)}}),Fe})}).then(function(Fe){Be.add(Fe);var Je=[];if(Ve.children)for(var Xe=Ve.children,Ke=0,Ye=Xe.length;Ke<Ye;Ke++){var or=Xe[Ke];Je.push(De.buildNodeHierarchy(or,Fe))}return Promise.all(Je).then(function(){return Fe})})},$e.prototype.createUniqueName=function(Se){for(var Be=PropertyBinding.sanitizeNodeName(Se||""),De=Be,Ve=1;this.nodeNamesUsed[De];++Ve)De=Be+"_"+Ve;return this.nodeNamesUsed[De]=!0,De},$e.prototype.resolveResouce=function(Se){return pathJoin(this.options.resourcePath,appendSearch(Se,this.options.search))},$e.prototype.toGeometryTrianglesDrawMode=function(Se,Be){var De=Se.getIndex();if(De===null){var Ve=[],Fe=Se.getAttribute("position");if(Fe!==void 0){for(var Je=0;Je<Fe.count;Je++)Ve.push(Je);Se.setIndex(Ve),De=Se.getIndex()}}if(De===null)return console.error("glTF: Undefined position attribute. Processing not possible."),Se;var Xe=De.count-2,Ke=[];if(Be===TriangleFanDrawMode)for(var Je=1;Je<=Xe;Je++)Ke.push(De.getX(0)),Ke.push(De.getX(Je)),Ke.push(De.getX(Je+1));else for(var Je=0;Je<Xe;Je++)Je%2===0?(Ke.push(De.getX(Je)),Ke.push(De.getX(Je+1)),Ke.push(De.getX(Je+2))):(Ke.push(De.getX(Je+2)),Ke.push(De.getX(Je+1)),Ke.push(De.getX(Je)));Ke.length/3!==Xe&&console.error("glTF: Unable to generate correct amount of triangles.");var Ye=Se.clone();return Ye.setIndex(Ke),this.disposeSet.add(Ye),Ye},$e}();function getNormalizedComponentScale($e){switch($e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("glTF: Unsupported normalized accessor component type.")}}var BaseExtension=function(){function $e(){}return $e.prototype.markDefs=function(Se){},$e.prototype.prepare=function(Se){},$e.prototype.emitResult=function(Se,Be){},$e.prototype.createPrimitiveKey=function(Se,Be){},$e.prototype.extendTexture=function(Se,Be,De){return null},$e.prototype.loadBuffer=function(Se,Be){return null},$e.prototype.loadBufferView=function(Se,Be){return null},$e.prototype.loadImage=function(Se,Be){return null},$e.prototype.loadTexture=function(Se,Be){return null},$e.prototype.loadGeometry=function(Se,Be){return null},$e.prototype.loadMaterial=function(Se,Be){return null},$e.prototype.extendMaterial=function(Se,Be,De){return Promise.resolve()},$e.prototype.loadMesh=function(Se,Be){return null},$e.prototype.loadNodeAttachments=function(Se,Be){return null},$e.prototype.loadCamera=function(Se,Be){return null},$e.prototype.loadAnimation=function(Se,Be){return null},$e}(),KHR_binary_glTF=function($e){__extends(Se,$e);function Se(){var Be=$e.call(this)||this;return Be.header={magic:"",version:0,length:0},Be.content="",Be.body=null,Be}return Se.getMagic=function(Be){return decodeText(new Uint8Array(Be.slice(0,4)))},Se.prototype.loadGlbBinary=function(Be){var De=new DataView(Be,0,Se.HEADER_LENGTH);if(this.header={magic:Se.getMagic(Be),version:De.getUint32(4,!0),length:De.getUint32(8,!0)},this.header.magic!==Se.HEADER_MAGIC)throw new Error("glTF:KHR_binary_glTF: Unsupported.");if(this.header.version<2)throw new Error("glTF:KHR_binary_glTF: Legacy binary file detected.");for(var Ve=new DataView(Be,Se.HEADER_LENGTH),Fe=0,Je=null,Xe=null;Fe<Ve.byteLength;){var Ke=Ve.getUint32(Fe,!0);if(Fe+=4,Ke!==0){var Ye=Ve.getUint32(Fe,!0);if(Fe+=4,Ye===Se.CHUNK_TYPES.JSON){var or=new Uint8Array(Be,Se.HEADER_LENGTH+Fe,Ke);Je=decodeText(or)}else if(Ye===Se.CHUNK_TYPES.BIN){var sr=Se.HEADER_LENGTH+Fe;Xe=Be.slice(sr,sr+Ke)}Fe+=Ke}}if(Je===null)throw new Error("glTF:KHR_binary_glTF: JSON content not found.");this.content=Je,this.body=Xe},Se.prototype.loadBuffer=function(Be,De){var Ve=De.json.buffers[Be];return Ve.uri===void 0&&Be===0&&this.body?Promise.resolve(this.body):null},Se.prototype.clear=function(){this.body=null,this.content=""},Se.HEADER_MAGIC="glTF",Se.HEADER_LENGTH=12,Se.CHUNK_TYPES={JSON:1313821514,BIN:5130562},Se}(BaseExtension),defaultDecoderPath="https://vr-public.realsee-cdn.cn/release/static/image/release/five/resource/draco/1.5.6/",defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},Draco=function(){function $e(){this.decoderPath=defaultDecoderPath,this.decoderConfig={},this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL=""}return $e.prototype.setDecoderPath=function(Se){this.decoderPath=Se},$e.prototype.setDecoderConfig=function(Se){return this.decoderConfig=Se,this},$e.prototype.setWorkerLimit=function(Se){return this.workerLimit=Se,this},$e.prototype.decodeDracoFile=function(Se,Be,De,Ve){var Fe={attributeIDs:De||defaultAttributeIDs,attributeTypes:Ve||defaultAttributeTypes,useUniqueIDs:!!De};this.decodeGeometry(Se,Fe).then(Be)},$e.prototype.decodeGeometry=function(Se,Be){var De=this;Be===void 0&&(Be={attributeIDs:defaultAttributeIDs,attributeTypes:defaultAttributeTypes,useUniqueIDs:!1});for(var Ve in Be.attributeTypes){var Fe=Be.attributeTypes[Ve];Fe.BYTES_PER_ELEMENT!==void 0&&(Be.attributeTypes[Ve]=Fe.name)}var Je,Xe=this.workerNextTaskID++,Ke=Se.byteLength,Ye=this._getWorker(Xe,Ke).then(function(or){return Je=or,new Promise(function(sr,cr){Je._callbacks[Xe]={resolve:sr,reject:cr},Je.postMessage({type:"decode",id:Xe,taskConfig:Be,buffer:Se},[Se])})}).then(function(or){return De._createGeometry(or.geometry)});return Ye.catch(function(){return!0}).then(function(){Je&&Xe&&De._releaseTask(Je,Xe)}),Ye},$e.prototype._createGeometry=function(Se){var Be=new BufferGeometry;Se.index&&Be.setIndex(new BufferAttribute(Se.index.array,1));for(var De=0;De<Se.attributes.length;De++){var Ve=Se.attributes[De],Fe=Ve.name,Je=Ve.array,Xe=Ve.itemSize,Ke=!(Je instanceof Float32Array||Je instanceof Float64Array);Be.setAttribute(Fe,new BufferAttribute(Je,Xe,Ke))}return Be},$e.prototype._initDecoder=function(){var Se=this;if(this.decoderPending)return this.decoderPending;var Be=typeof WebAssembly!="object"||this.decoderConfig.type==="js";if(Be){var De=ajax(this.decoderPath+"draco_decoder.js",{responseType:"text"}).then(function(Fe){return Fe.body});this.decoderPending=De.then(function(Fe){var Je=["/* draco decoder */",Fe,"","/* worker */",DRACOWorker].join(`
`);Se.workerSourceURL=URL.createObjectURL(new Blob([Je]))})}else{var De=ajax(this.decoderPath+"draco_wasm_wrapper.js",{responseType:"text"}).then(function(Je){return Je.body}),Ve=ajax(this.decoderPath+"draco_decoder.wasm",{responseType:"arraybuffer"}).then(function(Je){return Je.body});this.decoderPending=Promise.all([De,Ve]).then(function(Je){var Xe=Je[0],Ke=Je[1];Se.decoderConfig.wasmBinary=Ke;var Ye=["/* draco decoder */",Xe,"","/* worker */",DRACOWorker].join(`
`);Se.workerSourceURL=URL.createObjectURL(new Blob([Ye]))})}return this.decoderPending},$e.prototype._getWorker=function(Se,Be){var De=this;return this._initDecoder().then(function(){if(De.workerPool.length<De.workerLimit){var Ve=new Worker(De.workerSourceURL);Ve._callbacks={},Ve._taskCosts={},Ve._taskLoad=0,Ve.postMessage({type:"init",decoderConfig:De.decoderConfig}),Ve.onmessage=function(Je){var Xe=Je.data;switch(Xe.type){case"decode":Ve._callbacks[Xe.id].resolve(Xe);break;case"error":Ve._callbacks[Xe.id].reject(Xe);break;default:console.error('DRACO: Unexpected message, "'+Xe.type+'"')}},De.workerPool.push(Ve)}else De.workerPool.sort(function(Je,Xe){return Je._taskLoad>Xe._taskLoad?-1:1});var Fe=De.workerPool[De.workerPool.length-1];return Fe._taskCosts[Se]=Be,Fe._taskLoad+=Be,Fe})},$e.prototype._releaseTask=function(Se,Be){Se._taskLoad-=Se._taskCosts[Be],delete Se._callbacks[Be],delete Se._taskCosts[Be]},$e.prototype.dispose=function(){for(var Se=0;Se<this.workerPool.length;++Se)this.workerPool[Se].terminate();return this.workerPool.length=0,this},$e}(),draco=new Draco,DRACOWorker=`
  let decoderConfig;
  let decoderPending;

  onmessage = function ( e ) {

    const message = e.data;

    switch ( message.type ) {

      case 'init':
        decoderConfig = message.decoderConfig;
        decoderPending = new Promise( function ( resolve/*, reject*/ ) {

          decoderConfig.onModuleLoaded = function ( draco ) {

            // Module is Promise-like. Wrap before resolving to avoid loop.
            resolve( { draco: draco } );

          };

          DracoDecoderModule( decoderConfig ); // eslint-disable-line no-undef

        } );
        break;

      case 'decode':
        const buffer = message.buffer;
        const taskConfig = message.taskConfig;
        decoderPending.then( ( module ) => {

          const draco = module.draco;
          const decoder = new draco.Decoder();
          const decoderBuffer = new draco.DecoderBuffer();
          decoderBuffer.Init( new Int8Array( buffer ), buffer.byteLength );

          try {

            const geometry = decodeGeometry( draco, decoder, decoderBuffer, taskConfig );

            const buffers = geometry.attributes.map( ( attr ) => attr.array.buffer );

            if ( geometry.index ) buffers.push( geometry.index.array.buffer );

            self.postMessage( { type: 'decode', id: message.id, geometry }, buffers );

          } catch ( error ) {

            console.error( error );

            self.postMessage( { type: 'error', id: message.id, error: error.message } );

          } finally {

            draco.destroy( decoderBuffer );
            draco.destroy( decoder );

          }

        } );
        break;

    }

  };

  function decodeGeometry( draco, decoder, decoderBuffer, taskConfig ) {

    const attributeIDs = taskConfig.attributeIDs;
    const attributeTypes = taskConfig.attributeTypes;

    let dracoGeometry;
    let decodingStatus;

    const geometryType = decoder.GetEncodedGeometryType( decoderBuffer );

    if ( geometryType === draco.TRIANGULAR_MESH ) {

      dracoGeometry = new draco.Mesh();
      decodingStatus = decoder.DecodeBufferToMesh( decoderBuffer, dracoGeometry );

    } else if ( geometryType === draco.POINT_CLOUD ) {

      dracoGeometry = new draco.PointCloud();
      decodingStatus = decoder.DecodeBufferToPointCloud( decoderBuffer, dracoGeometry );

    } else {

      throw new Error( 'THREE.DRACOLoader: Unexpected geometry type.' );

    }

    if ( ! decodingStatus.ok() || dracoGeometry.ptr === 0 ) {

      throw new Error( 'THREE.DRACOLoader: Decoding failed: ' + decodingStatus.error_msg() );

    }

    const geometry = { index: null, attributes: [] };

    // Gather all vertex attributes.
    for ( const attributeName in attributeIDs ) {

      const attributeType = self[ attributeTypes[ attributeName ] ];

      let attribute;
      let attributeID;

      // A Draco file may be created with default vertex attributes, whose attribute IDs
      // are mapped 1:1 from their semantic name (POSITION, NORMAL, ...). Alternatively,
      // a Draco file may contain a custom set of attributes, identified by known unique
      // IDs. glTF files always do the latter, and .drc files typically do the former.
      if ( taskConfig.useUniqueIDs ) {

        attributeID = attributeIDs[ attributeName ];
        attribute = decoder.GetAttributeByUniqueId( dracoGeometry, attributeID );

      } else {

        attributeID = decoder.GetAttributeId( dracoGeometry, draco[ attributeIDs[ attributeName ] ] );

        if ( attributeID === - 1 ) continue;

        attribute = decoder.GetAttribute( dracoGeometry, attributeID );

      }

      geometry.attributes.push( decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) );

    }

    // Add index.
    if ( geometryType === draco.TRIANGULAR_MESH ) {

      geometry.index = decodeIndex( draco, decoder, dracoGeometry );

    }

    draco.destroy( dracoGeometry );

    return geometry;

  }

  function decodeIndex( draco, decoder, dracoGeometry ) {

    const numFaces = dracoGeometry.num_faces();
    const numIndices = numFaces * 3;
    const byteLength = numIndices * 4;

    const ptr = draco._malloc( byteLength );
    decoder.GetTrianglesUInt32Array( dracoGeometry, byteLength, ptr );
    const index = new Uint32Array( draco.HEAPF32.buffer, ptr, numIndices ).slice();
    draco._free( ptr );

    return { array: index, itemSize: 1 };

  }

  function decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) {

    const numComponents = attribute.num_components();
    const numPoints = dracoGeometry.num_points();
    const numValues = numPoints * numComponents;
    const byteLength = numValues * attributeType.BYTES_PER_ELEMENT;
    const dataType = getDracoDataType( draco, attributeType );

    const ptr = draco._malloc( byteLength );
    decoder.GetAttributeDataArrayForAllPoints( dracoGeometry, attribute, dataType, byteLength, ptr );
    const array = new attributeType( draco.HEAPF32.buffer, ptr, numValues ).slice();
    draco._free( ptr );

    return {
      name: attributeName,
      array: array,
      itemSize: numComponents
    };

  }

  function getDracoDataType( draco, attributeType ) {

    switch ( attributeType ) {

      case Float32Array: return draco.DT_FLOAT32;
      case Int8Array: return draco.DT_INT8;
      case Int16Array: return draco.DT_INT16;
      case Int32Array: return draco.DT_INT32;
      case Uint8Array: return draco.DT_UINT8;
      case Uint16Array: return draco.DT_UINT16;
      case Uint32Array: return draco.DT_UINT32;

    }

  }
`,EXTENSION_NAME$6="KHR_draco_mesh_compression",KHR_draco_mesh_compression=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.loadGeometry=function(Be,De){return Be.extensions&&Be.extensions[EXTENSION_NAME$6]?this.decodePrimitive(Be,De).then(function(Ve){return De.addGeometryPrimitiveAttributes(Ve,Be)}):null},Se.prototype.decodePrimitive=function(Be,De){var Ve=De.json,Fe=Be.extensions[EXTENSION_NAME$6].bufferView,Je=Be.extensions[EXTENSION_NAME$6].attributes,Xe={},Ke={},Ye={};for(var or in Je){var sr=ATTRIBUTES[or]||or.toLowerCase();Xe[sr]=Je[or]}for(var or in Be.attributes){var sr=ATTRIBUTES[or]||or.toLowerCase();if(Je[or]!==void 0){var cr=Ve.accessors[Be.attributes[or]],Br=WEBGL_COMPONENT_TYPES[cr.componentType];Ye[sr]=Br,Ke[sr]=cr.normalized===!0}}return De.loadBufferView(Fe).then(function(tn){return new Promise(function(en){draco.decodeDracoFile(tn,function(an){for(var rn in an.attributes){var on=an.attributes[rn],sn=Ke[rn];sn!==void 0&&(on.normalized=sn)}en(an)},Xe,Ye)})})},Se}(BaseExtension),defaultTranscoderPath="https://vr-public.realsee-cdn.cn/release/static/image/release/five/resource/basis/1.16/",KTX2TransferSRGB=2,KTX2_ALPHA_PREMULTIPLIED=1,WorkerPool=function(){function $e(Se){this.pool=Se,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0,this.workerCreator=null}return $e.prototype._initWorker=function(Se){if(this.workerCreator&&!this.workers[Se]){var Be=this.workerCreator();Be.addEventListener("message",this._onMessage.bind(this,Se)),this.workers[Se]=Be}},$e.prototype._getIdleWorker=function(){for(var Se=0;Se<this.pool;Se++)if(!(this.workerStatus&1<<Se))return Se;return-1},$e.prototype._onMessage=function(Se,Be){var De=this.workersResolve[Se];if(De&&De(Be),this.queue.length){var Ve=this.queue.shift(),Fe=Ve.resolve,Je=Ve.msg,Xe=Ve.transfer;this.workersResolve[Se]=Fe,this.workers[Se].postMessage(Je,Xe)}else this.workerStatus^=1<<Se},$e.prototype.setWorkerCreator=function(Se){this.workerCreator=Se},$e.prototype.setWorkerLimit=function(Se){this.pool=Se},$e.prototype.postMessage=function(Se,Be){var De=this;return new Promise(function(Ve){var Fe=De._getIdleWorker();Fe!==-1?(De._initWorker(Fe),De.workerStatus|=1<<Fe,De.workersResolve[Fe]=Ve,De.workers[Fe].postMessage(Se,Be)):De.queue.push({resolve:Ve,msg:Se,transfer:Be})})},$e.prototype.dispose=function(){this.workers.forEach(function(Se){return Se.terminate()}),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0},$e}(),KTX2=function(){function $e(){this.transcoderPath=defaultTranscoderPath,this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new WorkerPool(4),this.workerSourceURL="",this.workerConfig=null}return $e.prototype.setTranscoderPath=function(Se){this.transcoderPath=Se},$e.prototype.detectSupport=function(Se){if(!this.workerConfig){var Be=console.warn;console.warn=function(){},this.workerConfig={astcSupported:!!Se.extensions.get("WEBGL_compressed_texture_astc"),etc1Supported:!!Se.extensions.get("WEBGL_compressed_texture_etc1"),etc2Supported:!!Se.extensions.get("WEBGL_compressed_texture_etc"),dxtSupported:!!Se.extensions.get("WEBGL_compressed_texture_s3tc"),bptcSupported:!!Se.extensions.get("EXT_texture_compression_bptc"),pvrtcSupported:!!Se.extensions.get("WEBGL_compressed_texture_pvrtc")||!!Se.extensions.get("WEBKIT_WEBGL_compressed_texture_pvrtc")},console.warn=Be}return this},$e.prototype.init=function(){var Se=this;if(!this.transcoderPending){var Be=ajax(this.transcoderPath+"basis_transcoder.js",{responseType:"text"}).then(function(Ve){return Ve.body}),De=ajax(this.transcoderPath+"basis_transcoder.wasm",{responseType:"arraybuffer"}).then(function(Ve){return Ve.body});this.transcoderPending=Promise.all([Be,De]).then(function(Ve){var Fe=Ve[0],Je=Ve[1],Xe=["/* constants */","let _EngineFormat = "+JSON.stringify(EngineFormat),"let _TranscoderFormat = "+JSON.stringify(TranscoderFormat),"let _BasisFormat = "+JSON.stringify(BasisFormat),"/* basis_transcoder.js */",Fe,"/* worker */",BasisWorker].join(`
`);Se.workerSourceURL=URL.createObjectURL(new Blob([Xe])),Se.transcoderBinary=Je,Se.workerPool.setWorkerCreator(function(){var Ke=new Worker(Se.workerSourceURL),Ye=Se.transcoderBinary.slice(0);return Ke.postMessage({type:"init",config:Se.workerConfig,transcoderBinary:Ye},[Ye]),Ke})})}return this.transcoderPending},$e.prototype.parse=function(Se){return this._createTexture([Se])},$e.prototype._createTextureFrom=function(Se){var Be=Se.mipmaps,De=Se.width,Ve=Se.height,Fe=Se.format,Je=Se.type,Xe=Se.error,Ke=Se.dfdTransferFn,Ye=Se.dfdFlags;if(Je==="error")return Promise.reject(Xe);var or=new CompressedTexture(Be,De,Ve,Fe,UnsignedByteType);return or.minFilter=Be.length===1?LinearFilter:LinearMipmapLinearFilter,or.magFilter=LinearFilter,or.generateMipmaps=!1,or.needsUpdate=!0,or.encoding=Ke===KTX2TransferSRGB?sRGBEncoding:LinearEncoding,or.premultiplyAlpha=!!(Ye&KTX2_ALPHA_PREMULTIPLIED),Promise.resolve(or)},$e.prototype._createTexture=function(Se){var Be=this,De=this.init().then(function(){return Be.workerPool.postMessage({type:"transcode",buffers:Se},Se)}).then(function(Ve){return Be._createTextureFrom(Ve.data)});return De},$e.prototype.dispose=function(){return URL.revokeObjectURL(this.workerSourceURL),this.workerPool.dispose(),this},$e}(),ktx2=new KTX2,BasisFormat={ETC1S:0,UASTC_4x4:1},TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},EngineFormat={RGBAFormat,RGBA_ASTC_4x4_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format},BasisWorker=`

  let config;
  let transcoderPending;
  let BasisModule;

  const EngineFormat = _EngineFormat; // eslint-disable-line no-undef
  const TranscoderFormat = _TranscoderFormat; // eslint-disable-line no-undef
  const BasisFormat = _BasisFormat; // eslint-disable-line no-undef

  self.addEventListener( 'message', function ( e ) {

    const message = e.data;

    switch ( message.type ) {

      case 'init':
        config = message.config;
        init( message.transcoderBinary );
        break;

      case 'transcode':
        transcoderPending.then( () => {

          try {

            const { width, height, hasAlpha, mipmaps, format, dfdTransferFn, dfdFlags } = transcode( message.buffers[ 0 ] );

            const buffers = [];

            for ( let i = 0; i < mipmaps.length; ++ i ) {

              buffers.push( mipmaps[ i ].data.buffer );

            }

            self.postMessage( { type: 'transcode', id: message.id, width, height, hasAlpha, mipmaps, format, dfdTransferFn, dfdFlags }, buffers );

          } catch ( error ) {

            console.error( error );

            self.postMessage( { type: 'error', id: message.id, error: error.message } );

          }

        } );
        break;

    }

  } );

  function init( wasmBinary ) {

    transcoderPending = new Promise( ( resolve ) => {

      BasisModule = { wasmBinary, onRuntimeInitialized: resolve };
      BASIS( BasisModule ); // eslint-disable-line no-undef

    } ).then( () => {

      BasisModule.initializeBasis();

      if ( BasisModule.KTX2File === undefined ) {

        console.warn( 'THREE.KTX2Loader: Please update Basis Universal transcoder.' );

      }

    } );

  }

  function transcode( buffer ) {

    const ktx2File = new BasisModule.KTX2File( new Uint8Array( buffer ) );

    function cleanup() {

      ktx2File.close();
      ktx2File.delete();

    }

    if ( ! ktx2File.isValid() ) {

      cleanup();
      throw new Error( 'THREE.KTX2Loader:	Invalid or unsupported .ktx2 file' );

    }

    const basisFormat = ktx2File.isUASTC() ? BasisFormat.UASTC_4x4 : BasisFormat.ETC1S;
    const width = ktx2File.getWidth();
    const height = ktx2File.getHeight();
    const levels = ktx2File.getLevels();
    const hasAlpha = ktx2File.getHasAlpha();
    const dfdTransferFn = ktx2File.getDFDTransferFunc();
    const dfdFlags = ktx2File.getDFDFlags();

    const { transcoderFormat, engineFormat } = getTranscoderFormat( basisFormat, width, height, hasAlpha );

    if ( ! width || ! height || ! levels ) {

      cleanup();
      throw new Error( 'THREE.KTX2Loader:	Invalid texture' );

    }

    if ( ! ktx2File.startTranscoding() ) {

      cleanup();
      throw new Error( 'THREE.KTX2Loader: .startTranscoding failed' );

    }

    const mipmaps = [];

    for ( let mip = 0; mip < levels; mip ++ ) {

      const levelInfo = ktx2File.getImageLevelInfo( mip, 0, 0 );
      const mipWidth = levelInfo.origWidth;
      const mipHeight = levelInfo.origHeight;
      const dst = new Uint8Array( ktx2File.getImageTranscodedSizeInBytes( mip, 0, 0, transcoderFormat ) );

      const status = ktx2File.transcodeImage(
        dst,
        mip,
        0,
        0,
        transcoderFormat,
        0,
        - 1,
        - 1,
      );

      if ( ! status ) {

        cleanup();
        throw new Error( 'THREE.KTX2Loader: .transcodeImage failed.' );

      }

      mipmaps.push( { data: dst, width: mipWidth, height: mipHeight } );

    }

    cleanup();

    return { width, height, hasAlpha, mipmaps, format: engineFormat, dfdTransferFn, dfdFlags };

  }

  //

  // Optimal choice of a transcoder target format depends on the Basis format (ETC1S or UASTC),
  // device capabilities, and texture dimensions. The list below ranks the formats separately
  // for ETC1S and UASTC.
  //
  // In some cases, transcoding UASTC to RGBA32 might be preferred for higher quality (at
  // significant memory cost) compared to ETC1/2, BC1/3, and PVRTC. The transcoder currently
  // chooses RGBA32 only as a last resort and does not expose that option to the caller.
  const FORMAT_OPTIONS = [
    {
      if: 'astcSupported',
      basisFormat: [ BasisFormat.UASTC_4x4 ],
      transcoderFormat: [ TranscoderFormat.ASTC_4x4, TranscoderFormat.ASTC_4x4 ],
      engineFormat: [ EngineFormat.RGBA_ASTC_4x4_Format, EngineFormat.RGBA_ASTC_4x4_Format ],
      priorityETC1S: Infinity,
      priorityUASTC: 1,
      needsPowerOfTwo: false,
    },
    {
      if: 'bptcSupported',
      basisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC_4x4 ],
      transcoderFormat: [ TranscoderFormat.BC7_M5, TranscoderFormat.BC7_M5 ],
      engineFormat: [ EngineFormat.RGBA_BPTC_Format, EngineFormat.RGBA_BPTC_Format ],
      priorityETC1S: 3,
      priorityUASTC: 2,
      needsPowerOfTwo: false,
    },
    {
      if: 'dxtSupported',
      basisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC_4x4 ],
      transcoderFormat: [ TranscoderFormat.BC1, TranscoderFormat.BC3 ],
      engineFormat: [ EngineFormat.RGB_S3TC_DXT1_Format, EngineFormat.RGBA_S3TC_DXT5_Format ],
      priorityETC1S: 4,
      priorityUASTC: 5,
      needsPowerOfTwo: false,
    },
    {
      if: 'etc2Supported',
      basisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC_4x4 ],
      transcoderFormat: [ TranscoderFormat.ETC1, TranscoderFormat.ETC2 ],
      engineFormat: [ EngineFormat.RGB_ETC2_Format, EngineFormat.RGBA_ETC2_EAC_Format ],
      priorityETC1S: 1,
      priorityUASTC: 3,
      needsPowerOfTwo: false,
    },
    {
      if: 'etc1Supported',
      basisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC_4x4 ],
      transcoderFormat: [ TranscoderFormat.ETC1, TranscoderFormat.ETC1 ],
      engineFormat: [ EngineFormat.RGB_ETC1_Format, EngineFormat.RGB_ETC1_Format ],
      priorityETC1S: 2,
      priorityUASTC: 4,
      needsPowerOfTwo: false,
    },
    {
      if: 'pvrtcSupported',
      basisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC_4x4 ],
      transcoderFormat: [ TranscoderFormat.PVRTC1_4_RGB, TranscoderFormat.PVRTC1_4_RGBA ],
      engineFormat: [ EngineFormat.RGB_PVRTC_4BPPV1_Format, EngineFormat.RGBA_PVRTC_4BPPV1_Format ],
      priorityETC1S: 5,
      priorityUASTC: 6,
      needsPowerOfTwo: true,
    },
  ];

  const ETC1S_OPTIONS = FORMAT_OPTIONS.sort( function ( a, b ) {

    return a.priorityETC1S - b.priorityETC1S;

  } );
  const UASTC_OPTIONS = FORMAT_OPTIONS.sort( function ( a, b ) {

    return a.priorityUASTC - b.priorityUASTC;

  } );

  function getTranscoderFormat( basisFormat, width, height, hasAlpha ) {

    let transcoderFormat;
    let engineFormat;

    const options = basisFormat === BasisFormat.ETC1S ? ETC1S_OPTIONS : UASTC_OPTIONS;

    for ( let i = 0; i < options.length; i ++ ) {

      const opt = options[ i ];

      if ( ! config[ opt.if ] ) continue;
      if ( ! opt.basisFormat.includes( basisFormat ) ) continue;
      if ( opt.needsPowerOfTwo && ! ( isPowerOfTwo( width ) && isPowerOfTwo( height ) ) ) continue;

      transcoderFormat = opt.transcoderFormat[ hasAlpha ? 1 : 0 ];
      engineFormat = opt.engineFormat[ hasAlpha ? 1 : 0 ];

      return { transcoderFormat, engineFormat };

    }

    console.warn( 'KTX2: No suitable compressed texture format found. Decoding to RGBA32.' );

    transcoderFormat = TranscoderFormat.RGBA32;
    engineFormat = EngineFormat.RGBAFormat;

    return { transcoderFormat, engineFormat };

  }

  function isPowerOfTwo( value ) {

    if ( value <= 2 ) return true;

    return ( value & ( value - 1 ) ) === 0 && value !== 0;

  }
`,EXTENSION_NAME$5="KHR_texture_basisu",KHR_texture_basisu=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.loadTexture=function(Be,De){var Ve=De.json.textures[Be];if(!Ve.extensions||!Ve.extensions[EXTENSION_NAME$5])return null;var Fe=Ve.extensions[EXTENSION_NAME$5],Je=De.json.images[Fe.source],Xe=null;if(Je.bufferView!==void 0)Xe=De.loadBufferView(Je.bufferView).then(function(or){return ktx2.parse(or)});else if(Je.uri)Xe=De.options.fetcher.ajax(De.resolveResouce(Je.uri),{responseType:"arraybuffer"}).then(function(or){return ktx2.parse(or.body)});else throw new Error("glTF: Invalid image defs.");var Ke=De.json.samplers||{},Ye=Ke[Ve.sampler]||{};return Xe=Xe.then(function(or){return or.magFilter=LinearFilter,or.minFilter=LinearFilter,or.wrapS=WEBGL_WRAPPINGS[Ye.wrapS]||RepeatWrapping,or.wrapT=WEBGL_WRAPPINGS[Ye.wrapT]||RepeatWrapping,or}),Xe},Se}(BaseExtension),EXTENSION_NAME$4="KHR_texture_transform",KHR_texture_transform=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.extendTexture=function(Be,De,Ve){var Fe=De.extensions!==void 0?De.extensions[EXTENSION_NAME$4]:void 0;return Fe?(Fe.texCoord!==void 0&&console.warn('glTF: Custom UV sets in "'+EXTENSION_NAME$4+'" extension not yet supported.'),Fe.offset===void 0&&Fe.rotation===void 0&&Fe.scale===void 0||(Be=Be.clone(),Be.needsUpdate=!0,Fe.offset!==void 0&&Be.offset.fromArray(Fe.offset),Fe.rotation!==void 0&&(Be.rotation=Fe.rotation),Fe.scale!==void 0&&Be.repeat.fromArray(Fe.scale)),Be):null},Se}(BaseExtension),KHR_mesh_quantization=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se}(BaseExtension),KHR_materials_unlit=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se}(BaseExtension),meshoptDecoder=function(){var $e="b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q;iekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:78Yqdbk:qzezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9UhlaicefhodnadTmbalc;WFbGglcjdalcjd6EhDcbhqinaqae9pmeaDaeaq9RaqaDfae6Egkcsfglcl4cifcd4hxdndndndnalc9WGgmTmbcbhPcehsawcjdfhzaohHinaraH9Rax6midnaraHaxfgo9RcK6mbczhlinalgic9Wfglawcj;cbffhOdndndndndnaHalco4fRbbalci4coG4ciGPlbedibkaO9cb83ibaOcwf9cb83ibxikaOaoRblaoRbbgAco4glalciSgCE86bbawcj;cbfaifglcGfaoclfaCfgORbbaAcl4ciGgCaCciSgCE86bbalcVfaOaCfgORbbaAcd4ciGgCaCciSgCE86bbalc7faOaCfgORbbaAciGgAaAciSgAE86bbalctfaOaAfgARbbaoRbegOco4gCaCciSgCE86bbalc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc93faAaCfgARbbaOciGgOaOciSgOE86bbalc94faAaOfgARbbaoRbdgOco4gCaCciSgCE86bbalc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc97faAaCfgARbbaOciGgOaOciSgOE86bbalc98faAaOfgORbbaoRbigoco4gAaAciSgAE86bbalc99faOaAfgORbbaocl4ciGgAaAciSgAE86bbalc9:faOaAfgORbbaocd4ciGgAaAciSgAE86bbalcufaOaAfglRbbaociGgoaociSgoE86bbalaofhoxdkaOaoRbwaoRbbgAcl4glalcsSgCE86bbawcj;cbfaifglcGfaocwfaCfgORbbaAcsGgAaAcsSgAE86bbalcVfaOaAfgORbbaoRbegAcl4gCaCcsSgCE86bbalc7faOaCfgORbbaAcsGgAaAcsSgAE86bbalctfaOaAfgORbbaoRbdgAcl4gCaCcsSgCE86bbalc91faOaCfgORbbaAcsGgAaAcsSgAE86bbalc4faOaAfgORbbaoRbigAcl4gCaCcsSgCE86bbalc93faOaCfgORbbaAcsGgAaAcsSgAE86bbalc94faOaAfgORbbaoRblgAcl4gCaCcsSgCE86bbalc95faOaCfgORbbaAcsGgAaAcsSgAE86bbalc96faOaAfgORbbaoRbvgAcl4gCaCcsSgCE86bbalc97faOaCfgORbbaAcsGgAaAcsSgAE86bbalc98faOaAfgORbbaoRbogAcl4gCaCcsSgCE86bbalc99faOaCfgORbbaAcsGgAaAcsSgAE86bbalc9:faOaAfgORbbaoRbrgocl4gAaAcsSgAE86bbalcufaOaAfglRbbaocsGgoaocsSgoE86bbalaofhoxekaOao8Pbb83bbaOcwfaocwf8Pbb83bbaoczfhokdnaiam9pmbaiczfhlarao9RcL0mekkaiam6miaoTmidnakTmbawaPfRbbhOawcj;cbfhlazhiakhHinaialRbbgAce4cbaAceG9R7aOfgO86bbaiadfhialcefhlaHcufgHmbkkazcefhzaPcefgPad6hsaohHaPad9hmexvkkcbhoasceGmdxikaoaxad2fhPdnakTmbcbhmcehsawcjdfhCinarao9Rax6miaoTmdaoaxfhoawamfRbbhOawcj;cbfhlaChiakhHinaialRbbgAce4cbaAceG9R7aOfgO86bbaiadfhialcefhlaHcufgHmbkaCcefhCamcefgmad6hsamad9hmbkaPhoxikcbhlcehsinarao9Rax6mdaoTmeaoaxfhoalcefglad6hsadal9hmbkaPhoxdkcbhoasceGTmekc9:hoxikabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqaombkc9:hoxekcbc99arao9Radcaadca0ESEhokavcj;ebf8Kjjjjbaok;xzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhrcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgDc;Ve0mbavc;abfalaDcu7gPcl4fcsGcitfgsydlhzasydbhHdnaDcsGgDak9pmbavaiaPfcsGcdtfydbaxaDEhsaDThDdndnadcd9hmbabarcetfgPaH87ebaPcdfaz87ebaPclfas87ebxekabarcdtfgPaHBdbaPclfazBdbaPcwfasBdbkaxaDfhxavc;abfalcitfgPasBdbaPazBdlavaicdtfasBdbavc;abfalcefcsGglcitfgPaHBdbaPasBdlaiaDfhialcefhlxdkdndnaDcsSmbamaDfaDc987fcefhmxekaocefhDao8SbbgscFeGhPdndnascu9mmbaDhoxekaocvfhoaPcFbGhPcrhsdninaD8SbbgOcFbGastaPVhPaOcu9kmeaDcefhDascrfgsc8J9hmbxdkkaDcefhokaPce4cbaPceG9R7amfhmkdndnadcd9hmbabarcetfgDaH87ebaDcdfaz87ebaDclfam87ebxekabarcdtfgDaHBdbaDclfazBdbaDcwfamBdbkavc;abfalcitfgDamBdbaDazBdlavaicdtfamBdbavc;abfalcefcsGglcitfgDaHBdbaDamBdlaicefhialcefhlxekdnaDcpe0mbaxcefgOavaiaqaDcsGfRbbgscl49RcsGcdtfydbascz6gPEhDavaias9RcsGcdtfydbaOaPfgzascsGgOEhsaOThOdndnadcd9hmbabarcetfgHax87ebaHcdfaD87ebaHclfas87ebxekabarcdtfgHaxBdbaHclfaDBdbaHcwfasBdbkavaicdtfaxBdbavc;abfalcitfgHaDBdbaHaxBdlavaicefgicsGcdtfaDBdbavc;abfalcefcsGcitfgHasBdbaHaDBdlavaiaPfcsGgicdtfasBdbavc;abfalcdfcsGglcitfgDaxBdbaDasBdlalcefhlaiaOfhiazaOfhxxekaxcbaoRbbgHEgAaDc;:eSgDfhzaHcsGhCaHcl4hXdndnaHcs0mbazcefhOxekazhOavaiaX9RcsGcdtfydbhzkdndnaCmbaOcefhxxekaOhxavaiaH9RcsGcdtfydbhOkdndnaDTmbaocefhDxekaocdfhDao8SbegPcFeGhsdnaPcu9kmbaocofhAascFbGhscrhodninaD8SbbgPcFbGaotasVhsaPcu9kmeaDcefhDaocrfgoc8J9hmbkaAhDxekaDcefhDkasce4cbasceG9R7amfgmhAkdndnaXcsSmbaDhsxekaDcefhsaD8SbbgocFeGhPdnaocu9kmbaDcvfhzaPcFbGhPcrhodninas8SbbgDcFbGaotaPVhPaDcu9kmeascefhsaocrfgoc8J9hmbkazhsxekascefhskaPce4cbaPceG9R7amfgmhzkdndnaCcsSmbashoxekascefhoas8SbbgDcFeGhPdnaDcu9kmbascvfhOaPcFbGhPcrhDdninao8SbbgscFbGaDtaPVhPascu9kmeaocefhoaDcrfgDc8J9hmbkaOhoxekaocefhokaPce4cbaPceG9R7amfgmhOkdndnadcd9hmbabarcetfgDaA87ebaDcdfaz87ebaDclfaO87ebxekabarcdtfgDaABdbaDclfazBdbaDcwfaOBdbkavc;abfalcitfgDazBdbaDaABdlavaicdtfaABdbavc;abfalcefcsGcitfgDaOBdbaDazBdlavaicefgicsGcdtfazBdbavc;abfalcdfcsGcitfgDaABdbaDaOBdlavaiaHcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiarcifgrae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;siliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabavcefciGaiVcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:Ohkxekcjjjj94hkkabavcdfciGaiVcetfak87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:Ohqxekcjjjj94hqkabavcufciGaiVcetfaq87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohqxekcjjjj94hqkabavciGaiVcetfaq87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj;8ifcjjj98G::NUdbabclfhbadcufgdmbkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklz9Kbb",Se="b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q;Aekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;a9tqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk;d8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhwcbhDinaDae9pmeawaeaD9RaDawfae6Egqcsfgoc9WGgkci2hxakcethmaocl4cifcd4hPabaDad2fhscbhzdnincehHalhOcbhAdninaraO9RaP6miavcj;cbfaAak2fhCaOaPfhlcbhidnakc;ab6mbaral9Rc;Gb6mbcbhoinaCaofhidndndndndnaOaoco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklbalczfhlkdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklzalczfhlkdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklaalczfhlkdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalclfaYpQbfaXc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalcwfaYpQbfaXc:q:yjjbfRbbfhlxekaialpbbbpkl8Walczfhlkaoc;abfhiaocjefak0meaihoaral9Rc;Fb0mbkkdndnaiak9pmbaici4hoinaral9RcK6mdaCaifhXdndndndndnaOaico4fRbbaocoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpklbxikaXalpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaXalpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaXalpbbbpklbalczfhlkaocdfhoaiczfgiak6mbkkalTmbaAci6hHalhOaAcefgAclSmdxekkcbhlaHceGmdkdnakTmbavcjdfazfhiavazfpbdbhYcbhXinaiavcj;cbfaXfgopblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLaoakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEaoamfpblbg3cep9Ta3aQp9op9Hp9rg3aoaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfhiaXczfgXak6mbkkazclfgzad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfhDc9:hoalmexikkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk;tzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhrcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgDc;Ve0mbavc;abfalaDcu7gPcl4fcsGcitfgsydlhzasydbhHdnaDcsGgDak9pmbavaiaPfcsGcdtfydbaxaDEhsaDThDdndnadcd9hmbabarcetfgPaH87ebaPcdfaz87ebaPclfas87ebxekabarcdtfgPaHBdbaPclfazBdbaPcwfasBdbkaxaDfhxavc;abfalcitfgPasBdbaPazBdlavaicdtfasBdbavc;abfalcefcsGglcitfgPaHBdbaPasBdlaiaDfhialcefhlxdkdndnaDcsSmbamaDfaDc987fcefhmxekaocefhDao8SbbgscFeGhPdndnascu9mmbaDhoxekaocvfhoaPcFbGhPcrhsdninaD8SbbgOcFbGastaPVhPaOcu9kmeaDcefhDascrfgsc8J9hmbxdkkaDcefhokaPce4cbaPceG9R7amfhmkdndnadcd9hmbabarcetfgDaH87ebaDcdfaz87ebaDclfam87ebxekabarcdtfgDaHBdbaDclfazBdbaDcwfamBdbkavc;abfalcitfgDamBdbaDazBdlavaicdtfamBdbavc;abfalcefcsGglcitfgDaHBdbaDamBdlaicefhialcefhlxekdnaDcpe0mbaxcefgOavaiaqaDcsGfRbbgscl49RcsGcdtfydbascz6gPEhDavaias9RcsGcdtfydbaOaPfgzascsGgOEhsaOThOdndnadcd9hmbabarcetfgHax87ebaHcdfaD87ebaHclfas87ebxekabarcdtfgHaxBdbaHclfaDBdbaHcwfasBdbkavaicdtfaxBdbavc;abfalcitfgHaDBdbaHaxBdlavaicefgicsGcdtfaDBdbavc;abfalcefcsGcitfgHasBdbaHaDBdlavaiaPfcsGgicdtfasBdbavc;abfalcdfcsGglcitfgDaxBdbaDasBdlalcefhlaiaOfhiazaOfhxxekaxcbaoRbbgHEgAaDc;:eSgDfhzaHcsGhCaHcl4hXdndnaHcs0mbazcefhOxekazhOavaiaX9RcsGcdtfydbhzkdndnaCmbaOcefhxxekaOhxavaiaH9RcsGcdtfydbhOkdndnaDTmbaocefhDxekaocdfhDao8SbegPcFeGhsdnaPcu9kmbaocofhAascFbGhscrhodninaD8SbbgPcFbGaotasVhsaPcu9kmeaDcefhDaocrfgoc8J9hmbkaAhDxekaDcefhDkasce4cbasceG9R7amfgmhAkdndnaXcsSmbaDhsxekaDcefhsaD8SbbgocFeGhPdnaocu9kmbaDcvfhzaPcFbGhPcrhodninas8SbbgDcFbGaotaPVhPaDcu9kmeascefhsaocrfgoc8J9hmbkazhsxekascefhskaPce4cbaPceG9R7amfgmhzkdndnaCcsSmbashoxekascefhoas8SbbgDcFeGhPdnaDcu9kmbascvfhOaPcFbGhPcrhDdninao8SbbgscFbGaDtaPVhPascu9kmeaocefhoaDcrfgDc8J9hmbkaOhoxekaocefhokaPce4cbaPceG9R7amfgmhOkdndnadcd9hmbabarcetfgDaA87ebaDcdfaz87ebaDclfaO87ebxekabarcdtfgDaABdbaDclfazBdbaDcwfaOBdbkavc;abfalcitfgDazBdbaDaABdlavaicdtfaABdbavc;abfalcefcsGcitfgDaOBdbaDazBdlavaicefgicsGcdtfazBdbavc;abfalcdfcsGcitfgDaABdbaDaOBdlavaiaHcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiarcifgrae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:wPliuo97eue978Jjjjjbca9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalae9pmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskdnalTmbcbhvabhdinadczfgxaxpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oawaopmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalae9pmbaiaeciGgvcitgdfcbcaad9R;8kbaiabalcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oawaopmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalae9pmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepkbbadczfhdaeclfgeav6mbkkdnaval9pmbaialciGgecdtgdVcbc;abad9R;8kbaiabavcdtfgvad;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepklbkavaiad;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz9Tbb",Be=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),De=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var Ve=WebAssembly.validate(Be)?Se:$e,Fe,Je=WebAssembly.instantiate(Xe(Ve),{}).then(function(rn){Fe=rn.instance,Fe.exports.__wasm_call_ctors()});function Xe(rn){for(var on=new Uint8Array(rn.length),sn=0;sn<rn.length;++sn){var ln=rn.charCodeAt(sn);on[sn]=ln>96?ln-97:ln>64?ln-39:ln+4}for(var cn=0,sn=0;sn<rn.length;++sn)on[cn++]=on[sn]<60?De[on[sn]]:(on[sn]-60)*64+on[++sn];return on.buffer.slice(0,cn)}function Ke(rn,on,sn,ln,cn,hn){var mn=Fe.exports.sbrk,An=sn+3&-4,xn=mn(An*ln),pn=mn(cn.length),dn=new Uint8Array(Fe.exports.memory.buffer);dn.set(cn,pn);var fn=rn(xn,sn,ln,pn,cn.length);if(fn==0&&hn&&hn(xn,An,ln),on.set(dn.subarray(xn,xn+sn*ln)),mn(xn-mn(0)),fn!=0)throw new Error("Malformed buffer data: "+fn)}var Ye={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},or={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},sr=[],cr=0;function Br(rn){var on={object:new Worker(rn),pending:0,requests:{}};return on.object.onmessage=function(sn){var ln=sn.data;on.pending-=ln.count,on.requests[ln.id][ln.action](ln.value),delete on.requests[ln.id]},on}function tn(rn){for(var on="var instance; var ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(Xe(Ve))+"]), {}).then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });self.onmessage = workerProcess;"+Ke.toString()+an.toString(),sn=new Blob([on],{type:"text/javascript"}),ln=URL.createObjectURL(sn),cn=0;cn<rn;++cn)sr[cn]=Br(ln);URL.revokeObjectURL(ln)}function en(rn,on,sn,ln,cn){for(var hn=sr[0],mn=1;mn<sr.length;++mn)sr[mn].pending<hn.pending&&(hn=sr[mn]);return new Promise(function(An,xn){var pn=new Uint8Array(sn),dn=cr++;hn.pending+=rn,hn.requests[dn]={resolve:An,reject:xn},hn.object.postMessage({id:dn,count:rn,size:on,source:pn,mode:ln,filter:cn},[pn.buffer])})}function an(rn){Je.then(function(){var on=rn.data;try{var sn=new Uint8Array(on.count*on.size);Ke(Fe.exports[on.mode],sn,on.count,on.size,on.source,Fe.exports[on.filter]),self.postMessage({id:on.id,count:on.count,action:"resolve",value:sn},[sn.buffer])}catch(ln){self.postMessage({id:on.id,count:on.count,action:"reject",value:ln})}})}return{ready:Je,supported:!0,useWorkers:function(rn){tn(rn)},decodeVertexBuffer:function(rn,on,sn,ln,cn){Ke(Fe.exports.meshopt_decodeVertexBuffer,rn,on,sn,ln,Fe.exports[Ye[cn]])},decodeIndexBuffer:function(rn,on,sn,ln){Ke(Fe.exports.meshopt_decodeIndexBuffer,rn,on,sn,ln)},decodeIndexSequence:function(rn,on,sn,ln){Ke(Fe.exports.meshopt_decodeIndexSequence,rn,on,sn,ln)},decodeGltfBuffer:function(rn,on,sn,ln,cn,hn){Ke(Fe.exports[or[cn]],rn,on,sn,ln,Fe.exports[Ye[hn]])},decodeGltfBufferAsync:function(rn,on,sn,ln,cn){return sr.length>0?en(rn,on,sn,or[ln],Ye[cn]):Je.then(function(){var hn=new Uint8Array(rn*on);return Ke(Fe.exports[or[ln]],hn,rn,on,sn,Fe.exports[Ye[cn]]),hn})}}}(),EXTENSION_NAME$3="EXT_meshopt_compression",EXT_meshopt_compression=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.loadBufferView=function(Be,De){var Ve=De.json,Fe=Ve.bufferViews[Be];if(Fe.extensions&&Fe.extensions[EXTENSION_NAME$3]){var Je=Fe.extensions[EXTENSION_NAME$3],Xe=De.loadBuffer(Je.buffer);if(!meshoptDecoder.supported){if(Ve.extensionsRequired&&Ve.extensionsRequired.indexOf(EXTENSION_NAME$3)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([Xe,meshoptDecoder.ready]).then(function(Ke){var Ye=Ke[0],or=Je.byteOffset||0,sr=Je.byteLength||0,cr=Je.count,Br=Je.byteStride,tn=new ArrayBuffer(cr*Br),en=new Uint8Array(Ye,or,sr);return meshoptDecoder.decodeGltfBuffer(new Uint8Array(tn),cr,Br,en,Je.mode,Je.filter),tn})}else return null},Se}(BaseExtension),EXTENSION_NAME$2="EXT_texture_webp",EXT_texture_webp=function($e){__extends(Se,$e);function Se(){var Be=$e!==null&&$e.apply(this,arguments)||this;return Be.supportsWep=!1,Be}return Se.prototype.prepare=function(Be){var De=this;return imageSupport().then(function(Ve){De.supportsWep=Ve.webp})},Se.prototype.loadTexture=function(Be,De){var Ve=De.json,Fe=Ve.textures[Be];if(!Fe.extensions||!Fe.extensions[EXTENSION_NAME$2]||!this.supportsWep)return null;var Je=Fe.extensions[EXTENSION_NAME$2];return De.loadImage(Je.source).then(function(Xe){var Ke=new Texture(Xe);Ke.needsUpdate=!0,Ke.flipY=!1,Fe.name&&(Ke.name=Fe.name);var Ye=De.json.samplers||{},or=Ye[Fe.sampler]||{};return Ke.magFilter=WEBGL_FILTERS[or.magFilter]||LinearFilter,Ke.minFilter=WEBGL_FILTERS[or.minFilter]||LinearMipmapLinearFilter,Ke.wrapS=WEBGL_WRAPPINGS[or.wrapS]||RepeatWrapping,Ke.wrapT=WEBGL_WRAPPINGS[or.wrapT]||RepeatWrapping,Ke.onUpdate=function(){Xe.close()},Ke})},Se}(BaseExtension),EXTENSION_NAME$1="CESIUM_RTC",CESIUM_RTC=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.emitResult=function(Be,De){if(De.json.extensions[EXTENSION_NAME$1]&&De.json.extensions[EXTENSION_NAME$1].center){var Ve=De.json.extensions[EXTENSION_NAME$1].center;Be.CESIUM_RTC={center:new Vector3().fromArray(Ve)}}},Se}(BaseExtension),PBM_mesh=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.loadMesh=function(Be,De){var Ve=this,Fe=De.json.meshes[Be],Je=Fe.primitives,Xe=Promise.all(Je.map(function(or){return De.loadGeometry(or)})),Ke=Promise.all(Je.map(function(or){return Ve.loadPBMMaterial(or,De)})),Ye=Promise.all([Xe,Ke]).then(function(or){for(var sr=or[0],cr=or[1],Br=[],tn=0;tn<Je.length;tn++){var en=Je[tn],an=sr[tn],rn=cr[tn];an.attributes.normal===void 0&&(rn.flatShading=!0),an.attributes.tangent===void 0&&rn.normalScale&&(rn.normalScale.y*=-1);var on=en.mode||WEBGL_CONSTANTS.TRIANGLES,sn=void 0;if(on===WEBGL_CONSTANTS.TRIANGLES||on===WEBGL_CONSTANTS.TRIANGLE_STRIP||on===WEBGL_CONSTANTS.TRIANGLE_FAN)if(on===WEBGL_CONSTANTS.TRIANGLE_STRIP?an=De.toGeometryTrianglesDrawMode(an,TriangleStripDrawMode):on===WEBGL_CONSTANTS.TRIANGLE_FAN&&(an=De.toGeometryTrianglesDrawMode(an,TriangleFanDrawMode)),an.clearGroups(),an.addGroup(0,an.index?an.index.count:an.attributes.position.count,0),De.disposeSet.add(an),Fe.isSkinnedMesh){var ln=new PBMSkinnedMesh(an,[rn]);an.attributes.skinWeight.normalized||ln.normalizeSkinWeights(),sn=ln}else sn=new PBMMesh(an,[rn]);else if(on===WEBGL_CONSTANTS.POINTS)sn=new PBMPointCloud(an,rn);else throw new Error("glTF: Primitive mode unsupported: "+on);if(Object.keys(an.morphAttributes).length>0){if(Fe.weights!==void 0)for(var cn=0,hn=Fe.weights.length;cn<hn;cn++)sn.morphTargetInfluences[cn]=Fe.weights[cn];if(Fe.extras&&Array.isArray(Fe.extras.targetNames)){var mn=Fe.extras.targetNames;if(sn.morphTargetInfluences.length===mn.length){sn.morphTargetDictionary={};for(var cn=0,hn=mn.length;cn<hn;cn++)sn.morphTargetDictionary[mn[cn]]=cn}else console.warn("glTF: Invalid extras.targetNames length. Ignoring names.")}}sn.name=De.createUniqueName(Fe.name||"mesh_"+Be),Br.push(sn)}if(Br.length===1)return Br[0];for(var An=new Group$1,xn=0,pn=Br;xn<pn.length;xn++){var sn=pn[xn];An.add(sn)}return An});return Ye},Se.prototype.loadPBMMaterial=function(Be,De){var Ve,Fe=(Ve=Be.mode)!==null&&Ve!==void 0?Ve:WEBGL_CONSTANTS.TRIANGLES,Je=null;if(Fe===WEBGL_CONSTANTS.TRIANGLES||Fe===WEBGL_CONSTANTS.TRIANGLE_STRIP||Fe===WEBGL_CONSTANTS.TRIANGLE_FAN)Je=this.loadPBMMeshMaterial(Be,De);else if(Fe===WEBGL_CONSTANTS.POINTS)Je=this.loadPBMPointCloudMaterial(Be,De);else throw new Error("glTF: Primitive mode unsupported: "+Fe);return Je=Je.then(function(Xe){return Promise.all(values(De.extensions).map(function(Ke){return Ke.extendMaterial(Xe,Be,De)})).then(function(){return Xe})}),Je},Se.prototype.extendTexture=function(Be,De,Ve){return Be.minFilter=LinearFilter,Be.magFilter=LinearFilter,Be.generateMipmaps=!1,Be},Se.prototype.loadPBMPointCloudMaterial=function(Be,De){var Ve=new PBMPointCloudMaterial;return Object.keys(Be.attributes).filter(function(Fe){return ATTRIBUTES[Fe]==="normal"}).length>0&&(Ve.defines.USE_POINT_NORMAL=!0),De.disposeSet.add(Ve),Promise.resolve(Ve)},Se.prototype.loadPBMMeshMaterial=function(Be,De){var Ve=[],Fe=De.extensions.KHR_materials_unlit?"basic":"standard",Je=new PBMMeshMaterial(Fe);if(Je.color=new Color(1,1,1),Object.keys(Be.attributes).filter(function(cr){return ATTRIBUTES[cr]==="color"}).length>0&&(Je.vertexColors=!0),Object.keys(Be.attributes).filter(function(cr){return ATTRIBUTES[cr]==="tangent"}).length===0?(Je.normalScale&&(Je.normalScale.y*=-1),Je.clearcoatNormalScale&&(Je.clearcoatNormalScale.y*=-1)):Je.vertexTangents=!0,Be.material!==void 0){var Xe=De.json.materials[Be.material];Xe.name&&(Je.name=Xe.name);var Ke=Xe.pbrMetallicRoughness||{};if(Array.isArray(Ke.baseColorFactor)){var Ye=Ke.baseColorFactor;Je.color=new Color().fromArray(Ye),Je.colorAlpha=Ye[3]}Ke.baseColorTexture!==void 0&&Ve.push(De.createMaterialTexture(Ke.baseColorTexture).then(function(cr){De.disposeSet.add(cr),cr.encoding=sRGBEncoding,Je.map=cr})),typeof Ke.roughnessFactor=="number"&&(Je.roughness=Ke.roughnessFactor),typeof Ke.metallicFactor=="number"&&(Je.metalness=Ke.metallicFactor),Ke.metallicRoughnessTexture!==void 0&&Ve.push(De.createMaterialTexture(Ke.metallicRoughnessTexture).then(function(cr){De.disposeSet.add(cr),cr.encoding=sRGBEncoding,Je.roughnessMap=cr,Je.metalnessMap=cr})),Xe.doubleSided===!0&&(Je.side=DoubleSide);var or=Xe.alphaMode||ALPHA_MODES.OPAQUE;if(Je.alphaMode="OPAQUE",or===ALPHA_MODES.BLEND?(Je.alphaMode="BLEND",Je.transparent=!0,Je.depthWrite=!1):(Je.transparent=!1,or===ALPHA_MODES.MASK&&(Je.alphaMode="MASK",Je.alphaTest=Xe.alphaCutoff!==void 0?Xe.alphaCutoff:.5)),Xe.normalTexture!==void 0&&(Ve.push(De.createMaterialTexture(Xe.normalTexture).then(function(cr){De.disposeSet.add(cr),Je.normalMap=cr})),Je.normalScale=new Vector2(1,1),Xe.normalTexture.scale!==void 0)){var sr=Xe.normalTexture.scale;Je.normalScale.set(sr,sr)}}return De.disposeSet.add(Je),Promise.all(Ve).then(function(){return Je.refreshUniforms(),Je})},Se}(BaseExtension),EXTENSION_NAME="REALSEE_materials_lightmap",REALSEE_materials_lightmap=function($e){__extends(Se,$e);function Se(){return $e!==null&&$e.apply(this,arguments)||this}return Se.prototype.extendMaterial=function(Be,De,Ve){var Fe=[];if(Ve.json.materials&&De.material!==void 0){var Je=Ve.json.materials[De.material],Xe=Je.extensions[EXTENSION_NAME];Xe&&(Xe.lightMapTexture!==void 0&&Fe.push(Ve.createMaterialTexture(Xe.lightMapTexture).then(function(Ke){Be.lightMap=Ke})),Xe.lightMapIntensity!==void 0&&(Be.lightMapIntensity=Xe.lightMapIntensity))}return Promise.all(Fe).then(function(){})},Se}(BaseExtension),EXTENSIONS={KHR_binary_glTF,KHR_draco_mesh_compression,KHR_texture_basisu,KHR_texture_transform,KHR_mesh_quantization,KHR_materials_unlit,EXT_meshopt_compression,EXT_texture_webp,CESIUM_RTC,REALSEE_materials_lightmap,PBM_mesh};function parseGltf($e,Se){var Be,De,Ve,Fe={},Je,Xe;if(typeof $e=="string")Xe=$e;else{var Ke=EXTENSIONS.KHR_binary_glTF.getMagic($e);if(Ke===EXTENSIONS.KHR_binary_glTF.HEADER_MAGIC){Je=new EXTENSIONS.KHR_binary_glTF;try{Je.loadGlbBinary($e)}catch(tn){return Promise.reject(tn)}Fe.KHR_binary_glTF=Je,Xe=Je.content}else Xe=decodeText(new Uint8Array($e))}var Ye=JSON.parse(Xe);if(Se.jsonModify&&(Ye=Se.jsonModify(Ye)),Ye.asset===void 0||Number(Ye.asset.version[0])<2)return Promise.reject(new Error("glTF: Unsupported asset. glTF versions >=2.0 are supported."));if(Ye.extensionsUsed)for(var or=Ye.extensionsRequired||[],sr=0;sr<Ye.extensionsUsed.length;sr++){var cr=Ye.extensionsUsed[sr];Fe[cr]||(EXTENSIONS[cr]?Fe[cr]=new EXTENSIONS[cr]:or.indexOf(cr)>=0&&console.warn('glTF: Unknown extension "'+cr+'".'))}var Br=new Parser(Ye,Fe,{copyUV2:(Be=Se.copyUV2)!==null&&Be!==void 0?Be:!0,resourcePath:(De=Se.resourcePath)!==null&&De!==void 0?De:"",search:(Ve=Se.search)!==null&&Ve!==void 0?Ve:"",fetcher:Se.fetcher});return Br.parse().then(function(tn){return Je&&Je.clear(),tn})}function fixNumber($e){return isNaN($e)||!isFinite($e)?0:$e}function getGeometryMemoryUsed($e){var Se=0;if($e instanceof BufferGeometry){for(var Be in $e.attributes){var De=$e.getAttribute(Be),Ve=4;"BYTES_PER_ELEMENT"in De.array&&typeof De.array.BYTES_PER_ELEMENT=="number"&&(Ve=De.array.BYTES_PER_ELEMENT),Se+=fixNumber(De.count*De.itemSize*Ve)}var Fe=$e.getIndex();if(Fe){var Ve=4;"BYTES_PER_ELEMENT"in Fe.array&&typeof Fe.array.BYTES_PER_ELEMENT=="number"&&(Ve=Fe.array.BYTES_PER_ELEMENT),Se+=fixNumber(Fe.count*Fe.itemSize*Ve)}}else $e instanceof Geometry&&(Se+=fixNumber($e.faces.length*3*3*4),Se+=fixNumber($e.faceVertexUvs.length*3*2*4));return Se}function makeComputeBlockRectSizeFunction($e,Se,Be){return function(De,Ve,Fe){var Je=(De+$e-1)/$e|0,Xe=(Ve+Se-1)/Se|0;return Je*Xe*Be*Fe}}function makeComputePaddedRectSizeFunction($e,Se,Be){return function(De,Ve,Fe){return(Math.max(De,$e)*Math.max(Ve,Se)/Be|0)*Fe}}var compressedTextureFunctions=new Map([[RGB_S3TC_DXT1_Format,makeComputeBlockRectSizeFunction(4,4,8)],[RGBA_S3TC_DXT1_Format,makeComputeBlockRectSizeFunction(4,4,8)],[RGBA_S3TC_DXT3_Format,makeComputeBlockRectSizeFunction(4,4,16)],[RGBA_S3TC_DXT5_Format,makeComputeBlockRectSizeFunction(4,4,16)],[RGB_ETC1_Format,makeComputeBlockRectSizeFunction(4,4,8)],[RGB_PVRTC_4BPPV1_Format,makeComputePaddedRectSizeFunction(8,8,2)],[RGBA_PVRTC_4BPPV1_Format,makeComputePaddedRectSizeFunction(8,8,2)],[RGB_PVRTC_2BPPV1_Format,makeComputePaddedRectSizeFunction(16,8,4)],[RGBA_PVRTC_2BPPV1_Format,makeComputePaddedRectSizeFunction(16,8,4)],[RGB_ETC2_Format,makeComputeBlockRectSizeFunction(4,4,8)],[RGBA_ETC2_EAC_Format,makeComputeBlockRectSizeFunction(4,4,16)],[RGBA_ASTC_4x4_Format,makeComputeBlockRectSizeFunction(4,4,16)],[SRGB8_ALPHA8_ASTC_4x4_Format,makeComputeBlockRectSizeFunction(4,4,16)],[RGBA_ASTC_5x4_Format,makeComputeBlockRectSizeFunction(5,4,16)],[SRGB8_ALPHA8_ASTC_5x4_Format,makeComputeBlockRectSizeFunction(5,4,16)],[RGBA_ASTC_5x5_Format,makeComputeBlockRectSizeFunction(5,5,16)],[SRGB8_ALPHA8_ASTC_5x5_Format,makeComputeBlockRectSizeFunction(5,5,16)],[RGBA_ASTC_6x5_Format,makeComputeBlockRectSizeFunction(6,5,16)],[SRGB8_ALPHA8_ASTC_6x5_Format,makeComputeBlockRectSizeFunction(6,5,16)],[RGBA_ASTC_6x6_Format,makeComputeBlockRectSizeFunction(6,6,16)],[SRGB8_ALPHA8_ASTC_6x6_Format,makeComputeBlockRectSizeFunction(6,6,16)],[RGBA_ASTC_8x5_Format,makeComputeBlockRectSizeFunction(8,5,16)],[SRGB8_ALPHA8_ASTC_8x5_Format,makeComputeBlockRectSizeFunction(8,5,16)],[RGBA_ASTC_8x6_Format,makeComputeBlockRectSizeFunction(8,6,16)],[SRGB8_ALPHA8_ASTC_8x6_Format,makeComputeBlockRectSizeFunction(8,6,16)],[RGBA_ASTC_8x8_Format,makeComputeBlockRectSizeFunction(8,8,16)],[SRGB8_ALPHA8_ASTC_8x8_Format,makeComputeBlockRectSizeFunction(8,8,16)],[RGBA_ASTC_10x5_Format,makeComputeBlockRectSizeFunction(10,5,16)],[SRGB8_ALPHA8_ASTC_10x5_Format,makeComputeBlockRectSizeFunction(10,5,16)],[RGBA_ASTC_10x6_Format,makeComputeBlockRectSizeFunction(10,6,16)],[SRGB8_ALPHA8_ASTC_10x6_Format,makeComputeBlockRectSizeFunction(10,6,16)],[RGBA_ASTC_10x8_Format,makeComputeBlockRectSizeFunction(10,8,16)],[SRGB8_ALPHA8_ASTC_10x8_Format,makeComputeBlockRectSizeFunction(10,8,16)],[RGBA_ASTC_10x10_Format,makeComputeBlockRectSizeFunction(10,10,16)],[SRGB8_ALPHA8_ASTC_10x10_Format,makeComputeBlockRectSizeFunction(10,10,16)],[RGBA_ASTC_12x10_Format,makeComputeBlockRectSizeFunction(12,10,16)],[SRGB8_ALPHA8_ASTC_12x10_Format,makeComputeBlockRectSizeFunction(12,10,16)],[RGBA_ASTC_12x12_Format,makeComputeBlockRectSizeFunction(12,12,16)],[SRGB8_ALPHA8_ASTC_12x12_Format,makeComputeBlockRectSizeFunction(12,12,16)],[RGBA_BPTC_Format,makeComputeBlockRectSizeFunction(4,4,16)]]);function getTextureMemoryUsed($e){var Se=0,Be=1;($e.generateMipmaps===!0||$e.mipmaps&&$e.mipmaps.length>1)&&(Be=1.33);for(var De=$e instanceof CompressedTexture,Ve=De?compressedTextureFunctions.get($e.format):void 0,Fe=[].concat($e.image),Je=0,Xe=Fe;Je<Xe.length;Je++){var Ke=Xe[Je];if(Ke instanceof Texture)Se+=getTextureMemoryUsed(Ke);else{var Ye=Ke.width,or=Ye===void 0?1:Ye,sr=Ke.height,cr=sr===void 0?1:sr,Br=Ke.depth,tn=Br===void 0?1:Br;Ve?Se+=fixNumber(Ve(or,cr,tn)*Be):Se+=fixNumber(or*cr*tn*4*Be)}}return Se}var textureSet=new Set,textureNames=["map","alphaMap","bumpMap","normalMap","displacementMap","emissiveMap","specularMap","envMap","flipEnvMap","lightMap","aoMap","gradientMap","metalnessMap","roughnessMap","sheenColorMap","sheenRoughnessMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","iridescenceMap","iridescenceThicknessMap","transmissionMap","thicknessMap","anisotropyMap","specularColorMap","specularIntensityMap"];function getMaterialMemoryUsed($e){var Se=0;if(textureSet.clear(),$e instanceof ShaderMaterial)for(var Be in $e.uniforms){var De=$e.uniforms[Be],Ve=De&&De.value&&De.value instanceof Texture?De.value:void 0;Ve instanceof Texture&&(textureSet.has(Ve)||(Se=getTextureMemoryUsed(Ve),textureSet.add(Ve)))}else for(var Fe=0,Je=textureNames;Fe<Je.length;Fe++){var Xe=Je[Fe],Ve=$e[Xe];Ve instanceof Texture&&(textureSet.has(Ve)||(Se=getTextureMemoryUsed(Ve),textureSet.add(Ve)))}return textureSet.clear(),Se}var sceneSet=new Set;function getMemoryUsage($e){var Se=0;return sceneSet.clear(),$e.traverse(function(Be){if(Be instanceof Mesh||Be instanceof Line||Be instanceof Points){var De=Be.geometry;(De instanceof BufferGeometry||De instanceof Geometry)&&(sceneSet.has(De)||(Se+=getGeometryMemoryUsed(De),sceneSet.add(De)));for(var Ve=[].concat(Be.material),Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe];Xe instanceof Material&&(sceneSet.has(Xe)||(Se+=getMaterialMemoryUsed(Xe),sceneSet.add(Xe)))}}}),sceneSet.clear(),Se}var ROTATE_X_MATRIX$6=new Matrix4().fromArray([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]);function loadB3dm($e,Se){var Be,De;Se===void 0&&(Se={});var Ve=(Be=Se.upAxis)!==null&&Be!==void 0?Be:"Y",Fe=(De=Se.fetcher)!==null&&De!==void 0?De:new Fetcher({allowHosts:["*"]}),Je={uri:$e};return Promise.resolve().then(function(){return Fe.ajax($e,{responseType:"arraybuffer"}).then(function(Xe){return Xe.body})}).then(function(Xe){return Promise.resolve(0).then(function(Ke){return parseHeader$1(Je,Xe,Ke)}).then(function(Ke){return parseTable(Je,Xe,Ke)}).then(function(Ke){return parseGlTFArrayBuffer(Je,Xe,Ke)})}).then(function(){var Xe;return parseGltf(Je.gltfArrayBuffer,{copyUV2:!1,resourcePath:$e.slice(0,$e.lastIndexOf("/")+1),search:(Xe=$e.split("?")[1])!==null&&Xe!==void 0?Xe:"",jsonModify:function(Ke){var Ye;if(Ke.extensionsUsed=(Ye=Ke.extensionsUsed)!==null&&Ye!==void 0?Ye:[],typeof Se.light=="boolean"){var or="KHR_materials_unlit";if(Se.light){var sr=Ke.extensionsUsed.indexOf(or);sr>=0&&Ke.extensionsUsed.splice(sr,1)}else{var sr=Ke.extensionsUsed.indexOf(or);sr===-1&&Ke.extensionsUsed.push(or)}}{var or="PBM_mesh",sr=Ke.extensionsUsed.indexOf(or);sr===-1&&Ke.extensionsUsed.push(or)}return Ke},fetcher:Fe}).then(function(Ke){var Ye=new Matrix4;Ve==="Y"&&Ye.premultiply(ROTATE_X_MATRIX$6);var or=new Matrix4().setPosition(Je.rtcCenter[0],Je.rtcCenter[1],Je.rtcCenter[2]);if(Ye.premultiply(or),Ke.CESIUM_RTC){var sr=new Matrix4().setPosition(Ke.CESIUM_RTC.center);Ye.premultiply(sr)}var cr=Ke.scene;return cr.applyMatrix4(Ye),delete Je.featureTableBinary,delete Je.batchTableBinary,delete Je.gltfArrayBuffer,{type:"b3dm",upAxis:"Z",uri:Je.uri,byteLength:Je.byteLength,memoryUsage:getMemoryUsage(cr),scene:cr,textures:Ke.textures,dispose:function(){return Ke.dispose()}}})})}const encodedJs="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIEIoYSl7b25tZXNzYWdlPWZ1bmN0aW9uKHIpe1Byb21pc2UucmVzb2x2ZShyLmRhdGEpLnRoZW4oZnVuY3Rpb24obil7cmV0dXJuIGEobil9KS50aGVuKGZ1bmN0aW9uKG4pe3ZhciBlPW4ub3V0cHV0LHQ9bi50cmFuc2ZlcjtyZXR1cm4gcG9zdE1lc3NhZ2UoZSx0KX0pLmNhdGNoKGZ1bmN0aW9uKG4pe3JldHVybiBwb3N0TWVzc2FnZSh7JCRlcnJvcjpufSl9KX19dmFyIHUseTsoZnVuY3Rpb24oYSl7YVthLkJZVEU9NTEyMF09IkJZVEUiLGFbYS5VTlNJR05FRF9CWVRFPTUxMjFdPSJVTlNJR05FRF9CWVRFIixhW2EuU0hPUlQ9NTEyMl09IlNIT1JUIixhW2EuVU5TSUdORURfU0hPUlQ9NTEyM109IlVOU0lHTkVEX1NIT1JUIixhW2EuSU5UPTUxMjRdPSJJTlQiLGFbYS5VTlNJR05FRF9JTlQ9NTEyNV09IlVOU0lHTkVEX0lOVCIsYVthLkZMT0FUPTUxMjZdPSJGTE9BVCIsYVthLkRPVUJMRT01MTMwXT0iRE9VQkxFIn0pKHl8fCh5PXt9KSk7dmFyIGM9KHU9e30sdVt5LkRPVUJMRV09RmxvYXQ2NEFycmF5LHVbeS5GTE9BVF09RmxvYXQzMkFycmF5LHVbeS5VTlNJR05FRF9TSE9SVF09VWludDE2QXJyYXksdVt5LlVOU0lHTkVEX0lOVF09VWludDMyQXJyYXksdVt5LlVOU0lHTkVEX0JZVEVdPVVpbnQ4QXJyYXksdVt5LkJZVEVdPUludDhBcnJheSx1W3kuU0hPUlRdPUludDE2QXJyYXksdVt5LklOVF09SW50MzJBcnJheSx1KSxGPXtET1VCTEU6eS5ET1VCTEUsRkxPQVQ6eS5GTE9BVCxVTlNJR05FRF9TSE9SVDp5LlVOU0lHTkVEX1NIT1JULFVOU0lHTkVEX0lOVDp5LlVOU0lHTkVEX0lOVCxVTlNJR05FRF9CWVRFOnkuVU5TSUdORURfQllURSxCWVRFOnkuQllURSxTSE9SVDp5LlNIT1JULElOVDp5LklOVH07ZnVuY3Rpb24gTyhhKXt2YXIgcj1jW2FdO2lmKCFyKXRocm93IG5ldyBFcnJvcigiRmFpbGVkIHRvIGNvbnZlcnQgR0wgdHlwZSIpO3JldHVybiByfWZ1bmN0aW9uIHAoYSl7dmFyIHI9TyhhKTtyZXR1cm4gci5CWVRFU19QRVJfRUxFTUVOVH1mdW5jdGlvbiBfKGEscixuLGUpe249PT12b2lkIDAmJihuPTApO3ZhciB0PU8oYSk7aWYobiVwKGEpIT09MCl7dmFyIGk9ZT9yLnNsaWNlKG4sbitlKnAoYSkpOnIuc2xpY2Uobik7cmV0dXJuIG5ldyB0KGkpfWVsc2UgcmV0dXJuIG5ldyB0KHIsbixlIT1udWxsP2U6KHIuYnl0ZUxlbmd0aC1uKS9wKGEpKX1mdW5jdGlvbiBsKGEpe3ZhciByPUZbYV07aWYoIXIpdGhyb3cgbmV3IEVycm9yKCJGYWlsZWQgdG8gY29udmVydCBHTCB0eXBlIik7cmV0dXJuIHJ9dmFyIFI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKHIsbil7dGhpcy5mZWF0dXJlc0xlbmd0aD0wLHRoaXMuY2FjaGVkVHlwZWRBcnJheXM9e30sdGhpcy5qc29uPXIsdGhpcy5idWZmZXI9bjt2YXIgZT10aGlzLmdldEdsb2JhbFByb3BlcnR5KCJQT0lOVFNfTEVOR1RIIix5LlVOU0lHTkVEX0lOVCwxKTtlJiZlLmxlbmd0aCYmKHRoaXMuZmVhdHVyZXNMZW5ndGg9ZVswXSl9cmV0dXJuIGEucHJvdG90eXBlLmdldEV4dGVuc2lvbj1mdW5jdGlvbihyKXtyZXR1cm4gdGhpcy5qc29uLmV4dGVuc2lvbnMmJnRoaXMuanNvbi5leHRlbnNpb25zW3JdfSxhLnByb3RvdHlwZS5oYXNQcm9wZXJ0eT1mdW5jdGlvbihyKXtyZXR1cm4hIXRoaXMuanNvbltyXX0sYS5wcm90b3R5cGUuZ2V0R2xvYmFsUHJvcGVydHk9ZnVuY3Rpb24ocixuLGUpe3ZhciB0PXRoaXMuanNvbltyXTtpZih0eXBlb2YgdD09Im51bWJlciIpe3ZhciBpPU8obik7cmV0dXJuIG5ldyBpKFt0XSl9ZWxzZSBpZihBcnJheS5pc0FycmF5KHQpKXt2YXIgaT1PKG4pO3JldHVybiBuZXcgaSh0KX1lbHNlIGlmKHQmJk51bWJlci5pc0Zpbml0ZSh0LmJ5dGVPZmZzZXQpKXJldHVybiB0aGlzLmdldFR5cGVkQXJyYXlGcm9tQmluYXJ5KHIsbixlLDEsdC5ieXRlT2Zmc2V0KTtyZXR1cm4gbnVsbH0sYS5wcm90b3R5cGUuZ2V0UHJvcGVydHlBcnJheT1mdW5jdGlvbihyLG4sZSl7dmFyIHQ9dGhpcy5qc29uW3JdO3JldHVybiB0JiZOdW1iZXIuaXNGaW5pdGUodC5ieXRlT2Zmc2V0KT8oImNvbXBvbmVudFR5cGUiaW4gdCYmKG49bCh0LmNvbXBvbmVudFR5cGUpKSx0aGlzLmdldFR5cGVkQXJyYXlGcm9tQmluYXJ5KHIsbixlLHRoaXMuZmVhdHVyZXNMZW5ndGgsdC5ieXRlT2Zmc2V0KSk6dGhpcy5nZXRUeXBlZEFycmF5RnJvbUFycmF5KHIsbix0KX0sYS5wcm90b3R5cGUuZ2V0UHJvcGVydHk9ZnVuY3Rpb24ocixuLGUsdCxpKXt2YXIgbz10aGlzLmpzb25bcl07aWYoIW8pcmV0dXJuIG51bGw7dmFyIHY9dGhpcy5nZXRQcm9wZXJ0eUFycmF5KHIsbixlKTtpZihlPT09MSlyZXR1cm4gaVswXT12W3RdLGk7Zm9yKHZhciBBPTA7QTxlOysrQSlpW0FdPXZbZSp0K0FdO3JldHVybiBpfSxhLnByb3RvdHlwZS5nZXRUeXBlZEFycmF5RnJvbUJpbmFyeT1mdW5jdGlvbihyLG4sZSx0LGkpe3ZhciBvPXRoaXMuY2FjaGVkVHlwZWRBcnJheXMsdj1vW3JdO3JldHVybiB2fHwodj1fKG4sdGhpcy5idWZmZXIuYnVmZmVyLHRoaXMuYnVmZmVyLmJ5dGVPZmZzZXQraSx0KmUpLG9bcl09diksdn0sYS5wcm90b3R5cGUuZ2V0VHlwZWRBcnJheUZyb21BcnJheT1mdW5jdGlvbihyLG4sZSl7dmFyIHQ9dGhpcy5jYWNoZWRUeXBlZEFycmF5cyxpPXRbcl07cmV0dXJuIGl8fChpPV8obixlKSx0W3JdPWkpLGl9LGF9KCk7QihmdW5jdGlvbihhKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGEpLnRoZW4oZnVuY3Rpb24ocil7dmFyIG49bmV3IFIoci5mZWF0dXJlVGFibGVKc29uLHIuZmVhdHVyZVRhYmxlQmluYXJ5KSxlPWQobiksdD1nKG4pLGk9UChuKSxvPVtdO3JldHVybiBlJiZvLnB1c2goZS5hcnJheS5idWZmZXIpLHQmJm8ucHVzaCh0LmFycmF5LmJ1ZmZlciksaSYmby5wdXNoKGkuYXJyYXkuYnVmZmVyKSx7b3V0cHV0Ontwb3NpdGlvbjplLGNvbG9yOnQsbm9ybWFsOml9LHRyYW5zZmVyOm99fSl9KTt2YXIgVT02NTUzNTtmdW5jdGlvbiBkKGEpe2lmKGEuaGFzUHJvcGVydHkoIlBPU0lUSU9OIikpe3ZhciByPWEuZ2V0UHJvcGVydHlBcnJheSgiUE9TSVRJT04iLHkuRkxPQVQsMyk7cmV0dXJue2FycmF5OnIsaXRlbVNpemU6Myxub3JtYWxpemVkOiExfX1lbHNlIGlmKGEuaGFzUHJvcGVydHkoIlBPU0lUSU9OX1FVQU5USVpFRCIpKXt2YXIgbj1hLmdldFByb3BlcnR5QXJyYXkoIlBPU0lUSU9OX1FVQU5USVpFRCIseS5VTlNJR05FRF9TSE9SVCwzKSxlPWEuZ2V0R2xvYmFsUHJvcGVydHkoIlFVQU5USVpFRF9WT0xVTUVfU0NBTEUiLHkuRkxPQVQsMyksdD1hLmdldEdsb2JhbFByb3BlcnR5KCJRVUFOVElaRURfVk9MVU1FX09GRlNFVCIseS5GTE9BVCwzKTtpZighZXx8IXQpdGhyb3cgbmV3IEVycm9yKCJRVUFOVElaRURfVk9MVU1FX1NDQUxFIG9yIFFVQU5USVpFRF9WT0xVTUVfT0ZGU0VUIG5ldmVyIGZvdW5kLiIpO2Zvcih2YXIgaT1uZXcgRmxvYXQzMkFycmF5KG4ubGVuZ3RoKSxvPW4ubGVuZ3RoLzMsdj1lWzBdL1UsQT1lWzFdL1UsTj1lWzJdL1UsRT10WzBdLFM9dFsxXSxzPXRbMl0sVD0wLEk9dm9pZCAwO1Q8bztUKyspST1UKjMsaVtJXT1uW0ldKnYrRSxpWysrSV09bltJXSpBK1MsaVsrK0ldPW5bSV0qTitzO3JldHVybnthcnJheTppLGl0ZW1TaXplOjMsbm9ybWFsaXplZDohMX19cmV0dXJuIG51bGx9ZnVuY3Rpb24gZyhhKXtpZihhLmhhc1Byb3BlcnR5KCJSR0IiKSl7Zm9yKHZhciByPWEuZ2V0UHJvcGVydHlBcnJheSgiUkdCIix5LlVOU0lHTkVEX0JZVEUsMyksbj1yLmxlbmd0aC8zLGU9bmV3IFVpbnQ4QXJyYXkobio0KSx0PTAsaT12b2lkIDAsbz12b2lkIDA7dDxuO3QrKylvPXQqNCxpPXQqMyxlW29dPXJbaV0sZVsrK29dPXJbKytpXSxlWysrb109clsrK2ldO3JldHVybnthcnJheTplLGl0ZW1TaXplOjQsbm9ybWFsaXplZDohMH19ZWxzZSBpZihhLmhhc1Byb3BlcnR5KCJSR0JBIikpe3ZhciByPWEuZ2V0UHJvcGVydHlBcnJheSgiUkdCQSIseS5VTlNJR05FRF9CWVRFLDQpO3JldHVybnthcnJheTpyLGl0ZW1TaXplOjQsbm9ybWFsaXplZDohMH19ZWxzZSBpZihhLmhhc1Byb3BlcnR5KCJSR0I1NjUiKSl7Zm9yKHZhciByPWEuZ2V0UHJvcGVydHlBcnJheSgiUkdCNTY1Iix5LlVOU0lHTkVEX1NIT1JULDEpLG49ci5sZW5ndGgsZT1uZXcgVWludDhBcnJheShuKjQpLHQ9MCx2PXZvaWQgMCxBPXZvaWQgMDt0PG47dCsrKUE9clt0XSx2PXQqNCxlW3ZdPShBPj4xMSYzMSk8PDMsZVsrK3ZdPShBPj41JjYzKTw8MixlWysrdl09KEEmMzEpPDwzO3JldHVybnthcnJheTplLGl0ZW1TaXplOjQsbm9ybWFsaXplZDohMH19cmV0dXJuIG51bGx9dmFyIEc9MjU1LGg9MTI3LEQ9Mi9HO2Z1bmN0aW9uIFAoYSl7aWYoYS5oYXNQcm9wZXJ0eSgiTk9STUFMIikpe2Zvcih2YXIgcj1hLmdldFByb3BlcnR5QXJyYXkoIk5PUk1BTCIseS5GTE9BVCwzKSxuPXIubGVuZ3RoLzMsZT1uZXcgSW50OEFycmF5KG4qNCksdD0wLGk9dm9pZCAwLG89dm9pZCAwO3Q8bjt0Kyspbz10KjQsaT10KjMsZVtvXT1yW2ldKmgsZVsrK29dPXJbKytpXSpoLGVbKytvXT1yWysraV0qaDtyZXR1cm57YXJyYXk6ZSxpdGVtU2l6ZTo0LG5vcm1hbGl6ZWQ6ITB9fWVsc2UgaWYoYS5oYXNQcm9wZXJ0eSgiTk9STUFMX09DVDE2UCIpKXtmb3IodmFyIHI9YS5nZXRQcm9wZXJ0eUFycmF5KCJOT1JNQUxfT0NUMTZQIix5LlVOU0lHTkVEX0JZVEUsMiksbj1yLmxlbmd0aC8yLGU9bmV3IEludDhBcnJheShuKjQpLHQ9MCx2PXZvaWQgMCxBPXZvaWQgMCxOPXZvaWQgMCxFPXZvaWQgMCxTPXZvaWQgMCxzPXZvaWQgMCxUPXZvaWQgMDt0PG47dCsrKXY9dCoyLEE9clt2XSpELTEsTj1yWysrdl0qRC0xLFM9QTwwPy1BOkEscz1OPDA/LU46TixFPTEtKFMrcyksRTwwJiYoQT0oMS1zKSooQTwwPy0xOjEpLE49KDEtUykqKE48MD8tMToxKSksVD1NYXRoLnNxcnQoQSpBK04qTitFKkUpLHY9dCo0LGVbdl09QS9UKmgsZVsrK3ZdPU4vVCpoLGVbKyt2XT1FL1QqaDtyZXR1cm57YXJyYXk6ZSxpdGVtU2l6ZTo0LG5vcm1hbGl6ZWQ6ITB9fXJldHVybiBudWxsfX0pKCk7Cg==",decodeBase64=$e=>Uint8Array.from(atob($e),Se=>Se.charCodeAt(0)),blob$1=typeof self<"u"&&self.Blob&&new Blob([decodeBase64(encodedJs)],{type:"text/javascript;charset=utf-8"});function WorkerWrapper($e){let Se;try{if(Se=blob$1&&(self.URL||self.webkitURL).createObjectURL(blob$1),!Se)throw"";const Be=new Worker(Se,{name:$e?.name});return Be.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(Se)}),Be}catch{return new Worker("data:text/javascript;base64,"+encodedJs,{name:$e?.name})}finally{Se&&(self.URL||self.webkitURL).revokeObjectURL(Se)}}var attributeWorkerPool=new WorkerPool$1(function(){return new WorkerWrapper},2);function parsePointCloud($e,Se,Be){var De=new FeatureTable($e.featureTableJson,$e.featureTableBinary);return Promise.resolve().then(function(){var Ve=De.getExtension("3DTILES_draco_point_compression");return Ve?parseDraco(Ve,De):attributeWorkerPool.postMessage({featureTableBinary:De.buffer,featureTableJson:De.json},[De.buffer.buffer])}).then(function(Ve){return $e.attributes=Ve,Be})}function parseDraco($e,Se){return __awaiter(this,void 0,void 0,function(){var Be,De,Ve,Fe,Je,Xe;return __generator(this,function(Ke){if(Be=$e.properties||{},De=$e.byteOffset,Ve=$e.byteLength,!Be||!Number.isFinite(De)||!Ve)throw new Error("Draco properties, byteOffset, and byteLength must be defined");return Fe=Se.buffer.slice(De,De+Ve),Je=$e.properties,Xe={POSITION:"Float32Array",NORMAL:"Float32Array",RGB:"Uint8Array",RGBA:"Uint8Array"},[2,draco.decodeGeometry(Fe.buffer,{attributeIDs:Je,attributeTypes:Xe,useUniqueIDs:!0}).then(function(Ye){var or=Ye.getAttribute("POSITION"),sr=Ye.getAttribute("RGB"),cr=Ye.getAttribute("RGBA"),Br=Ye.getAttribute("NORMAL"),tn;if(cr)tn=cr;else if(sr){for(var en=sr.count,an=sr.array,rn=new Uint8Array(en*4),on=0,sn=void 0,ln=void 0;on<en;on++)ln=on*4,sn=on*3,rn[ln]=an[sn],rn[++ln]=an[++sn],rn[++ln]=an[++sn];tn=new BufferAttribute(rn,4,sr.normalized)}return{position:or?{array:or.array,itemSize:or.itemSize,normalized:or.normalized}:null,color:tn?{array:tn.array,itemSize:tn.itemSize,normalized:tn.normalized}:null,normal:Br?{array:Br.array,itemSize:Br.itemSize,normalized:Br.normalized}:null}})]})})}function loadPnts($e,Se){var Be;Se===void 0&&(Se={});var De=(Be=Se.fetcher)!==null&&Be!==void 0?Be:new Fetcher({allowHosts:["*"]}),Ve={uri:$e};return Promise.resolve().then(function(){return De.ajax($e,{responseType:"arraybuffer"}).then(function(Fe){return Fe.body})}).then(function(Fe){return Promise.resolve(0).then(function(Je){return parseHeader$1(Ve,Fe,Je)}).then(function(Je){return parseTable(Ve,Fe,Je)}).then(function(Je){return parsePointCloud(Ve,Fe,Je)})}).then(function(){var Fe;return createPoints(Ve.attributes,{computeBoundingBox:(Fe=Se.computeBoundingBox)!==null&&Fe!==void 0?Fe:!0})}).then(function(Fe){var Je=new Matrix4,Xe=new Matrix4().setPosition(Ve.rtcCenter[0],Ve.rtcCenter[1],Ve.rtcCenter[2]);return Je.premultiply(Xe),Fe.object.applyMatrix4(Je),delete Ve.gltfArrayBuffer,delete Ve.featureTableBinary,delete Ve.batchTableBinary,{type:"pnts",upAxis:"Z",uri:Ve.uri,byteLength:Ve.byteLength,memoryUsage:getMemoryUsage(Fe.object),scene:Fe.object,textures:[],dispose:function(){return Fe.dispose()}}})}function createPoints($e,Se){var Be=new Set,De=new BufferGeometry;Be.add(De);var Ve=new PBMPointCloudMaterial;Be.add(Ve),$e.position&&De.setAttribute("position",new BufferAttribute($e.position.array,$e.position.itemSize,$e.position.normalized)),$e.color&&De.setAttribute("color",new BufferAttribute($e.color.array,$e.color.itemSize,$e.color.normalized)),$e.normal&&(De.setAttribute("normal",new BufferAttribute($e.normal.array,$e.normal.itemSize,$e.normal.normalized)),Ve.defines.USE_POINT_NORMAL=!0),Se.computeBoundingBox&&De.computeBoundingBox();var Fe=new PBMPointCloud(De,Ve);return Fe.matrix.compose(Fe.position,Fe.quaternion,Fe.scale),Fe.matrixAutoUpdate=!1,Fe.frustumCulled=!1,Promise.resolve({object:Fe,dispose:function(){Be.forEach(function(Je){Je.dispose()}),Be.clear()}})}function createLZMA(){var $e={};return $e.OutWindow=function(){this._windowSize=0},$e.OutWindow.prototype.create=function(Se){(!this._buffer||this._windowSize!==Se)&&(this._buffer=[]),this._windowSize=Se,this._pos=0,this._streamPos=0},$e.OutWindow.prototype.flush=function(){var Se=this._pos-this._streamPos;if(Se!==0){for(;Se--;)this._stream.writeByte(this._buffer[this._streamPos++]);this._pos>=this._windowSize&&(this._pos=0),this._streamPos=this._pos}},$e.OutWindow.prototype.releaseStream=function(){this.flush(),this._stream=null},$e.OutWindow.prototype.setStream=function(Se){this.releaseStream(),this._stream=Se},$e.OutWindow.prototype.init=function(Se){Se||(this._streamPos=0,this._pos=0)},$e.OutWindow.prototype.copyBlock=function(Se,Be){var De=this._pos-Se-1;for(De<0&&(De+=this._windowSize);Be--;)De>=this._windowSize&&(De=0),this._buffer[this._pos++]=this._buffer[De++],this._pos>=this._windowSize&&this.flush()},$e.OutWindow.prototype.putByte=function(Se){this._buffer[this._pos++]=Se,this._pos>=this._windowSize&&this.flush()},$e.OutWindow.prototype.getByte=function(Se){var Be=this._pos-Se-1;return Be<0&&(Be+=this._windowSize),this._buffer[Be]},$e.RangeDecoder=function(){},$e.RangeDecoder.prototype.setStream=function(Se){this._stream=Se},$e.RangeDecoder.prototype.releaseStream=function(){this._stream=null},$e.RangeDecoder.prototype.init=function(){var Se=5;for(this._code=0,this._range=-1;Se--;)this._code=this._code<<8|this._stream.readByte()},$e.RangeDecoder.prototype.decodeDirectBits=function(Se){for(var Be=0,De=Se,Ve;De--;)this._range>>>=1,Ve=this._code-this._range>>>31,this._code-=this._range&Ve-1,Be=Be<<1|1-Ve,this._range&4278190080||(this._code=this._code<<8|this._stream.readByte(),this._range<<=8);return Be},$e.RangeDecoder.prototype.decodeBit=function(Se,Be){var De=Se[Be],Ve=(this._range>>>11)*De;return(this._code^2147483648)<(Ve^2147483648)?(this._range=Ve,Se[Be]+=2048-De>>>5,this._range&4278190080||(this._code=this._code<<8|this._stream.readByte(),this._range<<=8),0):(this._range-=Ve,this._code-=Ve,Se[Be]-=De>>>5,this._range&4278190080||(this._code=this._code<<8|this._stream.readByte(),this._range<<=8),1)},$e.initBitModels=function(Se,Be){for(;Be--;)Se[Be]=1024},$e.BitTreeDecoder=function(Se){this._models=[],this._numBitLevels=Se},$e.BitTreeDecoder.prototype.init=function(){$e.initBitModels(this._models,1<<this._numBitLevels)},$e.BitTreeDecoder.prototype.decode=function(Se){for(var Be=1,De=this._numBitLevels;De--;)Be=Be<<1|Se.decodeBit(this._models,Be);return Be-(1<<this._numBitLevels)},$e.BitTreeDecoder.prototype.reverseDecode=function(Se){for(var Be=1,De=0,Ve=0,Fe;Ve<this._numBitLevels;++Ve)Fe=Se.decodeBit(this._models,Be),Be=Be<<1|Fe,De|=Fe<<Ve;return De},$e.reverseDecode2=function(Se,Be,De,Ve){for(var Fe=1,Je=0,Xe=0,Ke;Xe<Ve;++Xe)Ke=De.decodeBit(Se,Be+Fe),Fe=Fe<<1|Ke,Je|=Ke<<Xe;return Je},$e.LenDecoder=function(){this._choice=[],this._lowCoder=[],this._midCoder=[],this._highCoder=new $e.BitTreeDecoder(8),this._numPosStates=0},$e.LenDecoder.prototype.create=function(Se){for(;this._numPosStates<Se;++this._numPosStates)this._lowCoder[this._numPosStates]=new $e.BitTreeDecoder(3),this._midCoder[this._numPosStates]=new $e.BitTreeDecoder(3)},$e.LenDecoder.prototype.init=function(){var Se=this._numPosStates;for($e.initBitModels(this._choice,2);Se--;)this._lowCoder[Se].init(),this._midCoder[Se].init();this._highCoder.init()},$e.LenDecoder.prototype.decode=function(Se,Be){return Se.decodeBit(this._choice,0)===0?this._lowCoder[Be].decode(Se):Se.decodeBit(this._choice,1)===0?8+this._midCoder[Be].decode(Se):16+this._highCoder.decode(Se)},$e.Decoder2=function(){this._decoders=[]},$e.Decoder2.prototype.init=function(){$e.initBitModels(this._decoders,768)},$e.Decoder2.prototype.decodeNormal=function(Se){var Be=1;do Be=Be<<1|Se.decodeBit(this._decoders,Be);while(Be<256);return Be&255},$e.Decoder2.prototype.decodeWithMatchByte=function(Se,Be){var De=1,Ve,Fe;do if(Ve=Be>>7&1,Be<<=1,Fe=Se.decodeBit(this._decoders,(1+Ve<<8)+De),De=De<<1|Fe,Ve!==Fe){for(;De<256;)De=De<<1|Se.decodeBit(this._decoders,De);break}while(De<256);return De&255},$e.LiteralDecoder=function(){},$e.LiteralDecoder.prototype.create=function(Se,Be){var De;if(!(this._coders&&this._numPrevBits===Be&&this._numPosBits===Se))for(this._numPosBits=Se,this._posMask=(1<<Se)-1,this._numPrevBits=Be,this._coders=[],De=1<<this._numPrevBits+this._numPosBits;De--;)this._coders[De]=new $e.Decoder2},$e.LiteralDecoder.prototype.init=function(){for(var Se=1<<this._numPrevBits+this._numPosBits;Se--;)this._coders[Se].init()},$e.LiteralDecoder.prototype.getDecoder=function(Se,Be){return this._coders[((Se&this._posMask)<<this._numPrevBits)+((Be&255)>>>8-this._numPrevBits)]},$e.Decoder=function(){this._outWindow=new $e.OutWindow,this._rangeDecoder=new $e.RangeDecoder,this._isMatchDecoders=[],this._isRepDecoders=[],this._isRepG0Decoders=[],this._isRepG1Decoders=[],this._isRepG2Decoders=[],this._isRep0LongDecoders=[],this._posSlotDecoder=[],this._posDecoders=[],this._posAlignDecoder=new $e.BitTreeDecoder(4),this._lenDecoder=new $e.LenDecoder,this._repLenDecoder=new $e.LenDecoder,this._literalDecoder=new $e.LiteralDecoder,this._dictionarySize=-1,this._dictionarySizeCheck=-1,this._posSlotDecoder[0]=new $e.BitTreeDecoder(6),this._posSlotDecoder[1]=new $e.BitTreeDecoder(6),this._posSlotDecoder[2]=new $e.BitTreeDecoder(6),this._posSlotDecoder[3]=new $e.BitTreeDecoder(6)},$e.Decoder.prototype.setDictionarySize=function(Se){return Se<0?!1:(this._dictionarySize!==Se&&(this._dictionarySize=Se,this._dictionarySizeCheck=Math.max(this._dictionarySize,1),this._outWindow.create(Math.max(this._dictionarySizeCheck,4096))),!0)},$e.Decoder.prototype.setLcLpPb=function(Se,Be,De){var Ve=1<<De;return Se>8||Be>4||De>4?!1:(this._literalDecoder.create(Be,Se),this._lenDecoder.create(Ve),this._repLenDecoder.create(Ve),this._posStateMask=Ve-1,!0)},$e.Decoder.prototype.init=function(){var Se=4;for(this._outWindow.init(!1),$e.initBitModels(this._isMatchDecoders,192),$e.initBitModels(this._isRep0LongDecoders,192),$e.initBitModels(this._isRepDecoders,12),$e.initBitModels(this._isRepG0Decoders,12),$e.initBitModels(this._isRepG1Decoders,12),$e.initBitModels(this._isRepG2Decoders,12),$e.initBitModels(this._posDecoders,114),this._literalDecoder.init();Se--;)this._posSlotDecoder[Se].init();this._lenDecoder.init(),this._repLenDecoder.init(),this._posAlignDecoder.init(),this._rangeDecoder.init()},$e.Decoder.prototype.decode=function(Se,Be,De){var Ve=0,Fe=0,Je=0,Xe=0,Ke=0,Ye=0,or=0,sr,cr,Br,tn,en,an;for(this._rangeDecoder.setStream(Se),this._outWindow.setStream(Be),this.init();De<0||Ye<De;)if(sr=Ye&this._posStateMask,this._rangeDecoder.decodeBit(this._isMatchDecoders,(Ve<<4)+sr)===0)cr=this._literalDecoder.getDecoder(Ye++,or),Ve>=7?or=cr.decodeWithMatchByte(this._rangeDecoder,this._outWindow.getByte(Fe)):or=cr.decodeNormal(this._rangeDecoder),this._outWindow.putByte(or),Ve=Ve<4?0:Ve-(Ve<10?3:6);else{if(this._rangeDecoder.decodeBit(this._isRepDecoders,Ve)===1)Br=0,this._rangeDecoder.decodeBit(this._isRepG0Decoders,Ve)===0?this._rangeDecoder.decodeBit(this._isRep0LongDecoders,(Ve<<4)+sr)===0&&(Ve=Ve<7?9:11,Br=1):(this._rangeDecoder.decodeBit(this._isRepG1Decoders,Ve)===0?tn=Je:(this._rangeDecoder.decodeBit(this._isRepG2Decoders,Ve)===0?tn=Xe:(tn=Ke,Ke=Xe),Xe=Je),Je=Fe,Fe=tn),Br===0&&(Br=2+this._repLenDecoder.decode(this._rangeDecoder,sr),Ve=Ve<7?8:11);else if(Ke=Xe,Xe=Je,Je=Fe,Br=2+this._lenDecoder.decode(this._rangeDecoder,sr),Ve=Ve<7?7:10,en=this._posSlotDecoder[Br<=5?Br-2:3].decode(this._rangeDecoder),en>=4){if(an=(en>>1)-1,Fe=(2|en&1)<<an,en<14)Fe+=$e.reverseDecode2(this._posDecoders,Fe-en-1,this._rangeDecoder,an);else if(Fe+=this._rangeDecoder.decodeDirectBits(an-4)<<4,Fe+=this._posAlignDecoder.reverseDecode(this._rangeDecoder),Fe<0){if(Fe===-1)break;return!1}}else Fe=en;if(Fe>=Ye||Fe>=this._dictionarySizeCheck)return!1;this._outWindow.copyBlock(Fe,Br),Ye+=Br,or=this._outWindow.getByte(0)}return this._outWindow.flush(),this._outWindow.releaseStream(),this._rangeDecoder.releaseStream(),!0},$e.Decoder.prototype.setDecoderProperties=function(Se){var Be,De,Ve,Fe,Je;return Se.size<5||(Be=Se.readByte(),De=Be%9,Be=~~(Be/9),Ve=Be%5,Fe=~~(Be/5),!this.setLcLpPb(De,Ve,Fe))?!1:(Je=Se.readByte(),Je|=Se.readByte()<<8,Je|=Se.readByte()<<16,Je+=Se.readByte()*16777216,this.setDictionarySize(Je))},$e.decompress=function(Se,Be,De,Ve){var Fe=new $e.Decoder;if(!Fe.setDecoderProperties(Se))throw"Incorrect stream properties";if(!Fe.decode(Be,De,Ve))throw"Error in data stream";return!0},$e.decompressFile=function(Se,Be){var De=new $e.Decoder,Ve;if(!De.setDecoderProperties(Se))throw"Incorrect stream properties";if(Ve=Se.readByte(),Ve|=Se.readByte()<<8,Ve|=Se.readByte()<<16,Ve+=Se.readByte()*16777216,Se.readByte(),Se.readByte(),Se.readByte(),Se.readByte(),!De.decode(Se,Be,Ve))throw"Error in data stream";return!0},$e}var LZMA=createLZMA();function createWASM(){function $e(Be){for(var De="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ve=new Uint8Array(256),Fe=0;Fe<De.length;Fe++)Ve[De.charCodeAt(Fe)]=Fe;var Je=Be.length*.75,Xe=Be.length,Ke,Ye=0,or,sr,cr,Br;Be[Be.length-1]==="="&&(Je--,Be[Be.length-2]==="="&&Je--);var tn=new ArrayBuffer(Je),en=new Uint8Array(tn);for(Ke=0;Ke<Xe;Ke+=4)or=Ve[Be.charCodeAt(Ke)],sr=Ve[Be.charCodeAt(Ke+1)],cr=Ve[Be.charCodeAt(Ke+2)],Br=Ve[Be.charCodeAt(Ke+3)],en[Ye++]=or<<2|sr>>4,en[Ye++]=(sr&15)<<4|cr>>2,en[Ye++]=(cr&3)<<6|Br&63;return tn}var Se="AGFzbQEAAAABSg1gAABgAX8Bf2ACf38Bf2AEf39/fwBgA39/fwBgAX8AYAJ/fwBgA39/fwF/YAR/f39/AX9gAn9/AGABfwF/YAABf2AEf39/fwF/AhsCA2VudgVhYm9ydAADA2VudgZtZW1vcnkCAAEDJiUBAQkKAgoKCwsLCwsAAgoBAgQKAQYFCAoFBQQEBwgCBwwCAQAABAQBcAABBhoFfwFBAAt/AUEAC38BQQALfwFBAAt/AUEACwc9BgZtZW1vcnkCAAV0YWJsZQEABXJlc2V0AA0KbmV3VThBcnJheQAQCnVucGFja1NpemUAFAZkZWNvZGUAIwgBJAkHAQBBAAsBJQqAViVoAQN/IABBgICAgARLBEAACyMBIgEgAEEBIABBAUsbakEHakF4cSICPwAiA0EQdEsEQCADIAIgAWtB//8DakGAgHxxQRB2IgAgAyAAShtAAEEASARAIABAAEEASARAAAsLCyACJAEgAQsbAQF/QQFBICAAQQdqZ2t0EAEiASAANgIAIAELkQMBAX8gAUUEQA8LIABBADoAACAAIAFqQQFrQQA6AAAgAUECTQRADwsgAEEBakEAOgAAIABBAmpBADoAACAAIAFqIgJBAmtBADoAACACQQNrQQA6AAAgAUEGTQRADwsgAEEDakEAOgAAIAAgAWpBBGtBADoAACABQQhNBEAPC0EAIABrQQNxIgIgAGoiAEEANgIAIAEgAmtBfHEiASAAakEEa0EANgIAIAFBCE0EQA8LIABBBGpBADYCACAAQQhqQQA2AgAgACABaiICQQxrQQA2AgAgAkEIa0EANgIAIAFBGE0EQA8LIABBDGpBADYCACAAQRBqQQA2AgAgAEEUakEANgIAIABBGGpBADYCACAAIAFqIgJBHGtBADYCACACQRhrQQA2AgAgAkEUa0EANgIAIAJBEGtBADYCACAAQQRxQRhqIgIgAGohACABIAJrIQEDQCABQSBPBEAgAEIANwMAIABBCGpCADcDACAAQRBqQgA3AwAgAEEYakIANwMAIAFBIGshASAAQSBqIQAMAQsLC1EBA38gAEH+////AEsEQEEAQSBBLUEnEAAACyAAQQJ0IgMQAiECQQgQASIBQQA2AgAgAUEANgIEIAEgAjYCACABIAA2AgQgAkEIaiADEAMgAQtmAQF/IAFB/P///wFLBEBBAEHAAEEXQSIQAAALIAFBAXQiARACIgJBCGogARADIABFBEBBDBABIQALIABBADYCACAAQQA2AgQgAEEANgIIIAAgAjYCACAAQQA2AgQgACABNgIIIAALCgBBDBABIAAQBQsuAQF/QQgQASIBQQA2AgAgAUEANgIEIAEgADYCBCABQQEgASgCBHQQBjYCACABC6EBAQR/QRAQASIBQQA2AgAgAUEANgIEIAFBADYCCCABQQA2AgxBEBAEIQIDQCAAQRBIBEBBAxAHIQMgAigCACAAQQJ0aiADNgIIIABBAWohAAwBCwsgASACNgIEQRAQBCECQQAhAANAIABBEEgEQEEDEAchAyACKAIAIABBAnRqIAM2AgggAEEBaiEADAELCyABIAI2AgggAUEIEAc2AgwgAQs0AQF/QRQQASIAQQA2AgAgAEEAOgAEIABBADYCCCAAQQA2AgwgAEEANgIQIABBDTYCCCAAC0IBAX9BGRABIgBBADYCACAAQQA2AgQgAEEANgIIIABBADYCDCAAQQA2AhAgAEEANgIUIABBADoAGCAAQQA2AhAgAAu1AgEEf0HQABABIgBBADoAACAAQQA2AgQgAEEANgIIIABBADYCDCAAQQA2AhAgAEEAOgAUIABBADYCGCAAQQA2AhwgAEEANgIgIABBADYCJCAAQQA2AiggAEEANgIsIABBADYCMCAAQQA2AjQgAEEANgI4IABBADYCPCAAQQA2AkAgAEEANgJEIABBADYCSCAAQQA2AkxBBBAEIQIDQCABQQRIBEBBBhAHIQMgAigCACABQQJ0aiADNgIIIAFBAWohAQwBCwsgACACNgIkIABBBBAHNgIoIABB8wAQBjYCLCAAQcABEAY2AjAgAEEMEAY2AjQgAEEMEAY2AjggAEEMEAY2AjwgAEEMEAY2AkAgAEHAARAGNgJEIAAQCDYCSCAAEAg2AkwgABAJNgIEIAAQCjYCCCAACx8BAX9BCBABIgBBADYCACAAQQA2AgQgABALNgIAIAALCgAjACQBEAwkAwthAQF/IAFB+P///wNLBEBBAEHAAEEXQSIQAAALIAEQAiICQQhqIAEQAyAARQRAQQwQASEACyAAQQA2AgAgAEEANgIEIABBADYCCCAAIAI2AgAgAEEANgIEIAAgATYCCCAACwoAQQwQASAAEA4LBgAgABAPCyoAIAEgACgCCE8EQEEAQcAAQSdBPxAAAAsgACgCBCABIAAoAgBqai0ACAssACABIAAoAghPBEBBAEHAAEEyQT8QAAALIAAoAgQgASAAKAIAamogAjoACAtkAQJ/QQ0QDyECA0AgAUENSARAIAIgASAAIAEQEUH/AXEQEiABQQFqIQEMAQsLQQAhAEEAIQEDQCABQQhIBEAgAiABQQVqEBFB/wFxIAFBA3R0IAByIQAgAUEBaiEBDAELCyAACwYAIAAQEwsnACAAIAEQDzYCCCAAQQA2AgwgACABNgIUIABBADoAGCAAQQA2AgALJAAgACgCCCAAKAIYEBUgAEGABiAAKAIMIAAtABRqdBAGNgIgC5UBAQR/IAEhBSAAIgYoAgAhASAAKAIEIQcgACgCCEEBdiEEIAJBAEgEfyACIARqIgBBACAAQQBKGwUgAiIAIAQgACAESBsLIQIgA0EASAR/IAMgBGoiAEEAIABBAEobBSADIgAgBCAAIARIGwshAwNAIAIgA05FBEAgAkEBdCABaiAHaiAFOwEIIAJBAWohAgwBCwsgBgssAQF/AkACQAJAIwRBAWsOAwEBAgALAAtB/////wchAQsgAEGACEEAIAEQFwvBAQECfyAAQQIQBjYCACAAKAIAIgEoAgAgASgCBGpBgAg7AQggACgCACICKAIAIQEgAigCBCABQQJqakGACDsBCCAAKAIMKAIAQQEkBBAYGkEAIQIDQCACQRBIBEAgAiAAKAIEKAIAIgEoAgBBAnZJBH8gAkECdCABaigCCAUACygCAEEBJAQQGBogAiAAKAIIKAIAIgEoAgBBAnZJBH8gAkECdCABaigCCAUACygCAEEBJAQQGBogAkEBaiECDAELCwuHAgEFfyAAIQJBgAYgACgCDCAALQAUanQhAQNAIAMgAUgEQCACKAIgIgQoAgAhBSAEKAIEIANBAXQgBWpqQYAIOwEIIANBAWohAwwBCwsgAiEBQQAhAgNAIAJBBEkEQCACIAEoAiQoAgAiAygCAEECdkkEfyACQQJ0IANqKAIIBQALKAIAQQEkBBAYGiACQQFqIQIMAQsLIAEoAigoAgBBASQEEBgaIAEoAixBASQEEBgaIAAoAjBBASQEEBgaIAAoAjRBASQEEBgaIAAoAjhBASQEEBgaIAAoAjxBASQEEBgaIAAoAkBBASQEEBgaIAAoAkRBASQEEBgaIAAoAkgQGSAAKAJMEBkLyAwBA38DQCABQQNxIAIgAhsEQCAAIgRBAWohACABIgNBAWohASAEIAMtAAA6AAAgAkEBayECDAELCyAAQQNxRQRAA0AgAkEQTwRAIAAgASgCADYCACAAQQRqIAFBBGooAgA2AgAgAEEIaiABQQhqKAIANgIAIABBDGogAUEMaigCADYCACABQRBqIQEgAEEQaiEAIAJBEGshAgwBCwsgAkEIcQRAIAAgASgCADYCACAAQQRqIAFBBGooAgA2AgAgAUEIaiEBIABBCGohAAsgAkEEcQRAIAAgASgCADYCACABQQRqIQEgAEEEaiEACyACQQJxBEAgACABLwEAOwEAIAFBAmohASAAQQJqIQALIAJBAXEEQCAAIAEtAAA6AAALDwsgAkEgTwRAAkACQAJAIABBA3EiA0EBRwRAIANBAkYNASADQQNGDQIMAwsgASgCACEFIAAgASIDLQAAOgAAIABBAWoiASABIANBAWoiAS0AADoAAEEBaiIEQQFqIQAgAUEBaiIDQQFqIQEgBCADLQAAOgAAIAJBA2shAgNAIAJBEU8EQCAAIAFBAWooAgAiA0EIdCAFQRh2cjYCACAAQQRqIAFBBWooAgAiBUEIdCADQRh2cjYCACAAQQhqIAFBCWooAgAiA0EIdCAFQRh2cjYCACAAQQxqIAFBDWooAgAiBUEIdCADQRh2cjYCACABQRBqIQEgAEEQaiEAIAJBEGshAgwBCwsMAgsgASgCACEFIAAgAS0AADoAACAAQQFqIgRBAWohACABQQFqIgNBAWohASAEIAMtAAA6AAAgAkECayECA0AgAkESTwRAIAAgAUECaigCACIDQRB0IAVBEHZyNgIAIABBBGogAUEGaigCACIFQRB0IANBEHZyNgIAIABBCGogAUEKaigCACIDQRB0IAVBEHZyNgIAIABBDGogAUEOaigCACIFQRB0IANBEHZyNgIAIAFBEGohASAAQRBqIQAgAkEQayECDAELCwwBCyABKAIAIQUgACIEQQFqIQAgASIDQQFqIQEgBCADLQAAOgAAIAJBAWshAgNAIAJBE08EQCAAIAFBA2ooAgAiA0EYdCAFQQh2cjYCACAAQQRqIAFBB2ooAgAiBUEYdCADQQh2cjYCACAAQQhqIAFBC2ooAgAiA0EYdCAFQQh2cjYCACAAQQxqIAFBD2ooAgAiBUEYdCADQQh2cjYCACABQRBqIQEgAEEQaiEAIAJBEGshAgwBCwsLCyACQRBxBEAgACABIgMtAAA6AAAgAEEBaiIBIAEgA0EBaiIBLQAAOgAAQQFqIgMgAyABQQFqIgEtAAA6AABBAWoiAyADIAFBAWoiAS0AADoAAEEBaiIDIAMgAUEBaiIBLQAAOgAAQQFqIgMgAyABQQFqIgEtAAA6AABBAWoiAyADIAFBAWoiAS0AADoAAEEBaiIDIAMgAUEBaiIBLQAAOgAAQQFqIgMgAyABQQFqIgEtAAA6AABBAWoiAyADIAFBAWoiAS0AADoAAEEBaiIDIAMgAUEBaiIBLQAAOgAAQQFqIgMgAyABQQFqIgEtAAA6AABBAWoiAyADIAFBAWoiAS0AADoAAEEBaiIDIAMgAUEBaiIBLQAAOgAAQQFqIgMgAyABQQFqIgEtAAA6AABBAWoiBEEBaiEAIAFBAWoiA0EBaiEBIAQgAy0AADoAAAsgAkEIcQRAIAAgASIDLQAAOgAAIABBAWoiASABIANBAWoiAS0AADoAAEEBaiIDIAMgAUEBaiIBLQAAOgAAQQFqIgMgAyABQQFqIgEtAAA6AABBAWoiAyADIAFBAWoiAS0AADoAAEEBaiIDIAMgAUEBaiIBLQAAOgAAQQFqIgMgAyABQQFqIgEtAAA6AABBAWoiBEEBaiEAIAFBAWoiA0EBaiEBIAQgAy0AADoAAAsgAkEEcQRAIAAgASIDLQAAOgAAIABBAWoiASABIANBAWoiAS0AADoAAEEBaiIDIAMgAUEBaiIBLQAAOgAAQQFqIgRBAWohACABQQFqIgNBAWohASAEIAMtAAA6AAALIAJBAnEEQCAAIAEtAAA6AAAgAEEBaiIEQQFqIQAgAUEBaiIDQQFqIQEgBCADLQAAOgAACyACQQFxBEAgACABLQAAOgAACwvVAgECfyAAIAFGBEAPCyABIAJqIABNIgNFBEAgACACaiABTSEDCyADBEAgACABIAIQGw8LIAAgAUkEQCABQQdxIABBB3FGBEADQCAAQQdxBEAgAkUEQA8LIAJBAWshAiAAIgRBAWohACABIgNBAWohASAEIAMtAAA6AAAMAQsLA0AgAkEITwRAIAAgASkDADcDACACQQhrIQIgAEEIaiEAIAFBCGohAQwBCwsLA0AgAgRAIAAiBEEBaiEAIAEiA0EBaiEBIAQgAy0AADoAACACQQFrIQIMAQsLBSABQQdxIABBB3FGBEADQCAAIAJqQQdxBEAgAkUEQA8LIAJBAWsiAiAAaiABIAJqLQAAOgAADAELCwNAIAJBCE8EQCACQQhrIgIgAGogASACaikDADcDAAwBCwsLA0AgAgRAIAJBAWsiAiAAaiABIAJqLQAAOgAADAELCwsL4AoBCH8gACgCACIGIgQoAgAgBCgCBGovAQgiCCABIgcoAgxBC3ZsIQQgBygCECAESQR/QYAQIAhrQf//A3FBBXYgCGohCCAHIAQ2AgxBAAUgCCAIQf//A3FBBXZrIQggByAHKAIQIARrNgIQIAcgBygCDCAEazYCDEEBCyAGKAIEIAYoAgBqIAg7AQggByIFKAIMIwJJBEAgBSAFKAIMQQh0NgIMIAUoAhBBCHQhByAFKAIAIQYgBSAFKAIIIglBAWo2AgggBSAGIAkQEUH/AXEgB3I2AhALQf//A3FFBEAgAiAAKAIEKAIAIgAoAgBBAnZJBH8gAkECdCAAaigCCAUACyEDIAEhBEEBIQgDQCAKIAMoAgRJBEAgAygCACIHKAIAIQEgBCgCECAHKAIEIAgiBUEBdCIIIAFqai8BCCIGIAQoAgxBC3ZsIglJBH9BgBAgBmtB//8DcUEFdiAGaiEGIAQgCTYCDEEABSAGIAZB//8DcUEFdmshBiAEIAQoAhAgCWs2AhAgBCAEKAIMIAlrNgIMQQELIAcoAgQgBygCACAFQQF0amogBjsBCCAEKAIMIwJJBEAgBCAEKAIMQQh0NgIMIAQoAhBBCHQhACAEKAIAIQUgBCAEKAIIIgFBAWo2AgggBCAFIAEQEUH/AXEgAHI2AhALQf//A3EgCGohCCAKQQFqIQoMAQsLIAhBASADKAIEdGsPCyAAKAIAIgooAgAhCCAFKAIQIAooAgQgCEECamovAQgiBCABKAIMQQt2bCIDSQR/IAUgAzYCDEEAIQlBgBAgBGtB//8DcUEFdiAEagUgBSAFKAIQIANrNgIQIAUgBSgCDCADazYCDEEBIQkgBCAEQf//A3FBBXZrCyEEIAoiBygCBCAHKAIAQQJqaiAEOwEIIAUiBigCDCMCSQRAIAYgBigCDEEIdDYCDCAGKAIQQQh0IQUgBigCACEHIAYgBigCCCIIQQFqNgIIIAYgByAIEBFB/wFxIAVyNgIQCyAJQf//A3FFBEAgAiAAKAIIKAIAIgAoAgBBAnZJBH8gAkECdCAAaigCCAUACyEJIAEhA0EBIQRBACECA0AgAiAJKAIESQRAIAMoAhAgCSgCACIFKAIEIAQiBkEBdCIEIAUoAgBqai8BCCIHIAMoAgxBC3ZsIghJBH9BgBAgB2tB//8DcUEFdiAHaiEHIAMgCDYCDEEABSAHIAdB//8DcUEFdmshByADIAMoAhAgCGs2AhAgAyADKAIMIAhrNgIMQQELIAUoAgQgBSgCACAGQQF0amogBzsBCCADKAIMIwJJBEAgAyADKAIMQQh0NgIMIAMoAhBBCHQhBSADKAIAIQcgAyADKAIIIgZBAWo2AgggAyAHIAYQEUH/AXEgBXI2AhALQf//A3EgBGohBCACQQFqIQIMAQsLIARBASAJKAIEdGtBCGoPCyAAKAIMIQQgASEDQQEhCUEAIQIDQCACIAQoAgRJBEAgBCgCACIIKAIAIQogAygCECAIKAIEIAogCSIHQQF0IgFqai8BCCIFIAMoAgxBC3ZsIgZJBH8gAyAGNgIMQQAhBkGAECAFa0H//wNxQQV2IAVqBSADIAMoAhAgBms2AhAgAyADKAIMIAZrNgIMQQEhBiAFIAVB//8DcUEFdmsLIQUgCCgCBCAIKAIAIAdBAXRqaiAFOwEIIAMoAgwjAkkEQCADIAMoAgxBCHQ2AgwgAygCEEEIdCEAIAMoAgAhBSADIAMoAggiCkEBajYCCCADIAUgChARQf8BcSAAcjYCEAsgBkH//wNxIAFqIQkgAkEBaiECDAELCyAJQQEgBCgCBHRrQRBqC5YCAQh/QQEhBwNAAkAgBiABTg0AIAIoAhAgACgCBCAAKAIAIAMgB2oiCUEBdGpqLwEIIgQgAigCDEELdmwiBUkEfyACIAU2AgxBACEFQYAQIARrQf//A3FBBXYgBGoFIAIgAigCECAFazYCECACIAIoAgwgBWs2AgxBASEFIAQgBEH//wNxQQV2awshBCAAKAIEIAAoAgAgCUEBdGpqIAQ7AQggAiIEKAIMIwJJBEAgBCAEKAIMQQh0NgIMIAQoAhBBCHQhCiAEKAIAIQsgBCAEKAIIIglBAWo2AgggBCALIAkQEUH/AXEgCnI2AhALIAVB//8DcSIEIAdBAXRqIQcgBCAGdCAIciEIIAZBAWohBgwBCwsgCAvwBAEIf0EDIAEgAUEDSxsiAiAAKAIkKAIAIgEoAgBBAnZJBH8gAkECdCABaigCCAUACyEEIAAoAgQhAkEBIQEDQCAHIAQoAgRJBEAgBCgCACIFKAIAIQMgAigCECAFKAIEIAFBAXQiCSADamovAQgiAyACKAIMQQt2bCIGSQR/IAIgBjYCDEEAIQhBgBAgA2tB//8DcUEFdiADagUgAiACKAIQIAZrNgIQIAIgAigCDCAGazYCDEEBIQggAyADQf//A3FBBXZrCyEDIAUoAgQgBSgCACABQQF0amogAzsBCCACKAIMIwJJBEAgAiACKAIMQQh0NgIMIAIoAhBBCHQhBiACKAIAIQUgAiACKAIIIgNBAWo2AgggAiAFIAMQEUH/AXEgBnI2AhALIAhB//8DcSAJaiEBIAdBAWohBwwBCwsgAUEBIAQoAgR0ayIBQQRJBEAgAQ8LIAFBAXFBAnIgAUEBdkEBayICdCEDIAFBDkkEfyAAKAIsIAIgACgCBCADIAFrEB4gA2oFIAAoAgQhASACQQRrIQJBACEEA0AgASABKAIMQQF2NgIMIAEgASgCECABKAIMazYCECABIAEoAhBBACABKAIQQR92ayIHIAEoAgxxajYCECABKAIQIAEoAgxGBEAgAUEBOgAECyABKAIMIwJJBEAgASABKAIMQQh0NgIMIAEoAhBBCHQhBSABKAIAIQggASABKAIIIgZBAWo2AgggASAIIAYQEUH/AXEgBXI2AhALIAdBAWogBEEBdGohBCACQQFrIgINAAsgBEEEdCADaiAAKAIoIgQoAgAgBCgCBCAAKAIEQQAQHmoLC9AcAQ9/IAAQGiAAKAIEIgdBADoABCAHKAIAIAcgBygCCCIDQQFqNgIIIAMQEUH/AXEEQCAHQQE6AAQLIAdBfzYCDCAHQQA2AhBBACEDA0AgA0EESARAIAcoAhBBCHQhBSAHKAIAIQwgByAHKAIIIghBAWo2AgggByAMIAgQEUH/AXEgBXI2AhAgA0EBaiEDDAELCyAHKAIQIAcoAgxGBEAgB0EBOgAECyABBEAgACgCCCACEA82AgQFIAAoAghBBBAPNgIEC0EAIQwDQAJAIAJFIAEgARsiBwR/IAAtAABFBSAHCwRAIAAoAgQoAhBFBEBBAw8LCyAAKAIwIgUoAgAhByAFKAIEIAAoAggoAgBBASAAKAIQdEEBa3EiCyAMQQR0Qf8BcWoiBkEBdCAHamovAQghAyAGIQcgACgCBCIEKAIMQQt2IANsIQggBCgCECAISQR/IAQgCDYCDEEAIQlBgBAgA2tB//8DcUEFdiADagUgBCAEKAIQIAhrNgIQIAQgBCgCDCAIazYCDEEBIQkgAyADQf//A3FBBXZrCyEIIAUiAygCBCADKAIAIAdBAXRqaiAIOwEIIAQiBigCDCMCSQRAIAYgBigCDEEIdDYCDCAGKAIQQQh0IQggBigCACEDIAYgBigCCCIHQQFqNgIIIAYgAyAHEBFB/wFxIAhyNgIQCyAJQf//A3FFBEAgAkUgASABGw0BIAwhCEEAIQYgACgCCCIFKAIMRSIEBH8gBS0AGEUFIAQLRQRAIAAoAggiBSgCCCIGKAIEQQEgBSgCDEwEfyAFKAIMQQFrBSAFKAIMIAUoAhRBAWtqCyAGKAIAamotAAghBgtBASEEIAAoAggoAgBBASAALQAUdEEBa3EgACgCDHQgBkEIIAAoAgxrdmpBgAZsIQcgCEEHTwRAIAAoAggiBigCCCIJKAIEIA5BAWoiDSAGKAIMTAR/IAYoAgwgDWsFIAYoAgwgBigCFCANa2oLIAkoAgBqai0ACCENA0ACQCANQf8BcUEHdiEGIA1BAXQhDSAAKAIgIgkoAgAhCyAJKAIEIAZBAWpBCHQgB2ogBGoiDEEBdCALamovAQgiCyAAKAIEIgMoAgxBC3ZsIQogAygCECAKSQR/QYAQIAtrQf//A3FBBXYgC2ohCyADIAo2AgxBAAUgCyALQf//A3FBBXZrIQsgAyADKAIQIAprNgIQIAMgAygCDCAKazYCDEEBCyEFIAkoAgQgCSgCACAMQQF0amogCzsBCCADIgooAgwjAkkEQCAKIAooAgxBCHQ2AgwgCigCEEEIdCEDIAooAgAhDCAKIAooAggiC0EBajYCCCAKIAwgCxARQf8BcSADcjYCEAsgBEEBdCAFciEEIAVB//8DcSAGRw0AIARB//8DcUGAAkkNAQsLCwNAIARBgAJJBEAgBEEBdCEJIAAoAiAiBSgCACEMIAUoAgQgBCAHaiIGQQF0IAxqai8BCCILIAAoAgQiDSgCDEELdmwhCiANKAIQIApJBH9BgBAgC2tB//8DcUEFdiALaiELIA0gCjYCDEEABSALIAtB//8DcUEFdmshCyANIA0oAhAgCms2AhAgDSANKAIMIAprNgIMQQELIAUoAgQgBSgCACAGQQF0amogCzsBCCANIgooAgwjAkkEQCAKIAooAgxBCHQ2AgwgCigCEEEIdCEGIAooAgAhBSAKIAooAggiDEEBajYCCCAKIAUgDBARQf8BcSAGcjYCEAsgCXIhBAwBCwsgACgCCCIDIAMoAgBBAWo2AgAgAygCCCELIAMgAygCDCIGQQFqNgIMIAsoAgQgCygCACAGamogBEGAAmsiCjoACCADKAIMIAMoAhRGBEAgA0EANgIMIANBAToAGAsgAygCBCgCCCADKAIQRgRAIAMgAygCBCIGKAIIQQF0EA82AgQgAygCBCgCACADKAIEKAIEakEIaiAGKAIAIAYoAgRqQQhqIAYoAggQHCAGKAIAGgsgAygCBCEJIAMgAygCECIMQQFqNgIQIAkoAgQgCSgCACAMamogCjoACCAIIgVBBEkEf0EABSAFQQNrIAVBBmsgBUEKSRsLIQwgAkEBayECDAILIAAoAjQiBigCACEFIAYoAgQgDCIDQQF0IAVqai8BCCIHIAAoAgQiCigCDEELdmwhBCAKKAIQIARJBH9BgBAgB2tB//8DcUEFdiAHaiEHIAogBDYCDEEABSAHIAdB//8DcUEFdmshByAKIAooAhAgBGs2AhAgCiAKKAIMIARrNgIMQQELIAMhBSAGIgMoAgAhDSADKAIEIAVBAXQgDWpqIAc7AQggCiIJKAIMIwJJBEAgCSAJKAIMQQh0NgIMIAkoAhBBCHQhBiAJKAIAIQMgCSAJKAIIIgVBAWo2AgggCSADIAUQEUH/AXEgBnI2AhALQf//A3EEQCACRSABIAEbDQEgACgCCCIIKAIMRSIEBH8gCC0AGEUFIAQLDQEgACgCOCIDKAIAIQggAygCBCAMQQF0IAhqai8BCCIEIAAoAgQiBSgCDEELdmwhByAFKAIQIAdJBH9BgBAgBGtB//8DcUEFdiAEaiEEIAUgBzYCDEEABSAEIARB//8DcUEFdmshBCAFIAUoAhAgB2s2AhAgBSAFKAIMIAdrNgIMQQELIAMoAgQgAygCACAMQQF0amogBDsBCCAFIgkoAgwjAkkEQCAJIAkoAgxBCHQ2AgwgCSgCEEEIdCEFIAkoAgAhAyAJIAkoAggiCEEBajYCCCAJIAMgCBARQf8BcSAFcjYCEAtB//8DcQRAIAAoAjwiCCgCACEHIAgoAgQgDEEBdCAHamovAQgiBCAAKAIEIgUoAgxBC3ZsIQYgBSgCECAGSQR/QYAQIARrQf//A3FBBXYgBGohBCAFIAY2AgxBAAUgBCAEQf//A3FBBXZrIQQgBSAFKAIQIAZrNgIQIAUgBSgCDCAGazYCDEEBCyAIIgMoAgQgAygCACAMQQF0amogBDsBCCAFIgkoAgwjAkkEQCAJIAkoAgxBCHQ2AgwgCSgCEEEIdCEIIAkoAgAhAyAJIAkoAggiB0EBajYCCCAJIAMgBxARQf8BcSAIcjYCEAtB//8DcQRAIAAoAkAiAygCACEKIAMoAgQgDEEBdCAKamovAQgiBiAAKAIEIgcoAgxBC3ZsIQQgBygCECAESQR/QYAQIAZrQf//A3FBBXYgBmohBiAHIAQ2AgxBAAUgBiAGQf//A3FBBXZrIQYgByAHKAIQIARrNgIQIAcgBygCDCAEazYCDEEBCyADKAIEIAMoAgAgDEEBdGpqIAY7AQggByIJKAIMIwJJBEAgCSAJKAIMQQh0NgIMIAkoAhBBCHQhCCAJKAIAIQMgCSAJKAIIIgpBAWo2AgggCSADIAoQEUH/AXEgCHI2AhALQf//A3EEQCARIQMgDyERBSAPIQMLIBAhDwUgECEDCyAOIRAgAyEOBSAAKAJEIgYoAgAhCiAGKAIEIAxBBHRB/wFxIAtqIgNBAXQgCmpqLwEIIgcgACgCBCIIKAIMQQt2bCEEIAgoAhAgBEkEf0GAECAHa0H//wNxQQV2IAdqIQcgCCAENgIMQQAFIAcgB0H//wNxQQV2ayEHIAggCCgCECAEazYCECAIIAgoAgwgBGs2AgxBAQsgAyEKIAYiAygCACENIAMoAgQgCkEBdCANamogBzsBCCAIIgkoAgwjAkkEQCAJIAkoAgxBCHQ2AgwgCSgCEEEIdCEIIAkoAgAhAyAJIAkoAggiCkEBajYCCCAJIAMgChARQf8BcSAIcjYCEAtB//8DcUUEQEEJQQsgDEEHSRshDCAAKAIIIQQgACgCCCIFKAIIIgMoAgQgDkEBaiIHIAUoAgxMBH8gBSgCDCAHawUgBSgCDCAFKAIUIAdragsgAygCAGpqLQAIIQcgBCAEKAIAQQFqNgIAIAQoAgghBSAEIAQoAgwiBkEBajYCDCAFKAIEIAUoAgAgBmpqIAc6AAggBCgCDCAEKAIURgRAIARBADYCDCAEQQE6ABgLIAQoAgQoAgggBCgCEEYEQCAEIAQoAgQiBigCCEEBdBAPNgIEIAQoAgQoAgAgBCgCBCgCBGpBCGogBigCACAGKAIEakEIaiAGKAIIEBwgBigCABoLIAQoAgQhAyAEIAQoAhAiCEEBajYCECADKAIEIAMoAgAgCGpqIAc6AAggAkEBayECDAQLCyAAKAJMIAAoAgQgCxAdIQtBCEELIAxBB0kbIQwFIA8hESAQIQ8gDiEQQQdBCiAMQQdJGyEMIAAgACgCSCAAKAIEIAsQHSILEB8iDkF/RgRAIAAoAgQoAhAEf0EBBUECCw8LIAJFIAEgARsNASAOIAAoAhhPIgUEfyAFBSAOIAAoAggiBCgCDEwiBgR/IAYFIAQtABgLRQsNAQtBACENIAAoAgghBSAOQQFqIQQgAiALQQJqIgtIIAEgARsEQEEBIQ0gAiELCyALIQYDQCAGQQBKBEAgBSIIKAIIIgkoAgQgBCAFKAIMTAR/IAUoAgwgBGsFIAUoAgwgBSgCFCAEa2oLIAkoAgBqai0ACCEHIAggCCgCAEEBajYCACAIKAIIIQMgCCAIKAIMIgpBAWo2AgwgAygCBCADKAIAIApqaiAHOgAIIAgoAgwgCCgCFEYEQCAIQQA2AgwgCEEBOgAYCyAIKAIEKAIIIAgoAhBGBEAgCCAIKAIEIgMoAghBAXQQDzYCBCAIKAIEKAIAIAgoAgQoAgRqQQhqIAMoAgAgAygCBGpBCGogAygCCBAcIAMoAgAaCyAIKAIEIQkgCCAIKAIQIgNBAWo2AhAgCSgCBCAJKAIAIANqaiAHOgAIIAZBAWshBgwBCwsgAiALayECIA1FDQELC0EBCyYBAX9BEBABIgQgADYCACAEIAE2AgQgBCACNgIIIAQgAzYCDCAEC7YEAQZ/IAAgATYCBEENEA8hAgNAAkAgA0ENTg0AIAIgAyABIAMQEUH/AXEQEiADQQFqIQMMAQsLIAAoAgAhBCACIQZBBBAPIgIoAgQgAigCAGogBigCBCAGKAIAai0ACCIDOgAIIANB/wFxQeEBTwRAQQBBgAFBoQFBDBAAAAsgAigCBCACKAIAQQFqaiADQf8BcUEJcCIHOgAIIAIoAgQgAigCAGogA0H/AXFBCW4iAzoACCADQQVwIQUgAigCBCACKAIAQQJqaiADQQVuIgM6AAggAigCBCACKAIAQQNqaiAFOgAIIAQgBzYCDCAEIAM2AhAgBCAFOgAUIARBADYCHEEAIQIDQAJAIAJBBE8NACAEIAQoAhwgBigCBCAGKAIAIAJBAWpqai0ACCACQQN0dHI2AhwgAkEBaiECDAELCyAEIAQoAhw2AhggBCgCGEGAIEkEQCAEQYAgNgIYC0EAIQJBACEFQQAhAwNAAkAgA0EITg0AIAYgA0EFahARQf8BcSIEQf8BRwRAQQEhBQsgBCADQQN0dCACciECIANBAWohAwwBCwsgACgCACAFRToAACAAKAIAKAIEIAE2AgAgACgCABAWAkAgACgCACAFIAIQICIBQQFGDQAgAUEDRwRAIAFBAkYEQCAFBEAgACgCACgCCCgCECACRw0DCwUMAgsLIAAoAgAoAgQtAAQaQQFBACAAKAIAKAIIKAIQIAAoAgAoAggoAgQQIQ8LQQBBAUEAQQAQIQsIACMDIAAQIgsWAEG4ASQAIwAkAUGAgIAIJAIQDCQDCwMAAQsLtwEEAEEICxcKAAAAdQBzAGUAIABzAHQAcgBpAGMAdABBIAsdDQAAAH4AbABpAGIALwBhAHIAcgBhAHkALgB0AHMAQcAACzkbAAAAfgBsAGkAYgAvAGkAbgB0AGUAcgBuAGEAbAAvAHQAeQBwAGUAZABhAHIAcgBhAHkALgB0AHMAQYABCzMYAAAAcwByAGMALwBsAHoAbQBhAC8AbAB6AG0AYQAtAGQAZQBjAG8AZABlAHIALgB0AHM=";return $e(Se)}function decodeLZMA($e,Se,Be){try{var De={data:Se,offset:0,readByte:function(){return this.data[this.offset++]}},Ve=De.data.length,Fe={data:[],offset:0,writeByte:function(Ke){var Ye=Math.floor(this.offset/Ve);this.data[Ye]||(this.data[Ye]=new Uint8Array(Ve)),this.data[Ye][this.offset%Ve]=Ke,this.offset++}};$e.decompressFile(De,Fe);for(var Je=new Uint8Array(Fe.offset),Xe=0;Xe<Fe.offset;Xe++)Je[Xe]=Fe.data[Math.floor(Xe/Ve)][Xe%Ve];Be(null,Je)}catch(Ke){Be(Ke)}}function decodeLZMAWithWASM($e,Se,Be){var De=24;try{var Ve=new WebAssembly.Memory({initial:16}),Fe=new WebAssembly.Module($e),Je=new WebAssembly.Instance(Fe,{env:{memory:Ve,abort:function(){Be(new Error("webAssembly abort"))}}}),Xe=Je.exports,Ke=Xe.newU8Array(Se.length),Ye=new Uint8Array(Ve.buffer,Ke+De,Se.length);Ye.set(Se);var or=Xe.decode(Ke),sr=new Uint32Array(Ve.buffer,or,4),cr=sr[0],Br=sr[2],tn=sr[3];cr?Be(null,new Uint8Array(Ve.buffer,tn+De,Br).slice(0,Br)):Be(new Error("lzma deocder error"))}catch(en){Be(en)}}var lzmaWorkerSource=`
var decodeLZMA = (function() {
  var LZMA = (`.concat(createLZMA.toString(),`)();
  return function(data, callback) {
    return (`).concat(decodeLZMA.toString(),`)(LZMA, data, callback);
  }
})();

var decodeLZMAWithWASM = (function() {
  var LZMA_WASM = (`).concat(createWASM.toString(),`)();
  return function(data, callback) {
    return (`).concat(decodeLZMAWithWASM.toString(),`)(LZMA_WASM, data, callback);
  }
})();

self.onmessage = function(event) {
  var packet = event.data;
  if (!packet.id) {
    postMessage({ id: packet.id, error: "No incoming id." });
    return;
  }
  if (!packet.data) {
    postMessage({ id: packet.id, error: "No input data." });
    return;
  }
  if (packet.type == "decompress") {
    if (packet.data.constructor !== Uint8Array) {
      postMessage({ id: packet.id, error: "Input data is not Uint8Array." });
    }
    const callback = function(error, result) {
      if (error) {
        postMessage({ id: packet.id, error: error.toString() });
      } else {
        postMessage({ id: packet.id, result: result, error: null }, [ result.buffer ]);
      }
    }
    if (typeof WebAssembly !== "undefined" && WebAssembly.instantiate) {
      decodeLZMAWithWASM(packet.data, callback);
    } else {
      decodeLZMA(packet.data, callback);
    }
    return;
  }
  postMessage({ id: packet.id, error: "type never matched." });
};
`),support=typeof Worker<"u"&&typeof Blob<"u",lzmaWorkerURL="";if(support)try{var blob=new Blob([lzmaWorkerSource],{type:"text/javascript"});lzmaWorkerURL=URL.createObjectURL(blob)}catch{}var LZMAWorker=function(){function $e(){var Se=this;if(!support)throw new Error("LZMAWorker cannot work in this broswer.");this.callCounter=0,this.requests={};var Be=this.worker=new Worker(lzmaWorkerURL);Be.onmessage=function(De){var Ve=De.data,Fe=Ve.id,Je=Ve.result,Xe=Ve.error,Ke=Se.getKey(Fe);Se.requests[Ke]&&(Xe?Se.requests[Ke](new Error(Xe)):Se.requests[Ke](null,Je),delete Se.requests[Ke])},Be.onerror=function(De){return console.error(De)}}return $e.prototype.getKey=function(Se){return"key_"+String(Se)},$e.prototype.decompress=function(Se,Be){var De=++this.callCounter;this.requests[this.getKey(De)]=Be,this.worker.postMessage({type:"decompress",id:De,data:Se},[Se.buffer])},$e.prototype.terminate=function(){this.worker.terminate()},$e.support=support,$e}();function readUint32($e){return Array.prototype.reduce.call($e,function(Se,Be,De){return Se|Be<<De*8},0)}function binaryArrays($e){for(var Se=[],Be=$e.length,De=function(Je){var Xe={data:$e[Je],offset:0,readByte:function(){return this.data[this.offset++]}},Ke=Xe.data.length,Ye={data:[],offset:0,writeByte:function(sr){var cr=Math.floor(this.offset/Ke);this.data[cr]||(this.data[cr]=new Uint8Array(Ke)),this.data[cr][this.offset%Ke]=sr,this.offset++}};LZMA.decompressFile(Xe,Ye),Ve=new Uint8Array(Ye.offset);for(var or=0;or<Ye.offset;or++)Ve[or]=Ye.data[Math.floor(or/Ke)][or%Ke];Se.push(Ve)},Ve,Fe=0;Fe<Be;Fe++)De(Fe);return Se}function binaryArraysWithWorker($e){for(var Se=[],Be=$e.length,De=function(Fe){Se.push(new Promise(function(Je,Xe){var Ke=new LZMAWorker;Ke.decompress($e[Fe],function(Ye,or){if(Ke.terminate(),Ye)return Xe(Ye);Je(or)})}))},Ve=0;Ve<Be;Ve++)De(Ve);return Promise.all(Se)}function lzma($e){var Se=new Uint8Array($e),Be=readUint32(Se.slice(0,4));if(Be>10)return Promise.reject(new Error("LZMA got too many sub chunks."));for(var De=[],Ve=[],Fe=4+Be*4,Je=0;Je<Be;Je++)Ve[Je]=readUint32(Se.slice(4+Je*4,8+Je*4)),Je===Be-1?De[Je]=Se.subarray(Fe,Fe+Ve[Je]):De[Je]=Se.slice(Fe,Fe+Ve[Je]),Fe+=Ve[Je];return LZMAWorker.support?binaryArraysWithWorker(De):Promise.resolve(binaryArrays(De))}var dequeuing=!1,queue=[];function dequeue($e){if($e===void 0&&($e=!1),!(!$e&&dequeuing)){dequeuing=!0;var Se=queue.shift();if(Se){try{Se()}catch{}AnimationFrameLoop.shared.add(function(){return dequeue(!0)},!0,2,-100)}else dequeuing=!1}}function delay($e){return new Promise(function(Se,Be){var De=function(){try{Se($e())}catch(Ve){Be(Ve)}};queue.push(De),AnimationFrameLoop.shared.add(function(){return dequeue()},!0,2,-100)})}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise($e,Se){for(var Be=new Array(arguments.length-1),De=0,Ve=2,Fe=!0;Ve<arguments.length;)Be[De++]=arguments[Ve++];return new Promise(function(Je,Xe){Be[De]=function(Ke){if(Fe)if(Fe=!1,Ke)Xe(Ke);else{for(var Ye=new Array(arguments.length-1),or=0;or<Ye.length;)Ye[or++]=arguments[or];Je.apply(null,Ye)}};try{$e.apply(Se||null,Be)}catch(Ke){Fe&&(Fe=!1,Xe(Ke))}})}var base64$1={};(function($e){var Se=$e;Se.length=function(Je){var Xe=Je.length;if(!Xe)return 0;for(var Ke=0;--Xe%4>1&&Je.charAt(Xe)==="=";)++Ke;return Math.ceil(Je.length*3)/4-Ke};for(var Be=new Array(64),De=new Array(123),Ve=0;Ve<64;)De[Be[Ve]=Ve<26?Ve+65:Ve<52?Ve+71:Ve<62?Ve-4:Ve-59|43]=Ve++;Se.encode=function(Je,Xe,Ke){for(var Ye=null,or=[],sr=0,cr=0,Br;Xe<Ke;){var tn=Je[Xe++];switch(cr){case 0:or[sr++]=Be[tn>>2],Br=(tn&3)<<4,cr=1;break;case 1:or[sr++]=Be[Br|tn>>4],Br=(tn&15)<<2,cr=2;break;case 2:or[sr++]=Be[Br|tn>>6],or[sr++]=Be[tn&63],cr=0;break}sr>8191&&((Ye||(Ye=[])).push(String.fromCharCode.apply(String,or)),sr=0)}return cr&&(or[sr++]=Be[Br],or[sr++]=61,cr===1&&(or[sr++]=61)),Ye?(sr&&Ye.push(String.fromCharCode.apply(String,or.slice(0,sr))),Ye.join("")):String.fromCharCode.apply(String,or.slice(0,sr))};var Fe="invalid encoding";Se.decode=function(Je,Xe,Ke){for(var Ye=Ke,or=0,sr,cr=0;cr<Je.length;){var Br=Je.charCodeAt(cr++);if(Br===61&&or>1)break;if((Br=De[Br])===void 0)throw Error(Fe);switch(or){case 0:sr=Br,or=1;break;case 1:Xe[Ke++]=sr<<2|(Br&48)>>4,sr=Br,or=2;break;case 2:Xe[Ke++]=(sr&15)<<4|(Br&60)>>2,sr=Br,or=3;break;case 3:Xe[Ke++]=(sr&3)<<6|Br,or=0;break}}if(or===1)throw Error(Fe);return Ke-Ye},Se.test=function(Je){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(Je)}})(base64$1);var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function($e,Se,Be){return(this._listeners[$e]||(this._listeners[$e]=[])).push({fn:Se,ctx:Be||this}),this};EventEmitter.prototype.off=function($e,Se){if($e===void 0)this._listeners={};else if(Se===void 0)this._listeners[$e]=[];else for(var Be=this._listeners[$e],De=0;De<Be.length;)Be[De].fn===Se?Be.splice(De,1):++De;return this};EventEmitter.prototype.emit=function($e){var Se=this._listeners[$e];if(Se){for(var Be=[],De=1;De<arguments.length;)Be.push(arguments[De++]);for(De=0;De<Se.length;)Se[De].fn.apply(Se[De++].ctx,Be)}return this};var float=factory(factory);function factory($e){return typeof Float32Array<"u"?function(){var Se=new Float32Array([-0]),Be=new Uint8Array(Se.buffer),De=Be[3]===128;function Ve(Ke,Ye,or){Se[0]=Ke,Ye[or]=Be[0],Ye[or+1]=Be[1],Ye[or+2]=Be[2],Ye[or+3]=Be[3]}function Fe(Ke,Ye,or){Se[0]=Ke,Ye[or]=Be[3],Ye[or+1]=Be[2],Ye[or+2]=Be[1],Ye[or+3]=Be[0]}$e.writeFloatLE=De?Ve:Fe,$e.writeFloatBE=De?Fe:Ve;function Je(Ke,Ye){return Be[0]=Ke[Ye],Be[1]=Ke[Ye+1],Be[2]=Ke[Ye+2],Be[3]=Ke[Ye+3],Se[0]}function Xe(Ke,Ye){return Be[3]=Ke[Ye],Be[2]=Ke[Ye+1],Be[1]=Ke[Ye+2],Be[0]=Ke[Ye+3],Se[0]}$e.readFloatLE=De?Je:Xe,$e.readFloatBE=De?Xe:Je}():function(){function Se(De,Ve,Fe,Je){var Xe=Ve<0?1:0;if(Xe&&(Ve=-Ve),Ve===0)De(1/Ve>0?0:2147483648,Fe,Je);else if(isNaN(Ve))De(2143289344,Fe,Je);else if(Ve>34028234663852886e22)De((Xe<<31|2139095040)>>>0,Fe,Je);else if(Ve<11754943508222875e-54)De((Xe<<31|Math.round(Ve/1401298464324817e-60))>>>0,Fe,Je);else{var Ke=Math.floor(Math.log(Ve)/Math.LN2),Ye=Math.round(Ve*Math.pow(2,-Ke)*8388608)&8388607;De((Xe<<31|Ke+127<<23|Ye)>>>0,Fe,Je)}}$e.writeFloatLE=Se.bind(null,writeUintLE),$e.writeFloatBE=Se.bind(null,writeUintBE);function Be(De,Ve,Fe){var Je=De(Ve,Fe),Xe=(Je>>31)*2+1,Ke=Je>>>23&255,Ye=Je&8388607;return Ke===255?Ye?NaN:Xe*(1/0):Ke===0?Xe*1401298464324817e-60*Ye:Xe*Math.pow(2,Ke-150)*(Ye+8388608)}$e.readFloatLE=Be.bind(null,readUintLE),$e.readFloatBE=Be.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var Se=new Float64Array([-0]),Be=new Uint8Array(Se.buffer),De=Be[7]===128;function Ve(Ke,Ye,or){Se[0]=Ke,Ye[or]=Be[0],Ye[or+1]=Be[1],Ye[or+2]=Be[2],Ye[or+3]=Be[3],Ye[or+4]=Be[4],Ye[or+5]=Be[5],Ye[or+6]=Be[6],Ye[or+7]=Be[7]}function Fe(Ke,Ye,or){Se[0]=Ke,Ye[or]=Be[7],Ye[or+1]=Be[6],Ye[or+2]=Be[5],Ye[or+3]=Be[4],Ye[or+4]=Be[3],Ye[or+5]=Be[2],Ye[or+6]=Be[1],Ye[or+7]=Be[0]}$e.writeDoubleLE=De?Ve:Fe,$e.writeDoubleBE=De?Fe:Ve;function Je(Ke,Ye){return Be[0]=Ke[Ye],Be[1]=Ke[Ye+1],Be[2]=Ke[Ye+2],Be[3]=Ke[Ye+3],Be[4]=Ke[Ye+4],Be[5]=Ke[Ye+5],Be[6]=Ke[Ye+6],Be[7]=Ke[Ye+7],Se[0]}function Xe(Ke,Ye){return Be[7]=Ke[Ye],Be[6]=Ke[Ye+1],Be[5]=Ke[Ye+2],Be[4]=Ke[Ye+3],Be[3]=Ke[Ye+4],Be[2]=Ke[Ye+5],Be[1]=Ke[Ye+6],Be[0]=Ke[Ye+7],Se[0]}$e.readDoubleLE=De?Je:Xe,$e.readDoubleBE=De?Xe:Je}():function(){function Se(De,Ve,Fe,Je,Xe,Ke){var Ye=Je<0?1:0;if(Ye&&(Je=-Je),Je===0)De(0,Xe,Ke+Ve),De(1/Je>0?0:2147483648,Xe,Ke+Fe);else if(isNaN(Je))De(0,Xe,Ke+Ve),De(2146959360,Xe,Ke+Fe);else if(Je>17976931348623157e292)De(0,Xe,Ke+Ve),De((Ye<<31|2146435072)>>>0,Xe,Ke+Fe);else{var or;if(Je<22250738585072014e-324)or=Je/5e-324,De(or>>>0,Xe,Ke+Ve),De((Ye<<31|or/4294967296)>>>0,Xe,Ke+Fe);else{var sr=Math.floor(Math.log(Je)/Math.LN2);sr===1024&&(sr=1023),or=Je*Math.pow(2,-sr),De(or*4503599627370496>>>0,Xe,Ke+Ve),De((Ye<<31|sr+1023<<20|or*1048576&1048575)>>>0,Xe,Ke+Fe)}}}$e.writeDoubleLE=Se.bind(null,writeUintLE,0,4),$e.writeDoubleBE=Se.bind(null,writeUintBE,4,0);function Be(De,Ve,Fe,Je,Xe){var Ke=De(Je,Xe+Ve),Ye=De(Je,Xe+Fe),or=(Ye>>31)*2+1,sr=Ye>>>20&2047,cr=4294967296*(Ye&1048575)+Ke;return sr===2047?cr?NaN:or*(1/0):sr===0?or*5e-324*cr:or*Math.pow(2,sr-1075)*(cr+4503599627370496)}$e.readDoubleLE=Be.bind(null,readUintLE,0,4),$e.readDoubleBE=Be.bind(null,readUintBE,4,0)}(),$e}function writeUintLE($e,Se,Be){Se[Be]=$e&255,Se[Be+1]=$e>>>8&255,Se[Be+2]=$e>>>16&255,Se[Be+3]=$e>>>24}function writeUintBE($e,Se,Be){Se[Be]=$e>>>24,Se[Be+1]=$e>>>16&255,Se[Be+2]=$e>>>8&255,Se[Be+3]=$e&255}function readUintLE($e,Se){return($e[Se]|$e[Se+1]<<8|$e[Se+2]<<16|$e[Se+3]<<24)>>>0}function readUintBE($e,Se){return($e[Se]<<24|$e[Se+1]<<16|$e[Se+2]<<8|$e[Se+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch($e){}return null}var utf8$2={};(function($e){var Se=$e;Se.length=function(Be){for(var De=0,Ve=0,Fe=0;Fe<Be.length;++Fe)Ve=Be.charCodeAt(Fe),Ve<128?De+=1:Ve<2048?De+=2:(Ve&64512)===55296&&(Be.charCodeAt(Fe+1)&64512)===56320?(++Fe,De+=4):De+=3;return De},Se.read=function(Be,De,Ve){var Fe=Ve-De;if(Fe<1)return"";for(var Je=null,Xe=[],Ke=0,Ye;De<Ve;)Ye=Be[De++],Ye<128?Xe[Ke++]=Ye:Ye>191&&Ye<224?Xe[Ke++]=(Ye&31)<<6|Be[De++]&63:Ye>239&&Ye<365?(Ye=((Ye&7)<<18|(Be[De++]&63)<<12|(Be[De++]&63)<<6|Be[De++]&63)-65536,Xe[Ke++]=55296+(Ye>>10),Xe[Ke++]=56320+(Ye&1023)):Xe[Ke++]=(Ye&15)<<12|(Be[De++]&63)<<6|Be[De++]&63,Ke>8191&&((Je||(Je=[])).push(String.fromCharCode.apply(String,Xe)),Ke=0);return Je?(Ke&&Je.push(String.fromCharCode.apply(String,Xe.slice(0,Ke))),Je.join("")):String.fromCharCode.apply(String,Xe.slice(0,Ke))},Se.write=function(Be,De,Ve){for(var Fe=Ve,Je,Xe,Ke=0;Ke<Be.length;++Ke)Je=Be.charCodeAt(Ke),Je<128?De[Ve++]=Je:Je<2048?(De[Ve++]=Je>>6|192,De[Ve++]=Je&63|128):(Je&64512)===55296&&((Xe=Be.charCodeAt(Ke+1))&64512)===56320?(Je=65536+((Je&1023)<<10)+(Xe&1023),++Ke,De[Ve++]=Je>>18|240,De[Ve++]=Je>>12&63|128,De[Ve++]=Je>>6&63|128,De[Ve++]=Je&63|128):(De[Ve++]=Je>>12|224,De[Ve++]=Je>>6&63|128,De[Ve++]=Je&63|128);return Ve-Fe}})(utf8$2);var pool_1=pool;function pool($e,Se,Be){var De=Be||8192,Ve=De>>>1,Fe=null,Je=De;return function(Xe){if(Xe<1||Xe>Ve)return $e(Xe);Je+Xe>De&&(Fe=$e(De),Je=0);var Ke=Se.call(Fe,Je,Je+=Xe);return Je&7&&(Je=(Je|7)+1),Ke}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=Se;var $e=requireMinimal();function Se(Fe,Je){this.lo=Fe>>>0,this.hi=Je>>>0}var Be=Se.zero=new Se(0,0);Be.toNumber=function(){return 0},Be.zzEncode=Be.zzDecode=function(){return this},Be.length=function(){return 1};var De=Se.zeroHash="\0\0\0\0\0\0\0\0";Se.fromNumber=function(Fe){if(Fe===0)return Be;var Je=Fe<0;Je&&(Fe=-Fe);var Xe=Fe>>>0,Ke=(Fe-Xe)/4294967296>>>0;return Je&&(Ke=~Ke>>>0,Xe=~Xe>>>0,++Xe>4294967295&&(Xe=0,++Ke>4294967295&&(Ke=0))),new Se(Xe,Ke)},Se.from=function(Fe){if(typeof Fe=="number")return Se.fromNumber(Fe);if($e.isString(Fe))if($e.Long)Fe=$e.Long.fromString(Fe);else return Se.fromNumber(parseInt(Fe,10));return Fe.low||Fe.high?new Se(Fe.low>>>0,Fe.high>>>0):Be},Se.prototype.toNumber=function(Fe){if(!Fe&&this.hi>>>31){var Je=~this.lo+1>>>0,Xe=~this.hi>>>0;return Je||(Xe=Xe+1>>>0),-(Je+Xe*4294967296)}return this.lo+this.hi*4294967296},Se.prototype.toLong=function(Fe){return $e.Long?new $e.Long(this.lo|0,this.hi|0,!!Fe):{low:this.lo|0,high:this.hi|0,unsigned:!!Fe}};var Ve=String.prototype.charCodeAt;return Se.fromHash=function(Fe){return Fe===De?Be:new Se((Ve.call(Fe,0)|Ve.call(Fe,1)<<8|Ve.call(Fe,2)<<16|Ve.call(Fe,3)<<24)>>>0,(Ve.call(Fe,4)|Ve.call(Fe,5)<<8|Ve.call(Fe,6)<<16|Ve.call(Fe,7)<<24)>>>0)},Se.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},Se.prototype.zzEncode=function(){var Fe=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^Fe)>>>0,this.lo=(this.lo<<1^Fe)>>>0,this},Se.prototype.zzDecode=function(){var Fe=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^Fe)>>>0,this.hi=(this.hi>>>1^Fe)>>>0,this},Se.prototype.length=function(){var Fe=this.lo,Je=(this.lo>>>28|this.hi<<4)>>>0,Xe=this.hi>>>24;return Xe===0?Je===0?Fe<16384?Fe<128?1:2:Fe<2097152?3:4:Je<16384?Je<128?5:6:Je<2097152?7:8:Xe<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function($e){var Se=$e;Se.asPromise=aspromise,Se.base64=base64$1,Se.EventEmitter=eventemitter,Se.float=float,Se.inquire=inquire_1,Se.utf8=utf8$2,Se.pool=pool_1,Se.LongBits=requireLongbits(),Se.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),Se.global=Se.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,Se.emptyArray=Object.freeze?Object.freeze([]):[],Se.emptyObject=Object.freeze?Object.freeze({}):{},Se.isInteger=Number.isInteger||function(Ve){return typeof Ve=="number"&&isFinite(Ve)&&Math.floor(Ve)===Ve},Se.isString=function(Ve){return typeof Ve=="string"||Ve instanceof String},Se.isObject=function(Ve){return Ve&&typeof Ve=="object"},Se.isset=Se.isSet=function(Ve,Fe){var Je=Ve[Fe];return Je!=null&&Ve.hasOwnProperty(Fe)?typeof Je!="object"||(Array.isArray(Je)?Je.length:Object.keys(Je).length)>0:!1},Se.Buffer=function(){try{var Ve=Se.inquire("buffer").Buffer;return Ve.prototype.utf8Write?Ve:null}catch{return null}}(),Se._Buffer_from=null,Se._Buffer_allocUnsafe=null,Se.newBuffer=function(Ve){return typeof Ve=="number"?Se.Buffer?Se._Buffer_allocUnsafe(Ve):new Se.Array(Ve):Se.Buffer?Se._Buffer_from(Ve):typeof Uint8Array>"u"?Ve:new Uint8Array(Ve)},Se.Array=typeof Uint8Array<"u"?Uint8Array:Array,Se.Long=Se.global.dcodeIO&&Se.global.dcodeIO.Long||Se.global.Long||Se.inquire("long"),Se.key2Re=/^true|false|0|1$/,Se.key32Re=/^-?(?:0|[1-9][0-9]*)$/,Se.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,Se.longToHash=function(Ve){return Ve?Se.LongBits.from(Ve).toHash():Se.LongBits.zeroHash},Se.longFromHash=function(Ve,Fe){var Je=Se.LongBits.fromHash(Ve);return Se.Long?Se.Long.fromBits(Je.lo,Je.hi,Fe):Je.toNumber(!!Fe)};function Be(Ve,Fe,Je){for(var Xe=Object.keys(Fe),Ke=0;Ke<Xe.length;++Ke)(Ve[Xe[Ke]]===void 0||!Je)&&(Ve[Xe[Ke]]=Fe[Xe[Ke]]);return Ve}Se.merge=Be,Se.lcFirst=function(Ve){return Ve.charAt(0).toLowerCase()+Ve.substring(1)};function De(Ve){function Fe(Je,Xe){if(!(this instanceof Fe))return new Fe(Je,Xe);Object.defineProperty(this,"message",{get:function(){return Je}}),Error.captureStackTrace?Error.captureStackTrace(this,Fe):Object.defineProperty(this,"stack",{value:new Error().stack||""}),Xe&&Be(this,Xe)}return Fe.prototype=Object.create(Error.prototype,{constructor:{value:Fe,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return Ve},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),Fe}Se.newError=De,Se.ProtocolError=De("ProtocolError"),Se.oneOfGetter=function(Ve){for(var Fe={},Je=0;Je<Ve.length;++Je)Fe[Ve[Je]]=1;return function(){for(var Xe=Object.keys(this),Ke=Xe.length-1;Ke>-1;--Ke)if(Fe[Xe[Ke]]===1&&this[Xe[Ke]]!==void 0&&this[Xe[Ke]]!==null)return Xe[Ke]}},Se.oneOfSetter=function(Ve){return function(Fe){for(var Je=0;Je<Ve.length;++Je)Ve[Je]!==Fe&&delete this[Ve[Je]]}},Se.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},Se._configure=function(){var Ve=Se.Buffer;if(!Ve){Se._Buffer_from=Se._Buffer_allocUnsafe=null;return}Se._Buffer_from=Ve.from!==Uint8Array.from&&Ve.from||function(Fe,Je){return new Ve(Fe,Je)},Se._Buffer_allocUnsafe=Ve.allocUnsafe||function(Fe){return new Ve(Fe)}}}(minimal$1)),minimal$1}var writer=Writer$1,util$4=requireMinimal(),BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op($e,Se,Be){this.fn=$e,this.len=Se,this.next=void 0,this.val=Be}function noop$2(){}function State($e){this.head=$e.head,this.tail=$e.tail,this.len=$e.len,this.next=$e.states}function Writer$1(){this.len=0,this.head=new Op(noop$2,0,0),this.tail=this.head,this.states=null}var create$1=function $e(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$1();Writer$1.alloc=function $e(Se){return new util$4.Array(Se)};util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray));Writer$1.prototype._push=function $e(Se,Be,De){return this.tail=this.tail.next=new Op(Se,Be,De),this.len+=Be,this};function writeByte($e,Se,Be){Se[Be]=$e&255}function writeVarint32($e,Se,Be){for(;$e>127;)Se[Be++]=$e&127|128,$e>>>=7;Se[Be]=$e}function VarintOp($e,Se){this.len=$e,this.next=void 0,this.val=Se}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function $e(Se){return this.len+=(this.tail=this.tail.next=new VarintOp((Se=Se>>>0)<128?1:Se<16384?2:Se<2097152?3:Se<268435456?4:5,Se)).len,this};Writer$1.prototype.int32=function $e(Se){return Se<0?this._push(writeVarint64,10,LongBits$1.fromNumber(Se)):this.uint32(Se)};Writer$1.prototype.sint32=function $e(Se){return this.uint32((Se<<1^Se>>31)>>>0)};function writeVarint64($e,Se,Be){for(;$e.hi;)Se[Be++]=$e.lo&127|128,$e.lo=($e.lo>>>7|$e.hi<<25)>>>0,$e.hi>>>=7;for(;$e.lo>127;)Se[Be++]=$e.lo&127|128,$e.lo=$e.lo>>>7;Se[Be++]=$e.lo}Writer$1.prototype.uint64=function $e(Se){var Be=LongBits$1.from(Se);return this._push(writeVarint64,Be.length(),Be)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function $e(Se){var Be=LongBits$1.from(Se).zzEncode();return this._push(writeVarint64,Be.length(),Be)};Writer$1.prototype.bool=function $e(Se){return this._push(writeByte,1,Se?1:0)};function writeFixed32($e,Se,Be){Se[Be]=$e&255,Se[Be+1]=$e>>>8&255,Se[Be+2]=$e>>>16&255,Se[Be+3]=$e>>>24}Writer$1.prototype.fixed32=function $e(Se){return this._push(writeFixed32,4,Se>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function $e(Se){var Be=LongBits$1.from(Se);return this._push(writeFixed32,4,Be.lo)._push(writeFixed32,4,Be.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function $e(Se){return this._push(util$4.float.writeFloatLE,4,Se)};Writer$1.prototype.double=function $e(Se){return this._push(util$4.float.writeDoubleLE,8,Se)};var writeBytes=util$4.Array.prototype.set?function $e(Se,Be,De){Be.set(Se,De)}:function $e(Se,Be,De){for(var Ve=0;Ve<Se.length;++Ve)Be[De+Ve]=Se[Ve]};Writer$1.prototype.bytes=function $e(Se){var Be=Se.length>>>0;if(!Be)return this._push(writeByte,1,0);if(util$4.isString(Se)){var De=Writer$1.alloc(Be=base64.length(Se));base64.decode(Se,De,0),Se=De}return this.uint32(Be)._push(writeBytes,Be,Se)};Writer$1.prototype.string=function $e(Se){var Be=utf8$1.length(Se);return Be?this.uint32(Be)._push(utf8$1.write,Be,Se):this._push(writeByte,1,0)};Writer$1.prototype.fork=function $e(){return this.states=new State(this),this.head=this.tail=new Op(noop$2,0,0),this.len=0,this};Writer$1.prototype.reset=function $e(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$2,0,0),this.len=0),this};Writer$1.prototype.ldelim=function $e(){var Se=this.head,Be=this.tail,De=this.len;return this.reset().uint32(De),De&&(this.tail.next=Se.next,this.tail=Be,this.len+=De),this};Writer$1.prototype.finish=function $e(){for(var Se=this.head.next,Be=this.constructor.alloc(this.len),De=0;Se;)Se.fn(Se.val,Be,De),De+=Se.len,Se=Se.next;return Be};Writer$1._configure=function($e){BufferWriter$1=$e,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&util$3.Buffer.prototype.set.name==="set"?function($e,Se,Be){Se.set($e,Be)}:function($e,Se,Be){if($e.copy)$e.copy(Se,Be,0,$e.length);else for(var De=0;De<$e.length;)Se[Be++]=$e[De++]}};BufferWriter.prototype.bytes=function $e(Se){util$3.isString(Se)&&(Se=util$3._Buffer_from(Se,"base64"));var Be=Se.length>>>0;return this.uint32(Be),Be&&this._push(BufferWriter.writeBytesBuffer,Be,Se),this};function writeStringBuffer($e,Se,Be){$e.length<40?util$3.utf8.write($e,Se,Be):Se.utf8Write?Se.utf8Write($e,Be):Se.write($e,Be)}BufferWriter.prototype.string=function $e(Se){var Be=util$3.Buffer.byteLength(Se);return this.uint32(Be),Be&&this._push(writeStringBuffer,Be,Se),this};BufferWriter._configure();var reader=Reader$1,util$2=requireMinimal(),BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange($e,Se){return RangeError("index out of range: "+$e.pos+" + "+(Se||1)+" > "+$e.len)}function Reader$1($e){this.buf=$e,this.pos=0,this.len=$e.length}var create_array=typeof Uint8Array<"u"?function $e(Se){if(Se instanceof Uint8Array||Array.isArray(Se))return new Reader$1(Se);throw Error("illegal buffer")}:function $e(Se){if(Array.isArray(Se))return new Reader$1(Se);throw Error("illegal buffer")},create=function $e(){return util$2.Buffer?function(Se){return(Reader$1.create=function(Be){return util$2.Buffer.isBuffer(Be)?new BufferReader$1(Be):create_array(Be)})(Se)}:create_array};Reader$1.create=create();Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice;Reader$1.prototype.uint32=function $e(){var Se=4294967295;return function(){if(Se=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(Se=(Se|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(Se=(Se|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(Se=(Se|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(Se=(Se|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return Se;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return Se}}();Reader$1.prototype.int32=function $e(){return this.uint32()|0};Reader$1.prototype.sint32=function $e(){var Se=this.uint32();return Se>>>1^-(Se&1)|0};function readLongVarint(){var $e=new LongBits(0,0),Se=0;if(this.len-this.pos>4){for(;Se<4;++Se)if($e.lo=($e.lo|(this.buf[this.pos]&127)<<Se*7)>>>0,this.buf[this.pos++]<128)return $e;if($e.lo=($e.lo|(this.buf[this.pos]&127)<<28)>>>0,$e.hi=($e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return $e;Se=0}else{for(;Se<3;++Se){if(this.pos>=this.len)throw indexOutOfRange(this);if($e.lo=($e.lo|(this.buf[this.pos]&127)<<Se*7)>>>0,this.buf[this.pos++]<128)return $e}return $e.lo=($e.lo|(this.buf[this.pos++]&127)<<Se*7)>>>0,$e}if(this.len-this.pos>4){for(;Se<5;++Se)if($e.hi=($e.hi|(this.buf[this.pos]&127)<<Se*7+3)>>>0,this.buf[this.pos++]<128)return $e}else for(;Se<5;++Se){if(this.pos>=this.len)throw indexOutOfRange(this);if($e.hi=($e.hi|(this.buf[this.pos]&127)<<Se*7+3)>>>0,this.buf[this.pos++]<128)return $e}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function $e(){return this.uint32()!==0};function readFixed32_end($e,Se){return($e[Se-4]|$e[Se-3]<<8|$e[Se-2]<<16|$e[Se-1]<<24)>>>0}Reader$1.prototype.fixed32=function $e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function $e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function $e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var Se=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,Se};Reader$1.prototype.double=function $e(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var Se=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,Se};Reader$1.prototype.bytes=function $e(){var Se=this.uint32(),Be=this.pos,De=this.pos+Se;if(De>this.len)throw indexOutOfRange(this,Se);if(this.pos+=Se,Array.isArray(this.buf))return this.buf.slice(Be,De);if(Be===De){var Ve=util$2.Buffer;return Ve?Ve.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,Be,De)};Reader$1.prototype.string=function $e(){var Se=this.bytes();return utf8.read(Se,0,Se.length)};Reader$1.prototype.skip=function $e(Se){if(typeof Se=="number"){if(this.pos+Se>this.len)throw indexOutOfRange(this,Se);this.pos+=Se}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function($e){switch($e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;($e=this.uint32()&7)!==4;)this.skipType($e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+$e+" at offset "+this.pos)}return this};Reader$1._configure=function($e){BufferReader$1=$e,Reader$1.create=create(),BufferReader$1._configure();var Se=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[Se](!1)},uint64:function(){return readLongVarint.call(this)[Se](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[Se](!1)},fixed64:function(){return readFixed64.call(this)[Se](!0)},sfixed64:function(){return readFixed64.call(this)[Se](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=requireMinimal();function BufferReader($e){Reader.call(this,$e)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)};BufferReader.prototype.string=function $e(){var Se=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+Se,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+Se,this.len))};BufferReader._configure();var rpc={},service=Service,util=requireMinimal();(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service;function Service($e,Se,Be){if(typeof $e!="function")throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=$e,this.requestDelimited=!!Se,this.responseDelimited=!!Be}Service.prototype.rpcCall=function $e(Se,Be,De,Ve,Fe){if(!Ve)throw TypeError("request must be specified");var Je=this;if(!Fe)return util.asPromise($e,Je,Se,Be,De,Ve);if(!Je.rpcImpl){setTimeout(function(){Fe(Error("already ended"))},0);return}try{return Je.rpcImpl(Se,Be[Je.requestDelimited?"encodeDelimited":"encode"](Ve).finish(),function(Xe,Ke){if(Xe)return Je.emit("error",Xe,Se),Fe(Xe);if(Ke===null){Je.end(!0);return}if(!(Ke instanceof De))try{Ke=De[Je.responseDelimited?"decodeDelimited":"decode"](Ke)}catch(Ye){return Je.emit("error",Ye,Se),Fe(Ye)}return Je.emit("data",Ke,Se),Fe(null,Ke)})}catch(Xe){Je.emit("error",Xe,Se),setTimeout(function(){Fe(Xe)},0);return}};Service.prototype.end=function $e(Se){return this.rpcImpl&&(Se||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function($e){var Se=$e;Se.Service=service})(rpc);var roots={};(function($e){var Se=$e;Se.build="minimal",Se.Writer=writer,Se.BufferWriter=writer_buffer,Se.Reader=reader,Se.BufferReader=reader_buffer,Se.util=requireMinimal(),Se.rpc=rpc,Se.roots=roots,Se.configure=Be;function Be(){Se.util._configure(),Se.Writer._configure(Se.BufferWriter),Se.Reader._configure(Se.BufferReader)}Be()})(indexMinimal);var minimal=indexMinimal;const $Reader$1=minimal.Reader,$util$1=minimal.util,$root$1=minimal.roots["@REALSEE/FIVE:five/loaders/model/parsers/protobuf/pbm.proto"]||(minimal.roots["@REALSEE/FIVE:five/loaders/model/parsers/protobuf/pbm.proto"]={}),Model$2=$root$1.Model=(()=>{function $e(Se){if(this.chunks=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.chunks=$util$1.emptyArray,$e.prototype.createAt=$util$1.Long?$util$1.Long.fromBits(0,0,!0):0,$e.prototype.description="",$e.decode=function(Se,Be){Se instanceof $Reader$1||(Se=$Reader$1.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root$1.Model;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{Ve.chunks&&Ve.chunks.length||(Ve.chunks=[]),Ve.chunks.push($root$1.Chunk.decode(Se,Se.uint32()));break}case 2:{Ve.createAt=Se.uint64();break}case 3:{Ve.description=Se.string();break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Model"},$e})();$root$1.Chunk=(()=>{function $e(Se){if(Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.vertices=null,$e.prototype.faces=null,$e.prototype.name="",$e.prototype.texture="",$e.decode=function(Se,Be){Se instanceof $Reader$1||(Se=$Reader$1.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root$1.Chunk;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{Ve.vertices=$root$1.Vertices.decode(Se,Se.uint32());break}case 2:{Ve.faces=$root$1.Faces.decode(Se,Se.uint32());break}case 3:{Ve.name=Se.string();break}case 4:{Ve.texture=Se.string();break}default:Se.skipType(Fe&7);break}}if(!Ve.hasOwnProperty("vertices"))throw $util$1.ProtocolError("missing required 'vertices'",{instance:Ve});if(!Ve.hasOwnProperty("faces"))throw $util$1.ProtocolError("missing required 'faces'",{instance:Ve});if(!Ve.hasOwnProperty("name"))throw $util$1.ProtocolError("missing required 'name'",{instance:Ve});return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Chunk"},$e})();$root$1.Vertices=(()=>{function $e(Se){if(this.xyz=[],this.uvs=[],this.marks=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.xyz=$util$1.emptyArray,$e.prototype.uvs=$util$1.emptyArray,$e.prototype.marks=$util$1.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader$1||(Se=$Reader$1.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root$1.Vertices;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{if(Ve.xyz&&Ve.xyz.length||(Ve.xyz=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.xyz.push(Se.float())}else Ve.xyz.push(Se.float());break}case 2:{if(Ve.uvs&&Ve.uvs.length||(Ve.uvs=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.uvs.push(Se.float())}else Ve.uvs.push(Se.float());break}case 3:{if(Ve.marks&&Ve.marks.length||(Ve.marks=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.marks.push(Se.int32())}else Ve.marks.push(Se.int32());break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Vertices"},$e})();$root$1.Faces=(()=>{function $e(Se){if(this.indices=[],this.normals=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.indices=$util$1.emptyArray,$e.prototype.normals=$util$1.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader$1||(Se=$Reader$1.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root$1.Faces;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{if(Ve.indices&&Ve.indices.length||(Ve.indices=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.indices.push(Se.uint32())}else Ve.indices.push(Se.uint32());break}case 2:{if(Ve.normals&&Ve.normals.length||(Ve.normals=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.normals.push(Se.float())}else Ve.normals.push(Se.float());break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Faces"},$e})();$root$1.VertexMark=(()=>{const $e={},Se=Object.create($e);return Se[$e[0]="VERTEX_MARK_UNSPECIFIED"]=0,Se[$e[1]="VERTEX_MARK_ROOF"]=1,Se})();function loadPbm($e,Se){var Be,De,Ve,Fe;Se===void 0&&(Se={});var Je=(Be=Se.fetcher)!==null&&Be!==void 0?Be:new Fetcher({allowHosts:["*"]}),Xe={byteLength:0},Ke=autoRestImageOptionsByTextureLength((De=Se.textureOptions)!==null&&De!==void 0?De:{},(Fe=(Ve=Se.textureArray)===null||Ve===void 0?void 0:Ve.length)!==null&&Fe!==void 0?Fe:0),Ye={};if(Se.textureArray)for(var or=0,sr=Se.textureArray;or<sr.length;or++){var cr=sr[or];Ye[cr]=loadTexture$1(cr,Ke,Je)}return Promise.resolve().then(function(){return Je.ajax($e,{responseType:"arraybuffer"})}).then(function(Br){return Xe.byteLength=Br.body.byteLength,delay(function(){var tn=new Uint8Array(Br.body);return Model$2.decode(tn)})}).then(function(Br){return delay(function(){var tn,en,an;return parse$4(Br,(tn=Se.light)!==null&&tn!==void 0?tn:!1,(en=Se.textureBaseUri)!==null&&en!==void 0?en:function(){var rn=$e.lastIndexOf("/");if(rn>=0){var on=$e.slice(0,rn)+"/";return/\/model\/$/.test(on)&&(on=on.replace(/\/model\/$/,"/materials/")),on}return""}(),((an=Se.textureArray)!==null&&an!==void 0?an:[]).slice(),Ke,Ye,Je)})}).then(function(Br){var tn=new Group$1;tn.matrixAutoUpdate=!1,tn.matrix.compose(tn.position,tn.quaternion,tn.scale),tn.name=$e;for(var en=0,an=Br.objects;en<an.length;en++){var rn=an[en];tn.add(rn)}return{type:"pbm",upAxis:"Z",uri:$e,byteLength:Xe.byteLength,memoryUsage:getMemoryUsage(tn),scene:tn,textures:Br.textures,dispose:function(){return Br.dispose()}}})}function parseFloorName($e){var Se=$e.match(/(group|floor)-?(\d+)/);return Se?parseInt(Se[2],10):0}function parseChunkName($e){var Se=$e.match(/(chunk)-?(\d+)/);return Se?parseInt(Se[2],10):0}function parseSubName($e){var Se=$e.match(/(sub)-?(\d+)/);return Se?parseInt(Se[2],10):0}function chunkOrder($e){var Se=parseFloorName($e.name),Be=parseChunkName($e.name),De=parseSubName($e.name);return Se*1e6+Be*1e3+De}function parsePBMModel($e){for(var Se,Be,De,Ve=typeof $e.createAt=="number"?$e.createAt:0,Fe=(Se=$e.description)!==null&&Se!==void 0?Se:"",Je=[],Xe=!0,Ke=!0,Ye=0,or=$e.chunks;Ye<or.length;Ye++){var sr=or[Ye];if(!sr.vertices.marks||sr.vertices.marks.length===0){Ke=!1;break}}for(var cr=0,Br=$e.chunks;cr<Br.length;cr++){var sr=Br[cr];if(!sr.faces.normals||sr.faces.normals.length===0){Xe=!1;break}}for(var tn=$e.chunks.sort(function(si,ei){return chunkOrder(si)-chunkOrder(ei)}),en=[],an=0,rn=tn;an<rn.length;an++){var sr=rn[an],on=parseFloorName(sr.name);en[on]||(en[on]=[]),en[on].push(sr)}for(var sn=0;sn<en.length;sn++){var ln=en[sn];if(ln)if(Xe){for(var cn=0,hn=0;hn<ln.length;hn++){var sr=ln[hn];cn+=sr.faces.indices.length}for(var mn=new Float32Array(cn*3),An=new Float32Array(cn*2),xn=new Float32Array(cn*3),pn=Ke?new Float32Array(cn):void 0,dn=[],fn=[1/0,1/0,1/0,-1/0,-1/0,-1/0],yn=0,Sn=0;Sn<ln.length;Sn++){for(var gn=[1/0,1/0,1/0,-1/0,-1/0,-1/0],sr=ln[Sn],Cn=sr.vertices.xyz,Mn=sr.vertices.uvs,Bn=sr.faces.indices,kn=sr.faces.normals,Ln=sr.vertices.marks,Pn=Bn.length,hn=0;hn<Pn;hn++){var Vn=Bn[hn],Yn=mn[yn*3+hn*3]=Cn[Vn*3],ni=mn[yn*3+hn*3+1]=Cn[Vn*3+1],Rn=mn[yn*3+hn*3+2]=Cn[Vn*3+2];pn&&(pn[yn+hn]=Ln[Vn]),An[yn*2+hn*2]=Mn[Vn*2],An[yn*2+hn*2+1]=Mn[Vn*2+1];var In=Math.floor(hn/3)*3;xn[yn*3+hn*3]=kn[In],xn[yn*3+hn*3+1]=kn[In+1],xn[yn*3+hn*3+2]=kn[In+2],Yn<gn[0]&&(gn[0]=Yn),ni<gn[1]&&(gn[1]=ni),Rn<gn[2]&&(gn[2]=Rn),Yn>gn[3]&&(gn[3]=Yn),ni>gn[4]&&(gn[4]=ni),Rn>gn[5]&&(gn[5]=Rn)}gn[0]<fn[0]&&(fn[0]=gn[0]),gn[1]<fn[1]&&(fn[1]=gn[1]),gn[2]<fn[2]&&(fn[2]=gn[2]),gn[3]>fn[3]&&(fn[3]=gn[3]),gn[4]>fn[4]&&(fn[4]=gn[4]),gn[5]>fn[5]&&(fn[5]=gn[5]),dn.push({materialIndex:Sn,name:sr.name,chunkName:parseChunkName(sr.name),start:yn,count:sr.faces.indices.length,texture:(Be=sr.texture)!==null&&Be!==void 0?Be:void 0}),yn+=Pn}var Gn={createAt:Ve,description:Fe,vertices:mn,uvs:An,normals:xn,masks:pn,indices:null,floorIndex:sn,groups:dn,extents:fn};Je.push(Gn)}else{for(var cn=0,Fn=0,hn=0;hn<ln.length;hn++){var sr=ln[hn];Fn+=sr.vertices.xyz.length/3,cn+=sr.faces.indices.length}for(var mn=new Float32Array(Fn*3),An=new Float32Array(Fn*2),xn=void 0,Hn=new Float32Array(Fn),Dn=new Uint32Array(cn),pn=Ke?new Float32Array(cn):void 0,dn=[],fn=[1/0,1/0,1/0,-1/0,-1/0,-1/0],zn=0,yn=0,Sn=0;Sn<ln.length;Sn++){for(var gn=[1/0,1/0,1/0,-1/0,-1/0,-1/0],sr=ln[Sn],Cn=sr.vertices.xyz,Qn=sr.vertices.marks,Mn=sr.vertices.uvs,Bn=sr.faces.indices,Zn=Cn.length/3,Pn=Bn.length,hn=0;hn<Zn;hn++){var Yn=mn[yn*3+hn*3]=Cn[hn*3],ni=mn[yn*3+hn*3+1]=Cn[hn*3+1],Rn=mn[yn*3+hn*3+2]=Cn[hn*3+2];pn&&(pn[yn+hn]=Qn[hn]),An[yn*2+hn*2]=Mn[hn*2],An[yn*2+hn*2+1]=Mn[hn*2+1],Hn[yn+hn]=sn,Yn<gn[0]&&(gn[0]=Yn),ni<gn[1]&&(gn[1]=ni),Rn<gn[2]&&(gn[2]=Rn),Yn>gn[3]&&(gn[3]=Yn),ni>gn[4]&&(gn[4]=ni),Rn>gn[5]&&(gn[5]=Rn)}gn[0]<fn[0]&&(fn[0]=gn[0]),gn[1]<fn[1]&&(fn[1]=gn[1]),gn[2]<fn[2]&&(fn[2]=gn[2]),gn[3]>fn[3]&&(fn[3]=gn[3]),gn[4]>fn[4]&&(fn[4]=gn[4]),gn[5]>fn[5]&&(fn[5]=gn[5]);for(var hn=0;hn<Pn;hn++)Dn[zn+hn]=yn+Bn[hn];dn.push({materialIndex:Sn,name:sr.name,chunkName:parseChunkName(sr.name),start:zn,count:sr.faces.indices.length,texture:(De=sr.texture)!==null&&De!==void 0?De:void 0}),yn+=Zn,zn+=Pn}var Gn={createAt:Ve,description:Fe,vertices:mn,uvs:An,normals:xn,masks:pn,indices:Dn,floorIndex:sn,groups:dn,extents:fn};Je.push(Gn)}}return Je}function loadTexture$1($e,Se,Be){var De=__assign({key:"texture.pbm"},pick(Se,["format","quality","size","sharpen","mappings"])),Ve=new TextureLoader,Fe=Ve.loadTexture($e,{imageURL:{transform:Se.transform,options:De},encoding:sRGBEncoding,wrapS:ClampToEdgeWrapping,wrapT:ClampToEdgeWrapping,minFilter:LinearFilter,maxSize:typeof De.size=="number"?new Vector2(De.size,De.size):void 0,fetcher:Be}).then(function(Je){var Xe=Je.body;return Xe.needsUpdate=!0,Xe});return Object.assign(Fe,{url:$e,textureOptions:Se})}function parse$4($e,Se,Be,De,Ve,Fe,Je){Fe===void 0&&(Fe={});for(var Xe=parsePBMModel($e),Ke=0,Ye="",or=[],sr={},cr=new Set,Br=0,tn=0,en=Xe;tn<en.length;tn++){var an=en[tn],rn=an.createAt,on=an.description,sn=an.vertices,ln=an.masks,cn=an.uvs,hn=an.normals,mn=an.indices,An=an.floorIndex,xn=an.groups,pn=an.extents,dn=new Box3;dn.min.x=pn[0],dn.min.y=pn[1],dn.min.z=pn[2],dn.max.x=pn[3],dn.max.y=pn[4],dn.max.z=pn[5];var fn=new BufferGeometry;fn.setAttribute("position",new BufferAttribute(sn,3)),fn.setAttribute("uv",new BufferAttribute(cn,2)),hn&&fn.setAttribute("normal",new BufferAttribute(hn,3)),ln&&fn.setAttribute("mask",new BufferAttribute(ln,1)),mn&&fn.setIndex(new BufferAttribute(mn,1)),fn.boundingBox=dn,fn.boundingSphere=dn.getBoundingSphere(new Sphere);for(var yn=0,Sn=xn;yn<Sn.length;yn++){var gn=Sn[yn];fn.addGroup(gn.start,gn.count,gn.materialIndex)}cr.add(fn);for(var Cn=[],Mn=0,Bn=xn;Mn<Bn.length;Mn++){var gn=Bn[Mn],kn=De[gn.chunkName]||(gn.texture?pathJoin(Be||"",gn.texture):void 0),Ln=new PBMMeshMaterial(Se?"phong":"basic");Ln.floorIndex=An,fn.attributes.normal===void 0&&(Ln.flatShading=!0),fn.attributes.mask&&(Ln.defines.USE_VERTEX_MARK=!0),Cn.push(Ln),kn?(Br++,sr[kn]?sr[kn].push(Ln):sr[kn]=[Ln]):Ln.color=new Color(16777215),cr.add(Ln),Ln.refreshUniforms()}var Pn=new PBMMesh(fn,Cn);Pn.name="model_floor_"+An,Pn.userData.createAt=rn,Pn.userData.description=on,Pn.matrix.compose(Pn.position,Pn.quaternion,Pn.scale),Pn.matrixAutoUpdate=!1,Pn.frustumCulled=!1,Ke=rn,Ye=on,or.push(Pn)}var Vn=function(Yn){Yn=autoRestImageOptionsByTextureLength(Yn,Br);for(var ni=[],Rn=function(Hn){var Dn=null;Hn in Fe&&(Dn=Fe[Hn]),Dn||(Dn=loadTexture$1(Hn,Yn,Je)),ni.push(Dn.then(function(zn){for(var Qn=0,Zn=sr[Hn];Qn<Zn.length;Qn++){var si=Zn[Qn];si.map&&(cr.delete(si.map),si.map.dispose()),si.map=zn,si.refreshUniforms(),cr.add(zn)}return zn}).catch(function(){for(var zn=0,Qn=sr[Hn];zn<Qn.length;zn++){var Zn=Qn[zn];Zn.map&&(cr.delete(Zn.map),Zn.map.dispose()),Zn.map=null,Zn.color=new Color(16777215),Zn.refreshUniforms()}return null}))},In=0,Gn=Object.keys(sr);In<Gn.length;In++){var Fn=Gn[In];Rn(Fn)}for(var Fn in Fe)delete Fe[Fn];return Promise.all(ni).then(function(Hn){return Hn.filter(function(Dn){return Dn})})};return Vn(Ve).then(function(Yn){return{createAt:Ke,description:Ye,objects:or,textures:Yn,dispose:function(){cr.forEach(function(ni){ni.dispose()}),cr.clear()}}})}function autoRestImageOptionsByTextureLength($e,Se){return $e=Object.assign({},$e),$e.autoResize!==!1&&(Se>96?$e.size=Math.min($e.size||1/0,100):Se>48?$e.size=Math.min($e.size||1/0,200):Se>24?$e.size=Math.min($e.size||1/0,400):Se>22?$e.size=Math.min($e.size||1/0,800):Se>5&&($e.size=Math.min($e.size||1/0,1024))),$e}function loadAt3d($e,Se){var Be,De,Ve,Fe;Se===void 0&&(Se={});var Je=(Be=Se.fetcher)!==null&&Be!==void 0?Be:new Fetcher({allowHosts:["*"]}),Xe={byteLength:0},Ke=autoRestImageOptionsByTextureLength((De=Se.textureOptions)!==null&&De!==void 0?De:{},(Fe=(Ve=Se.textureArray)===null||Ve===void 0?void 0:Ve.length)!==null&&Fe!==void 0?Fe:0),Ye={};if(Se.textureArray)for(var or=0,sr=Se.textureArray;or<sr.length;or++){var cr=sr[or];Ye[cr]=loadTexture$1(cr,Ke,Je)}return Promise.resolve().then(function(){return Je.ajax($e,{responseType:"arraybuffer"})}).then(function(Br){return lzma(Br.body)}).then(function(Br){return delay(function(){for(var tn,en={chunks:[],createAt:void 0,description:void 0},an=0,rn=Br;an<rn.length;an++){var on=rn[an],sn=Model$2.decode(on);sn.chunks.length&&((tn=en.chunks).push.apply(tn,sn.chunks),en.createAt=sn.createAt,en.description=sn.description)}return en})}).then(function(Br){return delay(function(){var tn,en,an,rn;return parse$4(Br,(tn=Se.light)!==null&&tn!==void 0?tn:!1,(en=Se.textureBaseUri)!==null&&en!==void 0?en:function(){var on=$e.lastIndexOf("/");if(on>=0){var sn=$e.slice(0,on)+"/";return/\/model\/$/.test(sn)&&(sn=sn.replace(/\/model\/$/,"/materials/")),sn}return""}(),((an=Se.textureArray)!==null&&an!==void 0?an:[]).slice(),(rn=Se.textureOptions)!==null&&rn!==void 0?rn:{},Ye,Je)})}).then(function(Br){var tn=new Group$1;tn.name=$e;for(var en=0,an=Br.objects;en<an.length;en++){var rn=an[en];tn.add(rn)}return{type:"at3d",upAxis:"Z",uri:$e,byteLength:Xe.byteLength,memoryUsage:getMemoryUsage(tn),scene:tn,textures:Br.textures,dispose:function(){return Br.dispose()}}})}const $Reader=minimal.Reader,$util=minimal.util,$root=minimal.roots["@REALSEE/FIVE:five/loaders/model/parsers/protobuf/dome.proto"]||(minimal.roots["@REALSEE/FIVE:five/loaders/model/parsers/protobuf/dome.proto"]={}),Model$1=$root.Model=(()=>{function $e(Se){if(this.meshes=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.meshes=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Model;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{Ve.meshes&&Ve.meshes.length||(Ve.meshes=[]),Ve.meshes.push($root.Mesh.decode(Se,Se.uint32()));break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Model"},$e})();$root.Mesh=(()=>{function $e(Se){if(this.chunks=[],this.matrix=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.name="",$e.prototype.chunks=$util.emptyArray,$e.prototype.matrix=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Mesh;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{Ve.name=Se.string();break}case 2:{Ve.chunks&&Ve.chunks.length||(Ve.chunks=[]),Ve.chunks.push($root.Chunk.decode(Se,Se.uint32()));break}case 3:{Ve.matrix&&Ve.matrix.length||(Ve.matrix=[]),Ve.matrix.push($root.Matrix.decode(Se,Se.uint32()));break}default:Se.skipType(Fe&7);break}}if(!Ve.hasOwnProperty("name"))throw $util.ProtocolError("missing required 'name'",{instance:Ve});return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Mesh"},$e})();$root.Matrix=(()=>{function $e(Se){if(this.elements=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.elements=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Matrix;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{if(Ve.elements&&Ve.elements.length||(Ve.elements=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.elements.push(Se.float())}else Ve.elements.push(Se.float());break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Matrix"},$e})();$root.Chunk=(()=>{function $e(Se){if(this.material=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.geometry=null,$e.prototype.material=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Chunk;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 2:{Ve.geometry=$root.Geometry.decode(Se,Se.uint32());break}case 3:{Ve.material&&Ve.material.length||(Ve.material=[]),Ve.material.push($root.Material.decode(Se,Se.uint32()));break}default:Se.skipType(Fe&7);break}}if(!Ve.hasOwnProperty("geometry"))throw $util.ProtocolError("missing required 'geometry'",{instance:Ve});return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Chunk"},$e})();$root.Geometry=(()=>{function $e(Se){if(this.groups=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.position=null,$e.prototype.uv=null,$e.prototype.uv2=null,$e.prototype.normal=null,$e.prototype.groups=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Geometry;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{Ve.position=$root.Position.decode(Se,Se.uint32());break}case 2:{Ve.uv=$root.UV.decode(Se,Se.uint32());break}case 3:{Ve.uv2=$root.UV.decode(Se,Se.uint32());break}case 4:{Ve.normal=$root.Normal.decode(Se,Se.uint32());break}case 5:{Ve.groups&&Ve.groups.length||(Ve.groups=[]),Ve.groups.push($root.Group.decode(Se,Se.uint32()));break}default:Se.skipType(Fe&7);break}}if(!Ve.hasOwnProperty("position"))throw $util.ProtocolError("missing required 'position'",{instance:Ve});if(!Ve.hasOwnProperty("normal"))throw $util.ProtocolError("missing required 'normal'",{instance:Ve});return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Geometry"},$e})();$root.Position=(()=>{function $e(Se){if(this.array=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.array=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Position;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{if(Ve.array&&Ve.array.length||(Ve.array=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.array.push(Se.float())}else Ve.array.push(Se.float());break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Position"},$e})();$root.UV=(()=>{function $e(Se){if(this.array=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.array=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.UV;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{if(Ve.array&&Ve.array.length||(Ve.array=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.array.push(Se.float())}else Ve.array.push(Se.float());break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/UV"},$e})();$root.Normal=(()=>{function $e(Se){if(this.array=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.array=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Normal;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{if(Ve.array&&Ve.array.length||(Ve.array=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.array.push(Se.float())}else Ve.array.push(Se.float());break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Normal"},$e})();$root.Group=(()=>{function $e(Se){if(Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.start=0,$e.prototype.count=0,$e.prototype.materialIndex=0,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Group;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{Ve.start=Se.uint32();break}case 2:{Ve.count=Se.uint32();break}case 3:{Ve.materialIndex=Se.uint32();break}default:Se.skipType(Fe&7);break}}if(!Ve.hasOwnProperty("start"))throw $util.ProtocolError("missing required 'start'",{instance:Ve});if(!Ve.hasOwnProperty("count"))throw $util.ProtocolError("missing required 'count'",{instance:Ve});if(!Ve.hasOwnProperty("materialIndex"))throw $util.ProtocolError("missing required 'materialIndex'",{instance:Ve});return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Group"},$e})();$root.Material=(()=>{function $e(Se){if(Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.kd=null,$e.prototype.ks=null,$e.prototype.ke=null,$e.prototype.mapkd="",$e.prototype.mapks="",$e.prototype.mapke="",$e.prototype.norm="",$e.prototype.mapbump="",$e.prototype.bump="",$e.prototype.mapd="",$e.prototype.ns=0,$e.prototype.d=0,$e.prototype.tr=0,$e.prototype.mapkdrepeat="",$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Material;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{Ve.kd=$root.Color.decode(Se,Se.uint32());break}case 2:{Ve.ks=$root.Color.decode(Se,Se.uint32());break}case 3:{Ve.ke=$root.Color.decode(Se,Se.uint32());break}case 4:{Ve.mapkd=Se.string();break}case 5:{Ve.mapks=Se.string();break}case 6:{Ve.mapke=Se.string();break}case 7:{Ve.norm=Se.string();break}case 8:{Ve.mapbump=Se.string();break}case 9:{Ve.bump=Se.string();break}case 10:{Ve.mapd=Se.string();break}case 11:{Ve.ns=Se.float();break}case 12:{Ve.d=Se.float();break}case 13:{Ve.tr=Se.float();break}case 14:{Ve.mapkdrepeat=Se.string();break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Material"},$e})();$root.Color=(()=>{function $e(Se){if(this.rgb=[],Se)for(let Be=Object.keys(Se),De=0;De<Be.length;++De)Se[Be[De]]!=null&&(this[Be[De]]=Se[Be[De]])}return $e.prototype.rgb=$util.emptyArray,$e.decode=function(Se,Be){Se instanceof $Reader||(Se=$Reader.create(Se));let De=Be===void 0?Se.len:Se.pos+Be,Ve=new $root.Color;for(;Se.pos<De;){let Fe=Se.uint32();switch(Fe>>>3){case 1:{if(Ve.rgb&&Ve.rgb.length||(Ve.rgb=[]),(Fe&7)===2){let Je=Se.uint32()+Se.pos;for(;Se.pos<Je;)Ve.rgb.push(Se.float())}else Ve.rgb.push(Se.float());break}default:Se.skipType(Fe&7);break}}return Ve},$e.getTypeUrl=function(Se){return Se===void 0&&(Se="type.googleapis.com"),Se+"/Color"},$e})();var ROTATE_X_MATRIX$5=new Matrix4().fromArray([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]);function loadDome($e,Se){var Be;Se===void 0&&(Se={});var De=(Be=Se.fetcher)!==null&&Be!==void 0?Be:new Fetcher({allowHosts:["*"]}),Ve={byteLength:0};return Promise.resolve().then(function(){return De.ajax($e,{responseType:"arraybuffer"})}).then(function(Fe){var Je,Xe;return Ve.byteLength=Fe.body.byteLength,parse$3(new Uint8Array(Fe.body),(Je=Se.light)!==null&&Je!==void 0?Je:!0,Se.textureBaseUri||"",(Xe=Se.textureOptions)!==null&&Xe!==void 0?Xe:{},De)}).then(function(Fe){var Je=new Group$1;Je.matrixAutoUpdate=!1,Je.applyMatrix4(ROTATE_X_MATRIX$5),Je.matrix.compose(Je.position,Je.quaternion,Je.scale),Je.name=$e;for(var Xe=0,Ke=Fe.objects;Xe<Ke.length;Xe++){var Ye=Ke[Xe];Je.add(Ye)}return{type:"dome",upAxis:"Z",uri:$e,byteLength:Ve.byteLength,memoryUsage:getMemoryUsage(Je),scene:Je,textures:Fe.textures,dispose:function(){return Fe.dispose()}}})}function flipBufferGeometryNormals($e){for(var Se=[0,0,0],Be=0;Be<$e.attributes.normal.array.length/9;Be++)Se[0]=$e.attributes.normal.array[Be*9],Se[1]=$e.attributes.normal.array[Be*9+1],Se[2]=$e.attributes.normal.array[Be*9+2],$e.attributes.normal.array[Be*9]=$e.attributes.normal.array[Be*9+6],$e.attributes.normal.array[Be*9+1]=$e.attributes.normal.array[Be*9+7],$e.attributes.normal.array[Be*9+2]=$e.attributes.normal.array[Be*9+8],$e.attributes.normal.array[Be*9+6]=Se[0],$e.attributes.normal.array[Be*9+7]=Se[1],$e.attributes.normal.array[Be*9+8]=Se[2];for(var Be=0;Be<$e.attributes.position.array.length/9;Be++)Se[0]=$e.attributes.position.array[Be*9],Se[1]=$e.attributes.position.array[Be*9+1],Se[2]=$e.attributes.position.array[Be*9+2],$e.attributes.position.array[Be*9]=$e.attributes.position.array[Be*9+6],$e.attributes.position.array[Be*9+1]=$e.attributes.position.array[Be*9+7],$e.attributes.position.array[Be*9+2]=$e.attributes.position.array[Be*9+8],$e.attributes.position.array[Be*9+6]=Se[0],$e.attributes.position.array[Be*9+7]=Se[1],$e.attributes.position.array[Be*9+8]=Se[2];for(var Be=0;Be<$e.attributes.uv.array.length/6;Be++)Se[0]=$e.attributes.uv.array[Be*6],Se[1]=$e.attributes.uv.array[Be*6+1],$e.attributes.uv.array[Be*6]=$e.attributes.uv.array[Be*6+4],$e.attributes.uv.array[Be*6+1]=$e.attributes.uv.array[Be*6+5],$e.attributes.uv.array[Be*6+4]=Se[0],$e.attributes.uv.array[Be*6+5]=Se[1];$e.attributes.normal.needsUpdate=!0,$e.attributes.position.needsUpdate=!0,$e.attributes.uv.needsUpdate=!0}function parseGeometry($e){var Se=$e.position,Be=$e.normal,De=$e.uv,Ve=$e.uv2,Fe=$e.groups,Je=new BufferGeometry;Je.setAttribute("position",new BufferAttribute(new Float32Array(Se.array),3)),Be&&Je.setAttribute("normal",new BufferAttribute(new Float32Array(Be.array),3)),De&&Je.setAttribute("uv",new BufferAttribute(new Float32Array(De.array),2)),Ve&&Je.setAttribute("uv2",new BufferAttribute(new Float32Array(Ve.array),2));for(var Xe=0,Ke=Fe;Xe<Ke.length;Xe++){var Ye=Ke[Xe];Je.addGroup(Ye.start,Ye.count,Ye.materialIndex)}return Je}function loadTexture($e,Se,Be,De,Ve,Fe,Je){if(Je.hasOwnProperty($e))return Je[$e];$e=$e.split("?")[0],isAbsoluteURL($e)||($e=pathJoin(Se,$e)),$e=$e.replace(/\/\/vrlab-image\d*.ljcdn.com\//,"//vrlab-public.ljcdn.com/"),$e.indexOf("//")===0&&($e="https:"+$e);var Xe=__assign({key:"texture.dome",size:64},pick(Be,["quality","format","sharpen","mappings"])),Ke=Je[$e]=Ve.loadTexture($e,{imageURL:{transform:Be.transform,options:Xe},wrapS:RepeatWrapping,wrapT:RepeatWrapping,fetcher:Fe}).then(function(Ye){var or=Ye.body;return De&&or.repeat.copy(De),or.needsUpdate=!0,or.updateMatrix(),or});return Ke}function parseMaterial($e,Se,Be,De,Ve,Fe,Je,Xe,Ke){var Ye=[],or=new PBMMeshMaterial(Se?"phong":"basic");if(Xe.add(or),$e.kd&&(or.color=new Color().fromArray($e.kd.rgb).convertLinearToSRGB()),$e.mapkd){var sr=null;if($e.mapkdrepeat){var cr=$e.mapkdrepeat.split(/\s+/).map(function(an){return Number(an)}),Br=cr[0],tn=cr[1];sr=new Vector2(Br,tn)}Ye.push(loadTexture($e.mapkd,Be,De,sr,Ve,Fe,Je).then(function(an){an.encoding=sRGBEncoding,or.map=an,Xe.add(an),Ke.add(an),or.needsUpdate=!0}).catch(noop$1))}if($e.ks&&(or.specular=new Color().fromArray($e.ks.rgb).convertLinearToSRGB()),$e.mapks&&Ye.push(loadTexture($e.mapks,Be,De,null,Ve,Fe,Je).then(function(an){or.specularMap=an,Xe.add(an),Ke.add(an)}).catch(noop$1)),$e.ke&&(or.emissive=new Color().fromArray($e.ke.rgb).convertLinearToSRGB()),$e.mapke&&Ye.push(loadTexture($e.mapke,Be,De,null,Ve,Fe,Je).then(function(an){an.encoding=sRGBEncoding,or.emissiveMap=an,Xe.add(an),Ke.add(an)}).catch(noop$1)),$e.norm&&Ye.push(loadTexture($e.norm,Be,De,null,Ve,Fe,Je).then(function(an){or.normalMap=an,Xe.add(an),Ke.add(an)}).catch(noop$1)),$e.mapbump&&Ye.push(loadTexture($e.mapbump,Be,De,null,Ve,Fe,Je).then(function(an){or.bumpMap=an,Xe.add(an),Ke.add(an)}).catch(noop$1)),$e.bump&&Ye.push(loadTexture($e.bump,Be,De,null,Ve,Fe,Je).then(function(an){or.bumpMap=an,Xe.add(an),Ke.add(an)}).catch(noop$1)),typeof $e.ns=="number"&&(or.shininess=$e.ns),typeof $e.d=="number"){var en=$e.d;en>0&&en<1&&(or.opacity=en)}return or.floorIndex=0,or.refreshUniforms(),{material:or,textureReady:Promise.all(Ye).then(function(){return or.refreshUniforms()}).then(noop$1)}}function fromProtoBuf($e){return Model$1.decode($e).meshes}function parse$3($e,Se,Be,De,Ve){for(var Fe=[],Je=[],Xe=new Set,Ke=fromProtoBuf($e),Ye=new TextureLoader,or=new Matrix4,sr=new Vector3,cr=new Quaternion,Br=new Vector3,tn={},en=new Set,an=0,rn=Ke;an<rn.length;an++){var on=rn[an],sn=on.name,ln=on.chunks,cn=on.matrix;if(!(sn==="Ceiling"||sn==="CeilingDrop"))for(var hn=0,mn=cn;hn<mn.length;hn++){var An=mn[hn];or.elements=An.elements;for(var xn=new Group$1,pn=0;pn<ln.length;pn++){var dn=parseGeometry(ln[pn].geometry);dn.applyMatrix4(or),or.decompose(sr,cr,Br),Br.x*Br.y*Br.z<0&&dn.attributes.normal&&dn.attributes.position&&dn.attributes.uv&&flipBufferGeometryNormals(dn),Xe.add(dn);for(var fn=[],yn=0,Sn=ln[pn].material;yn<Sn.length;yn++){var gn=Sn[yn],Cn=parseMaterial(gn,Se,Be||"",De,Ye,Ve,tn,Xe,en),Mn=Cn.material,Bn=Cn.textureReady;Je.push(Bn),fn.push(Mn)}var kn=new PBMMesh(dn,fn);kn.name="chunk_"+pn,kn.matrix.compose(kn.position,kn.quaternion,kn.scale),kn.matrixAutoUpdate=!1,kn.frustumCulled=!1,xn.add(kn)}xn.name=sn,Fe.push(xn)}}return Promise.all(Je).catch(noop$1).then(function(){return{createAt:0,description:"",objects:Fe,textures:Array.from(en),dispose:function(){Xe.forEach(function(Ln){Ln.dispose()}),Xe.clear()}}})}var ROTATE_X_MATRIX$4=new Matrix4().fromArray([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]);function loadDomez($e,Se){var Be;Se===void 0&&(Se={});var De=(Be=Se.fetcher)!==null&&Be!==void 0?Be:new Fetcher({allowHosts:["*"]}),Ve={byteLength:0};return Promise.resolve().then(function(){return De.ajax($e,{responseType:"arraybuffer"})}).then(function(Fe){return Ve.byteLength=Fe.body.byteLength,lzma(Fe.body)}).then(function(Fe){var Je=Fe.reduce(function(Ye,or){return Ye+or.length},0),Xe=new Uint8Array(Je),Ke=0;return Fe.forEach(function(Ye){Xe.set(Ye,Ke),Ke+=Ye.length}),Xe}).then(function(Fe){var Je,Xe;return parse$3(Fe,(Je=Se.light)!==null&&Je!==void 0?Je:!0,Se.textureBaseUri||"",(Xe=Se.textureOptions)!==null&&Xe!==void 0?Xe:{},De)}).then(function(Fe){var Je=new Group$1;Je.matrixAutoUpdate=!1,Je.applyMatrix4(ROTATE_X_MATRIX$4),Je.matrix.compose(Je.position,Je.quaternion,Je.scale),Je.name=$e;for(var Xe=0,Ke=Fe.objects;Xe<Ke.length;Xe++){var Ye=Ke[Xe];Je.add(Ye)}return{type:"domez",upAxis:"Z",uri:$e,byteLength:Ve.byteLength,memoryUsage:getMemoryUsage(Je),scene:Je,textures:Fe.textures,dispose:function(){return Fe.dispose()}}})}var ROTATE_X_MATRIX$3=new Matrix4().fromArray([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]);function loadGltf($e,Se){var Be,De;Se===void 0&&(Se={});var Ve=(Be=Se.upAxis)!==null&&Be!==void 0?Be:"Y",Fe=(De=Se.fetcher)!==null&&De!==void 0?De:new Fetcher({allowHosts:["*"]}),Je=0;return Promise.resolve().then(function(){return Fe.ajax($e,{responseType:"arraybuffer"}).then(function(Xe){return Je=Xe.body.byteLength,Xe.body})}).then(function(Xe){var Ke;return parseGltf(Xe,{copyUV2:!1,resourcePath:$e.slice(0,$e.lastIndexOf("/")+1),search:(Ke=$e.split("?")[1])!==null&&Ke!==void 0?Ke:"",jsonModify:function(Ye){var or;if(Ye.extensionsUsed=(or=Ye.extensionsUsed)!==null&&or!==void 0?or:[],typeof Se.light=="boolean"){var sr="KHR_materials_unlit";if(Se.light){var cr=Ye.extensionsUsed.indexOf(sr);cr>=0&&Ye.extensionsUsed.splice(cr,1)}else{var cr=Ye.extensionsUsed.indexOf(sr);cr===-1&&Ye.extensionsUsed.push(sr)}}{var sr="PBM_mesh",cr=Ye.extensionsUsed.indexOf(sr);cr===-1&&Ye.extensionsUsed.push(sr)}return Ye},fetcher:Fe})}).then(function(Xe){var Ke=new Matrix4;if(Ve==="Y"&&Ke.premultiply(ROTATE_X_MATRIX$3),Xe.CESIUM_RTC){var Ye=new Matrix4().setPosition(Xe.CESIUM_RTC.center);Ke.premultiply(Ye)}var or=Xe.scene;return or.applyMatrix4(Ke),{type:"gltf",upAxis:"Z",uri:$e,byteLength:Je,memoryUsage:getMemoryUsage(or),scene:or,textures:Xe.textures,dispose:function(){return Xe.dispose()}}})}var ROTATE_X_MATRIX$2=new Matrix4().fromArray([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),scratchColor=new Color;function loadPly($e,Se){var Be,De;Se===void 0&&(Se={});var Ve=(Be=Se.upAxis)!==null&&Be!==void 0?Be:"Z",Fe=(De=Se.fetcher)!==null&&De!==void 0?De:new Fetcher({allowHosts:["*"]}),Je=0;return Promise.resolve().then(function(){return Fe.ajax($e,{responseType:"arraybuffer"}).then(function(Xe){return Je=Xe.body.byteLength,Xe.body})}).then(function(Xe){var Ke,Ye;return parsePly(Xe,{propertyNameMapping:(Ke=Se.propertyNameMapping)!==null&&Ke!==void 0?Ke:{},customPropertyMapping:(Ye=Se.customPropertyMapping)!==null&&Ye!==void 0?Ye:{}})}).then(function(Xe){var Ke=Xe.geometry;switch(Se.type){case"geometry":{var Ye=Ke;return Ve==="Y"&&Ye.applyMatrix4(ROTATE_X_MATRIX$2),{type:"ply",upAxis:"Z",uri:$e,byteLength:Je,memoryUsage:getGeometryMemoryUsed(Ye),scene:Ye,meta:{},textures:[],dispose:function(){Ke.dispose()}}}case"line":{var or="color"in Ke.attributes,sr=new LineBasicMaterial({vertexColors:or}),Ye=new Line(Ke,sr);return Ye.computeLineDistances(),Ve==="Y"&&Ye.applyMatrix4(ROTATE_X_MATRIX$2),{type:"ply",upAxis:"Z",uri:$e,byteLength:Je,memoryUsage:getMemoryUsage(Ye),scene:Ye,meta:{},textures:[],dispose:function(){Ke.dispose(),sr.dispose()}}}case"pbmMesh":{var cr=new PBMMeshMaterial(Se.light?"phong":"basic");cr.vertexColors="color"in Ke.attributes;var Ye=new Mesh(Ke,cr);return Ve==="Y"&&Ye.applyMatrix4(ROTATE_X_MATRIX$2),{type:"ply",upAxis:"Z",uri:$e,byteLength:Je,memoryUsage:getMemoryUsage(Ye),scene:Ye,meta:{},textures:[],dispose:function(){Ke.dispose(),cr.dispose()}}}case"pbmPointCloud":{var Br=new PBMPointCloudMaterial,Ye=new PBMPointCloud(Ke,Br);return Ve==="Y"&&Ye.applyMatrix4(ROTATE_X_MATRIX$2),{type:"ply",upAxis:"Z",uri:$e,byteLength:Je,memoryUsage:getMemoryUsage(Ye),scene:Ye,meta:{},textures:[],dispose:function(){Ke.dispose(),Br.dispose()}}}}throw new Error("Invalid Type: ".concat(Se.type))})}function parsePly($e,Se){var Be=new Uint8Array($e),De=extractHeaderText(Be),Ve=De.headerText,Fe=De.headerLength,Je=parseHeader(Ve,Fe,Se);if(Je.format==="ascii"){var Xe=new TextDecoder().decode(Be);return{header:Je,geometry:parseASCII(Xe,Je,Se)}}else return{header:Je,geometry:parseBinary($e,Je,Se)}}function makePlyElementProperty($e,Se){var Be={name:"",type:$e[0]};return Be.type==="list"?(Be.name=$e[3],Be.countType=$e[1],Be.itemType=$e[2]):Be.name=$e[1],Be.name in Se.propertyNameMapping&&(Be.name=Se.propertyNameMapping[Be.name]),Be}function parseHeader($e,Se,Be){Se===void 0&&(Se=0);var De=/^ply([\s\S]*)end_header(\r\n|\r|\n)/,Ve="",Fe=De.exec($e);Fe!==null&&(Ve=Fe[1]);for(var Je={format:"",version:"",comments:[],elements:[],headerLength:Se,objInfo:""},Xe=Ve.split(/\r\n|\r|\n/),Ke=null,Ye=0;Ye<Xe.length;Ye++){var or=Xe[Ye];if(or=or.trim(),or!==""){var sr=or.split(/\s+/),cr=sr.shift();switch(or=sr.join(" "),cr){case"format":Je.format=sr[0],Je.version=sr[1];break;case"comment":Je.comments.push(or);break;case"element":Ke&&Je.elements.push(Ke),Ke={name:sr[0],count:parseInt(sr[1]),properties:[]};break;case"property":Ke&&Ke.properties.push(makePlyElementProperty(sr,Be));break;case"obj_info":Je.objInfo=or;break;default:console.log("unhandled",cr,sr)}}}return Ke&&Je.elements.push(Ke),Je}function parseASCIINumber($e,Se){switch(Se){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt($e);case"float":case"double":case"float32":case"float64":return parseFloat($e);default:throw new Error("unspport type: "+Se)}}function parseASCIIElement($e,Se){for(var Be={},De=0;De<$e.length;De++){if(Se.empty())return null;if($e[De].type==="list"){for(var Ve=[],Fe=parseASCIINumber(Se.next(),$e[De].countType),Je=0;Je<Fe;Je++){if(Se.empty())return null;Ve.push(parseASCIINumber(Se.next(),$e[De].itemType))}Be[$e[De].name]=Ve}else Be[$e[De].name]=parseASCIINumber(Se.next(),$e[De].type)}return Be}function createBuffer($e){for(var Se={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[],faceVertexColors:[]},Be=0,De=Object.keys($e.customPropertyMapping);Be<De.length;Be++){var Ve=De[Be];Se[Ve]=[]}return Se}function mapElementAttributes($e){var Se=$e.map(function(De){return De.name});function Be(De){for(var Ve=0,Fe=De.length;Ve<Fe;Ve++){var Je=De[Ve];if(Se.includes(Je))return Je}return null}return{attrX:Be(["x","px","posx"])||"x",attrY:Be(["y","py","posy"])||"y",attrZ:Be(["z","pz","posz"])||"z",attrNX:Be(["nx","normalx"]),attrNY:Be(["ny","normaly"]),attrNZ:Be(["nz","normalz"]),attrS:Be(["s","u","texture_u","tx"]),attrT:Be(["t","v","texture_v","ty"]),attrR:Be(["red","diffuse_red","r","diffuse_r"]),attrG:Be(["green","diffuse_green","g","diffuse_g"]),attrB:Be(["blue","diffuse_blue","b","diffuse_b"])}}function parseASCII($e,Se,Be){var De=createBuffer(Be),Ve=/end_header\s+(\S[\s\S]*\S|\S)\s*$/,Fe,Je=null;(Je=Ve.exec($e))!==null?Fe=Je[1].split(/\s+/):Fe=[];var Xe=new ArrayStream(Fe);e:for(var Ke=0;Ke<Se.elements.length;Ke++)for(var Ye=Se.elements[Ke],or=mapElementAttributes(Ye.properties),sr=0;sr<Ye.count;sr++){var cr=parseASCIIElement(Ye.properties,Xe);if(!cr)break e;handleElement(De,Ye.name,cr,or,Be)}return postProcess(De,Be)}function postProcess($e,Se){var Be=new BufferGeometry;$e.indices.length>0&&Be.setIndex($e.indices),Be.setAttribute("position",new Float32BufferAttribute($e.vertices,3)),$e.normals.length>0&&Be.setAttribute("normal",new Float32BufferAttribute($e.normals,3)),$e.uvs.length>0&&Be.setAttribute("uv",new Float32BufferAttribute($e.uvs,2)),$e.colors.length>0&&Be.setAttribute("color",new Float32BufferAttribute($e.colors,3)),($e.faceVertexUvs.length>0||$e.faceVertexColors.length>0)&&(Be=Be.toNonIndexed(),$e.faceVertexUvs.length>0&&Be.setAttribute("uv",new Float32BufferAttribute($e.faceVertexUvs,2)),$e.faceVertexColors.length>0&&Be.setAttribute("color",new Float32BufferAttribute($e.faceVertexColors,3)));for(var De=0,Ve=Object.keys(Se.customPropertyMapping);De<Ve.length;De++){var Fe=Ve[De];if($e[Fe].length>0){var Je=Se.customPropertyMapping[Fe],Xe=Je.itemType,Ke=Je.itemNames,Ye=Je.normalized,or=Ke.length,sr=void 0;switch(Xe){case"float32":sr=new Float32BufferAttribute($e[Fe],or,Ye);break;case"uint32":sr=new Uint32BufferAttribute($e[Fe],or,Ye);break;case"int32":sr=new Int32BufferAttribute($e[Fe],or,Ye);break;case"uint16":sr=new Uint16BufferAttribute($e[Fe],or,Ye);break;case"int16":sr=new Int16BufferAttribute($e[Fe],or,Ye);break;case"uint8":sr=new Uint8BufferAttribute($e[Fe],or,Ye);break;case"int8":sr=new Int8BufferAttribute($e[Fe],or,Ye);break;default:sr=new Float32BufferAttribute($e[Fe],or,Ye);break}Be.setAttribute(Fe,sr)}}return Be.computeBoundingSphere(),Be}function handleElement($e,Se,Be,De,Ve){if(Se==="vertex"){De.attrX!==null&&De.attrY!==null&&De.attrZ!==null&&$e.vertices.push(Be[De.attrX],Be[De.attrY],Be[De.attrZ]),De.attrNX!==null&&De.attrNY!==null&&De.attrNZ!==null&&$e.normals.push(Be[De.attrNX],Be[De.attrNY],Be[De.attrNZ]),De.attrS!==null&&De.attrT!==null&&$e.uvs.push(Be[De.attrS],Be[De.attrT]),De.attrR!==null&&De.attrG!==null&&De.attrB!==null&&(scratchColor.setRGB(Be[De.attrR]/255,Be[De.attrG]/255,Be[De.attrB]/255),$e.colors.push(scratchColor.r,scratchColor.g,scratchColor.b));for(var Fe=0,Je=Object.keys(Ve.customPropertyMapping);Fe<Je.length;Fe++)for(var Xe=Je[Fe],Ke=0,Ye=Ve.customPropertyMapping[Xe].itemNames;Ke<Ye.length;Ke++){var or=Ye[Ke];$e[Xe].push(Be[or])}}else if(Se==="face"){var sr=Be.vertex_indices||Be.vertex_index,cr=Be.texcoord;sr.length===3?($e.indices.push(sr[0],sr[1],sr[2]),cr&&cr.length===6&&($e.faceVertexUvs.push(cr[0],cr[1]),$e.faceVertexUvs.push(cr[2],cr[3]),$e.faceVertexUvs.push(cr[4],cr[5]))):sr.length===4&&($e.indices.push(sr[0],sr[1],sr[3]),$e.indices.push(sr[1],sr[2],sr[3])),De.attrR!==null&&De.attrG!==null&&De.attrB!==null&&(scratchColor.setRGB(Be[De.attrR]/255,Be[De.attrG]/255,Be[De.attrB]/255),$e.faceVertexColors.push(scratchColor.r,scratchColor.g,scratchColor.b),$e.faceVertexColors.push(scratchColor.r,scratchColor.g,scratchColor.b),$e.faceVertexColors.push(scratchColor.r,scratchColor.g,scratchColor.b))}}function binaryReadElement($e,Se){for(var Be={},De=0,Ve=0;Ve<Se.length;Ve++){var Fe=Se[Ve],Je=Fe.valueReader;if(Fe.type==="list"){var Xe=[],Ke=Fe.countReader.read($e+De);De+=Fe.countReader.size;for(var Ye=0;Ye<Ke;Ye++)Xe.push(Je.read($e+De)),De+=Je.size;Be[Fe.name]=Xe}else Be[Fe.name]=Je.read($e+De),De+=Je.size}return[Be,De]}function setPropertyBinaryReaders($e,Se,Be){function De(Xe,Ke,Ye){switch(Ke){case"int8":case"char":return{read:function(or){return Xe.getInt8(or)},size:1};case"uint8":case"uchar":return{read:function(or){return Xe.getUint8(or)},size:1};case"int16":case"short":return{read:function(or){return Xe.getInt16(or,Ye)},size:2};case"uint16":case"ushort":return{read:function(or){return Xe.getUint16(or,Ye)},size:2};case"int32":case"int":return{read:function(or){return Xe.getInt32(or,Ye)},size:4};case"uint32":case"uint":return{read:function(or){return Xe.getUint32(or,Ye)},size:4};case"float32":case"float":return{read:function(or){return Xe.getFloat32(or,Ye)},size:4};case"float64":case"double":return{read:function(or){return Xe.getFloat64(or,Ye)},size:8};default:throw new Error("not support type: "+Ke)}}for(var Ve=0,Fe=$e.length;Ve<Fe;Ve++){var Je=$e[Ve];Je.type==="list"?(Je.countReader=De(Se,Je.countType,Be),Je.valueReader=De(Se,Je.itemType,Be)):Je.valueReader=De(Se,Je.type,Be)}}function parseBinary($e,Se,Be){for(var De=createBuffer(Be),Ve=Se.format==="binary_little_endian",Fe=new DataView($e,Se.headerLength),Je,Xe=0,Ke=0;Ke<Se.elements.length;Ke++){var Ye=Se.elements[Ke],or=Ye.properties,sr=mapElementAttributes(or);setPropertyBinaryReaders(or,Fe,Ve);for(var cr=0;cr<Ye.count;cr++){Je=binaryReadElement(Xe,or),Xe+=Je[1];var Br=Je[0];handleElement(De,Ye.name,Br,sr,Be)}}return postProcess(De,Be)}function extractHeaderText($e){var Se=0,Be=!0,De="",Ve=[],Fe=new TextDecoder().decode($e.subarray(0,5)),Je=/^ply\r\n/.test(Fe);do{var Xe=String.fromCharCode($e[Se++]);Xe!==`
`&&Xe!=="\r"?De+=Xe:(De==="end_header"&&(Be=!1),De!==""&&(Ve.push(De),De=""))}while(Be&&Se<$e.length);return Je===!0&&Se++,{headerText:Ve.join("\r")+"\r",headerLength:Se}}var ArrayStream=function(){function $e(Se){this.arr=Se,this.i=0}return $e.prototype.empty=function(){return this.i>=this.arr.length},$e.prototype.next=function(){return this.arr[this.i++]},$e}(),ROTATE_X_MATRIX$1=new Matrix4().fromArray([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),_object_pattern=/^[og]\s*(.+)?/,_material_library_pattern=/^mtllib /,_material_use_pattern=/^usemtl /,_map_use_pattern=/^usemap /,_face_vertex_data_separator_pattern=/\s+/,_color=new Color,ObjState=function(){function $e(){this.objects=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materials={},this.materialLibraries=[],this.startObject("",!1)}return $e.prototype.startObject=function(Se,Be){if(this.object&&this.object.fromDeclaration===!1){this.object.name=Se,this.object.fromDeclaration=Be!==!1;return}var De=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:Se||"",fromDeclaration:Be!==!1,geometry:{vertices:[],hasNormal:!0,normals:[],hasColor:!0,colors:[],hasUV:!0,uvs:[],index:[],indexMap:{}},materials:[],smooth:!0,startMaterial:function(Fe,Je){var Xe,Ke,Ye=this._finalize(!1);Ye&&(Ye.inherited||((Xe=Ye.groupCount)!==null&&Xe!==void 0?Xe:0)<=0)&&this.materials.splice((Ke=Ye.index)!==null&&Ke!==void 0?Ke:0,1);var or={index:this.materials.length,name:Fe||"",mtllib:Array.isArray(Je)&&Je.length>0?Je[Je.length-1]:"",smooth:Ye!==void 0?Ye.smooth:this.smooth,groupStart:Ye!==void 0?Ye.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(sr){var cr={index:typeof sr=="number"?sr:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(){return this}};return cr.clone=this.clone.bind(cr),cr}};return this.materials.push(or),or},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(Fe){var Je,Xe,Ke=this.currentMaterial();if(Ke&&Ke.groupEnd===-1&&(Ke.groupEnd=this.geometry.index.length,Ke.groupCount=Ke.groupEnd-((Je=Ke.groupStart)!==null&&Je!==void 0?Je:0),Ke.inherited=!1),Fe&&this.materials.length>1)for(var Ye=this.materials.length-1;Ye>=0;Ye--)((Xe=this.materials[Ye].groupCount)!==null&&Xe!==void 0?Xe:0)<=0&&this.materials.splice(Ye,1);return Fe&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),Ke}},De&&De.name&&typeof De.clone=="function"){var Ve=De.clone(0);Ve.inherited=!0,this.object.materials.push(Ve)}this.objects.push(this.object)},$e.prototype.finalize=function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},$e.prototype.parseVertexIndex=function(Se,Be){var De=parseInt(Se,10);return(De>=0?De-1:De+Be/3)*3},$e.prototype.parseNormalIndex=function(Se,Be){var De=parseInt(Se,10);return(De>=0?De-1:De+Be/3)*3},$e.prototype.parseUVIndex=function(Se,Be){var De=parseInt(Se,10);return(De>=0?De-1:De+Be/2)*2},$e.prototype.addFace=function(Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye){var or=this.object.geometry,sr=this.vertices.length,cr=this.normals.length,Br=this.uvs.length,tn=this.parseVertexIndex(Se,sr),en=this.parseVertexIndex(Be,sr),an=this.parseVertexIndex(De,sr),rn=Xe!==void 0?this.parseNormalIndex(Xe,cr):void 0,on=Ke!==void 0?this.parseNormalIndex(Ke,cr):void 0,sn=Ye!==void 0?this.parseNormalIndex(Ye,cr):void 0,ln=Ve!==void 0?this.parseUVIndex(Ve,Br):void 0,cn=Fe!==void 0?this.parseUVIndex(Fe,Br):void 0,hn=Je!==void 0?this.parseUVIndex(Je,Br):void 0;(or.hasNormal===!0&&rn===void 0||on===void 0||sn===void 0)&&(or.hasNormal=!1),(or.hasUV===!0&&ln===void 0||cn===void 0||hn===void 0)&&(or.hasUV=!1);var mn=[tn,ln,rn].join(":"),An=or.indexMap[mn];An===void 0&&(An=or.vertices.length/3,or.indexMap[mn]=An,or.vertices.push(this.vertices[tn+0],this.vertices[tn+1],this.vertices[tn+2]),or.hasColor&&(this.colors[tn]===void 0?or.hasColor=!1:or.colors.push(this.colors[tn+0],this.colors[tn+1],this.colors[tn+2])),or.hasNormal&&or.normals.push(this.normals[tn+0],this.normals[tn+1],this.normals[tn+2]),or.hasUV&&or.uvs.push(this.uvs[ln+0],this.uvs[ln+1])),or.index.push(An);var xn=[en,cn,on].join(":"),pn=or.indexMap[xn];pn===void 0&&(pn=or.vertices.length/3,or.indexMap[xn]=pn,or.vertices.push(this.vertices[en+0],this.vertices[en+1],this.vertices[en+2]),or.hasColor&&(this.colors[en]===void 0?or.hasColor=!1:or.colors.push(this.colors[en+0],this.colors[en+1],this.colors[en+2])),or.hasNormal&&or.normals.push(this.normals[en+0],this.normals[en+1],this.normals[en+2]),or.hasUV&&or.uvs.push(this.uvs[cn+0],this.uvs[cn+1])),or.index.push(pn);var dn=[an,hn,sn].join(":"),fn=or.indexMap[dn];fn===void 0&&(fn=or.vertices.length/3,or.indexMap[dn]=fn,or.vertices.push(this.vertices[an+0],this.vertices[an+1],this.vertices[an+2]),or.hasColor&&(this.colors[an]===void 0?or.hasColor=!1:or.colors.push(this.colors[an+0],this.colors[an+1],this.colors[an+2])),or.hasNormal&&or.normals.push(this.normals[an+0],this.normals[an+1],this.normals[an+2]),or.hasUV&&or.uvs.push(this.uvs[hn+0],this.uvs[hn+1])),or.index.push(fn)},$e}();function parseObj($e){var Se=new ObjState;$e.indexOf(`\r
`)!==-1&&($e=$e.replace(/\r\n/g,`
`)),$e.indexOf(`\\
`)!==-1&&($e=$e.replace(/\\\n/g,""));for(var Be=$e.split(`
`),De=[],Ve=0,Fe=Be.length;Ve<Fe;Ve++){var Je=Be[Ve].trimStart();if(Je.length!==0){var Xe=Je.charAt(0);if(Xe!=="#"){if(Xe==="v"){var Ke=Je.split(_face_vertex_data_separator_pattern);switch(Ke[0]){case"v":Se.vertices.push(parseFloat(Ke[1]),parseFloat(Ke[2]),parseFloat(Ke[3])),Ke.length>=7?(_color.setRGB(parseFloat(Ke[4]),parseFloat(Ke[5]),parseFloat(Ke[6])),_color.convertSRGBToLinear(),Se.colors.push(_color.r,_color.g,_color.b)):Se.colors.push(void 0,void 0,void 0);break;case"vn":Se.normals.push(parseFloat(Ke[1]),parseFloat(Ke[2]),parseFloat(Ke[3]));break;case"vt":Se.uvs.push(parseFloat(Ke[1]),parseFloat(Ke[2]));break}}else if(Xe==="f"){for(var Ye=Je.slice(1).trim(),or=Ye.split(_face_vertex_data_separator_pattern),sr=[],cr=0,Br=or.length;cr<Br;cr++){var tn=or[cr];if(tn.length>0){var en=tn.split("/");sr.push(en)}}for(var an=sr[0],cr=1,Br=sr.length-1;cr<Br;cr++){var rn=sr[cr],on=sr[cr+1];Se.addFace(an[0],rn[0],on[0],an[1],rn[1],on[1],an[2],rn[2],on[2])}}else if(Xe!=="l"&&Xe!=="p")if((De=_object_pattern.exec(Je))!==null){var sn=(" "+De[0].slice(1).trim()).slice(1);Se.startObject(sn)}else if(_material_use_pattern.test(Je))Se.object.startMaterial(Je.substring(7).trim(),Se.materialLibraries);else if(_material_library_pattern.test(Je))Se.materialLibraries.push(Je.substring(7).trim());else if(_map_use_pattern.test(Je))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(Xe==="s"){if(De=Je.split(" "),De.length>1){var ln=De[1].trim().toLowerCase();Se.object.smooth=ln!=="0"&&ln!=="off"}else Se.object.smooth=!0;var cn=Se.object.currentMaterial();cn&&(cn.smooth=Se.object.smooth)}else{if(Je==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+Je+'"')}}}}return Se.finalize(),Se}function parseMtl($e,Se,Be){for(var De=new TextureLoader,Ve=Se.split(`
`),Fe={name:""},Je=/\s+/,Xe={},Ke=0;Ke<Ve.length;Ke++){var Ye=Ve[Ke];if(Ye=Ye.trim(),!(Ye.length===0||Ye.charAt(0)==="#")){var or=Ye.indexOf(" "),sr=or>=0?Ye.substring(0,or):Ye;sr=sr.toLowerCase();var cr=or>=0?Ye.substring(or+1):"";if(cr=cr.trim(),sr==="newmtl")Fe={name:cr},Xe[cr]=Fe;else if(sr==="ka"||sr==="kd"||sr==="ks"||sr==="ke"){var Br=cr.split(Je,3);Fe[sr]=[parseFloat(Br[0]),parseFloat(Br[1]),parseFloat(Br[2])]}else(sr==="map_kd"||sr==="map_ks"||sr==="map_ke"||sr==="norm"||sr==="map_bump"||sr==="bump"||sr==="map_d"||sr==="ns"||sr==="d"||sr==="tr")&&(Fe[sr]=cr)}}function tn(an){var rn={url:"",scale:new Vector2(1,1),offset:new Vector2(0,0),bumpScale:1},on=an.split(/\s+/),sn;return sn=on.indexOf("-bm"),sn>=0&&(rn.bumpScale=parseFloat(on[sn+1]),on.splice(sn,2)),sn=on.indexOf("-s"),sn>=0&&(rn.scale.set(parseFloat(on[sn+1]),parseFloat(on[sn+2])),on.splice(sn,4)),sn=on.indexOf("-o"),sn>=0&&(rn.offset.set(parseFloat(on[sn+1]),parseFloat(on[sn+2])),on.splice(sn,4)),rn.url=on.join(" ").trim(),rn}function en(an,rn,on){var sn=tn(on),ln=pathJoin(Be.path,sn.url);return De.loadTexture(ln,{fetcher:Be.fetcher,encoding:rn==="map"||rn==="emissiveMap"?sRGBEncoding:LinearEncoding,minFilter:LinearFilter,magFilter:LinearFilter,wrapS:RepeatWrapping,wrapT:RepeatWrapping}).then(function(cn){var hn=cn.body;return hn.repeat.copy(sn.scale),hn.offset.copy(sn.offset),an.bumpScale=sn.bumpScale,an[rn]=hn,hn})}return{name:$e,create:function(an){var rn=new PBMMeshMaterial(Be.light?"phong":"basic"),on=[],sn=Xe[an];if(sn){if(sn.kd!==void 0&&rn.color.fromArray(sn.kd),sn.ks!==void 0&&rn.specular.fromArray(sn.ks),sn.ke!==void 0&&rn.emissive.fromArray(sn.ke),sn.map_kd!==void 0&&on.push(en(rn,"map",sn.map_kd)),sn.map_ks!==void 0&&on.push(en(rn,"specularMap",sn.map_ks)),sn.map_ke!==void 0&&on.push(en(rn,"emissiveMap",sn.map_ke)),sn.norm!==void 0&&on.push(en(rn,"normalMap",sn.norm)),sn.map_bump!==void 0&&on.push(en(rn,"bumpMap",sn.map_bump)),sn.bump!==void 0&&on.push(en(rn,"bumpMap",sn.bump)),sn.map_d!==void 0&&on.push(en(rn,"alphaMap",sn.map_d)),sn.ns!==void 0&&(rn.shininess=parseFloat(sn.ns)),sn.d!==void 0){var ln=parseFloat(sn.d);ln<1&&(rn.opacity=ln,rn.transparent=!0)}if(sn.tr!==void 0){var ln=parseFloat(sn.tr);ln>0&&(rn.opacity=1-ln,rn.transparent=!0)}}var cn=Promise.all(on).then(function(hn){return rn.refreshUniforms(),hn});return[rn,cn]}}}function build($e,Se){for(var Be,De=[],Ve=[],Fe=new Group$1,Je=function(Ye,or){var sr=$e.objects[Ye],cr=sr.geometry,Br=sr.materials,tn=!1;if(cr.vertices.length===0)return"continue";var en=new BufferGeometry;Ve.push(function(){return en.dispose()}),en.setAttribute("position",new BufferAttribute(new Float32Array(cr.vertices),3)),cr.normals.length>0&&en.setAttribute("normal",new BufferAttribute(new Float32Array(cr.normals),3)),cr.colors.length>0&&(tn=!0,en.setAttribute("color",new BufferAttribute(new Float32Array(cr.colors),3))),cr.uvs.length>0&&en.setAttribute("uv",new BufferAttribute(new Float32Array(cr.uvs),2)),cr.index.length>0&&en.setIndex(new BufferAttribute(new Uint32Array(cr.index),1)),en.computeBoundingBox(),en.computeBoundingSphere();for(var an=[],rn=function(hn,mn){var An=Br[hn],xn=An.name+"_"+An.smooth+"_"+tn,pn=$e.materials[xn];if(!pn){for(var dn=null,fn=0,yn=Se;fn<yn.length;fn++){var Sn=yn[fn],gn=Sn.name,Cn=Sn.create;gn===An.mtllib&&(dn=Cn(An.name))}if(!dn){var Mn=new PBMMeshMaterial;Mn.refreshUniforms(),dn=[Mn,Promise.resolve([])]}pn=dn[0],pn.name=An.name,pn.flatShading=!(An.smooth||en.attributes.normal),pn.vertexColors=tn,$e.materials[xn]=pn;var Bn=dn[1];De.push(Bn),Ve.push(function(){return pn.dispose()})}an.push(pn)},on=0,sn=Br.length;on<sn;on++)rn(on);en.clearGroups();for(var on=0,sn=Br.length;on<sn;on++){var ln=Br[on];ln.groupCount&&en.addGroup((Be=ln.groupStart)!==null&&Be!==void 0?Be:0,ln.groupCount,on)}(!en.groups||en.groups.length===0)&&en.addGroup(0,en.index?en.index.count:en.attributes.position.count,0);var cn=new PBMMesh(en,an);cn.name=sr.name,Fe.add(cn)},Xe=0,Ke=$e.objects.length;Xe<Ke;Xe++)Je(Xe);return Promise.all(De).then(function(Ye){for(var or=[],sr=0,cr=Ye;sr<cr.length;sr++){var Br=cr[sr];or=or.concat(Br)}return{scene:Fe,textures:or,dispose:function(){return Ve.forEach(function(tn){return tn()})}}})}function loadObj($e,Se){var Be,De;Se===void 0&&(Se={});var Ve=(Be=Se.upAxis)!==null&&Be!==void 0?Be:"Z",Fe=(De=Se.fetcher)!==null&&De!==void 0?De:new Fetcher({allowHosts:["*"]}),Je=$e.slice(0,$e.lastIndexOf("/")+1),Xe=0,Ke;return Promise.resolve().then(function(){return Fe.ajax($e,{responseType:"arraybuffer"})}).then(function(Ye){Xe=Ye.body.byteLength;var or=new TextDecoder;return or.decode(Ye.body)}).then(function(Ye){return Ke=parseObj(Ye),Promise.all(Ke.materialLibraries.map(function(or){var sr=pathJoin(Je,or),cr=sr.slice(0,sr.lastIndexOf("/")+1);return Fe.ajax(sr,{responseType:"text"}).then(function(Br){var tn;return parseMtl(or,Br.body,{path:cr,light:(tn=Se.light)!==null&&tn!==void 0?tn:!1,fetcher:Fe})})}))}).then(function(Ye){return build(Ke,Ye)}).then(function(Ye){var or=new Matrix4;return Ve==="Y"&&or.premultiply(ROTATE_X_MATRIX$1),Ye.scene.applyMatrix4(or),{type:"obj",upAxis:"Z",uri:$e,byteLength:Xe,memoryUsage:getMemoryUsage(Ye.scene),scene:Ye.scene,textures:Ye.textures,dispose:function(){return Ye.dispose()}}})}var u8=Uint8Array,u16=Uint16Array,i32=Int32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function($e,Se){for(var Be=new u16(31),De=0;De<31;++De)Be[De]=Se+=1<<$e[De-1];for(var Ve=new i32(Be[30]),De=1;De<30;++De)for(var Fe=Be[De];Fe<Be[De+1];++Fe)Ve[Fe]=Fe-Be[De]<<5|De;return{b:Be,r:Ve}},_a$3=freb(fleb,2),fl=_a$3.b,revfl=_a$3.r;fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),fd=_b.b,rev=new u16(32768);for(var i$B=0;i$B<32768;++i$B){var x$v=(i$B&43690)>>1|(i$B&21845)<<1;x$v=(x$v&52428)>>2|(x$v&13107)<<2,x$v=(x$v&61680)>>4|(x$v&3855)<<4,rev[i$B]=((x$v&65280)>>8|(x$v&255)<<8)>>1}var hMap=function($e,Se,Be){for(var De=$e.length,Ve=0,Fe=new u16(Se);Ve<De;++Ve)$e[Ve]&&++Fe[$e[Ve]-1];var Je=new u16(Se);for(Ve=1;Ve<Se;++Ve)Je[Ve]=Je[Ve-1]+Fe[Ve-1]<<1;var Xe;{Xe=new u16(1<<Se);var Ke=15-Se;for(Ve=0;Ve<De;++Ve)if($e[Ve])for(var Ye=Ve<<4|$e[Ve],or=Se-$e[Ve],sr=Je[$e[Ve]-1]++<<or,cr=sr|(1<<or)-1;sr<=cr;++sr)Xe[rev[sr]>>Ke]=Ye}return Xe},flt=new u8(288);for(var i$B=0;i$B<144;++i$B)flt[i$B]=8;for(var i$B=144;i$B<256;++i$B)flt[i$B]=9;for(var i$B=256;i$B<280;++i$B)flt[i$B]=7;for(var i$B=280;i$B<288;++i$B)flt[i$B]=8;var fdt=new u8(32);for(var i$B=0;i$B<32;++i$B)fdt[i$B]=5;var flrm=hMap(flt,9),fdrm=hMap(fdt,5),max=function($e){for(var Se=$e[0],Be=1;Be<$e.length;++Be)$e[Be]>Se&&(Se=$e[Be]);return Se},bits=function($e,Se,Be){var De=Se/8|0;return($e[De]|$e[De+1]<<8)>>(Se&7)&Be},bits16=function($e,Se){var Be=Se/8|0;return($e[Be]|$e[Be+1]<<8|$e[Be+2]<<16)>>(Se&7)},shft=function($e){return($e+7)/8|0},slc=function($e,Se,Be){return(Se==null||Se<0)&&(Se=0),(Be==null||Be>$e.length)&&(Be=$e.length),new u8($e.subarray(Se,Be))},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function($e,Se,Be){var De=new Error(Se||ec[$e]);if(De.code=$e,Error.captureStackTrace&&Error.captureStackTrace(De,err),!Be)throw De;return De},inflt=function($e,Se,Be,De){var Ve=$e.length,Fe=De?De.length:0;if(!Ve||Se.f&&!Se.l)return Be||new u8(0);var Je=!Be,Xe=Je||Se.i!=2,Ke=Se.i;Je&&(Be=new u8(Ve*3));var Ye=function(zn){var Qn=Be.length;if(zn>Qn){var Zn=new u8(Math.max(Qn*2,zn));Zn.set(Be),Be=Zn}},or=Se.f||0,sr=Se.p||0,cr=Se.b||0,Br=Se.l,tn=Se.d,en=Se.m,an=Se.n,rn=Ve*8;do{if(!Br){or=bits($e,sr,1);var on=bits($e,sr+1,3);if(sr+=3,on)if(on==1)Br=flrm,tn=fdrm,en=9,an=5;else if(on==2){var sn=bits($e,sr,31)+257,ln=bits($e,sr+10,15)+4,cn=sn+bits($e,sr+5,31)+1;sr+=14;for(var hn=new u8(cn),mn=new u8(19),An=0;An<ln;++An)mn[clim[An]]=bits($e,sr+An*3,7);sr+=ln*3;for(var xn=max(mn),pn=(1<<xn)-1,dn=hMap(mn,xn),An=0;An<cn;){var fn=dn[bits($e,sr,pn)];sr+=fn&15;var yn=fn>>4;if(yn<16)hn[An++]=yn;else{var Sn=0,gn=0;for(yn==16?(gn=3+bits($e,sr,3),sr+=2,Sn=hn[An-1]):yn==17?(gn=3+bits($e,sr,7),sr+=3):yn==18&&(gn=11+bits($e,sr,127),sr+=7);gn--;)hn[An++]=Sn}}var Cn=hn.subarray(0,sn),Mn=hn.subarray(sn);en=max(Cn),an=max(Mn),Br=hMap(Cn,en),tn=hMap(Mn,an)}else err(1);else{var yn=shft(sr)+4,Bn=$e[yn-4]|$e[yn-3]<<8,kn=yn+Bn;if(kn>Ve){Ke&&err(0);break}Xe&&Ye(cr+Bn),Be.set($e.subarray(yn,kn),cr),Se.b=cr+=Bn,Se.p=sr=kn*8,Se.f=or;continue}if(sr>rn){Ke&&err(0);break}}Xe&&Ye(cr+131072);for(var Ln=(1<<en)-1,Pn=(1<<an)-1,Vn=sr;;Vn=sr){var Sn=Br[bits16($e,sr)&Ln],Yn=Sn>>4;if(sr+=Sn&15,sr>rn){Ke&&err(0);break}if(Sn||err(2),Yn<256)Be[cr++]=Yn;else if(Yn==256){Vn=sr,Br=null;break}else{var ni=Yn-254;if(Yn>264){var An=Yn-257,Rn=fleb[An];ni=bits($e,sr,(1<<Rn)-1)+fl[An],sr+=Rn}var In=tn[bits16($e,sr)&Pn],Gn=In>>4;In||err(3),sr+=In&15;var Mn=fd[Gn];if(Gn>3){var Rn=fdeb[Gn];Mn+=bits16($e,sr)&(1<<Rn)-1,sr+=Rn}if(sr>rn){Ke&&err(0);break}Xe&&Ye(cr+131072);var Fn=cr+ni;if(cr<Mn){var Hn=Fe-Mn,Dn=Math.min(Mn,Fn);for(Hn+cr<0&&err(3);cr<Dn;++cr)Be[cr]=De[Hn+cr]}for(;cr<Fn;++cr)Be[cr]=Be[cr-Mn]}}Se.l=Br,Se.p=Vn,Se.b=cr,Se.f=or,Br&&(or=1,Se.m=en,Se.d=tn,Se.n=an)}while(!or);return cr!=Be.length&&Je?slc(Be,0,cr):Be.subarray(0,cr)},et$3=new u8(0),b2=function($e,Se){return $e[Se]|$e[Se+1]<<8},b4=function($e,Se){return($e[Se]|$e[Se+1]<<8|$e[Se+2]<<16|$e[Se+3]<<24)>>>0},b8=function($e,Se){return b4($e,Se)+b4($e,Se+4)*4294967296},zls=function($e,Se){return(($e[0]&15)!=8||$e[0]>>4>7||($e[0]<<8|$e[1])%31)&&err(6,"invalid zlib data"),($e[1]>>5&1)==1&&err(6,"invalid zlib data: "+($e[1]&32?"need":"unexpected")+" dictionary"),($e[1]>>3&4)+2};function inflateSync($e,Se){return inflt($e,{i:2},Se&&Se.out,Se&&Se.dictionary)}function unzlibSync($e,Se){return inflt($e.subarray(zls($e),-4),{i:2},Se,Se)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et$3,{stream:!0}),tds=1}catch($e){}var dutf8=function($e){for(var Se="",Be=0;;){var De=$e[Be++],Ve=(De>127)+(De>223)+(De>239);if(Be+Ve>$e.length)return{s:Se,r:slc($e,Be-1)};Ve?Ve==3?(De=((De&15)<<18|($e[Be++]&63)<<12|($e[Be++]&63)<<6|$e[Be++]&63)-65536,Se+=String.fromCharCode(55296|De>>10,56320|De&1023)):Ve&1?Se+=String.fromCharCode((De&31)<<6|$e[Be++]&63):Se+=String.fromCharCode((De&15)<<12|($e[Be++]&63)<<6|$e[Be++]&63):Se+=String.fromCharCode(De)}};function strFromU8($e,Se){if(Se){for(var Be="",De=0;De<$e.length;De+=16384)Be+=String.fromCharCode.apply(null,$e.subarray(De,De+16384));return Be}else{if(td)return td.decode($e);var Ve=dutf8($e),Fe=Ve.s,Be=Ve.r;return Be.length&&err(8),Fe}}var slzh=function($e,Se){return Se+30+b2($e,Se+26)+b2($e,Se+28)},zh=function($e,Se,Be){var De=b2($e,Se+28),Ve=strFromU8($e.subarray(Se+46,Se+46+De),!(b2($e,Se+8)&2048)),Fe=Se+46+De,Je=b4($e,Se+20),Xe=Be&&Je==4294967295?z64e($e,Fe):[Je,b4($e,Se+24),b4($e,Se+42)],Ke=Xe[0],Ye=Xe[1],or=Xe[2];return[b2($e,Se+10),Ke,Ye,Ve,Fe+b2($e,Se+30)+b2($e,Se+32),or]},z64e=function($e,Se){for(;b2($e,Se)!=1;Se+=4+b2($e,Se+2));return[b8($e,Se+12),b8($e,Se+4),b8($e,Se+20)]};function unzipSync($e,Se){for(var Be={},De=$e.length-22;b4($e,De)!=101010256;--De)(!De||$e.length-De>65558)&&err(13);var Ve=b2($e,De+8);if(!Ve)return{};var Fe=b4($e,De+16),Je=Fe==4294967295||Ve==65535;if(Je){var Xe=b4($e,De-12);Je=b4($e,Xe)==101075792,Je&&(Ve=b4($e,Xe+32),Fe=b4($e,Xe+48))}for(var Ke=0;Ke<Ve;++Ke){var Ye=zh($e,Fe,Je),or=Ye[0],sr=Ye[1],cr=Ye[2],Br=Ye[3],tn=Ye[4],en=Ye[5],an=slzh($e,en);Fe=tn,or?or==8?Be[Br]=inflateSync($e.subarray(an,an+sr),{out:new u8(cr)}):err(14,"unknown compression type "+or):Be[Br]=slc($e,an,an+sr)}return Be}var ROTATE_X_MATRIX=new Matrix4().fromArray([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]);function loadFbx($e,Se){var Be;Se===void 0&&(Se={});var De=(Be=Se.fetcher)!==null&&Be!==void 0?Be:new Fetcher({allowHosts:["*"]}),Ve=0;return Promise.resolve().then(function(){return De.ajax($e,{responseType:"arraybuffer"}).then(function(Fe){return Ve=Fe.body.byteLength,Fe.body})}).then(function(Fe){var Je;return parse$2(Fe,{light:Se.light,resourcePath:$e.slice(0,$e.lastIndexOf("/")+1),search:(Je=$e.split("?")[1])!==null&&Je!==void 0?Je:"",fetcher:De})}).then(function(Fe){var Je=Fe.scene,Xe=Fe.unitScale/100,Ke=new Matrix4;return Ke.makeScale(Xe,Xe,Xe),Fe.upAxis==="Y"&&Ke.premultiply(ROTATE_X_MATRIX),Je.applyMatrix4(Ke),{type:"fbx",upAxis:"Z",uri:$e,byteLength:Ve,memoryUsage:getMemoryUsage(Je),scene:Je,textures:Fe.textures,dispose:function(){return Fe.dispose()}}})}function parse$2($e,Se){var Be;if(isFbxFormatBinary($e))Be=new BinaryParser().parse($e);else{var De=convertArrayBufferToString($e);if(!isFbxFormatASCII(De))throw new Error("THREE.FBXLoader: Unknown format.");if(getFbxVersion(De)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+getFbxVersion(De));Be=new TextParser().parse(De)}return new FBXTreeParser(Se).parse(Be)}var FBXTreeParser=function(){function $e(Se){var Be,De,Ve;this.light=(Be=Se.light)!==null&&Be!==void 0?Be:!0,this.resourcePath=(De=Se.resourcePath)!==null&&De!==void 0?De:"",this.search=(Ve=Se.search)!==null&&Ve!==void 0?Ve:"",this.fetcher=Se.fetcher}return $e.prototype.parse=function(Se){var Be,De,Ve,Fe,Je,Xe,Ke=this.parseConnections(Se),Ye=new Group$1,or=[],sr=this.parseImages(Se),cr=this.parseTextures(Se,sr,Ke,or),Br=this.parseMaterials(Se,cr,Ke),tn=this.parseDeformers(Se,Ke),en=new GeometryParser().parse(Se,tn,Ke);this.parseScene(Se,tn,en,Br,Ke,Ye);var an=(De=(Be=Se.GlobalSettings.UpAxis)===null||Be===void 0?void 0:Be.value)!==null&&De!==void 0?De:1,rn=(Fe=(Ve=Se.GlobalSettings.FrontAxis)===null||Ve===void 0?void 0:Ve.value)!==null&&Fe!==void 0?Fe:2,on=(Xe=(Je=Se.GlobalSettings.UnitScaleFactor)===null||Je===void 0?void 0:Je.value)!==null&&Xe!==void 0?Xe:1,sn;if(Se.GlobalSettings.AmbientColor){var ln=Se.GlobalSettings.AmbientColor.value,cn=ln[0],hn=ln[1],mn=ln[2];if(cn!==0||hn!==0||mn!==0){var An=new Color().setRGB(cn,hn,mn);sn=new AmbientLight(An,1)}}return Promise.all(or).then(function(xn){return{scene:Ye,textures:xn,ambientLight:sn,upAxis:["X","Y","Z"][an],frontAxis:["X","Y","Z"][rn],unitScale:on,dispose:function(){xn.forEach(function(pn){return pn.dispose()}),Br.forEach(function(pn){return pn.dispose()}),en.forEach(function(pn){return pn.dispose()})}}})},$e.prototype.parseConnections=function(Se){var Be=new Map;if("Connections"in Se){var De=Se.Connections.connections;De.forEach(function(Ve){var Fe=Ve[0],Je=Ve[1],Xe=Ve[2];Be.has(Fe)||Be.set(Fe,{parents:[],children:[]});var Ke={ID:Je,relationship:Xe};Be.get(Fe).parents.push(Ke),Be.has(Je)||Be.set(Je,{parents:[],children:[]});var Ye={ID:Fe,relationship:Xe};Be.get(Je).children.push(Ye)})}return Be},$e.prototype.parseImages=function(Se){var Be={},De={};if("Video"in Se.Objects){var Ve=Se.Objects.Video;for(var Fe in Ve){var Je=Ve[Fe],Xe=parseInt(Fe);if(Be[Xe]=Je.RelativeFilename||Je.Filename,"Content"in Je){var Ke=Je.Content instanceof ArrayBuffer&&Je.Content.byteLength>0,Ye=typeof Je.Content=="string"&&Je.Content!=="";if(Ke||Ye){var or=this.parseImage(Ve[Fe]);De[Je.RelativeFilename||Je.Filename]=or}}}}for(var Xe in Be){var sr=Be[Xe];De[sr]!==void 0?Be[Xe]=De[sr]:Be[Xe]=Be[Xe].split("\\").pop()}return Be},$e.prototype.parseImage=function(Se){var Be=Se.Content,De=Se.RelativeFilename||Se.Filename,Ve=De.slice(De.lastIndexOf(".")+1).toLowerCase(),Fe;switch(Ve){case"bmp":Fe="image/bmp";break;case"jpg":case"jpeg":Fe="image/jpeg";break;case"png":Fe="image/png";break;case"tif":Fe="image/tiff";break;case"tga":Fe="image/tga";break;default:return}if(typeof Be=="string")return"data:"+Fe+";base64,"+Be;var Je=new Uint8Array(Be);return window.URL.createObjectURL(new Blob([Je],{type:Fe}))},$e.prototype.parseTextures=function(Se,Be,De,Ve){var Fe=new Map;if("Texture"in Se.Objects){var Je=Se.Objects.Texture;for(var Xe in Je){var Ke=this.parseTexture(Je[Xe],Be,De,Ve);Fe.set(parseInt(Xe),Ke)}}return Fe},$e.prototype.parseTexture=function(Se,Be,De,Ve){var Fe=this.loadTexture(Se,Be,De,Ve);Fe.ID=Se.id,Fe.name=Se.attrName;var Je=Se.WrapModeU,Xe=Se.WrapModeV,Ke=Je!==void 0?Je.value:0,Ye=Xe!==void 0?Xe.value:0;if(Fe.wrapS=Ke===0?RepeatWrapping:ClampToEdgeWrapping,Fe.wrapT=Ye===0?RepeatWrapping:ClampToEdgeWrapping,Se.Scaling){var or=Se.Scaling.value;Fe.repeat.x=or[0],Fe.repeat.y=or[1]}if(Se.Translation){var or=Se.Translation.value;Fe.offset.x=or[0],Fe.offset.y=or[1]}return Fe},$e.prototype.loadTexture=function(Se,Be,De,Ve){var Fe=De.get(Se.id).children,Je="";Fe!==void 0&&Fe.length>0&&Be[Fe[0].ID]!==void 0&&(Je=Be[Fe[0].ID]),Je=pathJoin(this.resourcePath,appendSearch(Je,this.search));var Xe=Object.assign(new Texture,{ID:0}),Ke;Ke=this.fetcher.loadImage(Je,{},void 0,void 0,void 0,createImageBitmapLikeImage()).then(function(or){return or.body});var Ye=Ke.then(function(or){return Xe.image=or,Xe.needsUpdate=!0,Xe});return Ve.push(Ye),Xe},$e.prototype.parseMaterials=function(Se,Be,De){var Ve=new Map;if("Material"in Se.Objects){var Fe=Se.Objects.Material;for(var Je in Fe){var Xe=this.parseMaterial(Se,Fe[Je],Be,De);Xe!==null&&Ve.set(parseInt(Je),Xe)}}return Ve},$e.prototype.parseMaterial=function(Se,Be,De,Ve){var Fe=Be.id;Be.attrName;var Je=Be.ShadingModel;if(typeof Je=="object"&&(Je=Je.value),Je=Je.toLowerCase(),!Ve.has(Fe))return null;var Xe=new PBMMeshMaterial(this.light?"phong":"basic");Be.BumpFactor&&(Xe.bumpScale=Be.BumpFactor.value),Be.Diffuse?Xe.color=new Color().fromArray(Be.Diffuse.value):Be.DiffuseColor&&(Be.DiffuseColor.type==="Color"||Be.DiffuseColor.type==="ColorRGB")&&(Xe.color=new Color().fromArray(Be.DiffuseColor.value)),Be.DisplacementFactor&&(Xe.displacementScale=Be.DisplacementFactor.value),Be.Emissive?Xe.emissive=new Color().fromArray(Be.Emissive.value):Be.EmissiveColor&&(Be.EmissiveColor.type==="Color"||Be.EmissiveColor.type==="ColorRGB")&&(Xe.emissive=new Color().fromArray(Be.EmissiveColor.value)),Be.EmissiveFactor&&(Xe.emissiveIntensity=parseFloat(Be.EmissiveFactor.value));var Ke=1-(Be.TransparencyFactor?parseFloat(Be.TransparencyFactor.value):0);(Ke===1||Ke===0)&&(Ke=Be.Opacity?parseFloat(Be.Opacity.value):null,Ke===null&&(Ke=1-(Be.TransparentColor?parseFloat(Be.TransparentColor.value[0]):0))),Xe.opacity=Ke,Xe.opacity<1&&(Xe.transparent=!0),Be.ReflectionFactor&&(Xe.reflectivity=Be.ReflectionFactor.value),Be.Shininess&&(Xe.shininess=Be.Shininess.value),Be.Specular?Xe.specular=new Color().fromArray(Be.Specular.value):Be.SpecularColor&&Be.SpecularColor.type==="Color"&&(Xe.specular=new Color().fromArray(Be.SpecularColor.value));var Ye=this;return Ve.get(Fe).children.forEach(function(or){var sr=or.relationship;switch(sr){case"Bump":Xe.bumpMap=Ye.getTexture(Se,De,or.ID,Ve);break;case"Maya|TEX_ao_map":Xe.aoMap=Ye.getTexture(Se,De,or.ID,Ve);break;case"DiffuseColor":case"Maya|TEX_color_map":Xe.map=Ye.getTexture(Se,De,or.ID,Ve),Xe.map!==void 0&&(Xe.map.encoding=sRGBEncoding);break;case"DisplacementColor":Xe.displacementMap=Ye.getTexture(Se,De,or.ID,Ve);break;case"EmissiveColor":Xe.emissiveMap=Ye.getTexture(Se,De,or.ID,Ve),Xe.emissiveMap!==void 0&&(Xe.emissiveMap.encoding=sRGBEncoding);break;case"NormalMap":case"Maya|TEX_normal_map":Xe.normalMap=Ye.getTexture(Se,De,or.ID,Ve);break;case"ReflectionColor":Xe.envMap=Ye.getTexture(Se,De,or.ID,Ve),Xe.envMap!==void 0&&(Xe.envMap.mapping=EquirectangularReflectionMapping,Xe.envMap.encoding=sRGBEncoding);break;case"SpecularColor":Xe.specularMap=Ye.getTexture(Se,De,or.ID,Ve),Xe.specularMap!==void 0&&(Xe.specularMap.encoding=sRGBEncoding);break;case"TransparentColor":case"TransparencyFactor":Xe.alphaMap=Ye.getTexture(Se,De,or.ID,Ve),Xe.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",sr);break}}),Xe.refreshUniforms(),Xe},$e.prototype.getTexture=function(Se,Be,De,Ve){return Se.Objects.LayeredTexture&&De in Se.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),De=Ve.get(De).children[0].ID),Be.get(De)},$e.prototype.parseDeformers=function(Se,Be){var De={},Ve={};if("Deformer"in Se.Objects){var Fe=Se.Objects.Deformer;for(var Je in Fe){var Xe=Fe[Je],Ke=Be.get(parseInt(Je));if(Xe.attrType==="Skin"){var Ye=this.parseSkeleton(Ke,Fe);Ye.ID=Je,Ke.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),Ye.geometryID=Ke.parents[0].ID,De[Je]=Ye}else if(Xe.attrType==="BlendShape"){var or={id:Je};or.rawTargets=this.parseMorphTargets(Ke,Fe,Be),or.id=Je,Ke.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),Ve[Je]=or}}}return{skeletons:De,morphTargets:Ve}},$e.prototype.parseSkeleton=function(Se,Be){var De=[];return Se.children.forEach(function(Ve){var Fe=Be[Ve.ID];if(Fe.attrType==="Cluster"){var Je={ID:Ve.ID,indices:[],weights:[],transformLink:new Matrix4().fromArray(Fe.TransformLink.a)};Fe.Indexes&&(Je.indices=Fe.Indexes.a,Je.weights=Fe.Weights.a),De.push(Je)}}),{ID:"",geometryID:0,rawBones:De,bones:[]}},$e.prototype.parseMorphTargets=function(Se,Be,De){for(var Ve=[],Fe=0;Fe<Se.children.length;Fe++){var Je=Se.children[Fe],Xe=Be[Je.ID],Ke={name:Xe.attrName,initialWeight:Xe.DeformPercent,id:Xe.id,fullWeights:Xe.FullWeights.a,geoID:0};if(Xe.attrType!=="BlendShapeChannel")return;Ke.geoID=De.get(parseInt(Je.ID)).children.filter(function(Ye){return Ye.relationship===void 0})[0].ID,Ve.push(Ke)}return Ve},$e.prototype.parseScene=function(Se,Be,De,Ve,Fe,Je){var Xe=this.parseModels(Se,Be.skeletons,De,Ve,Fe),Ke=Se.Objects.Model,Ye=this;Xe.forEach(function(sr){var cr=Ke[sr.ID];Ye.setLookAtProperties(Se,sr,cr,Fe,Je);var Br=Fe.get(sr.ID).parents;Br.forEach(function(tn){var en=Xe.get(tn.ID);en!==void 0&&en.add(sr)}),sr.parent===null&&Je.add(sr)}),this.bindSkeleton(Se,Be.skeletons,De,Xe,Fe),Je.traverse(function(sr){if(sr.userData.transformData){sr.parent&&(sr.userData.transformData.parentMatrix=sr.parent.matrix,sr.userData.transformData.parentMatrixWorld=sr.parent.matrixWorld);var cr=generateTransform(sr.userData.transformData);sr.applyMatrix4(cr),sr.updateWorldMatrix(!0,!0)}});var or=new AnimationParser().parse(Se,Fe,Je);Je.children.length===1&&Je.children[0]instanceof Group$1&&(Je.children[0].animations=or,Je=Je.children[0]),Je.animations=or},$e.prototype.parseModels=function(Se,Be,De,Ve,Fe){var Je=new Map,Xe=Se.Objects.Model;for(var Ke in Xe){var Ye=parseInt(Ke),or=Xe[Ke],sr=Fe.get(Ye),cr=this.buildSkeleton(sr,Be,Ye,or.attrName);if(!cr){switch(or.attrType){case"Camera":cr=this.createCamera(Se,sr);break;case"Light":cr=this.createLight(Se,sr);break;case"Mesh":cr=this.createMesh(sr,De,Ve);break;case"NurbsCurve":case"LimbNode":case"Root":cr=new Bone;break;case"Null":default:cr=new Group$1;break}cr.name=or.attrName?PropertyBinding.sanitizeNodeName(or.attrName):"",cr.userData.originalName=or.attrName,cr.ID=Ye}this.getTransformData(cr,or),Je.set(Ye,cr)}return Je},$e.prototype.buildSkeleton=function(Se,Be,De,Ve){var Fe=null;return Se.parents.forEach(function(Je){var Xe=function(Ye){var or=Be[Ye];or.rawBones.forEach(function(sr,cr){if(sr.ID===Je.ID){var Br=Fe;Fe=new Bone,Fe.matrixWorld.copy(sr.transformLink),Fe.name=Ve?PropertyBinding.sanitizeNodeName(Ve):"",Fe.userData.originalName=Ve,Fe.ID=De,or.bones[cr]=Fe,Br!==null&&Fe.add(Br)}})};for(var Ke in Be)Xe(Ke)}),Fe},$e.prototype.createCamera=function(Se,Be){var De,Ve;if(Be.children.forEach(function(Br){var tn=Se.Objects.NodeAttribute[Br.ID];tn!==void 0&&(Ve=tn)}),Ve===void 0)De=new Object3D;else{var Fe=0;Ve.CameraProjectionType!==void 0&&Ve.CameraProjectionType.value===1&&(Fe=1);var Je=1;Ve.NearPlane!==void 0&&(Je=Ve.NearPlane.value/1e3);var Xe=1e3;Ve.FarPlane!==void 0&&(Xe=Ve.FarPlane.value/1e3);var Ke=window.innerWidth,Ye=window.innerHeight;Ve.AspectWidth!==void 0&&Ve.AspectHeight!==void 0&&(Ke=Ve.AspectWidth.value,Ye=Ve.AspectHeight.value);var or=Ke/Ye,sr=45;Ve.FieldOfView!==void 0&&(sr=Ve.FieldOfView.value);var cr=Ve.FocalLength?Ve.FocalLength.value:null;switch(Fe){case 0:De=new PerspectiveCamera(sr,or,Je,Xe),cr!==null&&De.setFocalLength(cr);break;case 1:console.warn("THREE.FBXLoader: Orthographic cameras not supported yet."),De=new Object3D;break;default:console.warn("THREE.FBXLoader: Unknown camera type "+Fe+"."),De=new Object3D;break}}return De},$e.prototype.createLight=function(Se,Be){var De,Ve;if(Be.children.forEach(function(cr){var Br=Se.Objects.NodeAttribute[cr.ID];Br!==void 0&&(Ve=Br)}),Ve===void 0)De=new Object3D;else{var Fe=void 0;Ve.LightType===void 0?Fe=0:Fe=Ve.LightType.value;var Je=new Color(16777215);Ve.Color!==void 0&&(Je=new Color().fromArray(Ve.Color.value));var Xe=Ve.Intensity===void 0?1:Ve.Intensity.value/100;Ve.CastLightOnObject!==void 0&&Ve.CastLightOnObject.value===0&&(Xe=0);var Ke=0;Ve.FarAttenuationEnd!==void 0&&(Ve.EnableFarAttenuation!==void 0&&Ve.EnableFarAttenuation.value===0?Ke=0:Ke=Ve.FarAttenuationEnd.value);var Ye=1;switch(Fe){case 0:De=new PointLight(Je,Xe,Ke,Ye);break;case 1:De=new DirectionalLight(Je,Xe);break;case 2:var or=Math.PI/3;Ve.InnerAngle!==void 0&&(or=MathUtils.degToRad(Ve.InnerAngle.value));var sr=0;Ve.OuterAngle!==void 0&&(sr=MathUtils.degToRad(Ve.OuterAngle.value),sr=Math.max(sr,1)),De=new SpotLight(Je,Xe,Ke,or,sr,Ye);break;default:console.warn("THREE.FBXLoader: Unknown light type "+Ve.LightType.value+", defaulting to a PointLight."),De=new PointLight(Je,Xe);break}Ve.CastShadows!==void 0&&Ve.CastShadows.value===1&&(De.castShadow=!0)}return De},$e.prototype.createMesh=function(Se,Be,De){var Ve,Fe=null,Je=[];if(Se.children.forEach(function(Ke){Be.has(Ke.ID)&&(Fe=Be.get(Ke.ID)),De.has(Ke.ID)&&Je.push(De.get(Ke.ID))}),Je.length===0){var Xe=new PBMMeshMaterial(this.light?"phong":"basic");Xe.color=new Color(13421772),Je.push(Xe)}return"color"in Fe.attributes&&Je.forEach(function(Ke){Ke.vertexColors=!0}),(!Fe.groups||Fe.groups.length===0)&&Fe.addGroup(0,Fe.index?Fe.index.count:Fe.attributes.position.count,0),Fe.FBX_Deformer?(Ve=new PBMSkinnedMesh(Fe,Je),Ve.normalizeSkinWeights()):Ve=new PBMMesh(Fe,Je),Ve},$e.prototype.createCurve=function(Se,Be){var De=Se.children.reduce(function(Fe,Je){return Be.has(Je.ID)&&(Fe=Be.get(Je.ID)),Fe},null),Ve=new LineBasicMaterial({name:"",color:3342591,linewidth:1});return new Line(De,Ve)},$e.prototype.getTransformData=function(Se,Be){var De={};Be.InheritType&&(De.inheritType=parseInt(Be.InheritType.value)),Be.RotationOrder?De.eulerOrder=getEulerOrder(Be.RotationOrder.value):De.eulerOrder=getEulerOrder(0),Be.Lcl_Translation&&(De.translation=Be.Lcl_Translation.value),Be.PreRotation&&(De.preRotation=Be.PreRotation.value),Be.Lcl_Rotation&&(De.rotation=Be.Lcl_Rotation.value),Be.PostRotation&&(De.postRotation=Be.PostRotation.value),Be.Lcl_Scaling&&(De.scale=Be.Lcl_Scaling.value),Be.ScalingOffset&&(De.scalingOffset=Be.ScalingOffset.value),Be.ScalingPivot&&(De.scalingPivot=Be.ScalingPivot.value),Be.RotationOffset&&(De.rotationOffset=Be.RotationOffset.value),Be.RotationPivot&&(De.rotationPivot=Be.RotationPivot.value),Se.userData.transformData=De},$e.prototype.setLookAtProperties=function(Se,Be,De,Ve,Fe){if("LookAtProperty"in De){var Je=Ve.get(Be.ID).children;Je.forEach(function(Xe){if(Xe.relationship==="LookAtProperty"){var Ke=Se.Objects.Model[Xe.ID];if(Ke.Lcl_Translation){var Ye=Ke.Lcl_Translation.value;"target"in Be&&Be.target instanceof Object3D?(Be.target.position.fromArray(Ye),Fe.add(Be.target)):Be.lookAt(new Vector3().fromArray(Ye))}}})}},$e.prototype.bindSkeleton=function(Se,Be,De,Ve,Fe){var Je=this.parsePoseNodes(Se),Xe=function(Ye){var or=Be[Ye],sr=Fe.get(parseInt(or.ID)).parents;sr.forEach(function(cr){if(De.has(cr.ID)){var Br=cr.ID,tn=Fe.get(Br);tn.parents.forEach(function(en){if(Ve.has(en.ID)){var an=Ve.get(en.ID);an instanceof SkinnedMesh&&an.bind(new Skeleton(or.bones),Je[en.ID])}})}})};for(var Ke in Be)Xe(Ke)},$e.prototype.parsePoseNodes=function(Se){var Be={};if(Se.Objects.Pose){var De=Se.Objects.Pose;for(var Ve in De)if(De[Ve].attrType==="BindPose"&&De[Ve].NbPoseNodes>0){var Fe=De[Ve].PoseNode;Array.isArray(Fe)?Fe.forEach(function(Je){Be[Je.Node]=new Matrix4().fromArray(Je.Matrix.a)}):Be[Fe.Node]=new Matrix4().fromArray(Fe.Matrix.a)}}return Be},$e}(),GeometryParser=function(){function $e(){this.negativeMaterialIndices=!1}return $e.prototype.parse=function(Se,Be,De){var Ve=new Map;if("Geometry"in Se.Objects){var Fe=Se.Objects.Geometry;for(var Je in Fe){var Xe=De.get(parseInt(Je)),Ke=this.parseGeometry(Se,Xe,Fe[Je],Be);Ve.set(parseInt(Je),Ke)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),Ve},$e.prototype.parseGeometry=function(Se,Be,De,Ve){switch(De.attrType){case"Mesh":return this.parseMeshGeometry(Se,Be,De,Ve);case"NurbsCurve":return this.parseNurbsGeometry(De)}},$e.prototype.parseMeshGeometry=function(Se,Be,De,Ve){var Fe=Ve.skeletons,Je=[],Xe=Be.parents.map(function(cr){return Se.Objects.Model[cr.ID]});if(Xe.length!==0){var Ke=Be.children.reduce(function(cr,Br){return Fe[Br.ID]!==void 0&&(cr=Fe[Br.ID]),cr},null);Be.children.forEach(function(cr){Ve.morphTargets[cr.ID]!==void 0&&Je.push(Ve.morphTargets[cr.ID])});var Ye=Xe[0],or={};Ye.RotationOrder&&(or.eulerOrder=getEulerOrder(Ye.RotationOrder.value)),Ye.InheritType&&(or.inheritType=parseInt(Ye.InheritType.value)),Ye.GeometricTranslation&&(or.translation=Ye.GeometricTranslation.value),Ye.GeometricRotation&&(or.rotation=Ye.GeometricRotation.value),Ye.GeometricScaling&&(or.scale=Ye.GeometricScaling.value);var sr=generateTransform(or);return this.genGeometry(Se,De,Ke,Je,sr)}},$e.prototype.genGeometry=function(Se,Be,De,Ve,Fe){var Je=new BufferGeometry;Be.attrName&&(Je.name=Be.attrName);var Xe=this.parseGeoNode(Be,De),Ke=this.genBuffers(Xe),Ye=new Float32BufferAttribute(Ke.vertex,3);if(Ye.applyMatrix4(Fe),Je.setAttribute("position",Ye),Ke.colors.length>0&&Je.setAttribute("color",new Float32BufferAttribute(Ke.colors,3)),De&&(Je.setAttribute("skinIndex",new Uint16BufferAttribute(Ke.weightsIndices,4)),Je.setAttribute("skinWeight",new Float32BufferAttribute(Ke.vertexWeights,4)),Je.FBX_Deformer=De),Ke.normal.length>0){var or=new Matrix3().getNormalMatrix(Fe),sr=new Float32BufferAttribute(Ke.normal,3);sr.applyNormalMatrix(or),Je.setAttribute("normal",sr)}if(Ke.uvs.forEach(function(an,rn){var on=rn===0?"uv":"uv".concat(rn+1);Je.setAttribute(on,new Float32BufferAttribute(Ke.uvs[rn],2))}),Xe.material&&Xe.material.mappingType!=="AllSame"){var cr=Ke.materialIndex[0],Br=0;if(Ke.materialIndex.forEach(function(an,rn){an!==cr&&(Je.addGroup(Br,rn-Br,cr),cr=an,Br=rn)}),Je.groups.length>0){var tn=Je.groups[Je.groups.length-1],en=tn.start+tn.count;en!==Ke.materialIndex.length&&Je.addGroup(en,Ke.materialIndex.length-en,cr)}Je.groups.length===0&&Je.addGroup(0,Ke.materialIndex.length,Ke.materialIndex[0])}return this.addMorphTargets(Se,Je,Be,Ve,Fe),Je},$e.prototype.parseGeoNode=function(Se,Be){var De={};if(De.vertexPositions=Se.Vertices!==void 0?Se.Vertices.a:[],De.vertexIndices=Se.PolygonVertexIndex!==void 0?Se.PolygonVertexIndex.a:[],Se.LayerElementColor&&(De.color=this.parseVertexColors(Se.LayerElementColor[0])),Se.LayerElementMaterial&&(De.material=this.parseMaterialIndices(Se.LayerElementMaterial[0])),Se.LayerElementNormal&&(De.normal=this.parseNormals(Se.LayerElementNormal[0])),Se.LayerElementUV){De.uv=[];for(var Ve=0;Se.LayerElementUV[Ve];)Se.LayerElementUV[Ve].UV&&De.uv.push(this.parseUVs(Se.LayerElementUV[Ve])),Ve++}return De.weightTable={},Be!==null&&(De.skeleton=Be,Be.rawBones.forEach(function(Fe,Je){Fe.indices.forEach(function(Xe,Ke){De.weightTable[Xe]===void 0&&(De.weightTable[Xe]=[]),De.weightTable[Xe].push({id:Je,weight:Fe.weights[Ke]})})})),De},$e.prototype.genBuffers=function(Se){var Be={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},De=0,Ve=0,Fe=!1,Je=[],Xe=[],Ke=[],Ye=[],or=[],sr=[],cr=this;return Se.vertexIndices.forEach(function(Br,tn){var en=0,an=!1;Br<0&&(Br=Br^-1,an=!0);var rn=[],on=[];if(Je.push(Br*3,Br*3+1,Br*3+2),Se.color){var sn=getData(tn,De,Br,Se.color);Ke.push(sn[0],sn[1],sn[2])}if(Se.skeleton){if(Se.weightTable[Br]!==void 0&&Se.weightTable[Br].forEach(function(mn){on.push(mn.weight),rn.push(mn.id)}),on.length>4){Fe||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),Fe=!0);var ln=[0,0,0,0],cn=[0,0,0,0];on.forEach(function(mn,An){var xn=mn,pn=rn[An];cn.forEach(function(dn,fn,yn){if(xn>dn){yn[fn]=xn,xn=dn;var Sn=ln[fn];ln[fn]=pn,pn=Sn}})}),rn=ln,on=cn}for(;on.length<4;)on.push(0),rn.push(0);for(var hn=0;hn<4;++hn)or.push(on[hn]),sr.push(rn[hn])}if(Se.normal){var sn=getData(tn,De,Br,Se.normal);Xe.push(sn[0],sn[1],sn[2])}Se.material&&Se.material.mappingType!=="AllSame"&&(en=getData(tn,De,Br,Se.material)[0],en<0&&(cr.negativeMaterialIndices=!0,en=0)),Se.uv&&Se.uv.forEach(function(mn,An){var xn=getData(tn,De,Br,mn);Ye[An]===void 0&&(Ye[An]=[]),Ye[An].push(xn[0]),Ye[An].push(xn[1])}),Ve++,an&&(cr.genFace(Be,Se,Je,en,Xe,Ke,Ye,or,sr,Ve),De++,Ve=0,Je=[],Xe=[],Ke=[],Ye=[],or=[],sr=[])}),Be},$e.prototype.getNormalNewell=function(Se){for(var Be=new Vector3(0,0,0),De=0;De<Se.length;De++){var Ve=Se[De],Fe=Se[(De+1)%Se.length];Be.x+=(Ve.y-Fe.y)*(Ve.z+Fe.z),Be.y+=(Ve.z-Fe.z)*(Ve.x+Fe.x),Be.z+=(Ve.x-Fe.x)*(Ve.y+Fe.y)}return Be.normalize(),Be},$e.prototype.getNormalTangentAndBitangent=function(Se){var Be=this.getNormalNewell(Se),De=Math.abs(Be.z)>.5?new Vector3(0,1,0):new Vector3(0,0,1),Ve=De.cross(Be).normalize(),Fe=Be.clone().cross(Ve).normalize();return{normal:Be,tangent:Ve,bitangent:Fe}},$e.prototype.flattenVertex=function(Se,Be,De){return new Vector2(Se.dot(Be),Se.dot(De))},$e.prototype.genFace=function(Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or){var sr;if(or>3){for(var cr=[],Br=Be.baseVertexPositions||Be.vertexPositions,tn=0;tn<De.length;tn+=3)cr.push(new Vector3(Br[De[tn]],Br[De[tn+1]],Br[De[tn+2]]));for(var en=this.getNormalTangentAndBitangent(cr),an=en.tangent,rn=en.bitangent,on=[],sn=0,ln=cr;sn<ln.length;sn++){var cn=ln[sn];on.push(this.flattenVertex(cn,an,rn))}sr=ShapeUtils.triangulateShape(on,[])}else sr=[[0,1,2]];for(var hn=function(yn,Sn,gn){Se.vertex.push(Be.vertexPositions[De[yn*3]]),Se.vertex.push(Be.vertexPositions[De[yn*3+1]]),Se.vertex.push(Be.vertexPositions[De[yn*3+2]]),Se.vertex.push(Be.vertexPositions[De[Sn*3]]),Se.vertex.push(Be.vertexPositions[De[Sn*3+1]]),Se.vertex.push(Be.vertexPositions[De[Sn*3+2]]),Se.vertex.push(Be.vertexPositions[De[gn*3]]),Se.vertex.push(Be.vertexPositions[De[gn*3+1]]),Se.vertex.push(Be.vertexPositions[De[gn*3+2]]),Be.skeleton&&(Se.vertexWeights.push(Ke[yn*4]),Se.vertexWeights.push(Ke[yn*4+1]),Se.vertexWeights.push(Ke[yn*4+2]),Se.vertexWeights.push(Ke[yn*4+3]),Se.vertexWeights.push(Ke[Sn*4]),Se.vertexWeights.push(Ke[Sn*4+1]),Se.vertexWeights.push(Ke[Sn*4+2]),Se.vertexWeights.push(Ke[Sn*4+3]),Se.vertexWeights.push(Ke[gn*4]),Se.vertexWeights.push(Ke[gn*4+1]),Se.vertexWeights.push(Ke[gn*4+2]),Se.vertexWeights.push(Ke[gn*4+3]),Se.weightsIndices.push(Ye[yn*4]),Se.weightsIndices.push(Ye[yn*4+1]),Se.weightsIndices.push(Ye[yn*4+2]),Se.weightsIndices.push(Ye[yn*4+3]),Se.weightsIndices.push(Ye[Sn*4]),Se.weightsIndices.push(Ye[Sn*4+1]),Se.weightsIndices.push(Ye[Sn*4+2]),Se.weightsIndices.push(Ye[Sn*4+3]),Se.weightsIndices.push(Ye[gn*4]),Se.weightsIndices.push(Ye[gn*4+1]),Se.weightsIndices.push(Ye[gn*4+2]),Se.weightsIndices.push(Ye[gn*4+3])),Be.color&&(Se.colors.push(Je[yn*3]),Se.colors.push(Je[yn*3+1]),Se.colors.push(Je[yn*3+2]),Se.colors.push(Je[Sn*3]),Se.colors.push(Je[Sn*3+1]),Se.colors.push(Je[Sn*3+2]),Se.colors.push(Je[gn*3]),Se.colors.push(Je[gn*3+1]),Se.colors.push(Je[gn*3+2])),Be.material&&Be.material.mappingType!=="AllSame"&&(Se.materialIndex.push(Ve),Se.materialIndex.push(Ve),Se.materialIndex.push(Ve)),Be.normal&&(Se.normal.push(Fe[yn*3]),Se.normal.push(Fe[yn*3+1]),Se.normal.push(Fe[yn*3+2]),Se.normal.push(Fe[Sn*3]),Se.normal.push(Fe[Sn*3+1]),Se.normal.push(Fe[Sn*3+2]),Se.normal.push(Fe[gn*3]),Se.normal.push(Fe[gn*3+1]),Se.normal.push(Fe[gn*3+2])),Be.uv&&Be.uv.forEach(function(Cn,Mn){Se.uvs[Mn]===void 0&&(Se.uvs[Mn]=[]),Se.uvs[Mn].push(Xe[Mn][yn*2]),Se.uvs[Mn].push(Xe[Mn][yn*2+1]),Se.uvs[Mn].push(Xe[Mn][Sn*2]),Se.uvs[Mn].push(Xe[Mn][Sn*2+1]),Se.uvs[Mn].push(Xe[Mn][gn*2]),Se.uvs[Mn].push(Xe[Mn][gn*2+1])})},mn=0,An=sr;mn<An.length;mn++){var xn=An[mn],pn=xn[0],dn=xn[1],fn=xn[2];hn(pn,dn,fn)}},$e.prototype.addMorphTargets=function(Se,Be,De,Ve,Fe){if(Ve.length!==0){Be.morphTargetsRelative=!0,Be.morphAttributes.position=[];var Je=this;Ve.forEach(function(Xe){Xe.rawTargets.forEach(function(Ke){var Ye=Se.Objects.Geometry[Ke.geoID];Ye!==void 0&&Je.genMorphGeometry(Be,De,Ye,Fe,Ke.name)})})}},$e.prototype.genMorphGeometry=function(Se,Be,De,Ve,Fe){for(var Je=Be.Vertices!==void 0?Be.Vertices.a:[],Xe=Be.PolygonVertexIndex!==void 0?Be.PolygonVertexIndex.a:[],Ke=De.Vertices!==void 0?De.Vertices.a:[],Ye=De.Indexes?De.Indexes.a:[],or=Se.attributes.position.count*3,sr=new Float32Array(or),cr=0;cr<Ye.length;cr++){var Br=Ye[cr]*3;sr[Br]=Ke[cr*3],sr[Br+1]=Ke[cr*3+1],sr[Br+2]=Ke[cr*3+2]}var tn={vertexIndices:Xe,vertexPositions:sr,baseVertexPositions:Je},en=this.genBuffers(tn),an=new Float32BufferAttribute(en.vertex,3);an.name=Fe||De.attrName,an.applyMatrix4(Ve),Se.morphAttributes.position.push(an)},$e.prototype.parseNormals=function(Se){var Be=Se.MappingInformationType,De=Se.ReferenceInformationType,Ve=Se.Normals.a,Fe=[];return De==="IndexToDirect"&&(Se.NormalIndex?Fe=Se.NormalIndex.a:Se.NormalsIndex&&(Fe=Se.NormalsIndex.a)),{dataSize:3,buffer:Ve,indices:Fe,mappingType:Be,referenceType:De}},$e.prototype.parseUVs=function(Se){var Be=Se.MappingInformationType,De=Se.ReferenceInformationType,Ve=Se.UV.a,Fe=[];return De==="IndexToDirect"&&(Fe=Se.UVIndex.a),{dataSize:2,buffer:Ve,indices:Fe,mappingType:Be,referenceType:De}},$e.prototype.parseVertexColors=function(Se){var Be=Se.MappingInformationType,De=Se.ReferenceInformationType,Ve=Se.Colors.a,Fe=[];De==="IndexToDirect"&&(Fe=Se.ColorIndex.a);for(var Je=0,Xe=new Color;Je<Ve.length;Je+=4)Xe.fromArray(Ve,Je),Xe.toArray(Ve,Je);return{dataSize:4,buffer:Ve,indices:Fe,mappingType:Be,referenceType:De}},$e.prototype.parseMaterialIndices=function(Se){var Be=Se.MappingInformationType,De=Se.ReferenceInformationType;if(Be==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:De};for(var Ve=Se.Materials.a,Fe=[],Je=0;Je<Ve.length;++Je)Fe.push(Je);return{dataSize:1,buffer:Ve,indices:Fe,mappingType:Be,referenceType:De}},$e.prototype.parseNurbsGeometry=function(Se){var Be=parseInt(Se.Order);if(isNaN(Be))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",Se.Order,Se.id),new BufferGeometry;for(var De=Be-1,Ve=Se.KnotVector.a,Fe=[],Je=Se.Points.a,Xe=0,Ke=Je.length;Xe<Ke;Xe+=4)Fe.push(new Vector4().fromArray(Je,Xe));var Ye,or;if(Se.Form==="Closed")Fe.push(Fe[0]);else if(Se.Form==="Periodic"){Ye=De,or=Ve.length-1-Ye;for(var Xe=0;Xe<De;++Xe)Fe.push(Fe[Xe])}var sr=new NURBSCurve(De,Ve,Fe,Ye,or),cr=sr.getPoints(Fe.length*12);return new BufferGeometry().setFromPoints(cr)},$e}(),AnimationParser=function(){function $e(){}return $e.prototype.parse=function(Se,Be,De){var Ve=[],Fe=this.parseClips(Se,Be,De);if(Fe!==void 0)for(var Je in Fe){var Xe=Fe[Je],Ke=this.addClip(Xe,De);Ve.push(Ke)}return Ve},$e.prototype.parseClips=function(Se,Be,De){if(Se.Objects.AnimationCurve!==void 0){var Ve=this.parseAnimationCurveNodes(Se);this.parseAnimationCurves(Se,Ve,Be);var Fe=this.parseAnimationLayers(Se,Ve,Be,De),Je=this.parseAnimStacks(Se,Fe,Be);return Je}},$e.prototype.parseAnimationCurveNodes=function(Se){var Be=Se.Objects.AnimationCurveNode,De=new Map;for(var Ve in Be){var Fe=Be[Ve];if(Fe.attrName.match(/S|R|T|DeformPercent/)!==null){var Je={id:Fe.id,attr:Fe.attrName,curves:{}};De.set(Je.id,Je)}}return De},$e.prototype.parseAnimationCurves=function(Se,Be,De){var Ve=Se.Objects.AnimationCurve;for(var Fe in Ve){var Je={id:Ve[Fe].id,times:Ve[Fe].KeyTime.a.map(convertFBXTimeToSeconds),values:Ve[Fe].KeyValueFloat.a},Xe=De.get(Je.id);if(Xe!==void 0){var Ke=Xe.parents[0].ID,Ye=Xe.parents[0].relationship,or=Be.get(Ke);or&&(Ye.match(/X/)?or.curves.x=Je:Ye.match(/Y/)?or.curves.y=Je:Ye.match(/Z/)?or.curves.z=Je:Ye.match(/DeformPercent/)&&Be.has(Ke)&&(or.curves.morph=Je))}}},$e.prototype.parseAnimationLayers=function(Se,Be,De,Ve){var Fe=Se.Objects.AnimationLayer,Je=new Map,Xe=function(Ye){var or=[],sr=De.get(parseInt(Ye));if(sr!==void 0){var cr=sr.children;cr.forEach(function(Br,tn){if(Be.has(Br.ID)){var en=Be.get(Br.ID);if(en.curves.x!==void 0||en.curves.y!==void 0||en.curves.z!==void 0){if(or[tn]===void 0){var an=De.get(Br.ID).parents.filter(function(An){return An.relationship!==void 0})[0].ID;if(an!==void 0){var rn=Se.Objects.Model[an.toString()];if(rn===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",Br);return}var on={modelName:rn.attrName?PropertyBinding.sanitizeNodeName(rn.attrName):"",ID:rn.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1],transform:new Matrix4,eulerOrder:"",preRotation:[0,0,0],postRotation:[0,0,0]};Ve.traverse(function(An){An.ID===rn.id&&(on.transform=An.matrix,An.userData.transformData&&(on.eulerOrder=An.userData.transformData.eulerOrder))}),on.transform||(on.transform=new Matrix4),rn.PreRotation&&(on.preRotation=rn.PreRotation.value),rn.PostRotation&&(on.postRotation=rn.PostRotation.value),or[tn]=on}}or[tn]&&(or[tn][en.attr]=en)}else if(en.curves.morph!==void 0){if(or[tn]===void 0){var sn=De.get(Br.ID).parents.filter(function(xn){return xn.relationship!==void 0})[0].ID,ln=De.get(sn).parents[0].ID,cn=De.get(ln).parents[0].ID,an=De.get(cn).parents[0].ID,hn=Se.Objects.Model[an],mn={modelName:hn.attrName?PropertyBinding.sanitizeNodeName(hn.attrName):"",morphName:Se.Objects.Deformer[sn].attrName};or[tn]=mn}or[tn][en.attr]=en}}}),Je.set(parseInt(Ye),or)}};for(var Ke in Fe)Xe(Ke);return Je},$e.prototype.parseAnimStacks=function(Se,Be,De){var Ve=Se.Objects.AnimationStack,Fe={};for(var Je in Ve){var Xe=De.get(parseInt(Je)).children;Xe.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var Ke=Be.get(Xe[0].ID);Fe[Je]={name:Ve[Je].attrName,layer:Ke}}return Fe},$e.prototype.addClip=function(Se,Be){var De=[],Ve=this;return Se.layer.forEach(function(Fe){De=De.concat(Ve.generateTracks(Fe,Be))}),new AnimationClip(Se.name,-1,De)},$e.prototype.generateTracks=function(Se,Be){var De=[],Ve=new Vector3,Fe=new Vector3;Se.transform&&Se.transform.decompose(Ve,new Quaternion,Fe);var Je=Ve.toArray(),Xe=Fe.toArray();if(Se.T!==void 0&&Object.keys(Se.T.curves).length>0){var Ke=this.generateVectorTrack(Se.modelName,Se.T.curves,Je,"position");Ke!==void 0&&De.push(Ke)}if(Se.R!==void 0&&Object.keys(Se.R.curves).length>0){var Ye=this.generateRotationTrack(Se.modelName,Se.R.curves,Se.preRotation,Se.postRotation,Se.eulerOrder);Ye!==void 0&&De.push(Ye)}if(Se.S!==void 0&&Object.keys(Se.S.curves).length>0){var or=this.generateVectorTrack(Se.modelName,Se.S.curves,Xe,"scale");or!==void 0&&De.push(or)}if(Se.DeformPercent!==void 0){var sr=this.generateMorphTrack(Se,Be);sr!==void 0&&De.push(sr)}return De},$e.prototype.generateVectorTrack=function(Se,Be,De,Ve){var Fe=this.getTimesForAllAxes(Be),Je=this.getKeyframeTrackValues(Fe,Be,De);return new VectorKeyframeTrack(Se+"."+Ve,Fe,Je)},$e.prototype.generateRotationTrack=function(Se,Be,De,Ve,Fe){var Je,Xe;if(Be.x!==void 0&&Be.y!==void 0&&Be.z!==void 0){var Ke=this.interpolateRotations(Be.x,Be.y,Be.z,Fe);Je=Ke[0],Xe=Ke[1]}var Ye=getEulerOrder(0),or=new Quaternion,sr=new Quaternion;De!==void 0&&(De=De.map(MathUtils.degToRad),De.push(Ye),or.setFromEuler(new Euler().fromArray(De))),Ve!==void 0&&(Ve=Ve.map(MathUtils.degToRad),Ve.push(Ye),sr.setFromEuler(new Euler().fromArray(Ve)),sr.inverse());var cr=new Quaternion,Br=new Euler,tn=[];if(!Xe||!Je)return new QuaternionKeyframeTrack(Se+".quaternion",[0],[0]);for(var en=0;en<Xe.length;en+=3){if(Br.set(Xe[en],Xe[en+1],Xe[en+2],Fe),cr.setFromEuler(Br),cr.premultiply(or),cr.multiply(sr),en>2){var an=new Quaternion().fromArray(tn,(en-3)/3*4);an.dot(cr)<0&&cr.set(-cr.x,-cr.y,-cr.z,-cr.w)}cr.toArray(tn,en/3*4)}return new QuaternionKeyframeTrack(Se+".quaternion",Je,tn)},$e.prototype.generateMorphTrack=function(Se,Be){var De=Se.DeformPercent.curves.morph,Ve=De.values.map(function(Je){return Je/100}),Fe=Be.getObjectByName(Se.modelName).morphTargetDictionary[Se.morphName];return new NumberKeyframeTrack(Se.modelName+".morphTargetInfluences["+Fe+"]",De.times,Ve)},$e.prototype.getTimesForAllAxes=function(Se){var Be=[];if(Se.x!==void 0&&(Be=Be.concat(Se.x.times)),Se.y!==void 0&&(Be=Be.concat(Se.y.times)),Se.z!==void 0&&(Be=Be.concat(Se.z.times)),Be=Be.sort(function(Xe,Ke){return Xe-Ke}),Be.length>1){for(var De=1,Ve=Be[0],Fe=1;Fe<Be.length;Fe++){var Je=Be[Fe];Je!==Ve&&(Be[De]=Je,Ve=Je,De++)}Be=Be.slice(0,De)}return Be},$e.prototype.getKeyframeTrackValues=function(Se,Be,De){var Ve=De,Fe=[],Je=-1,Xe=-1,Ke=-1;return Se.forEach(function(Ye){if(Be.x&&(Je=Be.x.times.indexOf(Ye)),Be.y&&(Xe=Be.y.times.indexOf(Ye)),Be.z&&(Ke=Be.z.times.indexOf(Ye)),Je!==-1){var or=Be.x.values[Je];Fe.push(or),Ve[0]=or}else Fe.push(Ve[0]);if(Xe!==-1){var sr=Be.y.values[Xe];Fe.push(sr),Ve[1]=sr}else Fe.push(Ve[1]);if(Ke!==-1){var cr=Be.z.values[Ke];Fe.push(cr),Ve[2]=cr}else Fe.push(Ve[2])}),Fe},$e.prototype.interpolateRotations=function(Se,Be,De,Ve){var Fe=[],Je=[];Fe.push(Se.times[0]),Je.push(MathUtils.degToRad(Se.values[0])),Je.push(MathUtils.degToRad(Be.values[0])),Je.push(MathUtils.degToRad(De.values[0]));for(var Xe=1;Xe<Se.values.length;Xe++){var Ke=[Se.values[Xe-1],Be.values[Xe-1],De.values[Xe-1]];if(!(isNaN(Ke[0])||isNaN(Ke[1])||isNaN(Ke[2]))){var Ye=Ke.map(MathUtils.degToRad),or=[Se.values[Xe],Be.values[Xe],De.values[Xe]];if(!(isNaN(or[0])||isNaN(or[1])||isNaN(or[2]))){or.map(MathUtils.degToRad);var sr=[or[0]-Ke[0],or[1]-Ke[1],or[2]-Ke[2]],cr=[Math.abs(sr[0]),Math.abs(sr[1]),Math.abs(sr[2])];if(cr[0]>=180||cr[1]>=180||cr[2]>=180){var Br=Math.max.apply(Math,cr),tn=Br/180,en=new Euler(Ye[0],Ye[1],Ye[2],Ve),an=new Euler(Ye[0],Ye[1],Ye[2],Ve),rn=new Quaternion().setFromEuler(en),on=new Quaternion().setFromEuler(an);rn.dot(on)&&on.set(-on.x,-on.y,-on.z,-on.w);for(var sn=Se.times[Xe-1],ln=Se.times[Xe]-sn,cn=new Quaternion,hn=new Euler,mn=0;mn<1;mn+=1/tn)cn.copy(rn.clone().slerp(on.clone(),mn)),Fe.push(sn+mn*ln),hn.setFromQuaternion(cn,Ve),Je.push(hn.x),Je.push(hn.y),Je.push(hn.z)}else Fe.push(Se.times[Xe]),Je.push(MathUtils.degToRad(Se.values[Xe])),Je.push(MathUtils.degToRad(Be.values[Xe])),Je.push(MathUtils.degToRad(De.values[Xe]))}}}return[Fe,Je]},$e}(),TextParser=function(){function $e(){this.allNodes=new FBXTree,this.nodeStack=[],this.currentIndent=0,this.currentPropName=""}return $e.prototype.getPrevNode=function(){return this.nodeStack[this.currentIndent-2]},$e.prototype.getCurrentNode=function(){return this.nodeStack[this.currentIndent-1]},$e.prototype.getCurrentProp=function(){return this.currentProp},$e.prototype.pushStack=function(Se){this.nodeStack.push(Se),this.currentIndent+=1},$e.prototype.popStack=function(){this.nodeStack.pop(),this.currentIndent-=1},$e.prototype.setCurrentProp=function(Se,Be){this.currentProp=Se,this.currentPropName=Be},$e.prototype.parse=function(Se){this.currentIndent=0,this.allNodes=new FBXTree,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var Be=this,De=Se.split(/[\r\n]+/);return De.forEach(function(Ve,Fe){var Je=Ve.match(/^[\s\t]*;/),Xe=Ve.match(/^[\s\t]*$/);if(!(Je||Xe)){var Ke=Ve.match("^\\t{"+Be.currentIndent+"}(\\w+):(.*){"),Ye=Ve.match("^\\t{"+Be.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),or=Ve.match("^\\t{"+(Be.currentIndent-1)+"}}");Ke?Be.parseNodeBegin(Ve,Ke):Ye?Be.parseNodeProperty(Ve,Ye,De[++Fe]):or?Be.popStack():Ve.match(/^[^\s\t}]/)&&Be.parseNodePropertyContinued(Ve)}}),this.allNodes},$e.prototype.parseNodeBegin=function(Se,Be){var De=Be[1].trim().replace(/^"/,"").replace(/"$/,""),Ve=Be[2].split(",").map(function(Ke){return Ke.trim().replace(/^"/,"").replace(/"$/,"")}),Fe={name:De},Je=this.parseNodeAttr(Ve),Xe=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(De,Fe):De in Xe?(De==="PoseNode"?Xe.PoseNode.push(Fe):Xe[De].id!==void 0&&(Xe[De]={},Xe[De][Xe[De].id]=Xe[De]),Je.id!==""&&(Xe[De][Je.id]=Fe)):typeof Je.id=="number"?(Xe[De]={},Xe[De][Je.id]=Fe):De!=="Properties70"&&(De==="PoseNode"?Xe[De]=[Fe]:Xe[De]=Fe),typeof Je.id=="number"&&(Fe.id=Je.id),Je.name!==""&&(Fe.attrName=Je.name),Je.type!==""&&(Fe.attrType=Je.type),this.pushStack(Fe)},$e.prototype.parseNodeAttr=function(Se){var Be=Se[0];Se[0]!==""&&(Be=parseInt(Se[0]),isNaN(Be)&&(Be=Se[0]));var De="",Ve="";return Se.length>1&&(De=Se[1].replace(/^(\w+)::/,""),Ve=Se[2]),{id:Be,name:De,type:Ve}},$e.prototype.parseNodeProperty=function(Se,Be,De){var Ve=Be[1].replace(/^"/,"").replace(/"$/,"").trim(),Fe=Be[2].replace(/^"/,"").replace(/"$/,"").trim();Ve==="Content"&&Fe===","&&(Fe=De.replace(/"/g,"").replace(/,$/,"").trim());var Je=this.getCurrentNode(),Xe=Je.name;if(Xe==="Properties70"){this.parseNodeSpecialProperty(Se,Ve,Fe);return}if(Ve==="C"){var Ke=Fe.split(",").slice(1),Ye=parseInt(Ke[0]),or=parseInt(Ke[1]),sr=Fe.split(",").slice(3);sr=sr.map(function(cr){return cr.trim().replace(/^"/,"")}),Ve="connections",Fe=[Ye,or],append(Fe,sr),Je[Ve]===void 0&&(Je[Ve]=[])}Ve==="Node"&&(Je.id=Fe),Ve in Je&&Array.isArray(Je[Ve])?Je[Ve].push(Fe):Ve!=="a"?Je[Ve]=Fe:Je.a=Fe,this.setCurrentProp(Je,Ve),Ve==="a"&&Fe.slice(-1)!==","&&(Je.a=parseNumberArray(Fe))},$e.prototype.parseNodePropertyContinued=function(Se){var Be=this.getCurrentNode();Be.a+=Se,Se.slice(-1)!==","&&(Be.a=parseNumberArray(Be.a))},$e.prototype.parseNodeSpecialProperty=function(Se,Be,De){var Ve=De.split('",').map(function(or){return or.trim().replace(/^\"/,"").replace(/\s/,"_")}),Fe=Ve[0],Je=Ve[1],Xe=Ve[2],Ke=Ve[3],Ye=Ve[4];switch(Je){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":Ye=parseFloat(Ye);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":Ye=parseNumberArray(Ye);break}this.getPrevNode()[Fe]={type:Je,type2:Xe,flag:Ke,value:Ye},this.setCurrentProp(this.getPrevNode(),Fe)},$e}(),BinaryParser=function(){function $e(){}return $e.prototype.parse=function(Se){var Be=new BinaryReader(Se);Be.skip(23);var De=Be.getUint32();if(De<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+De);for(var Ve=new FBXTree;!this.endOfContent(Be);){var Fe=this.parseNode(Be,De);Fe!==null&&Ve.add(Fe.name,Fe)}return Ve},$e.prototype.endOfContent=function(Se){return Se.size()%16===0?(Se.getOffset()+160+16&-16)>=Se.size():Se.getOffset()+160+16>=Se.size()},$e.prototype.parseNode=function(Se,Be){var De={},Ve=Be>=7500?Se.getUint64():Se.getUint32(),Fe=Be>=7500?Se.getUint64():Se.getUint32();Be>=7500?Se.getUint64():Se.getUint32();var Je=Se.getUint8(),Xe=Se.getString(Je);if(Ve===0)return null;for(var Ke=[],Ye=0;Ye<Fe;Ye++)Ke.push(this.parseProperty(Se));var or=Ke.length>0?Ke[0]:"",sr=Ke.length>1?Ke[1]:"",cr=Ke.length>2?Ke[2]:"";for(De.singleProperty=Fe===1&&Se.getOffset()===Ve;Ve>Se.getOffset();){var Br=this.parseNode(Se,Be);Br!==null&&this.parseSubNode(Xe,De,Br)}return De.propertyList=Ke,typeof or=="number"&&(De.id=or),sr!==""&&(De.attrName=sr),cr!==""&&(De.attrType=cr),Xe!==""&&(De.name=Xe),De},$e.prototype.parseSubNode=function(Se,Be,De){if(De.singleProperty===!0){var Ve=De.propertyList[0];Array.isArray(Ve)?(Be[De.name]=De,De.a=Ve):Be[De.name]=Ve}else if(Se==="Connections"&&De.name==="C"){var Fe=[];De.propertyList.forEach(function(cr,Br){Br!==0&&Fe.push(cr)}),Be.connections===void 0&&(Be.connections=[]),Be.connections.push(Fe)}else if(De.name==="Properties70"){var Je=Object.keys(De);Je.forEach(function(cr){Be[cr]=De[cr]})}else if(Se==="Properties70"&&De.name==="P"){var Xe=De.propertyList[0],Ke=De.propertyList[1],Ye=De.propertyList[2],or=De.propertyList[3],sr=void 0;Xe.indexOf("Lcl ")===0&&(Xe=Xe.replace("Lcl ","Lcl_")),Ke.indexOf("Lcl ")===0&&(Ke=Ke.replace("Lcl ","Lcl_")),Ke==="Color"||Ke==="ColorRGB"||Ke==="Vector"||Ke==="Vector3D"||Ke.indexOf("Lcl_")===0?sr=[De.propertyList[4],De.propertyList[5],De.propertyList[6]]:sr=De.propertyList[4],Be[Xe]={type:Ke,type2:Ye,flag:or,value:sr}}else Be[De.name]===void 0?typeof De.id=="number"?(Be[De.name]={},Be[De.name][De.id]=De):Be[De.name]=De:De.name==="PoseNode"?(Array.isArray(Be[De.name])||(Be[De.name]=[Be[De.name]]),Be[De.name].push(De)):Be[De.name][De.id]===void 0&&(Be[De.name][De.id]=De)},$e.prototype.parseProperty=function(Se){var Be=Se.getString(1),De;switch(Be){case"C":return Se.getBoolean();case"D":return Se.getFloat64();case"F":return Se.getFloat32();case"I":return Se.getInt32();case"L":return Se.getInt64();case"R":return De=Se.getUint32(),Se.getArrayBuffer(De);case"S":return De=Se.getUint32(),Se.getString(De);case"Y":return Se.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var Ve=Se.getUint32(),Fe=Se.getUint32(),Je=Se.getUint32();if(Fe===0)switch(Be){case"b":case"c":return Se.getBooleanArray(Ve);case"d":return Se.getFloat64Array(Ve);case"f":return Se.getFloat32Array(Ve);case"i":return Se.getInt32Array(Ve);case"l":return Se.getInt64Array(Ve)}var Xe=unzlibSync(new Uint8Array(Se.getArrayBuffer(Je))),Ke=new BinaryReader(Xe.buffer);switch(Be){case"b":case"c":return Ke.getBooleanArray(Ve);case"d":return Ke.getFloat64Array(Ve);case"f":return Ke.getFloat32Array(Ve);case"i":return Ke.getInt32Array(Ve);case"l":return Ke.getInt64Array(Ve)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+Be)}},$e}(),BinaryReader=function(){function $e(Se,Be){this.dv=new DataView(Se),this.offset=0,this.littleEndian=Be!==void 0?Be:!0,this._textDecoder=new TextDecoder}return $e.prototype.getOffset=function(){return this.offset},$e.prototype.size=function(){return this.dv.buffer.byteLength},$e.prototype.skip=function(Se){this.offset+=Se},$e.prototype.getBoolean=function(){return(this.getUint8()&1)===1},$e.prototype.getBooleanArray=function(Se){for(var Be=[],De=0;De<Se;De++)Be.push(this.getBoolean());return Be},$e.prototype.getUint8=function(){var Se=this.dv.getUint8(this.offset);return this.offset+=1,Se},$e.prototype.getInt16=function(){var Se=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,Se},$e.prototype.getInt32=function(){var Se=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,Se},$e.prototype.getInt32Array=function(Se){for(var Be=[],De=0;De<Se;De++)Be.push(this.getInt32());return Be},$e.prototype.getUint32=function(){var Se=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,Se},$e.prototype.getInt64=function(){var Se,Be;return this.littleEndian?(Se=this.getUint32(),Be=this.getUint32()):(Be=this.getUint32(),Se=this.getUint32()),Be&2147483648?(Be=~Be&4294967295,Se=~Se&4294967295,Se===4294967295&&(Be=Be+1&4294967295),Se=Se+1&4294967295,-(Be*4294967296+Se)):Be*4294967296+Se},$e.prototype.getInt64Array=function(Se){for(var Be=[],De=0;De<Se;De++)Be.push(this.getInt64());return Be},$e.prototype.getUint64=function(){var Se,Be;return this.littleEndian?(Se=this.getUint32(),Be=this.getUint32()):(Be=this.getUint32(),Se=this.getUint32()),Be*4294967296+Se},$e.prototype.getFloat32=function(){var Se=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,Se},$e.prototype.getFloat32Array=function(Se){for(var Be=[],De=0;De<Se;De++)Be.push(this.getFloat32());return Be},$e.prototype.getFloat64=function(){var Se=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,Se},$e.prototype.getFloat64Array=function(Se){for(var Be=[],De=0;De<Se;De++)Be.push(this.getFloat64());return Be},$e.prototype.getArrayBuffer=function(Se){var Be=this.dv.buffer.slice(this.offset,this.offset+Se);return this.offset+=Se,Be},$e.prototype.getString=function(Se){var Be=this.offset,De=new Uint8Array(this.dv.buffer,Be,Se);this.skip(Se);var Ve=De.indexOf(0);return Ve>=0&&(De=new Uint8Array(this.dv.buffer,Be,Ve)),this._textDecoder.decode(De)},$e}(),FBXTree=function(){function $e(){this.Connections={connections:[]},this.Objects={Model:{},NodeAttribute:{},Geometry:{}},this.GlobalSettings={}}return $e.prototype.add=function(Se,Be){this[Se]=Be},$e}();function isFbxFormatBinary($e){var Se="Kaydara FBX Binary  \0";return $e.byteLength>=Se.length&&Se===convertArrayBufferToString($e,0,Se.length)}function isFbxFormatASCII($e){var Se=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],Be=0;function De(Je){var Xe=$e[Je-1];return $e=$e.slice(Be+Je),Be++,Xe}for(var Ve=0;Ve<Se.length;++Ve){var Fe=De(1);if(Fe===Se[Ve])return!1}return!0}function getFbxVersion($e){var Se=/FBXVersion: (\d+)/,Be=$e.match(Se);if(Be){var De=parseInt(Be[1]);return De}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function convertFBXTimeToSeconds($e){return $e/46186158e3}var dataArray=[];function getData($e,Se,Be,De){var Ve;switch(De.mappingType){case"ByPolygonVertex":Ve=$e;break;case"ByPolygon":Ve=Se;break;case"ByVertice":Ve=Be;break;case"AllSame":Ve=De.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+De.mappingType),Ve=0}De.referenceType==="IndexToDirect"&&(Ve=De.indices[Ve]);var Fe=Ve*De.dataSize,Je=Fe+De.dataSize;return slice(dataArray,De.buffer,Fe,Je)}var tempEuler=new Euler,tempVec=new Vector3;function generateTransform($e){var Se=new Matrix4,Be=new Matrix4,De=new Matrix4,Ve=new Matrix4,Fe=new Matrix4,Je=new Matrix4,Xe=new Matrix4,Ke=new Matrix4,Ye=new Matrix4,or=new Matrix4,sr=new Matrix4,cr=new Matrix4,Br=$e.inheritType?$e.inheritType:0;$e.translation&&Se.setPosition(tempVec.fromArray($e.translation));var tn=getEulerOrder(0);if($e.preRotation){var en=$e.preRotation.map(MathUtils.degToRad);en.push(tn),Be.makeRotationFromEuler(tempEuler.fromArray(en))}if($e.rotation){var en=$e.rotation.map(MathUtils.degToRad);en.push($e.eulerOrder||tn),De.makeRotationFromEuler(tempEuler.fromArray(en))}if($e.postRotation){var en=$e.postRotation.map(MathUtils.degToRad);en.push(tn),Ve.makeRotationFromEuler(tempEuler.fromArray(en)),Ve.copy(new Matrix4().getInverse(Ve))}$e.scale&&Fe.scale(tempVec.fromArray($e.scale)),$e.scalingOffset&&Xe.setPosition(tempVec.fromArray($e.scalingOffset)),$e.scalingPivot&&Je.setPosition(tempVec.fromArray($e.scalingPivot)),$e.rotationOffset&&Ke.setPosition(tempVec.fromArray($e.rotationOffset)),$e.rotationPivot&&Ye.setPosition(tempVec.fromArray($e.rotationPivot)),$e.parentMatrixWorld&&(sr.copy($e.parentMatrix),or.copy($e.parentMatrixWorld));var an=Be.clone().multiply(De).multiply(Ve),rn=new Matrix4;rn.extractRotation(or);var on=new Matrix4;on.copyPosition(or);var sn=new Matrix4().getInverse(on).multiply(or),ln=new Matrix4().getInverse(rn).multiply(sn),cn=Fe,hn=new Matrix4;if(Br===0)hn.copy(rn).multiply(an).multiply(ln).multiply(cn);else if(Br===1)hn.copy(rn).multiply(ln).multiply(an).multiply(cn);else{var mn=new Matrix4().scale(new Vector3().setFromMatrixScale(sr)),An=new Matrix4().getInverse(mn),xn=ln.clone().multiply(An);hn.copy(rn).multiply(an).multiply(xn).multiply(cn)}var pn=new Matrix4().getInverse(Ye),dn=new Matrix4().getInverse(Je),fn=Se.clone().multiply(Ke).multiply(Ye).multiply(Be).multiply(De).multiply(Ve).multiply(pn).multiply(Xe).multiply(Je).multiply(Fe).multiply(dn),yn=new Matrix4().copyPosition(fn),Sn=or.clone().multiply(yn);return cr.copyPosition(Sn),fn=cr.clone().multiply(hn),fn.premultiply(new Matrix4().getInverse(or)),fn}function getEulerOrder($e){$e=$e||0;var Se=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return $e===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),Se[0]):Se[$e]}function parseNumberArray($e){var Se=$e.split(",").map(function(Be){return parseFloat(Be)});return Se}function convertArrayBufferToString($e,Se,Be){return Se===void 0&&(Se=0),Be===void 0&&(Be=$e.byteLength),new TextDecoder().decode(new Uint8Array($e,Se,Be))}function append($e,Se){for(var Be=0,De=$e.length,Ve=Se.length;Be<Ve;Be++,De++)$e[De]=Se[Be]}function slice($e,Se,Be,De){for(var Ve=Be,Fe=0;Ve<De;Ve++,Fe++)$e[Fe]=Se[Ve];return $e}var NURBSCurve=function($e){__extends(Se,$e);function Se(Be,De,Ve,Fe,Je){var Xe=$e.call(this)||this,Ke=De?De.length-1:0,Ye=Ve?Ve.length:0;Xe.degree=Be,Xe.knots=De,Xe.controlPoints=[],Xe.startKnot=Fe||0,Xe.endKnot=Je||Ke;for(var or=0;or<Ye;++or){var sr=Ve[or];Xe.controlPoints[or]=new Vector4(sr.x,sr.y,sr.z,sr.w)}return Xe}return Se.prototype.getPoint=function(Be,De){De===void 0&&(De=new Vector3);var Ve=De,Fe=this.knots[this.startKnot]+Be*(this.knots[this.endKnot]-this.knots[this.startKnot]),Je=calcBSplinePoint(this.degree,this.knots,this.controlPoints,Fe);return Je.w!==1&&Je.divideScalar(Je.w),Ve.set(Je.x,Je.y,Je.z)},Se.prototype.getTangent=function(Be,De){De===void 0&&(De=new Vector3);var Ve=De,Fe=this.knots[0]+Be*(this.knots[this.knots.length-1]-this.knots[0]),Je=calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,Fe,1);return Ve.copy(Je[1]).normalize(),Ve},Se.prototype.toJSON=function(){var Be=$e.prototype.toJSON.call(this);return Be.degree=this.degree,Be.knots=__spreadArray([],this.knots,!0),Be.controlPoints=this.controlPoints.map(function(De){return De.toArray()}),Be.startKnot=this.startKnot,Be.endKnot=this.endKnot,Be},Se.prototype.fromJSON=function(Be){return $e.prototype.fromJSON.call(this,Be),this.degree=Be.degree,this.knots=__spreadArray([],Be.knots,!0),this.controlPoints=Be.controlPoints.map(function(De){return new Vector4(De[0],De[1],De[2],De[3])}),this.startKnot=Be.startKnot,this.endKnot=Be.endKnot,this},Se}(Curve);function findSpan($e,Se,Be){var De=Be.length-$e-1;if(Se>=Be[De])return De-1;if(Se<=Be[$e])return $e;for(var Ve=$e,Fe=De,Je=Math.floor((Ve+Fe)/2);Se<Be[Je]||Se>=Be[Je+1];)Se<Be[Je]?Fe=Je:Ve=Je,Je=Math.floor((Ve+Fe)/2);return Je}function calcBasisFunctions($e,Se,Be,De){var Ve=[],Fe=[],Je=[];Ve[0]=1;for(var Xe=1;Xe<=Be;++Xe){Fe[Xe]=Se-De[$e+1-Xe],Je[Xe]=De[$e+Xe]-Se;for(var Ke=0,Ye=0;Ye<Xe;++Ye){var or=Je[Ye+1],sr=Fe[Xe-Ye],cr=Ve[Ye]/(or+sr);Ve[Ye]=Ke+or*cr,Ke=sr*cr}Ve[Xe]=Ke}return Ve}function calcBSplinePoint($e,Se,Be,De){for(var Ve=findSpan($e,De,Se),Fe=calcBasisFunctions(Ve,De,$e,Se),Je=new Vector4(0,0,0,0),Xe=0;Xe<=$e;++Xe){var Ke=Be[Ve-$e+Xe],Ye=Fe[Xe],or=Ke.w*Ye;Je.x+=Ke.x*or,Je.y+=Ke.y*or,Je.z+=Ke.z*or,Je.w+=Ke.w*Ye}return Je}function calcBasisFunctionDerivatives($e,Se,Be,De,Ve){for(var Fe=[],Je=0;Je<=Be;++Je)Fe[Je]=0;for(var Xe=[],Je=0;Je<=De;++Je)Xe[Je]=Fe.slice(0);for(var Ke=[],Je=0;Je<=Be;++Je)Ke[Je]=Fe.slice(0);Ke[0][0]=1;for(var Ye=Fe.slice(0),or=Fe.slice(0),sr=1;sr<=Be;++sr){Ye[sr]=Se-Ve[$e+1-sr],or[sr]=Ve[$e+sr]-Se;for(var cr=0,Br=0;Br<sr;++Br){var tn=or[Br+1],en=Ye[sr-Br];Ke[sr][Br]=tn+en;var an=Ke[Br][sr-1]/Ke[sr][Br];Ke[Br][sr]=cr+tn*an,cr=en*an}Ke[sr][sr]=cr}for(var sr=0;sr<=Be;++sr)Xe[0][sr]=Ke[sr][Be];for(var rn=0;rn<=Be;++rn){for(var on=0,sn=1,ln=[],Je=0;Je<=Be;++Je)ln[Je]=Fe.slice(0);ln[0][0]=1;for(var cn=1;cn<=De;++cn){var hn=0,mn=rn-cn,An=Be-cn;rn>=cn&&(ln[sn][0]=ln[on][0]/Ke[An+1][mn],hn=ln[sn][0]*Ke[mn][An]);for(var xn=mn>=-1?1:-mn,pn=rn-1<=An?cn-1:Be-rn,dn=xn;dn<=pn;++dn)ln[sn][dn]=(ln[on][dn]-ln[on][dn-1])/Ke[An+1][mn+dn],hn+=ln[sn][dn]*Ke[mn+dn][An];rn<=An&&(ln[sn][cn]=-ln[on][cn-1]/Ke[An+1][rn],hn+=ln[sn][cn]*Ke[rn][An]),Xe[cn][rn]=hn;var sr=on;on=sn,sn=sr}}for(var fn=Be,cn=1;cn<=De;++cn){for(var sr=0;sr<=Be;++sr)Xe[cn][sr]*=fn;fn*=Be-cn}return Xe}function calcBSplineDerivatives($e,Se,Be,De,Ve){for(var Fe=Ve<$e?Ve:$e,Je=[],Xe=findSpan($e,De,Se),Ke=calcBasisFunctionDerivatives(Xe,De,$e,Fe,Se),Ye=[],or=0;or<Be.length;++or){var sr=Be[or].clone(),cr=sr.w;sr.x*=cr,sr.y*=cr,sr.z*=cr,Ye[or]=sr}for(var Br=0;Br<=Fe;++Br){for(var sr=Ye[Xe-$e].clone().multiplyScalar(Ke[Br][0]),tn=1;tn<=$e;++tn)sr.add(Ye[Xe-$e+tn].clone().multiplyScalar(Ke[Br][tn]));Je[Br]=sr}for(var Br=Fe+1;Br<=Ve+1;++Br)Je[Br]=new Vector4(0,0,0);return Je}function calcKoverI($e,Se){for(var Be=1,De=2;De<=$e;++De)Be*=De;for(var Ve=1,De=2;De<=Se;++De)Ve*=De;for(var De=2;De<=$e-Se;++De)Ve*=De;return Be/Ve}function calcRationalCurveDerivatives($e){for(var Se=$e.length,Be=[],De=[],Ve=0;Ve<Se;++Ve){var Fe=$e[Ve];Be[Ve]=new Vector3(Fe.x,Fe.y,Fe.z),De[Ve]=Fe.w}for(var Je=[],Xe=0;Xe<Se;++Xe){for(var Ke=Be[Xe].clone(),Ve=1;Ve<=Xe;++Ve)Ke.sub(Je[Xe-Ve].clone().multiplyScalar(calcKoverI(Xe,Ve)*De[Ve]));Je[Xe]=Ke.divideScalar(De[0])}return Je}function calcNURBSDerivatives($e,Se,Be,De,Ve){var Fe=calcBSplineDerivatives($e,Se,Be,De,Ve);return calcRationalCurveDerivatives(Fe)}var _vector=new Vector3;function getPointArray($e,Se){switch(Se){case"D":return new Float64Array($e);case"F":return new Float32Array($e);case"L":return new Int32Array($e);case"I":return new Int16Array($e);default:return new Uint8Array($e)}}function loadX3p($e,Se){var Be;Se===void 0&&(Se={});var De=(Be=Se.fetcher)!==null&&Be!==void 0?Be:new Fetcher({allowHosts:["*"]}),Ve={byteLength:0};return Promise.resolve().then(function(){return De.ajax($e,{responseType:"arraybuffer"})}).then(function(Fe){var Je,Xe;return Ve.byteLength=Fe.body.byteLength,parse$1(new Uint8Array(Fe.body),{light:(Je=Se.light)!==null&&Je!==void 0?Je:!0,color:Se.color,resourcePath:$e.slice(0,$e.lastIndexOf("/")+1),search:(Xe=$e.split("?")[1])!==null&&Xe!==void 0?Xe:""})}).then(function(Fe){var Je=new Group$1;return Je.matrixAutoUpdate=!1,Je.matrix.compose(Je.position,Je.quaternion,Je.scale),Je.name=$e,Je.add(Fe.object),{type:"x3p",upAxis:"Z",uri:$e,byteLength:Ve.byteLength,memoryUsage:getMemoryUsage(Je),scene:Je,textures:[],dispose:function(){return Fe.dispose()}}})}function parse$1($e,Se){for(var Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an,rn,on,sn,ln,cn,hn,mn,An,xn,pn,dn,fn,yn,Sn,gn,Cn,Mn,Bn,kn,Ln,Pn,Vn,Yn,ni,Rn,In,Gn,Fn,Hn,Dn,zn,Qn,Zn,si,ei,hi,Un,Wn,Ai,oi=unzipSync($e),ci="",ai=null,wi=0,Pi=Object.keys(oi);wi<Pi.length;wi++){var Oi=Pi[wi];/(^|\/)main\.xml$/i.test(Oi)&&(ai=oi[Oi],ci=Oi.slice(0,Oi.lastIndexOf("/")+1))}if(!ai)throw new Error("X3p: main.xml not found.");if(typeof DOMParser>"u")throw new Error("X3p: DOMParser not found.");var Ri=(Be=Se.color)!==null&&Be!==void 0?Be:new Color(10066329),_i=new DOMParser,Mi=decodeText(ai),$i=_i.parseFromString(Mi,"text/xml"),vi=$i.querySelector("Record1 Axes"),ri={x:{type:(Fe=(Ve=(De=vi?.querySelector("CX AxisType"))===null||De===void 0?void 0:De.textContent)===null||Ve===void 0?void 0:Ve.toUpperCase())!==null&&Fe!==void 0?Fe:"I",dataType:(Ke=(Xe=(Je=vi?.querySelector("CX DataType"))===null||Je===void 0?void 0:Je.textContent)===null||Xe===void 0?void 0:Xe.toUpperCase())!==null&&Ke!==void 0?Ke:"D",increment:Number((or=(Ye=vi?.querySelector("CX Increment"))===null||Ye===void 0?void 0:Ye.textContent)!==null&&or!==void 0?or:"1"),offset:Number((cr=(sr=vi?.querySelector("CX Offset"))===null||sr===void 0?void 0:sr.textContent)!==null&&cr!==void 0?cr:"0")},y:{type:(en=(tn=(Br=vi?.querySelector("CY AxisType"))===null||Br===void 0?void 0:Br.textContent)===null||tn===void 0?void 0:tn.toUpperCase())!==null&&en!==void 0?en:"I",dataType:(on=(rn=(an=vi?.querySelector("CY DataType"))===null||an===void 0?void 0:an.textContent)===null||rn===void 0?void 0:rn.toUpperCase())!==null&&on!==void 0?on:"D",increment:Number((ln=(sn=vi?.querySelector("CY Increment"))===null||sn===void 0?void 0:sn.textContent)!==null&&ln!==void 0?ln:"1"),offset:Number((hn=(cn=vi?.querySelector("CY Offset"))===null||cn===void 0?void 0:cn.textContent)!==null&&hn!==void 0?hn:"0")},z:{type:(xn=(An=(mn=vi?.querySelector("CZ AxisType"))===null||mn===void 0?void 0:mn.textContent)===null||An===void 0?void 0:An.toUpperCase())!==null&&xn!==void 0?xn:"A",dataType:(fn=(dn=(pn=vi?.querySelector("CZ DataType"))===null||pn===void 0?void 0:pn.textContent)===null||dn===void 0?void 0:dn.toUpperCase())!==null&&fn!==void 0?fn:"D",increment:Number((Sn=(yn=vi?.querySelector("CZ Increment"))===null||yn===void 0?void 0:yn.textContent)!==null&&Sn!==void 0?Sn:"1"),offset:Number((Cn=(gn=vi?.querySelector("CZ Offset"))===null||gn===void 0?void 0:gn.textContent)!==null&&Cn!==void 0?Cn:"0")}},Ti=null,Bi=$i.querySelector("Record1 Axes Rotation");Bi&&(Ti=new Matrix3,Ti.set(Number((Bn=(Mn=Bi.querySelector("r11"))===null||Mn===void 0?void 0:Mn.textContent)!==null&&Bn!==void 0?Bn:0),Number((Ln=(kn=Bi.querySelector("r12"))===null||kn===void 0?void 0:kn.textContent)!==null&&Ln!==void 0?Ln:0),Number((Vn=(Pn=Bi.querySelector("r13"))===null||Pn===void 0?void 0:Pn.textContent)!==null&&Vn!==void 0?Vn:0),Number((ni=(Yn=Bi.querySelector("r21"))===null||Yn===void 0?void 0:Yn.textContent)!==null&&ni!==void 0?ni:0),Number((In=(Rn=Bi.querySelector("r22"))===null||Rn===void 0?void 0:Rn.textContent)!==null&&In!==void 0?In:0),Number((Fn=(Gn=Bi.querySelector("r23"))===null||Gn===void 0?void 0:Gn.textContent)!==null&&Fn!==void 0?Fn:0),Number((Dn=(Hn=Bi.querySelector("r31"))===null||Hn===void 0?void 0:Hn.textContent)!==null&&Dn!==void 0?Dn:0),Number((Qn=(zn=Bi.querySelector("r32"))===null||zn===void 0?void 0:zn.textContent)!==null&&Qn!==void 0?Qn:0),Number((si=(Zn=Bi.querySelector("r33"))===null||Zn===void 0?void 0:Zn.textContent)!==null&&si!==void 0?si:0)));var qi=(ei=$i.querySelector("Record3 DataLink PointDataLink"))===null||ei===void 0?void 0:ei.textContent;if(typeof qi!="string")throw new Error("X3p: PointDataLink not found.");qi=pathJoin(ci,qi);var Ii=oi[qi];if(!Ii)throw new Error("X3p: ".concat(Ii," not found."));for(var Ui=getPointArray(Ii.buffer,ri.z.dataType),ho=Number((Un=(hi=$i.querySelector("Record3 MatrixDimension SizeX"))===null||hi===void 0?void 0:hi.textContent)!==null&&Un!==void 0?Un:"0"),lo=Number((Ai=(Wn=$i.querySelector("Record3 MatrixDimension SizeY"))===null||Wn===void 0?void 0:Wn.textContent)!==null&&Ai!==void 0?Ai:"0"),po=Math.floor(ho-1),co=Math.floor(lo-1),go=po+1,vo=co+1,Eo=new Float32Array(go*vo*3),Oo=new Float32Array(go*vo*2),Bo=new Uint32Array(po*co*6),Po=new Box3,Kn=0;Kn<vo;Kn++)for(var mi=Kn*ri.y.increment+ri.y.offset,gi=0;gi<go;gi++){var xi=Kn*go+gi,ki=gi*ri.x.increment+ri.x.offset,Ki=Ui[xi],Yi=!isNaN(Ki),ji=Yi?Ki:NaN;_vector.set(ki,-mi,ji),Ti&&_vector.applyMatrix3(Ti),Yi&&Po.expandByPoint(_vector),Eo[xi*3+0]=_vector.x,Eo[xi*3+1]=_vector.y,Eo[xi*3+2]=_vector.z,Oo[xi*2+0]=gi/po,Oo[xi*2+1]=1-Kn/co}for(var Kn=0;Kn<co;Kn++)for(var gi=0;gi<po;gi++){var Wi=gi+go*Kn,Gi=gi+go*(Kn+1),Mo=gi+1+go*(Kn+1),bo=gi+1+go*Kn,fo=(Kn*po+gi)*6;Bo[fo+0]=Wi,Bo[fo+1]=Gi,Bo[fo+2]=bo,Bo[fo+3]=Gi,Bo[fo+4]=Mo,Bo[fo+5]=bo}var Hi=new BufferGeometry;Hi.setAttribute("position",new BufferAttribute(Eo,3)),Hi.setAttribute("uv",new BufferAttribute(Oo,2)),Hi.setIndex(new BufferAttribute(Bo,1)),(!Hi.groups||Hi.groups.length===0)&&Hi.addGroup(0,Hi.index?Hi.index.count:Hi.attributes.position.count,0),Hi.boundingBox=Po;var eo=new PBMMeshMaterial(Se.light?"phong":"basic");eo.flatShading=!0,eo.color.copy(Ri),eo.refreshUniforms();var mo=new PBMMesh(Hi,[eo]);return{object:mo,dispose:function(){Hi.dispose(),eo.dispose()}}}var scratchMatrix4$3=new Matrix4,MAX_RETRY_DELAY$1=5e3,RETRY_DELAY_STEP$1=1e3;function attachTileAttributes($e,Se){$e.name=Se.id;var Be=Se.tileset.properties.floorInfo;$e.traverse(function(De){if("floor"in Se.extras){if(De instanceof Mesh||De instanceof Points)for(var Ve=Array.isArray(De.material)?De.material:De.material?[De.material]:[],Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe];(Xe instanceof PBMMeshMaterial||Xe instanceof PBMPointCloudMaterial)&&(Xe.floorIndex=Se.extras.floor)}}else if(!(De instanceof PBMPointCloud)&&(De instanceof PBMMesh||De instanceof PBMSkinnedMesh)&&Be){for(var Ke=new Box3().expandByObject(De),Ye=Ke.getCenter(new Vector3),or=0,sr=0;sr<Be.length;sr++){var cr=Be[sr],Br=cr.ground,tn=cr.height;if(Ye.y<Br+tn){or=sr;break}}Se.floor=or,Se.tileset.floorLength=Math.max(Se.tileset.floorLength,Se.floor+1),De.material.forEach(function(en){return en.floorIndex=or})}})}function loadTileContent($e,Se){if(!$e.content)return Promise.resolve($e);var Be=$e.content,De=appendSearch(Be.uri,Se.search);if($e.type==="TILESET"){var Ve=imageURL(De,{key:"model.".concat($e.siblingIndex)});return Be.loadState="LOADING",Be.loadStateUpdateTime=now$2(),Se.fetcher.ajax(Ve,{responseType:"text"}).then(function(Fe){return Fe.body}).then(function(Fe){var Je=De.slice(0,De.lastIndexOf("/")+1);return normalizeTilesetHeader(JSON.parse(Fe),Je)}).then(function(Fe){Be.loadState="READY",Be.loadStateUpdateTime=now$2(),Be.loadfailRetryDelay=0,$e.children.length===0&&($e.children=[new Tile("".concat($e.id,".0"),Fe.root,$e.tileset,$e)])}).then(function(){return $e}).catch(function(Fe){return Be.loadState="FAILED",Be.loadStateUpdateTime=now$2(),Be.loadfailRetryDelay=Math.min(Be.loadfailRetryDelay+1e3,5e3),Promise.reject(Fe)})}if($e.type==="SCENEGRAPH")return Be.loadState="LOADING",Be.loadStateUpdateTime=now$2(),Promise.resolve().then(function(){var Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en="",an=De.split("#"),rn=an[0],on=an[1],sn=(on||rn).split("?")[0].match(/\.([0-9a-zA-Z]+)$/);if(sn&&(en=sn[1]),en==="b3dm"){var ln=imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadB3dm(ln,{upAxis:$e.tileset.asset.gltfUpAxis,light:Se.light,fetcher:Se.fetcher}).then(function(cn){return cn.scene.applyMatrix4($e.transform),cn.scene.updateWorldMatrix(!1,!0),cn.scene.matrixAutoUpdate=!1,attachTileAttributes(cn.scene,$e),cn})}if(en==="pnts"){var ln=imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadPnts(ln,{computeBoundingBox:!1,fetcher:Se.fetcher}).then(function(hn){if(hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,$e.boundingVolume){var mn=$e.boundingVolume;hn.scene.traverse(function(An){if(An instanceof PBMPointCloud){scratchMatrix4$3.getInverse(An.matrixWorld);var xn=new Box3;mn.getBoundingBox(xn),xn.applyMatrix4(scratchMatrix4$3),An.geometry.boundingBox=xn}})}return attachTileAttributes(hn.scene,$e),hn})}if(en==="glb"||en==="gltf"){var ln=imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadGltf(ln,{upAxis:$e.tileset.asset.gltfUpAxis,light:Se.light,fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,attachTileAttributes(hn.scene,$e),hn})}if(en==="at3d"){var ln=$e.extras.at3d?De:imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadAt3d(ln,{light:Se.light,textureBaseUri:(Fe=$e.extras.at3d)===null||Fe===void 0?void 0:Fe.textureBaseUri,textureArray:(Je=$e.extras.at3d)===null||Je===void 0?void 0:Je.textureArray,textureOptions:(Xe=$e.extras.at3d)===null||Xe===void 0?void 0:Xe.textureOptions,fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,hn})}if(en==="pbm"){var ln=$e.extras.pbm?De:imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadPbm(ln,{light:Se.light,textureBaseUri:(Ke=$e.extras.pbm)===null||Ke===void 0?void 0:Ke.textureBaseUri,textureArray:(Ye=$e.extras.pbm)===null||Ye===void 0?void 0:Ye.textureArray,textureOptions:(or=$e.extras.pbm)===null||or===void 0?void 0:or.textureOptions,fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,hn})}if(en==="dome"){var ln=$e.extras.dome?De:imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadDome(ln,{light:Se.light,textureBaseUri:(sr=$e.extras.dome)===null||sr===void 0?void 0:sr.textureBaseUri,textureOptions:(cr=$e.extras.dome)===null||cr===void 0?void 0:cr.textureOptions,fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,hn})}if(en==="domez"){var ln=$e.extras.domez?De:imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadDomez(ln,{light:Se.light,textureBaseUri:(Br=$e.extras.domez)===null||Br===void 0?void 0:Br.textureBaseUri,textureOptions:(tn=$e.extras.domez)===null||tn===void 0?void 0:tn.textureOptions,fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,hn})}if(en==="ply"){var ln=$e.extras.ply?De:imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadPly(ln,{type:"pbmPointCloud",light:Se.light,upAxis:"Z",fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,hn})}if(en==="obj"){var ln=$e.extras.obj?De:imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadObj(ln,{upAxis:"Z",light:Se.light,fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,hn})}if(en==="fbx"){var ln=$e.extras.obj?De:imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadFbx(ln,{light:Se.light,fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,hn})}if(en==="x3p"){var ln=$e.extras.x3p?De:imageURL(De,{key:"model.".concat($e.siblingIndex)});return loadX3p(ln,{light:Se.light,fetcher:Se.fetcher}).then(function(hn){return hn.scene.applyMatrix4($e.transform),hn.scene.updateWorldMatrix(!1,!0),hn.scene.matrixAutoUpdate=!1,hn})}throw new Error("Invalid Tile content: ".concat(De))}).then(function(Fe){Fe.scene.traverse(function(Xe){if(Xe instanceof PBMPointCloud)Xe.material.uniforms.geometricError.value=$e.geometricError;else if(Xe instanceof PBMMesh||Xe instanceof PBMSkinnedMesh)for(var Ke=0,Ye=Xe.material;Ke<Ye.length;Ke++){var or=Ye[Ke];or.uniforms.geometricError.value=$e.geometricError}});var Je={type:Fe.type,uri:Fe.uri,byteLength:Fe.byteLength,memoryUsage:Fe.memoryUsage,object:new TileNode($e.id,Fe.scene,Fe.dispose)};return Promise.resolve().then(function(){return Promise.all([Je.object.generateBvhTree(),Se.renderer&&Fe.textures.length<16?initTextures(Fe.textures,Se.renderer,1024*1024):null])}).then(function(){return Be.loadState="READY",Be.loadStateUpdateTime=now$2(),Be.loadfailRetryDelay=0,Be.byteLength=Je.byteLength,Be.memoryUsage=Je.memoryUsage,Be.data=Je,$e}).catch(function(Xe){return unloadTileContent($e),Promise.reject(Xe)})}).catch(function(Fe){return Be.loadState="FAILED",Be.loadStateUpdateTime=now$2(),Fe instanceof NetworkResponseError&&Fe.httpStatus===0||Fe instanceof NetworkTimeoutError||Fe instanceof NetworkProxyError?Be.loadfailRetryDelay=clamp$1(Be.loadfailRetryDelay+RETRY_DELAY_STEP$1,RETRY_DELAY_STEP$1,MAX_RETRY_DELAY$1):Be.loadfailRetryDelay=1/0,Promise.reject(Fe)});throw new Error("Invalid Tile type: ".concat($e.type))}function unloadTileContent($e){$e.content&&($e.content.data&&$e.content.data.object.dispose(),$e.content.data=void 0,$e.content.loadState="UNLOADED",$e.content.loadStateUpdateTime=now$2(),$e.content.byteLength=0,$e.content.memoryUsage=0)}var TrajectoryNode=function($e){__extends(Se,$e);function Se(Be,De,Ve){Ve===void 0&&(Ve=noop$1);var Fe=$e.call(this)||this;return Fe.name=Be,Fe.contentObject=De,Fe.name=Be,Fe.add(De),Fe.disposers=[Ve],Fe}return Se.prototype.update=function(Be,De,Ve){var Fe=this.contentObject.material[2];Fe.uniforms.dashOffset.value=(Fe.uniforms.dashOffset.value-.003)%(Fe.uniforms.dashSize.value.x+Fe.uniforms.dashSize.value.y),Ve.needsRender=!0},Se.prototype.dispose=function(){for(var Be=0,De=this.disposers;Be<De.length;Be++){var Ve=De[Be];Ve()}this.disposers.length=0},Se.prototype.clone=function(){return new Se(this.name,this.contentObject.clone())},Se}(Object3D),MAX_RETRY_DELAY=5e3,RETRY_DELAY_STEP=1e3,TRAJECTOR_PIPE_SHADER={vertexShader:`
varying vec2 vUv;
uniform float displacementScalar;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
  vUv = uv;
  #include <color_vertex>
  #include <begin_vertex>
  vec3 objectNormal = vec3( normal );
  transformed += normalize( objectNormal ) * displacementScalar;
  #include <morphtarget_vertex>
  #include <project_vertex>
  #include <logdepthbuf_vertex>
  #include <clipping_planes_vertex>
  #include <fog_vertex>
}
`,fragmentShader:`
varying vec2 vUv;
uniform vec3 diffuse;
uniform vec3 diffuse2;
uniform float opacity;
uniform float dashOffset;
uniform vec2 dashSize;
uniform float totalLength;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {
  if (mod(abs(vUv.x * totalLength + dashOffset), (dashSize.x + dashSize.y)) > dashSize.x) {
    discard;
  }
  #include <clipping_planes_fragment>
  vec3 outgoingLight = vec3( 0.0 );
  vec4 diffuseColor = vec4( mix(diffuse, diffuse2, vUv.x), opacity );

  #include <logdepthbuf_fragment>
  #include <color_fragment>

  outgoingLight = diffuseColor.rgb; // simple shader

  gl_FragColor = vec4( outgoingLight, diffuseColor.a );

  #include <tonemapping_fragment>
  #include <encodings_fragment>
  #include <fog_fragment>
  #include <premultiplied_alpha_fragment>
}
`,uniforms:{diffuse:{value:new Color},diffuse2:{value:new Color},opacity:{value:1},displacementScalar:{value:0},totalLength:{value:1},dashSize:{value:new Vector3},dashOffset:{value:0}}},TRAJECTOR_SPHERE_SHADER={vertexShader:`
uniform float displacementScalar;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
  #include <color_vertex>
  #include <begin_vertex>
  vec3 objectNormal = vec3( normal );
  transformed += normalize( objectNormal ) * displacementScalar;
  #include <morphtarget_vertex>
  #include <project_vertex>
  #include <logdepthbuf_vertex>
  #include <clipping_planes_vertex>
  #include <fog_vertex>
}
`,fragmentShader:`
uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {
  #include <clipping_planes_fragment>
  vec3 outgoingLight = vec3( 0.0 );
  vec4 diffuseColor = vec4( diffuse, opacity );

  #include <logdepthbuf_fragment>
  #include <color_fragment>

  outgoingLight = diffuseColor.rgb; // simple shader

  gl_FragColor = vec4( outgoingLight, diffuseColor.a );

  #include <tonemapping_fragment>
  #include <encodings_fragment>
  #include <fog_fragment>
  #include <premultiplied_alpha_fragment>
}
`,uniforms:{diffuse:{value:new Color},opacity:{value:1},displacementScalar:{value:0}}};function createPipeBufferGeometry($e,Se,Be,De){for(var Ve=new Float32Array((Be+1)*(De+1)*3),Fe=new Float32Array((Be+1)*(De+1)*3),Je=new Float32Array((Be+1)*(De+1)*2),Xe=new Uint32Array(Be*De*6),Ke=$e.computeFrenetFrames(Be),Ye=new Vector3,or=new Vector3,sr=new Vector2,cr=new Vector3,Br=0;Br<=Be;Br++){cr=$e.getPointAt(Br/Be,cr);for(var tn=Ke.normals[Br],en=Ke.binormals[Br],an=0;an<=De;an++){var rn=Br*(De+1)+an,on=an/De*Math.PI*2,sn=Math.sin(on),ln=-Math.cos(on);or.x=ln*tn.x+sn*en.x,or.y=ln*tn.y+sn*en.y,or.z=ln*tn.z+sn*en.z,or.normalize(),or.toArray(Fe,rn*3),Ye.x=cr.x+Se*or.x,Ye.y=cr.y+Se*or.y,Ye.z=cr.z+Se*or.z,Ye.toArray(Ve,rn*3),sr.x=Br/Be,sr.y=an/De,sr.toArray(Je,rn*2)}}for(var Br=0;Br<Be;Br++)for(var an=0;an<De;an++){var cn=(Br*De+an)*6,hn=(De+1)*Br+an,mn=(De+1)*(Br+1)+an,An=(De+1)*(Br+1)+(an+1),xn=(De+1)*Br+(an+1);Xe[cn]=hn,Xe[cn+1]=mn,Xe[cn+2]=xn,Xe[cn+3]=mn,Xe[cn+4]=An,Xe[cn+5]=xn}var pn=new BufferGeometry;return pn.setIndex(new BufferAttribute(Xe,1)),pn.setAttribute("position",new BufferAttribute(Ve,3)),pn.setAttribute("normal",new BufferAttribute(Fe,3)),pn.setAttribute("uv",new BufferAttribute(Je,2)),pn}function parseTrajectoryObject($e,Se){for(var Be=new Color(0).convertSRGBToLinear(),De=new Color(52949).convertSRGBToLinear(),Ve=new Color(3370495).convertSRGBToLinear(),Fe=new Color(16777215).convertSRGBToLinear(),Je=0,Xe=new CurvePath,Ke=$e.length,Ye=3;Ye<Ke;Ye+=3){var or=new Vector3().fromArray($e,Ye-3),sr=new Vector3().fromArray($e,Ye);Je+=or.distanceTo(sr);var cr=new LineCurve3(or,sr);Xe.add(cr)}var Br=.03,tn=Math.ceil(Je*100),en=6,an=createPipeBufferGeometry(Xe,Br,tn,en);an.clearGroups(),an.addGroup(0,an.index?an.index.count:an.attributes.position.count,0),an.addGroup(0,an.index?an.index.count:an.attributes.position.count,1),an.addGroup(0,an.index?an.index.count:an.attributes.position.count,2);var rn=new ShaderMaterial({vertexShader:TRAJECTOR_PIPE_SHADER.vertexShader,fragmentShader:TRAJECTOR_PIPE_SHADER.fragmentShader,uniforms:UniformsUtils.clone(TRAJECTOR_PIPE_SHADER.uniforms),side:BackSide});rn.uniforms.totalLength.value=Je,rn.uniforms.diffuse.value=Be,rn.uniforms.diffuse2.value=Be,rn.uniforms.opacity.value=.5,rn.transparent=!0;var on=new ShaderMaterial({vertexShader:TRAJECTOR_PIPE_SHADER.vertexShader,fragmentShader:TRAJECTOR_PIPE_SHADER.fragmentShader,uniforms:UniformsUtils.clone(TRAJECTOR_PIPE_SHADER.uniforms),side:BackSide});on.uniforms.totalLength.value=Je,on.uniforms.displacementScalar.value=-.01,on.uniforms.diffuse.value=De,on.uniforms.diffuse2.value=Ve;var sn=new ShaderMaterial({vertexShader:TRAJECTOR_PIPE_SHADER.vertexShader,fragmentShader:TRAJECTOR_PIPE_SHADER.fragmentShader,uniforms:UniformsUtils.clone(TRAJECTOR_PIPE_SHADER.uniforms),side:DoubleSide});sn.uniforms.totalLength.value=Je,sn.uniforms.displacementScalar.value=-.026,sn.uniforms.dashSize.value=new Vector2(.06,.09),sn.uniforms.diffuse.value=Fe,sn.uniforms.diffuse2.value=Fe;var ln=new Mesh(an,[rn,on,sn]),cn=.08,hn=24,mn=new SphereBufferGeometry(cn,hn,hn);mn.clearGroups(),mn.addGroup(0,an.index?an.index.count:an.attributes.position.count,0),mn.addGroup(0,an.index?an.index.count:an.attributes.position.count,1);var An=new ShaderMaterial({vertexShader:TRAJECTOR_SPHERE_SHADER.vertexShader,fragmentShader:TRAJECTOR_SPHERE_SHADER.fragmentShader,uniforms:UniformsUtils.clone(TRAJECTOR_SPHERE_SHADER.uniforms),side:BackSide});An.uniforms.diffuse.value=Be,An.uniforms.opacity.value=.5,An.transparent=!0;var xn=new ShaderMaterial({vertexShader:TRAJECTOR_SPHERE_SHADER.vertexShader,fragmentShader:TRAJECTOR_SPHERE_SHADER.fragmentShader,uniforms:UniformsUtils.clone(TRAJECTOR_SPHERE_SHADER.uniforms),side:FrontSide});xn.uniforms.displacementScalar.value=-.01,xn.uniforms.diffuse.value=De;var pn=new Mesh(mn,[An,xn]);pn.position.fromArray($e,0),ln.add(pn);var dn=new ShaderMaterial({vertexShader:TRAJECTOR_SPHERE_SHADER.vertexShader,fragmentShader:TRAJECTOR_SPHERE_SHADER.fragmentShader,uniforms:UniformsUtils.clone(TRAJECTOR_SPHERE_SHADER.uniforms),side:FrontSide});dn.uniforms.displacementScalar.value=-.01,dn.uniforms.diffuse.value=Ve;var fn=new Mesh(mn,[An,dn]);return fn.position.fromArray($e,$e.length-3),ln.add(fn),{scene:ln,dispose:function(){an.dispose(),rn.dispose(),on.dispose(),sn.dispose(),mn.dispose(),An.dispose(),xn.dispose(),dn.dispose()}}}function loadTrajectory($e,Se){var Be=$e.name,De=appendSearch($e.content.uri,Se.search),Ve=imageURL(De,{key:"model.0"});return $e.content.loadState="LOADING",$e.content.loadStateUpdateTime=now$2(),loadPly(Ve,{type:"geometry",customPropertyMapping:{time:{itemType:"uint32",itemNames:["time_milisec"]}},fetcher:Se.fetcher}).then(function(Fe){var Je,Xe,Ke,Ye,or=(Xe=(Je=Fe.scene.attributes)===null||Je===void 0?void 0:Je.time.array)!==null&&Xe!==void 0?Xe:[],sr=(Ye=(Ke=Fe.scene.attributes)===null||Ke===void 0?void 0:Ke.position.array)!==null&&Ye!==void 0?Ye:[],cr=Fe.byteLength,Br=Fe.memoryUsage,tn=parseTrajectoryObject(sr);tn.scene.applyMatrix4($e.transform),tn.scene.updateWorldMatrix(!1,!0),tn.scene.matrixAutoUpdate=!1;var en=new TrajectoryNode(Be,tn.scene);return $e.content.data={uri:Ve,byteLength:cr,memoryUsage:Br,positionArray:sr,timeArray:or,object:en},$e.content.byteLength=cr,$e.content.memoryUsage=Br,$e.content.loadState="READY",$e.content.loadStateUpdateTime=now$2(),$e}).catch(function(Fe){return $e.content.data=void 0,$e.content.loadState="FAILED",$e.content.loadStateUpdateTime=now$2(),Fe instanceof NetworkResponseError&&Fe.httpStatus===0||Fe instanceof NetworkTimeoutError||Fe instanceof NetworkProxyError?$e.content.loadfailRetryDelay=clamp$1($e.content.loadfailRetryDelay+RETRY_DELAY_STEP,RETRY_DELAY_STEP,MAX_RETRY_DELAY):$e.content.loadfailRetryDelay=1/0,Promise.reject(Fe)})}function unloadTrajectory($e){$e.content&&($e.content.data&&$e.content.data.object.dispose(),$e.content.data=void 0,$e.content.loadState="UNLOADED",$e.content.loadStateUpdateTime=now$2(),$e.content.byteLength=0,$e.content.memoryUsage=0)}var scratchVector3$1=new Vector3,scratchMatrix3=new Matrix3,scratchMatrix4$2=new Matrix4,a$E=6378137,invF=298.257223563;function ecefToLla($e){for(var Se=a$E-a$E/invF,Be=(a$E*a$E-Se*Se)/(a$E*a$E),De=Math.sqrt($e.x*$e.x+$e.y*$e.y),Ve=1e-12,Fe=1e3,Je=0,Xe=Math.atan2($e.z,De),Ke=0;Je++<Fe;){var Ye=Math.sin(Xe),or=a$E/Math.sqrt(1-Be*Ye*Ye);Ke=De/Math.cos(Xe)-or;var sr=Math.atan2($e.z/(or*(1-Be)+Ke),De/(or+Ke));if(isNaN(sr))break;var cr=Math.abs(sr-Xe);if(cr<Ve)break;Xe=sr}return $e.set(Xe,Math.atan2($e.y,$e.x),Ke)}function llaToEcef($e){var Se=$e.x,Be=$e.y,De=$e.z,Ve=a$E-a$E/invF,Fe=(a$E*a$E-Ve*Ve)/(a$E*a$E),Je=Math.sin(Se),Xe=Math.cos(Se),Ke=Math.sin(Be),Ye=Math.cos(Be),or=a$E/Math.sqrt(1-Fe*Je*Je),sr=(or+De)*Xe*Ye,cr=(or+De)*Xe*Ke,Br=(Ve*Ve/(a$E*a$E)*or+De)*Je;return $e.set(sr,cr,Br)}function getEcefToEnuMatrix($e,Se){var Be=ecefToLla(scratchVector3$1.copy($e)),De=Be.x,Ve=Be.y,Fe=Be.z,Je=Math.sin(De),Xe=Math.sin(Ve),Ke=Math.cos(De),Ye=Math.cos(Ve);Se.fromArray([-Xe,-Je*Ye,Ke*Ye,0,+Ye,-Je*Xe,Ke*Xe,0,0,Ke,Je,0,0,0,0,1]);var or=scratchMatrix3.setFromMatrix4(Se),sr=scratchVector3$1.copy($e).applyMatrix3(or).multiplyScalar(-1);Se.setPosition(sr);var cr=scratchMatrix4$2.fromArray([1,0,0,0,0,1,0,0,0,0,1,0,0,0,Fe,1]);return Se.premultiply(cr),Se}var StencilConstants={TILE_MASK:128,SKIP_LOD_MASK:112,SKIP_LOD_BIT_SHIFT:4},SKIP_BACKFACE_MATERIAL=function(){var $e=new MeshBasicMaterial;return $e.side=BackSide,$e.color.setHex(16711935),$e.colorWrite=!1,$e.stencilWrite=!0,$e.polygonOffset=!0,$e.polygonOffsetFactor=2,$e.polygonOffsetUnits=2,$e.stencilRef=StencilConstants.TILE_MASK,$e.stencilFunc=AlwaysStencilFunc,$e.stencilFuncMask=StencilConstants.TILE_MASK,$e.stencilZPass=ReplaceStencilOp,$e.stencilWriteMask=StencilConstants.TILE_MASK,$e}(),SKIP_BACKFACE_TRANSPARENT_MATERIAL=function(){var $e=new MeshBasicMaterial;return $e.visible=!1,$e}(),CLEAR_STENCIL_GEOMETRY=new BufferGeometry,CLEAR_STENCIL_MATERIAL=new MeshBasicMaterial,Tile3DModel=function($e){__extends(Se,$e);function Se(Be,De,Ve){var Fe,Je,Xe,Ke=$e.call(this)||this;return Ke.modelIndex=0,Ke.renderObjects=[],Ke.backfaceObjects=[],Ke.debugObjects=[],Ke.tileObjects=[],Ke.debug="none",Ke.name=Ve.name,Ke.type=Ve.type,Ke.light=Ve.light,Ke.upAxis=Ve.upAxis,Ke.model=Be,Ke.fetcher=Ve.fetcher,Ke.search=(Fe=Ve.search)!==null&&Fe!==void 0?Fe:"",Ke.groundHeight=Ve.groundHeight,Ke.coordinateTransform=Ve.coordinateTransform,Ke.boundingBox=new Box3,Ke.minLevelOfDetail=Se.DEFAULT_MIN_LEVEL_OF_DETAIL,Ke.maxLevelOfDetail=Se.DEFAULT_MAX_LEVEL_OF_DETAIL,Ke.minGeometricError=Se.DEFAULT_MIN_GEOMETRIC_ERROR,Ke.maxGeometricError=Se.DEFAULT_MAX_GEOMETRIC_ERROR,Ke.panoramaMinGeometricError=Se.DEFAULT_PANORAMA_MIN_GEOMETRIC_ERROR,Ke.needsRefined=!0,Ke.refined=!1,Ke.refineProgress=[0,0],Ke.loaded=!1,Ke.modelsLoaded=!1,Ke.disposed=!1,Ke.needsRender=!0,Ke.lastRenderHash="",Ke.matrixAutoUpdate=!1,Ke.cacheCameras=[],Ke.clearStencilObject=new Mesh(CLEAR_STENCIL_GEOMETRY,CLEAR_STENCIL_MATERIAL),Ke.clearStencilObject.frustumCulled=!1,Ke.clearStencilObject.onAfterRender=function(Ye){return Ye.clearStencil()},Ke.tileset=new Tileset((Xe=(Je=Ke.model.work)===null||Je===void 0?void 0:Je.workCode)!==null&&Xe!==void 0?Xe:"",De,{referer:Ve.referer,tileLoader:function(Ye){return Ke.loadContent(Ye)},tileUnloader:function(Ye){return Ke.unloadContent(Ye)},onTileLoad:function(){},onTileUnload:function(Ye){},onTileError:function(Ye,or){Ve.onError&&Ve.onError(Object.assign(or,{error:or})),console.error("Tile error",Ye.id,or)},trajectoryLoader:function(Ye){return Ke.loadTrajectory(Ye)},trajectoryUnloader:function(Ye){return Ke.unloadTrajectory(Ye)},onTrajectoryLoad:function(){},onTrajectoryUnload:function(Ye){},onTrajectoryError:function(Ye,or){Ve.onError&&Ve.onError(Object.assign(or,{error:or})),console.error("Trajectory error",Ye,or)}}),Ke.tileset.root.boundingVolume&&Ke.tileset.root.boundingVolume.getBoundingBox(Ke.boundingBox),Ke}return Se.prototype.getRecommendProps=function(Be){var De,Ve,Fe;Be===void 0&&(Be={});var Je,Xe,Ke,Ye=128;Be.powerPreference==="high"&&(Ye=512);var or=typeof this.tileset.rootMeta.creationTime=="string";if(or){var sr=typeof this.tileset.rootMeta.numTotalPoints=="number"&&this.tileset.rootMeta.numTotalPoints>0;if(sr){Ke=4,Be.powerPreference==="high"&&(Ke=2),Je=Ke/1.6;var cr=0;if(((De=this.tileset.rootMeta.taskParameters)===null||De===void 0?void 0:De.point_homogenization)==="1"&&!((Ve=this.tileset.rootMeta.taskParameters)===null||Ve===void 0)&&Ve.homo_point_density){var Br=Number((Fe=this.tileset.rootMeta.taskParameters)===null||Fe===void 0?void 0:Fe.homo_point_density);isFinite(Br)&&!isNaN(Br)&&(cr=Br)}cr<=0&&(cr=.02),Xe=cr*1.4}else Ke=5,Be.powerPreference==="high"&&(Ke=4),Je=1,Xe=.03}else Ke=6,Je=1,Xe=.03,this.name==="aerophoto"?(Ke=12,Be.powerPreference==="high"&&(Ke=10)):this.tileset.asset.extras&&typeof this.tileset.asset.extras.name=="string"&&/^matterport\b/i.test(this.tileset.asset.extras.name)&&(Ke=5,Be.powerPreference==="high"&&(Ke=4));return{pointScale:Xe,pointMinPixel:Je,maxScreenSpaceError:Ke,maxMemoryUsage:Ye}},Se.prototype.getRenderHash=function(){return jsonHash([this.tileset.id,this.tileset.skipLevelOfDetail,this.tileset.selectedTiles.map(function(Be){return Be.id}),this.tileset.selectedTrajectories.map(function(Be){return Be.index}),this.debug])},Object.defineProperty(Se.prototype,"maxMemoryUsage",{get:function(){return this.tileset.maxMemoryUsage},set:function(Be){this.tileset.maxMemoryUsage=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"maxRequests",{get:function(){return this.tileset.maxRequests},set:function(Be){this.tileset.maxRequests=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"requestOrder",{get:function(){return this.tileset.tileRequestOrder},set:function(Be){this.tileset.tileRequestOrder=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"skipLevelOfDetail",{get:function(){return this.tileset.skipLevelOfDetail},set:function(Be){this.tileset.skipLevelOfDetail=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"mostDetail",{get:function(){return this.tileset.mostDetail},set:function(Be){this.tileset.mostDetail=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"loadSiblings",{get:function(){return this.tileset.loadSiblings},set:function(Be){this.tileset.loadSiblings=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"loadAll",{get:function(){return this.tileset.loadAll},set:function(Be){this.tileset.loadAll=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"maxScreenSpaceError",{get:function(){return this.tileset.maxScreenSpaceError},set:function(Be){this.tileset.maxScreenSpaceError=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"currentMaxScreenSpaceError",{get:function(){return this.tileset.currentMaxScreenSpaceError},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"trajectories",{get:function(){return this.tileset.trajectories},enumerable:!1,configurable:!0}),Se.prototype.localToEnu=function(Be){return Be.applyMatrix4(this.coordinateTransform.localToEnuMatrix)},Se.prototype.enuToLocal=function(Be){return Be.applyMatrix4(this.coordinateTransform.enuToLocalMatrix)},Se.prototype.localToEcef=function(Be){return Be.applyMatrix4(this.coordinateTransform.localToEcefMatrix)},Se.prototype.ecefToLocal=function(Be){return Be.applyMatrix4(this.coordinateTransform.ecefToLocalMatrix)},Se.prototype.localToLla=function(Be){return ecefToLla(this.localToEcef(Be))},Se.prototype.llaToLocal=function(Be){return this.ecefToLocal(llaToEcef(Be))},Se.prototype.worldToEnu=function(Be){return this.localToEnu(this.worldToLocal(Be))},Se.prototype.enuToWorld=function(Be){return this.localToWorld(this.enuToLocal(Be))},Se.prototype.worldToEcef=function(Be){return this.localToEcef(this.worldToLocal(Be))},Se.prototype.ecefToWorld=function(Be){return this.localToWorld(this.ecefToLocal(Be))},Se.prototype.worldToLla=function(Be){return this.localToLla(this.worldToLocal(Be))},Se.prototype.llaToWorld=function(Be){return this.localToWorld(this.llaToLocal(Be))},Se.prototype.loadContent=function(Be){var De=this;return loadTileContent(Be,{light:this.light,fetcher:this.fetcher,search:this.search,renderer:this.renderer}).then(function(Ve){Be.type==="SCENEGRAPH"&&(De.disposed||!Be.content?unloadTileContent(Be):Be.content.data&&De.boundingBox.expandByObject(Be.content.data.object))})},Se.prototype.unloadContent=function(Be){return unloadTileContent(Be),Promise.resolve()},Se.prototype.loadAllTilesets=function(){var Be=this,De=function(Ve){var Fe=[];return Be.tileset.root.traverse(function(Je){var Xe;Je.type==="TILESET"&&((Xe=Je.content)===null||Xe===void 0?void 0:Xe.loadState)!=="READY"&&Fe.push(Je)}),Promise.all(Fe.map(function(Je){return Be.loadContent(Je).then(function(){return De()})})).then(function(){})};return De(this.tileset.root)},Se.prototype.loadTrajectory=function(Be){var De=this;return loadTrajectory(Be,{fetcher:this.fetcher,search:this.search,renderer:this.renderer}).then(function(Ve){De.disposed&&unloadTrajectory(Ve)})},Se.prototype.unloadTrajectory=function(Be){return unloadTrajectory(Be),Promise.resolve()},Se.prototype.intersectRaycaster=function(Be,De,Ve){var Fe=this;De===void 0&&(De=!0),Ve===void 0&&(Ve=[]);for(var Je=[this.tileset.root],Xe=this.tileset.transform,Ke=this.tileset.transformIsIdentity,Ye,or=[];Ye=Je.pop();){var sr=void 0;if(Ye.boundingVolume){var cr=Ke?Ye.boundingVolume:Ye.boundingVolume.clone().applyMatrix4(Xe);sr=cr.intersectRay(Be.ray,Be.far)}else sr=!0;if(sr){for(var Br=0,tn=Ye.children.length;Br<tn;Br++)Je.push(Ye.children[Br]);Ye.selected&&Ye.content&&Ye.content.data&&Ye.content.data.object.visible&&Ye.content.data.object.intersectRaycaster(Be,!1,or)}}return this.model.shownFloorIndex>=0&&(or=or.filter(function(en){return en.floor===Fe.model.shownFloorIndex})),De&&or.sort(function(en,an){return en.distance-an.distance}),or.map(function(en){en.model=Fe.model,en.viewLayer=Fe.viewLayer}),Ve.push.apply(Ve,or),Ve},Se.prototype.cloneSkipBackfaceObject=function(Be){var De;Be instanceof Mesh?De=new Mesh(Be.geometry,Array.isArray(Be.material)?Be.material.map(function(Xe){return Xe.transparent?SKIP_BACKFACE_TRANSPARENT_MATERIAL:SKIP_BACKFACE_MATERIAL}):Be.material&&Be.material.transparent?SKIP_BACKFACE_TRANSPARENT_MATERIAL:SKIP_BACKFACE_MATERIAL):Be instanceof Group$1?De=new Group$1:De=new Object3D,De.copy(Be,!1);for(var Ve=0,Fe=Be.children;Ve<Fe.length;Ve++){var Je=Fe[Ve];De.add(this.cloneSkipBackfaceObject(Je))}return De},Se.prototype.update=function(Be,De,Ve){var Fe,Je,Xe,Ke=this,Ye,or,sr;this.renderObjects.length=0,this.backfaceObjects.length=0,this.debugObjects.length=0,this.tileObjects.length=0,this.renderer=Be,this.updateMatrixWorld(!0),this.tileset.transform.equals(this.matrixWorld)||this.tileset.transform.copy(this.matrixWorld),this.tileset.cache.reset();var cr=this.tileset.frameNumber+1,Br=this.maxLevelOfDetail;Br=Math.max(Br,0);var tn=Math.min(this.minLevelOfDetail,Br);(!this.visible||!this.loaded||!this.modelsLoaded)&&(Br=Math.max(tn,0));var en=this.minGeometricError,an=this.maxGeometricError;if(an=Math.max(en,an),Ve==="Panorama"||Ve==="VRPanorama"||Ve==="XRPanorama"){var rn=this.model.getMaterial().modelAlpha;rn<.1&&(en=this.panoramaMinGeometricError)}var on={time:now$2(),camera:{type:De.type,position:new Vector3().copy(De.position),direction:De.getDirection(new Vector3),up:new Vector3().copy(De.up).applyQuaternion(De.quaternion),projectionMatrix:De.projectionMatrix.clone(),visible:De.visible,refine:De.refineModel},minLevelOfDetail:tn,maxLevelOfDetail:Br,minGeometricError:en,maxGeometricError:an,height:De.resolution.height,pixelRatio:De.pixelRatio,frameNumber:cr,sseDenominator:2*Math.tan(.5*De.fov/180*Math.PI),cullingVolume:new CullingVolume().setFromCamera(De)},sn=this.cacheCameras.map(function(Dn){return Dn.updateProjectionMatrix(),__assign(__assign({},on),{camera:{type:De.type,position:new Vector3().copy(Dn.position),direction:Dn.getWorldDirection(new Vector3),up:new Vector3().copy(Dn.up),projectionMatrix:Dn.projectionMatrix.clone(),visible:Dn.visible,refine:!0},cullingVolume:new CullingVolume().setFromCamera(Dn)})});if(this.needsRefined&&this.tileset.update(on,sn),this.refined=!0,this.refineProgress[0]=0,this.refineProgress[1]=0,this.tileset.needsRefinedTiles.forEach(function(Dn){if(Ke.refineProgress[1]++,Dn.content){var zn=Dn.content.loadState;if(zn==="UNLOADED"||zn==="LOADING"){Ke.refined=!1;return}}Ke.refineProgress[0]++}),this.loaded===!1&&this.needsRefined){this.loaded=!0;var ln=!1;this.tileset.needsRefinedTiles.forEach(function(Dn){if(Ke.loaded!==!1&&Dn.content){if(ln=!0,Ke.tileset.skipLevelOfDetail){if(Dn.state.finalResolution){var zn=Dn.state.ancestorWithContentAvailable,Qn=zn&&zn.content?zn.content:Dn.content,Zn=Qn.loadState;(Zn==="UNLOADED"||Zn==="LOADING")&&(Ke.loaded=!1)}}else if(Dn.state.visible&&Dn.levelOfContent<=0){var Zn=Dn.content.loadState;(Zn==="UNLOADED"||Zn==="LOADING")&&(Ke.loaded=!1)}}}),ln&&this.tileset.selectedTiles.length===0&&(this.loaded=!1),this.loaded===!0&&(this.refined=!1,this.refineProgress[1]++)}this.remove.apply(this,this.children),this.tileset.skipLevelOfDetail||this.tileset.selectedTiles.sort(function(Dn,zn){return Dn.floor!==zn.floor?Dn.floor-zn.floor:Dn.levelOfContent!==zn.levelOfContent?zn.levelOfContent-Dn.levelOfContent:Dn.state.distanceToCamera!==zn.state.distanceToCamera?Dn.state.distanceToCamera-zn.state.distanceToCamera:Dn.state.centerZDepth-zn.state.centerZDepth}),this.debug==="root-bounding-volume"&&this.tileset.root.boundingVolumeDebugObject&&this.debugObjects.push(this.tileset.root.boundingVolumeDebugObject);for(var cn=0,hn=this.tileset.selectedTiles;cn<hn.length;cn++){var mn=hn[cn];this.debug==="selected-bounding-volume"&&mn.boundingVolumeDebugObject&&this.debugObjects.push(mn.boundingVolumeDebugObject);var An=(or=(Ye=mn.content)===null||Ye===void 0?void 0:Ye.data)===null||or===void 0?void 0:or.object;if(An){if(An.update(Be,De,this.model,mn),this.tileset.hasMixedContent&&this.tileset.skipLevelOfDetail){if(!mn.state.finalResolution){var xn=this.cloneSkipBackfaceObject(An);this.backfaceObjects.push(xn)}for(var pn=mn.state.selectionDepth,dn=StencilConstants.TILE_MASK|pn<<StencilConstants.SKIP_LOD_BIT_SHIFT,fn=GreaterEqualStencilFunc,yn=StencilConstants.SKIP_LOD_MASK,Sn=ReplaceStencilOp,gn=StencilConstants.TILE_MASK|StencilConstants.SKIP_LOD_MASK,Cn=0,Mn=An.materials;Cn<Mn.length;Cn++){var Bn=Mn[Cn];Bn.stencilWrite=!0,Bn.stencilRef=dn,Bn.stencilFunc=fn,Bn.stencilFuncMask=yn,Bn.stencilZPass=Sn,Bn.stencilWriteMask=gn}}else for(var kn=0,Ln=An.materials;kn<Ln.length;kn++){var Bn=Ln[kn];Bn.stencilWrite=!1,Bn.stencilRef=StencilConstants.TILE_MASK,Bn.stencilFunc=AlwaysStencilFunc,Bn.stencilFuncMask=StencilConstants.TILE_MASK,Bn.stencilZPass=ReplaceStencilOp,Bn.stencilWriteMask=StencilConstants.TILE_MASK}this.tileObjects.push(An)}}this.tileset.skipLevelOfDetail&&this.backfaceObjects.length&&(Fe=this.renderObjects).push.apply(Fe,this.backfaceObjects),this.tileObjects.length&&(Je=this.renderObjects).push.apply(Je,this.tileObjects),this.tileset.skipLevelOfDetail&&this.renderObjects.push(this.clearStencilObject);for(var Pn=0,Vn=this.tileset.selectedTrajectories;Pn<Vn.length;Pn++){var Yn=Vn[Pn],ni=(sr=Yn.content.data)===null||sr===void 0?void 0:sr.object;ni&&(ni.update(Be,De,this.model),this.renderObjects.push(ni))}this.debug&&(Xe=this.renderObjects).push.apply(Xe,this.debugObjects);for(var Rn=this.modelIndex*1e4,In=function(Dn){var zn=Gn.renderObjects[Dn],Qn=Dn+Rn;zn.traverse(function(Zn){(Zn instanceof Mesh||Zn instanceof Line||Zn instanceof Points)&&(Zn.renderOrder=Qn)}),Gn.add(zn)},Gn=this,Fn=0;Fn<this.renderObjects.length;Fn++)In(Fn);var Hn=this.getRenderHash();this.lastRenderHash!==Hn&&(this.needsRender=!0,this.lastRenderHash=Hn)},Se.prototype.dispose=function(){this.disposed=!0,this.viewLayer=void 0,this.tileset.reset(),this.remove.apply(this,this.children),this.refineProgress[0]=0,this.refineProgress[1]=0,this.refined=!1,this.loaded=!1},Se.DEFAULT_PANORAMA_MIN_GEOMETRIC_ERROR=1,Se.DEFAULT_MIN_LEVEL_OF_DETAIL=0,Se.DEFAULT_MAX_LEVEL_OF_DETAIL=20,Se.DEFAULT_MIN_GEOMETRIC_ERROR=0,Se.DEFAULT_MAX_GEOMETRIC_ERROR=1e4,Se.DEFAULT_MAX_MEMORY_USAGE=16,Se.DEFAULT_MAX_SCREEN_SPACE_ERROR=Tileset.DEFAULT_MAX_SCREEN_SPACE_ERROR,Se.DEFAULT_SKIP_LEVEL_OF_DETAIL=Tileset.DEFAULT_SKIP_LEVEL_OF_DETAIL,Se.DEFAULT_MOST_DETAIL=Tileset.DEFAULT_MOST_DETAIL,Se.DEFAULT_LOAD_SIBLINGS=Tileset.DEFAULT_LOAD_SIBLINGS,Se.DEFAULT_LOAD_ALL=Tileset.DEFAULT_LOAD_ALL,Se.DEFAULT_MAX_REQUESTS=Tileset.DEFAULT_MAX_REQUESTS,Se.DEFAULT_REQUEST_ORDER=Tileset.DEFAULT_REQUEST_ORDER,Se}(Object3D);function headingToLongitude($e){return-(($e-.25)*360+90)/180*Math.PI}function equal($e,Se){if($e===Se)return!0;if($e&&Se&&typeof $e=="object"&&typeof Se=="object"){if($e.constructor!==Se.constructor)return!1;var Be,De,Ve;if(Array.isArray($e)){if(Be=$e.length,Be!=Se.length)return!1;for(De=Be;De--!==0;)if(!equal($e[De],Se[De]))return!1;return!0}if($e.constructor===RegExp)return $e.source===Se.source&&$e.flags===Se.flags;if($e.valueOf!==Object.prototype.valueOf)return $e.valueOf()===Se.valueOf();if($e.toString!==Object.prototype.toString)return $e.toString()===Se.toString();if(Ve=Object.keys($e),Be=Ve.length,Be!==Object.keys(Se).length)return!1;for(De=Be;De--!==0;)if(!Object.prototype.hasOwnProperty.call(Se,Ve[De]))return!1;for(De=Be;De--!==0;){var Fe=Ve[De];if(!equal($e[Fe],Se[Fe]))return!1}return!0}return $e!==$e&&Se!==Se}function isNumber($e){return typeof $e=="number"}function S4(){return((1+Math.random())*65536|0).toString(16).substring(1)}function createUuid(){return(S4()+S4()+"-"+S4()+"-4"+S4().substr(0,3)+"-"+S4()+"-"+S4()+S4()+S4()).toLowerCase()}var error_invalid_input=function(){return new Error("Invalid input.")},error_invalid_certificate=function(){return new Error("Invalid certificate.")},error_invalid_signature=function(){return new Error("Invalid signature.")},error_date_expired=function($e){return new Error("date(".concat($e.toString(),") expired."))},error_host_not_allowed=function($e){return new Error("host(".concat(JSON.stringify($e),") is not allowed."))};function ObjectOmit($e,Se){for(var Be={},De=0,Ve=Object.keys($e);De<Ve.length;De++){var Fe=Ve[De];Se.indexOf(Fe)===-1&&(Be[Fe]=$e[Fe])}return Be}function jsonStableNoneNumberStrinfiy_($e,Se){Se===void 0&&(Se=!1);var Be=typeof $e;if(Be==="string")return JSON.stringify($e);if($e===!0)return"true";if($e===!1)return"false";if($e===null)return"null";if($e instanceof Array){for(var De="[",Ve=$e.length-1,Fe=0;Fe<Ve;Fe++)De+=jsonStableNoneNumberStrinfiy_($e[Fe],!1)+",";return Ve>-1&&(De+=jsonStableNoneNumberStrinfiy_($e[Fe],!1)),De+"]"}if($e instanceof Object){if(typeof $e.toJSON=="function")return jsonStableNoneNumberStrinfiy_($e.toJSON(),Se);for(var Je=Object.keys($e).sort(),Xe=Je.length,De="",Fe=0;Fe<Xe;){var Ke=Je[Fe],Ye=jsonStableNoneNumberStrinfiy_($e[Ke],!0);Ye!==void 0&&(Fe&&De!==""&&(De+=","),De+=JSON.stringify(Ke)+":"+Ye),Fe++}return"{"+De+"}"}switch(Be){case"function":case"undefined":return Se?void 0:null;case"number":return 0;default:return isFinite($e)?$e:null}}function jsonStableNoneNumberStrinfiy($e){return String(jsonStableNoneNumberStrinfiy_($e,!1))}function verify($e){var Se,Be,De;if(Array.isArray($e)){var Ve=void 0,Fe,Je;if($e.length<=0)return error_invalid_input();for(var Xe=function(cn){var hn=verify($e[cn]);if(hn instanceof Error)return{value:hn};if(!Ve)Ve=hn.issuer;else if(Ve!==hn.issuer)return{value:error_invalid_certificate()};Fe?hn.expire.getTime()<Fe.getTime()&&(Fe=hn.expire):Fe=hn.expire,Je?Je=Je.filter(function(mn){return hn.allowHosts.indexOf(mn)!==-1}):Je=hn.allowHosts},Ke=0;Ke<$e.length;Ke++){var Ye=Xe(Ke);if(typeof Ye=="object")return Ye.value}return deepFreeze({issuer:Ve,expire:Fe,allowHosts:Je})}var or=JSON.parse($e),sr=typeof location<"u"?location.hostname:"",cr=Date.now();if(typeof or!="object")return error_invalid_input();var Br=new Date(typeof or.expire_at=="string"&&/^\d+$/.test(or.expire_at)?Number(or.expire_at):or.expire_at),tn=Array.isArray(or.allow_hosts)?or.allow_hosts:[];if(sr.length===0||isIPDomain(sr)||BUILDIN_ALLOW_HOST.filter(function(cn){return matchDomain(cn,sr)}).length>0){var en=String((Se=or.certificate)!==null&&Se!==void 0?Se:"");if(en){var an=new X509;return an.readCertPEM(en),deepFreeze({issuer:an.getSubjectString(),expire:Br,allowHosts:tn})}return deepFreeze({issuer:"none",expire:Br,allowHosts:tn})}var rn=String((Be=or.certificate)!==null&&Be!==void 0?Be:"");if(!rn)return error_invalid_certificate();var on=new X509;on.readCertPEM(rn);var sn=String((De=or._signature)!==null&&De!==void 0?De:"");if(!sn)return error_invalid_signature();var ln=jsonStableNoneNumberStrinfiy(ObjectOmit(or,["_signature"]));return verifyMessage(ln,sn,on)===!1?error_invalid_signature():cr<Br.getTime()?tn.filter(function(cn){return matchDomain(cn,sr)}).length===0?error_host_not_allowed(sr):deepFreeze({issuer:on.getSubjectString(),expire:Br,allowHosts:tn}):error_date_expired(Br)}var scratchMatrix4$1=new Matrix4,workRawMapping=new WeakMap,needsUpdateWorkCodeSet=new Set,Work=function(){function $e(Se,Be){this.name="",this.baseURL="",this.workCode="",this.expire=new Date,this.allowHosts=[],this.initial={work:this},this.observers=[],this.issuer="none",this.raw={works:[""],options:""},this.transform=new Matrix4;{var De=this;this.options={get transform(){return De.transform},set transform(Fe){De.transform.copy(Fe)}}}if(Se!==null)if("up"in Se&&typeof Se.up=="string"&&"down"in Se&&typeof Se.down=="string"&&"right"in Se&&typeof Se.right=="string"&&"left"in Se&&typeof Se.left=="string"&&"front"in Se&&typeof Se.front=="string"&&"back"in Se&&typeof Se.back=="string"&&"size"in Se&&typeof Se.size=="number")parsePanoWork(Se,this);else{var Ve=parse(Se,Be,this);if(Ve instanceof Error)throw new Error("[PARSE FAILED]: "+Ve.message+`
Error work input:
`+JSON.stringify(Se))}else parseNull(Se,this)}return $e.prototype.toJSON=function(){return this.raw},$e.parse=parseWork,$e}();function getType($e){return $e==null?"null":Array.isArray($e)?"array":typeof $e=="object"?"dict":"value"}function deepMerge($e,Se){var Be=getType($e),De=getType(Se);if(De==="null")return $e;if(De==="value")return Se;if(De!==Be)return JSON.parse(JSON.stringify(Se));if(De==="array")for(var Ve=0;Ve<Se.length;Ve++)$e[Ve]=deepMerge($e[Ve],Se[Ve]);else if(De==="dict")for(var Fe in Se)$e[Fe]=deepMerge($e[Fe],Se[Fe]);return $e}function startWithString($e,Se){return $e.indexOf(Se)===0}function urlWithParseOptions($e,Se,Be,De){var Ve,Fe=Se;if(De.jsonp===!0){Fe=Se.replace(/([\?\#].*)?$/i,"");var Je=sha256("".concat(Fe)).slice(0,7);Fe="".concat(Fe,".").concat(Je,".jsonp")}if(De.shortPath===!0){var Xe=Fe.replace($e,"").split("."),Ke=(Ve=Xe.shift())!==null&&Ve!==void 0?Ve:"",Ye=Xe.join(".");Fe=pathJoin($e,sha256(Ke))+(Ye?"."+Ye:"")}var or=Fe.replace($e,"");return De.baseURL&&(Fe=pathJoin(De.baseURL,or)),De.traverseResource&&De.traverseResource({origin:Se,absolute:Fe,relative:or,type:Be}),Fe}function panoURL($e,Se,Be,De,Ve){var Fe=Be;return isAbsoluteURL(Be)||(Se&&(Se=pathJoin(Se,String(De))),Fe=pathJoin(Se,Fe)),isAbsoluteURL(Fe)||(Fe=pathJoin($e,Fe)),startWithString(Fe,$e)||console.warn("".concat(Fe," is not start with base_url(").concat($e,").")),urlWithParseOptions($e,Fe,"panorama",Ve)}function fileURL($e,Se,Be){var De=Se;return isAbsoluteURL(De)||(De=pathJoin($e,Se)),startWithString(De,$e)||console.warn("".concat(De," is not start with base_url(").concat($e,").")),urlWithParseOptions($e,De,"model",Be)}function textureURL$1($e,Se,Be,De){var Ve=Se;return isAbsoluteURL(Ve)||(Ve=pathJoin(Be,Ve)),isAbsoluteURL(Ve)||(Ve=pathJoin($e,Ve)),startWithString(Ve,$e)||console.warn("".concat(Ve," is not start with base_url(").concat($e,").")),urlWithParseOptions($e,Ve,"texture",De)}var getTileLevel=function($e){for(var Se=10;Se>=0;Se--){var Be=512*Math.pow(2,Se);if(Be<=$e)return Se}return null},sortTile=function($e){$e=$e.slice().sort(function(Je,Xe){return Je.level-Xe.level});for(var Se=[],Be=0,De=$e;Be<De.length;Be++){var Ve=De[Be];if(Se.length===0){Se.push(Ve);continue}var Fe=Se[Se.length-1];if(Ve.level>Fe.level){Se.push(Ve);continue}if(Ve.size>Fe.size){Se[Se.length-1]=Ve;continue}}return Se};function parse($e,Se,Be){for(var De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an,rn,on,sn,ln,cn,hn,mn=JSON.stringify(Se),An=[],xn=0,pn=[].concat($e);xn<pn.length;xn++){var dn=pn[xn];dn instanceof Work?An.push.apply(An,dn.raw.works):typeof dn=="string"?An.push(dn):An.push(JSON.stringify(dn))}var fn=verify(An);if(fn instanceof Error)return fn;Array.isArray(Se.transform)?Be.transform.fromArray(Se.transform):Se.transform&&Be.transform.copy(Se.transform),$e=An.map(function(oi){return JSON.parse(oi)}).reduce(function(oi,ci){return deepMerge(oi,ci)}),Object.defineProperty(Be,"raw",{configurable:!1,get:function(){return{works:An,options:mn}}});{var yn;if(Se.workCode&&(typeof Se.workCode=="string"?yn=Se.workCode:typeof Se.workCode=="function"&&(yn=Se.workCode($e))),typeof yn>"u"&&(yn=String($e.resource_code||$e.basic_code||$e.vr_code||$e.code||$e.project_id||$e.work_code||$e.workCode)),typeof yn>"u")return new Error("WorkCode never matched.");Object.defineProperty(Be,"workCode",{configurable:!1,get:function(){return yn}})}{var Sn=String($e.name);Object.defineProperty(Be,"name",{configurable:!1,get:function(){return Sn}})}if(fn instanceof Error)return fn;Object.defineProperty(Be,"issuer",{configurable:!1,get:function(){return fn.issuer}}),Object.defineProperty(Be,"expire",{configurable:!1,get:function(){return fn.expire}}),Object.defineProperty(Be,"allowHosts",{configurable:!1,get:function(){return fn.allowHosts}});var gn=(De=$e.base_url)!==null&&De!==void 0?De:"";if(gn&&gn[gn.length-1]!=="/"&&(gn+="/"),Be.baseURL=(Ve=Se.baseURL)!==null&&Ve!==void 0?Ve:gn,fn instanceof Error)return fn;if($e.model){var Cn={work:Be,layers:[]},Mn;$e.model.file?Mn=fileURL(gn,$e.model.file,Se):$e.model.file_url&&(Mn=fileURL(gn,$e.model.file_url,Se)),Object.defineProperty(Cn,"file",{configurable:!1,get:function(){return Mn}});var Bn;$e.model.textureBase?Bn=textureURL$1(gn,"",$e.model.textureBase,Se):$e.model.material_base_url?Bn=textureURL$1(gn,"",$e.model.material_base_url,Se):Cn.file&&(Bn=Cn.file.split("/").slice(0,-1).join("/").replace("/model/","/materials/")),Object.defineProperty(Cn,"textureBase",{configurable:!1,get:function(){return Bn}});var kn;Array.isArray($e.model.textures)?(kn=$e.model.textures.map(function(oi){var ci,ai;return textureURL$1(gn,oi,(ai=(ci=$e.model.textureBase)!==null&&ci!==void 0?ci:$e.model.material_base_url)!==null&&ai!==void 0?ai:"",Se)}),Object.freeze(kn)):Array.isArray($e.model.material_textures)&&(kn=$e.model.material_textures.map(function(oi){var ci,ai;return textureURL$1(gn,oi,(ai=(ci=$e.model.textureBase)!==null&&ci!==void 0?ci:$e.model.material_base_url)!==null&&ai!==void 0?ai:"",Se)}),Object.freeze(kn)),Object.defineProperty(Cn,"textures",{configurable:!1,get:function(){return kn}});var Ln=[];if(Array.isArray($e.model.tiles))for(var Pn=0,Vn=$e.model.tiles;Pn<Vn.length;Pn++){var Yn=Vn[Pn];Yn&&(Yn.tileset||Yn.tileset_url)&&Ln.push(Object.freeze({type:(Fe=Yn.type)!==null&&Fe!==void 0?Fe:"mesh",name:(Je=Yn.name)!==null&&Je!==void 0?Je:"",upAxis:(Ke=(Xe=Yn.upAxis)!==null&&Xe!==void 0?Xe:Yn.up_axis)!==null&&Ke!==void 0?Ke:"-Y",tileset:fileURL(gn,Yn.tileset||Yn.tileset_url,Se)}))}else $e.model.tiles&&($e.model.tiles.tileset||$e.model.tiles.tileset_url)&&Ln.push(Object.freeze({type:(Ye=$e.model.tiles.type)!==null&&Ye!==void 0?Ye:"mesh",name:(or=$e.model.tiles.name)!==null&&or!==void 0?or:"lod",upAxis:(cr=(sr=$e.model.tiles.upAxis)!==null&&sr!==void 0?sr:$e.model.tiles.up_axis)!==null&&cr!==void 0?cr:"-Y",tileset:fileURL(gn,$e.model.tiles.tileset||$e.model.tiles.tileset_url,Se)}));if(Array.isArray($e.model.layers))for(var ni=0,Rn=$e.model.layers;ni<Rn.length;ni++){var In=Rn[ni];In&&(In.tileset||In.tileset_url)&&Ln.push(Object.freeze({type:(Br=In.type)!==null&&Br!==void 0?Br:"mesh",name:(tn=In.name)!==null&&tn!==void 0?tn:"",upAxis:(en=In.upAxis)!==null&&en!==void 0?en:In.up_axis,tileset:fileURL(gn,In.tileset||In.tileset_url,Se)}))}Object.freeze(Ln),Object.defineProperty(Cn,"layers",{configurable:!1,get:function(){return Ln}}),Object.defineProperty(Be,"model",{configurable:!1,get:function(){if(Cn.file||Cn.layers.length)return Cn}})}if(fn instanceof Error)return fn;var Gn=new Set,Fn=new Set;{var Hn=[];if($e.observers&&Array.isArray($e.observers)){var Dn=[];$e.panorama&&(Array.isArray($e.panorama)?Dn=$e.panorama:Array.isArray($e.panorama.list)?Dn=$e.panorama.list:Array.isArray($e.panorama.info)&&(Dn=$e.panorama.info));for(var zn=function(oi){var ci={},ai=$e.observers[oi];if(!ai)return"break";var wi=Dn[oi];if(!wi)return"break";ai=Object.assign({},ai,wi,{active:ai.active!==!1&&wi.active!==!1}),Object.defineProperty(ci,"work",{configurable:!1,get:function(){return Be}}),Object.defineProperty(ci,"index",{configurable:!1,get:function(){return oi}}),Fn.add(oi),Object.defineProperty(ci,"panoIndex",{configurable:!1,get:function(){return oi}});var Pi=panoStringify({workCode:Be.workCode,panoIndex:oi});Gn.add(Pi),Object.defineProperty(ci,"panoId",{configurable:!1,get:function(){return Pi}});var Oi=Object.freeze({workCode:Be.workCode,panoIndex:oi});Object.defineProperty(ci,"pano",{configurable:!1,get:function(){return Oi}});var Ri=ai.active!==!1;Object.defineProperty(ci,"active",{configurable:!1,get:function(){return Ri}});var _i=ai.loadable===!0;Object.defineProperty(ci,"loadable",{configurable:!1,get:function(){return _i}});var Mi=ai.derived_id;Object.defineProperty(ci,"derivedId",{configurable:!1,get:function(){return Mi}});var $i=ai.derived_id_str;Object.defineProperty(ci,"derivedIdStr",{configurable:!1,get:function(){return $i}});var vi=(cn=(sn=(rn=(an=$e.panorama)===null||an===void 0?void 0:an.pano_high_cube_base_url)!==null&&rn!==void 0?rn:(on=$e.panorama)===null||on===void 0?void 0:on.pano_cube_base_url)!==null&&sn!==void 0?sn:(ln=$e.panorama)===null||ln===void 0?void 0:ln.base_url)!==null&&cn!==void 0?cn:"",ri={up:panoURL(gn,vi,ai.images?ai.images.up:ai.up,oi,Se),down:panoURL(gn,vi,ai.images?ai.images.down:ai.down,oi,Se),right:panoURL(gn,vi,ai.images?ai.images.right:ai.right,oi,Se),left:panoURL(gn,vi,ai.images?ai.images.left:ai.left,oi,Se),front:panoURL(gn,vi,ai.images?ai.images.front:ai.front,oi,Se),back:panoURL(gn,vi,ai.images?ai.images.back:ai.back,oi,Se)};if(ai.size_list)ri.sizeList=ai.size_list.slice();else{var Ti=getImageSizeFromURL(ri.up);if(Ti&&(ri.sizeList=[Ti],ai.tiles))for(var Bi=ai.tiles.slice().sort(function(ro,To){return ro-To}).map(function(ro){return 512*Math.pow(2,ro)}),qi=0,Ii=Bi;qi<Ii.length;qi++){var Ui=Ii[qi];Ui>Ti&&ri.sizeList.push(Ui)}}var ho=ai.images?ai.images.luminance:ai.luminance;ho&&(ri.luminance=Object.freeze({up:panoURL(gn,vi,ho.up,oi,Se),down:panoURL(gn,vi,ho.down,oi,Se),right:panoURL(gn,vi,ho.right,oi,Se),left:panoURL(gn,vi,ho.left,oi,Se),front:panoURL(gn,vi,ho.front,oi,Se),back:panoURL(gn,vi,ho.back,oi,Se)}));var lo=void 0;if(ai.images)lo=ai.images.tiles;else if(Array.isArray(ai.size_list)){var po=ai.size_list.slice().sort(function(ro,To){return ro-To});if(po[0]){var co=getTileLevel(po[0]);if(co)for(var go=co-1;go>=0;go--)po.unshift(512*Math.pow(2,go));lo=po}}else if(Array.isArray(ai.tiles)&&(lo=ai.tiles.slice(),typeof lo[0]=="number")){for(var vo=lo[0];--vo>=0;)lo.unshift(vo);lo=lo.sort(function(ro,To){return ro-To}).map(function(ro){return 512*Math.pow(2,ro)})}if(lo){for(var Eo=[],Oo=0,Bo=lo;Oo<Bo.length;Oo++){var Ui=Bo[Oo];if(typeof Ui=="number"){var Po=getTileLevel(Ui);if(typeof Po!="number")continue;var Kn=getImageSizeFromURL(ri.front);if(!Kn)continue;if(Ui>Kn){var mi=replaceImageSize(ri.up,Ui),gi=replaceImageSize(ri.down,Ui),xi=replaceImageSize(ri.right,Ui),ki=replaceImageSize(ri.left,Ui),Ki=replaceImageSize(ri.front,Ui),Yi=replaceImageSize(ri.back,Ui);Eo.push(Object.freeze({level:Po,size:Ui,scale:1,up:mi,down:gi,right:xi,left:ki,front:Ki,back:Yi}))}else{var mi=ri.up,gi=ri.down,xi=ri.right,ki=ri.left,Ki=ri.front,Yi=ri.back;Eo.push(Object.freeze({level:Po,size:Kn,scale:Ui/Kn,up:mi,down:gi,right:xi,left:ki,front:Ki,back:Yi}))}}else{var Po=Ui.level;if(typeof Po!="number")continue;var Ti=Ui.size;if(typeof Ti!="number")continue;var mi=panoURL(gn,vi,Ui.up,oi,Se),gi=panoURL(gn,vi,Ui.down,oi,Se),xi=panoURL(gn,vi,Ui.right,oi,Se),ki=panoURL(gn,vi,Ui.left,oi,Se),Ki=panoURL(gn,vi,Ui.front,oi,Se),Yi=panoURL(gn,vi,Ui.back,oi,Se);Eo.push(Object.freeze({level:Po,size:Ti,scale:(hn=Ui.scale)!==null&&hn!==void 0?hn:1,up:mi,down:gi,right:xi,left:ki,front:Ki,back:Yi}))}}Eo=sortTile(Eo),Object.freeze(Eo),Object.defineProperty(ri,"tiles",{configurable:!1,get:function(){return Eo}})}Object.freeze(ri),Object.defineProperty(ci,"images",{configurable:!1,get:function(){return ri}});var ji=new Vector3;if(ai.position instanceof Vector3)ji.copy(ai.position);else if(Array.isArray(ai.position))ji.fromArray(ai.position);else return"break";Object.freeze(ji),Object.defineProperty(ci,"position",{configurable:!1,get:function(){return ji}});var Wi=new Vector3;if(ai.standingPosition instanceof Vector3)Wi.copy(ai.standingPosition);else if(Array.isArray(ai.standingPosition))Wi.fromArray(ai.standingPosition);else if(ai.standing_position instanceof Vector3)Wi.copy(ai.standing_position);else if(Array.isArray(ai.standing_position))Wi.fromArray(ai.standing_position);else return"break";Object.freeze(Wi),Object.defineProperty(ci,"standingPosition",{configurable:!1,get:function(){return Wi}});var Gi=new Quaternion;if(ai.quaternion instanceof Quaternion)Gi.copy(ai.quaternion);else if(Array.isArray(ai.quaternion))Gi.fromArray(ai.quaternion);else if(ai.quaternion){var Mo=ai.quaternion,bo=Mo.x,fo=Mo.y,Hi=Mo.z,eo=Mo.w;Gi.set(bo,fo,Hi,eo)}else return"break";Object.freeze(Gi),Object.defineProperty(ci,"quaternion",{configurable:!1,get:function(){return Gi}});var mo=0;isNumber(ai.floorIndex)?mo=ai.floorIndex:isNumber(ai.floor_index)?mo=ai.floor_index:isNumber(ai.floor)&&(mo=ai.floor),Object.defineProperty(ci,"floorIndex",{configurable:!1,get:function(){return mo}});var xo;ai.video&&(xo={},typeof ai.video.source=="string"&&(xo.source=ai.video.source),ai.video.matrix instanceof Matrix4?xo.matrix=ai.video.matrix.clone():Array.isArray(ai.video.matrix)&&(xo.matrix=new Matrix4().fromArray(ai.video.matrix)),ai.video.size instanceof Vector2?xo.size=ai.video.size.clone():Array.isArray(ai.video.size)&&(xo.size=new Vector2().fromArray(ai.video.size)),xo.source&&xo.matrix&&xo.size&&(ci.video=xo)),Object.freeze(xo),Object.defineProperty(ci,"video",{configurable:!1,get:function(){return xo}}),Array.isArray(ai.accessibleNodes)?(ci.accessibleNodes=ai.accessibleNodes.slice(),ci.accessibleIds=ai.accessibleNodes.map(function(ro){return panoStringify({workCode:Be.workCode,panoIndex:ro})})):Array.isArray(ai.accessible_nodes)&&(ci.accessibleNodes=ai.accessible_nodes.slice(),ci.accessibleIds=ai.accessible_nodes.map(function(ro){return panoStringify({workCode:Be.workCode,panoIndex:ro})})),Array.isArray(ai.visibleNodes)?(ci.visibleNodes=ai.visibleNodes.slice(),ci.visibleIds=ai.visibleNodes.map(function(ro){return panoStringify({workCode:Be.workCode,panoIndex:ro})})):Array.isArray(ai.visible_nodes)&&(ci.visibleNodes=ai.visible_nodes.slice(),ci.visibleIds=ai.visible_nodes.map(function(ro){return panoStringify({workCode:Be.workCode,panoIndex:ro})})),Hn[oi]=ci},Qn=0;Qn<$e.observers.length;Qn++){var Zn=zn(Qn);if(Zn==="break")break}}for(var si=function(oi){if(oi.accessibleIds){var ci=oi.accessibleIds.filter(function(vi){return Gn.has(vi)});Object.freeze(ci),Object.defineProperty(oi,"accessibleIds",{configurable:!1,get:function(){return ci}})}else{for(var ai=[],wi=0;wi<Hn.length;wi++)Hn[wi]!==oi&&(Math.abs(Hn[wi].position.y-oi.position.y)>3||Hn[wi].position.distanceTo(oi.position)>10||ai.push(Hn[wi].panoId));Object.freeze(ai),Object.defineProperty(oi,"accessibleIds",{configurable:!1,get:function(){return ai}})}if(oi.accessibleNodes){var Pi=oi.accessibleNodes.filter(function(vi){return Fn.has(vi)});Object.freeze(Pi),Object.defineProperty(oi,"accessibleNodes",{configurable:!1,get:function(){return Pi}})}else{for(var Oi=[],wi=0;wi<Hn.length;wi++)Hn[wi]!==oi&&(Math.abs(Hn[wi].position.y-oi.position.y)>3||Hn[wi].position.distanceTo(oi.position)>10||Oi.push(Hn[wi].panoIndex));Object.freeze(Oi),Object.defineProperty(oi,"accessibleNodes",{configurable:!1,get:function(){return Oi}})}if(oi.visibleIds){var Ri=oi.visibleIds.filter(function(vi){return Gn.has(vi)});Object.freeze(Ri),Object.defineProperty(oi,"visibleIds",{configurable:!1,get:function(){return Ri}})}else{var _i=oi.accessibleIds.slice();Object.freeze(_i),Object.defineProperty(oi,"visibleIds",{configurable:!1,get:function(){return _i}})}if(oi.visibleNodes){var Mi=oi.visibleNodes.filter(function(vi){return Fn.has(vi)});Object.freeze(Mi),Object.defineProperty(oi,"visibleNodes",{configurable:!1,get:function(){return Mi}})}else{var $i=oi.accessibleNodes.slice();Object.freeze($i),Object.defineProperty(oi,"visibleNodes",{configurable:!1,get:function(){return $i}})}},ei=0,hi=Hn;ei<hi.length;ei++){var Un=hi[ei];si(Un)}Object.freeze(Hn),Object.defineProperty(Be,"observers",{configurable:!1,get:function(){return Hn}})}if(fn instanceof Error)return fn;if($e.initial){if(($e.initial.mode==="Panorama"&&Be.observers.length===0||$e.initial.mode==="Floorplan"||$e.initial.mode==="Topview"||$e.initial.mode==="Model"||$e.initial.mode==="Mapview"||$e.initial.mode==="DepthPanorama")&&(Be.initial.mode=$e.initial.mode),isNumber($e.initial.latitude)&&(Be.initial.latitude=$e.initial.latitude),isNumber($e.initial.longitude)?Be.initial.longitude=$e.initial.longitude:isNumber($e.initial.heading)&&(Be.initial.longitude=headingToLongitude($e.initial.heading)),isNumber($e.initial.fov)&&(Be.initial.fov=$e.initial.fov),Be.observers.length>0){var Wn=void 0;isNumber($e.initial.panoIndex)?Wn=$e.initial.panoIndex:isNumber($e.initial.pano_index)?Wn=$e.initial.pano_index:isNumber($e.initial.pano)&&(Wn=$e.initial.pano),typeof Wn=="number"&&(Wn=clamp$1(Wn,0,Be.observers.length-1),Be.initial.panoIndex=Wn)}if(isNumber($e.initial.distance)&&(Be.initial.distance=$e.initial.distance),Array.isArray($e.initial.offset)){var Ai=[0,0,0].map(function(oi,ci){var ai=Number($e.initial.offset[ci]);return isNaN(ai)||!isFinite(ai)?0:ai});Be.initial.offset=new Vector3().fromArray(Ai)}else typeof $e.initial.offset=="object"&&typeof $e.initial.offset.x=="number"&&typeof $e.initial.offset.y=="number"&&typeof $e.initial.offset.z=="number"&&(Be.initial.offset=new Vector3($e.initial.offset.x,$e.initial.offset.y,$e.initial.offset.z));!Be.initial.mode&&typeof Be.initial.panoIndex=="number"&&(Be.initial.mode="Panorama")}return fn instanceof Error?fn:(workRawMapping.set(Be,{works:An,options:mn}),Be)}function parseNull($e,Se){return Se.issuer="null",deepFreeze(Se),workRawMapping.set(Se,{works:["null"],options:"{}"}),Se}function parsePanoWork($e,Se){var Be;Se.issuer="null",Se.allowHosts=["*"],Se.workCode=(Be=$e.code)!==null&&Be!==void 0?Be:createUuid();var De=[$e.size],Ve=[],Fe=getTileLevel(De[0]);if(Fe)for(var Je=Fe-1;Je>=0;Je--)De.unshift(512*Math.pow(2,Je));for(var Xe=0,Ke=De;Xe<Ke.length;Xe++){var Ye=Ke[Xe],or=getTileLevel(Ye);or&&Ve.push({level:or,size:$e.size,scale:Ye/$e.size,up:$e.up,down:$e.down,right:$e.right,left:$e.left,front:$e.front,back:$e.back})}var sr={up:$e.up,down:$e.down,right:$e.right,left:$e.left,front:$e.front,back:$e.back,sizeList:De};Ve&&(sr.tiles=Ve);var cr={accessibleIds:[],accessibleNodes:[],active:!0,floorIndex:0,images:sr,index:0,loadable:!1,pano:{workCode:Se.workCode,panoIndex:0},panoId:"".concat(Se.workCode,"[0]"),panoIndex:0,position:new Vector3(0,1.5,0),quaternion:new Quaternion(0,1,0,0),standingPosition:new Vector3(0,0,0),visibleIds:[],visibleNodes:[],work:Se};return Se.observers=[cr],deepFreeze(Se),workRawMapping.set(Se,{works:[JSON.stringify($e)],options:"{}"}),Se}function parseWork($e,Se){typeof $e=="string"&&$e.trim()[0]==="{"&&($e=JSON.parse($e));var Be=workRawMapping.get($e);if(Be){if(Se&&!equal(JSON.parse(Be.options),Se))throw new Error("[PARSE FAILED]: work is parsed with different options.");return $e}else try{return new Work($e,Se??{})}catch(De){throw new Error("[PARSE FAILED]: "+De.message+`
Error work input:
`+JSON.stringify($e))}}function createWorks($e){for(var Se={},Be=[],De={},Ve=0,Fe=$e;Ve<Fe.length;Ve++){var Je=Fe[Ve],Xe=Se[Je.workCode];Xe||(Xe=Se[Je.workCode]=new Matrix4().copy(Je.transform));for(var Ke=0,Ye=Je.observers;Ke<Ye.length;Ke++){var or=Ye[Ke],sr={isResolved:!0,active:or.active,accessibleIds:or.accessibleIds,visibleIds:or.visibleIds,accessibleNodes:or.accessibleNodes,visibleNodes:or.visibleNodes,floorIndex:or.floorIndex,images:or.images,index:or.index,panoIndex:or.panoIndex,loadable:or.loadable,panoId:or.panoId,pano:or.pano,work:or.work,derivedId:or.derivedId,video:or.video,position:new Vector3().copy(or.position).applyMatrix4(Xe),standingPosition:new Vector3().copy(or.standingPosition).applyMatrix4(Xe),quaternion:new Quaternion().setFromRotationMatrix(scratchMatrix4$1.makeRotationFromQuaternion(or.quaternion).premultiply(Xe))};Object.freeze(sr),Be.push(sr),De[sr.panoId]=sr}}Object.freeze(Be);for(var cr=$e.slice(),Br={},tn=0,en=cr;tn<en.length;tn++){var Je=en[tn];Br[Je.workCode]=Je}return Object.freeze(Object.assign(cr,{get initial(){return cr.length>0?cr[0].initial:{work:{}}},get resolvedObservers(){return Be},getWork:function(an){return Br[an]},getResolvedObserver:function(an){var rn,on;return isPanoId(an)?De[an]:typeof an=="number"?De[panoStringify({workCode:(on=(rn=$e[0])===null||rn===void 0?void 0:rn.workCode)!==null&&on!==void 0?on:"",panoIndex:an})]:De[panoStringify(an)]},update:function(){for(var an=0,rn=cr;an<rn.length;an++){var on=rn[an],sn=on.transform,ln=Se[on.workCode];ln?ln.equals(sn)||(ln.copy(sn),needsUpdateWorkCodeSet.add(on.workCode)):(Se[on.workCode]=new Matrix4().copy(sn),needsUpdateWorkCodeSet.add(on.workCode))}if(needsUpdateWorkCodeSet.size>0){for(var cn=0,hn=Be;cn<hn.length;cn++){var mn=hn[cn];if(needsUpdateWorkCodeSet.has(mn.work.workCode)){var An=mn.work.observers[mn.index],xn=mn.work.transform;mn.position.copy(An.position).applyMatrix4(xn),mn.standingPosition.copy(An.standingPosition).applyMatrix4(xn),mn.quaternion.setFromRotationMatrix(scratchMatrix4$1.makeRotationFromQuaternion(An.quaternion).premultiply(xn))}}needsUpdateWorkCodeSet.clear()}}}))}var fetcherMap=new Map;function getFetcher($e){var Se=fetcherMap.get($e);if(Se)return Se;throw new Error("fetcher never registered.")}function registerFetcher($e,Se){return fetcherMap.set($e,Se)}var BufferGeometryUtils={computeTangents:function($e){var Se=$e.index,Be=$e.attributes;if(Se===null||Be.position===void 0||Be.normal===void 0||Be.uv===void 0){console.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");return}var De=Se.array,Ve=Be.position.array,Fe=Be.normal.array,Je=Be.uv.array,Xe=Ve.length/3;Be.tangent===void 0&&$e.setAttribute("tangent",new BufferAttribute(new Float32Array(4*Xe),4));for(var Ke=Be.tangent.array,Ye=[],or=[],sr=0;sr<Xe;sr++)Ye[sr]=new Vector3,or[sr]=new Vector3;var cr=new Vector3,Br=new Vector3,tn=new Vector3,en=new Vector2,an=new Vector2,rn=new Vector2,on=new Vector3,sn=new Vector3;function ln(Ln,Pn,Vn){cr.fromArray(Ve,Ln*3),Br.fromArray(Ve,Pn*3),tn.fromArray(Ve,Vn*3),en.fromArray(Je,Ln*2),an.fromArray(Je,Pn*2),rn.fromArray(Je,Vn*2);var Yn=Br.x-cr.x,ni=tn.x-cr.x,Rn=Br.y-cr.y,In=tn.y-cr.y,Gn=Br.z-cr.z,Fn=tn.z-cr.z,Hn=an.x-en.x,Dn=rn.x-en.x,zn=an.y-en.y,Qn=rn.y-en.y,Zn=1/(Hn*Qn-Dn*zn);on.set((Qn*Yn-zn*ni)*Zn,(Qn*Rn-zn*In)*Zn,(Qn*Gn-zn*Fn)*Zn),sn.set((Hn*ni-Dn*Yn)*Zn,(Hn*In-Dn*Rn)*Zn,(Hn*Fn-Dn*Gn)*Zn),Ye[Ln].add(on),Ye[Pn].add(on),Ye[Vn].add(on),or[Ln].add(sn),or[Pn].add(sn),or[Vn].add(sn)}var cn=$e.groups;cn.length===0&&(cn=[{start:0,count:De.length}]);for(var sr=0,hn=cn.length;sr<hn;++sr)for(var mn=cn[sr],An=mn.start,xn=mn.count,pn=An,dn=An+xn;pn<dn;pn+=3)ln(De[pn+0],De[pn+1],De[pn+2]);var fn=new Vector3,yn=new Vector3,Sn=new Vector3,gn=new Vector3,Cn,Mn,Bn;function kn(Ln){Sn.fromArray(Fe,Ln*3),gn.copy(Sn),Mn=Ye[Ln],fn.copy(Mn),fn.sub(Sn.multiplyScalar(Sn.dot(Mn))).normalize(),yn.crossVectors(gn,Mn),Bn=yn.dot(or[Ln]),Cn=Bn<0?-1:1,Ke[Ln*4]=fn.x,Ke[Ln*4+1]=fn.y,Ke[Ln*4+2]=fn.z,Ke[Ln*4+3]=Cn}for(var sr=0,hn=cn.length;sr<hn;++sr)for(var mn=cn[sr],An=mn.start,xn=mn.count,pn=An,dn=An+xn;pn<dn;pn+=3)kn(De[pn+0]),kn(De[pn+1]),kn(De[pn+2])},mergeBufferGeometries:function($e,Se){for(var Be=$e[0].index!==null,De=new Set(Object.keys($e[0].attributes)),Ve=new Set(Object.keys($e[0].morphAttributes)),Fe={},Je={},Xe=new BufferGeometry,Ke=0,Ye=0;Ye<$e.length;++Ye){var or=$e[Ye];if(Be!==(or.index!==null))return null;for(var sr in or.attributes){if(!De.has(sr))return null;Fe[sr]===void 0&&(Fe[sr]=[]),Fe[sr].push(or.attributes[sr])}for(var sr in or.morphAttributes){if(!Ve.has(sr))return null;Je[sr]===void 0&&(Je[sr]=[]),Je[sr].push(or.morphAttributes[sr])}if(Xe.userData.mergedUserData=Xe.userData.mergedUserData||[],Xe.userData.mergedUserData.push(or.userData),Se){var cr;if(Be)cr=or.index.count;else if(or.attributes.position!==void 0)cr=or.attributes.position.count;else return null;Xe.addGroup(Ke,cr,Ye),Ke+=cr}}if(Be){for(var Br=0,tn=[],Ye=0;Ye<$e.length;++Ye){for(var en=$e[Ye].index,an=0;an<en.count;++an)tn.push(en.getX(an)+Br);Br+=$e[Ye].attributes.position.count}Xe.setIndex(tn)}for(var sr in Fe){var rn=this.mergeBufferAttributes(Fe[sr]);if(!rn)return null;Xe.setAttribute(sr,rn)}for(var sr in Je){var on=Je[sr][0].length;if(on===0)break;Xe.morphAttributes=Xe.morphAttributes||{},Xe.morphAttributes[sr]=[];for(var Ye=0;Ye<on;++Ye){for(var sn=[],an=0;an<Je[sr].length;++an)sn.push(Je[sr][an][Ye]);var ln=this.mergeBufferAttributes(sn);if(!ln)return null;Xe.morphAttributes[sr].push(ln)}}return Xe},mergeBufferAttributes:function($e){for(var Se,Be,De,Ve=0,Fe=0;Fe<$e.length;++Fe){var Je=$e[Fe];if(Je.isInterleavedBufferAttribute||(Se===void 0&&(Se=Je.array.constructor),Se!==Je.array.constructor)||(Be===void 0&&(Be=Je.itemSize),Be!==Je.itemSize)||(De===void 0&&(De=Je.normalized),De!==Je.normalized))return null;Ve+=Je.array.length}for(var Xe=new Se(Ve),Ke=0,Fe=0;Fe<$e.length;++Fe)Xe.set($e[Fe].array,Ke),Ke+=$e[Fe].array.length;return new BufferAttribute(Xe,Be,De)},interleaveAttributes:function($e){for(var Se,Be=0,De=0,Ve=0,Fe=$e.length;Ve<Fe;++Ve){var Je=$e[Ve];if(Se===void 0&&(Se=Je.array.constructor),Se!==Je.array.constructor)return console.warn("AttributeBuffers of different types cannot be interleaved"),null;Be+=Je.array.length,De+=Je.itemSize}for(var Xe=new InterleavedBuffer(new Se(Be),De),Ke=0,Ye=[],or=["getX","getY","getZ","getW"],sr=["setX","setY","setZ","setW"],cr=0,Fe=$e.length;cr<Fe;cr++){var Je=$e[cr],Br=Je.itemSize,tn=Je.count,en=new InterleavedBufferAttribute(Xe,Br,Ke,Je.normalized);Ye.push(en),Ke+=Br;for(var an=0;an<tn;an++)for(var rn=0;rn<Br;rn++)en[sr[rn]](an,Je[or[rn]](an))}return Ye},estimateBytesUsed:function($e){var Se=0;for(var Be in $e.attributes){var De=$e.getAttribute(Be);Se+=De.count*De.itemSize*De.array.BYTES_PER_ELEMENT}var Ve=$e.getIndex();return Se+=Ve?Ve.count*Ve.itemSize*Ve.array.BYTES_PER_ELEMENT:0,Se},mergeVertices:function($e,Se){Se===void 0&&(Se=1e-4),Se=Math.max(Se,Number.EPSILON);for(var Be={},De=$e.getIndex(),Ve=$e.getAttribute("position"),Fe=De?De.count:Ve.count,Je=0,Xe=Object.keys($e.attributes),Ke={},Ye={},or=[],sr=["getX","getY","getZ","getW"],cr=0,Br=Xe.length;cr<Br;cr++){var tn=Xe[cr];Ke[tn]=[];var en=$e.morphAttributes[tn];en&&(Ye[tn]=new Array(en.length).fill().map(function(){return[]}))}for(var an=Math.log10(1/Se),rn=Math.pow(10,an),cr=0;cr<Fe;cr++){for(var on=De?De.getX(cr):cr,sn="",ln=0,Br=Xe.length;ln<Br;ln++)for(var tn=Xe[ln],cn=$e.getAttribute(tn),hn=cn.itemSize,mn=0;mn<hn;mn++)sn+="".concat(~~(cn[sr[mn]](on)*rn),",");if(sn in Be)or.push(Be[sn]);else{for(var ln=0,Br=Xe.length;ln<Br;ln++)for(var tn=Xe[ln],cn=$e.getAttribute(tn),en=$e.morphAttributes[tn],hn=cn.itemSize,An=Ke[tn],xn=Ye[tn],mn=0;mn<hn;mn++){var pn=sr[mn];if(An.push(cn[pn](on)),en)for(var dn=0,fn=en.length;dn<fn;dn++)xn[dn].push(en[dn][pn](on))}Be[sn]=Je,or.push(Je),Je++}}for(var yn=$e.clone(),cr=0,Br=Xe.length;cr<Br;cr++){var tn=Xe[cr],Sn=$e.getAttribute(tn),gn=new Sn.array.constructor(Ke[tn]),cn=new BufferAttribute(gn,Sn.itemSize,Sn.normalized);if(yn.setAttribute(tn,cn),tn in Ye)for(var ln=0;ln<Ye[tn].length;ln++){var Cn=$e.morphAttributes[tn][ln],gn=new Cn.array.constructor(Ye[tn][ln]),Mn=new BufferAttribute(gn,Cn.itemSize,Cn.normalized);yn.morphAttributes[tn][ln]=Mn}}return yn.setIndex(or),yn}};function isThirdPersonMode($e){switch($e){case"Floorplan":return!0;case"Mapview":return!0;default:return!1}}function isFristPersonMode($e){switch($e){case"Panorama":return!0;case"VRPanorama":return!0;case"XRPanorama":return!0;case"Model":return!0;default:return!1}}var scratchVector3=new Vector3,scratchSphere=new Sphere,scratchMatrix4=new Matrix4,scratchMatrix4Inverse=new Matrix4,scratchBoundingBox=new Box3,ROTATE_X_90_MATRIX=new Matrix4().fromArray([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),ROTATE_X_90_MATRIX_INVERSE=new Matrix4().fromArray([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),DEFAULT_BOUNDING=new Box3(new Vector3(-.5,-.5,-.5),new Vector3(.5,.5,.5));function getEcefToEnuMatrixFromUpAxis($e,Se,Be){switch($e){case"Z":break;case"Y":Be.copy(ROTATE_X_90_MATRIX_INVERSE);break;case"-Y":Be.copy(ROTATE_X_90_MATRIX);break;case"WGS84":case"GCJ02":case"BD09":getEcefToEnuMatrix(Se,Be);break;default:Be.identity();break}return Be}function getExt($e){var Se=/([0-9a-z\.\_\-]+)([\?\#].*)?$/i.exec($e);if(Se){var Be=String(Se[1]).trim().split(".").slice(1).reverse()[0];if(Be)return Be}return""}var ModelViewLayer=function(){function $e(Se,Be){this.scene=Se,this.error=Be,Se.viewLayer=this}return Object.defineProperty($e.prototype,"name",{get:function(){return this.scene.name},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"type",{get:function(){return this.scene.type},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"upAxis",{get:function(){return this.scene.upAxis},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"groundHeight",{get:function(){return this.scene.groundHeight},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"model",{get:function(){return this.scene.model},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"coordinates",{get:function(){scratchVector3.setScalar(0);var Se=this.scene.localToLla(scratchVector3),Be=Se.x,De=Se.y;return[Be,De].map(function(Ve){return(Ve/Math.PI*180).toFixed(6)}).join(",")},enumerable:!1,configurable:!0}),$e.prototype.getTransformMatrix4=function(Se){return Se===void 0&&(Se=new Matrix4),Se.copy(this.scene.coordinateTransform.ecefToLocalMatrix),this.scene&&Se.premultiply(this.scene.matrixWorld),Se},$e.prototype.coordinatesToWorldPoint=function(Se){var Be=new Vector3(Se.latitude,Se.longitude,Se.altitude);return this.scene.llaToWorld(Be)},$e.prototype.worldPointToCoordinates=function(Se){return scratchVector3.copy(Se),this.scene.worldToLla(scratchVector3),{latitude:scratchVector3.x,longitude:scratchVector3.y,altitude:scratchVector3.z}},$e}(),Model=function($e){__extends(Se,$e);function Se(Be){Be===void 0&&(Be={});var De,Ve,Fe,Je=$e.call(this)||this;return Je.name="",Je.onError=(De=Be.onError)!==null&&De!==void 0?De:noop$1,Je.onShownFloorChange=(Ve=Be.onShownFloorChange)!==null&&Ve!==void 0?Ve:noop$1,Je.onLoad=(Fe=Be.onLoad)!==null&&Fe!==void 0?Fe:noop$1,Je.work=null,Je.viewLayers=[],Je.bounding=new Box3(new Vector3,new Vector3),Je.floorLength=0,Je.textureOptions={},Je.refined=!1,Je.refineProgress=[0,0],Je.loaded=!1,Je.matrixAutoUpdate=!1,Je.needsRender=!0,Je.autoRefine=!0,Je.materialVersion=0,Je.materialParameters=__assign({},defaultPbmParameters),Je.cacheCameras=[],Je.disposed=!1,Je}return Object.defineProperty(Se.prototype,"empty",{get:function(){return this.viewLayers.length===0},enumerable:!1,configurable:!0}),Se.prototype.getMaterial=function(){return __assign({},this.materialParameters)},Se.prototype.setMaterial=function(Be){var De=this.materialParameters.shownFloorIndex,Ve=updatePBMParameters(this.materialParameters,Be);if(Ve){var Fe=this.materialParameters.shownFloorIndex;De!==Fe&&this.onShownFloorChange(Fe),this.materialVersion++,this.needsRender=!0}},Object.defineProperty(Se.prototype,"brightness",{get:function(){return this.materialParameters.brightness},set:function(Be){this.setMaterial({brightness:typeof Be=="number"?Be:1})},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"shownFloorIndex",{get:function(){return this.materialParameters.shownFloorIndex},set:function(Be){this.setMaterial({shownFloorIndex:Be})},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"shownFloor",{get:function(){return this.shownFloorIndex===-1?null:this.shownFloorIndex},set:function(Be){this.shownFloorIndex=Be===null?-1:Be},enumerable:!1,configurable:!0}),Se.prototype.show=function(Be){this.shownFloor=Be??null},Object.defineProperty(Se.prototype,"clippers",{get:function(){return this.materialParameters.clippers},set:function(Be){this.setMaterial({clippers:Be})},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"customShaders",{get:function(){return this.materialParameters.customShaders},set:function(Be){this.setMaterial({customShaders:Be})},enumerable:!1,configurable:!0}),Se.prototype.getEdgesBySphere=function(Be,De){De===void 0&&(De=30/180*Math.PI);for(var Ve=Math.cos(De),Fe=[],Je=0,Xe=this.children;Je<Xe.length;Je++){var Ke=Xe[Je];Ke instanceof Tile3DModel&&Ke.tileset.selectedTiles.forEach(function(Ye){var or,sr,cr;if(!(Ye.boundingVolume&&Ye.boundingVolume.distanceToPoint(Be.center)>Be.radius)){var Br=(sr=(or=Ye.content)===null||or===void 0?void 0:or.data)===null||sr===void 0?void 0:sr.object;if(Br&&Br.visible){var tn=[];if(Br.traverseVisible(function(Vn){if(Vn instanceof Mesh){var Yn=bvhMeshMap.get(Vn);if(Yn){scratchMatrix4.copy(Vn.matrixWorld),scratchMatrix4Inverse.getInverse(scratchMatrix4),scratchSphere.copy(Be).applyMatrix4(scratchMatrix4Inverse);var ni=Yn.trianglesInSphere(scratchSphere.center,scratchSphere.radius),Rn=new BufferGeometry;Rn.setAttribute("position",new BufferAttribute(ni,3)),Rn.applyMatrix4(Vn.matrixWorld),Rn=BufferGeometryUtils.mergeVertices(Rn,.01),tn.push(Rn)}}}),tn.length===0)return;for(var en=["a","b","c"],an=BufferGeometryUtils.mergeBufferGeometries(tn,!1),rn=an.getAttribute("position").array,on=((cr=an.getIndex())===null||cr===void 0?void 0:cr.array)||[],sn=[],ln=[],cn=0,hn=rn.length;cn<hn;cn+=3){var mn=new Vector3(rn[cn],rn[cn+1],rn[cn+2]);sn.push(mn)}for(var cn=0,hn=on.length;cn<hn;cn+=3){var An=on[cn],xn=on[cn+1],pn=on[cn+2],dn=new Vector3().crossVectors(sn[xn].clone().sub(sn[An]),sn[pn].clone().sub(sn[An])).normalize();ln.push({a:An,b:xn,c:pn,normal:dn})}for(var fn={},cn=0,hn=ln.length;cn<hn;cn++)for(var yn=ln[cn],Sn=0;Sn<3;Sn++){var gn=yn[en[Sn]],Cn=yn[en[(Sn+1)%3]],Mn=[Math.min(gn,Cn),Math.max(gn,Cn)],Bn=Mn[0]+"-"+Mn[1];fn[Bn]===void 0?fn[Bn]={index1:Mn[0],index2:Mn[1],face1:cn}:fn[Bn].face2=cn}for(var Bn in fn){var kn=fn[Bn];if(kn.face2===void 0||ln[kn.face1].normal.dot(ln[kn.face2].normal)<=Ve){var Ln=sn[kn.index1],Pn=sn[kn.index2];Fe.push(new Line3(Ln,Pn))}}sn.length=0,ln.length=0}}})}return Fe},Se.prototype.intersectRaycaster=function(Be,De,Ve){De===void 0&&(De=null),Ve===void 0&&(Ve=!0);for(var Fe=[],Je=0,Xe=this.children.length;Je<Xe;Je++){var Ke=this.children[Je];Ke.visible&&Ke instanceof Tile3DModel&&Ke.intersectRaycaster(Be,!1,Fe)}return De!=null&&(Fe=Fe.filter(function(Ye){return Ye.floor===De})),this.getMaterial().pointBack==="HIDDEN"&&(Fe=Fe.filter(function(Ye){return!(Ye.object instanceof PBMPointCloud&&Ye.face&&Ye.face.normal.angleTo(Be.ray.direction)<Math.PI/2)})),Ve&&Fe.sort(function(Ye,or){return Ye.distance-or.distance}),Fe},Se.prototype.load=function(Be,De){var Ve,Fe=this,Je,Xe,Ke,Ye,or;if(De===void 0&&(De={}),this.work=Be,this.name=this.work.workCode,!Be.model)return Promise.resolve();for(var sr=Be.model,cr=0,Br=0,tn=Be.observers;Br<tn.length;Br++){var en=tn[Br];cr=Math.max(cr,en.floorIndex)}this.floorLength=cr+1;for(var an=!1,rn=[],on=function(In){var Gn=In.tileset,Fn=In.upAxis,Hn=In.name,Dn=In.type;Dn==="mesh"&&(an=!0);var zn=Gn.split("#"),Qn=zn[0],Zn=zn[1],si=(Je=(Zn||Qn).split("?")[1])!==null&&Je!==void 0?Je:"",ei=typeof De["3d-tiles"]=="function"?De["3d-tiles"](In):(Xe=De["3d-tiles"])!==null&&Xe!==void 0?Xe:{},hi=getFetcher(Be).ajax(Gn,{responseType:"text"}).then(function(Un){var Wn,Ai,oi=Gn?Gn.slice(0,Gn.lastIndexOf("/")+1):"",ci=normalizeTilesetHeader(JSON.parse(Un.body),oi),ai=ci.root,wi=ci.rootMeta,Pi=wi===void 0?{}:wi;Pi.upAxis&&Pi.upAxis!==Fn&&(Fn=Pi.upAxis),"lodVersion"in ci&&(Fn="-Y","floorInfo"in ci&&(ci.properties=ci.properties||{},ci.properties.floorInfo=ci.floorInfo.map(function(Ui){return{ground:-Ui.ground,height:Ui.height}}),delete ci.floorInfo),ci.asset.tilesetVersion=String(ci.lodVersion),delete ci.lodVersion);var Oi=ai.boundingVolume?makeBoundingVolume(ai.boundingVolume):void 0;Oi&&ai.transform&&Oi.applyMatrix4(scratchMatrix4.fromArray(ai.transform));var Ri=null,_i=new Matrix4,Mi=new Matrix4;Pi.coordinate?(Ri=Pi.coordinate.ground_height,_i.fromArray(Pi.coordinate.pose_ecef_to_enu),Mi.fromArray(Pi.coordinate.pose_enu_to_ecef)):(Oi?Oi.getCenter(scratchVector3):scratchVector3.setScalar(0),getEcefToEnuMatrixFromUpAxis(Fn,scratchVector3,_i),Mi.getInverse(_i));var $i=new Matrix4().copy(ROTATE_X_90_MATRIX),vi=new Matrix4().copy(ROTATE_X_90_MATRIX_INVERSE),ri=new Matrix4().premultiply(_i).premultiply($i),Ti=new Matrix4().getInverse(ri),Bi;if(ei.viewerRequestVolume){var qi=isBoundingVolume(ei.viewerRequestVolume)?ei.viewerRequestVolume:makeBoundingVolume(ei.viewerRequestVolume);qi.applyMatrix4(Ti),Bi=qi.toJson()}ci.root={refine:(Wn=ai.refine)!==null&&Wn!==void 0?Wn:"REPLACE",geometricError:ai.geometricError,transform:ri.toArray(),boundingVolume:Oi?Oi.toJson():void 0,viewerRequestVolume:Bi,children:[ai]};var Ii=new Tile3DModel(Fe,ci,{name:Hn,light:(Ai=De.light)!==null&&Ai!==void 0?Ai:!1,type:Dn,upAxis:Fn,url:Gn,referer:Gn,search:si,fetcher:getFetcher(Be),groundHeight:Ri,coordinateTransform:{localToEnuMatrix:vi,enuToLocalMatrix:$i,enuToEcefMatrix:Mi,ecefToEnuMatrix:_i,localToEcefMatrix:Ti,ecefToLocalMatrix:ri}});return Ii.matrix.copy(Be.transform),Ii.matrix.decompose(Ii.position,Ii.quaternion,Ii.scale),Ii.matrixWorldNeedsUpdate=!0,Object.assign(Ii.maxMemoryUsage,Ii.getRecommendProps()),typeof ei.debug<"u"&&(Ii.debug=ei.debug),typeof ei.minLevelOfDetail<"u"&&(Ii.minLevelOfDetail=ei.minLevelOfDetail),typeof ei.maxLevelOfDetail<"u"&&(Ii.maxLevelOfDetail=ei.maxLevelOfDetail),typeof ei.minGeometricError<"u"&&(Ii.minGeometricError=ei.minGeometricError),typeof ei.maxGeometricError<"u"&&(Ii.maxGeometricError=ei.maxGeometricError),typeof ei.skipLevelOfDetail<"u"&&(Ii.skipLevelOfDetail=ei.skipLevelOfDetail),typeof ei.mostDetail<"u"&&(Ii.mostDetail=ei.mostDetail),typeof ei.loadSiblings<"u"&&(Ii.loadSiblings=ei.loadSiblings),typeof ei.loadAll<"u"&&(Ii.loadAll=ei.loadAll),typeof ei.maxMemoryUsage<"u"&&(Ii.maxMemoryUsage=ei.maxMemoryUsage),typeof ei.maxRequests<"u"&&(Ii.maxRequests=ei.maxRequests),typeof ei.requestOrder<"u"&&(Ii.requestOrder=ei.requestOrder),typeof ei.maxScreenSpaceError<"u"&&(Ii.maxScreenSpaceError=ei.maxScreenSpaceError),(ei.showLayers===!1||Array.isArray(ei.showLayers)&&ei.showLayers.indexOf(Hn)===-1)&&(Ii.visible=!1),new ModelViewLayer(Ii,null)});rn.push(hi.catch(function(Un){var Wn;Fe.onError(Un);var Ai=new Matrix4,oi=new Matrix4,ci=new Matrix4().copy(ROTATE_X_90_MATRIX),ai=new Matrix4().copy(ROTATE_X_90_MATRIX_INVERSE),wi=new Matrix4().premultiply(Ai).premultiply(ci),Pi=new Matrix4().getInverse(wi),Oi=Gn?Gn.slice(0,Gn.lastIndexOf("/")+1):"",Ri;if(ei.viewerRequestVolume){var _i=isBoundingVolume(ei.viewerRequestVolume)?ei.viewerRequestVolume:makeBoundingVolume(ei.viewerRequestVolume);_i.applyMatrix4(Pi),Ri=_i.toJson()}var Mi=normalizeTilesetHeader({asset:{version:"0.0"},geometricError:0,viewerRequestVolume:Ri,root:{geometricError:0}},Oi),$i=new Tile3DModel(Fe,Mi,{name:Hn,light:(Wn=De.light)!==null&&Wn!==void 0?Wn:!1,type:Dn,upAxis:Fn,url:Gn,referer:Gn,search:si,fetcher:getFetcher(Be),groundHeight:null,coordinateTransform:{localToEnuMatrix:ai,enuToLocalMatrix:ci,enuToEcefMatrix:oi,ecefToEnuMatrix:Ai,localToEcefMatrix:Pi,ecefToLocalMatrix:wi},onError:Fe.onError});return $i.matrix.copy(Be.transform),$i.matrix.decompose($i.position,$i.quaternion,$i.scale),$i.matrixWorldNeedsUpdate=!0,(ei.showLayers===!1||Array.isArray(ei.showLayers)&&ei.showLayers.indexOf(Hn)===-1)&&($i.visible=!1),new ModelViewLayer($i,Un)}))},sn=0,ln=sr.layers;sn<ln.length;sn++){var cn=ln[sn];on(cn)}if(!an&&sr.file){var hn=sr.file,mn=sr.textureBase,An=sr.textures,xn="fallback",pn="mesh",dn="Z",fn="",cn={name:xn,type:pn,upAxis:dn,tileset:fn},yn=typeof De["3d-tiles"]=="function"?De["3d-tiles"](cn):(Ke=De["3d-tiles"])!==null&&Ke!==void 0?Ke:{},Sn=getExt(hn)||"at3d",gn=new Matrix4,Cn=new Matrix4,Mn=new Matrix4().copy(ROTATE_X_90_MATRIX),Bn=new Matrix4().copy(ROTATE_X_90_MATRIX_INVERSE);getEcefToEnuMatrixFromUpAxis(dn,scratchVector3.setScalar(0),gn),Cn.getInverse(gn);var kn=new Matrix4().premultiply(gn).premultiply(Mn),Ln=new Matrix4().getInverse(kn),Pn=void 0;if(yn.viewerRequestVolume){var Vn=isBoundingVolume(yn.viewerRequestVolume)?yn.viewerRequestVolume:makeBoundingVolume(yn.viewerRequestVolume);Vn.applyMatrix4(Ln),Pn=Vn.toJson()}var Yn=normalizeTilesetHeader({asset:{version:"0.0"},geometricError:0,root:{refine:"REPLACE",geometricError:0,transform:kn.toArray(),viewerRequestVolume:Pn,content:{uri:hn},extras:(Ve={},Ve[Sn]={textureBaseUri:mn,textureArray:An,textureOptions:(Ye=De.textureOptions)!==null&&Ye!==void 0?Ye:{}},Ve)}},""),ni=new Tile3DModel(this,Yn,{name:xn,light:(or=De.light)!==null&&or!==void 0?or:!1,type:pn,upAxis:dn,url:fn,referer:hn,fetcher:getFetcher(Be),groundHeight:null,coordinateTransform:{localToEnuMatrix:Bn,enuToLocalMatrix:Mn,enuToEcefMatrix:Cn,ecefToEnuMatrix:gn,localToEcefMatrix:Ln,ecefToLocalMatrix:kn},onError:this.onError});ni.matrix.copy(Be.transform),ni.matrix.decompose(ni.position,ni.quaternion,ni.scale),ni.matrixWorldNeedsUpdate=!0,(yn.showLayers===!1||Array.isArray(yn.showLayers)&&yn.showLayers.indexOf(xn)===-1)&&(ni.visible=!1);var Rn=new ModelViewLayer(ni,null);rn.push(Promise.resolve(Rn))}return Promise.all(rn).then(function(In){for(var Gn=0,Fn=In;Gn<Fn.length;Gn++){var Hn=Fn[Gn];if(Fe.disposed){Hn.scene.dispose();continue}Fe.viewLayers.push(Hn),Fe.add(Hn.scene)}})},Se.prototype.update=function(Be,De,Ve){if(this.children.length){var Fe=this.loaded;this.refined=this.work!==null,this.refineProgress[0]=0,this.refineProgress[1]=0,this.loaded=this.work!==null;for(var Je=0,Xe=this.viewLayers;Je<Xe.length;Je++){var Ke=Xe[Je],Ye=Ke.scene;Ye&&(this.work&&(Ye.cacheCameras=this.cacheCameras,this.autoRefine===!1?Ye.needsRefined=!1:isFristPersonMode(Ve)?Ye.needsRefined=this.materialParameters.modelAlpha===0||this.materialParameters.modelAlpha===1:Ye.needsRefined=!0,this.work.transform.equals(Ye.matrix)||(Ye.matrix.copy(this.work.transform),Ye.matrix.decompose(Ye.position,Ye.quaternion,Ye.scale),Ye.matrixWorldNeedsUpdate=!0)),Ye.update(Be,De,Ve),Ye.needsRender===!0&&(Ye.needsRender=!1,this.needsRender=!0),Ye.refined===!1&&(this.refined=!1),this.refineProgress[0]+=Ye.refineProgress[0],this.refineProgress[1]+=Ye.refineProgress[1],Ye.loaded===!1&&(this.loaded=!1))}this.bounding.makeEmpty();for(var or=0,sr=this.viewLayers;or<sr.length;or++){var Ke=sr[or],Ye=Ke.scene;Ye&&(Ye.boundingBox.isEmpty()||(scratchBoundingBox.copy(Ye.boundingBox).applyMatrix4(Ye.matrix),this.bounding.union(scratchBoundingBox)))}this.bounding.isEmpty()&&this.bounding.copy(DEFAULT_BOUNDING),Fe===!1&&this.loaded===!0&&this.onLoad()}else this.work&&!this.work.model?(this.refined=!0,this.refineProgress[0]=0,this.refineProgress[1]=0,this.loaded=!0):(this.refined=!1,this.refineProgress[0]=0,this.refineProgress[1]=0,this.loaded=!1),this.bounding.set(new Vector3,new Vector3)},Se.prototype.dispose=function(){this.disposed=!0;for(var Be;Be=this.children[0];)Be instanceof Tile3DModel&&Be.dispose(),this.remove(Be)},Se}(Object3D);function createModels(){var $e=new Box3,Se=omit(defaultPbmParameters,["clippers","shownFloorIndex","brightness","customShaders"]),Be=Object.assign([],{bounding:$e,needsRender:!1,refined:!1,refineProgress:[0,0],loaded:!1,materialVersion:0,cacheCameras:[],autoUpdate:!0,intersectRaycaster:function(De,Ve,Fe){Fe===void 0&&(Fe=!0);var Je;if(Be.length===1)Je=Be[0].intersectRaycaster(De,Ve,Fe);else if(Be.length===0)Je=[];else{Je=[];for(var Xe=0,Ke=Be;Xe<Ke.length;Xe++){var Ye=Ke[Xe];if(Ye.visible){var or=Ye.intersectRaycaster(De,Ve,!1);or.length&&Je.push.apply(Je,or)}}Fe&&Je.sort(function(sr,cr){return sr.distance-cr.distance})}return Je},setMaterial:function(De){var Ve=updatePBMParameters(Se,De);Ve&&(Be.materialVersion++,Be.needsRender=!0)},getMaterial:function(){return __assign({},Se)},resetBrightness:function(){for(var De=0,Ve=Be;De<Ve.length;De++){var Fe=Ve[De];Fe.setMaterial({brightness:1})}},update:function(De,Ve,Fe){Be.refined=Be.length>0,Be.loaded=Be.length>0,Be.refineProgress[0]=0,Be.refineProgress[1]=0,$e.makeEmpty();for(var Je=0,Xe=Be.cacheCameras;Je<Xe.length;Je++){var Ke=Xe[Je];Ke.updateMatrixWorld(!0),Ke.updateProjectionMatrix()}for(var Ye=0,or=0,sr=Be;or<sr.length;or++){for(var cr=sr[or],Br=0,tn=cr.viewLayers;Br<tn.length;Br++){var en=tn[Br];en.scene.modelIndex=Ye++}cr.setMaterial(Se),cr.cacheCameras=Be.cacheCameras,cr.autoRefine=this.autoUpdate,cr.update(De,Ve,Fe),cr.needsRender===!0&&(Be.needsRender=!0,cr.needsRender=!1),cr.refined===!1&&(Be.refined=!1),Be.refineProgress[0]+=cr.refineProgress[0],Be.refineProgress[1]+=cr.refineProgress[1],cr.loaded===!1&&(Be.loaded=!1),$e.union(cr.bounding)}for(var an=0,rn=Be;an<rn.length;an++)for(var cr=rn[an],on=0,sn=cr.viewLayers;on<sn.length;on++){var en=sn[on];en.scene.modelsLoaded=Be.loaded}$e.isEmpty()&&$e.copy(DEFAULT_BOUNDING)}});return Be}var easeOut$2=function($e){return $e*(2-$e)},sharedGeometry2$2=function(){var $e=new Float32Array([-.18,0,-.18,.18,0,-.18,-.18,0,.18,.18,0,.18]),Se=new Float32Array([1,0,0,0,1,1,0,1]),Be=new Uint8Array([0,2,1,2,3,1]),De=new BufferGeometry;return De.setAttribute("position",new BufferAttribute($e,3)),De.setAttribute("uv",new BufferAttribute(Se,2)),De.setIndex(new BufferAttribute(Be,1)),De}(),vertexShader$4=`
varying vec2 vUv;
#include <common>
#include <logdepthbuf_pars_vertex>
void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  #include <logdepthbuf_vertex>
}
`,fragmentShader$4=`
uniform vec3 baseColor;
uniform float circleScale;
uniform float ringScale;
uniform float ringOpacity;
uniform float loadingAngle;
uniform float loadingOpacity;
uniform float progress;
uniform float progressOpacity;
uniform float expand0;
uniform float expand1;
uniform float expandOpacity;
uniform float opacity;
uniform float tapScale;
uniform float tapOpacity;
uniform float disable;
varying vec2 vUv;

#include <common>
#include <logdepthbuf_pars_fragment>
#define SMOOTH_DIST 0.017
#define CENTER vec2(0.5, 0.5)

float inside(float innerDist) {
  float dist = length(CENTER - vUv);
  return smoothstep(innerDist, innerDist + SMOOTH_DIST, dist);
}
float outside(float outerDist) {
  float dist = length(CENTER - vUv);
  return 1.0 - smoothstep(outerDist - SMOOTH_DIST, outerDist, dist);
}

vec4 create_circle() {
  float dist = length(CENTER - vUv);
  float gradient = clamp(0.8 + abs(dot(normalize(vec2(1.0, -1.0)), vUv - CENTER)) * 1.5, 0.0, 1.0);
  return vec4(1.0, 1.0, 1.0, gradient * tapOpacity * inside(0.15 * circleScale * tapScale) * outside(0.234 * circleScale * tapScale));
}

vec4 create_disable() {
  float dist = length(CENTER - vUv);
  return vec4(1.0, 1.0, 1.0, 0.5 * tapOpacity * outside(0.32 * circleScale * tapScale));
}

vec4 create_ring() {
  float gradient = clamp(0.5 + abs(dot(normalize(vec2(1.0, 1.0)), vUv - CENTER)), 0.0, 1.0);
  return vec4(1.0, 1.0, 1.0, gradient * tapOpacity * ringOpacity * inside(0.27 * ringScale * tapScale) * outside(0.32 * ringScale * tapScale));
}

vec4 create_loading() {
  float angle = PI - atan(CENTER.x - vUv.x, CENTER.y - vUv.y);
  angle = mod(angle + loadingAngle, PI2);
  float gradient = (1.0 - smoothstep(0.0, PI2, angle)) * 0.4 + 0.1;
  return vec4(1.0, 1.0, 1.0, gradient * tapOpacity * loadingOpacity * inside(0.208 * circleScale * tapScale) * outside(0.3 * circleScale * tapScale));
}

vec4 create_progress() {
  float angle = PI + atan(CENTER.x - vUv.x, CENTER.y - vUv.y);
  float bar = (1.0 - step(progress * PI2, angle)) * 0.5;
  return vec4(1.0, 1.0, 1.0, bar * tapOpacity * progressOpacity * inside(0.208 * circleScale * tapScale) * outside(0.3 * circleScale * tapScale));
}

vec4 create_expand0() {
  float width = 0.2;
  float radius = 0.2 + (0.43 - 0.2) * expand0;
  float dist = length(CENTER - vUv);
  float gradient = (1.0 - clamp((radius - dist) / width, 0.0, 1.0)) * 0.8 * clamp((1.0 - abs(expand0 - 0.5) * 2.0) * 1.2, 0.0, 1.0);
  return vec4(1.0, 1.0, 1.0, gradient * expandOpacity * outside(radius));
}

vec4 create_expand1() {
  float width = 0.2;
  float radius = 0.2 + (0.43 - 0.2) * expand1;
  float dist = length(CENTER - vUv);
  float gradient = (1.0 - clamp((radius - dist) / width, 0.0, 1.0)) * 0.8 * clamp((1.0 - abs(expand1 - 0.5) * 2.0) * 1.2, 0.0, 1.0);
  return vec4(1.0, 1.0, 1.0, gradient * expandOpacity * outside(radius));
}

void main() {
  #include <logdepthbuf_fragment>
  gl_FragColor = vec4(1.0, 1.0, 1.0, 0);

  vec4 expand1Color = create_expand1();
  gl_FragColor = mix(gl_FragColor, expand1Color, expand1Color.a);

  vec4 expand0Color = create_expand0();
  gl_FragColor = mix(gl_FragColor, expand0Color, expand0Color.a);

  vec4 progressColor = create_progress();
  gl_FragColor = mix(gl_FragColor, progressColor, progressColor.a);

  vec4 loadingColor = create_loading();
  gl_FragColor = mix(gl_FragColor, loadingColor, loadingColor.a);

  vec4 circleColor = create_circle();
  gl_FragColor = mix(gl_FragColor, circleColor, circleColor.a);

  vec4 ringColor = create_ring();
  gl_FragColor = mix(gl_FragColor, ringColor, ringColor.a);

  gl_FragColor = mix(gl_FragColor, create_disable(), disable);

  gl_FragColor = vec4(gl_FragColor.rgb * baseColor, gl_FragColor.a * opacity * opacity);
}
`,PanoCircleMesh=function($e){__extends(Se,$e);function Se(Be){Be===void 0&&(Be={});var De,Ve,Fe=$e.call(this)||this,Je=(De=Be.color)!==null&&De!==void 0?De:16777215,Xe=(Ve=Be.scale)!==null&&Ve!==void 0?Ve:1;return Fe.progress=0,Fe.opacity=0,Fe.loading=!1,Fe.current=!1,Fe.disabled=!1,Fe.currentMotion=new Motion({progress:0}),Fe.ringMotion=new Motion({scale:1,opacity:1}),Fe.tapMotion=new Motion({scale:1,opacity:1}),Fe.loadingOpacityMotion=new Motion({opacity:0}),Fe.progressMotion=new Motion({progress:0}),Fe.progressOpacityMotion=new Motion({opacity:0}),Fe.opacityMotion=new Motion({opacity:0}),Fe.disableMotion=new Motion({progress:0}),Fe.panoMesh=new Mesh(sharedGeometry2$2,new ShaderMaterial({blending:CustomBlending,blendSrc:SrcAlphaFactor,blendDst:OneMinusSrcAlphaFactor,blendSrcAlpha:OneFactor,blendDstAlpha:OneMinusSrcAlphaFactor,depthWrite:!1,vertexShader:vertexShader$4,fragmentShader:fragmentShader$4,uniforms:{baseColor:{value:new Color(Je)},circleScale:{value:1},ringScale:{value:1},ringOpacity:{value:1},loadingAngle:{value:0},loadingOpacity:{value:0},progress:{value:0},progressOpacity:{value:0},expand0:{value:0},expand1:{value:0},expandOpacity:{value:0},opacity:{value:0},tapScale:{value:1},tapOpacity:{value:1},disable:{value:0}}})),Fe.renderOrder=-2,Fe.panoMesh.renderOrder=-2,Fe.panoMesh.position.y=.004,Fe.panoMesh.scale.set(Xe,1,Xe),Fe.add(Fe.panoMesh),Fe.currentStartTime=now$2(),Fe.needsRender=!0,Fe}return Se.prototype.setProgress=function(Be){var De=this;this.setDisabled(!1),this.setLoading(!1),this.progress!==Be&&(Be=clamp$1(Be,0,1),this.tapMotion.ended&&(this.progress===0&&this.progressOpacityMotion.set({opacity:1},500).catch(noop$1),Be===0?this.progressOpacityMotion.set({opacity:0},500).catch(noop$1).then(function(){De.progressMotion.set({progress:0},0).catch(noop$1)}):this.progressMotion.set({progress:clamp$1(Be*1.2,0,1)},100).catch(noop$1)),this.progress=Be)},Se.prototype.setOpacity=function(Be){this.opacity!==Be&&(this.opacity=Be=clamp$1(Be,0,1),this.opacityMotion.set({opacity:Be},200).catch(noop$1))},Se.prototype.setCurrent=function(Be){this.current!==Be&&(this.currentMotion.set({progress:Be?1:0},2e3).catch(noop$1),this.current=Be,this.current===!0&&(this.currentStartTime=now$2()))},Se.prototype.setLoading=function(Be){this.loading!==Be&&(this.loading=Be,this.disabled===!0&&this.setDisabled(!1),this.loadingOpacityMotion.set({opacity:Be?1:0},500).catch(noop$1))},Se.prototype.setDisabled=function(Be){this.disabled!==Be&&(this.disabled=Be,this.loading===!0&&this.setLoading(!1),this.disableMotion.set({progress:Be?1:0},500).catch(noop$1))},Se.prototype.tap=function(){var Be=this;if(!this.tapMotion.ended)return Promise.resolve();var De=[{progress:0,value:{scale:1,opacity:1}},{progress:.3,value:{scale:.85,opacity:.5}},{progress:.8,value:{scale:1.05,opacity:.6}},{progress:1,value:{scale:1,opacity:1}}];return this.progressOpacityMotion.set({opacity:0},0).catch(noop$1),this.progressMotion.set({progress:0},0).catch(noop$1),this.tapMotion.setKeyframes(De,600).then(function(){Be.progressOpacityMotion.set({opacity:Be.progress>0?1:0},300).catch(noop$1),Be.progressMotion.set({progress:Be.progress},120).catch(noop$1)}).catch(noop$1)},Se.prototype.updateTime=function(Be,De){if(!this.progressMotion.ended){this.progressMotion.update(Be);var Ve=this.progressMotion.value.progress;this.panoMesh.material.uniforms.progress.value=Ve,this.needsRender=!0}if(!this.progressOpacityMotion.ended){this.progressOpacityMotion.update(Be);var Fe=this.progressOpacityMotion.value.opacity;this.panoMesh.material.uniforms.progressOpacity.value=Fe,this.needsRender=!0}if(!this.opacityMotion.ended){this.opacityMotion.update(Be);var Fe=this.opacityMotion.value.opacity;this.panoMesh.material.uniforms.opacity.value=Fe,this.needsRender=!0}if(this.visible=this.opacityMotion.value.opacity!==0,(!this.loadingOpacityMotion.ended||this.loadingOpacityMotion.value.opacity>0)&&(this.loadingOpacityMotion.update(Be),this.panoMesh.material.uniforms.loadingOpacity.value=this.loadingOpacityMotion.value.opacity,this.panoMesh.material.uniforms.loadingAngle.value=Be/120%(Math.PI*2),this.needsRender=!0),this.tapMotion.ended||(this.tapMotion.update(Be),this.panoMesh.material.uniforms.tapOpacity.value=this.tapMotion.value.opacity,this.panoMesh.material.uniforms.tapScale.value=this.tapMotion.value.scale,this.needsRender=!0),this.current||!this.currentMotion.ended){this.currentMotion.update(Be),this.panoMesh.material.uniforms.expandOpacity.value=this.currentMotion.value.progress;{var Je=(Be-this.currentStartTime-1500)/2e3;if(Je%5<2){var Xe=1+Math.sin(Math.PI*Je)/25*this.currentMotion.value.progress;this.panoMesh.material.uniforms.circleScale.value=Xe,this.needsRender=!0}}{var Ke=(Be-this.currentStartTime-1500)/2e3;if(Ke%5<2){var Ye=Ke%1;this.panoMesh.material.uniforms.expand0.value=easeOut$2(Ye)*this.currentMotion.value.progress,this.needsRender=!0}}{var or=(Be-this.currentStartTime-1e3)/2e3;if(or%5<2){var Ye=or%1;this.panoMesh.material.uniforms.expand1.value=easeOut$2(Ye)*this.currentMotion.value.progress,this.needsRender=!0}}}if(this.currentMotion.value.progress>.2&&this.progress===0&&this.loading===!1){var sr=(Be-this.currentStartTime-1e3)/2e3;sr%5<2?this.ringMotion.getTargetKeyframe().value.scale!==.8&&this.ringMotion.set({scale:.8,opacity:0},600).catch(noop$1):this.ringMotion.getTargetKeyframe().value.scale!==1&&this.ringMotion.set({scale:1,opacity:1},600).catch(noop$1)}else this.ringMotion.getTargetKeyframe().value.scale!==1&&this.ringMotion.set({scale:1,opacity:1},600).catch(noop$1);if(!this.ringMotion.ended){var cr=this.ringMotion.value,Xe=cr.scale,Fe=cr.opacity;this.ringMotion.update(Be),this.panoMesh.material.uniforms.ringScale.value=Xe,this.panoMesh.material.uniforms.ringOpacity.value=Fe,this.needsRender=!0}if(!this.disableMotion.ended){var Ve=this.disableMotion.value.progress;this.disableMotion.update(Be),this.panoMesh.material.uniforms.disable.value=Ve,this.needsRender=!0}},Se.prototype.dispose=function(){this.ringMotion.dispose(),this.tapMotion.dispose(),this.progressMotion.dispose(),this.progressOpacityMotion.dispose(),this.opacityMotion.dispose(),this.currentMotion.dispose(),this.panoMesh.material.dispose()},Se}(Object3D),easeOut$1=function($e){return $e*(2-$e)},sharedGeometry2$1=function(){var $e=new Float32Array([-.18,0,-.18,.18,0,-.18,-.18,0,.18,.18,0,.18]),Se=new Float32Array([1,0,0,0,1,1,0,1]),Be=new Uint8Array([0,2,1,2,3,1]),De=new BufferGeometry;return De.setAttribute("position",new BufferAttribute($e,3)),De.setAttribute("uv",new BufferAttribute(Se,2)),De.setIndex(new BufferAttribute(Be,1)),De}(),vertexShader$3=`
varying vec2 vUv;
#include <common>
#include <logdepthbuf_pars_vertex>
void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  #include <logdepthbuf_vertex>
}
`,fragmentShader$3=`
uniform vec3 baseColor;
uniform float circleScale;
uniform float circleOpacity;
uniform float loadingAngle;
uniform float loadingOpacity;
uniform float progress;
uniform float progressOpacity;
uniform float expand0;
uniform float expand1;
uniform float expandOpacity;
uniform float opacity;
uniform float tapScale;
uniform float tapOpacity;
uniform float disable;
varying vec2 vUv;

#include <common>
#include <logdepthbuf_pars_fragment>
#define SMOOTH_DIST 0.017
#define CENTER vec2(0.5, 0.5)

float inside(float innerDist) {
  float dist = length(CENTER - vUv);
  return smoothstep(innerDist, innerDist + SMOOTH_DIST, dist);
}
float outside(float outerDist) {
  float dist = length(CENTER - vUv);
  return 1.0 - smoothstep(outerDist - SMOOTH_DIST, outerDist, dist);
}

vec4 create_circle() {
  float dist = length(CENTER - vUv);
  return vec4(1.0, 1.0, 1.0, 0.8 * circleOpacity * tapOpacity * inside(0.2 * circleScale * tapScale) * outside(0.3 * circleScale * tapScale));
}

vec4 create_disable() {
  float dist = length(CENTER - vUv);
  return vec4(1.0, 1.0, 1.0, 0.5 * tapOpacity * outside(0.32 * circleScale * tapScale));
}

vec4 create_loading() {
  float angle = PI - atan(CENTER.x - vUv.x, CENTER.y - vUv.y);
  angle = mod(angle + loadingAngle, PI2);
  float gradient = (1.0 - smoothstep(0.0, PI2, angle)) * 0.9 + 0.1;
  return vec4(1.0, 1.0, 1.0, gradient * tapOpacity * loadingOpacity * inside(0.2 * circleScale * tapScale) * outside(0.3 * circleScale * tapScale));
}

vec4 create_progress() {
  float angle = PI + atan(CENTER.x - vUv.x, CENTER.y - vUv.y);
  float bar = (1.0 - step(progress * PI2, angle)) * 0.7;
  return vec4(1.0, 1.0, 1.0, bar * tapOpacity * progressOpacity * inside(0.2 * circleScale * tapScale) * outside(0.3 * circleScale * tapScale));
}

vec4 create_expand0() {
  float width = 0.2;
  float radius = 0.25 + (0.5 - 0.25) * expand0;
  float dist = length(CENTER - vUv);
  float gradient = (1.0 - clamp((radius - dist) / width, 0.0, 1.0)) * 0.8 * clamp((1.0 - abs(expand0 - 0.5) * 2.0) * 1.2, 0.0, 1.0);
  return vec4(1.0, 1.0, 1.0, gradient * expandOpacity * outside(radius));
}

vec4 create_expand1() {
  float width = 0.2;
  float radius = 0.25 + (0.48 - 0.25) * expand1;
  float dist = length(CENTER - vUv);
  float gradient = (1.0 - clamp((radius - dist) / width, 0.0, 1.0)) * 0.8 * clamp((1.0 - abs(expand1 - 0.5) * 2.0) * 1.2, 0.0, 1.0);
  return vec4(1.0, 1.0, 1.0, gradient * expandOpacity * outside(radius));
}

void main() {
  #include <logdepthbuf_fragment>
  gl_FragColor = vec4(1.0, 1.0, 1.0, 0);

  vec4 expand1Color = create_expand1();
  gl_FragColor = mix(gl_FragColor, expand1Color, expand1Color.a);

  vec4 expand0Color = create_expand0();
  gl_FragColor = mix(gl_FragColor, expand0Color, expand0Color.a);

  vec4 circleColor = create_circle();
  gl_FragColor = mix(gl_FragColor, circleColor, circleColor.a);

  vec4 progressColor = create_progress();
  gl_FragColor = mix(gl_FragColor, progressColor, progressColor.a);

  vec4 loadingColor = create_loading();
  gl_FragColor = mix(gl_FragColor, loadingColor, loadingColor.a);

  gl_FragColor = mix(gl_FragColor, create_disable(), disable);

  gl_FragColor = vec4(gl_FragColor.rgb * baseColor, gl_FragColor.a * opacity * opacity);
}
`;(function($e){__extends(Se,$e);function Se(Be){Be===void 0&&(Be={});var De,Ve,Fe=$e.call(this)||this,Je=(De=Be.color)!==null&&De!==void 0?De:16777215,Xe=(Ve=Be.scale)!==null&&Ve!==void 0?Ve:1;return Fe.progress=0,Fe.opacity=0,Fe.loading=!1,Fe.current=!1,Fe.disabled=!1,Fe.currentMotion=new Motion({progress:0}),Fe.tapMotion=new Motion({scale:1,opacity:1}),Fe.loadingOpacityMotion=new Motion({opacity:0}),Fe.progressMotion=new Motion({progress:0}),Fe.progressOpacityMotion=new Motion({opacity:0}),Fe.opacityMotion=new Motion({opacity:0}),Fe.disableMotion=new Motion({progress:0}),Fe.panoMesh=new Mesh(sharedGeometry2$1,new ShaderMaterial({blending:CustomBlending,blendSrc:SrcAlphaFactor,blendDst:OneMinusSrcAlphaFactor,blendSrcAlpha:OneFactor,blendDstAlpha:OneMinusSrcAlphaFactor,depthWrite:!1,vertexShader:vertexShader$3,fragmentShader:fragmentShader$3,uniforms:{baseColor:{value:new Color(Je)},circleScale:{value:1},circleOpacity:{value:1},loadingAngle:{value:0},loadingOpacity:{value:0},progress:{value:0},progressOpacity:{value:0},expand0:{value:0},expand1:{value:0},expandOpacity:{value:0},opacity:{value:0},tapScale:{value:1},tapOpacity:{value:1},disable:{value:0}}})),Fe.renderOrder=-2,Fe.panoMesh.renderOrder=-2,Fe.panoMesh.position.y=.004,Fe.panoMesh.scale.set(Xe,1,Xe),Fe.add(Fe.panoMesh),Fe.currentStartTime=now$2(),Fe.needsRender=!0,Fe}return Se.prototype.setProgress=function(Be){var De=this;this.setDisabled(!1),this.setLoading(!1),this.progress!==Be&&(Be=clamp$1(Be,0,1),this.tapMotion.ended&&(this.progress===0&&this.progressOpacityMotion.set({opacity:1},500).catch(noop$1),Be===0?this.progressOpacityMotion.set({opacity:0},500).catch(noop$1).then(function(){De.progressMotion.set({progress:0},0).catch(noop$1)}):this.progressMotion.set({progress:clamp$1(Be*1.2,0,1)},100).catch(noop$1)),this.progress=Be)},Se.prototype.setOpacity=function(Be){this.opacity!==Be&&(this.opacity=Be=clamp$1(Be,0,1),this.opacityMotion.set({opacity:Be},200).catch(noop$1))},Se.prototype.setCurrent=function(Be){this.current!==Be&&(this.currentMotion.set({progress:Be?1:0},2e3).catch(noop$1),this.current=Be,this.current===!0&&(this.currentStartTime=now$2()))},Se.prototype.setLoading=function(Be){this.loading!==Be&&(this.loading=Be,this.disabled===!0&&this.setDisabled(!1),this.loadingOpacityMotion.set({opacity:Be?1:0},500).catch(noop$1))},Se.prototype.setDisabled=function(Be){this.disabled!==Be&&(this.disabled=Be,this.loading===!0&&this.setLoading(!1),this.disableMotion.set({progress:Be?1:0},500).catch(noop$1))},Se.prototype.tap=function(){var Be=this;if(!this.tapMotion.ended)return Promise.resolve();var De=[{progress:0,value:{scale:1,opacity:1}},{progress:.3,value:{scale:.85,opacity:.5}},{progress:.8,value:{scale:1.05,opacity:.6}},{progress:1,value:{scale:1,opacity:1}}];return this.progressOpacityMotion.set({opacity:0},0).catch(noop$1),this.progressMotion.set({progress:0},0).catch(noop$1),this.tapMotion.setKeyframes(De,600).then(function(){Be.progressOpacityMotion.set({opacity:Be.progress>0?1:0},300).catch(noop$1),Be.progressMotion.set({progress:Be.progress},120).catch(noop$1)}).catch(noop$1)},Se.prototype.updateTime=function(Be,De){if(!this.progressMotion.ended){this.progressMotion.update(Be);var Ve=this.progressMotion.value.progress;this.panoMesh.material.uniforms.progress.value=Ve,this.needsRender=!0}if(!this.progressOpacityMotion.ended){this.progressOpacityMotion.update(Be);var Fe=this.progressOpacityMotion.value.opacity;this.panoMesh.material.uniforms.progressOpacity.value=Fe,this.needsRender=!0}if(!this.opacityMotion.ended){this.opacityMotion.update(Be);var Fe=this.opacityMotion.value.opacity;this.panoMesh.material.uniforms.opacity.value=Fe,this.needsRender=!0}if(this.visible=this.opacityMotion.value.opacity!==0,(!this.loadingOpacityMotion.ended||this.loadingOpacityMotion.value.opacity>0)&&(this.loadingOpacityMotion.update(Be),this.panoMesh.material.uniforms.loadingOpacity.value=this.loadingOpacityMotion.value.opacity,this.panoMesh.material.uniforms.loadingAngle.value=Be/120%(Math.PI*2),this.needsRender=!0),this.tapMotion.ended||(this.tapMotion.update(Be),this.panoMesh.material.uniforms.tapOpacity.value=this.tapMotion.value.opacity,this.panoMesh.material.uniforms.tapScale.value=this.tapMotion.value.scale,this.needsRender=!0),this.panoMesh.material.uniforms.circleOpacity.value=Math.max(.6,1-Math.max(this.loadingOpacityMotion.value.opacity,this.progressOpacityMotion.value.opacity)),this.current||!this.currentMotion.ended){this.currentMotion.update(Be),this.panoMesh.material.uniforms.expandOpacity.value=this.currentMotion.value.progress;{var Je=(Be-this.currentStartTime-1500)/2e3;if(Je%5<2){var Xe=1+Math.sin(Math.PI*Je)/25*this.currentMotion.value.progress;this.panoMesh.material.uniforms.circleScale.value=Xe,this.needsRender=!0}}{var Ke=(Be-this.currentStartTime-1500)/2e3;if(Ke%5<2){var Ye=Ke%1;this.panoMesh.material.uniforms.expand0.value=easeOut$1(Ye)*this.currentMotion.value.progress,this.needsRender=!0}}{var or=(Be-this.currentStartTime-1e3)/2e3;if(or%5<2){var Ye=or%1;this.panoMesh.material.uniforms.expand1.value=easeOut$1(Ye)*this.currentMotion.value.progress,this.needsRender=!0}}}if(!this.disableMotion.ended){var Ve=this.disableMotion.value.progress;this.disableMotion.update(Be),this.panoMesh.material.uniforms.disable.value=Ve,this.needsRender=!0}},Se.prototype.dispose=function(){this.tapMotion.dispose(),this.progressMotion.dispose(),this.progressOpacityMotion.dispose(),this.opacityMotion.dispose(),this.currentMotion.dispose(),this.panoMesh.material.dispose()},Se})(Object3D);var easeOut=function($e){return $e*(2-$e)},sharedGeometry2=function(){var $e=new Float32Array([-.18,0,-.18,.18,0,-.18,-.18,0,.18,.18,0,.18]),Se=new Float32Array([1,0,0,0,1,1,0,1]),Be=new Uint8Array([0,2,1,2,3,1]),De=new BufferGeometry;return De.setAttribute("position",new BufferAttribute($e,3)),De.setAttribute("uv",new BufferAttribute(Se,2)),De.setIndex(new BufferAttribute(Be,1)),De}(),vertexShader$2=`
varying vec2 vUv;
#include <common>
#include <logdepthbuf_pars_vertex>
void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  #include <logdepthbuf_vertex>
}
`,fragmentShader$2=`
#if defined(USE_MAP)
uniform sampler2D map;
uniform float mapAlpha;
#endif
#if defined(USE_BORDER)
uniform float borderWidth;
uniform vec3 borderColor;
#endif
uniform vec3 baseColor;
uniform float circleScale;
uniform float circleOpacity;
uniform float loadingAngle;
uniform float loadingOpacity;
uniform float progress;
uniform float progressOpacity;
uniform float expand0;
uniform float expand1;
uniform float expandOpacity;
uniform float opacity;
uniform float tapScale;
uniform float tapOpacity;
uniform float disable;
varying vec2 vUv;

#include <common>
#include <logdepthbuf_pars_fragment>
#define SMOOTH_DIST 0.017
#define CENTER vec2(0.5, 0.5)

float inside(float innerDist) {
  float dist = length(CENTER - vUv);
  return smoothstep(innerDist, innerDist + SMOOTH_DIST, dist);
}
float outside(float outerDist) {
  float dist = length(CENTER - vUv);
  return 1.0 - smoothstep(outerDist - SMOOTH_DIST, outerDist, dist);
}

vec4 create_circle() {
  float dist = length(CENTER - vUv);
  float radius = 0.3 * circleScale * tapScale;
  #if defined(USE_MAP)
    float delta = radius / 0.5;
    vec2 deltaUv = (vUv - CENTER) / delta + CENTER;
    vec4 image = texture2D(map, deltaUv);
    image.a = image.a * mapAlpha;
    #if defined(USE_COLOR)
    image = vec4(baseColor, 1.0) * image;
    #endif
  #endif
  #if defined(USE_REVERSE)
    image = vec4(baseColor, 1.0 - image.a);
  #else
    #if defined(USE_BORDER)
      float borderDist = clamp(borderWidth, 0.0, 1.0);
      float clipAlpha = inside(radius - borderDist * radius);
      float gradient = clamp(borderWidth * 2.0 + abs(dot(normalize(vec2(1.0, -1.0)), vUv - CENTER)), 0.0, 1.0);
      vec4 borderColor = vec4(borderColor, clipAlpha * gradient);
      image = mix(borderColor, image, image.a);
    #endif
  #endif
  return vec4(image.rgb, image.a * circleOpacity * tapOpacity * outside(radius));
}

vec4 create_disable() {
  float dist = length(CENTER - vUv);
  return vec4(baseColor, 0.5 * tapOpacity * outside(0.32 * circleScale * tapScale));
}

vec4 create_loading() {
  float angle = PI - atan(CENTER.x - vUv.x, CENTER.y - vUv.y);
  angle = mod(angle + loadingAngle, PI2);
  float gradient = (1.0 - smoothstep(0.0, PI2, angle)) * 0.9 + 0.1;
  float radius = 0.3 * circleScale * tapScale;
  float inner = inside(radius - 0.2 * radius);
  #if defined(USE_BORDER)
    float borderDist = clamp(borderWidth, 0.0, 1.0);
    inner = inside(radius - borderDist * radius);
  #endif
  return vec4(baseColor, gradient * tapOpacity * loadingOpacity * inner * outside(radius));
}

vec4 create_progress() {
  float angle = PI + atan(CENTER.x - vUv.x, CENTER.y - vUv.y);
  float bar = (1.0 - step(progress * PI2, angle)) * 0.7;
  float radius = 0.3 * circleScale * tapScale;
  float inner = inside(radius - 0.2 * radius);
  #if defined(USE_BORDER)
    float borderDist = clamp(borderWidth, 0.0, 1.0);
    inner = inside(radius - borderDist * radius);
  #endif
  return vec4(baseColor, bar * tapOpacity * progressOpacity * inner * outside(radius));
}

vec4 create_expand0() {
  float width = 0.2;
  float radius = 0.25 + (0.5 - 0.25) * expand0;
  float dist = length(CENTER - vUv);
  float gradient = (1.0 - clamp((radius - dist) / width, 0.0, 1.0)) * 0.8 * clamp((1.0 - abs(expand0 - 0.5) * 2.0) * 1.2, 0.0, 1.0);
  return vec4(baseColor, gradient * expandOpacity * outside(radius));
}

vec4 create_expand1() {
  float width = 0.2;
  float radius = 0.25 + (0.48 - 0.25) * expand1;
  float dist = length(CENTER - vUv);
  float gradient = (1.0 - clamp((radius - dist) / width, 0.0, 1.0)) * 0.8 * clamp((1.0 - abs(expand1 - 0.5) * 2.0) * 1.2, 0.0, 1.0);
  return vec4(baseColor, gradient * expandOpacity * outside(radius));
}

void main() {
  #include <logdepthbuf_fragment>
  gl_FragColor = vec4(baseColor, 0);

  vec4 expand1Color = create_expand1();
  gl_FragColor = mix(gl_FragColor, expand1Color, expand1Color.a);

  vec4 expand0Color = create_expand0();
  gl_FragColor = mix(gl_FragColor, expand0Color, expand0Color.a);

  vec4 circleColor = create_circle();
  gl_FragColor = mix(gl_FragColor, circleColor, circleColor.a);

  vec4 progressColor = create_progress();
  gl_FragColor = mix(gl_FragColor, progressColor, progressColor.a);

  vec4 loadingColor = create_loading();
  gl_FragColor = mix(gl_FragColor, loadingColor, loadingColor.a);

  gl_FragColor = mix(gl_FragColor, create_disable(), disable);

  gl_FragColor = vec4(gl_FragColor.rgb, gl_FragColor.a * opacity);
}
`;(function($e){__extends(Se,$e);function Se(Be){Be===void 0&&(Be={});var De,Ve,Fe,Je,Xe,Ke,Ye,or=$e.call(this)||this,sr=(De=Be.color)!==null&&De!==void 0?De:16777215,cr=(Ve=Be.scale)!==null&&Ve!==void 0?Ve:1,Br=Be.map,tn=(Fe=Be.mapAlpha)!==null&&Fe!==void 0?Fe:1,en=(Je=Be.mapUseColor)!==null&&Je!==void 0?Je:!1,an=(Xe=Be.mapUseReverse)!==null&&Xe!==void 0?Xe:!1,rn=(Ke=Be.borderWidth)!==null&&Ke!==void 0?Ke:.1,on=(Ye=Be.borderColor)!==null&&Ye!==void 0?Ye:16777215;return or.progress=0,or.opacity=0,or.loading=!1,or.current=!1,or.disabled=!1,or.currentMotion=new Motion({progress:0}),or.tapMotion=new Motion({scale:1,opacity:1}),or.loadingOpacityMotion=new Motion({opacity:0}),or.progressMotion=new Motion({progress:0}),or.progressOpacityMotion=new Motion({opacity:0}),or.opacityMotion=new Motion({opacity:0}),or.disableMotion=new Motion({progress:0}),or.panoMesh=new Mesh(sharedGeometry2,new ShaderMaterial({blending:CustomBlending,blendSrc:SrcAlphaFactor,blendDst:OneMinusSrcAlphaFactor,blendSrcAlpha:OneFactor,blendDstAlpha:OneMinusSrcAlphaFactor,depthWrite:!1,vertexShader:vertexShader$2,fragmentShader:fragmentShader$2,defines:{USE_COLOR:en,USE_MAP:Br!==void 0,USE_BORDER:rn>0,USE_REVERSE:an},uniforms:{baseColor:{value:new Color(sr)},circleScale:{value:1},circleOpacity:{value:1},loadingAngle:{value:0},loadingOpacity:{value:0},progress:{value:0},progressOpacity:{value:0},expand0:{value:0},expand1:{value:0},expandOpacity:{value:0},opacity:{value:0},tapScale:{value:1},tapOpacity:{value:1},disable:{value:0},map:{value:Br},mapAlpha:{value:tn},borderWidth:{value:rn},borderColor:{value:new Color(on)}}})),or.renderOrder=-2,or.panoMesh.renderOrder=-2,or.panoMesh.position.y=.004,or.panoMesh.scale.set(cr,1,cr),or.add(or.panoMesh),or.currentStartTime=now$2(),or.needsRender=!0,or}return Se.prototype.setProgress=function(Be){var De=this;this.setDisabled(!1),this.setLoading(!1),this.progress!==Be&&(Be=clamp$1(Be,0,1),this.tapMotion.ended&&(this.progress===0&&this.progressOpacityMotion.set({opacity:1},500).catch(noop$1),Be===0?this.progressOpacityMotion.set({opacity:0},500).catch(noop$1).then(function(){De.progressMotion.set({progress:0},0).catch(noop$1)}):this.progressMotion.set({progress:clamp$1(Be*1.2,0,1)},100).catch(noop$1)),this.progress=Be)},Se.prototype.setOpacity=function(Be){this.opacity!==Be&&(this.opacity=Be=clamp$1(Be,0,1),this.opacityMotion.set({opacity:Be},200).catch(noop$1))},Se.prototype.setCurrent=function(Be){this.current!==Be&&(this.currentMotion.set({progress:Be?1:0},2e3).catch(noop$1),this.current=Be,this.current===!0&&(this.currentStartTime=now$2()))},Se.prototype.setLoading=function(Be){this.loading!==Be&&(this.loading=Be,this.disabled===!0&&this.setDisabled(!1),this.loadingOpacityMotion.set({opacity:Be?1:0},500).catch(noop$1))},Se.prototype.setDisabled=function(Be){this.disabled!==Be&&(this.disabled=Be,this.loading===!0&&this.setLoading(!1),this.disableMotion.set({progress:Be?1:0},500).catch(noop$1))},Se.prototype.tap=function(){var Be=this;if(!this.tapMotion.ended)return Promise.resolve();var De=[{progress:0,value:{scale:1,opacity:1}},{progress:.3,value:{scale:.85,opacity:.5}},{progress:.8,value:{scale:1.05,opacity:.6}},{progress:1,value:{scale:1,opacity:1}}];return this.progressOpacityMotion.set({opacity:0},0).catch(noop$1),this.progressMotion.set({progress:0},0).catch(noop$1),this.tapMotion.setKeyframes(De,600).then(function(){Be.progressOpacityMotion.set({opacity:Be.progress>0?1:0},300).catch(noop$1),Be.progressMotion.set({progress:Be.progress},120).catch(noop$1)}).catch(noop$1)},Se.prototype.updateTime=function(Be,De){if(!this.progressMotion.ended){this.progressMotion.update(Be);var Ve=this.progressMotion.value.progress;this.panoMesh.material.uniforms.progress.value=Ve,this.needsRender=!0}if(!this.progressOpacityMotion.ended){this.progressOpacityMotion.update(Be);var Fe=this.progressOpacityMotion.value.opacity;this.panoMesh.material.uniforms.progressOpacity.value=Fe,this.needsRender=!0}if(!this.opacityMotion.ended){this.opacityMotion.update(Be);var Fe=this.opacityMotion.value.opacity;this.panoMesh.material.uniforms.opacity.value=Fe,this.needsRender=!0}if(this.visible=this.opacityMotion.value.opacity!==0,(!this.loadingOpacityMotion.ended||this.loadingOpacityMotion.value.opacity>0)&&(this.loadingOpacityMotion.update(Be),this.panoMesh.material.uniforms.loadingOpacity.value=this.loadingOpacityMotion.value.opacity,this.panoMesh.material.uniforms.loadingAngle.value=Be/120%(Math.PI*2),this.needsRender=!0),this.tapMotion.ended||(this.tapMotion.update(Be),this.panoMesh.material.uniforms.tapOpacity.value=this.tapMotion.value.opacity,this.panoMesh.material.uniforms.tapScale.value=this.tapMotion.value.scale,this.needsRender=!0),this.panoMesh.material.uniforms.circleOpacity.value=Math.max(.6,1-Math.max(this.loadingOpacityMotion.value.opacity,this.progressOpacityMotion.value.opacity)),this.current||!this.currentMotion.ended){this.currentMotion.update(Be),this.panoMesh.material.uniforms.expandOpacity.value=this.currentMotion.value.progress;{var Je=(Be-this.currentStartTime-1500)/2e3;if(Je%5<2){var Xe=Je%1;this.panoMesh.material.uniforms.expand0.value=easeOut(Xe)*this.currentMotion.value.progress,this.needsRender=!0}}{var Ke=(Be-this.currentStartTime-1e3)/2e3;if(Ke%5<2){var Xe=Ke%1;this.panoMesh.material.uniforms.expand1.value=easeOut(Xe)*this.currentMotion.value.progress,this.needsRender=!0}}}if(!this.disableMotion.ended){var Ve=this.disableMotion.value.progress;this.disableMotion.update(Be),this.panoMesh.material.uniforms.disable.value=Ve,this.needsRender=!0}},Se.prototype.dispose=function(){this.tapMotion.dispose(),this.progressMotion.dispose(),this.progressOpacityMotion.dispose(),this.opacityMotion.dispose(),this.currentMotion.dispose(),this.panoMesh.material.dispose()},Se})(Object3D);var sharedGeometry$2=new CircleBufferGeometry(.1,16),vertexShader$1=`
varying vec2 vUv;
#include <common>
#include <logdepthbuf_pars_vertex>
void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  #include <logdepthbuf_vertex>
}
`,fragmentShader$1=`
varying vec2 vUv;
#include <common>
#include <logdepthbuf_pars_fragment>

float smoothDist = 0.01;
void main() {
  #include <logdepthbuf_fragment>
  vec2 center = vec2(0.5, 0.5);
  float dist = length(center - vUv);
  float outerDist = 0.49;
  float innerDist = 0.29;

  float outside = 1.0 - smoothstep(outerDist - smoothDist, outerDist, dist);
  float inside = smoothstep(innerDist, innerDist + smoothDist, dist);

  vec4 bg = vec4(0.576, 0.635, 1.0, 0.3);
  float gradientAlpha = clamp(abs(dist - (outerDist + innerDist) / 2.0) / (outerDist - innerDist) * 1.5 + 0.1, 0.0, 1.0);
  vec4 gradient = vec4(1.0, 1.0, 1.0, gradientAlpha);

  gl_FragColor = mix(bg, gradient, gradient.a);

  gl_FragColor = vec4(gl_FragColor.rgb, gl_FragColor.a * outside * inside);
}
`,sharedMaterial=new ShaderMaterial({vertexShader:vertexShader$1,fragmentShader:fragmentShader$1,side:DoubleSide,blending:CustomBlending,blendSrc:SrcAlphaFactor,blendDst:OneMinusSrcAlphaFactor,blendSrcAlpha:OneFactor,blendDstAlpha:OneMinusSrcAlphaFactor,depthWrite:!1}),IntersectMesh=function($e){__extends(Se,$e);function Se(){var Be=$e.call(this)||this;return Be.ringMesh=new Mesh(sharedGeometry$2,sharedMaterial),Be.ringMesh.position.z=.01,Be.ringMesh.renderOrder=-2,Be.add(Be.ringMesh),Be}return Se.prototype.dispose=function(){this.remove(this.ringMesh)},Se}(Object3D);function isSimilarValue($e,Se,Be){var De=Math.abs($e-Se);return De<.001||typeof Be<"u"&&Math.abs(Be-De)<.001}function notSimilarValue($e,Se,Be){return!isSimilarValue($e,Se,Be)}function isSimilarVector3($e,Se){return $e.distanceTo(Se)<.001}function notSimilarVector3($e,Se){return!isSimilarVector3($e,Se)}var DEFAULT_OFFSET_VECTOR=new Vector3(0,0,0),BoundingMesh=function($e){__extends(Se,$e);function Se(Be,De){De===void 0&&(De=DEFAULT_OFFSET_VECTOR);var Ve=this,Fe=new BoxBufferGeometry(Be.max.x-Be.min.x+De.x*2,Be.max.y-Be.min.y+De.y*2,Be.max.z-Be.min.z+De.z*2,1,1);Fe.clearGroups(),Fe.addGroup(0,Fe.index?Fe.index.count:Fe.attributes.position.count,0),Fe.applyMatrix4(new Matrix4().makeScale(-1,1,1)),Fe.computeVertexNormals();var Je=new PBMMeshMaterial("none");return Je.refreshUniforms(),Ve=$e.call(this,Fe,[Je])||this,Ve.position.copy(Be.getCenter(new Vector3)),Ve.frustumCulled=!1,Ve.boundingBox=new Box3,Ve.boundingBox.setFromObject(Ve),Ve.renderOrder=-1001,Ve}return Se}(PBMMesh);function generateBoundingMesh($e,Se){return Se===void 0&&(Se=DEFAULT_OFFSET_VECTOR),new BoundingMesh($e,Se)}function cameraWorldToLocal($e,Se){var Be=new Vector3(0,0,-1);Be.applyQuaternion($e.quaternion);var De=Se.quaternion.clone().inverse();Be.applyQuaternion(De);var Ve=Math.atan2(Be.x,-Be.z),Fe=-Math.asin(Be.y);return{theta:Ve,phi:Fe,lookAtVector:Be}}var TAU$1=Math.PI*2;function formatRad($e){return $e>=0&&$e<TAU$1?$e:($e%TAU$1+TAU$1)%TAU$1}var PI$2=Math.PI,TAU=PI$2*2;function stepNumber($e,Se,Be){if($e===Se)return Se;var De=Se-$e,Ve=Math.abs(De);if(Ve<=Be)return Se;var Fe=De>0?1:-1;return $e+Fe*Be}function stepVector($e,Se,Be){if($e.equals(Se))return new Vector3().copy(Se);var De=new Vector3().subVectors(Se,$e);return De.lengthSq()<Be*Be?De.copy(Se):De.setLength(Be).add($e)}function stepCoordinates($e,Se,Be){if($e.longitude===Se.longitude&&$e.latitude===Se.latitude)return{longitude:Se.longitude,latitude:Se.latitude};var De=formatRad($e.longitude),Ve=$e.latitude,Fe=formatRad(Se.longitude),Je=Se.latitude;Fe-De>PI$2?De+=TAU:De-Fe>PI$2&&(De-=TAU);var Xe=Math.sqrt(Math.pow(Fe-De,2)+Math.pow(Je-Ve,2)),Ke=Be/Xe;return Ke>=1?{longitude:Se.longitude,latitude:Se.latitude}:{longitude:De+(Fe-De)*Ke,latitude:Ve+(Je-Ve)*Ke}}function isPromise($e){return!!$e&&(typeof $e=="object"||typeof $e=="function")&&typeof $e.then=="function"}var _a$2,userAgent$1=typeof navigator<"u"?((_a$2=navigator?.userAgent)!==null&&_a$2!==void 0?_a$2:"").toLowerCase():"node";(function(){try{var $e=document.createElement("canvas");return!!(window.WebGLRenderingContext&&($e.getContext("webgl")||$e.getContext("experimental-webgl")))}catch{return!1}})();var isMobile=/android/i.test(userAgent$1)||/webos/i.test(userAgent$1)||/ipad|iphone|ipod/i.test(userAgent$1)||/iemobile/i.test(userAgent$1)||/opera mini/i.test(userAgent$1)||/blackberry/i.test(userAgent$1)||/windows phone/i.test(userAgent$1);function createEvent($e,Se){for(var Be=!1,De={type:$e,timeStamp:now$2(),get defaultPrevented(){return Be},preventDefault:function(){Be=!0}},Ve=0,Fe=Object.keys(Se);Ve<Fe.length;Ve++){var Je=Fe[Ve];Je in De||(De[Je]=Se[Je])}return De}function requestDeviceOrientationPermission(){return typeof location>"u"||location.protocol!=="https:"?Promise.reject(new Error("Request DeviceOrientation Permission denied.")):typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(function($e){if($e=="granted")return Promise.resolve();var Se=new Error("Request DeviceOrientation Permission denied.");return Promise.reject(Se)}):Promise.resolve()}function requestXRSessionPermission(){if("xr"in navigator)return navigator.xr.isSessionSupported("immersive-vr").then(function(Se){return Se?Promise.resolve():Promise.reject()}).then(function(){var Se={optionalFeatures:["local-floor"]};return navigator.xr.requestSession("immersive-vr",Se).then(function(Be){return Promise.resolve(Be)})});var $e=new Error("Request XR Permission denied.");return Promise.reject($e)}function assignState($e,Se){$e.mode=Se.mode,$e.workCode=Se.workCode,$e.panoIndex=Se.panoIndex,$e.longitude=Se.longitude,$e.latitude=Se.latitude,$e.fov=Se.fov,$e.offset.copy(Se.offset),$e.distance=Se.distance}function stateEqual($e,Se){return $e.workCode===Se.workCode&&$e.mode===Se.mode&&$e.panoIndex===Se.panoIndex&&isSimilarValue($e.longitude,Se.longitude,Math.PI*2)&&isSimilarValue($e.latitude,Se.latitude)&&isSimilarValue($e.fov,Se.fov)&&isSimilarVector3($e.offset,Se.offset)&&isSimilarValue($e.distance,Se.distance)}function assignPose($e,Se){$e.longitude=Se.longitude,$e.latitude=Se.latitude,$e.fov=Se.fov,$e.distance=Se.distance,$e.offset.copy(Se.offset)}function clonePose($e){return{longitude:$e.longitude,latitude:$e.latitude,fov:$e.fov,offset:$e.offset.clone(),distance:$e.distance}}function omitUndefinedFields($e){var Se={};for(var Be in $e){var De=$e[Be];De!==void 0&&(Se[Be]=De)}return Se}var defaultIterator=function($e){return Number($e)};function arrayMin($e,Se,Be){var De;Se===void 0&&(Se=defaultIterator),Be===void 0&&(Be=!1);for(var Ve,Fe=1/0,Je=0,Xe=$e;Je<Xe.length;Je++){var Ke=Xe[Je],Ye=Se(Ke);Ye<=Fe&&(De=[Ke,Ye],Ve=De[0],Fe=De[1])}return isFinite(Fe)||(Fe=0),Be?[Ve,Fe]:Ve}function isEmptyObject($e){for(var Se in $e)return!1;return!0}/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var Hammer=function($e,Se,Be,De){var Ve=["","webkit","Moz","MS","ms","o"],Fe=Se.createElement?Se.createElement("div"):De,Je="function",Xe=Math.round,Ke=Math.abs,Ye=Date.now;function or(Nn,Xn,_n){return setTimeout(on(Nn,_n),Xn)}function sr(Nn,Xn,_n){return Array.isArray(Nn)?(cr(Nn,_n[Xn],_n),!0):!1}function cr(Nn,Xn,_n){var On;if(Nn)if(Nn.forEach)Nn.forEach(Xn,_n);else if(Nn.length!==De)for(On=0;On<Nn.length;)Xn.call(_n,Nn[On],On,Nn),On++;else for(On in Nn)Nn.hasOwnProperty(On)&&Xn.call(_n,Nn[On],On,Nn)}function Br(Nn,Xn,_n){var On="DEPRECATED METHOD: "+Xn+`
`+_n+` AT 
`;return function(){var Jn=new Error("get-stack-trace"),pi=Jn&&Jn.stack?Jn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Si=$e.console&&($e.console.warn||$e.console.log);return Si&&Si.call($e.console,On,pi),Nn.apply(this,arguments)}}var tn;typeof Object.assign!="function"?tn=function(Nn){if(Nn===De||Nn===null)throw new TypeError("Cannot convert undefined or null to object");for(var Xn=Object(Nn),_n=1;_n<arguments.length;_n++){var On=arguments[_n];if(On!==De&&On!==null)for(var Jn in On)On.hasOwnProperty(Jn)&&(Xn[Jn]=On[Jn])}return Xn}:tn=Object.assign;var en=Br(function(Nn,Xn,_n){for(var On=Object.keys(Xn),Jn=0;Jn<On.length;)(!_n||_n&&Nn[On[Jn]]===De)&&(Nn[On[Jn]]=Xn[On[Jn]]),Jn++;return Nn},"extend","Use `assign`."),an=Br(function(Nn,Xn){return en(Nn,Xn,!0)},"merge","Use `assign`.");function rn(Nn,Xn,_n){var On=Xn.prototype,Jn;Jn=Nn.prototype=Object.create(On),Jn.constructor=Nn,Jn._super=On,_n&&tn(Jn,_n)}function on(Nn,Xn){return function(){return Nn.apply(Xn,arguments)}}function sn(Nn,Xn){return typeof Nn==Je?Nn.apply(Xn&&Xn[0]||De,Xn):Nn}function ln(Nn,Xn){return Nn===De?Xn:Nn}function cn(Nn,Xn,_n){cr(xn(Xn),function(On){Nn.addEventListener(On,_n,!1)})}function hn(Nn,Xn,_n){cr(xn(Xn),function(On){Nn.removeEventListener(On,_n,!1)})}function mn(Nn,Xn){for(;Nn;){if(Nn==Xn)return!0;Nn=Nn.parentNode}return!1}function An(Nn,Xn){return Nn.indexOf(Xn)>-1}function xn(Nn){return Nn.trim().split(/\s+/g)}function pn(Nn,Xn,_n){if(Nn.indexOf&&!_n)return Nn.indexOf(Xn);for(var On=0;On<Nn.length;){if(_n&&Nn[On][_n]==Xn||!_n&&Nn[On]===Xn)return On;On++}return-1}function dn(Nn){return Array.prototype.slice.call(Nn,0)}function fn(Nn,Xn,_n){for(var On=[],Jn=[],pi=0;pi<Nn.length;){var Si=Nn[pi][Xn];pn(Jn,Si)<0&&On.push(Nn[pi]),Jn[pi]=Si,pi++}return On=On.sort(function(zi,no){return zi[Xn]>no[Xn]}),On}function yn(Nn,Xn){for(var _n,On,Jn=Xn[0].toUpperCase()+Xn.slice(1),pi=0;pi<Ve.length;){if(_n=Ve[pi],On=_n?_n+Jn:Xn,On in Nn)return On;pi++}return De}var Sn=1;function gn(){return Sn++}function Cn(Nn){var Xn=Nn.ownerDocument||Nn;return Xn.defaultView||Xn.parentWindow||$e}var Mn=/mobile|tablet|ip(ad|hone|od)|android/i,Bn="ontouchstart"in $e,kn=yn($e,"PointerEvent")!==De,Ln=Bn&&Mn.test(navigator.userAgent),Pn="touch",Vn="pen",Yn="mouse",ni="kinect",Rn=25,In=1,Gn=2,Fn=4,Hn=8,Dn=1,zn=2,Qn=4,Zn=8,si=16,ei=zn|Qn,hi=Zn|si,Un=ei|hi,Wn=["x","y"],Ai=["clientX","clientY"];function oi(Nn,Xn){var _n=this;this.manager=Nn,this.callback=Xn,this.element=Nn.element,this.target=Nn.options.inputTarget,this.domHandler=function(On){sn(Nn.options.enable,[Nn])&&_n.handler(On)},this.init()}oi.prototype={handler:function(){},init:function(){this.evEl&&cn(this.element,this.evEl,this.domHandler),this.evTarget&&cn(this.target,this.evTarget,this.domHandler),this.evWin&&cn(Cn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&hn(this.element,this.evEl,this.domHandler),this.evTarget&&hn(this.target,this.evTarget,this.domHandler),this.evWin&&hn(Cn(this.element),this.evWin,this.domHandler)}};function ci(Nn){var Xn,_n=Nn.options.inputClass;return _n?Xn=_n:kn?Xn=vo:Ln?Xn=xi:Bn?Xn=ji:Xn=ho,new Xn(Nn,ai)}function ai(Nn,Xn,_n){var On=_n.pointers.length,Jn=_n.changedPointers.length,pi=Xn&In&&On-Jn===0,Si=Xn&(Fn|Hn)&&On-Jn===0;_n.isFirst=!!pi,_n.isFinal=!!Si,pi&&(Nn.session={}),_n.eventType=Xn,wi(Nn,_n),Nn.emit("hammer.input",_n),Nn.recognize(_n),Nn.session.prevInput=_n}function wi(Nn,Xn){var _n=Nn.session,On=Xn.pointers,Jn=On.length;_n.firstInput||(_n.firstInput=Ri(Xn)),Jn>1&&!_n.firstMultiple?_n.firstMultiple=Ri(Xn):Jn===1&&(_n.firstMultiple=!1);var pi=_n.firstInput,Si=_n.firstMultiple,zi=Si?Si.center:pi.center,no=Xn.center=_i(On);Xn.timeStamp=Ye(),Xn.deltaTime=Xn.timeStamp-pi.timeStamp,Xn.angle=ri(zi,no),Xn.distance=vi(zi,no),Pi(_n,Xn),Xn.offsetDirection=$i(Xn.deltaX,Xn.deltaY);var Co=Mi(Xn.deltaTime,Xn.deltaX,Xn.deltaY);Xn.overallVelocityX=Co.x,Xn.overallVelocityY=Co.y,Xn.overallVelocity=Ke(Co.x)>Ke(Co.y)?Co.x:Co.y,Xn.scale=Si?Bi(Si.pointers,On):1,Xn.rotation=Si?Ti(Si.pointers,On):0,Xn.maxPointers=_n.prevInput?Xn.pointers.length>_n.prevInput.maxPointers?Xn.pointers.length:_n.prevInput.maxPointers:Xn.pointers.length,Oi(_n,Xn);var Uo=Nn.element;mn(Xn.srcEvent.target,Uo)&&(Uo=Xn.srcEvent.target),Xn.target=Uo}function Pi(Nn,Xn){var _n=Xn.center,On=Nn.offsetDelta||{},Jn=Nn.prevDelta||{},pi=Nn.prevInput||{};(Xn.eventType===In||pi.eventType===Fn)&&(Jn=Nn.prevDelta={x:pi.deltaX||0,y:pi.deltaY||0},On=Nn.offsetDelta={x:_n.x,y:_n.y}),Xn.deltaX=Jn.x+(_n.x-On.x),Xn.deltaY=Jn.y+(_n.y-On.y)}function Oi(Nn,Xn){var _n=Nn.lastInterval||Xn,On=Xn.timeStamp-_n.timeStamp,Jn,pi,Si,zi;if(Xn.eventType!=Hn&&(On>Rn||_n.velocity===De)){var no=Xn.deltaX-_n.deltaX,Co=Xn.deltaY-_n.deltaY,Uo=Mi(On,no,Co);pi=Uo.x,Si=Uo.y,Jn=Ke(Uo.x)>Ke(Uo.y)?Uo.x:Uo.y,zi=$i(no,Co),Nn.lastInterval=Xn}else Jn=_n.velocity,pi=_n.velocityX,Si=_n.velocityY,zi=_n.direction;Xn.velocity=Jn,Xn.velocityX=pi,Xn.velocityY=Si,Xn.direction=zi}function Ri(Nn){for(var Xn=[],_n=0;_n<Nn.pointers.length;)Xn[_n]={clientX:Xe(Nn.pointers[_n].clientX),clientY:Xe(Nn.pointers[_n].clientY)},_n++;return{timeStamp:Ye(),pointers:Xn,center:_i(Xn),deltaX:Nn.deltaX,deltaY:Nn.deltaY}}function _i(Nn){var Xn=Nn.length;if(Xn===1)return{x:Xe(Nn[0].clientX),y:Xe(Nn[0].clientY)};for(var _n=0,On=0,Jn=0;Jn<Xn;)_n+=Nn[Jn].clientX,On+=Nn[Jn].clientY,Jn++;return{x:Xe(_n/Xn),y:Xe(On/Xn)}}function Mi(Nn,Xn,_n){return{x:Xn/Nn||0,y:_n/Nn||0}}function $i(Nn,Xn){return Nn===Xn?Dn:Ke(Nn)>=Ke(Xn)?Nn<0?zn:Qn:Xn<0?Zn:si}function vi(Nn,Xn,_n){_n||(_n=Wn);var On=Xn[_n[0]]-Nn[_n[0]],Jn=Xn[_n[1]]-Nn[_n[1]];return Math.sqrt(On*On+Jn*Jn)}function ri(Nn,Xn,_n){_n||(_n=Wn);var On=Xn[_n[0]]-Nn[_n[0]],Jn=Xn[_n[1]]-Nn[_n[1]];return Math.atan2(Jn,On)*180/Math.PI}function Ti(Nn,Xn){return ri(Xn[1],Xn[0],Ai)+ri(Nn[1],Nn[0],Ai)}function Bi(Nn,Xn){return vi(Xn[0],Xn[1],Ai)/vi(Nn[0],Nn[1],Ai)}var qi={mousedown:In,mousemove:Gn,mouseup:Fn},Ii="mousedown",Ui="mousemove mouseup";function ho(){this.evEl=Ii,this.evWin=Ui,this.pressed=!1,oi.apply(this,arguments)}rn(ho,oi,{handler:function(Nn){var Xn=qi[Nn.type];Xn&In&&(Nn.button===0||Nn.button===2)&&(this.pressed=!0),Xn&Gn&&Nn.which!==1&&(Xn=Fn),this.pressed&&(Xn&Fn&&(this.pressed=!1),this.callback(this.manager,Xn,{pointers:[Nn],changedPointers:[Nn],pointerType:Yn,srcEvent:Nn}))}});var lo={pointerdown:In,pointermove:Gn,pointerup:Fn,pointercancel:Hn,pointerout:Hn},po={2:Pn,3:Vn,4:Yn,5:ni},co="pointerdown",go="pointermove pointerup pointercancel";$e.MSPointerEvent&&!$e.PointerEvent&&(co="MSPointerDown",go="MSPointerMove MSPointerUp MSPointerCancel");function vo(){this.evEl=co,this.evWin=go,oi.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}rn(vo,oi,{handler:function(Nn){var Xn=this.store,_n=!1,On=!1,Jn=Nn.type.toLowerCase().replace("ms",""),pi=lo[Jn],Si=po[Nn.pointerType]||Nn.pointerType,zi=Si==Pn,no=pn(Xn,Nn.pointerId,"pointerId");pi&In&&(Nn.button===0||Nn.button===2||zi)?no<0&&(Xn.push(Nn),no=Xn.length-1):pi&(Fn|Hn)?_n=!0:!zi&&Nn.buttons===0&&(_n=!0,On=!0,pi=lo.pointerup),!(no<0)&&(On||(Xn[no]=Nn),this.callback(this.manager,pi,{pointers:Xn,changedPointers:[Nn],pointerType:Si,srcEvent:Xn[no]}),_n&&Xn.splice(no,1))}});var Eo={touchstart:In,touchmove:Gn,touchend:Fn,touchcancel:Hn},Oo="touchstart",Bo="touchstart touchmove touchend touchcancel";function Po(){this.evTarget=Oo,this.evWin=Bo,this.started=!1,oi.apply(this,arguments)}rn(Po,oi,{handler:function(Nn){var Xn=Eo[Nn.type];if(Xn===In&&(this.started=!0),!!this.started){var _n=Kn.call(this,Nn,Xn);Xn&(Fn|Hn)&&_n[0].length-_n[1].length===0&&(this.started=!1),this.callback(this.manager,Xn,{pointers:_n[0],changedPointers:_n[1],pointerType:Pn,srcEvent:Nn})}}});function Kn(Nn,Xn){var _n=dn(Nn.touches),On=dn(Nn.changedTouches);return Xn&(Fn|Hn)&&(_n=fn(_n.concat(On),"identifier")),[_n,On]}var mi={touchstart:In,touchmove:Gn,touchend:Fn,touchcancel:Hn},gi="touchstart touchmove touchend touchcancel";function xi(){this.evTarget=gi,this.targetIds={},oi.apply(this,arguments)}rn(xi,oi,{handler:function(Nn){var Xn=mi[Nn.type],_n=ki.call(this,Nn,Xn);_n&&this.callback(this.manager,Xn,{pointers:_n[0],changedPointers:_n[1],pointerType:Pn,srcEvent:Nn})}});function ki(Nn,Xn){var _n=dn(Nn.touches),On=this.targetIds;if(Xn&(In|Gn)&&_n.length===1)return On[_n[0].identifier]=!0,[_n,_n];var Jn,pi,Si=dn(Nn.changedTouches),zi=[],no=this.target;if(pi=_n.filter(function(Co){return mn(Co.target,no)}),Xn===In)for(Jn=0;Jn<pi.length;)On[pi[Jn].identifier]=!0,Jn++;for(Jn=0;Jn<Si.length;)On[Si[Jn].identifier]&&zi.push(Si[Jn]),Xn&(Fn|Hn)&&delete On[Si[Jn].identifier],Jn++;if(zi.length)return[fn(pi.concat(zi),"identifier"),zi]}var Ki=2500,Yi=25;function ji(){oi.apply(this,arguments);var Nn=on(this.handler,this);this.touch=new xi(this.manager,Nn),this.mouse=new ho(this.manager,Nn),this.primaryTouch=null,this.lastTouches=[]}rn(ji,oi,{handler:function(Nn,Xn,_n){var On=_n.pointerType==Pn,Jn=_n.pointerType==Yn;if(!(Jn&&_n.sourceCapabilities&&_n.sourceCapabilities.firesTouchEvents)){if(On)Wi.call(this,Xn,_n);else if(Jn&&Mo.call(this,_n))return;this.callback(Nn,Xn,_n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Wi(Nn,Xn){Nn&In?(this.primaryTouch=Xn.changedPointers[0].identifier,Gi.call(this,Xn)):Nn&(Fn|Hn)&&Gi.call(this,Xn)}function Gi(Nn){var Xn=Nn.changedPointers[0];if(Xn.identifier===this.primaryTouch){var _n={x:Xn.clientX,y:Xn.clientY};this.lastTouches.push(_n);var On=this.lastTouches,Jn=function(){var pi=On.indexOf(_n);pi>-1&&On.splice(pi,1)};setTimeout(Jn,Ki)}}function Mo(Nn){for(var Xn=Nn.srcEvent.clientX,_n=Nn.srcEvent.clientY,On=0;On<this.lastTouches.length;On++){var Jn=this.lastTouches[On],pi=Math.abs(Xn-Jn.x),Si=Math.abs(_n-Jn.y);if(pi<=Yi&&Si<=Yi)return!0}return!1}var bo=Fe?yn(Fe.style,"touchAction"):De,fo=bo!==De,Hi="compute",eo="auto",mo="manipulation",xo="none",ro="pan-x",To="pan-y",_o=Xa();function Ho(Nn,Xn){this.manager=Nn,this.set(Xn)}Ho.prototype={set:function(Nn){Nn==Hi&&(Nn=this.compute()),fo&&this.manager.element.style&&_o[Nn]&&(this.manager.element.style[bo]=Nn),this.actions=Nn.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Nn=[];return cr(this.manager.recognizers,function(Xn){sn(Xn.options.enable,[Xn])&&(Nn=Nn.concat(Xn.getTouchAction()))}),Io(Nn.join(" "))},preventDefaults:function(Nn){var Xn=Nn.srcEvent,_n=Nn.offsetDirection;if(this.manager.session.prevented){Xn.preventDefault();return}var On=this.actions,Jn=An(On,xo)&&!_o[xo],pi=An(On,To)&&!_o[To],Si=An(On,ro)&&!_o[ro];if(Jn){var zi=Nn.pointers.length===1,no=Nn.distance<2,Co=Nn.deltaTime<250;if(zi&&no&&Co)return}if(!(Si&&pi)&&(Jn||pi&&_n&ei||Si&&_n&hi))return this.preventSrc(Xn)},preventSrc:function(Nn){this.manager.session.prevented=!0,Nn.preventDefault()}};function Io(Nn){if(An(Nn,xo))return xo;var Xn=An(Nn,ro),_n=An(Nn,To);return Xn&&_n?xo:Xn||_n?Xn?ro:To:An(Nn,mo)?mo:eo}function Xa(){if(!fo)return!1;var Nn={},Xn=$e.CSS&&$e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(_n){Nn[_n]=Xn?$e.CSS.supports("touch-action",_n):!0}),Nn}var Na=1,$o=2,qo=4,na=8,Go=na,Jo=16,Xo=32;function Do(Nn){this.options=tn({},this.defaults,Nn||{}),this.id=gn(),this.manager=null,this.options.enable=ln(this.options.enable,!0),this.state=Na,this.simultaneous={},this.requireFail=[]}Do.prototype={defaults:{},set:function(Nn){return tn(this.options,Nn),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Nn){if(sr(Nn,"recognizeWith",this))return this;var Xn=this.simultaneous;return Nn=Ka(Nn,this),Xn[Nn.id]||(Xn[Nn.id]=Nn,Nn.recognizeWith(this)),this},dropRecognizeWith:function(Nn){return sr(Nn,"dropRecognizeWith",this)?this:(Nn=Ka(Nn,this),delete this.simultaneous[Nn.id],this)},requireFailure:function(Nn){if(sr(Nn,"requireFailure",this))return this;var Xn=this.requireFail;return Nn=Ka(Nn,this),pn(Xn,Nn)===-1&&(Xn.push(Nn),Nn.requireFailure(this)),this},dropRequireFailure:function(Nn){if(sr(Nn,"dropRequireFailure",this))return this;Nn=Ka(Nn,this);var Xn=pn(this.requireFail,Nn);return Xn>-1&&this.requireFail.splice(Xn,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Nn){return!!this.simultaneous[Nn.id]},emit:function(Nn){var Xn=this,_n=this.state;function On(Jn){Xn.manager.emit(Jn,Nn)}_n<na&&On(Xn.options.event+ia(_n)),On(Xn.options.event),Nn.additionalEvent&&On(Nn.additionalEvent),_n>=na&&On(Xn.options.event+ia(_n))},tryEmit:function(Nn){if(this.canEmit())return this.emit(Nn);this.state=Xo},canEmit:function(){for(var Nn=0;Nn<this.requireFail.length;){if(!(this.requireFail[Nn].state&(Xo|Na)))return!1;Nn++}return!0},recognize:function(Nn){var Xn=tn({},Nn);if(!sn(this.options.enable,[this,Xn])){this.reset(),this.state=Xo;return}this.state&(Go|Jo|Xo)&&(this.state=Na),this.state=this.process(Xn),this.state&($o|qo|na|Jo)&&this.tryEmit(Xn)},process:function(Nn){},getTouchAction:function(){},reset:function(){}};function ia(Nn){return Nn&Jo?"cancel":Nn&na?"end":Nn&qo?"move":Nn&$o?"start":""}function va(Nn){return Nn==si?"down":Nn==Zn?"up":Nn==zn?"left":Nn==Qn?"right":""}function Ka(Nn,Xn){var _n=Xn.manager;return _n?_n.get(Nn):Nn}function Fo(){Do.apply(this,arguments)}rn(Fo,Do,{defaults:{pointers:1},attrTest:function(Nn){var Xn=this.options.pointers;return Xn===0||Nn.pointers.length===Xn},process:function(Nn){var Xn=this.state,_n=Nn.eventType,On=Xn&($o|qo),Jn=this.attrTest(Nn);return On&&(_n&Hn||!Jn)?Xn|Jo:On||Jn?_n&Fn?Xn|na:Xn&$o?Xn|qo:$o:Xo}});function sa(){Fo.apply(this,arguments),this.pX=null,this.pY=null}rn(sa,Fo,{defaults:{event:"pan",threshold:10,pointers:1,direction:Un},getTouchAction:function(){var Nn=this.options.direction,Xn=[];return Nn&ei&&Xn.push(To),Nn&hi&&Xn.push(ro),Xn},directionTest:function(Nn){var Xn=this.options,_n=!0,On=Nn.distance,Jn=Nn.direction,pi=Nn.deltaX,Si=Nn.deltaY;return Jn&Xn.direction||(Xn.direction&ei?(Jn=pi===0?Dn:pi<0?zn:Qn,_n=pi!=this.pX,On=Math.abs(Nn.deltaX)):(Jn=Si===0?Dn:Si<0?Zn:si,_n=Si!=this.pY,On=Math.abs(Nn.deltaY))),Nn.direction=Jn,_n&&On>Xn.threshold&&Jn&Xn.direction},attrTest:function(Nn){return Fo.prototype.attrTest.call(this,Nn)&&(this.state&$o||!(this.state&$o)&&this.directionTest(Nn))},emit:function(Nn){this.pX=Nn.deltaX,this.pY=Nn.deltaY;var Xn=va(Nn.direction);Xn&&(Nn.additionalEvent=this.options.event+Xn),this._super.emit.call(this,Nn)}});function za(){Fo.apply(this,arguments)}rn(za,Fo,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[xo]},attrTest:function(Nn){return this._super.attrTest.call(this,Nn)&&(Math.abs(Nn.scale-1)>this.options.threshold||this.state&$o)},emit:function(Nn){if(Nn.scale!==1){var Xn=Nn.scale<1?"in":"out";Nn.additionalEvent=this.options.event+Xn}this._super.emit.call(this,Nn)}});function Pa(){Do.apply(this,arguments),this._timer=null,this._input=null}rn(Pa,Do,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[eo]},process:function(Nn){var Xn=this.options,_n=Nn.pointers.length===Xn.pointers,On=Nn.distance<Xn.threshold,Jn=Nn.deltaTime>Xn.time;if(this._input=Nn,!On||!_n||Nn.eventType&(Fn|Hn)&&!Jn)this.reset();else if(Nn.eventType&In)this.reset(),this._timer=or(function(){this.state=Go,this.tryEmit()},Xn.time,this);else if(Nn.eventType&Fn)return Go;return Xo},reset:function(){clearTimeout(this._timer)},emit:function(Nn){this.state===Go&&(Nn&&Nn.eventType&Fn?this.manager.emit(this.options.event+"up",Nn):(this._input.timeStamp=Ye(),this.manager.emit(this.options.event,this._input)))}});function wa(){Fo.apply(this,arguments)}rn(wa,Fo,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[xo]},attrTest:function(Nn){return this._super.attrTest.call(this,Nn)&&(Math.abs(Nn.rotation)>this.options.threshold||this.state&$o)}});function ma(){Fo.apply(this,arguments)}rn(ma,Fo,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ei|hi,pointers:1},getTouchAction:function(){return sa.prototype.getTouchAction.call(this)},attrTest:function(Nn){var Xn=this.options.direction,_n;return Xn&(ei|hi)?_n=Nn.overallVelocity:Xn&ei?_n=Nn.overallVelocityX:Xn&hi&&(_n=Nn.overallVelocityY),this._super.attrTest.call(this,Nn)&&Xn&Nn.offsetDirection&&Nn.distance>this.options.threshold&&Nn.maxPointers==this.options.pointers&&Ke(_n)>this.options.velocity&&Nn.eventType&Fn},emit:function(Nn){var Xn=va(Nn.offsetDirection);Xn&&this.manager.emit(this.options.event+Xn,Nn),this.manager.emit(this.options.event,Nn)}});function Aa(){Do.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}rn(Aa,Do,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[mo]},process:function(Nn){var Xn=this.options,_n=Nn.pointers.length===Xn.pointers,On=Nn.distance<Xn.threshold,Jn=Nn.deltaTime<Xn.time;if(this.reset(),Nn.eventType&In&&this.count===0)return this.failTimeout();if(On&&Jn&&_n){if(Nn.eventType!=Fn)return this.failTimeout();var pi=this.pTime?Nn.timeStamp-this.pTime<Xn.interval:!0,Si=!this.pCenter||vi(this.pCenter,Nn.center)<Xn.posThreshold;this.pTime=Nn.timeStamp,this.pCenter=Nn.center,!Si||!pi?this.count=1:this.count+=1,this._input=Nn;var zi=this.count%Xn.taps;if(zi===0)return this.hasRequireFailures()?(this._timer=or(function(){this.state=Go,this.tryEmit()},Xn.interval,this),$o):Go}return Xo},failTimeout:function(){return this._timer=or(function(){this.state=Xo},this.options.interval,this),Xo},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Go&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function da(Nn,Xn){return Xn=Xn||{},Xn.recognizers=ln(Xn.recognizers,da.defaults.preset),new Ua(Nn,Xn)}da.VERSION="2.0.7",da.defaults={domEvents:!1,touchAction:Hi,enable:!0,inputTarget:null,inputClass:null,preset:[[wa,{enable:!1}],[za,{enable:!1},["rotate"]],[ma,{direction:ei}],[sa,{direction:ei},["swipe"]],[Aa],[Aa,{event:"doubletap",taps:2},["tap"]],[Pa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ia=1,ys=2;function Ua(Nn,Xn){this.options=tn({},da.defaults,Xn||{}),this.options.inputTarget=this.options.inputTarget||Nn,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Nn,this.input=ci(this),this.touchAction=new Ho(this,this.options.touchAction),Ya(this,!0),cr(this.options.recognizers,function(_n){var On=this.add(new _n[0](_n[1]));_n[2]&&On.recognizeWith(_n[2]),_n[3]&&On.requireFailure(_n[3])},this)}Ua.prototype={set:function(Nn){return tn(this.options,Nn),Nn.touchAction&&this.touchAction.update(),Nn.inputTarget&&(this.input.destroy(),this.input.target=Nn.inputTarget,this.input.init()),this},stop:function(Nn){this.session.stopped=Nn?ys:Ia},recognize:function(Nn){var Xn=this.session;if(!Xn.stopped){this.touchAction.preventDefaults(Nn);var _n,On=this.recognizers,Jn=Xn.curRecognizer;(!Jn||Jn&&Jn.state&Go)&&(Jn=Xn.curRecognizer=null);for(var pi=0;pi<On.length;)_n=On[pi],Xn.stopped!==ys&&(!Jn||_n==Jn||_n.canRecognizeWith(Jn))?_n.recognize(Nn):_n.reset(),!Jn&&_n.state&($o|qo|na)&&(Jn=Xn.curRecognizer=_n),pi++}},get:function(Nn){if(Nn instanceof Do)return Nn;for(var Xn=this.recognizers,_n=0;_n<Xn.length;_n++)if(Xn[_n].options.event==Nn)return Xn[_n];return null},add:function(Nn){if(sr(Nn,"add",this))return this;var Xn=this.get(Nn.options.event);return Xn&&this.remove(Xn),this.recognizers.push(Nn),Nn.manager=this,this.touchAction.update(),Nn},remove:function(Nn){if(sr(Nn,"remove",this))return this;if(Nn=this.get(Nn),Nn){var Xn=this.recognizers,_n=pn(Xn,Nn);_n!==-1&&(Xn.splice(_n,1),this.touchAction.update())}return this},on:function(Nn,Xn){if(Nn!==De&&Xn!==De){var _n=this.handlers;return cr(xn(Nn),function(On){_n[On]=_n[On]||[],_n[On].push(Xn)}),this}},off:function(Nn,Xn){if(Nn!==De){var _n=this.handlers;return cr(xn(Nn),function(On){Xn?_n[On]&&_n[On].splice(pn(_n[On],Xn),1):delete _n[On]}),this}},emit:function(Nn,Xn){this.options.domEvents&&ja(Nn,Xn);var _n=this.handlers[Nn]&&this.handlers[Nn].slice();if(!(!_n||!_n.length)){Xn.type=Nn,Xn.preventDefault=function(){Xn.srcEvent.preventDefault()};for(var On=0;On<_n.length;)_n[On](Xn),On++}},destroy:function(){this.element&&Ya(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ya(Nn,Xn){var _n=Nn.element;if(_n.style){var On;cr(Nn.options.cssProps,function(Jn,pi){On=yn(_n.style,pi),Xn?(Nn.oldCssProps[On]=_n.style[On],_n.style[On]=Jn):_n.style[On]=Nn.oldCssProps[On]||""}),Xn||(Nn.oldCssProps={})}}function ja(Nn,Xn){var _n=Se.createEvent("Event");_n.initEvent(Nn,!0,!0),_n.gesture=Xn,Xn.target.dispatchEvent(_n)}return tn(da,{INPUT_START:In,INPUT_MOVE:Gn,INPUT_END:Fn,INPUT_CANCEL:Hn,STATE_POSSIBLE:Na,STATE_BEGAN:$o,STATE_CHANGED:qo,STATE_ENDED:na,STATE_RECOGNIZED:Go,STATE_CANCELLED:Jo,STATE_FAILED:Xo,DIRECTION_NONE:Dn,DIRECTION_LEFT:zn,DIRECTION_RIGHT:Qn,DIRECTION_UP:Zn,DIRECTION_DOWN:si,DIRECTION_HORIZONTAL:ei,DIRECTION_VERTICAL:hi,DIRECTION_ALL:Un,Manager:Ua,Input:oi,TouchAction:Ho,TouchInput:xi,MouseInput:ho,PointerEventInput:vo,TouchMouseInput:ji,SingleTouchInput:Po,Recognizer:Do,AttrRecognizer:Fo,Tap:Aa,Pan:sa,Swipe:ma,Pinch:za,Rotate:wa,Press:Pa,on:cn,off:hn,each:cr,merge:an,extend:en,assign:tn,inherit:rn,bindFn:on,prefixed:yn}),da}(typeof window<"u"?window:{},typeof document<"u"?document:{});function calculateThreeMouse($e,Se,Be){var De=Se.getBoundingClientRect(),Ve=De.top,Fe=De.left,Je=De.width,Xe=De.height;return Be&&(Fe=Fe+Je*Be.left,Ve=Ve+Xe*(1-Be.bottom-Be.height),Je=Je*Be.width,Xe=Xe*Be.height),new Vector2(($e.x-Fe)/Je*2-1,-($e.y-Ve)/Xe*2+1)}var camera$2=new OrthographicCamera(-1,1,1,-1,0,1),geometry$5=new BufferGeometry;geometry$5.setAttribute("position",new Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3));geometry$5.setAttribute("uv",new Float32BufferAttribute([0,2,0,0,2,0],2));var mesh$4=new Mesh(geometry$5),scene$2=new Scene$1;scene$2.add(mesh$4);var DEFAULT_VERTEX_SHADER=`
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Pass=function(){function $e(Se,Be){var De;this.renderer=Se,this.material=new ShaderMaterial({vertexShader:(De=Be.vertex)!==null&&De!==void 0?De:DEFAULT_VERTEX_SHADER,fragmentShader:Be.fragment,uniforms:Object.assign({inputBuffer:new Uniform(null)},Be.uniforms),defines:Object.assign({},Be.defines),blending:NoBlending,depthWrite:!1,depthTest:!1})}return $e.prototype.render=function(Se,Be){var De=this.renderer.getRenderTarget(),Ve=mesh$4.material;this.material.uniforms.inputBuffer.value=Se.texture,mesh$4.material=this.material,this.renderer.setRenderTarget(Be||null),this.renderer.render(scene$2,camera$2),this.renderer.setRenderTarget(De),mesh$4.material=Ve},$e.prototype.dispose=function(){this.material.dispose()},$e}(),VALUE_VERTEX_SHADER=`
void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,VALUE_FRAGMENT_SHADER=`
uniform vec3 inputValue;
void main() {
  gl_FragColor = vec4(inputValue, 1.0);
}
`,ValuePass=function(){function $e(Se){this.renderer=Se,this.material=new ShaderMaterial({vertexShader:VALUE_VERTEX_SHADER,fragmentShader:VALUE_FRAGMENT_SHADER,uniforms:Object.assign({inputValue:new Uniform(new Vector3)}),blending:NoBlending,depthWrite:!1,depthTest:!1})}return $e.prototype.render=function(Se,Be){var De=this.renderer.getRenderTarget(),Ve=mesh$4.material;this.material.uniforms.inputValue.value.copy(Se),mesh$4.material=this.material,this.renderer.setRenderTarget(Be||null),this.renderer.render(scene$2,camera$2),this.renderer.setRenderTarget(De),mesh$4.material=Ve},$e.prototype.dispose=function(){this.material.dispose()},$e}(),FRAGMENT$2=`
uniform sampler2D inputBuffer;
varying vec2 vUv;
void main() {
  gl_FragColor = texture2D(inputBuffer, vUv);
}
`,CopyPass=function($e){__extends(Se,$e);function Se(Be){return $e.call(this,Be,{fragment:FRAGMENT$2})||this}return Se}(Pass),FRAGMENT$1=`
precision mediump float;
precision mediump int;
uniform sampler2D depthBuffer;
varying vec2 vUv;
void main() {
  gl_FragColor = vec4(0.0,0.0,0.0,1.0);
  gl_FragDepthEXT = texture2D(depthBuffer, vUv).r;
}
`,VERTEX=`

varying vec2 vUv;

void main() {
	vUv = uv;

	vec4 mvPosition = modelViewMatrix * vec4(position,1.0);

	gl_Position = projectionMatrix * mvPosition;
}
`,camera$1=new OrthographicCamera(-1,1,1,-1,0,1),geometry$4=new BufferGeometry;geometry$4.setAttribute("position",new Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3));geometry$4.setAttribute("uv",new Float32BufferAttribute([0,2,0,0,2,0],2));var noneMaterial=new MeshBasicMaterial,mesh$3=new Mesh(geometry$4,noneMaterial),scene$1=new Scene$1;scene$1.add(mesh$3);var DepthCopyPass=function(){function $e(Se){this.renderer=Se,this.material=new ShaderMaterial({vertexShader:VERTEX,fragmentShader:FRAGMENT$1,uniforms:Object.assign({depthBuffer:new Uniform(null)}),blending:NoBlending,depthWrite:!0,depthTest:!0}),this.renderer.getContext()&&this.renderer.getContext()instanceof WebGLRenderingContext&&(this.material.extensions.fragDepth=!0)}return $e.prototype.render=function(Se,Be){var De=this.renderer.getRenderTarget();this.material.uniforms.depthBuffer.value=Se,mesh$3.material=this.material,this.renderer.setRenderTarget(Be||null),this.renderer.render(scene$1,camera$1),this.renderer.setRenderTarget(De),mesh$3.material=noneMaterial},$e.prototype.dispose=function(){this.material.dispose()},$e}(),sharedVector2$1=new Vector2,BaseController=function($e){__extends(Se,$e);function Se(Be){var De,Ve,Fe,Je,Xe,Ke,Ye,or=$e.call(this)||this,sr=Se.parseArgs(Be);or.mode="",or.pending=new Set,or.userAction=sr.initial.userAction,or.destroyed=!1,or.ident=sr.ident,or.scene=sr.scene,or.xrCustomObjectsScene=sr.xrCustomObjectsScene,or.helper=sr.helper,or.boundingMesh=sr.boundingMesh,or.camera=sr.camera,or.renderer=sr.renderer,or.scissor=sr.scissor,or.element=sr.element,or.models=sr.models,or.enableWheel=sr.enableWheel,or.enableIOSEDR=(De=sr.enableIOSEDR)!==null&&De!==void 0?De:!1,or.enableEDL=(Ve=sr.enableEDL)!==null&&Ve!==void 0?Ve:!0,or.enableHQ=(Fe=sr.enableHQ)!==null&&Fe!==void 0?Fe:!0,or.works=sr.works,or.imageOptions=sr.imageOptions,or.videoTexture=sr.videoTexture,or.extraElements=sr.extraElements,or.initial=sr.initial,or.currentPano=typeof or.initial.state.panoIndex=="number"?{workCode:(Ke=(Je=or.initial.state.workCode)!==null&&Je!==void 0?Je:(Xe=sr.works[0])===null||Xe===void 0?void 0:Xe.workCode)!==null&&Ke!==void 0?Ke:"",panoIndex:or.initial.state.panoIndex}:{workCode:or.initial.currentState.workCode,panoIndex:or.initial.currentState.panoIndex},or.needsRender=!0,or.modelSceneNeedsRender=!0,or.cameraMotion=new Motion({longitude:{value:or.camera.pose.longitude,circle:[0,Math.PI*2]},latitude:or.camera.pose.latitude,fov:or.camera.pose.fov}),or.inMomentumMovement=null,or.eventUnbinds=[sr.element].concat(sr.extraElements||[]).map(function(tn){return or.bindEvents(tn)}),or.pending.add("init-animation"),or.initAnimationReady=new Promise(function(tn){AnimationFrameLoop.shared.add(function(){or.initAnimation().then(function(){or.pending.delete("init-animation"),tn()})},!0)}),or.initAnimationIsReady=!1,or.initAnimationReady.then(function(){return or.initAnimationIsReady=!0}),or.modelScene=sr.modelScene;var cr=new Vector2;or.renderer.getDrawingBufferSize(cr),or.modelRenderTarget=sr.modelRenderTarget,or.copyPass=new CopyPass(or.renderer),or.depthCopyPass=new DepthCopyPass(or.renderer),or.screenBuffers=[],or.lastPostProcessingType=null,or.enableLayeringRendering=sr.enableLayeringRendering;var Br=(Ye=or.renderer)===null||Ye===void 0?void 0:Ye.getContext();return or.enableFragDepth=or.enableLayeringRendering&&(typeof WebGL2RenderingContext<"u"&&Br instanceof WebGL2RenderingContext||Br.getExtension("EXT_frag_depth")!==null),or}return Se.parseArgs=function(Be){return Be instanceof Se?Be:__assign({},Be)},Se.initAnimationEndState=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye,or,sr=this.parseArgs(Be),cr=sr.initial,Br=cr.state,tn=cr.currentState,en=typeof Br.panoIndex=="number"?{workCode:(Fe=(De=Br.workCode)!==null&&De!==void 0?De:(Ve=sr.works[0])===null||Ve===void 0?void 0:Ve.workCode)!==null&&Fe!==void 0?Fe:"",panoIndex:Br.panoIndex}:{workCode:tn.workCode,panoIndex:tn.panoIndex};return __assign(__assign({},en),{mode:"",longitude:(Je=Br.longitude)!==null&&Je!==void 0?Je:tn.longitude,latitude:(Xe=Br.latitude)!==null&&Xe!==void 0?Xe:tn.latitude,fov:(Ke=Br.fov)!==null&&Ke!==void 0?Ke:tn.fov,offset:(Ye=Br.offset)!==null&&Ye!==void 0?Ye:tn.offset,distance:(or=Br.distance)!==null&&or!==void 0?or:tn.distance})},Se.prototype.updateConfiguration=function(Be){return!0},Se.prototype.destroy=function(){var Be;this.stopMomentumMovement(),this.destroyed=!0,this.off(),this.cameraMotion.dispose();for(var De=0,Ve=this.eventUnbinds;De<Ve.length;De++){var Fe=Ve[De];Fe()}this.copyEffect&&(this.copyEffect.dispose(),delete this.copyEffect),delete this.panState,(Be=this.pressState)===null||Be===void 0||Be.stop(),delete this.pressState},Se.prototype.isReady=function(){return this.inMomentumMovement===null&&this.pending.size===0&&this.cameraMotion.ended===!0},Se.prototype.bindExtraElement=function(Be){for(var De=0,Ve=this.eventUnbinds;De<Ve.length;De++){var Fe=Ve[De];if(Fe.element===Be)return}this.eventUnbinds.push(this.bindEvents(Be))},Se.prototype.unbindExtraElement=function(Be){for(var De=[],Ve=0,Fe=this.eventUnbinds;Ve<Fe.length;Ve++){var Je=Fe[Ve];Je.element===Be?Je():De.push(Je)}this.eventUnbinds=De},Se.prototype.updateRenderSize=function(Be){this.needsRender=!0,this.modelSceneNeedsRender=!0,this.modelRenderTarget.setSize(Be.x,Be.y),this.screenBuffers.forEach(function(De){De!==null&&De.setSize(Be.x,Be.y)})},Se.prototype.updateModel=function(Be){this.needsRender=!0,this.modelSceneNeedsRender=!0},Se.prototype.updateWork=function(Be,De,Ve,Fe){return this.works=Be,this.userAction=Fe,!1},Se.prototype.updateTime=function(Be,De){if(!this.destroyed){var Ve={};this.cameraMotion.ended&&(this.cameraMotion.update(Be),Ve.longitude=this.cameraMotion.value.longitude,Ve.latitude=this.cameraMotion.value.latitude,Ve.fov=this.cameraMotion.value.fov),isEmptyObject(Ve)&&this.setCamera(Ve)}},Se.prototype.render=function(Be,De){var Ve=this.renderer.getRenderTarget();this.updateScreenBuffer(De),this.enableFragDepth?(Be&&(this.renderer.setRenderTarget(this.modelRenderTarget),this.renderer.render(this.modelScene,this.camera)),this.depthCopyPass.render(this.modelRenderTarget.depthTexture,Ve),this.renderer.autoClearDepth=!1,this.renderer.autoClearColor=!0,this.copyPass.render(this.modelRenderTarget,Ve),this.renderer.setRenderTarget(Ve),this.renderer.autoClearColor=!1,this.renderer.autoClearDepth=!1,this.renderer.render(this.scene,this.camera),this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0):(this.renderer.render(this.modelScene,this.camera),this.renderer.autoClearColor=!1,this.renderer.autoClearDepth=!1,this.renderer.render(this.scene,this.camera),this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0)},Se.prototype.postProcessing=function(Be,De){this.destroyed},Se.prototype.updateCamera=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();var Je={};return Be.longitude!==void 0&&(Je.longitude=Be.longitude),Be.latitude!==void 0&&(Je.latitude=Be.latitude),Be.fov!==void 0&&(Je.fov=Be.fov),Fe.cameraMotion.set(Je,De).catch(noop$1)})},Se.prototype.updateCameraWithKeyframes=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();for(var Je=[],Xe=0,Ke=Be;Xe<Ke.length;Xe++){var Ye=Ke[Xe];Je.push({key:Ye.key,progress:Ye.progress,value:{longitude:Ye.value.longitude,latitude:Ye.value.latitude,fov:Ye.value.fov}})}return Fe.cameraMotion.setKeyframes(Je,De)})},Se.prototype.getTargetState=function(){var Be=this.cameraMotion.getKeyFrameSegment(now$2())[1];return __assign(__assign({},this.currentPano),{mode:this.mode,longitude:Be.value.longitude,latitude:Be.value.latitude,fov:Be.value.fov,offset:this.camera.pose.offset.clone(),distance:this.camera.pose.distance})},Se.prototype.initAnimation=function(){var Be=this.initial;Be.state,Be.currentState,Be.duration;var De=Be.userAction,Ve=Se.initAnimationEndState(this);return this.userAction=De,this.emit("initAnimation.start",createEvent("initAnimation.start",{state:Ve,userAction:this.userAction})),this.emit("initAnimation.end",createEvent("initAnimation.end",{state:Ve,userAction:this.userAction})),Promise.resolve()},Se.prototype.setCamera=function(Be){var De,Ve,Fe,Je,Xe;Be===void 0&&(Be={});var Ke=(De=Be.longitude)!==null&&De!==void 0?De:this.camera.pose.longitude,Ye=(Ve=Be.latitude)!==null&&Ve!==void 0?Ve:this.camera.pose.latitude,or=(Fe=Be.fov)!==null&&Fe!==void 0?Fe:this.camera.pose.fov,sr=(Je=Be.distance)!==null&&Je!==void 0?Je:this.camera.pose.distance,cr=(Xe=Be.offset)!==null&&Xe!==void 0?Xe:this.camera.pose.offset,Br=notSimilarValue(Ke,this.camera.pose.longitude,Math.PI*2)||notSimilarValue(Ye,this.camera.pose.latitude),tn=notSimilarValue(or,this.camera.pose.fov),en=notSimilarValue(sr,this.camera.pose.distance),an=notSimilarVector3(cr,this.camera.pose.offset);(tn||Br||an||en)&&(this.camera.setFromPose({longitude:Ke,latitude:Ye,fov:or,distance:sr,offset:cr}),this.emit("camera.update",createEvent("camera.update",{userAction:this.userAction,state:__assign(__assign({},this.currentPano),{mode:this.mode,longitude:Ke,latitude:Ye,fov:or,offset:cr,distance:sr})})),this.needsRender=!0,this.modelSceneNeedsRender=!0)},Se.prototype.stopMomentumMovement=function(){if(this.inMomentumMovement&&this.inMomentumMovement.event&&!this.inMomentumMovement.event.defaultPrevented&&!this.inMomentumMovement.event.isFinal){var Be=createEvent("gesture.momentum",__assign(__assign({},this.inMomentumMovement.event),{isFirst:!1,isFinal:!0}));this.emit("gesture.momentum",Be)}this.inMomentumMovement=null},Se.prototype.onPanGesture=function(Be){this.stopMomentumMovement(),this.emit("gesture.pan",Be)},Se.prototype.onTapGesture=function(Be){this.stopMomentumMovement(),this.emit("gesture.tap",Be)},Se.prototype.onDblTapGesture=function(Be){this.stopMomentumMovement(),this.emit("gesture.dbltap",Be),!Be.defaultPrevented&&(Be.type="gesture.tap",this.onTapGesture(Be))},Se.prototype.onPressGesture=function(Be){this.stopMomentumMovement(),this.emit("gesture.press",Be)},Se.prototype.onPinchGesture=function(Be){this.stopMomentumMovement(),this.emit("gesture.pinch",Be)},Se.prototype.onMouseWheel=function(Be){this.stopMomentumMovement(),this.emit("gesture.mousewheel",Be)},Se.prototype.onMouseMove=function(Be){this.stopMomentumMovement(),this.emit("gesture.mousemove",Be)},Se.prototype.relativeClientPosition=function(Be){return calculateThreeMouse(Be,this.element,this.scissor)},Se.prototype.bindEvents=function(Be){var De=this,Ve=function(dn){var fn=calculateThreeMouse(dn,De.element,De.scissor);return!(Math.abs(fn.x)>1||Math.abs(fn.y)>1)},Fe=new Hammer.Manager(Be),Je=function(dn){var fn=dn.session;return fn.firstInput||null},Xe=new Hammer.Pan({threshold:10,pointers:0}),Ke=new Hammer.Tap({interval:410}),Ye=new Hammer.Pinch({threshold:0,pointers:2});Fe.add([Xe,Ke,Ye]),Fe.on("panstart pan",function(dn){var fn=Je(Fe);if(!(fn&&!Ve(fn.center))){var yn=createEvent("gesture.pan",{target:dn.target,pointerType:dn.pointerType,srcEvent:dn.srcEvent,pointers:dn.pointers.map(function(Sn){var gn=De.relativeClientPosition(Sn),Cn=new Raycaster;return Cn.params.Points={threshold:.1},Cn.setFromCamera(gn,De.camera),{x:Sn.x,y:Sn.y,delta:0,buttons:0,coords:gn,raycaster:Cn}}),isFirst:dn.isFirst,isFinal:dn.isFinal,scale:dn.scale,center:function(Sn){var gn=De.relativeClientPosition(Sn),Cn=new Raycaster;return Cn.params.Points={threshold:.1},Cn.setFromCamera(gn,De.camera),{x:Sn.x,y:Sn.y,delta:0,buttons:0,coords:gn,raycaster:Cn}}(dn.center),velocityX:dn.velocityX,velocityY:dn.velocityY,overallVelocityX:dn.overallVelocityX,overallVelocityY:dn.overallVelocityY,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});De.onPanGesture(yn),sn()}}),Fe.on("tap",function(dn){if(!(dn.pointerType==="mouse"&&dn.srcEvent.button!==0)){var fn=Je(Fe);if(!(fn&&!Ve(fn.center))){var yn=createEvent("gesture.tap",{target:dn.target,pointerType:dn.pointerType,srcEvent:dn.srcEvent,pointers:dn.pointers.map(function(Sn){var gn=De.relativeClientPosition(Sn),Cn=new Raycaster;return Cn.params.Points={threshold:.1},Cn.setFromCamera(gn,De.camera),{x:Sn.x,y:Sn.y,delta:0,buttons:0,coords:gn,raycaster:Cn}}),isFirst:!0,isFinal:!0,scale:dn.scale,center:function(Sn){var gn=De.relativeClientPosition(Sn),Cn=new Raycaster;return Cn.params.Points={threshold:.1},Cn.setFromCamera(gn,De.camera),{x:Sn.x,y:Sn.y,delta:0,buttons:0,coords:gn,raycaster:Cn}}(dn.center),velocityX:dn.velocityX,velocityY:dn.velocityY,overallVelocityX:dn.overallVelocityX,overallVelocityY:dn.overallVelocityY,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});De.onTapGesture(yn),sn()}}}),Fe.on("pinchstart pinch pinchend",function(dn){var fn=Je(Fe);if(!(fn&&!Ve(fn.center))){var yn=createEvent("gesture.pinch",{target:dn.target,pointerType:dn.pointerType,srcEvent:dn.srcEvent,pointers:dn.pointers.map(function(Sn){var gn,Cn=De.relativeClientPosition(Sn),Mn=new Raycaster;return Mn.params.Points={threshold:.1},Mn.setFromCamera(Cn,De.camera),{x:Sn.x,y:Sn.y,delta:(gn=Sn.delta)!==null&&gn!==void 0?gn:0,buttons:0,coords:Cn,raycaster:Mn}}),isFirst:dn.type==="pinchstart",isFinal:dn.type==="pinchend",scale:dn.scale,center:function(Sn){var gn=De.relativeClientPosition(Sn),Cn=new Raycaster;return Cn.params.Points={threshold:.1},Cn.setFromCamera(gn,De.camera),{x:Sn.x,y:Sn.y,delta:0,buttons:0,coords:gn,raycaster:Cn}}(dn.center),velocityX:dn.velocityX,velocityY:dn.velocityY,overallVelocityX:dn.overallVelocityX,overallVelocityY:dn.overallVelocityY,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});De.onPinchGesture(yn),sn()}}),Fe.on("dbltap",function(dn){if(!(dn.pointerType==="mouse"&&dn.srcEvent.button!==0)){var fn=Je(Fe);if(!(fn&&!Ve(fn.center))){var yn=createEvent("gesture.dbltap",{target:dn.target,pointerType:dn.pointerType,srcEvent:dn.srcEvent,pointers:dn.pointers.map(function(Sn){var gn=De.relativeClientPosition(Sn),Cn=new Raycaster;return Cn.params.Points={threshold:.1},Cn.setFromCamera(gn,De.camera),{x:Sn.x,y:Sn.y,delta:0,buttons:0,coords:gn,raycaster:Cn}}),isFirst:!0,isFinal:!0,scale:dn.scale,center:function(Sn){var gn=De.relativeClientPosition(Sn),Cn=new Raycaster;return Cn.params.Points={threshold:.1},Cn.setFromCamera(gn,De.camera),{x:Sn.x,y:Sn.y,delta:0,buttons:0,coords:gn,raycaster:Cn}}(dn.center),velocityX:dn.velocityX,velocityY:dn.velocityY,overallVelocityX:dn.overallVelocityX,overallVelocityY:dn.overallVelocityY,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});De.onDblTapGesture(yn),sn()}}});var or=null,sr=null,cr=function(dn,fn,yn){var Sn={x:yn.clientX,y:yn.clientY},gn=De.relativeClientPosition(Sn),Cn=new Raycaster;Cn.params.Points={threshold:.1},Cn.setFromCamera(gn,De.camera);var Mn=__assign(__assign({},Sn),{coords:gn,raycaster:Cn,buttons:yn.buttons,delta:0}),Bn=dn==="pinchend"?fn:fn-yn.deltaY/280,kn=createEvent("gesture.pinch",{target:yn.target,pointerType:"mouse",srcEvent:yn,pointers:[__assign({},Mn)],isFirst:dn==="pinchstart",isFinal:dn==="pinchend",scale:clamp$1(Bn,.1,10),center:__assign({},Mn),velocityX:0,velocityY:0,overallVelocityX:0,overallVelocityY:0,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});return kn},Br=function(dn){var fn,yn={x:dn.clientX,y:dn.clientY};if(Ve(yn)){if(dn.preventDefault(),dn.ctrlKey){var Sn=(fn=or?.prevEvent.scale)!==null&&fn!==void 0?fn:1,gn=cr(or?"pinch":"pinchstart",Sn,dn);or===null?or={firstEvent:gn,prevEvent:gn}:or.prevEvent=gn,De.onPinchGesture(gn),sr!==null&&window.clearTimeout(sr),sr=window.setTimeout(function(){var Vn;sr=null;var Yn=(Vn=or?.prevEvent.scale)!==null&&Vn!==void 0?Vn:1,ni=cr("pinchend",Yn,dn);or=null,De.onPinchGesture(ni)},200)}else{var Cn=(Math.abs(dn.deltaY)>Math.abs(dn.deltaX)?dn.deltaY:dn.deltaX)/-60,Mn=De.mouseWheelState!==void 0,Bn={x:dn.clientX,y:dn.clientY},kn=De.relativeClientPosition(Bn),Ln=new Raycaster;Ln.params.Points={threshold:.1},Ln.setFromCamera(kn,De.camera);var Pn=__assign(__assign({},Bn),{coords:kn,raycaster:Ln,buttons:dn.buttons,delta:Cn}),gn=createEvent("gesture.mousewheel",{target:dn.target,pointerType:"mouse",srcEvent:dn,pointers:[__assign({},Pn)],isFirst:Mn,isFinal:!1,scale:0,center:__assign({},Pn),velocityX:0,velocityY:0,overallVelocityX:0,overallVelocityY:0,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});De.onMouseWheel(gn),De.mouseWheelState&&clearTimeout(De.mouseWheelState.timer),De.mouseWheelState={timer:setTimeout(function(){delete De.mouseWheelState;var Yn=createEvent("gesture.mousewheel",{target:dn.target,pointerType:"mouse",srcEvent:dn,pointers:[__assign(__assign({},Pn),{delta:0})],isFirst:!1,isFinal:!0,scale:0,center:__assign(__assign({},Pn),{delta:0}),velocityX:0,velocityY:0,overallVelocityX:0,overallVelocityY:0,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});De.onMouseWheel(Yn)},100)}}sn()}},tn=function(dn){if(!isMobile){if(!Ve({x:dn.clientX,y:dn.clientY})){en();return}var fn=!1;De.mouseMoveState||(fn=!0);var yn={x:dn.clientX,y:dn.clientY},Sn=De.relativeClientPosition(yn),gn=new Raycaster;gn.params.Points={threshold:.1},gn.setFromCamera(Sn,De.camera);var Cn=__assign(__assign({},yn),{coords:Sn,raycaster:gn,buttons:dn.buttons,delta:0}),Mn=createEvent("gesture.mousemove",{target:dn.target,pointerType:"mouse",srcEvent:dn,pointers:[__assign({},Cn)],isFirst:fn,isFinal:!1,scale:0,center:__assign({},Cn),velocityX:0,velocityY:0,overallVelocityX:0,overallVelocityY:0,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});De.mouseMoveState={timeStamp:now$2(),event:Mn},De.onMouseMove(Mn),De.pressState&&Math.abs(dn.clientX-De.pressState.event.center.y)>10&&Math.abs(dn.clientY-De.pressState.event.center.y)>10&&sn()}},en=function(){if(De.mouseMoveState){var dn=createEvent(De.mouseMoveState.event.type,__assign(__assign({},De.mouseMoveState.event),{isFinal:!0}));delete De.mouseMoveState,De.onMouseMove(dn)}sn()},an=function(dn){if(!Ve(dn.center)){sn();return}var fn=!1;De.pressState||(fn=!0,De.pressState={event:dn,timeStamp:now$2(),stop:noop$1});var yn=now$2()-De.pressState.timeStamp,Sn=createEvent(De.pressState.event.type,__assign(__assign({},De.pressState.event),{isFirst:fn,isFinal:!1,center:__assign(__assign({},De.pressState.event.center),{delta:yn}),pointers:De.pressState.event.pointers.map(function(gn){return __assign(__assign({},gn),{delta:yn})})}));De.onPressGesture(Sn),De.pressState&&(De.pressState.stop=AnimationFrameLoop.shared.add(function(gn){an(dn)},!0,1))},rn=function(dn){if(sn(),!(dn.touches.length>1||dn.changedTouches.length<=0)){var fn={x:dn.changedTouches[0].clientX,y:dn.changedTouches[0].clientY},yn=De.relativeClientPosition(fn),Sn=new Raycaster;Sn.params.Points={threshold:.1},Sn.setFromCamera(yn,De.camera);var gn=__assign(__assign({},fn),{coords:yn,raycaster:Sn,buttons:0,delta:0}),Cn=createEvent("gesture.press",{target:dn.target,pointerType:"touch",srcEvent:dn,pointers:[__assign({},gn)],isFirst:!1,isFinal:!1,scale:0,center:gn,velocityX:0,velocityY:0,overallVelocityX:0,overallVelocityY:0,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});an(Cn)}},on=function(dn){sn();var fn={x:dn.clientX,y:dn.clientY},yn=De.relativeClientPosition(fn),Sn=new Raycaster;Sn.params.Points={threshold:.1},Sn.setFromCamera(yn,De.camera);var gn=__assign(__assign({},fn),{coords:yn,raycaster:Sn,buttons:dn.buttons,delta:0}),Cn=createEvent("gesture.press",{target:dn.target,pointerType:"mouse",srcEvent:dn,pointers:[__assign({},gn)],isFirst:!1,isFinal:!1,scale:0,center:gn,velocityX:0,velocityY:0,overallVelocityX:0,overallVelocityY:0,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});an(Cn)},sn=function(){var dn;if(De.pressState){var fn=now$2()-De.pressState.timeStamp,yn=createEvent(De.pressState.event.type,__assign(__assign({},De.pressState.event),{center:__assign(__assign({},De.pressState.event.center),{delta:fn}),isFirst:!1,isFinal:!0,pointers:De.pressState.event.pointers.map(function(Sn){return __assign(__assign({},Sn),{delta:fn})})}));De.onPressGesture(yn),(dn=De.pressState)===null||dn===void 0||dn.stop(),delete De.pressState}},ln=null,cn=function(dn){var fn,yn=!1,Sn=!1;switch(dn.type){case"gesturestart":yn=!0;break;case"gestureend":Sn=!0;break}var gn={x:dn.clientX,y:dn.clientY},Cn=De.relativeClientPosition(gn),Mn=new Raycaster;Mn.params.Points={threshold:.1},Mn.setFromCamera(Cn,De.camera);var Bn=__assign(__assign({},gn),{coords:Cn,raycaster:Mn,buttons:0,delta:0}),kn=createEvent("gesture.pinch",{target:dn.target,pointerType:"mouse",srcEvent:dn,pointers:[__assign({},Bn)],isFirst:yn,isFinal:Sn,scale:(fn=dn.scale)!==null&&fn!==void 0?fn:1,center:__assign({},Bn),velocityX:0,velocityY:0,overallVelocityX:0,overallVelocityY:0,userAction:!0,state:__assign(__assign({mode:De.mode},De.currentPano),clonePose(De.camera.pose))});return kn},hn=function(dn){if(dn.preventDefault(),!isMobile){var fn=cn(dn);ln={firstEvent:fn};var yn=ln.firstEvent;yn&&!Ve(yn.center)||De.onPinchGesture(fn)}},mn=function(dn){if(dn.preventDefault(),!isMobile&&ln){var fn=cn(dn),yn=ln.firstEvent;yn&&!Ve(yn.center)||De.onPinchGesture(fn)}},An=function(dn){if(dn.preventDefault(),!isMobile&&ln){var fn=cn(dn),yn=ln.firstEvent;ln=null,!(yn&&!Ve(yn.center))&&De.onPinchGesture(fn)}},xn=function(dn){if(dn&&typeof dn.preventDefault=="function"&&dn.currentTarget===Be&&dn.preventDefault(),typeof getSelection=="function"){var fn=getSelection();fn&&fn.focusNode&&(fn.removeAllRanges&&fn.removeAllRanges(),fn.empty&&fn.empty())}};this.enableWheel&&Be.addEventListener("wheel",Br,{passive:!1}),Be.addEventListener("mousemove",tn,!1),Be.addEventListener("mouseout",en,!1),Be.addEventListener("touchstart",rn,{passive:!0}),Be.addEventListener("touchend",sn,!1),Be.addEventListener("touchcancel",sn,!1),Be.addEventListener("mousedown",on,!1),Be.addEventListener("mouseup",sn,!1),Be.addEventListener("gesturestart",hn,{passive:!1}),Be.addEventListener("gesturechange",mn,{passive:!1}),Be.addEventListener("gestureend",An,{passive:!1}),Be.addEventListener("touchstart",xn,{passive:!1}),Be.addEventListener("contextmenu",xn,!1);var pn=function(){Fe.destroy(),Be.removeEventListener("wheel",Br,!1),Be.removeEventListener("mousemove",tn,!1),Be.removeEventListener("mouseout",en,!1),Be.removeEventListener("touchstart",rn,!1),Be.removeEventListener("touchend",sn,!1),Be.removeEventListener("touchcancel",sn,!1),Be.removeEventListener("mousedown",on,!1),Be.removeEventListener("mouseup",sn,!1),Be.removeEventListener("gesturestart",hn,!1),Be.removeEventListener("gesturechange",mn,!1),Be.removeEventListener("gestureend",An,!1),Be.removeEventListener("touchstart",xn,!1),Be.removeEventListener("contextmenu",xn,!1)};return Object.assign(pn,{element:Be})},Se.prototype.preloadPano=function(Be,De){var Ve=this;De===void 0&&(De=noop$1);var Fe=this.works.getResolvedObserver(Be);if(!Fe)return Promise.resolve();var Je=["right","left","up","down","front","back"];return Promise.all(Je.map(function(Xe){var Ke=__assign({key:"pano.".concat(panoStringify(Be),".").concat(Xe)},pick(Ve.imageOptions,["size","format","quality","mappings"])),Ye=Fe.images[Xe],or=applyImageURLOptions(Ye,Ve.imageOptions.transform,Ke);return getFetcher(Fe.work).preload(or,{timeout:500})})).then(function(){return De(Be),Be})},Se.prototype.updateScreenBuffer=function(Be){var De,Ve,Fe,Je,Xe,Ke;if(this.lastPostProcessingType!==Be)if(this.lastPostProcessingType=Be,Be==="luminance"){if(this.screenBuffers.length===0){var Ye=this.renderer.getDrawingBufferSize(sharedVector2$1);this.screenBuffers=[new WebGLRenderTarget(Ye.x,Ye.y,{generateMipmaps:!1,encoding:(Ve=(De=this.renderer)===null||De===void 0?void 0:De.outputEncoding)!==null&&Ve!==void 0?Ve:sRGBEncoding}),this.enableFragDepth?this.modelRenderTarget:null]}}else if(Be==="edl"){if(this.screenBuffers.length===0){var Ye=this.renderer.getDrawingBufferSize(sharedVector2$1);this.screenBuffers=[new WebGLRenderTarget(Ye.x,Ye.y,{generateMipmaps:!1,encoding:(Je=(Fe=this.renderer)===null||Fe===void 0?void 0:Fe.outputEncoding)!==null&&Je!==void 0?Je:sRGBEncoding,minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat,type:FloatType}),this.enableFragDepth?this.modelRenderTarget:null]}this.models.setMaterial({useEDL:!0})}else if(Be==="hq"){if(this.screenBuffers.length===0){var Ye=this.renderer.getDrawingBufferSize(sharedVector2$1),or=new WebGLRenderTarget(Ye.x,Ye.y,{generateMipmaps:!1,minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat,type:FloatType,depthTexture:new DepthTexture(Ye.x,Ye.y,UnsignedIntType)});or.depthTexture.format=DepthFormat,or.depthBuffer=!0;var sr=new WebGLRenderTarget(Ye.x,Ye.y,{generateMipmaps:!1,encoding:(Ke=(Xe=this.renderer)===null||Xe===void 0?void 0:Xe.outputEncoding)!==null&&Ke!==void 0?Ke:sRGBEncoding,minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat,type:FloatType,depthTexture:or.depthTexture});this.screenBuffers=[or,sr,this.enableFragDepth?this.modelRenderTarget:null]}this.models.setMaterial({useHQDepth:!0,useHQWeight:!1,pointShape:"CIRCLE"})}else this.screenBuffers&&(this.screenBuffers.forEach(function(cr){cr!==null&&cr.dispose()}),this.screenBuffers=[]),this.models.setMaterial({useEDL:!1,useHQDepth:!1,useHQWeight:!1})},Se}(Subscribe),defaultFloorplanControllerCustomInitArgs={defaultLongitude:Math.PI/4,defaultLatitude:Math.PI/4,defaultFov:80,maxFov:120,minFov:20,maxLatitude:+Math.PI/2,minLatitude:-Math.PI/2,intersectMeshCreator:function(){return new IntersectMesh}},FloorplanController=function($e){__extends(Se,$e);function Se(Be){var De=this,Ve,Fe=Se.parseArgs(Be);return De=$e.call(this,Fe)||this,De.mode="Floorplan",De.defaultLongitude=Fe.defaultLongitude,De.defaultLatitude=Fe.defaultLatitude,De.defaultFov=Fe.defaultFov,De.maxFov=Fe.maxFov,De.minFov=Fe.minFov,De.maxLatitude=Fe.maxLatitude,De.minLatitude=Fe.minLatitude,De.locationMotion=new Motion({x:De.camera.pose.offset.x,y:De.camera.pose.offset.y,z:De.camera.pose.offset.z,distance:De.camera.pose.distance}),De.modelAlphaMotion=new Motion({modelAlpha:(Ve=De.models.getMaterial().modelAlpha)!==null&&Ve!==void 0?Ve:0}),De.perspToOrthoMotion=new Motion({perspToOrtho:De.camera.perspToOrtho.x}),De.currentTapId=null,De.intersectMeshCreator=Fe.intersectMeshCreator,De.intersectMesh=De.intersectMeshCreator(),De.intersectMesh.name="intersect",De.intersectMesh.visible=!1,De.helper.add(De.intersectMesh),De}return Se.distanceFromModel=function(Be,De,Ve){var Fe=Be.bounding,Je=Math.pow(Math.pow(Fe.max.x-Fe.min.x+1,2)+Math.pow(Fe.max.y-Fe.min.y+1,2)+Math.pow(Fe.max.z-Fe.min.z+1,2),1/2),Xe=Je/2/Math.tan(Math.PI*De/360);return Ve<1&&(Xe=Xe/Ve),isNaN(Xe)?Je:Xe},Se.parseArgs=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye,or;if(Be instanceof Se)return Be;var sr=$e.parseArgs.call(this,Be);return __assign(__assign({},sr),{defaultLongitude:(De=Be.defaultLongitude)!==null&&De!==void 0?De:defaultFloorplanControllerCustomInitArgs.defaultLongitude,defaultLatitude:(Ve=Be.defaultLatitude)!==null&&Ve!==void 0?Ve:defaultFloorplanControllerCustomInitArgs.defaultLatitude,defaultFov:(Fe=Be.defaultFov)!==null&&Fe!==void 0?Fe:defaultFloorplanControllerCustomInitArgs.defaultFov,maxFov:(Je=Be.maxFov)!==null&&Je!==void 0?Je:defaultFloorplanControllerCustomInitArgs.maxFov,minFov:(Xe=Be.minFov)!==null&&Xe!==void 0?Xe:defaultFloorplanControllerCustomInitArgs.minFov,maxLatitude:(Ke=Be.maxLatitude)!==null&&Ke!==void 0?Ke:defaultFloorplanControllerCustomInitArgs.maxLatitude,minLatitude:(Ye=Be.minLatitude)!==null&&Ye!==void 0?Ye:defaultFloorplanControllerCustomInitArgs.minLatitude,intersectMeshCreator:(or=Be.intersectMeshCreator)!==null&&or!==void 0?or:defaultFloorplanControllerCustomInitArgs.intersectMeshCreator})},Se.initAnimationEndState=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye,or=this.parseArgs(Be),sr=Be.initial,cr=sr.state,Br=sr.currentState,tn=typeof cr.panoIndex=="number"?{workCode:(Fe=(De=cr.workCode)!==null&&De!==void 0?De:(Ve=or.works[0])===null||Ve===void 0?void 0:Ve.workCode)!==null&&Fe!==void 0?Fe:"",panoIndex:cr.panoIndex}:{workCode:Br.workCode,panoIndex:Br.panoIndex},en=__assign(__assign({},tn),{mode:"Floorplan",longitude:(Je=cr.longitude)!==null&&Je!==void 0?Je:isThirdPersonMode(Br.mode)?Br.longitude:or.defaultLongitude,latitude:clamp$1((Xe=cr.latitude)!==null&&Xe!==void 0?Xe:Br.mode==="Floorplan"?Br.latitude:or.defaultLatitude,or.minLatitude,or.maxLatitude),fov:(Ke=cr.fov)!==null&&Ke!==void 0?Ke:or.defaultFov,offset:cr.offset?cr.offset.clone():Be.models.bounding.getCenter(new Vector3),distance:(Ye=cr.distance)!==null&&Ye!==void 0?Ye:Se.distanceFromModel(or.models,or.defaultFov,or.camera.aspect)});return en},Se.prototype.updateConfiguration=function(Be){var De=$e.prototype.updateConfiguration.call(this,Be);if(De===!1)return!1;if(Be.defaultLongitude!==void 0&&this.defaultLongitude!==Be.defaultLongitude&&(this.defaultLongitude=Be.defaultLongitude),Be.defaultLatitude!==void 0&&this.defaultLatitude!==Be.defaultLatitude&&(this.defaultLatitude=Be.defaultLatitude),Be.defaultFov!==void 0&&this.defaultFov!==Be.defaultFov&&(this.defaultFov=Be.defaultFov),Be.maxFov!==void 0&&this.maxFov!==Be.maxFov&&(this.maxFov=Be.maxFov),Be.minFov!==void 0&&this.minFov!==Be.minFov&&(this.minFov=Be.minFov),Be.maxLatitude!==void 0&&this.maxLatitude!==Be.maxLatitude&&(this.maxLatitude=Be.maxLatitude),Be.minLatitude!==void 0&&this.minLatitude!==Be.minLatitude&&(this.minLatitude=Be.minLatitude),Be.intersectMeshCreator!==void 0&&this.intersectMeshCreator!==Be.intersectMeshCreator){this.intersectMeshCreator=Be.intersectMeshCreator;var Ve=this.intersectMesh;this.intersectMesh=this.intersectMeshCreator(),this.intersectMesh.name=Ve.name,this.intersectMesh.visible=Ve.visible;var Fe=this.intersectMesh.parent;Fe&&Fe.add(this.intersectMesh),Ve.dispose()}return!0},Se.prototype.destroy=function(){$e.prototype.destroy.call(this),this.locationMotion.dispose(),delete this.panState,this.intersectMesh.dispose(),this.helper.remove(this.intersectMesh)},Se.prototype.isReady=function(){return this.locationMotion.ended===!1?!1:$e.prototype.isReady.call(this)},Se.prototype.updateWork=function(Be,De,Ve,Fe){var Je;return this.works=Be,this.updateCamera(De,(Je=Ve.duration)!==null&&Je!==void 0?Je:0,Fe),!0},Se.prototype.updateModel=function(Be){$e.prototype.updateModel.call(this,Be);var De=Be.bounding.getCenter(new Vector3),Ve=Se.distanceFromModel(Be,this.defaultFov,this.camera.aspect);this.updateCamera({offset:De,distance:Ve},0,!0)},Se.prototype.updateCamera=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();var Je={},Xe={};return Be.distance!==void 0&&(Je.distance=Be.distance),Be.offset!==void 0&&(Je.x=Be.offset.x,Je.y=Be.offset.y,Je.z=Be.offset.z),Be.longitude!==void 0&&(Xe.longitude=Be.longitude),Be.latitude!==void 0&&(Xe.latitude=Be.latitude),Be.fov!==void 0&&(Xe.fov=Be.fov),Fe.locationMotion.set(Je,De).catch(noop$1),Fe.cameraMotion.set(Xe,De).catch(noop$1)})},Se.prototype.updateCameraWithKeyframes=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();for(var Je=[],Xe=[],Ke=0,Ye=Be;Ke<Ye.length;Ke++){var or=Ye[Ke];Je.push({key:or.key,progress:or.progress,value:{distance:or.value.distance,x:or.value.offset.x,y:or.value.offset.x,z:or.value.offset.x}}),Xe.push({key:or.key,progress:or.progress,value:{longitude:or.value.longitude,latitude:or.value.latitude,fov:or.value.fov}})}return Fe.locationMotion.setKeyframes(Je,De).catch(noop$1),Fe.cameraMotion.setKeyframes(Be,De)})},Se.prototype.updateTime=function(Be,De){if(!this.destroyed){var Ve={},Fe={};if(this.modelAlphaMotion.ended||(this.modelAlphaMotion.update(Be),Ve.modelAlpha=this.modelAlphaMotion.value.modelAlpha),this.perspToOrthoMotion.ended||(this.perspToOrthoMotion.update(Be),this.camera.perspToOrtho.setScalar(clamp$1(this.perspToOrthoMotion.value.perspToOrtho,0,1))),this.locationMotion.ended||(this.locationMotion.update(Be),Fe.distance=this.locationMotion.value.distance,Fe.offset=new Vector3(this.locationMotion.value.x,this.locationMotion.value.y,this.locationMotion.value.z)),this.cameraMotion.ended||(this.cameraMotion.update(Be),Fe.longitude=this.cameraMotion.value.longitude,Fe.latitude=this.cameraMotion.value.latitude,Fe.fov=this.cameraMotion.value.fov),isEmptyObject(Ve)||this.models.setMaterial(Ve),isEmptyObject(Fe)||this.setCamera(Fe),this.intersectMesh&&this.intersectMesh.parent){var Je=this.camera.position.distanceTo(this.intersectMesh.position),Xe=2*Math.tan(.5*this.camera.fov/180*Math.PI),Ke=Je*Xe/5;this.intersectMesh.scale.setScalar(Ke)}}},Se.prototype.getTargetState=function(){var Be=this.cameraMotion.getKeyFrameSegment(now$2())[1],De=this.locationMotion.getKeyFrameSegment(now$2())[1];return __assign(__assign({},this.currentPano),{mode:this.mode,longitude:Be.value.longitude,latitude:Be.value.latitude,fov:Be.value.fov,offset:new Vector3(De.value.x,De.value.y,De.value.z),distance:De.value.distance})},Se.prototype.initAnimation=function(){var Be=this;return this.destroyed?Promise.resolve():new Promise(function(De){var Ve=Be.initial;Ve.state,Ve.currentState;var Fe=Ve.duration,Je=Ve.userAction;Be.userAction=Je;var Xe=Se.initAnimationEndState(Be),Ke=pick(Xe,["longitude","latitude","fov"]),Ye={x:Xe.offset.x,y:Xe.offset.y,z:Xe.offset.z,distance:Xe.distance},or={modelAlpha:1},sr={perspToOrtho:0};Be.emit("initAnimation.start",createEvent("initAnimation.start",{state:Xe,userAction:Be.userAction})),Be.modelAlphaMotion.set(or,Fe/3).catch(noop$1),Be.perspToOrthoMotion.set(sr,Fe).catch(noop$1),Be.cameraMotion.set(Ke,Fe).catch(noop$1),Be.locationMotion.set(Ye,Fe).then(function(){Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:Xe,userAction:Be.userAction}))},function(cr){var Br=__assign(__assign(__assign({},Be.currentPano),{mode:Be.mode}),clonePose(Be.camera.pose));Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:Br,userAction:Be.userAction}))}).then(function(){De()})})},Se.prototype.updateRenderSize=function(Be){this.needsRender=!0,this.modelSceneNeedsRender=!0,this.screenBuffers.forEach(function(De){De!==null&&De.setSize(Be.x,Be.y)})},Se.prototype.getForwardObserverOrNot=function(Be){var De=this,Ve=this.models.intersectRaycaster(Be)[0];if(!Ve)return null;var Fe=this.works.resolvedObservers.filter(function(Ye){for(var or,sr=0,cr=De.models;sr<cr.length;sr++){var Br=cr[sr];if(Br.visible&&((or=Br.work)===null||or===void 0?void 0:or.workCode)===Ye.work.workCode)return!0}return!1}),Je=arrayMin(Fe,function(Ye){return Ye.standingPosition.distanceTo(Ve.point)},!0),Xe=Je[0],Ke=Je[1];return Xe&&Ke<10?Xe:null},Se.prototype.coordinatesForOffset=function(Be){var De=this.renderer.getSize(new Vector2);return{longitude:-2*Be.x/(De.x*this.scissor.width),latitude:2*Be.y/(De.y*this.scissor.height)}},Se.prototype.requestMomentumMovement=function(Be,De,Ve,Fe){var Je=this;if(this.inMomentumMovement!==null){for(var Xe=__assign({},Ve),Ke={longitude:0,latitude:0},Ye=0;Ye<Fe;Ye++)Xe.longitude*=.996,Xe.latitude*=.996*.998,Ke.longitude+=Xe.longitude,Ke.latitude+=Xe.latitude;var or=formatRad(this.cameraMotion.value.longitude+Ke.longitude),sr=clamp$1(this.cameraMotion.value.latitude+Ke.latitude,this.minLatitude,this.maxLatitude),cr=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:or,latitude:sr,fov:this.cameraMotion.value.fov,offset:this.camera.pose.offset.clone(),distance:this.camera.pose.distance}),Br=!(Xe.longitude>1e-4||Xe.longitude<-1e-4||Xe.latitude>1e-4||Xe.latitude<-1e-4),tn=createEvent("gesture.momentum",__assign(__assign({},Be),{isFirst:De,isFinal:Br,state:cr}));if(this.inMomentumMovement.event=tn,this.emit("gesture.momentum",tn),Be.defaultPrevented){this.inMomentumMovement=null;return}this.inMomentumMovement&&(this.cameraMotion.set({longitude:or,latitude:sr},0).catch(noop$1),Br?this.inMomentumMovement=null:AnimationFrameLoop.shared.add(function(en,an){Je.requestMomentumMovement(Be,!1,Xe,an|0)},!0,1))}},Se.prototype.onPanGesture=function(Be){this.userAction=Be.userAction,this.stopMomentumMovement(),this.hideIntersectMesh();var De=this.panState,Ve=Be.pointers.length;if(Be.isFinal?delete this.panState:this.panState={pointerLength:Ve,x:Be.center.x,y:Be.center.y},!(typeof De>"u"||De.pointerLength!==Ve)){var Fe={x:Be.center.x-De.x,y:Be.center.y-De.y},Je=this.relativeClientPosition(Be.center),Xe=this.camera.pose.latitude<Math.PI/6||Je.y<0?1:-1;Fe.x*=Xe;var Ke=this.coordinatesForOffset(Fe),Ye=formatRad(this.cameraMotion.value.longitude+Ke.longitude),or=clamp$1(this.cameraMotion.value.latitude+Ke.latitude,this.minLatitude,this.maxLatitude);this.camera.aspect<1&&Math.abs(Be.overallVelocityX)>.2&&Math.atan2(Math.abs(Be.overallVelocityY),Math.abs(Be.overallVelocityX))<Math.PI/6.923&&(or=this.cameraMotion.value.latitude);var sr=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:Ye,latitude:or,fov:this.camera.pose.fov,offset:this.camera.pose.offset,distance:this.camera.pose.distance});if(Be.state=sr,this.emit("gesture.pan",Be),!Be.defaultPrevented&&(this.cameraMotion.set({longitude:sr.longitude,latitude:sr.latitude},0).catch(noop$1),Be.isFinal)){var cr=Be.velocityX*Xe,Br=Be.velocityY;this.inMomentumMovement={uuid:createUuid()},this.requestMomentumMovement(Be,!0,this.coordinatesForOffset({x:cr,y:Br}),0)}}},Se.prototype.onPinchGesture=function(Be){var De;if(this.initAnimationIsReady){this.userAction=Be.userAction,this.stopMomentumMovement();var Ve=(De=this.pinchState)===null||De===void 0?void 0:De.fov;if(Be.isFirst){this.pinchState={x:Be.center.x,y:Be.center.y,fov:this.cameraMotion.value.fov};return}if(Be.isFinal&&(delete this.panState,delete this.pinchState),typeof Ve<"u"){var Fe=clamp$1(Ve/Be.scale,this.minFov,this.maxFov);Be.state.fov=Fe,this.emit("gesture.pinch",Be),!Be.defaultPrevented&&(this.cameraMotion.set({fov:Fe},0).catch(noop$1),this.onPanGesture(Be))}}},Se.prototype.onMouseMove=function(Be){var De,Ve;if(this.intersectMesh.parent&&!this.panState){if(this.emit("gesture.mousemove",Be),Be.defaultPrevented){this.hideIntersectMesh();return}var Fe=Be.center.raycaster;if(Be.isFinal&&this.intersectMesh.parent&&this.intersectMesh.visible===!0){this.hideIntersectMesh();return}var Je=this.models.intersectRaycaster(Fe)[0],Xe=createEvent("intersect.update",{raycaster:Fe,intersection:Je??null,object:this.intersectMesh});if(this.emit("intersect.update",Xe),Xe.defaultPrevented){this.hideIntersectMesh();return}if(Je){var Ke=(Ve=(De=Je.face)===null||De===void 0?void 0:De.normal)!==null&&Ve!==void 0?Ve:new Vector3().copy(Fe.ray.direction).multiplyScalar(-1),Ye=Ke.clone(),or=Je.point.clone();this.intersectMesh.position.copy(or);var sr=or.clone().add(Ye);if(this.intersectMesh.lookAt(sr),Math.abs(Ke.y)>.99){var cr=this.camera.position.clone().sub(or);this.intersectMesh.rotation.z=-Math.atan2(cr.z,cr.x)}this.intersectMesh.visible=!0,this.needsRender=!0}else this.hideIntersectMesh()}},Se.prototype.onMouseWheel=function(Be){if(this.initAnimationIsReady){this.userAction=Be.userAction,this.stopMomentumMovement();var De=this,Ve=De.minFov,Fe=De.maxFov,Je=clamp$1(this.camera.fov-Be.center.delta,Ve,Fe);Be.state.fov=Je,this.emit("gesture.mousewheel",Be),!Be.defaultPrevented&&this.cameraMotion.set({fov:Je},0).catch(noop$1)}},Se.prototype.onTapGesture=function(Be){var De=this;this.userAction=!0,this.stopMomentumMovement();var Ve=Be.center.raycaster,Fe=this.getForwardObserverOrNot(Ve);if(!Fe)this.emit("gesture.tap",Be);else{var Je={longitude:this.camera.pose.longitude,latitude:0},Xe=__assign(__assign({},Be.state),{mode:"Panorama",workCode:Fe.pano.workCode,panoIndex:Fe.pano.panoIndex,longitude:Je.longitude,latitude:Je.latitude,offset:Fe?Fe.position.clone():new Vector3,distance:0});if(Be.state=Xe,this.emit("gesture.tap",Be),!Be.defaultPrevented&&(this.emit("pano.select",createEvent("pano.select",{prevPano:this.currentPano,state:Xe,userAction:Be.userAction,options:Je,progress:0,error:null})),Fe&&Fe.active)){var Ke=this.currentTapId=createUuid();this.preloadPano(Fe.pano).then(function(Ye){De.currentTapId===Ke&&De.emit("pano.request",createEvent("pano.request",{userAction:!0,prevPano:De.currentPano,progress:0,state:Xe,options:Je,error:null}))})}}},Se.prototype.onDblTapGesture=function(Be){this.userAction=Be.userAction,this.stopMomentumMovement();var De=this.cameraMotion.value.fov,Ve=this.minFov-De<De-this.defaultFov?this.minFov:this.defaultFov;Be.state.fov=Ve,this.emit("gesture.dbltap",Be),!Be.defaultPrevented&&(this.cameraMotion.set({fov:Ve},360).catch(noop$1),this.hideIntersectMesh())},Se.prototype.hideIntersectMesh=function(){this.intersectMesh.visible=!1,this.needsRender=!0},Se}(BaseController);__assign({},omit(defaultFloorplanControllerCustomInitArgs,["defaultLongitude","defaultLatitude","maxLatitude","minLatitude"]));var TopviewController=function($e){__extends(Se,$e);function Se(Be){var De=this,Ve=Se.parseArgs(Be);return De=$e.call(this,Ve)||this,De.mode="Topview",De}return Se.parseArgs=function(Be){if(Be instanceof Se)return Be;var De=__assign(__assign({},Be),{defaultLongitude:0,defaultLatitude:Math.PI/2});return $e.parseArgs.call(this,De)},Se.initAnimationEndState=function(Be){var De=this.parseArgs(Be),Ve=$e.initAnimationEndState.call(this,De);return __assign(__assign({},Ve),{longitude:De.defaultLongitude,latitude:De.defaultLatitude,mode:"Topview"})},Se.prototype.updateConfiguration=function(Be){return $e.prototype.updateConfiguration.call(this,__assign(__assign({},Be),{defaultLongitude:0,defaultLatitude:Math.PI/2}))},Se.prototype.updateModel=function(Be){this.needsRender=!0,this.modelSceneNeedsRender=!0;var De=this.models.bounding.getCenter(new Vector3);this.locationMotion.set({x:De.x,y:De.y,z:De.z,distance:FloorplanController.distanceFromModel(this.models,this.defaultFov,this.camera.aspect)},0).catch(noop$1)},Se.prototype.updateCamera=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();var Je={},Xe={};return Be.distance!==void 0&&(Je.distance=Be.distance),Be.offset!==void 0&&(Je.x=Be.offset.x,Je.y=Be.offset.y,Je.z=Be.offset.z),Be.longitude!==void 0&&(Xe.longitude=Be.longitude),Be.latitude!==void 0&&(Xe.latitude=Be.latitude),Be.fov!==void 0&&(Xe.fov=Be.fov),Fe.locationMotion.set(Je,De).catch(noop$1),Fe.cameraMotion.set(Xe,De).catch(noop$1)})},Se.prototype.updateCameraWithKeyframes=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();for(var Je=[],Xe=[],Ke=0,Ye=Be;Ke<Ye.length;Ke++){var or=Ye[Ke];Je.push({key:or.key,progress:or.progress,value:{distance:or.value.distance,x:or.value.offset.x,y:or.value.offset.y,z:or.value.offset.z}}),Xe.push({key:or.key,progress:or.progress,value:{longitude:or.value.longitude,latitude:or.value.latitude,fov:or.value.fov}})}return Fe.locationMotion.setKeyframes(Je,De).catch(noop$1),Fe.cameraMotion.setKeyframes(Be,De)})},Se.prototype.initAnimation=function(){var Be=this;return this.destroyed?Promise.resolve():new Promise(function(De){var Ve=Be.initial;Ve.state,Ve.currentState;var Fe=Ve.duration,Je=Ve.userAction;Be.userAction=Je;var Xe=Se.initAnimationEndState(Be),Ke={longitude:Xe.longitude,latitude:Xe.latitude,fov:Xe.fov},Ye={x:Xe.offset.x,y:Xe.offset.y,z:Xe.offset.z,distance:Xe.distance},or={modelAlpha:1},sr={perspToOrtho:1};Be.emit("initAnimation.start",createEvent("initAnimation.start",{state:Xe,userAction:Be.userAction})),Be.modelAlphaMotion.set(or,Fe/3).catch(noop$1),Be.perspToOrthoMotion.set(sr,Fe).catch(noop$1),Be.cameraMotion.set(Ke,Fe).catch(noop$1),Be.locationMotion.set(Ye,Fe).then(function(){Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:Xe,userAction:Be.userAction}))},function(cr){var Br=__assign(__assign(__assign({},Be.currentPano),{mode:Be.mode}),clonePose(Be.camera.pose));Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:Br,userAction:Be.userAction}))}).then(function(){De()})})},Se.prototype.requestMomentumMovement=function(){this.inMomentumMovement=null},Se.prototype.onPanGesture=function(Be){this.userAction=Be.userAction,this.stopMomentumMovement();var De=this.panState,Ve=Be.pointers.length;if(Be.isFinal?delete this.panState:this.panState={pointerLength:Ve,x:Be.center.x,y:Be.center.y},!(typeof De>"u"||De.pointerLength!==Ve)){var Fe={x:Be.center.x-De.x,y:Be.center.y-De.y},Je=new Vector3(this.locationMotion.value.x,this.locationMotion.value.y,this.locationMotion.value.z),Xe=this.locationMotion.value.distance;Xe*=Math.tan(this.cameraMotion.value.fov/2*Math.PI/180);var Ke=this.renderer.getSize(new Vector2),Ye=2*Fe.x*Xe/Ke.y,or=2*Fe.y*Xe/Ke.y,sr=new Vector3;sr.setFromMatrixColumn(this.camera.matrix,0),sr.multiplyScalar(-Ye),Je.add(sr),sr.setFromMatrixColumn(this.camera.matrix,1),sr.multiplyScalar(or),Je.add(sr);var cr=this.models.bounding.getCenter(new Vector3),Br=this.models.bounding.getSize(new Vector3),tn=Math.max(Br.x,Br.y,Br.z)/2;Je.clamp(cr.clone().sub(new Vector3().setScalar(tn)),cr.clone().add(new Vector3().setScalar(tn)));var en=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:0,latitude:Math.PI/2,fov:this.cameraMotion.value.fov,offset:Je,distance:this.locationMotion.value.distance});Be.state=en,this.emit("gesture.pan",Be),!Be.defaultPrevented&&this.locationMotion.set({x:Je.x,y:Je.y,z:Je.z},0).catch(noop$1)}},Se.prototype.onPinchGesture=function(Be){var De;if(this.initAnimationIsReady){this.userAction=Be.userAction,this.stopMomentumMovement();var Ve=(De=this.pinchState)===null||De===void 0?void 0:De.fov;if(Be.isFirst){this.pinchState={x:Be.center.x,y:Be.center.y,fov:this.cameraMotion.value.fov};return}if(Be.isFinal&&delete this.pinchState,typeof Ve<"u"){var Fe=clamp$1(Ve/Be.scale,this.minFov,this.maxFov);Be.state.fov=Fe,this.emit("gesture.pinch",Be),!Be.defaultPrevented&&(this.cameraMotion.set({fov:Fe},0).catch(noop$1),Be.type="gesture.pan",this.onPanGesture(Be))}}},Se.prototype.onMouseWheel=function(Be){if(this.initAnimationIsReady){this.userAction=Be.userAction,this.stopMomentumMovement();var De=clamp$1(this.cameraMotion.value.fov-Be.center.delta,this.minFov,this.maxFov);Be.state.fov=De,this.emit("gesture.mousewheel",Be),!Be.defaultPrevented&&this.cameraMotion.set({fov:De},0).catch(noop$1)}},Se}(FloorplanController),defaultPanoramaLikeControllerCustomInitArgs={defaultLatitude:0,defaultFov:90,maxFov:120,minFov:20,maxLatitude:+Math.PI/2,minLatitude:-Math.PI/2,moveSpeed:3.4,intersectMeshCreator:function(){return new IntersectMesh}},PanoramaLikeController=function($e){__extends(Se,$e);function Se(Be){var De=this,Ve=Se.parseArgs(Be);return De=$e.call(this,Ve)||this,De.mode="PanoramaLike",De.defaultLatitude=Ve.defaultLatitude,De.defaultFov=Ve.defaultFov,De.maxFov=Ve.maxFov,De.minFov=Ve.minFov,De.maxLatitude=Ve.maxLatitude,De.minLatitude=Ve.minLatitude,De.moveSpeed=Ve.moveSpeed,De.intersectMeshCreator=Ve.intersectMeshCreator,De.intersectMesh=De.intersectMeshCreator(),De.intersectMesh.name="intersect",De.intersectMesh.visible=!1,De.helper.add(De.intersectMesh),De}return Se.parseArgs=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye,or;if(Be instanceof Se)return Be;var sr=$e.parseArgs.call(this,Be);return __assign(__assign({},sr),{defaultLatitude:(De=Be.defaultLatitude)!==null&&De!==void 0?De:defaultPanoramaLikeControllerCustomInitArgs.defaultLatitude,defaultFov:(Ve=Be.defaultFov)!==null&&Ve!==void 0?Ve:defaultPanoramaLikeControllerCustomInitArgs.defaultFov,maxFov:(Fe=Be.maxFov)!==null&&Fe!==void 0?Fe:defaultPanoramaLikeControllerCustomInitArgs.maxFov,minFov:(Je=Be.minFov)!==null&&Je!==void 0?Je:defaultPanoramaLikeControllerCustomInitArgs.minFov,maxLatitude:(Xe=Be.maxLatitude)!==null&&Xe!==void 0?Xe:defaultPanoramaLikeControllerCustomInitArgs.maxLatitude,minLatitude:(Ke=Be.minLatitude)!==null&&Ke!==void 0?Ke:defaultPanoramaLikeControllerCustomInitArgs.minLatitude,moveSpeed:(Ye=Be.moveSpeed)!==null&&Ye!==void 0?Ye:defaultPanoramaLikeControllerCustomInitArgs.moveSpeed,intersectMeshCreator:(or=Be.intersectMeshCreator)!==null&&or!==void 0?or:defaultPanoramaLikeControllerCustomInitArgs.intersectMeshCreator})},Se.initAnimationEndState=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye=this.parseArgs(Be),or=Ye.works,sr=Be.initial,cr=sr.state,Br=sr.currentState,tn=typeof cr.panoIndex=="number"?{workCode:(Fe=(De=cr.workCode)!==null&&De!==void 0?De:(Ve=Ye.works[0])===null||Ve===void 0?void 0:Ve.workCode)!==null&&Fe!==void 0?Fe:"",panoIndex:cr.panoIndex}:{workCode:Br.workCode,panoIndex:Br.panoIndex},en=or.getResolvedObserver(tn),an=(Je=cr.longitude)!==null&&Je!==void 0?Je:Br.longitude,rn=clamp$1((Xe=cr.latitude)!==null&&Xe!==void 0?Xe:isFristPersonMode(Br.mode)?Br.latitude:Ye.defaultLatitude,Ye.minLatitude,Ye.maxLatitude),on=clamp$1((Ke=cr.fov)!==null&&Ke!==void 0?Ke:isFristPersonMode(Br.mode)?Br.fov:Ye.defaultFov,Ye.minFov,Ye.maxFov),sn=en?en.position.clone():new Vector3;return{workCode:tn.workCode,panoIndex:tn.panoIndex,mode:"PanoramaLike",longitude:an,latitude:rn,fov:on,offset:sn,distance:0}},Se.prototype.updateConfiguration=function(Be){var De=$e.prototype.updateConfiguration.call(this,Be);if(De===!1)return!1;if(Be.defaultLatitude!==void 0&&this.defaultLatitude!==Be.defaultLatitude&&(this.defaultLatitude=Be.defaultLatitude),Be.maxLatitude!==void 0&&this.maxLatitude!==Be.maxLatitude&&(this.maxLatitude=Be.maxLatitude),Be.minLatitude!==void 0&&this.minLatitude!==Be.minLatitude&&(this.minLatitude=Be.minLatitude),Be.defaultFov!==void 0&&this.defaultFov!==Be.defaultFov&&(this.defaultFov=Be.defaultFov),Be.maxFov!==void 0&&this.maxFov!==Be.maxFov&&(this.maxFov=Be.maxFov),Be.minFov!==void 0&&this.minFov!==Be.minFov&&(this.minFov=Be.minFov),Be.moveSpeed!==void 0&&this.moveSpeed!==Be.moveSpeed&&(this.moveSpeed=Be.moveSpeed),Be.intersectMeshCreator!==void 0&&this.intersectMeshCreator!==Be.intersectMeshCreator){this.intersectMeshCreator=Be.intersectMeshCreator;var Ve=this.intersectMesh;this.intersectMesh=this.intersectMeshCreator(),this.intersectMesh.name=Ve.name,this.intersectMesh.visible=Ve.visible;var Fe=this.intersectMesh.parent;Fe&&Fe.add(this.intersectMesh),Ve.dispose()}return!0},Se.prototype.destroy=function(){$e.prototype.destroy.call(this),this.intersectMesh&&(this.helper.remove(this.intersectMesh),this.intersectMesh.dispose()),delete this.panState},Se.prototype.isReady=function(){return this.panState||this.pinchState?!1:$e.prototype.isReady.call(this)},Se.prototype.calculateMovingDuration=function(Be,De){switch(typeof Be){case"function":return Be(De,this.moveSpeed);case"number":return Be;case"string":return Number(Be);default:return clamp$1(De,2,5)/this.moveSpeed*1e3}},Se.prototype.hideIntersectMesh=function(){this.intersectMesh.visible=!1,this.needsRender=!0},Se.prototype.coordinatesForOffset=function(Be){var De=this.cameraMotion.value.fov,Ve=this.camera.aspect,Fe=this.renderer.getSize(new Vector2);return{longitude:2*Be.x/(Fe.x*this.scissor.width)*De/95*Ve,latitude:-2*Be.y/(Fe.y*this.scissor.height)*De/95}},Se.prototype.cameraBounce=function(){var Be=this.cameraMotion.value,De=Be.longitude,Ve=Be.latitude,Fe=Be.fov,Je=[{progress:0,value:{longitude:De,latitude:Ve,fov:Fe}},{progress:.5,value:{longitude:De,latitude:Ve,fov:Fe*.98}},{progress:1,value:{longitude:De,latitude:Ve,fov:Fe}}];this.cameraMotion.setKeyframes(Je,500).catch(noop$1)},Se.prototype.requestMomentumMovement=function(Be,De,Ve,Fe){var Je=this;if(this.inMomentumMovement!==null){for(var Xe=__assign({},Ve),Ke={longitude:0,latitude:0},Ye=0;Ye<Fe;Ye++)Xe.longitude*=.996,Xe.latitude*=.996*.99,Ke.longitude+=Xe.longitude,Ke.latitude+=Xe.latitude;var or=formatRad(this.cameraMotion.value.longitude+Ke.longitude),sr=clamp$1(this.cameraMotion.value.latitude+Ke.latitude,this.minLatitude,this.maxLatitude),cr=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:or,latitude:sr,fov:this.cameraMotion.value.fov,offset:this.camera.pose.offset.clone(),distance:this.camera.pose.distance}),Br=!(Xe.longitude>1e-4||Xe.longitude<-1e-4||Xe.latitude>1e-4||Xe.latitude<-1e-4),tn=createEvent("gesture.momentum",__assign(__assign({},Be),{isFirst:De,isFinal:Br,state:cr}));if(this.inMomentumMovement.event=tn,this.emit("gesture.momentum",tn),Be.defaultPrevented){this.inMomentumMovement=null;return}this.inMomentumMovement&&(this.cameraMotion.set({longitude:or,latitude:sr},0).catch(noop$1),Br?this.inMomentumMovement=null:AnimationFrameLoop.shared.add(function(en,an){Je.requestMomentumMovement(Be,!1,Xe,an|0)},!0,1))}},Se.prototype.onPanGesture=function(Be){this.userAction=Be.userAction,this.stopMomentumMovement(),this.hideIntersectMesh();var De=this.panState,Ve=Be.pointers.length;if(Be.isFinal?delete this.panState:this.panState={pointerLength:Ve,x:Be.center.x,y:Be.center.y},!(typeof De>"u"||De.pointerLength!==Ve)){var Fe={x:Be.center.x-De.x,y:Be.center.y-De.y},Je=this.coordinatesForOffset(Fe),Xe=formatRad(this.cameraMotion.value.longitude+Je.longitude),Ke=clamp$1(this.cameraMotion.value.latitude+Je.latitude,this.minLatitude,this.maxLatitude);this.camera.aspect<1&&Math.abs(Be.overallVelocityX)>.2&&Math.atan2(Math.abs(Be.overallVelocityY),Math.abs(Be.overallVelocityX))<Math.PI/6.923&&(Ke=this.cameraMotion.value.latitude);var Ye=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:Xe,latitude:Ke,fov:this.cameraMotion.value.fov,offset:this.camera.pose.offset.clone(),distance:this.camera.pose.distance});if(Be.state=Ye,this.emit("gesture.pan",Be),!Be.defaultPrevented){var or={longitude:Ye.longitude,latitude:Ye.latitude,fov:Ye.fov};if(this.cameraMotion.set(or,0).catch(noop$1),Be.isFinal){var sr=Be.velocityX,cr=Be.velocityY*.6;Math.abs(cr)>.5&&Math.abs(sr)<.5&&(sr=0),this.inMomentumMovement={uuid:createUuid()},this.requestMomentumMovement(Be,!0,this.coordinatesForOffset({x:sr,y:cr}),0)}}}},Se.prototype.onPinchGesture=function(Be){var De;this.userAction=Be.userAction,this.stopMomentumMovement();var Ve=(De=this.pinchState)===null||De===void 0?void 0:De.fov,Fe=Be.scale;if(Be.isFirst){this.pinchState={x:Be.center.x,y:Be.center.y,fov:this.cameraMotion.value.fov};return}if(Be.isFinal&&delete this.pinchState,typeof Ve<"u"){var Je=clamp$1(Ve/Fe,this.minFov,this.maxFov);Be.state.fov=Je,this.emit("gesture.pinch",Be),!Be.defaultPrevented&&(this.cameraMotion.set({fov:Je},0).catch(noop$1),Be.type="gesture.pan",this.onPanGesture(Be))}},Se.prototype.onMouseWheel=function(Be){this.userAction=Be.userAction,this.stopMomentumMovement();var De=clamp$1(this.cameraMotion.value.fov-Be.center.delta,this.minFov,this.maxFov);Be.state.fov=De,this.emit("gesture.mousewheel",Be),!Be.defaultPrevented&&(this.cameraMotion.set({fov:De},0).catch(noop$1),this.onMouseMove(Be))},Se.prototype.onMouseMove=function(Be){var De,Ve;if(this.intersectMesh.parent&&!this.panState&&(this.emit("gesture.mousemove",Be),!Be.defaultPrevented)){var Fe=Be.center.raycaster;if(Be.isFinal&&this.intersectMesh.parent){this.hideIntersectMesh();return}var Je=this.models.intersectRaycaster(Fe)[0],Xe=createEvent("intersect.update",{raycaster:Fe,intersection:Je??null,object:this.intersectMesh});if(this.emit("intersect.update",Xe),Xe.defaultPrevented){this.hideIntersectMesh();return}if(Je){var Ke=(Ve=(De=Je.face)===null||De===void 0?void 0:De.normal)!==null&&Ve!==void 0?Ve:new Vector3().copy(Fe.ray.direction).multiplyScalar(-1),Ye=Ke.clone(),or=Je.point.clone();this.intersectMesh.position.copy(or);var sr=or.clone().add(Ye);if(this.intersectMesh.lookAt(sr),Math.abs(Ke.y)>.99){var cr=this.camera.position.clone().sub(or);this.intersectMesh.rotation.z=-Math.atan2(cr.z,cr.x)}this.intersectMesh.visible=!0,this.needsRender=!0}else this.hideIntersectMesh()}},Se.prototype.onDblTapGesture=function(Be){this.userAction=Be.userAction,this.stopMomentumMovement();var De=this.cameraMotion.value.fov,Ve=2,Fe=this.works.getResolvedObserver(this.currentPano);if(Fe){var Je=Fe.images.tiles;Je&&Je.length&&(Ve=Math.max.apply(Math,Je.map(function(Ye){return Ye.level})))}var Xe=Math.max(40-Ve*5,this.minFov,5),Ke=Xe-De<De-this.defaultFov?Xe:this.defaultFov;Be.state.fov=Ke,this.emit("gesture.dbltap",Be),!Be.defaultPrevented&&(this.cameraMotion.set({fov:Ke},360).catch(noop$1),this.hideIntersectMesh())},Se}(BaseController),blankVideo="data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw",result;function canplayVideo(){return result||(result=new Promise(function($e){var Se,Be=document.createElement("video");Be.muted=!0,Be.src=blankVideo,Be.addEventListener("timeupdate",function De(){Be.removeEventListener("timeupdate",De,!1),clearTimeout(Se);var Ve=document.createElement("canvas");Ve.width=Ve.height=1;var Fe=Ve.getContext("2d");if(!Fe){$e(!1);return}Fe.drawImage(Be,0,0,1,1);var Je=Fe.getImageData(0,0,1,1).data;Je[3]>10?$e(!0):$e(!1)},!1),Be.addEventListener("canplay",function De(){Be.removeEventListener("canplay",De,!1),Be.play()},!1),Se=window.setTimeout(function(){return $e(!1)},1e3)}))}var FRAGMENT=`
#include <common>
uniform sampler2D inputBuffer;
uniform float scale;
varying vec2 vUv;

void main() {
  float u = (vUv.x - 0.5) * scale + 0.5;
  float v = (vUv.y - 0.5) * scale + 0.5;
  vec3 rgb = texture2D(inputBuffer, vec2(u, v)).rgb;
  float luminance = clamp(linearToRelativeLuminance(rgb), 0.1, 0.9);
  gl_FragColor = vec4(luminance);
}
`,LuminancePass=function($e){__extends(Se,$e);function Se(Be,De){return De===void 0&&(De=.5),$e.call(this,Be,{uniforms:{inputBuffer:new Uniform(null),scale:new Uniform(De)},fragment:FRAGMENT})||this}return Se}(Pass),Effect=function(){function $e(Se,Be,De,Ve){this.enable=!0,this.renderer=Se,this.camera=De,this.models=Ve,this.scene=Be,this.copyPass=new CopyPass(this.renderer)}return $e.prototype.render=function(Se,Be){},$e.prototype.dispose=function(){this.copyPass.dispose()},$e}(),NextStepPass=function($e){__extends(Se,$e);function Se(Be,De){De===void 0&&(De=.002);var Ve=$e.call(this,Be,{uniforms:{targetBuffer:new Uniform(null),inputBuffer:new Uniform(null),step:new Uniform(De)},fragment:`
        uniform sampler2D targetBuffer;
        uniform sampler2D inputBuffer;
        uniform float step;
        varying vec2 vUv;
        void main() {

          #ifdef GL_EXT_shader_texture_lod
            #if __VERSION__ < 300
              float target = texture2DLodEXT(targetBuffer, vUv, 5.0).r;
            #else
              float target = textureLod(targetBuffer, vUv, 5.0).r;
            #endif
          #else
            float target = texture2D(targetBuffer, vUv).r;
          #endif
          float current = texture2D(inputBuffer, vUv).r;

          float result;
          if (abs(target - current) < step) {
            result = target;
          } else if (target - current > 0.0) {
            result = current + step;
          } else {
            result = current - step;
          }
          gl_FragColor = vec4(result, result, result, 1.0);
        }
      `})||this;return Ve.material.extensions.shaderTextureLOD=!0,Ve}return Object.defineProperty(Se.prototype,"targetBuffer",{get:function(){return this.material.uniforms.targetBuffer.value},set:function(Be){this.material.uniforms.targetBuffer.value=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"step",{get:function(){return this.material.uniforms.step.value},set:function(Be){this.material.uniforms.step.value=Be},enumerable:!1,configurable:!0}),Se}(Pass),LuminanceAdaptivePass=function($e){__extends(Se,$e);function Se(Be){var De=$e.call(this,Be,{uniforms:{inputBuffer:new Uniform(null),luminanceAdaptiveBuffer:new Uniform(null),progress:new Uniform(0)},fragment:`
        #include <common>
        uniform sampler2D inputBuffer;
        uniform sampler2D luminanceAdaptiveBuffer;
        uniform float progress;
        varying vec2 vUv;

        void main() {
          float middleGrey = 1.5;
          float whitePoint = 13.0;
          float exposure = 1.4;
          vec4 inputColor = texture2D(inputBuffer, vUv);
          vec3 rgb = inputColor.rgb * exposure;
          float alpha = inputColor.a;
          float luminance = linearToRelativeLuminance(rgb);
          float lumAvg = texture2D(luminanceAdaptiveBuffer, vec2(0.5)).r;
          float lumScaled = (luminance * middleGrey) / max(lumAvg, 1e-6);
          float lumCompressed = lumScaled * (1.0 + lumScaled / (whitePoint * whitePoint));
          lumCompressed /= (1.0 + lumScaled);
          rgb = clamp(lumCompressed * rgb, 0.0, 1.0);
          gl_FragColor = mix(inputColor, vec4(rgb, alpha), progress * 0.9);
        }
      `})||this;return De.material.transparent=!0,De}return Object.defineProperty(Se.prototype,"luminanceAdaptiveBuffer",{get:function(){return this.material.uniforms.luminanceAdaptiveBuffer.value},set:function(Be){this.material.uniforms.luminanceAdaptiveBuffer.value=Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"progress",{get:function(){return this.material.uniforms.progress.value},set:function(Be){this.material.uniforms.progress.value=Be},enumerable:!1,configurable:!0}),Se}(Pass),LuminanceAdaptiveEffect=function($e){__extends(Se,$e);function Se(Be,De,Ve,Fe){var Je=$e.call(this,Be,De,Ve,Fe)||this;return Je.enableTime=now$2(),Je.renderer=Be,Je.valuePass=new ValuePass(Je.renderer),Je.luminancePass=new LuminancePass(Je.renderer,Math.sqrt(1/3)),Je.nextStepPass=new NextStepPass(Je.renderer,.01),Je.luminanceAdaptivePass=new LuminanceAdaptivePass(Je.renderer),Je}return Se.prototype.render=function(Be){this.renderer.setRenderTarget(Be[0]),this.renderer.render(this.scene,this.camera),this.enableTime===null&&(this.enableTime=now$2()),this.luminanceTargetBuffer||(this.luminanceTargetBuffer=new WebGLRenderTarget(128,128,{minFilter:LinearMipmapLinearFilter,magFilter:LinearFilter,encoding:this.renderer.outputEncoding,stencilBuffer:!1,depthBuffer:!1,format:RGBAFormat,generateMipmaps:!0}),this.nextStepPass.targetBuffer=this.luminanceTargetBuffer.texture),this.luminancePass.render(Be[0],this.luminanceTargetBuffer),this.luminancePrevBuffer||(this.luminancePrevBuffer=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType,encoding:this.renderer.outputEncoding,stencilBuffer:!1,depthBuffer:!1}),this.valuePass.render(new Vector3(.5,.5,.5),this.luminancePrevBuffer)),this.luminanceNextBuffer||(this.luminanceNextBuffer=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter,type:HalfFloatType,encoding:this.renderer.outputEncoding,stencilBuffer:!1,depthBuffer:!1}),this.valuePass.render(new Vector3(.5,.5,.5),this.luminanceNextBuffer),this.luminanceAdaptivePass.luminanceAdaptiveBuffer=this.luminanceNextBuffer.texture),this.copyPass.render(this.luminanceNextBuffer,this.luminancePrevBuffer),this.nextStepPass.render(this.luminancePrevBuffer,this.luminanceNextBuffer),this.luminanceAdaptivePass.progress=Math.min((now$2()-this.enableTime)/100,1),this.luminanceAdaptivePass.render(Be[0],Be[1])},Se.prototype.dispose=function(){var Be,De,Ve;(Be=this.luminanceTargetBuffer)===null||Be===void 0||Be.dispose(),(De=this.luminancePrevBuffer)===null||De===void 0||De.dispose(),(Ve=this.luminanceNextBuffer)===null||Ve===void 0||Ve.dispose(),this.copyPass.dispose(),this.luminancePass.dispose(),this.nextStepPass.dispose(),this.luminanceAdaptivePass.dispose()},Se}(Effect),_a$1,sharedSortVector3=new Vector3,MAX_TILE_COUNT=64,SQRT1_2=(_a$1=Math.SQRT1_2)!==null&&_a$1!==void 0?_a$1:Math.sqrt(2),TILE_QUATERNION={up:new Quaternion(SQRT1_2,0,0,SQRT1_2),down:new Quaternion(-SQRT1_2,0,0,SQRT1_2),left:new Quaternion(0,SQRT1_2,0,SQRT1_2),right:new Quaternion(0,-SQRT1_2,0,SQRT1_2),front:new Quaternion(0,0,0,1),back:new Quaternion(0,1,0,0)},vertices$2=new Float32Array([-.5,-.5,0,.5,-.5,0,-.5,.5,0,.5,.5,0]),uvs$1=new Float32Array([0,0,1,0,0,1,1,1]),index$2=new Uint8Array([0,1,2,1,3,2]),geometry$3=new BufferGeometry;geometry$3.setAttribute("position",new BufferAttribute(vertices$2,3));geometry$3.setAttribute("uv",new BufferAttribute(uvs$1,2));geometry$3.setIndex(new BufferAttribute(index$2,1));var TILE_MATERIAL_VERTEX_SHADER=`
uniform float flipY;
varying vec2 vUv;
void main() {
  vUv = vec2(uv.x, mix((1.0 - uv.y), uv.y, flipY));
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,TILE_MATERIAL_FRAGMENT_SHADER=`
#if defined(USE_LUMINANCE)
uniform sampler2D luminanceMap;
#endif
uniform sampler2D map;
uniform float level;
varying vec2 vUv;

void main() {
  gl_FragColor = texture2D(map, vUv);
  #if defined(USE_LUMINANCE)
  gl_FragColor.a = 1.0 - texture2D(luminanceMap, vUv).r;
  #endif
}
`,TileMaterial=function($e){__extends(Se,$e);function Se(){var Be=$e.call(this,{uniforms:{map:{value:null},luminanceMap:{value:null},flipY:{value:1},level:{value:0}},vertexShader:TILE_MATERIAL_VERTEX_SHADER,fragmentShader:TILE_MATERIAL_FRAGMENT_SHADER})||this;return Be.depthTest=!1,Be.depthWrite=!1,Be.blending=NoBlending,Be.map=Be.uniforms.map.value,Be.luminanceMap=Be.uniforms.luminanceMap.value,Be.flipY=!!Be.uniforms.flipY.value,Be.level=Be.uniforms.level.value,Object.defineProperties(Be,{map:{get:function(){return this.uniforms.map.value},set:function(De){this.uniforms.map.value=De}},luminanceMap:{get:function(){return this.uniforms.luminanceMap.value},set:function(De){this.uniforms.luminanceMap.value=De,this.defines.USE_LUMINANCE=De!==null,this.needsUpdate=!0}},flipY:{get:function(){return this.uniforms.flipY.value===1},set:function(De){this.uniforms.flipY.value=De?1:0}},level:{get:function(){return this.uniforms.level.value},set:function(De){this.uniforms.level.value=De}}}),Be}return Se}(ShaderMaterial),TileMesh=function($e){__extends(Se,$e);function Se(Be,De){var Ve=$e.call(this,geometry$3,new TileMaterial)||this;return Be.box.getCenter(Ve.position),Ve.quaternion.multiplyQuaternions(new Quaternion().setFromAxisAngle(new Vector3(0,1,0),-Math.PI),TILE_QUATERNION[Be.face]),Ve.scale.setScalar(Be.size),Ve.node=Be,Ve.name="tiling:tile",Ve.material.visible=!1,Ve.activeTime=-1,Ve.disposed=!1,Ve.needsRender=!1,Ve.frustumCulled=!1,De.then(function(Fe){var Je=Fe[0],Xe=Fe[1];Ve.disposed?(Je.dispose(),Xe?.dispose()):(Ve.material.map=Je,Ve.material.luminanceMap=Xe,Ve.material.flipY=!!Je.flipY,Ve.material.level=Be.level,Ve.material.needsUpdate=!0,Ve.material.visible=!0,Ve.needsRender=!0)}).catch(noop$1),Ve}return Se.prototype.updateTime=function(Be){},Se.prototype.dispose=function(){var Be;this.disposed=!0,this.material.map&&(this.material.map.dispose(),(Be=this.material.luminanceMap)===null||Be===void 0||Be.dispose()),this.material.dispose()},Se}(Mesh),TilingObject3D=function($e){__extends(Se,$e);function Se(){var Be=$e.call(this)||this;return Be.needsRender=!1,Be.name="tiling",Be}return Se}(Group$1),Tiling=function(){function $e(Se,Be,De){this.disposed=!1,this.textureLoader=new TextureLoader,this.minLevel=Be,this.level=0,this.panoId="[0]",this.maxRequest=$e.DEFAULT_MAX_REQUEST,this.pedding=0,this.tileTree=createTileCubeTree(this.minLevel),this.tileMeshes=new Map,this.resource=[],this.luminance=null,this.imageOptions=De,this.fetcher=Se,this.object=new TilingObject3D,this.object.renderOrder=-3}return $e.prototype.setFetcher=function(Se){this.fetcher=Se},$e.prototype.cleanup=function(){var Se=this;this.tileMeshes.forEach(function(Be){Be.dispose(),Se.object.remove(Be),Se.object.needsRender=!0}),this.tileMeshes.clear()},$e.prototype.setRotation=function(Se){this.disposed||this.object.quaternion.equals(Se)||(this.object.quaternion.copy(Se),this.object.needsRender=!0)},$e.prototype.setPosition=function(Se){this.disposed||this.object.position.equals(Se)||(this.object.position.copy(Se),this.object.needsRender=!0)},$e.prototype.setResource=function(Se,Be){var De,Ve;if(!this.disposed&&!(this.resource===Se&&this.luminance===Be)){this.cleanup(),this.resource=Se;var Fe=(Ve=(De=Se.slice().sort(function(Je,Xe){return Xe.level-Je.level})[0])===null||De===void 0?void 0:De.level)!==null&&Ve!==void 0?Ve:0;this.tileTree=createTileCubeTree(Fe),this.luminance=Be,this.object.needsRender=!0}},$e.prototype.update=function(Se,Be,De){var Ve=this;if(!this.disposed){this.level=Be;var Fe=Se.planes[5].normal,Je=[];Be>=this.minLevel&&traverseTileCubeNode(this.tileTree,function(on){if(!(on.level<Ve.minLevel)){if(on.level>Be||!Se.intersectsBox(on.box))return!1;Je.push(on)}}),Je.sort(function(on,sn){return on.level!==sn.level?on.level-sn.level:on.box.getCenter(sharedSortVector3).angleTo(Fe)-sn.box.getCenter(sharedSortVector3).angleTo(Fe)});for(var Xe=new Set,Ke=function(on){var sn=Ye.resource.filter(function(Pn){return Pn.level===on.level})[0];if(!sn)return"continue";if(Xe.add(on),Ye.tileMeshes.has(on))return Ye.tileMeshes.get(on).activeTime=De,"continue";if(Ye.pedding>=Ye.maxRequest)return"continue";var ln=sn.size,cn=Ye.imageOptions.transform,hn=Math.pow(2,on.level)*on.position.y,mn=Math.pow(2,on.level)*on.position.x,An="".concat(Ye.panoId,".").concat(on.face,".").concat(on.level,".").concat(hn,".").concat(mn),xn=__assign(__assign({},pick(Ye.imageOptions,["format","sharpen","mappings"])),{key:"pano_tile.".concat(An),size:sn.scale>=1?void 0:ln*on.size*sn.scale,cut:on.size===1?void 0:[ln*on.position.x,ln*on.position.y,ln*on.size,ln*on.size]});on.size===1&&console.warn("tile: ".concat(xn.key," should not appear.")),on.level===1&&sn.scale>=.5&&(xn.format==="jpg"||/\.jpg$/.test(sn[on.face]))&&(xn.size=void 0,xn.quality||(xn.quality=70));var pn=Ye.textureLoader.loadTexture(sn[on.face],{imageURL:{transform:cn,options:xn},minFilter:LinearFilter,magFilter:LinearFilter,generateMipmaps:!1,fetcher:Ye.fetcher}).then(function(Pn){return Pn.body}),dn=null;if(Ye.luminance){var fn=Ye.luminance[on.face],yn=fn.match(/\/cube_(\d+)\//),Sn=yn?Number(yn[1]):!1;if(Sn!==!1){var gn=sn.size*sn.scale/2,Cn=gn*on.size,Mn=Sn<gn?fn.replace(/\/cube_(\d+)\//,"cube_"+gn):fn,Bn=__assign(__assign({},xn),{size:Sn*on.size===Cn?void 0:Cn,cut:on.size===1?void 0:[Sn*on.position.x,Sn*on.position.y,Sn*on.size,Sn*on.size],key:"pano_tile_luminance.".concat(An)});on.size===1&&console.warn("tile: ".concat(Bn.key," should not appear.")),dn=Ye.textureLoader.loadTexture(Mn,{imageURL:{transform:Ye.imageOptions.transform,options:Bn},minFilter:LinearFilter,magFilter:LinearFilter,fetcher:Ye.fetcher}).then(function(Pn){return Pn.body}).catch(function(){return null})}}Ye.pedding++;var kn=Promise.all([pn,dn]).then(function(Pn){return Ve.pedding--,Pn},function(Pn){return Ve.pedding--,Promise.reject(Pn)}),Ln=new TileMesh(on,kn);Ln.name="tiling:tile-".concat(An),Ln.activeTime=De,Ln.renderOrder=on.level,Ye.tileMeshes.set(on,Ln),Ye.object.needsRender=!0,Ye.object.add(Ln)},Ye=this,or=0,sr=Je;or<sr.length;or++){var cr=sr[or];Ke(cr)}var Br=[];this.tileMeshes.forEach(function(on,sn){Xe.has(sn)||Br.push(sn),on.visible=sn.level<=Be});for(var tn=Br.sort(function(on,sn){var ln,cn,hn,mn;return((cn=(ln=Ve.tileMeshes.get(sn))===null||ln===void 0?void 0:ln.activeTime)!==null&&cn!==void 0?cn:0)-((mn=(hn=Ve.tileMeshes.get(on))===null||hn===void 0?void 0:hn.activeTime)!==null&&mn!==void 0?mn:0)}).slice(Math.max(0,MAX_TILE_COUNT-Xe.size)),en=0,an=tn;en<an.length;en++){var cr=an[en],rn=this.tileMeshes.get(cr);rn&&(rn.dispose(),this.object.remove(rn),this.object.needsRender=!0),this.tileMeshes.delete(cr)}}},$e.prototype.dispose=function(){this.cleanup(),this.resource=[],this.disposed=!0},$e.DEFAULT_MAX_REQUEST=3,$e}(),vertices$1=new Float32Array([-1,1,1,-1,1,-1,-1,-1,1,-1,-1,-1,1,1,-1,1,1,1,1,-1,-1,1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,-1,1,-1,-1,1,-1,1,-1,1,1,-1,-1,-1,-1,1,-1,-1]),index$1=new Uint8Array([0,2,1,2,3,1,4,6,5,6,7,5,8,10,9,10,11,9,12,14,13,14,15,13,16,18,17,18,19,17,20,22,21,22,23,21]),sharedGeometry$1=new BufferGeometry;sharedGeometry$1.setAttribute("position",new BufferAttribute(vertices$1,3));sharedGeometry$1.setIndex(new BufferAttribute(index$1,1));var PANO_VIDEO_MATERIAL_VERTEX_SHADER=`
#if defined(USE_PANO_VIDEO)
varying vec3 worldPosition;
#endif
void main() {
  vec4 transformed = vec4(position, 1.0);
  #if defined(USE_PANO_VIDEO)
  worldPosition = (modelMatrix * transformed).xyz;
  #endif
  gl_Position = projectionMatrix * modelViewMatrix * transformed;
}
`,PANO_VIDEO_TILE_MATERIAL_FRAGMENT_SHADER=`
uniform vec2 size;
uniform mat4 matrix;
uniform float alpha;
uniform sampler2D map;
#if defined(USE_PANO_VIDEO)
varying vec3 worldPosition;
#endif
#include <common>
void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
  #if defined(USE_PANO_VIDEO)
  vec3 cameraToVertex = worldPosition - cameraPosition;
  vec4 mapCoods = vec4(cameraToVertex, 1.0) * matrix;
  vec2 uv = vec2(
    0.5 + mapCoods.x / mapCoods.z / size.x,
    0.5 - mapCoods.y / mapCoods.z / size.y
  );
  vec4 videoColor = texture2D(map, uv);
  float match = (1.0 - step(0.0, mapCoods.z)) * (1.0 - step(0.5, abs(uv.x - 0.5))) * (1.0 - step(0.5, abs(uv.y - 0.5)));
  float blendAlpha = clamp(0.0, 1.0, 5.0 * (1.0 - clamp(distance(uv, vec2(0.5, 0.5)) / 0.55 , 0.0, 1.0)));
  gl_FragColor = vec4(videoColor.rgb, match * blendAlpha * alpha);
  #endif
}
`,PanoVideo=function(){function $e(){this.material=new ShaderMaterial({vertexShader:PANO_VIDEO_MATERIAL_VERTEX_SHADER,fragmentShader:PANO_VIDEO_TILE_MATERIAL_FRAGMENT_SHADER,uniforms:{size:new Uniform(null),matrix:new Uniform(null),alpha:new Uniform(null),map:new Uniform(null)},depthTest:!1,depthWrite:!1,defines:{USE_PANO_VIDEO:!1},blending:CustomBlending,blendSrc:SrcAlphaFactor,blendDst:OneMinusSrcAlphaFactor,blendSrcAlpha:OneFactor,blendDstAlpha:OneMinusSrcAlphaFactor}),this.object=new Mesh(sharedGeometry$1,this.material),this.object.visible=!1,this.object.renderOrder=-1,this.object.frustumCulled=!1,this.object.name="pano-video",this.alphaMotion=new Motion({alpha:0})}return $e.prototype.setMaterial=function(Se){Se?(this.material.uniforms.size.value=Se.size,this.material.uniforms.matrix.value=Se.matrix,this.material.uniforms.map.value=Se.map,this.alphaMotion.set({alpha:Se.alpha},500).catch(noop$1),this.material.uniforms.alpha.value=Se.alpha):(this.material.uniforms.size.value=null,this.material.uniforms.matrix.value=null,this.material.uniforms.map.value=null,this.alphaMotion.set({alpha:0},0).catch(noop$1));var Be=Se!==null,De=this.material.defines.USE_PANO_VIDEO;Be!==De&&(this.material.defines.USE_PANO_VIDEO=Be,this.material.needsUpdate=!0,this.object.visible=Se!==null)},$e.prototype.updateTime=function(Se){this.alphaMotion.ended||(this.alphaMotion.update(Se),this.material.uniforms.alpha.value=this.alphaMotion.value.alpha)},$e.prototype.dispose=function(){this.material.dispose()},$e}(),ROTATE_Y_PI_MATRIX$1=new Matrix4().makeRotationAxis(new Vector3(0,1,0),Math.PI),PANO_TEXTURE_SCALE$1=new Vector3(-1,1,1),CubeRenderTargetPool=function(){function $e(Se){Se===void 0&&(Se=0),this.width=Se,this.pool=[]}return Object.defineProperty($e.prototype,"size",{get:function(){return this.pool.length},enumerable:!1,configurable:!0}),$e.prototype.create=function(){return new WebGLCubeRenderTarget(this.width,{stencilBuffer:!1,depthBuffer:!1})},$e.prototype.pop=function(){var Se=this.pool.pop();return Se||this.create()},$e.prototype.push=function(Se){this.pool.indexOf(Se)===-1&&this.pool.push(Se)},$e.prototype.clear=function(){for(var Se=0,Be=this.pool;Se<Be.length;Se++){var De=Be[Se];De.dispose()}this.pool.length=0},$e}(),defaultPanoramaControllerCustomInitArgs=__assign(__assign({},defaultPanoramaLikeControllerCustomInitArgs),{maxAccessibleDistance:5,panoTapTriggerRadius:.5,panoCircleMeshCreator:function($e){return new PanoCircleMesh},tiledCubeTextureLevel:2,tileLevelForFov:function($e,Se){var Be,De=function(Xe){return Xe/180*Math.PI},Ve=(Be=Math.log2)!==null&&Be!==void 0?Be:function(Xe){return Math.log(Xe)*Math.LOG2E},Fe=Se.height/2/Math.tan(De($e/2))*Math.tan(De(45))*2,Je=Math.max(Ve(Fe/512),0);return Je<2.3&&Je>.1&&(Je=1),Je=Je%1>.75?Math.ceil(Je):Math.floor(Je),Je},tileMaxRequest:3,luminanceAdaptiveEffectEnable:!0}),PanoramaController=function($e){__extends(Se,$e);function Se(Be){var De=this,Ve,Fe,Je,Xe,Ke=Se.parseArgs(Be);De=$e.call(this,Ke)||this,De.mode="Panorama",De.tileLevel=0,De.initAnimationed=!1,De.maxAccessibleDistance=Ke.maxAccessibleDistance,De.panoTapTriggerRadius=Ke.panoTapTriggerRadius,De.panoCircleMeshCreator=Ke.panoCircleMeshCreator,De.tiledCubeTextureLevel=Ke.tiledCubeTextureLevel,De.tileLevelForFov=Ke.tileLevelForFov,De.tileMaxRequest=Ke.tileMaxRequest,De.luminanceAdaptiveEffectEnable=Ke.luminanceAdaptiveEffectEnable,De.luminanceAdaptiveEffect=new LuminanceAdaptiveEffect(De.renderer,De.modelScene,De.camera,De.models),De.colorCubeRenderTargetPool=new CubeRenderTargetPool,De.luminanceCubeRenderTargetPool=new CubeRenderTargetPool;var Ye=De.models.getMaterial()||{},or=Ye.pano0,sr=Ye.pano1;or&&sr?.map!==or.map&&(De.models.setMaterial({pano0:sr}),or.map.dispose(),or.map instanceof TileCubeTextureTarget&&or.map.cubeRenderTarget&&De.colorCubeRenderTargetPool.push(or.map.cubeRenderTarget),or.luminanceMap&&(or.luminanceMap.dispose(),or.luminanceMap instanceof TileCubeTextureTarget&&or.luminanceMap.cubeRenderTarget&&De.luminanceCubeRenderTargetPool.push(or.luminanceMap.cubeRenderTarget)));var cr=new Set;or&&cr.add(or),sr&&cr.add(sr);for(var Br=De.colorCubeRenderTargetPool.size+cr.size;Br<2;Br++){var tn=Math.max(1024*De.tiledCubeTextureLevel,512),en=De.colorCubeRenderTargetPool.create();en.setSize(tn,tn),renderCubeTextureToCubeRenderTarget(null,en,De.renderer),De.colorCubeRenderTargetPool.push(en)}De.panoMeshes={},De.updatePanoMeshes(),De.locationMotion=new Motion({count:0,distance:De.camera.pose.distance}),De.modelAlphaMotion=new Motion({modelAlpha:(Fe=(Ve=De.models.getMaterial())===null||Ve===void 0?void 0:Ve.modelAlpha)!==null&&Fe!==void 0?Fe:0}),De.perspToOrthoMotion=new Motion({perspToOrtho:De.camera.perspToOrtho.x}),De.panoResources={},De.panoResources[De.locationMotion.keyframes[0].key=De.locationMotion.keyframes[1].key=createUuid()]={panoId:panoStringify(De.currentPano),panoPicture:(Xe=(Je=De.models.getMaterial())===null||Je===void 0?void 0:Je.pano1)!==null&&Xe!==void 0?Xe:null,position:De.camera.pose.offset.clone(),effect:"fly",fixCameraTransform:new Matrix4};var an=De.works.getResolvedObserver(De.currentPano);return De.textureLoader=new TextureLoader,De.tiling=new Tiling(an?getFetcher(an.work):internalFetcher,De.tiledCubeTextureLevel+1,De.imageOptions),De.scene.add(De.tiling.object),De.panoVideo=new PanoVideo,De.scene.add(De.panoVideo.object),De}return Se.parseArgs=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye;if(Be instanceof Se)return Be;var or=$e.parseArgs.call(this,Be);return __assign(__assign({},or),{maxAccessibleDistance:(De=Be.maxAccessibleDistance)!==null&&De!==void 0?De:defaultPanoramaControllerCustomInitArgs.maxAccessibleDistance,panoTapTriggerRadius:(Ve=Be.panoTapTriggerRadius)!==null&&Ve!==void 0?Ve:defaultPanoramaControllerCustomInitArgs.panoTapTriggerRadius,panoCircleMeshCreator:(Fe=Be.panoCircleMeshCreator)!==null&&Fe!==void 0?Fe:defaultPanoramaControllerCustomInitArgs.panoCircleMeshCreator,tiledCubeTextureLevel:(Je=Be.tiledCubeTextureLevel)!==null&&Je!==void 0?Je:defaultPanoramaControllerCustomInitArgs.tiledCubeTextureLevel,tileLevelForFov:(Xe=Be.tileLevelForFov)!==null&&Xe!==void 0?Xe:defaultPanoramaControllerCustomInitArgs.tileLevelForFov,tileMaxRequest:(Ke=Be.tileMaxRequest)!==null&&Ke!==void 0?Ke:defaultPanoramaControllerCustomInitArgs.tileMaxRequest,luminanceAdaptiveEffectEnable:(Ye=Be.luminanceAdaptiveEffectEnable)!==null&&Ye!==void 0?Ye:defaultPanoramaControllerCustomInitArgs.luminanceAdaptiveEffectEnable})},Se.initAnimationEndState=function(Be){var De=this.parseArgs(Be),Ve=$e.initAnimationEndState.call(this,De);return __assign(__assign({},Ve),{mode:"Panorama"})},Se.prototype.updateConfiguration=function(Be){var De=this,Ve=$e.prototype.updateConfiguration.call(this,Be);if(Ve===!1)return!1;if(Be.maxAccessibleDistance!==void 0&&this.maxAccessibleDistance!==Be.maxAccessibleDistance&&(this.maxAccessibleDistance=Be.maxAccessibleDistance),Be.panoTapTriggerRadius!==void 0&&this.panoTapTriggerRadius!==Be.panoTapTriggerRadius&&(this.panoTapTriggerRadius=Be.panoTapTriggerRadius),Be.panoCircleMeshCreator!==void 0&&this.panoCircleMeshCreator!==Be.panoCircleMeshCreator&&(this.panoCircleMeshCreator=Be.panoCircleMeshCreator,this.panoMeshes)){for(var Fe=Object.keys(this.panoMeshes),Je=0,Xe=Fe;Je<Xe.length;Je++){var Ke=Xe[Je],Ye=this.panoMeshes[Ke];this.helper.remove(Ye),Ye.dispose(),delete this.panoMeshes[Ke]}this.updatePanoMeshes()}return Be.tiledCubeTextureLevel!==void 0&&this.tiledCubeTextureLevel!==Be.tiledCubeTextureLevel&&(this.tiledCubeTextureLevel=Be.tiledCubeTextureLevel,setTimeout(function(){De.moveToPano(De.currentPano,{},!0)},30)),Be.tileLevelForFov!==void 0&&this.tileLevelForFov!==Be.tileLevelForFov&&(this.tileLevelForFov=Be.tileLevelForFov),Be.tileMaxRequest!==void 0&&this.tileMaxRequest!==Be.tileMaxRequest&&(this.tileMaxRequest=Be.tileMaxRequest),Be.luminanceAdaptiveEffectEnable!==void 0&&this.luminanceAdaptiveEffectEnable!==Be.luminanceAdaptiveEffectEnable&&(this.luminanceAdaptiveEffectEnable=Be.luminanceAdaptiveEffectEnable),!0},Se.prototype.destroy=function(){var Be,De;if($e.prototype.destroy.call(this),this.scene.remove(this.tiling.object),this.tiling.dispose(),this.locationMotion.dispose(),this.colorCubeRenderTargetPool.clear(),this.luminanceCubeRenderTargetPool.clear(),delete this.pendingTextureTask,this.panoMeshes)for(var Ve=Object.keys(this.panoMeshes),Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe],Ke=this.panoMeshes[Xe];this.helper.remove(Ke),Ke.dispose(),delete this.panoMeshes[Xe]}var Ye=this.videoTexture.image;Ye.pause(),Ye.oncanplay=function(){},Ye.ontimeupdate=function(){},this.scene.remove(this.panoVideo.object),this.panoVideo.setMaterial(null),this.panoVideo.dispose();for(var or=(Be=this.models.getMaterial())!==null&&Be!==void 0?Be:{},sr=or.pano0,cr=or.pano1,Br=0,tn=Object.keys(this.panoResources);Br<tn.length;Br++){var en=tn[Br],an=this.panoResources[en];if(an.panoPicture){var rn=an.panoPicture.map;rn&&rn!==sr?.map&&rn!==cr?.map&&(rn.dispose(),(De=an.panoPicture.luminanceMap)===null||De===void 0||De.dispose(),an.panoPicture=null)}delete this.panoResources[en]}this.luminanceAdaptiveEffect.dispose()},Se.prototype.isReady=function(){return this.locationMotion.ended!==!0?!1:$e.prototype.isReady.call(this)},Se.prototype.isTileReady=function(){var Be,De,Ve,Fe=this.panoResourceFromLocationMotionKeyframe(this.locationMotion.keyframes[this.locationMotion.keyframes.length-1]),Je=((Be=Fe.panoPicture)===null||Be===void 0?void 0:Be.map)instanceof TileCubeTextureTarget&&(Ve=(De=Fe.panoPicture)===null||De===void 0?void 0:De.map.tilePending)!==null&&Ve!==void 0?Ve:0,Xe=Je<=0,Ke=this.tiling.pedding,Ye=this.tiling.object.visible&&Ke<=0;return this.initAnimationed&&Xe&&Ye},Se.prototype.updateWork=function(Be,De,Ve,Fe){var Je=this;this.userAction=Fe,this.works=Be;var Xe=Se.initAnimationEndState(__assign(__assign({},this),{initial:{currentState:__assign(__assign({},this.currentPano),this.camera.pose),duration:Ve.duration,effect:Ve.effect,state:De,userAction:Fe}})),Ke={workCode:Xe.workCode,panoIndex:Xe.panoIndex},Ye=this.works.getWork(Ke.workCode);return this.tiling.setFetcher(Ye?getFetcher(Ye):internalFetcher),this.tiling.cleanup(),this.initAnimationed=!1,this.hideIntersectMesh(),this.updatePanoMeshes(),this.moveToPano(Ke,{effect:Ve.effect,duration:Ve.duration,longitude:De.longitude,latitude:De.latitude,fov:De.fov,moveEndCallback:function(){Je.initAnimationed=!0},moveCancelCallback:function(){Je.initAnimationed=!0}},Fe),!0},Se.prototype.updateModel=function(Be){this.models=Be,this.updatePanoMeshes()},Se.prototype.updateTime=function(Be,De){var Ve=this,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn;if(!this.destroyed){var en={},an={},rn=this.panoResourceFromLocationMotionKeyframe(this.locationMotion.keyframes[0]),on=this.panoResourceFromLocationMotionKeyframe(this.locationMotion.keyframes[this.locationMotion.keyframes.length-1]),sn=!1;if(this.cameraMotion.ended===!1&&(this.cameraMotion.update(Be),an.longitude=this.cameraMotion.value.longitude,an.latitude=this.cameraMotion.value.latitude,an.fov=this.cameraMotion.value.fov),this.modelAlphaMotion.ended===!1&&(this.modelAlphaMotion.update(Be),en.modelAlpha=this.modelAlphaMotion.value.modelAlpha),this.perspToOrthoMotion.ended===!1&&(this.perspToOrthoMotion.update(Be),this.camera.perspToOrtho.setScalar(clamp$1(this.perspToOrthoMotion.value.perspToOrtho,0,1))),this.locationMotion.ended===!1){this.locationMotion.update(Be);var ln=this.locationMotion.getKeyFrameSegment(Be),cn=ln[0],hn=ln[1],mn=this.panoResourceFromLocationMotionKeyframe(cn),An=this.panoResourceFromLocationMotionKeyframe(hn),xn=new Vector3().copy(mn.position),pn=new Vector3().copy(An.position),dn=this.locationMotion.value.count-hn.value.count+1;en.progress=dn,An.panoPicture&&(dn<1?mn.panoPicture&&(en.pano0=mn.panoPicture):en.pano0=An.panoPicture,en.pano1=An.panoPicture),An.effect==="montage"?en.transition="BLACK":An.effect==="spread"?en.transition="SPREAD":en.transition="FADE",(An.effect==="zoomin"||An.effect==="zoomout")&&(en.progress=Math.pow(dn,3)),dn<1&&An.effect!=="fly"&&(en.pano0&&mn.panoPicture&&(en.pano0={map:en.pano0.map,zoom:en.pano0.zoom,luminanceMap:en.pano0.luminanceMap,matrix:mn.panoPicture.matrix.clone().premultiply(mn.fixCameraTransform).setPosition(An.position)}),xn.copy(pn),sn=!0),an.distance=this.locationMotion.value.distance,an.offset=new Vector3(xn.x+(pn.x-xn.x)*dn,xn.y+(pn.y-xn.y)*dn,xn.z+(pn.z-xn.z)*dn);for(var fn=[],yn=[],Sn=0,gn=this.locationMotion.keyframes;Sn<gn.length;Sn++){var Cn=gn[Sn],Mn=Cn.key,Bn=Cn.progress;Mn!==void 0&&(fn.push(Mn),Bn>this.locationMotion.progress&&yn.push(Mn))}for(var kn=0,Ln=Object.keys(this.panoResources);kn<Ln.length;kn++){var Pn=Ln[kn];if(!(yn.indexOf(Pn)>=0)){var Vn=this.panoResources[Pn];if(Vn.panoPicture){var Yn=Vn.panoPicture.map,ni=Vn.panoPicture.luminanceMap;if(Yn){if(Yn===((Fe=en.pano0)===null||Fe===void 0?void 0:Fe.map)||Yn===((Je=en.pano1)===null||Je===void 0?void 0:Je.map))continue;Yn instanceof TileCubeTextureTarget&&Yn.cubeRenderTarget&&this.colorCubeRenderTargetPool.push(Yn.cubeRenderTarget),Yn.dispose(),ni&&(ni instanceof TileCubeTextureTarget&&ni.cubeRenderTarget&&this.luminanceCubeRenderTargetPool.push(ni.cubeRenderTarget),ni.dispose()),Vn.panoPicture=null}}fn.indexOf(Pn)>=0||delete this.panoResources[Pn]}}this.currentPano=panoParse(An.panoId),this.emit("pano.moving",createEvent("pano.moving",{userAction:this.userAction,prevPano:panoParse(rn.panoId),state:__assign(__assign(__assign(__assign({},panoParse(on.panoId)),{mode:this.mode}),clonePose(this.camera.pose)),an),options:{},progress:this.locationMotion.progress,error:null}))}isEmptyObject(en)===!1&&(!((Xe=en.pano0)===null||Xe===void 0)&&Xe.map&&en.pano0.map instanceof TileCubeTextureTarget&&!en.pano0.map.cubeRenderTarget&&(en.pano0.map.cubeRenderTarget=this.colorCubeRenderTargetPool.pop()),!((Ke=en.pano0)===null||Ke===void 0)&&Ke.luminanceMap&&en.pano0.luminanceMap instanceof TileCubeTextureTarget&&!en.pano0.luminanceMap.cubeRenderTarget&&(en.pano0.luminanceMap.cubeRenderTarget=this.luminanceCubeRenderTargetPool.pop()),!((Ye=en.pano1)===null||Ye===void 0)&&Ye.map&&en.pano1.map instanceof TileCubeTextureTarget&&!en.pano1.map.cubeRenderTarget&&(en.pano1.map.cubeRenderTarget=this.colorCubeRenderTargetPool.pop()),!((or=en.pano1)===null||or===void 0)&&or.luminanceMap&&en.pano1.luminanceMap instanceof TileCubeTextureTarget&&!en.pano1.luminanceMap.cubeRenderTarget&&(en.pano1.luminanceMap.cubeRenderTarget=this.luminanceCubeRenderTargetPool.pop()),this.models.setMaterial(en)),isEmptyObject(an)===!1&&this.setCamera(an);var Rn=this.works.getResolvedObserver(this.currentPano),In=this.locationMotion.ended?this.getForwardObserverOrNot():null;if(this.camera.pose.distance>.1||sn)for(var Gn=0,Fn=Object.keys(this.panoMeshes);Gn<Fn.length;Gn++){var Hn=Fn[Gn],Dn=this.panoMeshes[Hn];Dn.setOpacity(0),Dn.setCurrent(!1),Dn.updateTime&&Dn.updateTime(Be,De),Dn.visible=!1}else if(Rn){var zn=arrayMin(Rn.visibleIds,function(_i){var Mi=Ve.works.getResolvedObserver(_i);return Mi?Rn.standingPosition.distanceTo(Mi.standingPosition):1/0},!0),Qn=zn[1];Qn=clamp$1(Qn,2.5,1/0);for(var Zn=Rn.visibleIds.concat(panoStringify(this.currentPano)),si=this.camera.getDirection(new Vector3),ei=0,hi=Object.keys(this.panoMeshes);ei<hi.length;ei++){var Hn=hi[ei],Dn=this.panoMeshes[Hn],Un=this.works.getResolvedObserver(Hn);if(Zn.indexOf(Hn)===-1)Dn.setCurrent(!1),Dn.setOpacity(0);else if(!Un)Dn.setCurrent(!1),Dn.setOpacity(0);else if(!Un.loadable&&!Un.active)Dn.setCurrent(!1),Dn.setOpacity(0);else{var Wn=Dn.position.clone().setY(this.camera.position.y).distanceTo(this.camera.position);Dn.setCurrent(!Dn.loading&&Dn.progress===0&&In!==null&&In.panoId===Hn),Dn.setOpacity(Wn<.01?0:clamp$1(Qn/Wn*1.2,.4,.85));var Ai=this.camera.position.clone().setY(Dn.position.y),oi=new Vector3().copy(Dn.position).sub(Ai).normalize();if(Hn===panoStringify(this.currentPano)){var ci=clamp$1((.5-Ai.distanceTo(Dn.position))/.5,0,1);oi.multiplyScalar(1-ci).add(si.clone().multiplyScalar(ci))}oi.length()>0&&Dn.quaternion.setFromEuler(new Euler(0,Math.atan2(oi.x,oi.z),0))}Dn.updateTime&&Dn.updateTime(Be,De)}}var ai=this.tileLevel=function(){if(Ve.tileLevelForFov===!1)return 0;var _i=Ve.renderer.getDrawingBufferSize(new Vector2);_i.width*=Ve.scissor.width,_i.height*=Ve.scissor.height;var Mi=on.panoId,$i=Ve.works.getResolvedObserver(Mi),vi=Ve.imageOptions.size;if(typeof vi>"u"&&$i){var ri=$i.images.up.match(/\/cube_(\d+)\//);ri&&(vi=Number(ri[1]))}typeof vi>"u"&&(vi=2048);var Ti=0;vi>=1024&&(Ti=1),vi>=2048&&(Ti=2),vi>=4096&&(Ti=3),vi>=8192&&(Ti=4);var Bi=Ve.tileLevelForFov(Ve.camera.fov,_i);return Bi>Ti?Bi:0}(),wi=function(){var _i=Ve.camera.quaternion.clone(),Mi=Ve.works.getResolvedObserver(on.panoId),$i=Mi??Rn;$i&&_i.premultiply($i.quaternion.clone().inverse());var vi=new Matrix4().makeRotationFromQuaternion(_i),ri=new Matrix4().getInverse(vi),Ti=new Frustum().setFromProjectionMatrix(new Matrix4().multiplyMatrices(Ve.camera.projectionMatrix,ri));return Ti}();on.panoId===panoStringify(this.currentPano)&&(((sr=on.panoPicture)===null||sr===void 0?void 0:sr.map)instanceof TileCubeTextureTarget&&(on.panoPicture.map.maxRequest=this.tileMaxRequest,on.panoPicture.map.update(wi,Math.min(ai,this.tiledCubeTextureLevel)),on.panoPicture.map.needsRender===!0&&(on.panoPicture.map.needsRender=!1,this.needsRender=!0,this.modelSceneNeedsRender=!0)),((cr=on.panoPicture)===null||cr===void 0?void 0:cr.luminanceMap)instanceof TileCubeTextureTarget&&(on.panoPicture.luminanceMap.maxRequest=this.tileMaxRequest,on.panoPicture.luminanceMap.update(wi,Math.min(ai,this.tiledCubeTextureLevel)),on.panoPicture.luminanceMap.needsRender===!0&&(on.panoPicture.luminanceMap.needsRender=!1,this.needsRender=!0,this.modelSceneNeedsRender=!0)));{var Pi=this.tiling.object.visible;if(this.initAnimationed){var Oi=on.panoId,Ri=this.works.getResolvedObserver(Oi);Ri?isSimilarVector3(this.camera.position,Ri.position)&&this.locationMotion.ended?(this.tiling.object.visible=!0,this.tiling.panoId!==Oi&&this.tiling.cleanup(),this.tiling.panoId=Oi,this.tiling.setResource((tn=(Br=Ri.images)===null||Br===void 0?void 0:Br.tiles)!==null&&tn!==void 0?tn:[],this.enableIOSEDR&&Ri.images.luminance?Ri.images.luminance:null),this.tiling.setFetcher(getFetcher(Ri.work)),this.tiling.setRotation(Ri.quaternion),this.tiling.setPosition(Ri.position),this.tiling.maxRequest=this.tileMaxRequest,ai>this.tiledCubeTextureLevel?this.tiling.update(wi,ai,Be):this.tiling.update(wi,0,Be)):this.tiling.object.visible=!1:this.tiling.object.visible=!1}else this.tiling.object.visible=!1;Pi!==this.tiling.object.visible&&(this.tiling.object.needsRender=!0,this.modelSceneNeedsRender=!0)}this.panoVideo.object.position.copy(this.camera.position),this.panoVideo.updateTime(Be),this.intersectMesh.scale.setScalar(clamp$1(this.cameraMotion.value.fov/45,0,1))}},Se.prototype.render=function(Be,De){var Ve=this.renderer.getRenderTarget(),Fe=this.works.getResolvedObserver(this.currentPano);Fe&&Fe.video&&(this.needsRender=!0,this.modelSceneNeedsRender=!0),this.updateScreenBuffer(De),this.enableFragDepth?(Be&&(De==="luminance"?(this.luminanceAdaptiveEffect.enable=this.luminanceAdaptiveEffectEnable,this.luminanceAdaptiveEffect.render(this.screenBuffers)):(this.renderer.setRenderTarget(this.modelRenderTarget),this.renderer.render(this.modelScene,this.camera))),this.depthCopyPass.render(this.modelRenderTarget.depthTexture,Ve),this.renderer.autoClearDepth=!1,this.renderer.autoClearColor=!0,this.copyPass.render(this.modelRenderTarget,Ve),this.renderer.setRenderTarget(Ve),this.renderer.autoClearColor=!1,this.renderer.autoClearDepth=!1,this.renderer.render(this.scene,this.camera),this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0):De==="luminance"?(this.luminanceAdaptiveEffect.enable=this.luminanceAdaptiveEffectEnable,this.luminanceAdaptiveEffect.render(this.screenBuffers)):(this.renderer.render(this.modelScene,this.camera),this.renderer.autoClearColor=!1,this.renderer.autoClearDepth=!1,this.renderer.render(this.scene,this.camera),this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0)},Se.prototype.postProcessing=function(Be,De){if(!this.destroyed&&De==="luminance")return this.luminanceAdaptiveEffect||(this.luminanceAdaptiveEffect=new LuminanceAdaptiveEffect(this.renderer,this.scene,this.camera,this.models),this.luminanceAdaptiveEffect.enable=this.luminanceAdaptiveEffectEnable),this.luminanceAdaptiveEffect.render(Be)},Se.prototype.getTargetState=function(){var Be=this.cameraMotion.getKeyFrameSegment(now$2())[1],De=this.locationMotion.getKeyFrameSegment(now$2())[1],Ve=this.panoResourceFromLocationMotionKeyframe(De),Fe=this.works.getResolvedObserver(Ve.panoId);return{workCode:Fe?Fe.work.workCode:this.currentPano.workCode,panoIndex:Fe?Fe.panoIndex:this.currentPano.panoIndex,mode:this.mode,longitude:Be.value.longitude,latitude:Be.value.latitude,fov:Be.value.fov,offset:Fe?Fe.position.clone():this.camera.position.clone(),distance:this.locationMotion.value.distance}},Se.prototype.moveToPano=function(Be,De,Ve){var Fe=this,Je,Xe,Ke,Ye,or=(Je=De.effect)!==null&&Je!==void 0?Je:"fly";this.userAction=Ve,this.stopMomentumMovement();var sr=this.works.getResolvedObserver(Be);if(!sr)throw new Error("Invalid PanoId ".concat(JSON.stringify(Be)));var cr=getImageSizeFromURL(sr.images.up),Br=this.imageOptions.size;typeof Br>"u"&&sr&&cr&&(Br=Number(cr)),typeof Br>"u"&&(Br=2048);var tn=this.imageOptions.transform,en=__assign({key:"pano.".concat(sr.panoId)},pick(this.imageOptions,["format","size","quality","sharpen","mappings"])),an=sr.images,rn=(Ke=(Xe=sr.images.tiles)===null||Xe===void 0?void 0:Xe.filter(function(gn){return gn.size>Br}))!==null&&Ke!==void 0?Ke:null,on=tn,sn={key:"pano_luminance.".concat(sr.panoId),size:en.size?en.size/2:void 0},ln=this.enableIOSEDR&&sr.images.luminance?sr.images.luminance:null,cn=function(){if(!sr.images.tiles||!ln)return null;var gn=getImageSizeFromURL(ln.up);return gn?rn?.map(function(Cn){var Mn=Cn.size*Cn.scale/2;return gn<Mn?{level:Cn.level,size:Mn,scale:1,back:replaceImageSize(ln.back,Mn),front:replaceImageSize(ln.front,Mn),left:replaceImageSize(ln.left,Mn),right:replaceImageSize(ln.right,Mn),up:replaceImageSize(ln.up,Mn),down:replaceImageSize(ln.down,Mn)}:{level:Cn.level,size:gn,scale:Mn/gn,back:ln.back,front:ln.front,left:ln.left,right:ln.right,up:ln.up,down:ln.down}}):null}(),hn="pano:"+jsonHash([an,en,tn,this.tiledCubeTextureLevel]);if(this.pendingTextureTask){if(this.pendingTextureTask.hash===hn)return;var mn=this.pendingTextureTask.panoId;(Ye=this.panoMeshes[mn])===null||Ye===void 0||Ye.setProgress(0),this.emit("pano.texture.abort",createEvent("pano.texture.abort",{error:null,progress:0,meta:null,pano:sr.pano}))}var An="move-to-pano-"+sr.panoId;this.pending.add(An);var xn=this.models.getMaterial()||{},pn=xn.pano0,dn=xn.pano1,fn;if(pn&&pn.map.name===hn&&pn.luminanceMap!==null===this.enableIOSEDR?fn=pn:dn?.map.name===hn&&dn.luminanceMap!==null===this.enableIOSEDR&&(fn=dn),fn){var yn={panoId:sr.panoId,effect:or,panoPicture:{zoom:1,map:fn.map,luminanceMap:fn.luminanceMap,matrix:new Matrix4().compose(sr.position,sr.quaternion,PANO_TEXTURE_SCALE$1)},position:sr.position.clone(),fixCameraTransform:new Matrix4};AnimationFrameLoop.shared.add(function(){Fe.pending.delete(An),Fe.doMoveToPano(sr.pano,yn,De)},!0,1);return}this.pendingTextureTask={panoId:sr.panoId,hash:hn,onLoad:function(gn,Cn){var Mn;if(Fe.pending.delete(An),Fe.destroyed)gn.body.dispose();else{gn.body.name=hn;var Bn={panoId:sr.panoId,effect:or,panoPicture:{zoom:1,map:gn.body,luminanceMap:(Mn=Cn?.body)!==null&&Mn!==void 0?Mn:null,matrix:new Matrix4().compose(sr.position,sr.quaternion,PANO_TEXTURE_SCALE$1)},position:sr.position.clone(),fixCameraTransform:new Matrix4};Fe.doMoveToPano(sr.pano,Bn,De)}},onError:function(gn){Fe.pending.delete(An);var Cn=__assign(__assign(__assign({},sr.pano),{mode:Fe.mode}),clonePose(Fe.camera.pose));Fe.emit("pano.error",createEvent("pano.error",{error:gn,userAction:Fe.userAction,options:De,prevPano:Fe.currentPano,progress:0,state:Cn})),Fe.emit("pano.cancel",createEvent("pano.cancel",{error:gn,userAction:Fe.userAction,options:De,prevPano:Fe.currentPano,progress:0,state:Cn})),Fe.emit("error",gn),De.moveCancelCallback&&De.moveCancelCallback()}};var Sn=this.panoMeshes[sr.panoId];Sn&&Sn.tap&&Sn.tap(),Promise.all([this.tileLevelForFov&&rn&&rn.length?this.textureLoader.loadTiledCubeTexture(an,rn,{tileMaxLevel:this.tiledCubeTextureLevel,imageURL:{transform:tn,options:en},minFilter:LinearFilter,magFilter:LinearFilter,generateMipmaps:!1,format:RGBAFormat,viaAjax:!0,fetcher:getFetcher(sr.work)},void 0,void 0,function(gn){var Cn,Mn;Fe.emit("pano.texture.progress",createEvent("pano.texture.progress",{error:null,progress:gn,meta:null,pano:sr.pano})),((Cn=Fe.pendingTextureTask)===null||Cn===void 0?void 0:Cn.hash)===hn&&((Mn=Fe.panoMeshes[sr.panoId])===null||Mn===void 0||Mn.setProgress(gn))},this.renderer):this.textureLoader.loadCubeTexture(an,{imageURL:{transform:tn,options:en},format:RGBAFormat,viaAjax:!0,fetcher:getFetcher(sr.work)},void 0,void 0,function(gn){var Cn,Mn;Fe.emit("pano.texture.progress",createEvent("pano.texture.progress",{error:null,progress:gn,meta:null,pano:sr.pano})),((Cn=Fe.pendingTextureTask)===null||Cn===void 0?void 0:Cn.hash)===hn&&((Mn=Fe.panoMeshes[sr.panoId])===null||Mn===void 0||Mn.setProgress(gn))},this.renderer),ln?this.tileLevelForFov&&cn&&cn.length?this.textureLoader.loadTiledCubeTexture(ln,cn,{tileMaxLevel:this.tiledCubeTextureLevel,imageURL:{transform:on,options:sn},minFilter:LinearFilter,magFilter:LinearFilter,generateMipmaps:!1,fetcher:getFetcher(sr.work)},void 0,void 0,void 0,this.renderer).catch(function(){return null}):this.textureLoader.loadCubeTexture(ln,{imageURL:{transform:on,options:sn},fetcher:getFetcher(sr.work)},void 0,void 0,void 0,this.renderer).catch(function(){return null}):Promise.resolve(null)]).then(function(gn){var Cn,Mn,Bn=gn[0],kn=gn[1];((Cn=Fe.pendingTextureTask)===null||Cn===void 0?void 0:Cn.hash)===hn?(Fe.pendingTextureTask.onLoad(Bn,kn),(Mn=Fe.panoMeshes[sr.panoId])===null||Mn===void 0||Mn.setProgress(0),delete Fe.pendingTextureTask,Fe.emit("pano.texture.success",createEvent("pano.texture.success",{error:null,progress:1,meta:Bn.meta,pano:sr.pano}))):(Bn.body.dispose(),kn?.body.dispose())}).catch(function(gn){var Cn,Mn;((Cn=Fe.pendingTextureTask)===null||Cn===void 0?void 0:Cn.hash)===hn&&(Fe.pendingTextureTask.onError(gn),(Mn=Fe.panoMeshes[sr.panoId])===null||Mn===void 0||Mn.setProgress(0),delete Fe.pendingTextureTask,Fe.emit("pano.texture.error",createEvent("pano.texture.error",{error:gn,progress:0,meta:null,pano:sr.pano})),Fe.emit("error",gn))}),this.emit("pano.texture.load",createEvent("pano.texture.load",{error:null,progress:0,meta:null,pano:sr.pano}))},Se.prototype.initAnimation=function(){var Be=this;return this.destroyed?Promise.resolve():new Promise(function(De){var Ve=Be.initial,Fe=Ve.duration,Je=Ve.effect,Xe=Ve.userAction;Be.userAction=Xe;var Ke=Se.initAnimationEndState(Be),Ye={workCode:Ke.workCode,panoIndex:Ke.panoIndex},or={modelAlpha:0},sr={perspToOrtho:0},cr=!1;Be.moveToPano(Ye,{longitude:Ke.longitude,latitude:Ke.latitude,fov:Ke.fov,effect:Je,duration:Fe,moveStartCallback:function(Br){cr=!0,Be.perspToOrthoMotion.set(sr,Fe).catch(noop$1),Be.modelAlphaMotion.setKeyframes([{progress:0,value:__assign({},Be.modelAlphaMotion.value)},{progress:.6,value:__assign({},Be.modelAlphaMotion.value)},{progress:1,value:or}],Fe).catch(noop$1),Be.emit("initAnimation.start",createEvent("initAnimation.start",{state:Br,userAction:Be.userAction}))},moveEndCallback:function(Br){Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:Br,userAction:Be.userAction})),Be.initAnimationed=!0,De()},moveCancelCallback:function(){var Br=__assign(__assign(__assign({},Ye),{mode:Be.mode}),clonePose(Be.camera.pose));cr===!1&&Be.emit("initAnimation.start",createEvent("initAnimation.start",{state:Br,userAction:Be.userAction})),Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:Br,userAction:Be.userAction})),Be.initAnimationed=!0,De()}},Xe)})},Se.prototype.panoResourceFromLocationMotionKeyframe=function(Be){return this.panoResources[Be.key]},Se.prototype.locationMotionKeyframesLength=function(Be){for(var De=0,Ve=1;Ve<Be.length;Ve++){var Fe=this.panoResourceFromLocationMotionKeyframe(Be[Ve-1]).position,Je=this.panoResourceFromLocationMotionKeyframe(Be[Ve]).position,Xe=Fe.distanceTo(Je)*(Be[Ve].value.count-Be[Ve-1].value.count);De+=Xe}return De},Se.prototype.updatePanoMeshes=function(){for(var Be=this,De={},Ve=Object.keys(this.panoMeshes),Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe],Ke=this.panoMeshes[Xe];De[Xe]=Ke,delete this.panoMeshes[Xe]}for(var Ye=1,or={},sr=function(hn){var mn=arrayMin(hn.accessibleIds,function(xn){var pn=Be.works.getResolvedObserver(xn);if(!pn)return 1/0;var dn=pn.standingPosition.distanceTo(hn.standingPosition);return clamp$1(dn,1,1/0)},!0),An=mn[1];or[hn.panoId]===void 0&&(or[hn.panoId]=An)},cr=0,Br=this.works.resolvedObservers;cr<Br.length;cr++){var tn=Br[cr];sr(tn)}var en=Object.keys(or).map(function(hn){return or[hn]});if(en.length){var an=en.reduce(function(hn,mn){return hn+mn},0)/en.length;Ye=clamp$1(an*.6,1,3)}for(var rn=0,on=this.works.resolvedObservers;rn<on.length;rn++){var tn=on[rn],Ke=void 0;De[tn.panoId]?(Ke=De[tn.panoId],Ke.loading===!0&&tn.loadable===!1&&Ke.setLoading(!1),delete De[tn.panoId]):(Ke=this.panoCircleMeshCreator(tn.pano),Ke.name="PanoCircleMesh_"+tn.panoId,this.helper.add(Ke)),Ke.scale.set(Ye,1,Ye),Ke.position.copy(tn.standingPosition),this.panoMeshes[tn.panoId]=Ke}for(var sn=0,ln=Object.keys(De);sn<ln.length;sn++){var cn=ln[sn];this.helper.remove(De[cn]),De[cn].dispose(),delete De[cn]}},Se.prototype.doMoveToPano=function(Be,De,Ve){var Fe=this,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an;Ve===void 0&&(Ve={});var rn=now$2(),on=createUuid();this.tiling.cleanup(),this.panoResources[on]=De;var sn=1,ln,cn,hn;if(this.locationMotion.ended){var mn=this.locationMotion.getKeyFrameSegment(rn);mn[0];var An=mn[1],xn=this.locationMotion.value,pn=((Je=this.panoResourceFromLocationMotionKeyframe(An))!==null&&Je!==void 0?Je:this.camera).position,dn=De.position;ln=Math.max(pn.distanceTo(dn),sn),cn=[{key:An.key,progress:0,value:__assign(__assign({},xn),{count:0})},{key:on,progress:1,value:{distance:0,count:1}}],hn=0}else{var fn=this.locationMotion.getKeyFrameSegment(rn),yn=fn[0],An=fn[1],xn=this.locationMotion.value,Sn=this.panoResourceFromLocationMotionKeyframe(yn).position,pn=this.panoResourceFromLocationMotionKeyframe(An).position,dn=De.position,gn=An.value.count-xn.count,Cn=Math.max(Sn.distanceTo(pn),sn)*gn,Mn=Math.max(pn.distanceTo(dn),sn);ln=Cn+Mn,cn=[{key:yn.key,progress:0,value:__assign({},xn)},{key:An.key,progress:Cn/ln,value:An.value},{key:on,progress:1,value:{count:An.value.count+1,distance:0}}];var Bn=this.locationMotionKeyframesLength(this.locationMotion.keyframes),kn=this.locationMotionKeyframesLength(cn);Bn===0||Bn===0?hn=0:hn=this.locationMotion.getProgressVelocity(rn)*Bn/kn}var Ln=De.effect==="instant"?0:this.calculateMovingDuration(Ve.duration,De.effect==="fly"?ln:0),Pn={longitude:Ve.longitude,latitude:Ve.latitude,fov:Ve.fov},Vn=__assign(__assign({},Be),{mode:this.mode,longitude:(Xe=Pn.longitude)!==null&&Xe!==void 0?Xe:this.camera.pose.longitude,latitude:(Ke=Pn.latitude)!==null&&Ke!==void 0?Ke:this.camera.pose.latitude,fov:(Ye=Pn.fov)!==null&&Ye!==void 0?Ye:this.camera.pose.fov,offset:De.position.clone(),distance:this.camera.pose.distance}),Yn=this.currentPano;if(this.emit("pano.moveTo",createEvent("pano.moveTo",{options:Ve,prevPano:Yn,progress:0,state:Vn,userAction:this.userAction,error:null})),Ve.moveStartCallback&&Ve.moveStartCallback(Vn),this.videoTexture&&this.videoTexture.image instanceof HTMLVideoElement&&this.videoTexture.image.getAttribute("src")&&(this.videoTexture.image.pause(),this.videoTexture.image.removeAttribute("uuid"),this.videoTexture.image.removeAttribute("src"),this.videoTexture.image.oncanplay=noop$1,this.videoTexture.needsUpdate=!0),this.panoVideo.setMaterial(null),De.effect==="fly")this.cameraMotion.set(Pn,Ln).catch(noop$1);else{var ni=coordinatesToVector({longitude:this.cameraMotion.value.longitude,latitude:this.cameraMotion.value.latitude}),Rn=coordinatesToVector({longitude:(or=Pn.longitude)!==null&&or!==void 0?or:this.cameraMotion.value.longitude,latitude:(sr=Pn.latitude)!==null&&sr!==void 0?sr:this.cameraMotion.value.latitude}),In=new Object3D;In.lookAt(ni);var Gn=new Matrix4().makeRotationFromQuaternion(In.quaternion);In.lookAt(Rn);var Fn=new Matrix4().makeRotationFromQuaternion(In.quaternion),Hn=new Matrix4().getInverse(Gn).premultiply(Fn),Dn=this.cameraMotion.value.fov,zn=(cr=Pn.fov)!==null&&cr!==void 0?cr:this.cameraMotion.value.fov,Qn=1;De.effect==="zoomin"?Qn=1.5:De.effect==="zoomout"&&(Qn=.4);for(var Zn=clamp$1(zn*Qn,1,170),si=0;si<cn.length-1;si++){var ei=cn[si].key;if(ei){var hi=this.panoResources[ei];hi&&(hi.fixCameraTransform.copy(Hn),hi.panoPicture&&(hi.panoPicture.zoom=Math.tan(Dn/2/180*Math.PI)/Math.tan(Zn/2/180*Math.PI)))}}this.cameraMotion.setKeyframes([{progress:0,value:{longitude:this.cameraMotion.value.longitude,latitude:this.cameraMotion.value.latitude,fov:this.cameraMotion.value.fov}},{progress:0,value:{longitude:(Br=Pn.longitude)!==null&&Br!==void 0?Br:this.cameraMotion.value.longitude,latitude:(tn=Pn.latitude)!==null&&tn!==void 0?tn:this.cameraMotion.value.latitude,fov:Zn}},{progress:1,value:{longitude:(en=Pn.longitude)!==null&&en!==void 0?en:this.cameraMotion.value.longitude,latitude:(an=Pn.latitude)!==null&&an!==void 0?an:this.cameraMotion.value.latitude,fov:zn}}],Ln).catch(noop$1)}var Un=this.locationMotion.setKeyframes(cn,Ln,hn);Un.then(function(){for(var Wn,Ai,oi=0,ci=Fe.models;oi<ci.length;oi++){var ai=ci[oi];ai.show()}var wi=__assign(__assign({},Be),{mode:Fe.mode,longitude:Fe.camera.pose.longitude,latitude:Fe.camera.pose.latitude,fov:Fe.camera.pose.fov,offset:Fe.camera.pose.offset.clone(),distance:Fe.camera.pose.distance});Fe.emit("pano.arrived",createEvent("pano.arrived",{options:Ve,prevPano:Yn,progress:1,state:wi,userAction:Fe.userAction,error:null})),Ve.moveEndCallback&&Ve.moveEndCallback(wi);var Pi=Fe.works.getResolvedObserver(Be);if(Pi&&Pi.video&&Fe.videoTexture&&Fe.videoTexture.image instanceof HTMLVideoElement){var Oi=ROTATE_Y_PI_MATRIX$1.clone().multiply((Ai=(Wn=Fe.models.getMaterial().pano1)===null||Wn===void 0?void 0:Wn.matrix)!==null&&Ai!==void 0?Ai:new Matrix4).multiply(Pi.video.matrix),Ri={map:Fe.videoTexture,size:Pi.video.size,matrix:Oi,alpha:1},_i=createUuid(),Mi=Fe.videoTexture.image;Mi.setAttribute("uuid",_i),canplayVideo().then(function($i){$i&&Pi.video&&Mi.getAttribute("uuid")===_i&&(Mi.oncanplay=function(){Mi.oncanplay=noop$1,Mi.play()},Mi.ontimeupdate=function(){Mi.currentTime>.5&&(Mi.ontimeupdate=noop$1,Fe.panoVideo.setMaterial(Ri))},Mi.src=Pi.video.source)}).catch(function(){Mi.removeAttribute("uuid")})}},function(){Fe.emit("pano.cancel",createEvent("pano.cancel",{options:Ve,prevPano:Yn,progress:0,state:Vn,userAction:Fe.userAction,error:null})),Ve.moveCancelCallback&&Ve.moveCancelCallback()})},Se.prototype.getForwardObserverOrNot=function(Be){var De=this,Ve=this.works.getResolvedObserver(this.currentPano);if(!Ve)return null;var Fe=Be??new Raycaster(this.camera.position.clone(),this.camera.getDirection(new Vector3));Fe.params.Points={threshold:.1};var Je=Ve.standingPosition.clone();if(Ve.position.distanceTo(Fe.ray.origin)>1){var Xe=this.models.intersectRaycaster(new Raycaster(Fe.ray.origin,new Vector3(0,-1,0)))[0];Xe&&Xe.distance<=2?Je.copy(Xe.point):Je.copy(Fe.ray.origin).add(new Vector3(0,-1.5,0))}var Ke=this.models.intersectRaycaster(Fe)[0],Ye=Ke?Ke.point:Fe.ray.origin.clone().add(Fe.ray.direction.clone().normalize().multiplyScalar(3)),or=Ye.clone().sub(Je).normalize();if(or.length()===0)return null;for(var sr=Ve.accessibleIds.filter(function(cn){if(cn===panoStringify(De.currentPano))return!1;var hn=De.works.getResolvedObserver(cn);if(!hn)return!1;var mn=hn.standingPosition.clone().project(De.camera);return Math.abs(mn.z)>1||Math.abs(mn.x)>1||Math.abs(mn.y)>1?!1:hn.loadable||hn.active}),cr=sr.slice().sort(function(cn,hn){var mn=De.works.getResolvedObserver(cn).standingPosition.clone().distanceTo(Je),An=De.works.getResolvedObserver(hn).standingPosition.clone().distanceTo(Je);return mn-An}),Br=0,tn=[Math.PI/8,Math.PI/6,Math.PI/4,Math.PI/3];Br<tn.length;Br++)for(var en=tn[Br],an=0,rn=cr;an<rn.length;an++){var on=rn[an],sn=this.works.getResolvedObserver(on);if(sn){var ln=sn.standingPosition.clone().sub(Je);if(ln&&ln.length()!==0&&or.angleTo(ln)<en)return sn}}return null},Se.prototype.onTapGesture=function(Be){var De=this,Ve;if(this.userAction=Be.userAction,this.stopMomentumMovement(),!!this.initAnimationed){if(!this.locationMotion.ended){var Fe=this.panoResourceFromLocationMotionKeyframe(this.locationMotion.keyframes[this.locationMotion.keyframes.length-1]);if(Fe.panoId!==panoStringify(this.currentPano))return}var Je=Be.center.raycaster,Xe=this.camera.getDirection(new Vector3).setY(0),Ke=null,Ye=this.works.getResolvedObserver(this.currentPano);if(Ye){var or=Ye.accessibleIds.filter(function(kn){if(kn===panoStringify(De.currentPano))return!1;var Ln=De.works.getResolvedObserver(kn);return!Ln||Ln.position.distanceTo(De.camera.position)>De.maxAccessibleDistance?!1:Ln.loadable||Ln.active}),sr=this.models.intersectRaycaster(Je)[0];if(sr){var cr=arrayMin(or,function(kn){var Ln=De.works.getResolvedObserver(kn);if(!Ln)return 1/0;var Pn=Ln.standingPosition.clone();return Pn.distanceTo(sr.point)},!0),Br=cr[0],tn=cr[1];Br&&tn<this.panoTapTriggerRadius&&(Ke=(Ve=this.works.getResolvedObserver(Br))!==null&&Ve!==void 0?Ve:null)}Ke||(Ke=this.getForwardObserverOrNot(Je));for(var en=0,an=this.locationMotion.keyframes;en<an.length;en++){var rn=an[en],on=this.panoResourceFromLocationMotionKeyframe(rn);if(!(rn.progress<this.locationMotion.progress)&&Ke&&on.panoId===Ke.panoId){Ke=null;break}}if(!Ke)this.emit("gesture.tap",Be),Be.defaultPrevented||this.locationMotion.ended===!0&&this.cameraBounce();else{for(var sn={},ln=Math.PI/6,cn=Math.PI/12,hn=Ke.position.clone().setY(0).sub(Ye.position.clone().setY(0)).normalize(),mn=[],An=[],xn=[],pn=0,dn=Ke.accessibleIds;pn<dn.length;pn++){var Br=dn[pn],fn=panoParse(Br);if(!(panoEqual(fn,this.currentPano)||panoEqual(fn,Ke.pano))){var yn=this.works.getResolvedObserver(Br);if(yn){var Sn=yn.position.clone().sub(Ke.position).setY(0);hn.angleTo(Sn)<ln&&xn.push(Sn)}}}var gn=xn.length>0?xn:__spreadArray(__spreadArray([],mn,!0),An,!0),Cn=gn.slice().sort(function(kn,Ln){return kn.angleTo(hn)-Ln.angleTo(hn)})[0];Cn&&Cn.angleTo(Xe)>cn&&(sn.longitude=Math.atan2(-Cn.x,-Cn.z)),this.cameraMotion.value.latitude<-Math.PI/4&&(sn.latitude=clamp$1(0,this.minLatitude,this.maxLatitude));var Mn=__assign({},Be.state);if(Mn.workCode=Ke.pano.workCode,Mn.panoIndex=Ke.pano.panoIndex,sn.longitude!==void 0&&(Mn.longitude=sn.longitude),sn.latitude!==void 0&&(Mn.latitude=sn.latitude),sn.fov!==void 0&&(Mn.fov=sn.fov),Mn.distance=0,Mn.offset=Ke.position.clone(),Be.state=Mn,this.emit("gesture.tap",Be),!Be.defaultPrevented){if(this.emit("pano.select",createEvent("pano.select",{prevPano:this.currentPano,state:Mn,userAction:Be.userAction,options:sn,progress:0,error:null})),Ke&&!Ke.active){var Bn=Ke.panoId;this.panoMeshes[Bn]&&(this.panoMeshes[Bn].setDisabled(!1),this.panoMeshes[Bn].setLoading(!0))}Ke&&Ke.active&&this.emit("pano.request",createEvent("pano.request",{userAction:Be.userAction,prevPano:this.currentPano,progress:0,state:Mn,options:sn,error:null}))}}}}},Se}(PanoramaLikeController),DEG_TO_RAD=Math.PI/180,RAD_TO_DEG=180/Math.PI,MIN_TIMESTEP=.001,MAX_TIMESTEP=1,isIOS$1=function(){var $e=typeof navigator<"u"&&/iPad|iPhone|iPod/.test(navigator.platform);return function(){return $e}}(),isSafari$1=function(){var $e=typeof navigator<"u"&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return $e}}(),isFirefoxAndroid=function(){var $e=typeof navigator<"u"&&navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return $e}}(),getChromeVersion=function(){var $e=typeof navigator<"u"?navigator.userAgent.match(/.*Chrome\/([0-9]+)/):null,Se=$e?parseInt($e[1],10):null;return function(){return Se}}(),isChromeWithoutDeviceMotion=function(){var $e=!1;if(getChromeVersion()===65){var Se=typeof navigator<"u"?navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/):null;if(Se){var Be=Se[1].split(".");Be[0],Be[1];var De=Be[2],Ve=Be[3];$e=parseInt(De,10)===3325&&parseInt(Ve,10)<148}}return function(){return $e}}(),isSafariWithoutDeviceMotion=function(){var $e=isIOS$1()&&isSafari$1()&&typeof navigator<"u"&&navigator.userAgent.indexOf("13_4")!==-1;return function(){return $e}}(),isR7=function(){var $e=typeof navigator<"u"&&navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return $e}}();function isLandscapeMode(){var $e=typeof window<"u"&&(window.orientation==90||window.orientation==-90);return isR7()?!$e:$e}function isTimestampDeltaValid($e){return!(isNaN($e)||$e<=MIN_TIMESTEP||$e>MAX_TIMESTEP)}function getQuaternionAngle($e){if($e.w>1)return 0;var Se=2*Math.acos($e.w);return Se}var warnOnce=function(){var $e={};return function(Se,Be){$e[Se]===void 0&&(console.warn("cardboard: "+Be),$e[Se]=!0)}}();function getOriginFromUrl($e){var Se,Be=$e.indexOf("://");Be!==-1?Se=Be+3:Se=0;var De=$e.indexOf("/",Se);return De===-1&&(De=$e.length),$e.substring(0,De)}function isInsideCrossOriginIFrame(){if(typeof window>"u"||typeof document>"u")return!1;var $e=window.self!==window.top,Se=getOriginFromUrl(document.referrer),Be=getOriginFromUrl(window.location.href);return $e&&Se!==Be}var updateEyeViewMatrices=function(){function $e(De,Ve,Fe){var Je=Ve?Ve[0]:0,Xe=Ve?Ve[1]:0,Ke=Ve?Ve[2]:0,Ye=Ve?Ve[3]:1,or=Je+Je,sr=Xe+Xe,cr=Ke+Ke,Br=Je*or,tn=Je*sr,en=Je*cr,an=Xe*sr,rn=Xe*cr,on=Ke*cr,sn=Ye*or,ln=Ye*sr,cn=Ye*cr;return De[0]=1-(an+on),De[1]=tn+cn,De[2]=en-ln,De[3]=0,De[4]=tn-cn,De[5]=1-(Br+on),De[6]=rn+sn,De[7]=0,De[8]=en+ln,De[9]=rn-sn,De[10]=1-(Br+an),De[11]=0,De[12]=0,De[13]=0,De[14]=0,De[15]=1,De}function Se(De,Ve,Fe){var Je=Fe[0],Xe=Fe[1],Ke=Fe[2],Ye,or,sr,cr,Br,tn,en,an,rn,on,sn,ln;return Ve===De?(De[12]=Ve[0]*Je+Ve[4]*Xe+Ve[8]*Ke+Ve[12],De[13]=Ve[1]*Je+Ve[5]*Xe+Ve[9]*Ke+Ve[13],De[14]=Ve[2]*Je+Ve[6]*Xe+Ve[10]*Ke+Ve[14],De[15]=Ve[3]*Je+Ve[7]*Xe+Ve[11]*Ke+Ve[15]):(Ye=Ve[0],or=Ve[1],sr=Ve[2],cr=Ve[3],Br=Ve[4],tn=Ve[5],en=Ve[6],an=Ve[7],rn=Ve[8],on=Ve[9],sn=Ve[10],ln=Ve[11],De[0]=Ye,De[1]=or,De[2]=sr,De[3]=cr,De[4]=Br,De[5]=tn,De[6]=en,De[7]=an,De[8]=rn,De[9]=on,De[10]=sn,De[11]=ln,De[12]=Ye*Je+Br*Xe+rn*Ke+Ve[12],De[13]=or*Je+tn*Xe+on*Ke+Ve[13],De[14]=sr*Je+en*Xe+sn*Ke+Ve[14],De[15]=cr*Je+an*Xe+ln*Ke+Ve[15]),De}function Be(De,Ve){var Fe=Ve[0],Je=Ve[1],Xe=Ve[2],Ke=Ve[3],Ye=Ve[4],or=Ve[5],sr=Ve[6],cr=Ve[7],Br=Ve[8],tn=Ve[9],en=Ve[10],an=Ve[11],rn=Ve[12],on=Ve[13],sn=Ve[14],ln=Ve[15],cn=Fe*or-Je*Ye,hn=Fe*sr-Xe*Ye,mn=Fe*cr-Ke*Ye,An=Je*sr-Xe*or,xn=Je*cr-Ke*or,pn=Xe*cr-Ke*sr,dn=Br*on-tn*rn,fn=Br*sn-en*rn,yn=Br*ln-an*rn,Sn=tn*sn-en*on,gn=tn*ln-an*on,Cn=en*ln-an*sn,Mn=cn*Cn-hn*gn+mn*Sn+An*yn-xn*fn+pn*dn;return Mn?(Mn=1/Mn,De[0]=(or*Cn-sr*gn+cr*Sn)*Mn,De[1]=(Xe*gn-Je*Cn-Ke*Sn)*Mn,De[2]=(on*pn-sn*xn+ln*An)*Mn,De[3]=(en*xn-tn*pn-an*An)*Mn,De[4]=(sr*yn-Ye*Cn-cr*fn)*Mn,De[5]=(Fe*Cn-Xe*yn+Ke*fn)*Mn,De[6]=(sn*mn-rn*pn-ln*hn)*Mn,De[7]=(Br*pn-en*mn+an*hn)*Mn,De[8]=(Ye*gn-or*yn+cr*dn)*Mn,De[9]=(Je*yn-Fe*gn-Ke*dn)*Mn,De[10]=(rn*xn-on*mn+ln*cn)*Mn,De[11]=(tn*mn-Br*xn-an*cn)*Mn,De[12]=(or*fn-Ye*Sn-sr*dn)*Mn,De[13]=(Fe*Sn-Je*fn+Xe*dn)*Mn,De[14]=(on*hn-rn*An-sn*cn)*Mn,De[15]=(Br*An-tn*hn+en*cn)*Mn,De):null}return function(De,Ve,Fe){$e(De,Ve),Fe&&Se(De,De,Fe),Be(De,De)}}(),SensorSample=function(){function $e(Se,Be){Se===void 0&&(Se=new Vector3),Be===void 0&&(Be=0),this.sample=Se,this.timestampS=Be}return $e.prototype.set=function(Se,Be){this.sample=Se,this.timestampS=Be},$e.prototype.copy=function(Se){this.set(Se.sample,Se.timestampS)},$e}(),ComplementaryFilter=function(){function $e(Se,Be){this.kFilter=Se,this.isDebug=Be,this.currentAccelMeasurement=new SensorSample,this.currentGyroMeasurement=new SensorSample,this.previousGyroMeasurement=new SensorSample,isIOS$1()?this.filterQ=new Quaternion(-1,0,0,1):this.filterQ=new Quaternion(1,0,0,1),this.previousFilterQ=new Quaternion,this.previousFilterQ.copy(this.filterQ),this.accelQ=new Quaternion,this.isOrientationInitialized=!1,this.estimatedGravity=new Vector3,this.measuredGravity=new Vector3,this.gyroIntegralQ=new Quaternion}return $e.prototype.addAccelMeasurement=function(Se,Be){this.currentAccelMeasurement.set(Se,Be)},$e.prototype.addGyroMeasurement=function(Se,Be){this.currentGyroMeasurement.set(Se,Be);var De=Be-this.previousGyroMeasurement.timestampS;isTimestampDeltaValid(De)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},$e.prototype.getOrientation=function(){return this.filterQ},$e.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var Se=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,Be=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,Se);this.gyroIntegralQ.multiply(Be),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(Be);var De=new Quaternion;De.copy(this.filterQ),De.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(De),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var Ve=new Quaternion;Ve.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),Ve.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",RAD_TO_DEG*getQuaternionAngle(Ve),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var Fe=new Quaternion;Fe.copy(this.filterQ),Fe.multiply(Ve),this.filterQ.slerp(Fe,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},$e.prototype.accelToQuaternion_=function(Se){var Be=new Vector3;Be.copy(Se),Be.normalize();var De=new Quaternion;return De.setFromUnitVectors(new Vector3(0,0,-1),Be),De.inverse(),De},$e.prototype.gyroToQuaternionDelta_=function(Se,Be){var De=new Quaternion,Ve=new Vector3;return Ve.copy(Se),Ve.normalize(),De.setFromAxisAngle(Ve,Se.length()*Be),De},$e}(),PosePredictor=function(){function $e(Se,Be){this.predictionTimeS=Se,this.isDebug=Be,this.previousQ=new Quaternion,this.previousTimestampS=null,this.deltaQ=new Quaternion,this.outQ=new Quaternion}return $e.prototype.getPrediction=function(Se,Be,De){if(!this.previousTimestampS)return this.previousQ.copy(Se),this.previousTimestampS=De,Se;var Ve=new Vector3;Ve.copy(Be),Ve.normalize();var Fe=Be.length();if(Fe<DEG_TO_RAD*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(RAD_TO_DEG*Fe).toFixed(1)),this.outQ.copy(Se),this.previousQ.copy(Se),this.outQ;var Je=Fe*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(Ve,Je),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(Se),this.previousTimestampS=De,this.outQ},$e}(),Distortion=function(){function $e(Se){this.coefficients=Se}return $e.prototype.distortInverse=function(Se){for(var Be=0,De=1,Ve=Se-this.distort(Be);Math.abs(De-Be)>1e-4;){var Fe=Se-this.distort(De),Je=De-Fe*((De-Be)/(Fe-Ve));Be=De,De=Je,Ve=Fe}return De},$e.prototype.distort=function(Se){for(var Be=Se*Se,De=0,Ve=0;Ve<this.coefficients.length;Ve++)De=Be*(De+this.coefficients[Ve]);return(De+1)*Se},$e}(),Pose=function(){function $e(){this.angularAcceleration=null,this.angularVelocity=null,this.linearAcceleration=null,this.linearVelocity=null,this.orientation=null,this.position=null}return $e}(),FieldOfView=function(){function $e(){this.leftDegrees=0,this.rightDegrees=0,this.upDegrees=0,this.downDegrees=0}return $e}(),Sensor=function(){function $e(Se,Be,De,Ve){this.viewer={id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]},this.device={widthMeters:.11,heightMeters:.062,bevelMeters:.004},this.depthNear=.01,this.depthFar=1e4,this.yawOnly=De,this.accelerometer=new Vector3,this.gyroscope=new Vector3,this.filter=new ComplementaryFilter(Se,Ve),this.posePredictor=new PosePredictor(Be,Ve),this.isFirefoxAndroid=isFirefoxAndroid(),this.isIOS=isIOS$1();var Fe=getChromeVersion();this.isDeviceMotionInRadians=!this.isIOS&&Fe!==null&&Fe<66,this.isWithoutDeviceMotion=isChromeWithoutDeviceMotion()||isSafariWithoutDeviceMotion(),this.filterToWorldQ=new Quaternion,isIOS$1()?this.filterToWorldQ.setFromAxisAngle(new Vector3(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new Vector3(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new Quaternion,this.worldToScreenQ=new Quaternion,this.originalPoseAdjustQ=new Quaternion;var Je=typeof window<"u"?-window.orientation*Math.PI/180:0;this.originalPoseAdjustQ.setFromAxisAngle(new Vector3(0,0,1),Je),this.setScreenTransform_(),isLandscapeMode()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new Quaternion,this.orientationOut_=new Float32Array(4),this.previousTimestampS=Date.now()}return $e.prototype.getPosition=function(){return null},$e.prototype.getOrientation=function(){var Se;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var Fe=new Quaternion().setFromAxisAngle(new Vector3(0,0,-1),0),Je=new Quaternion;return typeof window<"u"&&window.orientation===-90?Je.setFromAxisAngle(new Vector3(0,1,0),Math.PI/-2):Je.setFromAxisAngle(new Vector3(0,1,0),Math.PI/2),Fe.multiply(Je)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var Fe=new Quaternion;return Fe.setFromAxisAngle(new Vector3(1,0,0),-Math.PI/2),Fe}(),Se=this._deviceOrientationQ;var Be=new Quaternion;return Be.copy(Se),Be.multiply(this.deviceOrientationFilterToWorldQ),Be.multiply(this.resetQ),Be.multiply(this.worldToScreenQ),Be.multiplyQuaternions(this.deviceOrientationFixQ,Be),this.yawOnly&&(Be.x=0,Be.z=0,Be.normalize()),this.orientationOut_[0]=Be.x,this.orientationOut_[1]=Be.y,this.orientationOut_[2]=Be.z,this.orientationOut_[3]=Be.w,this.orientationOut_}else{var De=this.filter.getOrientation();Se=this.posePredictor.getPrediction(De,this.gyroscope,this.previousTimestampS)}var Ve=new Quaternion;return Ve.copy(this.filterToWorldQ),Ve.multiply(this.resetQ),Ve.multiply(Se),Ve.multiply(this.worldToScreenQ),this.yawOnly&&(Ve.x=0,Ve.z=0,Ve.normalize()),this.orientationOut_[0]=Ve.x,this.orientationOut_[1]=Ve.y,this.orientationOut_[2]=Ve.z,this.orientationOut_[3]=Ve.w,this.orientationOut_},$e.prototype.getPose=function(){var Se=new Pose;return Se.orientation=this.getOrientation(),Se},$e.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),isLandscapeMode()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},$e.prototype.getFrameData=function(Se){var Be=this.getOrientation(),De=this.getEyeOffset(),Ve=this.getEyeProjectionMatrix();return Se.pose.angularAcceleration=null,Se.pose.angularVelocity=null,Se.pose.linearAcceleration=null,Se.pose.linearVelocity=null,Se.pose.orientation=Be,Se.pose.position=null,Se.timestamp=this.previousTimestampS,Se.leftProjectionMatrix.set(Ve.left),Se.rightProjectionMatrix.set(Ve.right),updateEyeViewMatrices(Se.leftViewMatrix,Be,De.left),updateEyeViewMatrices(Se.rightViewMatrix,Be,De.right),Se},$e.prototype.start=function(){if(typeof window>"u")return function(){};var Se=this.onDeviceMotion_.bind(this),Be=this.onOrientationChange_.bind(this),De=this.onMessage_.bind(this),Ve=this.onDeviceOrientation_.bind(this);return isIOS$1()&&isInsideCrossOriginIFrame()&&window.addEventListener("message",De),window.addEventListener("orientationchange",Be),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",Ve):window.addEventListener("devicemotion",Se),function(){window.removeEventListener("devicemotion",Se),window.removeEventListener("deviceorientation",Be),window.removeEventListener("orientationchange",Be),window.removeEventListener("message",De)}},$e.prototype.getEyeOffset=function(){return{left:[-this.viewer.interLensDistance*.5,0,0],right:[this.viewer.interLensDistance*.5,0,0]}},$e.prototype.getEyeProjectionMatrix=function(){var Se=this.getEyeFieldOfView(),Be=this.depthNear,De=this.depthFar,Ve={left:[],right:[]};{var Fe=Se.left.upDegrees*DEG_TO_RAD,Je=Se.left.downDegrees*DEG_TO_RAD,Xe=Se.left.leftDegrees*DEG_TO_RAD,Ke=Se.left.rightDegrees*DEG_TO_RAD,Ye=2/(Xe+Ke),or=2/(Fe+Je);Ve.left[0]=Ye,Ve.left[1]=0,Ve.left[2]=0,Ve.left[3]=0,Ve.left[4]=0,Ve.left[5]=or,Ve.left[6]=0,Ve.left[7]=0,Ve.left[8]=-((Xe-Ke)*Ye*.5),Ve.left[9]=(Fe-Je)*or*.5,Ve.left[10]=De/(Be-De),Ve.left[11]=-1,Ve.left[12]=0,Ve.left[13]=0,Ve.left[14]=De*Be/(Be-De),Ve.left[15]=0}{var Fe=Se.right.upDegrees*DEG_TO_RAD,Je=Se.right.downDegrees*DEG_TO_RAD,Xe=Se.right.leftDegrees*DEG_TO_RAD,Ke=Se.right.rightDegrees*DEG_TO_RAD,Ye=2/(Xe+Ke),or=2/(Fe+Je);Ve.right[0]=Ye,Ve.right[1]=0,Ve.right[2]=0,Ve.right[3]=0,Ve.right[4]=0,Ve.right[5]=or,Ve.right[6]=0,Ve.right[7]=0,Ve.right[8]=-((Xe-Ke)*Ye*.5),Ve.right[9]=(Fe-Je)*or*.5,Ve.right[10]=De/(Be-De),Ve.right[11]=-1,Ve.right[12]=0,Ve.right[13]=0,Ve.right[14]=De*Be/(Be-De),Ve.right[15]=0}return Ve},$e.prototype.getEyeFieldOfView=function(){var Se=this.viewer,Be=this.device,De=new Distortion(Se.distortionCoefficients),Ve=Se.screenLensDistance,Fe=(Be.widthMeters-Se.interLensDistance)/2,Je=Se.interLensDistance/2,Xe=Se.baselineLensDistance-Be.bevelMeters,Ke=Be.heightMeters-Xe,Ye=RAD_TO_DEG*Math.atan(De.distort(Fe/Ve)),or=RAD_TO_DEG*Math.atan(De.distort(Je/Ve)),sr=RAD_TO_DEG*Math.atan(De.distort(Xe/Ve)),cr=RAD_TO_DEG*Math.atan(De.distort(Ke/Ve)),Br=new FieldOfView,tn=new FieldOfView;return Br.leftDegrees=Math.min(Ye,Se.fov),Br.rightDegrees=Math.min(or,Se.fov),Br.downDegrees=Math.min(sr,Se.fov),Br.upDegrees=Math.min(cr,Se.fov),tn.leftDegrees=Br.rightDegrees,tn.rightDegrees=Br.leftDegrees,tn.upDegrees=Br.upDegrees,tn.downDegrees=Br.downDegrees,{left:Br,right:tn}},$e.prototype.onDeviceOrientation_=function(Se){this._deviceOrientationQ=this._deviceOrientationQ||new Quaternion;var Be=Se.alpha,De=Se.beta,Ve=Se.gamma;Be=(Be||0)*Math.PI/180,De=(De||0)*Math.PI/180,Ve=(Ve||0)*Math.PI/180,this._deviceOrientationQ.setFromEuler(new Euler(Be,De,-Ve,"YXZ"))},$e.prototype.onDeviceMotion_=function(Se){this.updateDeviceMotion_(Se)},$e.prototype.updateDeviceMotion_=function(Se){var Be=Se.accelerationIncludingGravity,De=Se.rotationRate,Ve=Se.timeStamp/1e3,Fe=Ve-this.previousTimestampS;if(Fe<0){warnOnce("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=Ve;return}else if(Fe<=MIN_TIMESTEP||Fe>MAX_TIMESTEP){warnOnce("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=Ve;return}Be&&(this.accelerometer.set(-Be.x,-Be.y,-Be.z),De&&(isR7()?this.gyroscope.set(-De.beta,De.alpha,De.gamma):this.gyroscope.set(De.alpha,De.beta,De.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,Ve)),this.filter.addAccelMeasurement(this.accelerometer,Ve)),this.previousTimestampS=Ve},$e.prototype.onOrientationChange_=function(){this.setScreenTransform_()},$e.prototype.onMessage_=function(Se){var Be=Se.data;if(!(!Be||!Be.type)){var De=Be.type.toLowerCase();De==="devicemotion"&&this.updateDeviceMotion_(Be.deviceMotionEvent)}},$e.prototype.setScreenTransform_=function(){this.worldToScreenQ.set(0,0,0,1);var Se=typeof window<"u"?window.orientation:0;switch(Se){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new Vector3(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new Vector3(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},$e}(),defaultLeftBounds=[0,0,.5,1],defaultRightBounds=[.5,0,.5,1],Cardboard=function(){function $e(Se){var Be=this;this.renderer=Se,this.sensor=new Sensor(.98,.04,!1,!1),this.scale=1,this.cameraL=new PerspectiveCamera,this.cameraR=new PerspectiveCamera;var De=this.sensor.start();this.dispose=function(){var Ve=Be.renderer.getSize(new Vector2);Be.renderer.setScissor(0,0,Ve.width,Ve.height),Be.renderer.setViewport(0,0,Ve.width,Ve.height),Be.renderer.setScissorTest(!1),De()}}return $e.prototype.render=function(Se,Be){var De=this.renderer.getSize(new Vector2);if(De.width>De.height){var Ve=Se.autoUpdate;Ve&&(Se.updateMatrixWorld(),Se.autoUpdate=!1);var Fe={x:Math.round(De.width*defaultLeftBounds[0]),y:Math.round(De.height*defaultLeftBounds[1]),width:Math.round(De.width*defaultLeftBounds[2]),height:Math.round(De.height*defaultLeftBounds[3])},Je={x:Math.round(De.width*defaultRightBounds[0]),y:Math.round(De.height*defaultRightBounds[1]),width:Math.round(De.width*defaultRightBounds[2]),height:Math.round(De.height*defaultRightBounds[3])};this.renderer.setScissorTest(!0),this.renderer.autoClear&&this.renderer.clear(),Be.parent===null&&Be.updateMatrixWorld(),Be.matrixWorld.decompose(this.cameraL.position,this.cameraL.quaternion,this.cameraL.scale),Be.matrixWorld.decompose(this.cameraR.position,this.cameraR.quaternion,this.cameraR.scale);var Xe=this.sensor.getEyeOffset();this.cameraL.translateOnAxis(new Vector3().fromArray(Xe.left),this.scale),this.cameraR.translateOnAxis(new Vector3().fromArray(Xe.right),this.scale);var Ke=this.sensor.getEyeProjectionMatrix();this.cameraL.projectionMatrix.elements=Ke.left.slice(),this.cameraR.projectionMatrix.elements=Ke.right.slice(),this.renderer.setViewport(Fe.x,Fe.y,Fe.width,Fe.height),this.renderer.setScissor(Fe.x,Fe.y,Fe.width,Fe.height),this.renderer.render(Se,this.cameraL),this.renderer.setViewport(Je.x,Je.y,Je.width,Je.height),this.renderer.setScissor(Je.x,Je.y,Je.width,Je.height),this.renderer.render(Se,this.cameraR),this.renderer.setViewport(0,0,De.width,De.height),this.renderer.setScissor(0,0,De.width,De.height),this.renderer.setScissorTest(!1),Ve&&(Se.autoUpdate=!0)}else this.renderer.render(Se,Be)},$e.prototype.dispose=function(){},$e}();const cardboard="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAADqCAMAAAAvZYhaAAAC/VBMVEUAAAD///99fX37+/v5+fn29vbx8fHv7+/Nzc3o6Ojq6urh4eHU1NTR0dGDg4Pl5eWSkpLHx8fj4+Pe3t7X19fAwMDZ2dnCwsKrq6uioqLb29uNjY2enp67u7t5eXmAgIC2traWlpa5ubnKysqmpqZycnKHh4eurq6ysrKKioqDg4Pd3d12dnb9/f1vb2/s7OxlZWXz8/OoqKiZmZlpaWmbm5teXl7W1tbJycnExMRiYmJsbGywsLCPj49aWlq9vb1UVFRYWFhra2t+fn7t7e1RUVFOTk6Dg4OAgICCgoKKioqEhISIiIhqamqCgoKIiIiQkJCIiIiWlpawsLBmZmaAgICenp6Li4uBgYGTk5OMjIyVlZWFhYWCgoKvr6+Ojo59fX2SkpKvr6+Ojo6QkJCurq6BgYGxsbF8fHx4eHitra2enp6srKyJiYmurq54eHj5+fl+fn57e3v////5+fnS0tLAwMCVlZWwsLCurq5QUFCtra2EhISUlJSwsLCUlJSUlJSlpaWVlZW3t7diYmLAwMCFhYV3d3f///+tra3///9XV1eampqnp6d8fHz///////9VVVVlZWVtbW3+/v5SUlKcnJytra28vLzGxsbR0dHX19doaGiWlpafn5/Hx8ezs7Nzc3Nubm7AwMCIiIjj4+NTU1P29vZbW1vl5eVkZGTMzMxYWFjq6upfX1/k5OT////4+PjV1dWkpKRoaGj4+Pizs7Pm5ubAwMCfn5+vr6+urq4wMDCxsbG2tra5ubliYmIuLi6zs7NHR0empqY0NDRCQkKqqqo5OTmoqKg7OztfX19dXV1oaGikpKRkZGStra0hISE/Pz89PT0pKSlmZmZJSUlERERbW1s2NjZVVVUmJia7u7uEhIRXV1dZWVlLS0tOTk6srKxqamojIyNTU1MrKyuAgICCgoJRUVFra2ttbW13d3dxcXFvb299fX1zc3N2dnZ5eXl8fHyHh4eSkpKenp6Ojo6VlZWMjIyYmJihoaGcnJyJiYmamprZ2YdEAAAAunRSTlMAs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7P9s7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Oz+QSzswb9DiH3FyI57Jn1ajgu7uHYmIgr8OHHwqVOQybv6OZuUvTt3dHPrIeFSNVgLCAWD9/UqKebiH1iXVTczcvKvambhnBuY/vGrKqjlHlzVDj37s/Fw7+tpJGAeN7VzcWTgGJNQ8O9u7iko5aVjvbNsa+so1pd3mNGAAAqAElEQVR42uzZzWvTYBwH8DxNmvRlfVNr17Wl05a9dISyiugO4qVQ2g1pVyx2Q7QKCoIivgxF1HnTXbbDDnNDJ8iQHcQX8O3We1t6GnjJyYPSuTmdf4C/ZE260U5rl6bJ2g8Pu2zP5cvz++ZJhilOcOxcfPHq/NuFhVcftK8WXizeCGItFWKKX5x/23Zk3/6OPr1+j0mr1fkpkuxXv5luBbbZWPzevEWjMRja2iCrvXs3stJRFGRFEDhOT1xv5QWCkYvPPtosFg+XFZyrvSYdRUJEBA4Igg2LRuBhk+cVOndv3uWyWm0DlqMajWafXkcSNNrexA2sSQ1dvPK+86DruNUGWRn6dGoa/dvk9BjWbMLxZ7e7e3ogK5fVZtBTOKrew6Y6Xufu3Qm0d3f3dEJWGj1Fo/81dbU52isUf2T3etvZrHoG9vtxVKOJm9guF049ddrt3gBkdVCzh0DlWtO4YejT00OHnU44VwHXPgqJ4PV1bFeKDD8xH4Cs7PaAtY9AYpncfeUFSR0zc1l5B/Q4EhW9q+KCpHodXFYBjxZxWnFtk9SZrl4uK6/Hj+pmWvlxDQ2fMRq7eh0OSIpCW7Ti2iJ8/4zK7WazcloqJtUaxqLweFSl4rI6ZNOhylpxsUKpqFsF3EazS4ukNLmIKcuJpFHF6erUI8lNKeiaGrl7WcUxtu+nUUO8VsZLEDz8VBy33YCjxnko+1dsrtI5hz1q1GATcm76YCrpVnHMVgrJgWwfjCN3u1Sc3k4TkgtZNv3QcLHS3Wyly4ncqis8/qSYlFNDINl5IZ9ZDKaifFHZSCRLkzKZxZEkX1QHtUi+ZDCLQlEZ2/uQzDX2c0T4vjzuntWaatiVPiQU1YEBoahoRMNCNRBzv9zuqCNJo1BUdGU4jcOiqyDhfgmLvryoOnClkfRwhcehqDh2A4ErkGTNBa9+paLClUqSK2rkrnCjMhFK9mYMqy+4Jwhf8wjlIWcvjcYGGYbxxUZvmd6V93w9XmicHpJQmD0zifM+ZovYzFWsjMifiB0urVpRyMeJmI+pyBnCxBcaF8avQ60kL58nYkyJ78f3leUvXwqrP9e/MqzBCCaykWRp/NTKQT0fHfzN8L79WlteSm9S+MUdt2t16XR4+vVXTd2vhtVfRrL9cw9ijGB9rZDOgPRm+XxunQGnRD9Ubm8bqRgvZ0Z9woFaX81lNqQzW7MCKwy4IE5T8YfKbNWRSmG6FCtN3upSNpspKosKLBXY6jorxuPPyF+pSKWYezDIFP1YyWXYpLJlSeWFqNi0fFD7O235VFTFOWbVUjUiKRIWBaTZP5vgk/r2vZDOgkylAczD4tMCy5DW6R2V+vBlvqkohZhN8DX1dY09UkJW5b0uJMXJ/dzRIEaKpe5wmShlmEv4hOHLf84WlU8gEKLi5Zagtk5itTkR5f/trvNvj/JTsKr4Xf3366GnhKSy2WJWmZJKpypfDCoHVmHriZpu6hvzZ+zu0HH8kBj8+KvKfyfN/j/UnclvG1UcxxGnhGxKaVIIioBEosi9gVAaCSkHkFhFgAOrBEIgDixCnOAAAgmVG1cEZ7jxHzi2YzvYcWyP3cRNY6e1J2sdJ7bjbLXTLOL73rzFz88TGqip+cyLZ+kMJB++v988jwN0fSJMFb1JIFxxXXq3kq4wCIjWw/+gVT3G6+++/wOtP7wmMuUVooASqtmNQim/6djd36tUyuX9o930WnZrXagCJdwQnz3lc+JvrVb16MXW+/4P/PaRg3X0AstUUm1WRil7VIn5xzkeD74EU4fl3c0CVC0bG/iLvHi6rs7vf60ncR9E4kXbVvcbf724+a2VZpMUdCuhysgfHS5xR1KVR+dyZQdvrNdOdT9851X+IWnr/wDR0h15I2kmuSwK8eQetwG+dGP+4200rW9Oq+r8/a3NT9cPH/K3x+tRSJKx8haObvqvXx8fx8CLrokOLBp/7q69daq5An5BtrWL0trVitHFkcea4M9/FY2qGBGhQreKFNI3x68TdFXSGIaO3+P3e6a+vK1Uvc+ev7R1NT1i7pktxU3AVEU2HIee64JxDCy1lrgqrBVV3Ne7r/ztZMFq6w+NtHWdUeg604Vhu62f2/Dr277m8wQ0KqkqvnkMUSo2uWKFWKvKTxaMy1+c7Oq7Tuu9ctuZZucX/mnD5kbUpCSBkT6AG00VXNkJ0/BzYeCxk2L1Ki3AnjNtZzDaFGqPnXROw6//46vnHWmHNaMyhari/iS86EAThgYNVd0ZBM0V5U37mdXnZF51/kJbc9Mr5wmzTJSZjG7tuXVTateyK0U9WXR1oq0PHiaz9fa25kY0qp31ZIaHKn8LEYEOLDpSVI0w2dv5SvoS/F5/wkBcPYH/Is791WC3DcNuXz+3oddXzxMyXFUBmQJWZ1Kxb1oeeVPUVPF82dt6Ea4e7r+/iRnCPIG6Wit5M1zV+v6YNMDE6NiUIPmqh99aGPrs9OXH4GoY39KF+y9o4KB+XD8HNOz6vs9ek40qg4Vg7E5JUdZig83NUE7h9ZuhYLJ2vvUs6e0DfVVc6LtAwErsY9gepzTs+l8/WuPzhCQyRWPlzR6M12Bri/4Rhh6setGCKMXWz8/VzK/g6nxfczLE737ZQiQDiKpoibZ0NVeQYhcs20Kki4rfGsQY0G+JL6BhPdnX19vXS8BKbst9sVaQ5zTm+h9G0w5HGsvWbIZhzh45x+tio4pmyq4SdagqDI7br3zq+jYaVktv8/HHG8+z8ltPilBt36Sh0pNFZdzmNMvjnIzdPK5Ubh0fHsRik6oq4Fei9XP1nRBF+EDvWYXes70YyrZyTDt+56/HM2KaKtz95rkqY99pdWUdmyJURTljt/Y3C7ORqMB6ompsrZUP3doMntMpZX2L5zHtZ5uLDv5AYdswM4zk9oEw5dFUKcL0jjVWLpq5mXDIlUpM5PhDeWEMzkwzshlTmrxUNiUeMj/XiWCdBUNnhwTYwbDbVtaUO3s9OhXBkS1G55Eqind3TE636+pi9aZNGpbKxZxrenpl5Uo4HE75XC5XYC4TEb4iUpdZONBuh8DtFj3+A9Kx2sFQ+xAFGwLsYNhuC+7g9QiV1dS3Z2GKsVHxezgyWZov7Z4Y21kNTFNWgA+2Ai5CYAKf9AhhEalrR86zJO7Jl5msV3ErbG8aLrFnL1aosJD624kJUWypmyzZ6qm0qWwGgWKsEK4FwuGQJcsVMr0WoiKT1FaexkpNlt/dyaoQ84aB9uag47OXECmwbWTmCRkQP3J6JGp71xsXS9ZSOpqaBqqra1dC4USKuAKpjBdIXyRcNFtIFhC+3BjuGHsHTaqwg9De0Y5B14BuA2Xf7pw7cv2ljzBTgKxsKQJPzJWxJ+pP6lKipfs63JiBH10VcKEQ4YqSMr0CIouHa1/t7sgVhvUW8XU8Re5oAj57ic+pTOqJpqp4rImCKm5Kr0Ow5w1M18JcXQGkxwcYoSj9CF+my7KVPKhtWRjv8pb1YMfd5hKefZJUkTkVsGSZedGqVF+gfo937mZuMD+aKyaLdC3mKhWYicOVECYaVxx2PGq03JdfILLQsh7p6GjpaMGgawX1mN05//L6H0bp3S+dRagY6OrZSevGpCCCpatypxeuTduoYrkCrnAiHOC2Urk4gCvFlmkeacGy6vBlTN+7tR+QLjp25/2b61s+hSaSqq34vMBSRVuHrqtez/KXvSGIsXXFZd24weswRUC0KN64Yis6SaIlVRE+svp7Z8vdA/VnzRQ2kqurMlVrl627Ud0iBDVPPPeMYDi1cmKs4MqSFbLqMEUJRfHLRlXhYm3edCjJosKW8Hs13+PznJa7xXujaTpVwPSzSlXUAVUED1noi16JUtgtIxGGAKUEtdbOVIFAOBGCKiZrdRayLF1xflckn9M6FVtu0rbwbxN8jF/Uxrc92DKIYa0BVicfA+r26a8f/PQlqwC3IsSU7FVjXBXXpCNq8KAQ9LlCiitNFZCufIFEIsxzFQpdhSyqS9qihVjmomSLf4w+nnlq8C7QjfojqcpumKsyVfPm9pRf4lGalpYsZ3bB5fP5UgjWFRtXTJV05XNBFhEFVSA4q9mihVjA31h44k2LzhwGL14cvDhIwQaGsmaIff3c019/CQ+KHaz+qmNViklR9Lu1D5anEgn4XD7MMOHKZ+NKVQWxVFYCrhhhwzCYL2JLFuJYdRVSZQf33PMjHjngB+m+2E3BBoayBnxbX1NOe/17L1lPP0uov2pXxZt+BXE71J1NbgXhicpCEQbsVNWXNROStuIGELbkLbGi1iDwv0hldf+nkFYFWdmiSU0J4hV62wF/27PKpgv4YApFWL9haaq4K9fMTDAk8RrSFtNFu9amlMV9fUxkne/+7xjGVJ2kKrucWaWIiVXayfKu2tJ9TRUSSBRVhVdShDdOaFcM6coVDEpZ4VDUkLZEISJa62qwAKalnUTWMKV7uJuCDQxlDcS2ft5tX49WRVOFVqWqyuSnSNAxavDU+tozXdQUf4GrgH2srimqAFpclSxcnDQseLJ414q6hS0erd+JrMeH8X/UODeMcQ7IbbwAbVs/9zavHxh1ULZYq5IlaBy6qStVkx6tpe0gc4SBxSrCldtrV8AFAnNzc0wVkWUajNpoxVgFimjhcenDkHXuv+C9Uev9XzGphAqYu043hf9TlCgzh0NvgBcfXuiPXq8IV6avKa5uSFeE1NzcBI8VMJeXZbRmq6J1LBoW84UHD/fiffS5xvMTujppVeu8VUlbxZjbggdeLUEmy7+f8wFY4g2LBStVq2paUwVXMlihiYk5pgokMsvVtiCLt/g9tWWBnyFLJKvnXI8CDgiwg6GstXPsr/8UXR1kDThSSzATKbsFfvqlNS1weTtIJbHyoyvW3a+oroDqSlUVCIQhK8xVJSALCFmA1+GuejMEB1RWT2NhqnbisKS6ymQKU+5q1Dr0sNeYEWB5wop90X1tiqXfBVVXYObq1SBTJWQpXYvJyrJYyWjFGi5rBKpIr8p7V3PClZgv7ON7cApRdBG3RA+rxMOIiyCDhQFEsPRYAZtYgbmFhSCPFZivKwu2xERL6Joisp7uGRnpGenBoGsNebz+OSP214+QaRVk5SM57mpeulqOOYFbhaqSuioZmiQ2A1WGOndHt1Jc6d3K4ipkcVdqstRZ/DYVVc0SldU/Iugf6SdgpW4DrPTj9Jjd9f3szXIpmsvxUMkKNNc0VVrHKi8SR0wTT5XQhh9Zzt0VVbauUqGFxcUZ4WpmBrJAtay41eHzRJXa4oms8/2NgfWqUjIHVxzhKnqLqHLSFylLMVZegBjpCJvKfgrBkqki6K5UVZCVWFxcJKY0WUDp8HnpqfGyfnrGAdYKJlelPF7IrP/ppKI0xORhfwFCmCTmSN1nHcv+LsiQrvBoZm5x8SoTBVVclt60aLKsRZU1MDDQP9CPQdcCdV85DsQ1QL9+YDRNVBUzMCVKcFW62hyzTPFcqdECe0QVF0M3a/fJ5zQiVnbtClTFCiws5ia4KhA8QRa+Dz1ZDwzccf6i7Wx60zjCON5PEPVoq5WcRFGd+ugoN/fUSy9VT1UPTXuu1EPVr5B7T/02wAG0ZrFZMAjMshCVBRziXTCOncR2Xtqq/3nZfXZmdrdJtf15CsYiCvzyf56dmd3iH3msLv2kqvGCTnK9KcVAmNbfMf4e8xSRoor5GO29JlTlzq5UV028Ipu5EtiZyXIuKVP/r6zfWLd6Xg0ByQLUrqQo9mXqetep14D0wi3pj6m9K0dBmlw909uV2Ege4gUlVNm2nyWL9aw0Wbfv3r199zbGXUDfp9wDeh491v78Y97XF0qzwojOMw+OSgQKUWtZjXUfnVtEiVbNxuO6WOlAFLnKjFW86T5bLKZwJbFJljF3OIMqNihgJSGrWH5m3aoNU2Zj5639sKzI0nS9rD05aMJWnCQxKtpjUYVP02IFjKOgPD/Rx2sZkqocWa0zocpMVqH8FmAV2AoBqUq4Om+UFNQavOohLMzWQSV70hBPsqAqyxWeRLKEKWAh4mRKkaVPtDLLUHD/9n2M24T2c/qe7s3nRa7SGju46JZLZUOXFHbYEoUlL9GrKY7Ux/xYCFm5rurkittqLsaTKalieFClL6VlsjRKvAx37xcJjoNBNX2+AC5MVRiSPyrRKeQabFWAsn9Fj8EIT8ieiFY4SgWC5hCvwOaNPcbPkZWWrHtFuvpmJ4CrDFVwBUoYiitRi0dh4nQ7XByY+1fyMQOV+kw7h0qySBXVIGiGvh+qroZZyXLMZCmy9u7vcfANBr+X0GP6efpzfsZc9DyUpqgCJes5c0XZSs61dmqRKsCjpe9fyccCrO6eGCcGZQkKDFVN2/d9y04wHJIshiJLC1ZJytrb3t7b3vtg8Icw6J6BCdbzlKOgYNngwUrT1ZioV+ixHj8y9q8SJpC8FFdKCequmgvf8xVVubIUU/yGy9ouir3vMGtwVFOTCL+zXxaUjGRd1bUp03EFNvT9q0pEnbWskdKujlNjBejkxNBrtdzYFFylyBpklWFJytrcLoyvsHI25wsc33kHT13Zs9Sp1sUTc+9O1GEtMRLUR81+XTw5P1cHUhbfbve8ieLKlAXSZfHGymVtbCtsbG9g0L3AfGz+DMEKfNnYSRTwJ773ttyFKoZWhQ3e2RVXgO3sqftXMlR1puKg368oqgD5NHIF+pbXclxhKlZlWSmyqjkNHrKKAh1rrbgax678V1DVFclS29b1QeqqhS1nlKkoIBXNvl0zF86mKnLV8x1nbAukKbh6H1liBQuKlLX9eCc4pQv4FFX+ZVfUoJGtmxq19mRd8aZF+1cUKw7WdzWtBOk5HM1Vf4rFsStFkSur9T6yMNh/hSbr252dM2VuRa46h10AX1HTinj+xFBFsmj/KqIuwVTpmXJunlzRslkg9pDtllMdQ5USq3xZpCqRrE83dnc3djc4+AaD7kH69wT9mdOdYBD3dYnP8f7sCihYGGBtlqA0wGdaVIEUKw7e8zN1O4ZUyRIckSowgQDLpmYVkS+LhGEIWbvF8BjtfUKqkrL+mHNT+Ooq04e2VoLJsEhZZqwAzsGTLHPdzKBYgV4IAaGq6v2TVRIjlnVv9x5Gjgl6jvaYvkcVXgpVlCvBct6VtqJgiduqkiutXeNd1pOx4pAsqyYTyEjaVEtQbLdbeP9eXIGEazm5sshXXIb3igHHQlmFZIrjXXNXZYzIF6/DTnasuKxePVYFyBR84B3XUtqV2q+aUa7sFvZdrKEkocp1nZx5FonCbbGyNoOdoJUswUiVFyBYXJc6e1iqsyv9hHu/J2XVKVjSBpdVORbdioJl5Eqe7uotOp3BLBJFuMD51+VOKRL2n2Vt3tvEUH6EiUMwmcSpIledxnwOVaIQqRQv8nIFcMCrU2OnVAlZrjtiz8xuVwhVJGsKV75ZgS6YVvNk0RwrTtbDzQ8GogweYeJAswVy5b2BK6ji0Gzr1VNylXrdmU2yDFcHtus2a0oJGjPROFduZzCoWqqpmGr+Fk0JQ/giWUXwbbBzThUo8ECbu5pryXp7DFV5ripox5DFRgx1JHs6tckVSHfVA1Zn0B5MaWYF3FjXtJMnq0TJKlgWtkjbhilwI13FTYuxX08/DJKrOt4bTOnNSuro4cQyyapndHaosodVaAgVVZIpY5CzU0ozB5L1oBhZ2HHoKK6EreW8MQdQlZg/dMOnubkCIws9XK9AmmvikgW2GMpy1U+6OlkYzQqqhCxypcsSoZKmSNanRbDJtrLiXuVhCP5qxLLk/AGyXuS2q/hyxmSqaFrOmYZhP32PoZl0ZTvtk5NxiirhajY7yT4VBleA6yJZdwqR9SAIdjytBoFzCFGNuAzn3NWfx6kLHEVW33JtowRJlhWGrrp1BVRXYIj+vfRJFfUqwSxUZAE6yQpV0XGwcFmPg+DUFyQ/sveMqeLQEXHeI1dmu5IGcLzrGc2KsLETNKKjIKkiV7ZtdZbLZUtLFUxJUMqTrAk8ZJGqFFkPP32I8Z9l4XShVoEtjLeNhm6rfGLmSnMFrOm0KVxpoZJOwvHYUkrQdDVtL5erhCuJNDWdAT9TVkbPuvOwCLBL+tIHpIoFq81UUYfnvM09CkpXB3g/IzVWZIpJGWKtcJCUSapkv1qcLFcrzyhAyhXIWhqKnhVDsj5+8GFaHjx8gKF//10QvFRccU4bgFciNflQqCJZhivQw9shVXqsQD/0/YXZregw6EDVapKnCnSMCTzJolApsooAyXohRZErVOG8S1XIm/zrfzkMCqzZbGi4IlUwMsS/y1SLFR0GwxOoWoYZfV26ov5uXlN6SaqKl/UoCM6oswucKg8WG7Jn4Wb2Pq5GeCN9vQKpK3ErM/xFbl1tV1KVW12BgZsbq4z+LibwkAVSZN0pgkfsSj9SJbiAK64qttW9TlFlbqD3wzA8SDdFK+QJ/oaZ3q6gyvJWDD/jEEiEmS0LZaiKKmNA1lZxsmRjp9/e8gqqulKXtLXObVfSFZtGTXVXTXIltNg+/gq/py1w3NYKnHdm2jKQKlCCf492xvydl6FGGcnaKkjWt0FwQaakrOsGo5s4JM6beq5SN9DDxcJWelWTXAlTgNnCW5tY9GNrMmCmzpdjbXvBzBVceeSKggXgytNllVGGW1tbX3xcBNhUXsMUpQoMeKgYcSG+1qYMRqyYIj7lRBUarihV0ta4WsVmVdVf4N0vJk57xThf+i65Sq3BcBaCQWzK/L8zLzVT2AkXsu4U8IVkrePGLmWtSRRuOOdmripaCYLZYjxLqcB+BF3oOHUGoA3YDJSnaqCmapqeKuC1iYGy1mkZZVgWsm4VlCzIIleC5w2gHhCHWTUY5wr0sTttG65IlnJVaNhqA6wBIet8NfBmlkCqipuV4Wqiu1I+rOCFago3hx9t3br1ScGy6NcnvWkA0gX2kwvn9HYF3MlkYajSChAjwgonLQfv1PFDV18HZsQKjAe6q2SwvD+MYB19dKtAWeeaq+p1QpVo8jfHuisJ5Qp2sCtm6Y29T644NqGcj3+vZgX8DFcyWP6NMmtgXHNZXxTBT7jkT/t1i51GgjnP1lq7kkNr7YIptsWapCq9/kiVJHsfJkXVuKqp0j9fxb+OXTFZ7Ot7LiuFL2AQNwr5z2HJckgWY9VQmMNXKGXJvavU/fM+NsXcgxxZdhI9VUBVhaHLWjgkKuOTezrJboVb8IjLKoSfgmBFseK80GRhjPTODvQz7ljGTJLLQF1VzzBFqvKPgYJFa8AtER3jM6H8QG3vZfBDobLOhSoMwU5Dt3VE7SrzOlmbLfnSZ6HATutWZqqymxVUqXSUz8+SRei/k6IAbkC3/AuT9XkhsnByZ8XrD0NyYwTrylg3V8zLZFstv5k9tSJRdmZbp1QRslc5eqRErvRP/XvBTQlfksbXXJbGJ7CHG+NxPl/KMqwSfzc05qdQlZcr2Bni5VoyVn1KlV6Bw+liylWRK5dildHYJ06y8MSd+Zl/kNXaj0qQovX6I8j67PMCkLKqBF7B/uGhZuuEYpVx7WfPbzl+/mzBcs5ujso4nVC+Wrt5qlRXC6+ajBRhfvamfxNNGOQd6P4KWbBVmKwqgRfQNoLVmNQEGbGCnxCbYMMcV8OTqzK2MCP21yQrt7GPW51UqqSKXJ1Sa2eI0+i/C1kJPoc53KSS/xwui2KFsTxs6MlyyVVdm10JPxbCGZIqo1d1jqSpEh/gapYWK0LWn2mJ00n5BFz/MpqJ8iF9/UPdufy4FMVx/MYf4E9ghURELMQCEa/Em3gl4hWPeEYICfGKJREiQbARwULEwoYVG4nGdWk7DUHTpEbbSKudajvtdDpjiO9533POvUXNovOZ03tvaybRT76/X29Oz22HFzvOZLgaFfRk9YAqVBm+XofWIPODhVQvou9NV6pZ9Yl3XCBKbOKfIatdqlJJ4UShdNmfrVyBKAypiq0rQxU655GsUZaFVFH6XatnSVd2CQK68hNFGNrYS/rVwriRjRfVp/f0XoUpr0BMVfJTu4fUrAxTRcvQewhZmyYjW+P/CH4Jo92xkKW+nLnieUawmsKVWr6gvQmRwd9mQpoVSGWpKYrbHPn14znLl/tCr0BFKvn2z6JAVLarYlNkSgFXiTUOODt+FJCyVKzwwpx2abQwBC0RKztXdJoTf55sc2L16xkn0UrX6/VKJf+Lta5E7ItExeorXlgZ7TyBqKzAF0MsUloRYiSy1x2wdzRl+VX1fBjyzKbVCHcFW5/IH78SqmxXVeGqWahX4IrQ4k2sZKr6+jmp5tZszK+wIPTGBhNSk4AvsV7rEHaOoqzvSIbv+9EHPbMOK1IVMFcnvCITxF/0SSv/+XrG5a7ieRIrThOuSLz6NFOpXu2dEwzbEtkwkkRWD2JKMHQxV+4xh7ByPJhoMX7ieIx/eYzI0r93vwVVTJcwVtVipbl69+otWSXLVGGItq5s/XzGSdcr3FU+X5ma4E2s1StNiWVPXJhC1Jz5tTvF/qEfwhJumih62+pQFp+XrjrHkPWBEhuBKKZLUISsQFewk8RffOOuguasPgtXkYoEtvL8839wa5VTeFOILZeWvgA1YsD+4W2sXME3vBuz7eqknW5Ac5UDeNMaTVkfhKsPPzyKqxrXC7tdEZirWCxFVYXMhMqZy2FpqpIHaf+Viz9+9hejKeFLCdN0vYiVapX0UKvp6ZLIjeBTxVb9ZI84nOVE1jj8UHBggofsx+3fYbI+SFexGG9ZdMPola6YKVWD5I2WJDElZBmqECxBi5mSNOWZFycbHx78ma7U+2u1avk7KFf76pV8+ufgwPBIHIaC4ReNajXIxlFHsonI+m+kLOmq6HFcaetrmCvMXObeolUFpIrbasgLyYaoK6WL9zKurBNYm2I7lSn2Qgi2LHEkqxGtUZKlVElZvGlhgIxWgkIVrqyJ5YpRX6iMXIFMVs4vpVkBKnjP6VzYczp8mVLtCsQ3Oz7OTkS0JozDmEBRx9p9sQ8CD0tZMbgilDyOOjd9yVQZrf0bVBWTsGRXoJw37ucXdGKDUGmuCqKbdZoqtgU4Yqp4pNh2nUNQXQu2JvwvkFWWqkCu7ElcLuwVZL3mqHYFVcWUZsqeNI6TOqFPx9ViVSDEO1dFN2xIEmzw9cJ3HJ1j49HBR11WVakCLuG9cKVi9eVDEWTet3EFWz1EFQtAxG+K2po69B/Bko3KbuzAdAUWn8Xr4KjIinGw4CJX8wTy5PT1a721v3sZhalSz0tblRRF+cmvu8OI533AFEiPdGBJDtxUosSOxyp7xrFYdoVEa9qEaRLcwQg7Nh8TsqQrdKFcn67KxU7UIFf1qbdI+Bz0GkhVCVlf3OeAxWAEiiAJgzKVfL1mw+3Ektjo9ccjxWwddkK+cxu2/odF+XyZq6IUIcvQFddq8GMyR2P1UU5Z2Y2dU3quGC5I8ixXYPBfMqV2ovz08wXFRSeQ5ePAf8kSycpRW9DQ7wFN1483cpLhZaqnCEq5b/Y7p/ZbXAPi0js8tQGRLLqHK0qTS7BRZjD8Z1X22TobuCFTuN3a54SwGZWEaE2aNkmAQ3VfYf473wtZOaYK1D0D90dPNPWNLTorUlXFVFizAsrV1yxXRdi97ezeYzv2btq2gqWL2GqkG54qMrPo9DwxUdp8FdtiT1WJEjy0ywll1RVia1LHkDKkqopwRah4Js0ecXIPSqWeb6+Eq/bLPMp4BrL/yqeweMe2pdQXsdUYpI1a5gZH1n3ey7kms1OpMyuYIu1qsdOGlReQrM5tIVnVWIyqCpHljlBXOWYq9fIdxzZlXJk0wOqDPTH/c1i2aSnt9JDVGGalBrgZ677csKHBSlBxaL3TniVHaFl1LqsMVUJWqZiPeBFPo/UpQ+Yvk5+/fnylFqUZbd12lXETgL9SHTRex8+TUkQxNhpxJkKLkryv7TVFdKuRTRzc54Sigk1VTfcxafokjND76jGaLCJKuCoVInCly8LscQfrrGKsQJix7VZBjC/kQSHfiHBH8rRAv6+EAX+3Ms4Ysof2ifS2Z/kF4qoj0LOqyhUoQI/ua8CWFe4KprisRgIIYWcC/tPbWLrSEV909HNzw5DogapPgSwzddgswHCWXJ/+37JKjKmGKshqs35PmrKClYknfNx1Alh2diNk5ac2lSpgqbLbFDY8sbdObj91+OL6E84/sWrSnOlzMJgCHAB2v83jAGVYU65AOuIZXWuQuQqvwMBFoaVE1hetsG6y+ey2rSumYsGIhpkoYYjYOXhy+5RTZw5fPLdv/a7jRuH9Q7jmdALpWdSUkgU8U1bQREzblY6ZEchSvv5UJLsunpm7/eTBPZyDB08eOrR9+1xoOXP48F2Y2bd+/S5bTudsuD1n4ZyFFBxQcIBB90HgYVKGJSHrOwZk0aalhA3JVGmEqqKy8uJTIRgnnG5jyfWZC2diLMSYyVH3sQHiWOxJskrSFWa+GzRZRJiUxVWFL3S01+8Vhaosve1xupANt2f+I0hWjasCTJan6xoSrmxVGNyUvoI25mYpohK3O93Ikmv/KGs/GjxVpWSxaPnKMGx6L2z53reSuqiTHRx2uhOEawZl5oyZGHQPxLHYa7KUq3K5wWIl4wVZfzqzErK4qlRNXqkoivGc06UsucZU/R378/k+WoJKlkCWoW0K2C+BGETV57wLU9SWzNcup2vZcHvGX4Nk9clYwRVkCVHY0O2QPb1nNytAVJFPNiWuXP7DuOV0MSRc/5AsnyozWRiQZTWr4AtuMlDVOwBHTJfilNPVbJg9e8ZspgMHGHyvHuMcgCzlyp8ssqUHg393bdI38qEj0WEXJKgvDC6ta1uWDNfs9ihZ/T5V1XI6IvHYGNBOQkMueMO1g3D19he1BF3UlajE7jsltcL117KkKsiqTo1oQNeAOWllX5uUgSq46vmhXafIo9XtVcjDNWv2rNkYs+QeGI8dKBQgi4vCqBYMV16kpdefHSuooq5ycSFJ9i2ycdc7Y4ENj2f9CSSrXhZUQT5i4A0HTcT4U8VX7dcirglsjY1g0XBd+pOse5AlTYXI4t3KMsVVcVfpIFVgz3FnrLDq8R9lVZQqUImYNImq4NfAr0lxNciLlhvMky4+IbVYfGnerFnzZs3DCJRVKFSUqlqtVo/EDVnxb8SUfWUSQiWvyPoed4O5OXZyRVl5dV4495Gsalm4Av1wZZAMUIVQ+a5eS7NVgjZblzhjjYdtZeWlKmoLdgxfL4zP/mKhArwGY7+gCsMicsUZgyx7wNQsmLcAQ5rC4VMpq8aJWHxI4mMqpCryPr66eg1UInLJrs7lY87YZMPpBYE8giyVKtAXj5vJKiahpPcz/QrpqH71WjL6YdgD3JSWsN0rnbHKkkuhsmqQVeWq+oisiO6rytejv6XAEweuVKzUVRlc23hnLLPyKtUzf8F8DLbHEWT1iVBRWSMRostvq94LW/rVRzxXMcRKiBI/LFvNvc4Y5wb8mGASvi5l9YGBOGRp0Wr0MlvUl9whVr/bO3fdtmEoDPNJ0r1P0UW+oKC1GGjRJoCBdKinwB09B/DgIICHvELRIQ+RQYuHnqxdjI42ejMqVWpguUWPKNJHFKtKBZJBlD5YpucPh8c/aRLeeHSOK/vgFHzBak93bsgaY3ZIVUl+eQCgVdZPcTsE5RCJqs+/lSrSJUvrhFkBX+RkJdmBXCFr1bRA+drjpp52uS35fPPDWxYQnzFbuJo6zhPnIOt6g5s06QxEfN8PAPGytQUf0JbQRbK+x4YjlR9eDpg9dOdOFjEPv0hXiMgOoJXWe7rblnIbLuWms8mz+oX2kozqEOdrLC1hSpJWVjZB+HS1TSjbgDyWZALPmXXwhdNxOvhCWz20JVyluoIYQKiiyRhqNwG/RvLsiGdW18WI2chw2pEkpRWgLEUICk9V1zf6X56bMKMqz6s+s5QrpWuc2PIlQbBSogAO+XR1Ky6afvy0AuGKniXhPWIWI3U5vdRW4AcCkJArJN7d7SLtlx9VW8pXbdfN/6frfJPYUq58cqWivBpIlTrFRcJOObOe4SKx1Vsj20Cwjam01JODjiUpcbaE9jL4W9Hkla7tNgTI9XgxmtChiMie0F5G/930+vX6wOOsKvinKDlaFdrL4XOcipIACOpcxco820J7BfhsLH1F+jyUQxE2hvYqdEezo8lk8hQIavQFwiwN7ZV5Awa0+Mnh1nen/Z44BkLv9DljYHVorwbfgwGtf4iL2u+03weXYKJKi5pXE0J7FU5Bw8zz+N6Q0F4OD4EwvhWRJoX2UoZhUY9PZ2PYrNBewuAODLzDUMPjMQ8Kd6GIaMZaclxG8FfcIWsxGLkxGOzazl7AYKLn09idtd2qmP7ZiZsK24fHR20MLafPB6O2UTWAP1yGz7GpTmekAAAAAElFTkSuQmCC",phone="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAAClCAMAAADyFTYfAAAC+lBMVEUAAABISEhKSkpGRkZERERCQkJOTk45OTlBQUFQUFBSUlJUVFQ7OztYWFg/Pz8/Pz9aWlpkZGQ3NzdcXFxeXl5MTExHR0dhYWFJSUk9PT1WVlZMTEygoKBERERFRUVmZmZQUFA9PT1LS0tra2tPT09ubm5SUlI2NjZXV1czMzOpqalTU1O3t7dVVVVoaGhaWlpqamq1tbWhoaGenp6lpaWurq6ysrJZWVmjo6OgoKBUVFRdXV1cXFyvr6+0tLSwsLCrq6ubm5syMjKbm5twcHCQkJCLi4uGhobLy8uCgoJ9fX1ycnLPz894eHizs7NxcXFgYGCVlZWYmJh7e3umpqa3t7fOzs7JycnFxcWvr6+JiYl0dHRra2uSkpKNjY2IiIi4uLiUlJSsrKx3d3fDw8OHh4eQkJB9fX2dnZ2UlJR/f3++vr6RkZFzc3ODg4OioqKcnJyUlJSCgoJ4eHirq6u4uLh4eHiBgYF2dnaLi4uMjIyjo6OZmZm1tbWwsLCcnJyxsbF6enqAgICwsLC9vb26urqjo6OKioqsrKyWlpaoqKhbW1u2traCgoJ6enqZmZmbm5t+fn6JiYmgoKC0tLS4uLhmZma0tLSYmJhxcXF1dXWlpaWfn5+IiIicnJyzs7Ofn5+xsbGampq7u7vAwMCMjIxgYGChoaGgoKCQkJCOjo5vb2+RkZG1tbWOjo6Hh4d6enq1tbV8fHzGxsZubm5mZmanp6eZmZmvr6+Hh4eTk5Ojo6NwcHCenp6mpqZ6enqlpaWWlpaJiYmlpaVjY2OcnJyKiop9fX1/f3+CgoKlpaV4eHiUlJSIiIixsbGqqqqGhoZxcXGPj4+ysrK1tbWurq63t7eBgYG2tra2tralpaV+fn6enp6tra2EhISZmZmVlZWGhoZycnKhoaHV1dXX19fW1tbZ2dmrq6upqamwsLDa2trU1NSzs7Ovr6+ysrKurq6tra3S0tLGxsa9vb3Q0NDDw8PNzc3BwcG/v7/IyMi6urq4uLi1tbVYe8d+AAAA5HRSTlMA4+Pj4+Dj4OPj4+Pg4+Pg4+Pg4+Pj4OPg4OPg7+Dg4+Dj4OPg4+Dg4ODM4Mzg4+DjzPDwzMzM4MzM4ODgzMzMzMzg7uPMzMz+zMzM/swD4+DNzMz0/vz8+fXNzerMzAr58dPN9fLs7MzMzPn05My3j1w/Lff07+7MLRH77+7u7uVbJfr39PPr6eno6Ofn59W7jl9ZVxAK+ffr6dXVuHNAQCYm/Prx6uff3NLNuaePjX9zc/vq6d/f3NbUyK6rqaeNjXMR6ufc2tG9vLynp4xzWUnn0ry8t6WZemFLNxrRyMjIxGrWwvApAAASsUlEQVR42uzW12tTYRjH8aMQvLDiJDa2aimigqiQ3NjLIjVpTQutrba2FkupthXqIA6caNUaxYUXDlTcWhUVB+LeCxXUGy8EFxlocoxohokJ+Hvfk9Pn4q1By/EYwe9f8OHhd4b0P40qmXfm6vuJV8/Mk/6BVp19XD2Rd+Lq8xIprVu88kY1sEnuCYCltK1k3tbi+kXV8HLsgzpHIuFwnpHSMowA2EXVi7j2wYzA9/j3eLyioiL7lZRuYQTFxcX19fDiuNVtju+sOLio9ayUTmEERZO4lk9hoyUYDALburBXd8ORhkSF/DmN7osRTJoELcJtHzgrgqx43V1TRkYPtOFDQrZI6RFGAKuqrX9RFY1GgV2yYEgGsEqDErKcDs8bRtBcVFTEucDeXxv9FkWBhp4ZiLwNstwu6Z04gkdFPK59uDT+jRXccaG3KYntOK8sl0t/tcXPXhY2N6vahy9aw+EwsI4FRhNL4aoZZPmzpH80gtOFhdA2K9r75V+/htH0w4N6m3h0XF4/WQ5If6tVtx8VshTtpRWHvqJw1FJj6I0ELrT6c2kET1usHdqHzu2xGNNWzcwEFQlTgFb369II3lmtLS2Fire9PGaLgXvwcC9+WOLy6Li6cmkEe6ysFu69lB222aANm2sMLOISVkeuOALrVCsP2NfO6ZGIDbXOzDIoqVjUCTfwUdIvjGDCVGCTt22vskWQ7VBdL4OaOAXSMq5+18UIJkzo4B5fe85ut0cisbXnB6vW1FtAAb24i+c+hRVazp16b3UoZEfbF2YNNhCXsDQF3a+LEZyq5VjluBerQl9CqLKu/5DByEDcVMdFAR22e+D2ydraWlXbvn7Kly/Q2sp3GocIWuG4+nIxgicFKKk9fvSQy8+00xtygOXaX1+uyNV6BLcKOBbhsheX+T0uv99/bukAI7BMK16X3mLicUcEPv457oG9J6cV8Bj28rrJbrfH5Qo5dmUa0U+PS1hEWoGr9QiapqnaguNHK71uaD2rG0YZFWzqKZg61Y74+Ee4JftuvS2FVvHWXpzv9jHtlPEDM3FZgUta8UkjLbj96LpajmBLaWlTUxK7eZ3dh7wux67cTGjVJbB+TUveGs25d7Y9KS0rZdwmaC8frfR5YfXNahvNsHRc1m+9FtAYM8ag7QjelJVBq1z32Hw3qF7fZEvfXI6l4xpTLFf8Lef1mWHWlIsR5JexuHbzcrvPizxVm7JykcKlKYjeVJ+IHmOcZgSuViO4lp+fr2DR+kovuysbQZagRZ1gSStuoRsuqxkXI5jTmM/jXIzAi3w2S98sxLW5xE35iQA4Q3gtmOrMKveTFiNQsQgj4FaMIAfWJJe0qlc4boop1CS12XTdro8gr7ERXN7m9ZU4LJrVNnLYMEFLxyUvaVniFvqhNlA1GEPJvptX8vIa85K35SNANsvQnGGIYclLWjou1YGl1wJ5l2pwXYxgdh6PH3f3crsbny6vHyMAlrTCcUmb+rjEXZHUgvupqyO4Pm5cUgssRuCGFiMYm4NScVP+OIpbIG62mbi/PQIVC+6xNR4vw9osY4bDqnrFKSjRcAVvZw8acbt23f0/SLV7n6aiMAzg8SMkSkwkaPz+SPwqbbHcXAVjpRJ1cFIGAjJqTB1IR+IiyiDRBRZhkYGYuDK4ECb/AAcd/IgObscGk8YAf4Hve96ePj19r+e28eEf+OXJc889bfn04cqlK47LI+CYyYXc+dPCTRpu+uXmiNWq5XrcPx1yl169v0RhLVt5BJypcuE8x3VLSeOqbvVywWUtuO2PIHtJtMxdmzZMpREM5HLQppTLadHWvYlaxz3O+aO4wRFks1mnXX46bq10EvTnOJ2UywmUK1Rwb3bc7tLi+yzFlfuyPoLn5eLV3NVcR+WeONnBFITLWOFutjOClY8jI9kGd21ORjARn+nv7xcutLpcSYArCXAxBs3VI/g6cjlb12YxgkeZfqu1QbsWeza4XEon5V7gdsENj2D1MqVe7vLLxklQzGQyrKVAaxMqFw8a0g73OLjBEQxftrHaphFkBIt29RY4Spv25QK4wF5or903775eHx4erne7PDNe/UV/NIJCRsJY4upyj6XfHBH1imgEXJIKd3PrnyMYHCStlPuAR1C1IxgdGhpq1oIrWJu0m6OHDX25wPG4m8kjKA2SVrgja3O1KoVGcK4wREG5BGZs6BSTBMoVbahccDeJq0fwpVQi7KCdwgMaQZWq3Z6cL1BYK162SrfeoYtyrdfDhk4xlOtryeu1q0YQRYS15V6nEZgqZ6rcY7EFaDngkla3i49oTpv+iVKV67Xrb/fnj1I+KpWEO7xOI+BMxHevFSTYArR6C4JFuekXR30Xg7avL5m79COfz0d1rh2BqRoaQfEatF656lgIXcvDXH2KwZvMXfkWRaSNSHt99mGVsKb6vHyKsNDiQRMt2gUXWmA7vy645frtbjW4i9SslPt5ZrtqKBNxpVgkrea65bZebrxDt4Obo+ai3L5E7ru6NhqcZmqVR8C5xlFab7rhKegHLV2L6frtbglXtJa7fpu1U+WLo0UbT4stoNxcMtfXYrr6Z6kwty9pDIsRdcvaWW52en501Gk5oi0ka9X7V50LwVMsrFVj2LBvBrYSuDRD2tsvCKu4arl40Nq6iqX/zqMvN4q7JdxVovKxwNq5AWC1ViLDtd4WrXih/a+LrmjBjYW7mJfM1kxtsoewvle/Ijih96+N1qaXq7U+d4O4d77lbbfr28ZMVyqVu3eLo6FycYgprTrE2rvcHAl0q8awwlgS3zPm3gJhKbco5zhJZ24GN0fRSgJclNvJp4hWbiztfs/bdulQ2J7ncimMRc5w/Cl45QIradGCm/r61VpwY+EuUbXc7rgxYwR1adIiA5RD2IJg4YXWRbCdlKu3cKPB3SDuCmO53NptbhZSaIGlXOSc4hwIfhUiVl2u/hQRKBftxjIG90J7yOVSdLO+V7CSHpfe0/61HN0GD139UwS0/2r3u32jfTamtkBQR9Va1yv9OS1yyOWs0oa2EFgutMKN69xV+0ajLbxVxXqRZrUUWs6BQwc4vb29x/zLjY+FNjQFcNHuF7uFGdoCtOAOuFyEVheLkFa8kv2cw+Rt99tyF48rWOHaM5enW4ZUtJ5XqGJVWkiBFa5kXz3OG/jPQbXcFi5Z6W/CmHmxetQzVKp+wMLaXq1FjnK6u7t9beLlRrTCjcG1BxmduhW9WnFKUC7ScMpm1Q5IStZWbrfN3nr8LahyKU+auXLRNcYkvRRgBRRBraBKudB6te7rdlyA9+zdw+nq6iKtOhaEGzvub+JGFFNzXEyWmYob3KyTIl6tVgoruOJ1OXiwhRs3ceViLu1Ci6fLST2tgkILbwPqsNA6qkS04FJ22uzYDe4zx40oNeImnwXt70CCdvVeEXAhVVzyco6PjY097rpx5PXGb+JGBC7RzRxYHLHQpjQLK6T7odVQaD2oSKHl9Nx/tGcXx223xGMAF3sNbdZz+lxILfRvc2f2clMUhvGNkzFucOPOrTtD4kJcupArc8oQURQyJZI5U5nKzI1ZQiFTpkLxDyhxZZ91bHPmsbzvWmftd6/1rGWT4zjP58Plr6ffftdwPptHyylI0Al7FVQOkxrczLjLuC+clRZMiI/ZPPCE4dNleX1ne0qCsBVKu4qRodCuKdahDIogY6sQz1iNC8L+iratNNvWa7bCyTKWgS/x6FHTxfrbGAElVMaFXg0pzoOu8Hh5sFYAkTZPjkq/Ca1pV1/oUruwLyiZBdArLLc+p8MLukocDQyqtKuvn2mZcOdskFbW2hzTpxVnXVrsVXARVXBz2o4dO2pc2y6vYUAbecBCT5eHK6hxXk3q4BZBg7hsrsFFUhOcXPS7MRZmgQ1qEFjAfFCkzUk5BpfL5UctZoHg4sYAcB1UjxaXMNAAaAG3r22XUAO8uIShBbCbhUEA5cooAFyXlH5Z3DZZtjQh2rzdAmV40EoKuEIbHVtC6k8EwQzj2nTr1q1zlvVPBjLuUG438nAFaIWzWC5uuFxaO2froEhrFZDhJbCUo1k2RXBjswAONeEhS9+wj/Hi4DKpZkVcgXVwF2XZhIRoPdzQydZDRVyeswaUvrv4tIWHS6wFUEb1abvl6Tg7y7Yl5uNfcvcPDgpdveATBr06xmK1MGQtrgDTk5bNTwZKuxo0RGtIi7wwDNwDo88ptIEFoQ19wehymrUubEgSXa7gFijNX9ADKBZPX3k8VtjGwJAVWMHtzem4lF0wuEM0buR+QzyAjUFeLgsLWxigrcdwurA4DDSt4FK5SycRLtMyrmxiJNE5i4fFPMFezbqAtUpwzhpS+sXpROY+SDSuaVeqRVzoVWhttbKCAS3H2xigr4Y155VejQq7s2xZYnCHcLsKaC0qDFrvrAiPWM4JHuDk4oSc9XCn09Z8JeNyt0aGHl6gWLjf8EB9WpPgZlY4Jb4Gkm5MeyPhmJ+5SVUqkE7gMiZ2pEFnXVx8xAqkdnSBB5zKbLodu5zoEK2RAZ+uQoC2ZDebc3q0QupW6wwDD/f2UqFNzA80kQxQbWgWdI01i7QOKEjroIoH0GyHTVzt03tJPUzLuEpooyeFAmVx0KKySItLwi8esJy348Tdb+inGJaeTXzcVHCjqy1IAL2GN97uoaZQqkMLzW6a/vTVK/qpgBOrkjxsLuGq1HRqElEWeONDNu4Bbr2DyrZftPTZM6LN7jpvHCJYIwM8XRYXDouS6GERcUMS4OgSCV4+o7zqf2A+QyJu6gorEgCtkCItYMITJmMLcEWCZy9f0z/9y07yyhDBNajIG7mMKXMWUIUWQE2sBNlLerPBy2cbtu1MMJp2GLkbmAX0HTvSeLi4L4gfaULWigT0NiTCXWckwGjaYeRuoNnwaiuBBQx79QetA+rhbjrycjTlxxuRAHE1r0pTC+ntEb1eQ6Or3IKKJDYLOs1YoF819eMOSBBqNw19XNfrF8XSd6zYdh6uR4q7rsr5/of0m7FAgiBuH3LXoS2bBbkHfKAJWOClSGtJhfbo7NHfGHb1FZAAwrTa3RLa6NE2uB5gsRoXeiUJFq/WL/L6fucMSoBhWi2DsMIuJnKm4V+5tYCKHuCeq7Jn3Zf3nFEgQSTaBZah0G35p0q4mUXa+AJW33QfnX3oC9PuAgni0bR9VKry5cs5gQGog/uLYv2LLju3RILX+j1e74+BBCW4xEsyWFq49o59DOrhuq0WyoViWYKl9GYswl1wCiT4dZiWZaB2cdDG14Tf23hTKrgvODrls36R1+Qt25M/Dbug2xUFOLEjjaMBbLhKlgTG7Tx98rt3THvsNEpQHi5XP2qOsBxZwkqPto6uYIGwVvaO+qpf5DUeJPgjXJUqBxeURVy53wiLgLPr9u6PGvZQVILyMC3jmnbLP60TWtxwSWBykQSHvn5l2o0swV/ipkoFL2PgIC6o3vwC0CJuu0UL9Hu8vu4iCf4qxGrc7QwiiAW61PiaAFPLlfZC/7H6RV6H97MEDcFN1W9/WifBy0NcwDofmTXiE9NqCRqDO0CpFM40MV6oFou1C1ibRatHjGDahVtJgkZE0w5QqXJoQVko1y3Wpc0lGPOBaceJBA1ql93NSfHyCD9Uil512j97HfnM7/Ea8Wn96UkNQpV2U6V0tUAaXW7jNwYswYxdL94y7VqSoKFhWiMDXnUBaHBwoQT9Prx4Szm3TyRodLupoMJHH5LyK+9es8+l/CKvDytukQQND8FSlFIOreGM0/omiATVapVo12xd0jhExKW5294RAc40RVoftY47cd2LKtMOFwkajzuAeVOlIhfJeKahLyiWJRhLr3Ai2BVzQYKG4lLYXfg8HCSI33a2nTH5OaVWmzYHJGhsdLmDuN2exAonBTzZIuzEUS+ec0ZMBQn+Ea5KlXNI4C/UAO/k6hKwBptJgn8fgmVckgFXML9YEEFLUKMvlqAp0eWyDEAL65dLqyWo6RekTZ2XNCsD6rgpTK/4p3WcrrPH1ghWJGhONC3JoGAkRHH1JKjpNEcCxOV2I8MWyiUJqNVajSVodgiWcVMVLVeSS1ATCZoc88qjVKlSc3kSLJ5c5V6rTZQAcVkGbBeuOkgCgq2CBM3MoFwGr1tvim2aMpZZqyBBc3N1UF2GX90j9SQJKCBB83OfYAcNVjFcSrvzo95WOShB83Ody5V24fqzO0nAUSzB/89Nph38VqmuOa3gticJOP9fApuHTDt4nFJ7AXdPC0lg8/gq8y5XapSrgpUgbQ0JpF5u97hS1fOC26nlJJA8Yd41Sg3fU4dtRQkKeXSN3jo4Qqm0397OmyZOGatoDrScBIWM3DFn5kXi1ZyqRSUoZtKOa1vWKArztqgEnhIHty4f9/btuEstKwGkxf+XuCT5CbTFnFRuxktuAAAAAElFTkSuQmCC";var _a$6,LOCALE={zh:{TITLE:"眼镜模式",HIT:"请将手机横屏放入 VR 眼镜中"},en:{TITLE:"GLASSES MODE",HIT:"Please put the mobile phone horizontally into the VR glasses."},ja:{TITLE:"メガネモード",HIT:"携帯電話をVRメガネに水平に入れてください。"}},TEXT=typeof navigator<"u"&&(_a$6=LOCALE[navigator.language.split("-")[0]])!==null&&_a$6!==void 0?_a$6:LOCALE.zh,CONTENTS=`
<style>
.$id {
  all: initial;
  position: absolute;
  overflow: hidden;
  display: none;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
.$id-modal {
  width: 100%;
  height: 332px;
  position: absolute;
  bottom: -2px;
  left: 0;
  right: 0;
  overflow: hidden;
  pointer-events: none;
  will-change: transform;
  animation: $id-modal-fade-in 0.3s ease 1;
}
.$id-modal-bg {
  background: rgba(0, 0, 0, 0.75);
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
}
.$id-modal-bg-line {
  height: 1px;
  background-image: linear-gradient(
    85deg,
    rgba(162, 177, 255, 0.3) 1%,
    rgba(120, 126, 255, 0.8) 30%,
    rgba(147, 218, 255, 0.8) 66%,
    rgba(250, 255, 184, 0.3) 92%
  );
}
.$id-modal-bg-wave svg {
  width: 375px;
  height: 61px;
  display: block;
}
.$id-modal-content {
  color: #ffffff;
  padding: 0 14px;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  overflow: hidden;
}
.$id-modal-content-title {
  font-size: 17px;
  font-family: sans-serif;
  line-height: 18px;
  padding: 20px 0;
  font-weight: bold;
}
.$id-modal-content-hit {
  font-size: 14px;
  font-family: sans-serif;
  line-height: 24px;
  opacity: 0.85;
}
.$id-modal-content-guide {
  position: relative;
  width: 168px;
  height: 139px;
  margin: 36px auto 0;
}
.$id-modal-content-guide-cardboard {
  position: absolute;
  width: 100px;
  height: 82px;
  left: 68px;
  top: 57px;
}
.$id-modal-content-guide-cardboard-image {
  width: 100px;
  height: 82px;
  background-image: url(`.concat(cardboard,`);
  background-size: 100%;
  background-repeat: no-repeat;
}
.$id-modal-content-guide-phone {
  position: absolute;
  width: 58px;
  height: 56px;
  left: 0;
  top: 0;
}
.$id-modal-content-guide-phone-move-x {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  will-change: transform;
  animation: $id-guide-move-x 4s 0.5s infinite;
}
.$id-modal-content-guide-phone-move-y {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  will-change: transform;
  animation: $id-guide-move-y 4s cubic-bezier(0.42, 0, 0.23, 0.98) 0.5s infinite;
}
.$id-modal-content-guide-phone-blink {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  opacity: 0;
  will-change: opacity;
  animation: $id-guide-blink 4s 0.5s infinite;
}
.$id-modal-content-guide-phone-image {
  width: 58px;
  height: 56px;
  background-image: url(`).concat(phone,`);
  background-size: 100%;
  background-repeat: no-repeat;
}
.$id-modal-close {
  position: absolute;
  top: 20px;
  right: 14px;
  width: 14px;
  height: 14px;
}
.$id-modal-close svg {
  width: 14px;
  height: 14px;
  display: block;
}

@keyframes $id-modal-fade-in {
  0% { transform: translate3d(0, 100%, 0); opacity: 0.5; }
  100% { transform: translate3d(0, 0, 0);  opacity: 1; }
}
@keyframes $id-guide-blink {
  0% { opacity: 0; }
  7% { opacity: 0; }
  12% { opacity: 1; }
  29% { opacity: 1; }
  34% { opacity: 0.3; }
  39% { opacity: 1; }
  44% { opacity: 0.3; }
  49% { opacity: 1; }
  80% { opacity: 1; }
  100% { opacity: 0; }
}
@keyframes $id-guide-move-x {
  0% { transform: translate3d(0, 0, 0); }
  57% { transform: translate3d(0, 0, 0); }
  80% { transform: translate3d(70px, 0, 0); }
  100% { transform: translate3d(70px, 0, 0); }
}
@keyframes $id-guide-move-y {
  0% { transform: translate3d(0, 0, 0); }
  57% { transform: translate3d(0, 0, 0); }
  80% { transform: translate3d(0, 58px, 0); }
  100% { transform: translate3d(0, 58px, 0); }
}
@media screen and (orientation: portrait) {
  .$id {
    display: block;
  }
}
</style>
<div class="$id-modal">
  <div class="$id-modal-bg">
    <div class="$id-modal-bg-line"></div>
    <div class="$id-modal-bg-wave">
      <svg width="375" height="61" viewBox="0 0 375 61" version="1.1" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient x1="0" y1="0%" x2="0" y2="100%" id="$id-2y6_dj_hgp">
            <stop stop-color="#8598FF" stop-opacity="0.15" offset="0%"></stop>
            <stop stop-color="#000" stop-opacity="0" offset="100%"></stop>
          </linearGradient>
        </defs>
        <path transform="translate(187.5, 30.5) scale(-1, 1) translate(-187.5, -30.5)" fill="url(#$id-2y6_dj_hgp)" d="
M0,1
C83.001,1.706 140.146,4.164 171.435,8.374
C218.369,14.688 253.467,26.308 273.002,33
C292.536,39.691323.501,51 343.709,56
C357.182,59.333 367.612,61 375,61
L375,0
L0,0
L0,1
Z
"></path>
      </svg>
    </div>
  </div>
  <div class="$id-modal-content">
    <div class="$id-modal-content-title">`).concat(TEXT.TITLE,`</div>
    <div class="$id-modal-content-hit">`).concat(TEXT.HIT,`</div>
    <div class="$id-modal-content-guide">
      <div class="$id-modal-content-guide-phone">
        <div class="$id-modal-content-guide-phone-move-x">
          <div class="$id-modal-content-guide-phone-move-y">
            <div class="$id-modal-content-guide-phone-blink">
              <div class="$id-modal-content-guide-phone-image"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="$id-modal-content-guide-cardboard">
        <div class="$id-modal-content-guide-cardboard-image"></div>
      </div>
    </div>
  </div>
  <div class="$id-modal-close">
    <svg width="14" height="14" viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <radialGradient cx="50%" cy="50%" fx="50%" fy="50%" r="70%" id="$id-ho0itsc4p9">
          <stop stop-color="#FFF" stop-opacity="0.75" offset="0%"></stop>
          <stop stop-color="#FFF" stop-opacity="0.22" offset="100%"></stop>
        </radialGradient>
      </defs>
      <path transform="translate(-3, -3)" fill="url(#$id-ho0itsc4p9)" fill-rule="nonzero" d="
M16.791,3.198
C17.044,3.438 17.067,3.814 16.860,4.080
L16.791,4.156
L12.144,9.331
C11.803,9.711 11.803,10.288 12.144,10.668
L16.791,15.843
C17.044,16.084 17.067,16.460 16.860,16.725
L16.791,16.801
C16.538,17.042 16.142,17.063 15.864,16.867
L15.784,16.801
L10.000,11.250
L4.215,16.801
L4.135,16.867
C3.857,17.063 3.461,17.042 3.208,16.801
L3.208,16.801
L3.139,16.725
C2.932,16.460 2.955,16.084 3.208,15.843
L3.208,15.843
L7.855,10.668
C8.196,10.288 8.196,9.711 7.855,9.331
L7.855,9.331
L3.208,4.156
L3.139,4.080
C2.932,3.814 2.955,3.438 3.208,3.198
C3.486,2.933 3.937,2.933 4.215,3.198
L4.215,3.198 L9.999,8.749
L15.784,3.198
C16.062,2.933 16.513,2.933 16.791,3.198
Z
"></path>
    </svg>
  </div>
</div>
`);function createContents($e){for(var Se=1,Be=document.getElementsByTagName("meta"),De=0;De<Be.length;De++){var Ve=Be[De];if(Ve.getAttribute("name")==="viewport"){var Fe=Ve.getAttribute("content")||"",Je=Fe.match(/initial\-scale\=([\d|\.]+)/);Je&&(Se=Number(Je[1])),isNaN(Se)&&(Se=1)}}var Xe=function(Ke){return Math.floor(Ke*Se)+"px"};return CONTENTS.replace(/\n/g," ").replace(/\ +/g," ").replace(/\$id/g,$e).replace(/(\d+)px/g,function(Ke,Ye){return Xe(Number(Ye))})}function createHelper(){var $e="five_vr_helper_"+createUuid(),Se=createContents($e),Be=document.createElement("div");return Be.className=$e,Be.innerHTML=Se,Be}var sharedGeometry=new CircleBufferGeometry(.12,16),vertexShader$5=`
varying vec2 vUv;
#include <common>
#include <logdepthbuf_pars_vertex>
void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  #include <logdepthbuf_vertex>
}
`,fragmentShader=`
uniform float circleScale;
uniform float circleFade;
uniform float circleOpacity;
uniform float loadingAngle;
uniform float loadingOpacity;
uniform float opacity;
uniform float disable;
varying vec2 vUv;

#include <common>
#include <logdepthbuf_pars_fragment>
#define SMOOTH_DIST 0.017
#define CENTER vec2(0.5, 0.5)

float inside(float innerDist) {
  float dist = length(CENTER - vUv);
  return smoothstep(innerDist, innerDist + SMOOTH_DIST, dist);
}
float outside(float outerDist) {
  float dist = length(CENTER - vUv);
  return 1.0 - smoothstep(outerDist - SMOOTH_DIST, outerDist, dist);
}

vec4 create_circle() {
  float dist = length(CENTER - vUv);
  float gradient = clamp(0.98 + abs(dot(normalize(vec2(1.0, -1.0)), vUv - CENTER)) * 2.0, 0.0, 1.0);
  vec3 color = mix(vec3(0.576, 0.635, 1.0), vec3(1.0, 1.0, 1.0), circleFade * 0.5);
  return vec4(color, 1.0 * gradient * circleOpacity * outside(0.3 * circleScale));
}

vec4 create_disable() {
  float dist = length(CENTER - vUv);
  return vec4(1.0, 1.0, 1.0, 0.5 * outside(0.32 * circleScale));
}

vec4 create_loading() {
  float angle = PI - atan(CENTER.x - vUv.x, CENTER.y - vUv.y);
  angle = mod(angle + loadingAngle, PI2);
  float gradient = (1.0 - smoothstep(0.0, PI2, angle)) * 0.9 + 0.1;
  return vec4(1.0, 1.0, 1.0, gradient * loadingOpacity * inside(0.2 * circleScale) * outside(0.25 * circleScale));
}

void main() {
  #include <logdepthbuf_fragment>
  gl_FragColor = vec4(1.0, 1.0, 1.0, 0);

  vec4 circleColor = create_circle();
  gl_FragColor = mix(gl_FragColor, circleColor, circleColor.a);

  vec4 loadingColor = create_loading();
  gl_FragColor = mix(gl_FragColor, loadingColor, loadingColor.a);

  gl_FragColor = mix(gl_FragColor, create_disable(), disable);

  gl_FragColor = vec4(gl_FragColor.rgb, gl_FragColor.a * opacity);
}
`,ringVertexShader=`
varying vec2 vUv;
#include <common>
#include <logdepthbuf_pars_vertex>
void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  #include <logdepthbuf_vertex>
}
`,ringFragmentShader=`
varying vec2 vUv;
uniform float opacity;
#include <common>
#include <logdepthbuf_pars_fragment>

float smoothDist = 0.01;
void main() {
  #include <logdepthbuf_fragment>
  vec2 center = vec2(0.5, 0.5);
  float dist = length(center - vUv);
  float outerDist = 0.49;
  float innerDist = 0.29;

  float outside = 1.0 - smoothstep(outerDist - smoothDist, outerDist, dist);
  float inside = smoothstep(innerDist, innerDist + smoothDist, dist);

  vec4 bg = vec4(0.576, 0.635, 1.0, 0.3);
  float gradientAlpha = clamp(abs(dist - (outerDist + innerDist) / 2.0) / (outerDist - innerDist) * 1.5 + 0.1, 0.0, 1.0);
  vec4 gradient = vec4(1.0, 1.0, 1.0, gradientAlpha);

  gl_FragColor = mix(bg, gradient, gradient.a);

  gl_FragColor = vec4(gl_FragColor.rgb, gl_FragColor.a * opacity * outside * inside);
}
`,PanoSphereMesh=function($e){__extends(Se,$e);function Se(){var Be=$e.call(this)||this;Be.progress=0,Be.opacity=0,Be.loading=!1,Be.current=!1,Be.disabled=!1,Be.currentMotion=new Motion({ringScale:1.1,ringOpacity:0,circleFade:0,circleOpacity:.85,circleScale:1}),Be.opacityMotion=new Motion({opacity:0}),Be.loadingMotion=new Motion({opacity:0}),Be.disableMotion=new Motion({opacity:0});var De={blending:CustomBlending,blendSrc:SrcAlphaFactor,blendDst:OneMinusSrcAlphaFactor,blendSrcAlpha:OneFactor,blendDstAlpha:OneMinusSrcAlphaFactor,depthWrite:!1,transparent:!0};return Be.hitTestMesh=new Mesh(sharedGeometry,new MeshBasicMaterial(__assign(__assign({},De),{color:0,opacity:0}))),Be.hitTestMesh.scale.set(1.5,1.5,1.5),Be.ringMesh=new Mesh(sharedGeometry,new ShaderMaterial(__assign(__assign({},De),{vertexShader:ringVertexShader,fragmentShader:ringFragmentShader,uniforms:{opacity:{value:0}}}))),Be.panoMesh=new Mesh(sharedGeometry,new ShaderMaterial(__assign(__assign({},De),{vertexShader:vertexShader$5,fragmentShader,uniforms:{circleScale:{value:1.1},circleFade:{value:0},circleOpacity:{value:.5},loadingAngle:{value:0},loadingOpacity:{value:0},opacity:{value:0},disable:{value:0}}}))),Be.add(Be.hitTestMesh),Be.add(Be.ringMesh),Be.add(Be.panoMesh),Be.renderOrder=1e4,Be.needsRender=!0,Be}return Se.prototype.setProgress=function(Be){this.progress=Be,this.setLoading(Be>0)},Se.prototype.setOpacity=function(Be){this.opacity!==Be&&(this.opacity=Be=clamp$1(Be,0,1),this.opacityMotion.set({opacity:Be},30).catch(noop$1))},Se.prototype.setCurrent=function(Be){if(this.current!==Be){if(Be){var De=[{progress:0,value:{ringScale:2,ringOpacity:0,circleFade:0,circleOpacity:.85,circleScale:1}},{progress:.05,value:{ringScale:1,ringOpacity:1,circleFade:0,circleOpacity:.85,circleScale:1}},{progress:.15,value:{ringScale:1.2,ringOpacity:1,circleFade:0,circleOpacity:.85,circleScale:1}},{progress:.25,value:{ringScale:1.1,ringOpacity:1,circleFade:0,circleOpacity:.85,circleScale:1}},{progress:.8,value:{ringScale:1.1,ringOpacity:1,circleFade:1,circleOpacity:.85,circleScale:1}},{progress:.9,value:{ringScale:1.1,ringOpacity:1,circleFade:1,circleOpacity:.65,circleScale:.8}},{progress:.92,value:{ringScale:1.1,ringOpacity:1,circleFade:1,circleOpacity:.65,circleScale:.8}},{progress:1,value:{ringScale:1.1,ringOpacity:1,circleFade:1,circleOpacity:.85,circleScale:1.1}}];this.currentMotion.setKeyframes(De,1500).catch(noop$1)}else{var De=[{progress:0,value:__assign({},this.currentMotion.value)},{progress:1,value:{ringScale:1.1,ringOpacity:0,circleFade:0,circleOpacity:.85,circleScale:1}}];this.currentMotion.setKeyframes(De,200).catch(noop$1)}this.current=Be}},Se.prototype.setLoading=function(Be){this.loading!==Be&&(Be?this.loadingMotion.setKeyframes([{progress:0,value:{opacity:0}},{progress:.3,value:{opacity:0}},{progress:1,value:{opacity:.8}}],500).catch(noop$1):this.loadingMotion.set({opacity:0},0).catch(noop$1),this.loading=Be,this.disabled===!0&&this.setDisabled(!1),this.needsRender=!0)},Se.prototype.setDisabled=function(Be){this.disabled!==Be&&(this.disabled=Be,this.loading===!0&&this.setLoading(!1),this.disableMotion.set({opacity:Be?1:0},300).catch(noop$1),this.needsRender=!0)},Se.prototype.tap=function(){return Promise.resolve()},Se.prototype.updateTime=function(Be,De){this.opacityMotion.update(Be),this.currentMotion.update(Be),this.loadingMotion.update(Be);var Ve=this.opacityMotion.value.opacity;this.visible=Ve!==0;var Fe=this.currentMotion.value,Je=Fe.ringScale,Xe=Fe.ringOpacity,Ke=Fe.circleFade,Ye=Fe.circleOpacity,or=Fe.circleScale;this.ringMesh.scale.set(Je,1,Je),this.ringMesh.material.uniforms.opacity.value=Xe*Ve,this.panoMesh.material.uniforms.opacity.value=Ve,this.panoMesh.material.uniforms.circleOpacity.value=Ye,this.panoMesh.material.uniforms.circleScale.value=or,this.panoMesh.material.uniforms.circleFade.value=Ke,this.panoMesh.material.uniforms.loadingOpacity.value=this.loadingMotion.value.opacity,this.panoMesh.material.uniforms.disable.value=this.disableMotion.value.opacity,this.panoMesh.material.uniforms.loadingAngle.value=Be/120%(Math.PI*2),this.needsRender=!0},Se.prototype.dispose=function(){this.hitTestMesh.material.dispose(),this.ringMesh.material.dispose(),this.panoMesh.material.dispose()},Se}(Object3D),ACTIVE_TO_CURRENT_DELAY=1500;__assign({},omit(defaultPanoramaControllerCustomInitArgs,["maxLatitude","minLatitude"]));var VRPanoramaController=function($e){__extends(Se,$e);function Se(Be){var De=this,Ve=Se.parseArgs(Be);De=$e.call(this,Ve)||this,De.mode="VRPanorama",De.cardboard=new Cardboard(De.renderer);var Fe=createHelper();De.helperElement=Fe;var Je=new Hammer(Fe);return De.element.parentNode&&(De.element.parentNode.insertBefore(Fe,De.element),De.setHelperElementSize(),Je.on("tap",function(){return De.emit("vr.requestExit",createEvent("vr.requestExit",{}))})),De.destroyHelper=function(){Je.destroy(),Fe.parentNode&&Fe.parentNode.removeChild(Fe),delete De.helperElement},De}return Se.parseArgs=function(Be){if(Be instanceof Se)return Be;var De=__assign(__assign({},Be),{maxLatitude:Math.PI/2,minLatitude:-Math.PI/2});return $e.parseArgs.call(this,De)},Se.initAnimationEndState=function(Be){var De=this.parseArgs(Be),Ve=$e.initAnimationEndState.call(this,De);return __assign(__assign({},Ve),{mode:"VRPanorama"})},Se.prototype.updateConfiguration=function(Be){return $e.prototype.updateConfiguration.call(this,__assign(__assign({},Be),{maxLatitude:Math.PI/2,minLatitude:-Math.PI/2}))},Se.prototype.destroy=function(){$e.prototype.destroy.call(this),this.cardboard.dispose(),this.destroyHelper();for(var Be=Object.keys(this.panoMeshes),De=0,Ve=Be;De<Ve.length;De++){var Fe=Ve[De],Je=this.panoMeshes[Fe];this.helper.remove(Je),Je.dispose(),delete this.panoMeshes[Fe]}},Se.prototype.isReady=function(){return!1},Se.prototype.updateRenderSize=function(){this.needsRender=!0,this.modelSceneNeedsRender=!0,this.setHelperElementSize()},Se.prototype.updateCamera=function(Be,De,Ve){return Promise.resolve()},Se.prototype.updateCameraWithKeyframes=function(Be,De,Ve){return Promise.resolve()},Se.prototype.updatePanoMeshesVisible=function(){for(var Be=this.works.getResolvedObserver(this.currentPano),De=(Be?Be.visibleIds:[]).concat(panoStringify(this.currentPano)),Ve=0,Fe=this.works.resolvedObservers;Ve<Fe.length;Ve++){var Je=Fe[Ve],Xe=this.panoMeshes[Je.panoId];Xe&&(De.indexOf(Je.panoId)>=0?Xe.parent!==this.helper&&this.helper.add(Xe):Xe.parent===this.helper&&(this.helper.remove(Xe),Xe.setOpacity(0)))}},Se.prototype.updatePanoMeshes=function(){for(var Be=Object.keys(this.panoMeshes),De=0,Ve=Be;De<Ve.length;De++){var Fe=Ve[De],Je=this.panoMeshes[Fe];this.helper.remove(Je),Je.dispose(),delete this.panoMeshes[Fe]}for(var Xe=0,Ke=this.works.resolvedObservers;Xe<Ke.length;Xe++){var Ye=Ke[Xe],or=Ye.panoId,sr=new PanoSphereMesh;sr.name="panoSphere_".concat(or),sr.position.copy(Ye.position),sr.needsRender=!0,this.panoMeshes[or]=sr}this.updatePanoMeshesVisible()},Se.prototype.updateTime=function(Be,De){var Ve=this,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn;if(!this.destroyed){var en=this.currentPano;this.userAction=!0,this.needsRender=!0,this.modelSceneNeedsRender=!0;var an={},rn={},on=this.panoResourceFromLocationMotionKeyframe(this.locationMotion.keyframes[0]),sn=this.panoResourceFromLocationMotionKeyframe(this.locationMotion.keyframes[this.locationMotion.keyframes.length-1]),ln=!1;if(this.modelAlphaMotion.ended===!1&&(this.modelAlphaMotion.update(Be),an.modelAlpha=this.modelAlphaMotion.value.modelAlpha),this.perspToOrthoMotion.ended===!1&&(this.perspToOrthoMotion.update(Be),this.camera.perspToOrtho.setScalar(clamp$1(this.perspToOrthoMotion.value.perspToOrtho,0,1))),this.locationMotion.ended===!1){this.locationMotion.update(Be);var cn=this.locationMotion.getKeyFrameSegment(Be),hn=cn[0],mn=cn[1],An=this.panoResourceFromLocationMotionKeyframe(hn),xn=this.panoResourceFromLocationMotionKeyframe(mn),pn=An.position,dn=xn.position,fn=this.locationMotion.value.count-mn.value.count+1;an.progress=fn,xn.panoPicture&&(fn<1?An.panoPicture&&(an.pano0=An.panoPicture):an.pano0=xn.panoPicture,an.pano1=xn.panoPicture),xn.effect==="montage"?an.transition="BLACK":xn.effect==="spread"?an.transition="SPREAD":an.transition="FADE",(xn.effect==="zoomin"||xn.effect==="zoomout")&&(an.progress=Math.pow(fn,3)),fn<1&&xn.effect!=="fly"&&(an.pano0&&An.panoPicture&&(an.pano0={map:an.pano0.map,zoom:an.pano0.zoom,luminanceMap:an.pano0.luminanceMap,matrix:An.panoPicture.matrix.clone().premultiply(An.fixCameraTransform).setPosition(xn.position)}),pn.copy(dn),ln=!0),rn.distance=this.locationMotion.value.distance,rn.offset=new Vector3(pn.x+(dn.x-pn.x)*fn,pn.y+(dn.y-pn.y)*fn,pn.z+(dn.z-pn.z)*fn);for(var yn=[],Sn=[],gn=0,Cn=this.locationMotion.keyframes;gn<Cn.length;gn++){var Mn=Cn[gn],Bn=Mn.key,kn=Mn.progress;Bn!==void 0&&(yn.push(Bn),kn>this.locationMotion.progress&&Sn.push(Bn))}for(var Ln=0,Pn=Object.keys(this.panoResources);Ln<Pn.length;Ln++){var Vn=Pn[Ln];if(!(Sn.indexOf(Vn)>=0)){var Yn=this.panoResources[Vn];if(Yn.panoPicture){var ni=Yn.panoPicture.map,Rn=Yn.panoPicture.luminanceMap;if(ni){if(ni===((Fe=an.pano0)===null||Fe===void 0?void 0:Fe.map)||ni===((Je=an.pano1)===null||Je===void 0?void 0:Je.map))continue;ni instanceof TileCubeTextureTarget&&ni.cubeRenderTarget&&this.colorCubeRenderTargetPool.push(ni.cubeRenderTarget),ni.dispose(),Rn&&(Rn instanceof TileCubeTextureTarget&&Rn.cubeRenderTarget&&this.luminanceCubeRenderTargetPool.push(Rn.cubeRenderTarget),Rn.dispose()),Yn.panoPicture=null}}yn.indexOf(Vn)>=0||delete this.panoResources[Vn]}}this.currentPano=panoParse(xn.panoId),this.emit("pano.moving",createEvent("pano.moving",{userAction:this.userAction,prevPano:panoParse(on.panoId),state:__assign(__assign(__assign(__assign({},panoParse(sn.panoId)),{mode:this.mode}),clonePose(this.camera.pose)),rn),options:{},progress:this.locationMotion.progress,error:null}))}isEmptyObject(an)===!1&&(!((Xe=an.pano0)===null||Xe===void 0)&&Xe.map&&an.pano0.map instanceof TileCubeTextureTarget&&!an.pano0.map.cubeRenderTarget&&(an.pano0.map.cubeRenderTarget=this.colorCubeRenderTargetPool.pop()),!((Ke=an.pano0)===null||Ke===void 0)&&Ke.luminanceMap&&an.pano0.luminanceMap instanceof TileCubeTextureTarget&&!an.pano0.luminanceMap.cubeRenderTarget&&(an.pano0.luminanceMap.cubeRenderTarget=this.luminanceCubeRenderTargetPool.pop()),!((Ye=an.pano1)===null||Ye===void 0)&&Ye.map&&an.pano1.map instanceof TileCubeTextureTarget&&!an.pano1.map.cubeRenderTarget&&(an.pano1.map.cubeRenderTarget=this.colorCubeRenderTargetPool.pop()),!((or=an.pano1)===null||or===void 0)&&or.luminanceMap&&an.pano1.luminanceMap instanceof TileCubeTextureTarget&&!an.pano1.luminanceMap.cubeRenderTarget&&(an.pano1.luminanceMap.cubeRenderTarget=this.luminanceCubeRenderTargetPool.pop()),this.models.setMaterial(an)),rn.offset&&this.camera.position.copy(rn.offset),panoEqual(this.currentPano,en)&&this.updatePanoMeshesVisible();var In=this.camera.pose.longitude,Gn=this.camera.pose.latitude;this.camera.quaternion.fromArray(this.cardboard.sensor.getOrientation()),this.camera.computePose();var Fn=this.works.getResolvedObserver(this.currentPano);if(this.camera.pose.distance>.1||ln)for(var Hn=0,Dn=Object.keys(this.panoMeshes);Hn<Dn.length;Hn++){var zn=Dn[Hn],Qn=this.panoMeshes[zn];Qn.setOpacity(0),Qn.updateTime&&Qn.updateTime(Be,De),Qn.visible=!1}else if(Fn)for(var Zn=Fn.visibleIds.concat(panoStringify(this.currentPano)),si=0,ei=Zn;si<ei.length;si++){var zn=ei[si],hi=panoParse(zn),Un=this.works.getResolvedObserver(hi);if(Un){var Qn=this.panoMeshes[zn];if(!Un.loadable&&!Un.active){Qn.setOpacity(0);continue}var Wn=Qn.position.clone().setY(this.camera.position.y).distanceTo(this.camera.position);Wn<.05?Qn.setOpacity(0):Qn.setOpacity(clamp$1(1.5/Wn,0,1)),panoEqual(this.currentPano,hi)&&Qn.setOpacity(0),Qn.lookAt(this.camera.position)}}if(this.locationMotion.ended)for(var Ai=this.intersect(Be),oi=0,ci=this.works.resolvedObservers;oi<ci.length;oi++){var Un=ci[oi],Qn=this.panoMeshes[Un.panoId];Qn&&(Qn.setCurrent(Qn===Ai),Qn.updateTime&&Qn.updateTime(Be,De))}(In!==this.camera.pose.longitude||Gn!==this.camera.pose.latitude)&&(this.cameraMotion.set(pick(this.camera.pose,["longitude","latitude"]),0).catch(noop$1),this.emit("camera.update",createEvent("camera.update",{userAction:!0,state:__assign(__assign(__assign({},this.currentPano),{mode:this.mode}),clonePose(this.camera.pose))})));var ai=this.tileLevel=function(){if(Ve.tileLevelForFov===!1)return 0;var _i=Ve.renderer.getDrawingBufferSize(new Vector2);_i.width*=Ve.scissor.width,_i.height*=Ve.scissor.height;var Mi=sn.panoId,$i=Ve.works.getResolvedObserver(Mi),vi=Ve.imageOptions.size;if(typeof vi>"u"&&$i){var ri=$i.images.up.match(/\/cube_(\d+)\//);ri&&(vi=Number(ri[1]))}typeof vi>"u"&&(vi=2048);var Ti=0;vi>=1024&&(Ti=1),vi>=2048&&(Ti=2),vi>=4096&&(Ti=3),vi>=8192&&(Ti=4);var Bi=Ve.tileLevelForFov(Ve.camera.fov,_i);return Bi>Ti?Bi:0}(),wi=function(){var _i=Ve.camera.quaternion.clone(),Mi=Ve.works.getResolvedObserver(sn.panoId),$i=Mi??Fn;$i&&_i.premultiply($i.quaternion.clone().inverse());var vi=new Matrix4().makeRotationFromQuaternion(_i),ri=new Matrix4().getInverse(vi),Ti=new Frustum().setFromProjectionMatrix(new Matrix4().multiplyMatrices(Ve.camera.projectionMatrix,ri));return Ti}();sn.panoId===panoStringify(this.currentPano)&&(((sr=sn.panoPicture)===null||sr===void 0?void 0:sr.map)instanceof TileCubeTextureTarget&&(sn.panoPicture.map.maxRequest=this.tileMaxRequest,sn.panoPicture.map.update(wi,ai),sn.panoPicture.map.needsRender===!0&&(sn.panoPicture.map.needsRender=!1,this.needsRender=!0,this.modelSceneNeedsRender=!0)),((cr=sn.panoPicture)===null||cr===void 0?void 0:cr.luminanceMap)instanceof TileCubeTextureTarget&&(sn.panoPicture.luminanceMap.maxRequest=this.tileMaxRequest,sn.panoPicture.luminanceMap.update(wi,ai),sn.panoPicture.luminanceMap.needsRender===!0&&(sn.panoPicture.luminanceMap.needsRender=!1,this.needsRender=!0,this.modelSceneNeedsRender=!0)));{var Pi=this.tiling.object.visible;if(this.initAnimationed){var Oi=sn.panoId,Ri=this.works.getResolvedObserver(Oi);Ri?isSimilarVector3(this.camera.position,Ri.position)&&this.locationMotion.ended?(this.tiling.object.visible=!0,this.tiling.panoId!==Oi&&this.tiling.cleanup(),this.tiling.panoId=Oi,this.tiling.setResource((tn=(Br=Ri.images)===null||Br===void 0?void 0:Br.tiles)!==null&&tn!==void 0?tn:[],this.enableIOSEDR&&Ri.images.luminance?Ri.images.luminance:null),this.tiling.setFetcher(getFetcher(Ri.work)),this.tiling.setRotation(Ri.quaternion),this.tiling.setPosition(Ri.position),this.tiling.maxRequest=this.tileMaxRequest,ai>this.tiledCubeTextureLevel?this.tiling.update(wi,ai,Be):this.tiling.update(wi,0,Be)):this.tiling.object.visible=!1:this.tiling.object.visible=!1}else this.tiling.object.visible=!1;Pi!==this.tiling.object.visible&&(this.tiling.object.needsRender=!0,this.modelSceneNeedsRender=!0)}this.panoVideo.object.position.copy(this.camera.position),this.panoVideo.updateTime(Be)}},Se.prototype.render=function(){this.cardboard.render(this.modelScene,this.camera),this.renderer.autoClear=!1,this.cardboard.render(this.scene,this.camera),this.renderer.autoClear=!0},Se.prototype.setCamera=function(Be){},Se.prototype.destroyHelper=function(){},Se.prototype.setHelperElementSize=function(){if(this.helperElement){var Be=new Vector2(this.element.offsetWidth,this.element.offsetHeight),De=Be.x*this.scissor.left,Ve=Be.y*(1-this.scissor.bottom-this.scissor.height),Fe=Be.x*this.scissor.width,Je=Be.y*this.scissor.height;this.helperElement.style.marginLeft=De+"px",this.helperElement.style.marginTop=Ve+"px",this.helperElement.style.width=Fe+"px",this.helperElement.style.height=Je+"px"}},Se.prototype.intersect=function(Be){var De,Ve;if(this.locationMotion.ended===!1){this.intersectMesh.visible=!1,delete this.activePanoMesh,delete this.activeTime;return}if(this.activePanoMesh&&this.activeTime&&Be-this.activeTime>ACTIVE_TO_CURRENT_DELAY){for(var Fe=this.activePanoMesh,Je=Object.keys(this.panoMeshes),Xe=null,Ke=0,Ye=Je;Ke<Ye.length;Ke++){var or=Ye[Ke];if(this.panoMeshes[or]===Fe){Xe=or;break}}return Xe!==null&&this.moveToPano(panoParse(Xe),{},!0),delete this.activePanoMesh,delete this.activeTime,Fe}var sr=this.camera.getDirection(new Vector3),cr=new Raycaster(this.camera.position,sr);cr.params.Points={threshold:.1};for(var Br=void 0,tn=[],en=this.works.getResolvedObserver(this.currentPano),an=en?en.visibleIds:[],rn=0,on=an;rn<on.length;rn++){var Xe=on[rn],sn=this.panoMeshes[Xe],ln=cr.intersectObject((De=sn.hitTestMesh)!==null&&De!==void 0?De:sn,!0)[0];ln&&tn.push({panoMesh:sn,intersection:__assign({floor:(Ve=en?.floorIndex)!==null&&Ve!==void 0?Ve:0},ln)})}var cn=tn.sort(function(pn,dn){return pn.intersection.distance-dn.intersection.distance})[0];cn?(Br=cn.intersection,this.activePanoMesh!==cn.panoMesh&&(this.activePanoMesh=cn.panoMesh,this.activeTime=Be),this.intersectMesh.position.copy(cn.panoMesh.position),this.intersectMesh.lookAt(this.camera.position)):(this.activePanoMesh=void 0,this.activeTime=void 0),Br||(Br=this.models.intersectRaycaster(cr)[0]);var hn=createEvent("intersect.update",{raycaster:cr,intersection:Br??null,object:this.intersectMesh});if(this.emit("intersect.update",hn),hn.defaultPrevented){this.hideIntersectMesh();return}if(Br&&Br.face){var mn=Br.face.normal,An=new Quaternion;An.setFromUnitVectors(new Vector3(0,0,1),mn),this.intersectMesh.quaternion.copy(An);var xn=Br.point.clone();this.intersectMesh.position.copy(xn),cn?this.intersectMesh.visible=!1:this.intersectMesh.visible=!0}else this.intersectMesh.visible=!1;return cn?.panoMesh},Se.prototype.onPanGesture=function(){},Se.prototype.onTapGesture=function(){},Se.prototype.onPinchGesture=function(){},Se.prototype.onMouseMove=function(){},Se.prototype.onMouseOut=function(){},Se}(PanoramaController),HUMAN_EYE_POSITION=new Vector3(0,1.6,0);__assign({},defaultPanoramaLikeControllerCustomInitArgs);var ModelController=function($e){__extends(Se,$e);function Se(Be){var De=this,Ve,Fe=Se.parseArgs(Be);return De=$e.call(this,Fe)||this,De.mode="Model",De.locationMotion=new Motion({x:De.camera.pose.offset.x,y:De.camera.pose.offset.y,z:De.camera.pose.offset.z,distance:De.camera.pose.distance}),De.modelAlphaMotion=new Motion({modelAlpha:(Ve=De.models.getMaterial().modelAlpha)!==null&&Ve!==void 0?Ve:0}),De.perspToOrthoMotion=new Motion({perspToOrtho:De.camera.perspToOrtho.x}),De}return Se.parseArgs=function(Be){return Be instanceof Se?Be:$e.parseArgs.call(this,Be)},Se.initAnimationEndState=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye=this.parseArgs(Be),or=Ye.works,sr=Be.initial,cr=sr.state,Br=sr.currentState,tn=typeof cr.panoIndex=="number"?{workCode:(Fe=(De=cr.workCode)!==null&&De!==void 0?De:(Ve=Ye.works[0])===null||Ve===void 0?void 0:Ve.workCode)!==null&&Fe!==void 0?Fe:"",panoIndex:cr.panoIndex}:{workCode:Br.workCode,panoIndex:Br.panoIndex},en=or.getResolvedObserver(tn),an=(Je=cr.longitude)!==null&&Je!==void 0?Je:Br.longitude,rn=clamp$1((Xe=cr.latitude)!==null&&Xe!==void 0?Xe:!en||isFristPersonMode(Br.mode)?Br.latitude:Ye.defaultLatitude,Ye.minLatitude,Ye.maxLatitude),on=clamp$1((Ke=cr.fov)!==null&&Ke!==void 0?Ke:!en||isFristPersonMode(Br.mode)?Br.fov:Ye.defaultFov,Ye.minFov,Ye.maxFov),sn=new Vector3;if(Ye.initial.state.offset)sn.copy(Ye.initial.state.offset);else if(en)sn.copy(en.position);else{var ln=coordinatesToVector(Br).setLength(Br.distance);sn.copy(Ye.initial.currentState.offset).sub(ln)}return{workCode:tn.workCode,panoIndex:tn.panoIndex,mode:"Model",longitude:an,latitude:rn,fov:on,offset:sn,distance:0}},Se.prototype.updateConfiguration=function(Be){return $e.prototype.updateConfiguration.call(this,Be)},Se.prototype.destroy=function(){$e.prototype.destroy.call(this),this.locationMotion.dispose()},Se.prototype.isReady=function(){return this.locationMotion.ended===!1?!1:$e.prototype.isReady.call(this)},Se.prototype.updateWork=function(Be,De,Ve,Fe){this.works=Be;var Je=Se.initAnimationEndState(__assign(__assign({},this),{initial:{currentState:__assign(__assign({},this.currentPano),this.camera.pose),duration:Ve.duration,effect:Ve.effect,state:De,userAction:Fe}}));return this.hideIntersectMesh(),this.moveToPosition(Je.offset,{duration:0,longitude:Je.longitude,latitude:Je.latitude,fov:Je.fov},Fe),!0},Se.prototype.updateCamera=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();var Je={},Xe={};return Je.distance=0,Be.offset!==void 0&&(Je.x=Be.offset.x,Je.y=Be.offset.y,Je.z=Be.offset.z),Be.longitude!==void 0&&(Xe.longitude=Be.longitude),Be.latitude!==void 0&&(Xe.latitude=Be.latitude),Be.fov!==void 0&&(Xe.fov=Be.fov),Fe.locationMotion.set(Je,De).catch(noop$1),Fe.cameraMotion.set(Xe,De).catch(noop$1)})},Se.prototype.updateCameraWithKeyframes=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();for(var Je=[],Xe=[],Ke=0,Ye=Be;Ke<Ye.length;Ke++){var or=Ye[Ke];Je.push({key:or.key,progress:or.progress,value:{distance:0,x:or.value.offset.x,y:or.value.offset.x,z:or.value.offset.x}}),Xe.push({key:or.key,progress:or.progress,value:{longitude:or.value.longitude,latitude:or.value.latitude,fov:or.value.fov}})}return Fe.locationMotion.setKeyframes(Je,De).catch(noop$1),Fe.cameraMotion.setKeyframes(Be,De)})},Se.prototype.updateTime=function(Be,De){if(!this.destroyed){var Ve={},Fe={};if(this.modelAlphaMotion.ended||(this.modelAlphaMotion.update(Be),Ve.modelAlpha=this.modelAlphaMotion.value.modelAlpha),this.perspToOrthoMotion.ended||(this.perspToOrthoMotion.update(Be),this.camera.perspToOrtho.setScalar(clamp$1(this.perspToOrthoMotion.value.perspToOrtho,0,1))),!this.locationMotion.ended){this.locationMotion.update(Be),Fe.distance=this.locationMotion.value.distance,Fe.offset=new Vector3(this.locationMotion.value.x,this.locationMotion.value.y,this.locationMotion.value.z);var Je=new Vector3(this.locationMotion.value.x,this.locationMotion.value.y,this.locationMotion.value.z),Xe=this.works.resolvedObservers,Ke=arrayMin(Xe,function(Ye){return Ye.position.distanceTo(Je)});this.currentPano=Ke?{workCode:Ke.work.workCode,panoIndex:Ke.panoIndex}:{workCode:"",panoIndex:0}}this.cameraMotion.ended||(this.cameraMotion.update(Be),Fe.longitude=this.cameraMotion.value.longitude,Fe.latitude=this.cameraMotion.value.latitude,Fe.fov=this.cameraMotion.value.fov),isEmptyObject(Ve)||this.models.setMaterial(Ve),isEmptyObject(Fe)||this.setCamera(Fe)}},Se.prototype.initAnimation=function(){var Be=this;return this.destroyed?Promise.resolve():new Promise(function(De){var Ve=Be.initial;Ve.state,Ve.currentState;var Fe=Ve.duration,Je=Ve.userAction;Be.userAction=Je;var Xe=Se.initAnimationEndState(Be),Ke={modelAlpha:1},Ye={perspToOrtho:0},or={longitude:Xe.longitude,latitude:Xe.latitude,fov:Xe.fov,duration:Fe,moveStartCallback:function(sr){Be.perspToOrthoMotion.set(Ye,Fe).catch(noop$1),Be.modelAlphaMotion.set(Ke,Fe).catch(noop$1),Be.emit("initAnimation.start",createEvent("initAnimation.start",{state:sr,userAction:Be.userAction}))},moveEndCallback:function(sr){Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:sr,userAction:Be.userAction})),De()},moveCancelCallback:function(){var sr=Be.currentPano,cr=__assign(__assign({},sr),{mode:Be.mode,longitude:Be.camera.pose.longitude,latitude:Be.camera.pose.latitude,fov:Be.camera.pose.fov,offset:Be.camera.pose.offset.clone(),distance:Be.camera.pose.distance});Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:cr,userAction:Be.userAction})),De()}};Be.moveToPosition(Xe.offset,or,Je)})},Se.prototype.getTargetState=function(){var Be=this.cameraMotion.getKeyFrameSegment(now$2())[1],De=this.locationMotion.getKeyFrameSegment(now$2())[1];return __assign(__assign({},this.currentPano),{mode:this.mode,longitude:Be.value.longitude,latitude:Be.value.latitude,fov:Be.value.fov,offset:new Vector3(De.value.x,De.value.y,De.value.z),distance:De.value.distance})},Se.prototype.moveToPano=function(Be,De,Ve){De===void 0&&(De={});var Fe=this.works.getResolvedObserver(Be);Fe&&this.moveToPosition(Fe.position,De,Ve)},Se.prototype.moveToPosition=function(Be,De,Ve){var Fe=this,Je,Xe,Ke;De===void 0&&(De={}),this.userAction=Ve,this.stopMomentumMovement();for(var Ye=now$2(),or=new Vector3(this.locationMotion.value.x,this.locationMotion.value.y,this.locationMotion.value.z),sr=or.distanceTo(Be),cr=this.locationMotion.getProgressVelocity(Ye),Br=0,tn=1;tn<this.locationMotion.keyframes.length;tn++){var en=this.locationMotion.keyframes[tn-1].value,an=en.x,rn=en.y,on=en.z,sn=this.locationMotion.keyframes[tn].value,ln=sn.x,cn=sn.y,hn=sn.z;Br+=Math.sqrt(Math.pow(ln-an,2)+Math.pow(cn-rn,2)+Math.pow(hn-on,2))}var mn=sr===0?0:cr*Br/sr,An=this.calculateMovingDuration(De.duration,sr),xn={x:Be.x,y:Be.y,z:Be.z,distance:0},pn={longitude:De.longitude,latitude:De.latitude,fov:De.fov},dn=this.works.resolvedObservers,fn=arrayMin(dn,function(Cn){return Cn.position.distanceTo(or)}),yn=fn?{workCode:fn.work.workCode,panoIndex:fn.panoIndex}:{workCode:"",panoIndex:0},Sn=__assign(__assign({},yn),{mode:this.mode,longitude:(Je=pn.longitude)!==null&&Je!==void 0?Je:this.camera.pose.longitude,latitude:(Xe=pn.latitude)!==null&&Xe!==void 0?Xe:this.camera.pose.latitude,fov:(Ke=pn.fov)!==null&&Ke!==void 0?Ke:this.camera.pose.fov,offset:Be.clone(),distance:0}),gn=this.currentPano;this.emit("pano.moveTo",createEvent("pano.moveTo",{options:De,prevPano:gn,progress:0,state:Sn,userAction:this.userAction,error:null})),De.moveStartCallback&&De.moveStartCallback(Sn),this.cameraMotion.set(pn,An).catch(noop$1),this.locationMotion.set(xn,An,mn).then(function(){for(var Cn=0,Mn=Fe.models;Cn<Mn.length;Cn++){var Bn=Mn[Cn];Bn.show()}var kn=__assign(__assign(__assign({},yn),{mode:Fe.mode}),clonePose(Fe.camera.pose));Fe.emit("pano.arrived",createEvent("pano.arrived",{options:De,prevPano:gn,progress:0,state:kn,userAction:Fe.userAction,error:null})),De.moveEndCallback&&De.moveEndCallback(kn)},function(){De.moveCancelCallback&&De.moveCancelCallback(),Fe.emit("pano.cancel",createEvent("pano.cancel",{options:De,prevPano:gn,progress:0,state:Sn,userAction:Fe.userAction,error:null}))})},Se.prototype.onTapGesture=function(Be){var De=Be.center.raycaster;this.stopMomentumMovement();var Ve=this.models.intersectRaycaster(De)[0];if(Ve&&Ve.face){var Fe=Ve.face.normal,Je=Ve.point;if(new Vector3(0,1,0).angleTo(Fe)>Math.PI/3){var Xe=Fe.clone().setLength(.3).add(Je);De.set(Xe,new Vector3(0,-1,0)),Ve=this.models.intersectRaycaster(De)[0]}}if(Ve){var Ke=new Vector3().copy(Ve.point).add(HUMAN_EYE_POSITION),Ye=this.works.resolvedObservers,or=arrayMin(Ye,function(Br){return Br.position.distanceTo(Ke)},!0),sr=or[0],cr=or[1];sr&&cr<5&&(Ke.y=sr.position.y),Be.state.offset.copy(Ke),Be.state.distance=0,this.emit("gesture.tap",Be),Be.defaultPrevented||this.moveToPosition(Ke,{},!0)}else this.emit("gesture.tap",Be),Be.defaultPrevented||this.cameraBounce()},Se}(PanoramaLikeController);const edlVertexShader=function $e(){for(var Se=[],Be=0;Be<arguments.length;Be++)Se[Be]=arguments[Be];var De=113,Ve=126,Fe=0,Je="";return Se[Fe].split(Je).map(function(Xe){return Xe.charCodeAt(Fe)>Ve?Xe:String.fromCharCode((Xe.charCodeAt(Fe)+De)%Ve)}).join(Je)}(`}rpvv|{-zrqvz}-sy|nH}rpvv|{-zrqvz}-v{Hnvor-rp@-}|vv|{Hnvor-rp?-H{vs|z-znA-}|wrpv|{Znv\x07H{vs|z-znA-z|qrycvrZnv\x07Hn\bv{t-rp?-bH|vq-znv{56-
b-J-HrpA-z]|vv|{-J-z|qrycvrZnv\x07-7-rpA5}|vv|{9>;=6Htyl]|vv|{-J-}|wrpv|{Znv\x07-7-z]|vv|{H\f`),edlFragmentShader=function $e(){for(var Se=[],Be=0;Be<arguments.length;Be++)Se[Be]=arguments[Be];var De=113,Ve=126,Fe=0,Je="";return Se[Fe].split(Je).map(function(Xe){return Xe.charCodeAt(Fe)>Ve?Xe:String.fromCharCode((Xe.charCodeAt(Fe)+De)%Ve)}).join(Je)}(`0r\x07r{v|{-TYlRealsntlqr}u-G-r{noyr<<<<-nqn}rq-s|z-ur-RQY-unqr-p|qr-s|z-Puvvn{-O|pur{\b-v{-py|q-p|z}nrG<<-u}G<<tvuo;p|z<py|qp|z}nr<{x<rr<znr<}ytv{<\0RQY<unqr<RQY<<}rpvv|{-zrqvz}-sy|nH}rpvv|{-zrqvz}-v{H{vs|z-sy|n-prr{dvquH{vs|z-sy|n-prr{UrvtuH{vs|z-rp?-{rvtuo|h[RVTUO\\b_lP\\b[ajH{vs|z-sy|n-rqy\`r{tuH{vs|z-sy|n-nqvH{vs|z-sy|n-|}npv\bH{vs|z-sy|n-[rnH{vs|z-sy|n-SnH{vs|z-znA-]|wH{vs|z-nz}yr?Q-RQYP|y|Hn\bv{t-rp?-bHsy|n-r}|{r5sy|n-qr}u6
--rp?-_nqv-J-nqv-<-rp?5prr{dvqu9-prr{Urvtu6H--sy|n-z-J-=;=H--s|5v{-v-J-=H-v-I-[RVTUO\\b_lP\\b[aH-v886
----rp?-[rvtuo|-J-b-8-_nqv-7-{rvtuo|hvjH----sy|n-{rvtuo|Qr}u-J-r\x07r?Q5RQYP|y|9-[rvtuo|6;nH----{rvtuo|Qr}u-J-5{rvtuo|Qr}u-JJ->;=6-L-=;=-G-{rvtuo|Qr}uH----vs5{rvtuo|Qr}u-.J-=;=6
------vs5qr}u-JJ-=;=6
--------z-8J->==;=H------\fryr
--------z-8J-zn\x075=;=9-qr}u-:-{rvtuo|Qr}u6H------\f----\f--\f--r{-z-<-sy|n5[RVTUO\\b_lP\\b[a6H\f|vq-znv{56
--rpA-pRQY-J-r\x07r?Q5RQYP|y|9-b6H--sy|n-qr}u-J-pRQY;nH--qr}u-J-5qr}u-JJ->;=6-L-=;=-G-qr}uH--sy|n-r-J-r}|{r5qr}u6H--sy|n-unqr-J-r\x07}5:r-7-@==;=-7-rqy\`r{tu6H--tylSntP|y|-J-rpA5pRQY;to-7-unqr9-|}npv\b6H--
-<<-vr-rtyn-u\b}ro|yvp-qr}u-nyr-|-qr}u-ossr----sy|n-qy-J-}|5?;=9-qr}u6H----rpA-q}-J-]|w-7-rpA5=;=9-=;=9-:qy9->;=6H----sy|n-}	-J-q};	-<-q};H----sy|n-sntQr}u-J-5}	-8->;=6-<-?;=H----<<-tylSntQr}uRea-J-sntQr}uH--\f--vs5qr}u-JJ-=;=6
----qvpnqH--\f\f`);var EDLMaterial=function($e){__extends(Se,$e);function Se(Be){var De=$e.call(this)||this;return De.uniforms={screenWidth:makeUniform$1("f",0),screenHeight:makeUniform$1("f",0),edlStrength:makeUniform$1("f",1),uNear:makeUniform$1("f",1),uFar:makeUniform$1("f",1),radius:makeUniform$1("f",1),neighbours:makeUniform$1("2fv",new Float32Array),depthMap:makeUniform$1("t",new Texture),uEDLColor:makeUniform$1("t",new Texture),uEDLDepth:makeUniform$1("t",new Texture),opacity:makeUniform$1("f",1),uProj:makeUniform$1("Matrix4fv",new Float32Array)},De.neighbourCount=8,De.updateShaderSource(),De.transparent=!0,De}return Se.prototype.getUniform=function(Be){return this.uniforms===void 0?void 0:this.uniforms[Be].value},Se.prototype.setUniform=function(Be,De){if(this.uniforms!==void 0){var Ve=this.uniforms[Be];Ve.value=De}},Se.prototype.getDefines=function(){var Be="";return Be+="#define NEIGHBOUR_COUNT "+this.neighbourCount+`
`,Be},Se.prototype.updateShaderSource=function(){var Be=this.getDefines()+edlVertexShader,De=this.getDefines()+edlFragmentShader;this.setValues({vertexShader:Be,fragmentShader:De}),this.needsUpdate=!0},__decorate([uniform$1("screenWidth"),__metadata("design:type",Number)],Se.prototype,"screenWidth",void 0),__decorate([uniform$1("screenHeight"),__metadata("design:type",Number)],Se.prototype,"screenHeight",void 0),__decorate([uniform$1("edlStrength"),__metadata("design:type",Number)],Se.prototype,"edlStrength",void 0),__decorate([uniform$1("uNear"),__metadata("design:type",Number)],Se.prototype,"uNear",void 0),__decorate([uniform$1("uFar"),__metadata("design:type",Number)],Se.prototype,"uFar",void 0),__decorate([uniform$1("radius"),__metadata("design:type",Number)],Se.prototype,"radius",void 0),__decorate([uniform$1("neighbours",!0),__metadata("design:type",Float32Array)],Se.prototype,"neighbours",void 0),__decorate([uniform$1("depthMap"),__metadata("design:type",Texture)],Se.prototype,"depthMap",void 0),__decorate([uniform$1("uEDLColor"),__metadata("design:type",Texture)],Se.prototype,"uEDLColor",void 0),__decorate([uniform$1("uEDLDepth"),__metadata("design:type",Texture)],Se.prototype,"uEDLDepth",void 0),__decorate([uniform$1("uProj"),__metadata("design:type",Array)],Se.prototype,"uProj",void 0),Se}(RawShaderMaterial);function makeUniform$1($e,Se){return{type:$e,value:Se}}function uniform$1($e,Se){return Se===void 0&&(Se=!1),function(Be,De){Object.defineProperty(Be,De,{get:function(){return this.getUniform($e)},set:function(Ve){Ve!==this.getUniform($e)&&(this.setUniform($e,Ve),Se&&this.updateShaderSource())}})}}var passCamera$1=new OrthographicCamera(-1,1,1,-1,0,1),geometry$2=new BufferGeometry;geometry$2.setAttribute("position",new Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3));geometry$2.setAttribute("uv",new Float32BufferAttribute([0,2,0,0,2,0],2));var mesh$2=new Mesh(geometry$2),edlEffectScene=new Scene$1;edlEffectScene.add(mesh$2);var EDLEffect=function($e){__extends(Se,$e);function Se(Be,De,Ve,Fe){var Je=$e.call(this,Be,De,Ve,Fe)||this;return Je.sharedV2=new Vector2,Je.renderer=Be,Je.material=new EDLMaterial,mesh$2.material=Je.material,Je.material.needsUpdate=!0,Je}return Se.prototype.render=function(Be){this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0,this.renderer.setRenderTarget(Be[0]),this.renderer.render(this.scene,this.camera);var De=this.camera,Ve=this.material.uniforms,Fe=this.renderer.getSize(this.sharedV2);Ve.screenWidth.value=Fe.x,Ve.screenHeight.value=Fe.y;var Je=De.projectionMatrix,Xe=new Float32Array(16);Xe.set(Je.elements);for(var Ke=new Float32Array(this.material.neighbourCount*2),Ye=0;Ye<this.material.neighbourCount;Ye++)Ke[2*Ye+0]=Math.cos(2*Ye*Math.PI/this.material.neighbourCount),Ke[2*Ye+1]=Math.sin(2*Ye*Math.PI/this.material.neighbourCount);Ve.neighbours.value=Ke,Ve.uNear.value=De.near,Ve.uFar.value=De.far,Ve.uEDLColor.value=Be[0].texture,Ve.uProj.value=Xe,Ve.edlStrength.value=.5,Ve.radius.value=1,Ve.opacity.value=1,this.renderer.setRenderTarget(Be[1]),this.renderer.render(edlEffectScene,passCamera$1)},Se.prototype.dispose=function(){this.copyPass.dispose()},Se}(Effect);const fragment=function $e(){for(var Se=[],Be=0;Be<arguments.length;Be++)Se[Be]=arguments[Be];var De=113,Ve=126,Fe=0,Je="";return Se[Fe].split(Je).map(function(Xe){return Xe.charCodeAt(Fe)>Ve?Xe:String.fromCharCode((Xe.charCodeAt(Fe)+De)%Ve)}).join(Je)}(`}rpvv|{-zrqvz}-sy|nH}rpvv|{-zrqvz}-v{H{vs|z-nz}yr?Q-drvtuZn}H{vs|z-nz}yr?Q-Qr}uZn}Hn\bv{t-rp?-bH|vq-znv{56-
sy|n-qr}u-J-r\x07r?Q5Qr}uZn}9-b6;Hvs5qr}u-KJ->;=6
qvpnqH\frpA-p|y|-J-r\x07r?Q5drvtuZn}9-b6H-p|y|-J-p|y|-<-p|y|;HtylSntP|y|-J-rpA5p|y|;\x07\b	9->;=6H-\f`),vertex=function $e(){for(var Se=[],Be=0;Be<arguments.length;Be++)Se[Be]=arguments[Be];var De=113,Ve=126,Fe=0,Je="";return Se[Fe].split(Je).map(function(Xe){return Xe.charCodeAt(Fe)>Ve?Xe:String.fromCharCode((Xe.charCodeAt(Fe)+De)%Ve)}).join(Je)}(`}rpvv|{-zrqvz}-sy|nH}rpvv|{-zrqvz}-v{Hnvor-rp@-}|vv|{Hnvor-rp?-H{vs|z-znA-}|wrpv|{Znv\x07H{vs|z-znA-z|qrycvrZnv\x07Hn\bv{t-rp?-bH|vq-znv{56-
b-J-Htyl]|vv|{-J-}|wrpv|{Znv\x07-7-z|qrycvrZnv\x07-7-rpA5}|vv|{9>;=6H\f`);var HQMaterial=function($e){__extends(Se,$e);function Se(Be){var De=$e.call(this,{vertexShader:vertex,fragmentShader:fragment})||this;return De.uniforms={uDepthMap:makeUniform("t",null),uWeightMap:makeUniform("t",null)},De.depthTest=!0,De.depthWrite=!0,De.opacity=1,De}return Se.prototype.getUniform=function(Be){return this.uniforms===void 0?void 0:this.uniforms[Be].value},Se.prototype.setUniform=function(Be,De){if(this.uniforms!==void 0){var Ve=this.uniforms[Be];Ve.value=De}},__decorate([uniform("uDepthMap"),__metadata("design:type",Number)],Se.prototype,"uDepthMap",void 0),__decorate([uniform("uWeightMap"),__metadata("design:type",Number)],Se.prototype,"uWeightMap",void 0),Se}(RawShaderMaterial);function makeUniform($e,Se){return{type:$e,value:Se}}function uniform($e,Se){return Se===void 0&&(Se=!1),function(Be,De){Object.defineProperty(Be,De,{get:function(){return this.getUniform($e)},set:function(Ve){Ve!==this.getUniform($e)&&(this.setUniform($e,Ve),Se&&this.updateShaderSource())}})}}var passCamera=new OrthographicCamera(-1,1,1,-1,0,1),geometry$1=new BufferGeometry;geometry$1.setAttribute("position",new Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3));geometry$1.setAttribute("uv",new Float32BufferAttribute([0,2,0,0,2,0],2));var mesh$1=new Mesh(geometry$1),hqScene=new Scene$1;hqScene.add(mesh$1);var HQEffect=function($e){__extends(Se,$e);function Se(Be,De,Ve,Fe){var Je=$e.call(this,Be,De,Ve,Fe)||this;return Je.sharedV2=new Vector2,Je.renderer=Be,Je.material=new HQMaterial,Je.camera=Ve,mesh$1.material=Je.material,Je}return Se.prototype.render=function(Be){this.models.setMaterial({useHQDepth:!0,useHQWeight:!1}),this.models.update(this.renderer,this.camera,"Mapview"),this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0,this.renderer.setRenderTarget(Be[0]),this.renderer.render(this.scene,this.camera),this.models.setMaterial({useHQWeight:!0,useHQDepth:!1}),this.models.update(this.renderer,this.camera,"Mapview"),this.renderer.autoClearDepth=!1,this.renderer.autoClearColor=!0,this.renderer.setClearColor(new Color(0,0,0)),this.renderer.setClearAlpha(0),this.renderer.setRenderTarget(Be[1]),this.renderer.render(this.scene,this.camera),this.material.uniforms.uWeightMap.value=Be[1].texture,this.material.uniforms.uDepthMap.value=Be[0].depthTexture,this.renderer.autoClearDepth=!0,this.renderer.autoClearColor=!0,this.renderer.setClearColor(new Color(0,0,0)),this.renderer.setClearAlpha(1),this.renderer.setRenderTarget(Be[2]),this.renderer.render(hqScene,passCamera)},Se.prototype.dispose=function(){this.copyPass.dispose()},Se}(Effect),minDistance=.5,PANGESTURE_FORWARD_ANGLE=Math.PI/7,defaultMapviewControllerCustomInitArgs={defaultLongitude:Math.PI/4,defaultLatitude:Math.PI/4,defaultDistance:150,maxLatitude:+Math.PI/2,minLatitude:0,cameraType:"auto",cameraFence:null,intersectMeshCreator:function(){return new IntersectMesh}},MapviewController=function($e){__extends(Se,$e);function Se(Be){var De=this,Ve,Fe=Se.parseArgs(Be);return De=$e.call(this,Fe)||this,De.mode="Mapview",De.defaultLongitude=Fe.defaultLongitude,De.defaultLatitude=Fe.defaultLatitude,De.defaultDistance=Fe.defaultDistance,De.maxLatitude=Fe.maxLatitude,De.minLatitude=Fe.minLatitude,De.cameraType=Fe.cameraType,De.cameraFence=Fe.cameraFence,De.locationMotion=new Motion({x:De.camera.pose.offset.x,y:De.camera.pose.offset.y,z:De.camera.pose.offset.z,distance:De.camera.pose.distance}),De.modelAlphaMotion=new Motion({modelAlpha:(Ve=De.models.getMaterial().modelAlpha)!==null&&Ve!==void 0?Ve:0}),De.perspToOrthoMotion=new Motion({perspToOrtho:De.camera.perspToOrtho.x}),De.intersectMeshCreator=Fe.intersectMeshCreator,De.intersectMesh=De.intersectMeshCreator(),De.intersectMesh.name="intersect",De.intersectMesh.visible=!1,De.currentTapId=null,De.helper.add(De.intersectMesh),De.edlTarget=new WebGLRenderTarget(1024,1024,{generateMipmaps:!1,minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat,type:FloatType,depthTexture:new DepthTexture(1024,1024,UnsignedIntType)}),De.edlEffect=new EDLEffect(De.renderer,De.modelScene,De.camera,De.models),De.hqEffect=new HQEffect(De.renderer,De.modelScene,De.camera,De.models),De}return Se.parseArgs=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye,or;if(Be instanceof Se)return Be;var sr=$e.parseArgs.call(this,Be);return __assign(__assign({},sr),{defaultLongitude:(De=Be.defaultLongitude)!==null&&De!==void 0?De:defaultMapviewControllerCustomInitArgs.defaultLongitude,defaultLatitude:(Ve=Be.defaultLatitude)!==null&&Ve!==void 0?Ve:defaultMapviewControllerCustomInitArgs.defaultLatitude,defaultDistance:(Fe=Be.defaultDistance)!==null&&Fe!==void 0?Fe:defaultMapviewControllerCustomInitArgs.defaultDistance,maxLatitude:(Je=Be.maxLatitude)!==null&&Je!==void 0?Je:defaultMapviewControllerCustomInitArgs.maxLatitude,minLatitude:(Xe=Be.minLatitude)!==null&&Xe!==void 0?Xe:defaultMapviewControllerCustomInitArgs.minLatitude,cameraType:(Ke=Be.cameraType)!==null&&Ke!==void 0?Ke:defaultMapviewControllerCustomInitArgs.cameraType,cameraFence:(Ye=Be.cameraFence)!==null&&Ye!==void 0?Ye:defaultMapviewControllerCustomInitArgs.cameraFence,intersectMeshCreator:(or=Be.intersectMeshCreator)!==null&&or!==void 0?or:defaultMapviewControllerCustomInitArgs.intersectMeshCreator})},Se.distanceFromModel=function(Be,De,Ve){var Fe=Be.bounding,Je=Math.pow(Math.pow(Fe.max.x-Fe.min.x+1,2)+Math.pow(Fe.max.y-Fe.min.y+1,2)+Math.pow(Fe.max.z-Fe.min.z+1,2),1/2),Xe=Je/2/Math.tan(Math.PI*De/360);return Ve<1&&(Xe=Xe/Ve),isNaN(Xe)?Je:Xe},Se.initAnimationEndState=function(Be){var De,Ve,Fe,Je,Xe,Ke,Ye,or=this.parseArgs(Be),sr=or.works,cr=or.models,Br=Be.initial,tn=Br.state,en=Br.currentState,an=typeof tn.panoIndex=="number"?{workCode:(Fe=(De=tn.workCode)!==null&&De!==void 0?De:(Ve=or.works[0])===null||Ve===void 0?void 0:Ve.workCode)!==null&&Fe!==void 0?Fe:"",panoIndex:tn.panoIndex}:{workCode:en.workCode,panoIndex:en.panoIndex},rn=sr.getResolvedObserver(an),on=(Je=tn.fov)!==null&&Je!==void 0?Je:60,sn=clamp$1((Xe=tn.latitude)!==null&&Xe!==void 0?Xe:isThirdPersonMode(en.mode)?en.latitude:or.defaultLatitude,or.minLatitude,or.maxLatitude),ln=Se.distanceFromModel(or.models,on,or.camera.aspect),cn=new Vector3,hn=(Ke=tn.distance)!==null&&Ke!==void 0?Ke:Math.min(or.defaultDistance,ln),mn=(Ye=tn.longitude)!==null&&Ye!==void 0?Ye:isThirdPersonMode(en.mode)?en.longitude:or.defaultLongitude;return tn.offset?cn.copy(tn.offset):or.defaultDistance<ln&&rn?(cn.copy(rn.position),tn.longitude===void 0&&(mn=en.longitude)):(cr.bounding.getCenter(cn),hn=ln),__assign(__assign({},an),{mode:"Mapview",longitude:mn,latitude:sn,fov:on,offset:cn,distance:hn})},Se.prototype.updateConfiguration=function(Be){var De=$e.prototype.updateConfiguration.call(this,Be);if(De===!1)return!1;if(Be.defaultLongitude!==void 0&&this.defaultLongitude!==Be.defaultLongitude&&(this.defaultLongitude=Be.defaultLongitude),Be.defaultLatitude!==void 0&&this.defaultLatitude!==Be.defaultLatitude&&(this.defaultLatitude=Be.defaultLatitude),Be.defaultDistance!==void 0&&this.defaultDistance!==Be.defaultDistance&&(this.defaultDistance=Be.defaultDistance),Be.maxLatitude!==void 0&&this.maxLatitude!==Be.maxLatitude&&(this.maxLatitude=Be.maxLatitude),Be.minLatitude!==void 0&&this.minLatitude!==Be.minLatitude&&(this.minLatitude=Be.minLatitude),Be.cameraType!==void 0&&this.cameraType!==Be.cameraType&&(this.cameraType=Be.cameraType),this.cameraFence instanceof Box3&&Be.cameraFence instanceof Box3?this.cameraFence.equals(Be.cameraFence)||(this.cameraFence=Be.cameraFence):this.cameraFence instanceof Sphere&&Be.cameraFence instanceof Sphere?this.cameraFence.equals(Be.cameraFence)||(this.cameraFence=Be.cameraFence):Be.cameraFence!==void 0&&(this.cameraFence=Be.cameraFence),Be.intersectMeshCreator!==void 0&&this.intersectMeshCreator!==Be.intersectMeshCreator){this.intersectMeshCreator=Be.intersectMeshCreator;var Ve=this.intersectMesh;this.intersectMesh=this.intersectMeshCreator(),this.intersectMesh.name=Ve.name,this.intersectMesh.visible=Ve.visible;var Fe=this.intersectMesh.parent;Fe&&Fe.add(this.intersectMesh),Ve.dispose()}return!0},Se.prototype.destroy=function(){$e.prototype.destroy.call(this),this.locationMotion.dispose(),delete this.panState,this.intersectMesh.dispose(),this.helper.remove(this.intersectMesh)},Se.prototype.isReady=function(){return this.locationMotion.ended===!1?!1:$e.prototype.isReady.call(this)},Se.prototype.updateWork=function(Be,De,Ve,Fe){this.userAction=Fe,this.works=Be;var Je=Se.initAnimationEndState(__assign(__assign({},this),{initial:{currentState:__assign(__assign({},this.currentPano),this.camera.pose),duration:Ve.duration,effect:Ve.effect,state:De,userAction:Fe}}));this.currentPano={workCode:Je.workCode,panoIndex:Je.panoIndex};var Xe={longitude:Je.longitude,latitude:Je.latitude,fov:Je.fov},Ke={x:Je.offset.x,y:Je.offset.y,z:Je.offset.z,distance:Je.distance,orthoDistance:Je.distance};return this.locationMotion.set(Ke,Ve.duration).catch(noop$1),this.cameraMotion.set(Xe,Ve.duration).catch(noop$1),!0},Se.prototype.updateModel=function(Be){$e.prototype.updateModel.call(this,Be);var De=Be.bounding.getCenter(new Vector3),Ve=Se.distanceFromModel(Be,this.cameraMotion.value.fov,this.camera.aspect);this.updateCamera({offset:De,distance:Ve},0,!0)},Se.prototype.updateCamera=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();var Je={},Xe={};return Be.distance!==void 0&&(Je.distance=Be.distance),Be.offset!==void 0&&(Je.x=Be.offset.x,Je.y=Be.offset.y,Je.z=Be.offset.z),Be.longitude!==void 0&&(Xe.longitude=Be.longitude),Be.latitude!==void 0&&(Xe.latitude=Be.latitude),Be.fov!==void 0&&(Xe.fov=Be.fov),Fe.locationMotion.set(Je,De).catch(noop$1),Fe.cameraMotion.set(Xe,De).catch(noop$1)})},Se.prototype.updateCameraWithKeyframes=function(Be,De,Ve){var Fe=this;return this.initAnimationReady.then(function(){Fe.userAction=Ve,Fe.stopMomentumMovement();for(var Je=[],Xe=[],Ke=0,Ye=Be;Ke<Ye.length;Ke++){var or=Ye[Ke];Je.push({key:or.key,progress:or.progress,value:{distance:or.value.distance,x:or.value.offset.x,y:or.value.offset.x,z:or.value.offset.x}}),Xe.push({key:or.key,progress:or.progress,value:{longitude:or.value.longitude,latitude:or.value.latitude,fov:or.value.fov}})}return Fe.locationMotion.setKeyframes(Je,De).catch(noop$1),Fe.cameraMotion.setKeyframes(Be,De)})},Se.prototype.updateTime=function(Be,De){if(!this.destroyed){var Ve={},Fe={};this.locationMotion.ended||(this.locationMotion.update(Be),Fe.distance=this.locationMotion.value.distance,Fe.offset=new Vector3(this.locationMotion.value.x,this.locationMotion.value.y,this.locationMotion.value.z)),this.cameraMotion.ended||(this.cameraMotion.update(Be),Fe.longitude=this.cameraMotion.value.longitude,Fe.latitude=this.cameraMotion.value.latitude,Fe.fov=this.cameraMotion.value.fov),this.modelAlphaMotion.ended||(this.modelAlphaMotion.update(Be),Ve.modelAlpha=this.modelAlphaMotion.value.modelAlpha);var Je=0;if(this.cameraType==="auto"?Je=Math.abs(Math.PI/2-this.cameraMotion.value.latitude)<.02||Math.abs(-Math.PI/2-this.cameraMotion.value.latitude)<.02?1:0:this.cameraType==="perspective"?Je=0:this.cameraType==="orthographic"&&(Je=1),this.perspToOrthoMotion.getTargetKeyframe().value.perspToOrtho!==Je&&this.perspToOrthoMotion.set({perspToOrtho:Je},500).catch(noop$1),this.perspToOrthoMotion.ended||(this.perspToOrthoMotion.update(Be),this.camera.perspToOrtho.setScalar(clamp$1(this.perspToOrthoMotion.value.perspToOrtho,0,1))),isEmptyObject(Ve)||this.models.setMaterial(Ve),isEmptyObject(Fe)||this.setCamera(Fe),this.cameraFence&&!this.panState&&!this.pinchState&&!this.mouseWheelState&&!this.inMomentumMovement&&this.locationMotion.ended&&this.perspToOrthoMotion.ended&&this.cameraMotion.ended){var Xe=coordinatesToVector(this.camera.pose,new Vector3),Ke=new Vector3().copy(this.camera.pose.offset).sub(Xe.clone().multiplyScalar(this.camera.pose.distance));if(this.cameraFence.distanceToPoint(Ke)>.01){var Ye=this.cameraFence.clampPoint(Ke,new Vector3),or=this.camera.pose.offset.clone().add(Ye).sub(Ke),sr=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:this.camera.pose.longitude,latitude:this.camera.pose.latitude,fov:this.camera.pose.fov,offset:or,distance:this.camera.pose.distance});this.fixFinalState(sr),this.locationMotion.set({x:sr.offset.x,y:sr.offset.y,z:sr.offset.z,distance:sr.distance},300).catch(noop$1)}}if(this.intersectMesh&&this.intersectMesh.parent){var cr=this.camera.position.distanceTo(this.intersectMesh.position),Br=2*Math.tan(.5*this.camera.fov/180*Math.PI),tn=cr*Br/5;this.intersectMesh.scale.setScalar(tn)}}},Se.prototype.getTargetState=function(){var Be=this.cameraMotion.getKeyFrameSegment(now$2())[1],De=this.locationMotion.getKeyFrameSegment(now$2())[1];return __assign(__assign({},this.currentPano),{mode:this.mode,longitude:Be.value.longitude,latitude:Be.value.latitude,fov:Be.value.fov,distance:De.value.distance,offset:new Vector3(De.value.x,De.value.y,De.value.z)})},Se.prototype.initAnimation=function(){var Be=this;return this.destroyed?Promise.resolve():new Promise(function(De){var Ve=Be.initial;Ve.state,Ve.currentState;var Fe=Ve.duration,Je=Ve.userAction;Be.userAction=Je;var Xe=Se.initAnimationEndState(Be),Ke={longitude:Xe.longitude,latitude:Xe.latitude,fov:Xe.fov},Ye={x:Xe.offset.x,y:Xe.offset.y,z:Xe.offset.z,distance:Xe.distance},or={modelAlpha:1},sr={perspToOrtho:0};Be.emit("initAnimation.start",createEvent("initAnimation.start",{state:Xe,userAction:Be.userAction})),Be.perspToOrthoMotion.set(sr,Fe).catch(noop$1),Be.modelAlphaMotion.set(or,Fe/3).catch(noop$1),Be.cameraMotion.set(Ke,Fe).catch(noop$1),Be.locationMotion.set(Ye,Fe).then(function(){Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:Xe,userAction:Be.userAction}))},function(cr){var Br=__assign(__assign(__assign({},Be.currentPano),{mode:Be.mode}),clonePose(Be.camera.pose));Be.emit("initAnimation.end",createEvent("initAnimation.end",{state:Br,userAction:Be.userAction}))}).then(function(){De()})})},Se.prototype.getForwardObserverOrNot=function(Be){var De=this,Ve=this.models.intersectRaycaster(Be)[0];if(!Ve)return null;var Fe=this.works.resolvedObservers.filter(function(Ye){for(var or,sr=0,cr=De.models;sr<cr.length;sr++){var Br=cr[sr];if(Br.visible&&((or=Br.work)===null||or===void 0?void 0:or.workCode)===Ye.work.workCode)return!0}return!1}),Je=arrayMin(Fe,function(Ye){return Ye.standingPosition.distanceTo(Ve.point)},!0),Xe=Je[0],Ke=Je[1];return Xe&&Ke<10?Xe:null},Se.prototype.coordinatesForOffset=function(Be){var De=this.renderer.getSize(new Vector2);return{longitude:-2*Be.x/(De.x*this.scissor.width),latitude:2*Be.y/(De.y*this.scissor.height)}},Se.prototype.requestMomentumMovement=function(Be,De,Ve,Fe){var Je=this;if(this.inMomentumMovement!==null){for(var Xe=__assign({},Ve),Ke={longitude:0,latitude:0,x:0,y:0,z:0},Ye=0;Ye<Fe;Ye++)Xe.longitude*=.996,Xe.latitude*=.996*.998,Xe.x*=.99,Xe.y*=.99,Xe.z*=.99,Ke.longitude+=Xe.longitude,Ke.latitude+=Xe.latitude,Ke.x+=Xe.x,Ke.y+=Xe.y,Ke.z+=Xe.z;var or=formatRad(this.cameraMotion.value.longitude+Ke.longitude),sr=clamp$1(this.cameraMotion.value.latitude+Ke.latitude,this.minLatitude,this.maxLatitude),cr=new Vector3(this.locationMotion.value.x+Ke.x,this.locationMotion.value.y+Ke.y,this.locationMotion.value.z+Ke.z),Br=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:or,latitude:sr,offset:cr,fov:this.cameraMotion.value.fov,distance:this.locationMotion.value.distance}),tn=Be.state.offset.clone().sub(coordinatesToVector(Be.state).setLength(Br.distance)),en=!(Math.abs(Xe.longitude)>1e-4||Math.abs(Xe.latitude)>1e-4||Math.abs(Xe.x)>1e-4||Math.abs(Xe.y)>1e-4||Math.abs(Xe.z)>1e-4),an=this.cameraFence?this.cameraFence.containsPoint(tn):!0;an===!1&&(en=!0);var rn=createEvent("gesture.momentum",__assign(__assign({},Be),{isFirst:De,isFinal:en,state:Br}));if(this.inMomentumMovement.event=rn,this.emit("gesture.momentum",rn),Be.defaultPrevented){this.inMomentumMovement=null;return}this.inMomentumMovement&&(this.cameraMotion.set({longitude:or,latitude:sr},0).catch(noop$1),this.locationMotion.set({x:Br.offset.x,y:Br.offset.y,z:Br.offset.z,distance:Br.distance},0).catch(noop$1),en?this.inMomentumMovement=null:AnimationFrameLoop.shared.add(function(on,sn){Je.requestMomentumMovement(Be,!1,Xe,sn|0)},!0,1))}},Se.prototype.fixFinalState=function(Be){if(this.perspToOrthoMotion.getTargetKeyframe().value.perspToOrtho!==1){var De=coordinatesToVector(Be,new Vector3),Ve=new Vector3().copy(Be.offset).sub(De.clone().multiplyScalar(Be.distance)),Fe=new Raycaster(Ve,De);Fe.params.Points={threshold:.1},Fe.near=this.camera.near,Fe.far=this.camera.far;var Je;if(Je=this.models.intersectRaycaster(Fe).filter(function(sr){var cr,Br=(cr=sr.face)===null||cr===void 0?void 0:cr.normal;return Br&&Fe.ray.direction.dot(Br)>=0?!1:sr.distance>minDistance+Fe.near})[0],!Je){var Xe=new Plane(new Vector3(0,1,0),-this.models.bounding.min.y),Ke=Fe.ray.intersectPlane(Xe,new Vector3);if(Ke){var Ye=Ke.distanceTo(Fe.ray.origin);Ye<1e3&&Ye>=Fe.near&&(Je={distance:Ye,floor:0,point:Ke,object:this.scene,face:null})}}if(!Je){var or=Math.max(Be.distance,3);Je={distance:or,floor:0,point:Fe.ray.direction.clone().setLength(or).add(Fe.ray.origin),object:this.scene,face:null}}Je&&(Be.distance=clamp$1(Je.distance,0,1/0),Be.offset.copy(Ve).add(De.clone().multiplyScalar(Be.distance)))}},Se.prototype.onPanGesture=function(Be){this.userAction=Be.userAction,this.stopMomentumMovement(),this.hideIntersectMesh();var De=Be.pointers.length,Ve=this.panState,Fe=0,Je=!1;Be.pointerType==="mouse"&&(Fe=Be.srcEvent.buttons,Je=Be.srcEvent.shiftKey),Ve&&Fe===0&&Ve.buttons!==0&&(Fe=Ve.buttons);var Xe=Ve?.target;if(!Xe){var Ke=this.relativeClientPosition(Be.center),Ye=new Raycaster;Ye.params.Points={threshold:.1},Ye.setFromCamera(Ke,this.camera),Ye.near=this.camera.near,Xe=new Vector3().copy(Ye.ray.direction).multiplyScalar(3).add(Ye.ray.origin);var or=this.models.intersectRaycaster(Ye)[0];if(!or&&Ye.ray.direction.y<-.3){var sr=new Plane(new Vector3(0,1,0),0),cr=Ye.ray.intersectPlane(sr,new Vector3);if(cr){var Br=cr.distanceTo(Ye.ray.origin);Br<1e4&&Br>=Ye.near&&(or={distance:Br,floor:0,point:cr,object:this.scene})}}if(or)Xe.copy(or.point);else{var tn=new Vector3().copy(this.camera.pose.offset).sub(this.camera.position).normalize(),sr=new Plane().setFromNormalAndCoplanarPoint(tn,this.camera.pose.offset);Ye.ray.intersectPlane(sr,Xe)}}if(Be.isFinal?delete this.panState:this.panState={target:Xe,buttons:Fe,pointerLength:De,x:Be.center.x,y:Be.center.y},!(typeof Ve>"u"||Ve.pointerLength!==De)){var en=De>1||Fe===2||Je;if(en){var an={x:Be.center.x-Ve.x,y:Be.center.y-Ve.y},rn=new Vector3(this.locationMotion.value.x,this.locationMotion.value.y,this.locationMotion.value.z),on=coordinatesToVector(this.cameraMotion.value).setLength(this.locationMotion.value.distance).add(rn),sn=new Vector3().copy(on).sub(Ve.target).length();sn*=Math.tan(this.camera.pose.fov/2*Math.PI/180);var ln=this.renderer.getSize(new Vector2),cn=2*an.x*sn/ln.y,hn=2*an.y*sn/ln.y,mn=new Vector3;mn.setFromMatrixColumn(this.camera.matrix,0),mn.multiplyScalar(-cn),rn.add(mn),this.camera.pose.latitude<PANGESTURE_FORWARD_ANGLE?mn.setFromMatrixColumn(this.camera.matrix,1):(mn.setFromMatrixColumn(this.camera.matrix,0),mn.crossVectors(this.camera.up,mn)),mn.multiplyScalar(hn),rn.add(mn);var An=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:this.camera.pose.longitude,latitude:this.camera.pose.latitude,fov:this.camera.pose.fov,offset:rn,distance:this.camera.pose.distance});if(Be.state=An,this.emit("gesture.pan",Be),Be.defaultPrevented)return;if(this.locationMotion.set({x:An.offset.x,y:An.offset.y,z:An.offset.z},0).catch(noop$1),Be.isFinal&&(this.fixFinalState(An),Object.assign(Be,{__fixFinalState:!0}),this.locationMotion.set({distance:An.distance,x:An.offset.x,y:An.offset.y,z:An.offset.z},0).catch(noop$1)),Be.isFinal){var xn=this.renderer.getSize(new Vector2),pn=2*Be.velocityX*sn/xn.y,dn=2*Be.velocityY*sn/xn.y,fn=new Vector3,yn=new Vector3;fn.setFromMatrixColumn(this.camera.matrix,0),fn.multiplyScalar(-pn),yn.add(fn),this.camera.pose.latitude<PANGESTURE_FORWARD_ANGLE?fn.setFromMatrixColumn(this.camera.matrix,1):(fn.setFromMatrixColumn(this.camera.matrix,0),fn.crossVectors(this.camera.up,fn)),fn.multiplyScalar(dn),yn.add(fn),this.inMomentumMovement={uuid:createUuid()},this.requestMomentumMovement(Be,!0,{longitude:0,latitude:0,x:yn.x,y:yn.y,z:yn.z},0)}}else{var an={x:Be.center.x-Ve.x,y:Be.center.y-Ve.y},Sn=this.coordinatesForOffset(an),gn=formatRad(this.cameraMotion.value.longitude+Sn.longitude),Cn=clamp$1(this.cameraMotion.value.latitude+Sn.latitude,this.minLatitude,this.maxLatitude);this.camera.aspect<1&&Math.abs(Be.overallVelocityX)>.2&&Math.atan2(Math.abs(Be.overallVelocityY),Math.abs(Be.overallVelocityX))<Math.PI/6.923&&(Cn=this.cameraMotion.value.latitude);var An=__assign(__assign({},this.currentPano),{mode:this.mode,longitude:gn,latitude:Cn,fov:this.camera.pose.fov,offset:this.camera.pose.offset,distance:this.camera.pose.distance});if(Be.isFinal&&Object.assign(Be,{__fixFinalState:!0}),Be.state=An,this.emit("gesture.pan",Be),Be.defaultPrevented)return;if(Be.isFinal?this.locationMotion.set({distance:An.distance,x:An.offset.x,y:An.offset.y,z:An.offset.z},0).catch(noop$1):this.cameraMotion.set({longitude:An.longitude,latitude:An.latitude},0).catch(noop$1),Be.isFinal){var Mn=Be.velocityX,Bn=Be.velocityY;this.inMomentumMovement={uuid:createUuid()},this.requestMomentumMovement(Be,!0,__assign(__assign({},this.coordinatesForOffset({x:Mn,y:Bn})),{x:0,y:0,z:0}),0)}}}},Se.prototype.onPinchGesture=function(Be){var De;if(this.initAnimationIsReady){this.userAction=Be.userAction,this.stopMomentumMovement(),this.hideIntersectMesh();var Ve=(De=this.pinchState)===null||De===void 0?void 0:De.distance;if(Be.isFirst){this.pinchState={x:Be.center.x,y:Be.center.y,scale:1,distance:this.locationMotion.value.distance};return}if(typeof Ve<"u"){var Fe=this.models.bounding.getCenter(new Vector3),Je=Se.distanceFromModel(this.models,this.cameraMotion.value.fov,this.camera.aspect),Xe=clamp$1(Ve/Be.scale,minDistance,1/0),Ke=Be.state.offset.clone().sub(coordinatesToVector(Be.state).setLength(Xe)),Ye=this.models.bounding.containsPoint(Ke),or;if(!Ye&&this.pinchState&&this.pinchState.scale>Be.scale&&Fe.distanceTo(Ke)>Je?or=Be.state.distance:(or=Xe,this.pinchState&&(this.pinchState.scale=Be.scale)),Be.state.distance=or,this.emit("gesture.pinch",Be),!Be.defaultPrevented&&(this.locationMotion.set({distance:Be.state.distance},0).catch(noop$1),Be.pointerType!=="mouse"&&(Be.type="gesture.pan",this.onPanGesture(Be)),Be.isFinal)){if(!("__fixFinalState"in Be)){var sr=Be.state;this.fixFinalState(Be.state);var cr={x:sr.offset.x,y:sr.offset.y,z:sr.offset.z,distance:sr.distance};this.locationMotion.set(cr,0).catch(noop$1)}delete this.panState,delete this.pinchState}}}},Se.prototype.onMouseMove=function(Be){var De,Ve;if(this.intersectMesh.parent&&!this.panState&&!this.pinchState&&!this.mouseWheelState&&(this.emit("gesture.mousemove",Be),!Be.defaultPrevented)){var Fe=Be.center.raycaster;if(Fe.near=this.camera.near,Fe.far=this.camera.far,Be.isFinal&&this.intersectMesh.parent&&this.intersectMesh.visible===!0){this.hideIntersectMesh();return}var Je=this.models.intersectRaycaster(Fe)[0],Xe=createEvent("intersect.update",{raycaster:Fe,intersection:Je??null,object:this.intersectMesh});if(this.emit("intersect.update",Xe),Xe.defaultPrevented){this.hideIntersectMesh();return}if(Je){var Ke=(Ve=(De=Je.face)===null||De===void 0?void 0:De.normal)!==null&&Ve!==void 0?Ve:new Vector3().copy(Fe.ray.direction).multiplyScalar(-1),Ye=Ke.clone(),or=Je.point.clone();this.intersectMesh.position.copy(or);var sr=or.clone().add(Ye);if(this.intersectMesh.lookAt(sr),Math.abs(Ke.y)>.99){var cr=this.camera.position.clone().sub(or);this.intersectMesh.rotation.z=-Math.atan2(cr.z,cr.x)}this.intersectMesh.visible=!0,this.needsRender=!0}else this.hideIntersectMesh()}},Se.prototype.onMouseWheel=function(Be){if(this.initAnimationIsReady)if(this.userAction=Be.userAction,this.stopMomentumMovement(),this.hideIntersectMesh(),Be.isFinal){var De=Be.state;if(this.fixFinalState(De),this.emit("gesture.mousewheel",Be),Be.defaultPrevented)return;var Ve={x:De.offset.x,y:De.offset.y,z:De.offset.z,distance:De.distance};this.locationMotion.set(Ve,0).catch(noop$1)}else{var Fe=Math.max(this.locationMotion.value.distance-this.camera.near,0),Je=Be.center.delta/10*Math.max(Fe/5,.1);if(this.locationMotion.value.distance-Je>=minDistance){var Xe=this.locationMotion.value.distance-Je;Be.state.distance=Xe}else{var Ke=coordinatesToVector(this.cameraMotion.value);Ke.setLength(Je),Be.state.offset.add(Ke)}if(this.emit("gesture.mousewheel",Be),Be.defaultPrevented)return;this.locationMotion.set({distance:Be.state.distance,x:Be.state.offset.x,y:Be.state.offset.y,z:Be.state.offset.z},0).catch(noop$1)}},Se.prototype.onTapGesture=function(Be){var De=this;this.userAction=Be.userAction,this.stopMomentumMovement();var Ve=Be.center.raycaster,Fe=this.getForwardObserverOrNot(Ve);if(!Fe)this.emit("gesture.tap",Be);else{var Je={longitude:this.camera.pose.longitude,latitude:0},Xe=__assign(__assign({},Be.state),{mode:"Panorama",workCode:Fe.pano.workCode,panoIndex:Fe.pano.panoIndex,longitude:Je.longitude,latitude:Je.latitude,offset:Fe?Fe.position.clone():new Vector3,distance:0});if(Be.state=Xe,this.emit("gesture.tap",Be),!Be.defaultPrevented&&(this.emit("pano.select",createEvent("pano.select",{prevPano:this.currentPano,state:Xe,userAction:Be.userAction,options:Je,progress:0,error:null})),Fe&&Fe.active)){var Ke=this.currentTapId=createUuid();this.preloadPano(Fe.pano).then(function(Ye){De.currentTapId===Ke&&De.emit("pano.request",createEvent("pano.request",{userAction:!0,prevPano:De.currentPano,progress:0,state:Xe,options:Je,error:null}))})}}},Se.prototype.onDblTapGesture=function(Be){if(this.initAnimationIsReady){this.userAction=Be.userAction,this.stopMomentumMovement(),this.hideIntersectMesh();var De=Be.state,Ve=Be.center.raycaster,Fe=Ve.ray.origin.clone().add(Ve.ray.direction.clone().setLength(3)),Je=1,Xe=3,Ke=Je,Ye=this.models.intersectRaycaster(Ve)[0];if(Ye&&(Fe=Ye.point.clone(),Ye.distance>(Je+Xe)/2?Ke=Je:Ke=Xe),Be.state.distance=Ke,Be.state.offset=Fe,this.emit("gesture.dbltap",Be),!Be.defaultPrevented){var or={x:De.offset.x,y:De.offset.y,z:De.offset.z,distance:De.distance};this.locationMotion.set(or,360).catch(noop$1),this.hideIntersectMesh()}}},Se.prototype.hideIntersectMesh=function(){this.intersectMesh.visible=!1,this.needsRender=!0},Se.prototype.render=function(Be,De){var Ve=this.renderer.getRenderTarget();this.updateScreenBuffer(De),this.enableFragDepth?(Be&&(De==="edl"?this.edlEffect.render(this.screenBuffers):De==="hq"?this.hqEffect.render(this.screenBuffers):(this.renderer.setRenderTarget(this.modelRenderTarget),this.renderer.render(this.modelScene,this.camera))),this.depthCopyPass.render(this.modelRenderTarget.depthTexture,Ve),this.renderer.autoClearDepth=!1,this.renderer.autoClearColor=!0,this.copyPass.render(this.modelRenderTarget,Ve),this.renderer.setRenderTarget(Ve),this.renderer.autoClearColor=!1,this.renderer.autoClearDepth=!1,this.renderer.render(this.scene,this.camera),this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0):(De==="edl"?this.edlEffect.render(this.screenBuffers):De==="hq"?this.hqEffect.render(this.screenBuffers):this.renderer.render(this.modelScene,this.camera),this.renderer.autoClearColor=!1,this.renderer.autoClearDepth=!1,this.renderer.render(this.scene,this.camera),this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0)},Se}(BaseController);function isNil($e){return $e==null}var _moveEvent={type:"move"},XRController=function(){function $e(){this._targetRay=null,this._grip=null,this._hand=null,this._axes=[0,0]}return $e.prototype.getHandSpace=function(){return this._hand===null&&(this._hand=new Group$1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},$e.prototype.getTargetRaySpace=function(){return this._targetRay===null&&(this._targetRay=new Group$1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay},$e.prototype.getGripSpace=function(){return this._grip===null&&(this._grip=new Group$1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip},$e.prototype.dispatchEvent=function(Se){return this._targetRay!==null&&this._targetRay.dispatchEvent(Se),this._grip!==null&&this._grip.dispatchEvent(Se),this._hand!==null&&this._hand.dispatchEvent(Se),this},$e.prototype.disconnect=function(Se){return this.dispatchEvent({type:"disconnected",data:Se}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},$e.prototype.getAxes=function(){return this._axes},$e.prototype.update=function(Se,Be,De){var Ve=null,Fe=null,Je=null,Xe=this._targetRay,Ke=this._grip,Ye=this._hand;if(Se&&Se.gamepad&&Se.gamepad.axes&&(this._axes=[Se.gamepad.axes[2],Se.gamepad.axes[3]]),Se&&Be.session.visibilityState!=="visible-blurred")if(Xe!==null&&(Ve=Be.getPose(Se.targetRaySpace,De),Ve!==null&&(Xe.matrix.fromArray(Ve.transform.matrix),Xe.matrix.decompose(Xe.position,Xe.rotation,Xe.scale),Ve.linearVelocity?(Xe.hasLinearVelocity=!0,Xe.linearVelocity.copy(Ve.linearVelocity)):Xe.hasLinearVelocity=!1,Ve.angularVelocity?(Xe.hasAngularVelocity=!0,Xe.angularVelocity.copy(Ve.angularVelocity)):Xe.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent))),Ye&&Se.hand){Je=!0;for(var or=0,sr=Se.hand.values();or<sr.length;or++){var cr=sr[or],Br=Be.getJointPose(cr,De);if(Ye.joints[cr.jointName]===void 0){var tn=new Group$1;tn.matrixAutoUpdate=!1,tn.visible=!1,Ye.joints[cr.jointName]=tn,Ye.add(tn)}var en=Ye.joints[cr.jointName];Br!==null&&(en.matrix.fromArray(Br.transform.matrix),en.matrix.decompose(en.position,en.rotation,en.scale),en.jointRadius=Br.radius),en.visible=Br!==null}var an=Ye.joints["index-finger-tip"],rn=Ye.joints["thumb-tip"],on=an.position.distanceTo(rn.position),sn=.02,ln=.005;Ye.inputState.pinching&&on>sn+ln?(Ye.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:Se.handedness,target:this})):!Ye.inputState.pinching&&on<=sn-ln&&(Ye.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:Se.handedness,target:this}))}else Ke!==null&&Se.gripSpace&&(Fe=Be.getPose(Se.gripSpace,De),Fe!==null&&(Ke.matrix.fromArray(Fe.transform.matrix),Ke.matrix.decompose(Ke.position,Ke.rotation,Ke.scale),Fe.linearVelocity?(Ke.hasLinearVelocity=!0,Ke.linearVelocity.copy(Fe.linearVelocity)):Ke.hasLinearVelocity=!1,Fe.angularVelocity?(Ke.hasAngularVelocity=!0,Ke.angularVelocity.copy(Fe.angularVelocity)):Ke.hasAngularVelocity=!1));return Xe!==null&&(Xe.visible=Ve!==null),Ke!==null&&(Ke.visible=Fe!==null),Ye!==null&&(Ye.visible=Je!==null),this},$e}(),framebufferScaleFactor=1,XRManager=function(){function $e(Se,Be,De){var Ve,Fe,Je,Xe,Ke;this.isPanorama=(Ve=De?.isPanorama)!==null&&Ve!==void 0?Ve:!0;var Ye=navigator.userAgent.toLowerCase(),or;Ye.includes("pico")?or="Pico":Ye.includes("oculus")?or="Oculus":or="VP",this.machineType=(Fe=De?.machineType)!==null&&Fe!==void 0?Fe:or,this.renderer=Se,this.gl=Be,this.enabled=!1,this.session=null,this.referenceSpaceType=(Je=De?.referenceSpaceType)!==null&&Je!==void 0?Je:"local-floor",this.referenceSpace=null,this.onSessionStartCallback=(Xe=De?.onSessionStart)!==null&&Xe!==void 0?Xe:noop$1,this.onSessionEndCallback=(Ke=De?.onSessionEnd)!==null&&Ke!==void 0?Ke:noop$1,this.controllers=[new XRController,new XRController],this.inputSourcesMap=new Map,this.cameraVR=new ArrayCamera,this.cameraL=new PerspectiveCamera,this.cameraR=new PerspectiveCamera,this.cameraL.viewport=new Vector4,this.cameraR.viewport=new Vector4,this.cameraL.layers.enable(1),this.cameraR.layers.enable(2),this.cameraVR.layers.enable(1),this.cameraVR.layers.enable(2),this.isPresenting=!1,this.currentDepthNear=null,this.currentDepthFar=null,this.cameraLPos=new Vector3,this.cameraRPos=new Vector3}return $e.prototype.getController=function(Se){var Be=this.controllers[Se];return Be||console.warn("no controller find"),Be.getTargetRaySpace()},$e.prototype.getRightController=function(){if(!this.session)return null;var Se=this.session.inputSources[0].handedness==="right"?0:1,Be=this.controllers[Se];return Be||console.warn("no controller find"),Be.getTargetRaySpace()},$e.prototype.getLeftController=function(){if(!this.session)return null;var Se=this.session.inputSources[0].handedness==="left"?0:1,Be=this.controllers[Se];return Be||console.warn("no controller find"),Be.getTargetRaySpace()},$e.prototype.getControllerGrip=function(Se){var Be=this.controllers[Se];return Be||console.warn("no controller find"),Be.getGripSpace()},$e.prototype.getCameras=function(){return{cameraL:this.cameraL,cameraR:this.cameraR,cameraVR:this.cameraVR}},$e.prototype.updateCamera=function(Se,Be){Be===null?Se.matrixWorld.copy(Se.matrix):Se.matrixWorld.multiplyMatrices(Be.matrixWorld,Se.matrix),Se.matrixWorldInverse.getInverse(Se.matrixWorld)},$e.prototype.setProjectionFromUnion=function(Se,Be,De){this.cameraLPos.setFromMatrixPosition(Be.matrixWorld),this.cameraRPos.setFromMatrixPosition(De.matrixWorld);var Ve=this.cameraLPos.distanceTo(this.cameraRPos),Fe=Be.projectionMatrix.elements,Je=De.projectionMatrix.elements,Xe=Fe[14]/(Fe[10]-1),Ke=Fe[14]/(Fe[10]+1),Ye=(Fe[9]+1)/Fe[5],or=(Fe[9]-1)/Fe[5],sr=(Fe[8]-1)/Fe[0],cr=(Je[8]+1)/Je[0],Br=Xe*sr,tn=Xe*cr,en=Ve/(-sr+cr),an=en*-sr;Be.matrixWorld.decompose(Se.position,Se.quaternion,Se.scale),Se.translateX(an),Se.translateZ(en),Se.matrixWorld.compose(Se.position,Se.quaternion,Se.scale),Se.matrixWorldInverse.getInverse(Se.matrixWorld);var rn=Xe+en,on=Ke+en,sn=Br-an,ln=tn+(Ve-an),cn=Ye*Ke/on*rn,hn=or*Ke/on*rn;Se.projectionMatrix.makePerspective(sn,ln,cn,hn,rn,on)},$e.prototype.getCamera=function(Se){this.cameraVR.near=this.cameraR.near=this.cameraL.near=Se.near,this.cameraVR.far=this.cameraR.far=this.cameraL.far=Se.far,this.session&&(this.currentDepthNear!==this.cameraVR.near||this.currentDepthFar!==this.cameraVR.far)&&(this.session.updateRenderState({depthNear:this.cameraVR.near,depthFar:this.cameraVR.far}),this.currentDepthNear=this.cameraVR.near,this.currentDepthFar=this.cameraVR.far);var Be=Se.parent,De=this.cameraVR.cameras;this.updateCamera(this.cameraVR,Be);for(var Ve=0;Ve<De.length;Ve++)this.updateCamera(De[Ve],Be);Se.matrixWorld.copy(this.cameraVR.matrixWorld);for(var Fe=Se.children,Ve=0,Je=Fe.length;Ve<Je;Ve++)Fe[Ve].updateMatrixWorld(!0);return De.length===2?this.setProjectionFromUnion(this.cameraVR,this.cameraL,this.cameraR):this.cameraVR.projectionMatrix.copy(this.cameraL.projectionMatrix),this.cameraVR},$e.prototype.updateInputSources=function(Se){if(!this.session){console.warn("session is lose!");return}for(var Be=this.session.inputSources,De=0;De<this.controllers.length;De++)this.inputSourcesMap.set(Be[De],this.controllers[De]);for(var De=0;De<Se.removed.length;De++){var Ve=Se.removed[De],Fe=this.inputSourcesMap.get(Ve);Fe&&(Fe.dispatchEvent({type:"disconnected",data:Ve}),this.inputSourcesMap.delete(Ve))}for(var De=0;De<Se.added.length;De++){var Ve=Se.added[De],Fe=this.inputSourcesMap.get(Ve);Fe&&Fe.dispatchEvent({type:"connected",data:Ve})}},$e.prototype.onSessionEvent=function(Se){var Be=this.inputSourcesMap.get(Se.inputSource);Be&&Be.dispatchEvent({type:Se.type})},$e.prototype.onSessionEnd=function(){this.inputSourcesMap.forEach(function(Se,Be){Se.disconnect(Be)}),this.inputSourcesMap.clear(),this.renderer.setFramebuffer(null),this.renderer.setRenderTarget(this.renderer.getRenderTarget()),this.isPresenting=!1,this.session=null,AnimationFrameLoop.shared.setContext(null),this.onSessionEndCallback()},$e.prototype.onRequestReferenceSpace=function(Se){this.referenceSpace=Se,this.isPresenting=!0,this.session&&this.onSessionStartCallback(this.session)},$e.prototype.setSession=function(Se){var Be=this;if(this.session=Se,this.session){this.session.addEventListener("select",function(Ve){Be.onSessionEvent(Ve)}),this.session.addEventListener("selectstart",function(Ve){Be.onSessionEvent(Ve)}),this.session.addEventListener("selectend",function(Ve){Be.onSessionEvent(Ve)}),this.session.addEventListener("squeeze",function(Ve){Be.onSessionEvent(Ve)}),this.session.addEventListener("squeezestart",function(Ve){Be.onSessionEvent(Ve)}),this.session.addEventListener("squeezeend",function(Ve){Be.onSessionEvent(Ve)}),this.session.addEventListener("end",function(Ve){Be.onSessionEnd()});var De=this.gl.getContextAttributes();this.gl.makeXRCompatible().then(function(){var Ve={antialias:De?.antialias,alpha:De?.alpha,depth:De?.depth,stencil:De?.stencil,framebufferScaleFactor};if(!Be.session){console.error("session is lose while set session!");return}switch(Be.machineType){case"Pico":case"VP":Be.session.updateRenderState({baseLayer:new XRWebGLLayer(Be.session,Be.gl,Ve)});break;case"Oculus":Be.session.updateRenderState({baseLayer:new XRWebGLLayer(Be.session,Be.gl,Ve)});break;default:Be.machineType;break}Be.session.requestReferenceSpace(Be.referenceSpaceType).then(function(Fe){Be.onRequestReferenceSpace(Fe)}),Be.session.addEventListener("inputsourceschange",function(Fe){Be.updateInputSources(Fe)})})}},$e}(),LineSegmentsGeometry=function($e){__extends(Se,$e);function Se(){var Be=$e.call(this)||this;Be.type="LineSegmentsGeometry";var De=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],Ve=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],Fe=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];return Be.setIndex(Fe),Be.setAttribute("position",new Float32BufferAttribute(De,3)),Be.setAttribute("uv",new Float32BufferAttribute(Ve,2)),Be}return Se.prototype.applyMatrix4=function(Be){var De=this.attributes.instanceStart,Ve=this.attributes.instanceEnd;return De!==void 0&&(De.applyMatrix4(Be),Ve.applyMatrix4(Be),De.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},Se.prototype.setPositions=function(Be){var De;Be instanceof Float32Array?De=Be:Array.isArray(Be)?De=new Float32Array(Be):De=new Float32Array;var Ve=new InstancedInterleavedBuffer(De,6,1);return this.setAttribute("instanceStart",new InterleavedBufferAttribute(Ve,3,0)),this.setAttribute("instanceEnd",new InterleavedBufferAttribute(Ve,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},Se.prototype.setColors=function(Be){var De;Be instanceof Float32Array?De=Be:Array.isArray(Be)?De=new Float32Array(Be):De=new Float32Array;var Ve=new InstancedInterleavedBuffer(De,6,1);return this.setAttribute("instanceColorStart",new InterleavedBufferAttribute(Ve,3,0)),this.setAttribute("instanceColorEnd",new InterleavedBufferAttribute(Ve,3,3)),this},Se.prototype.fromWireframeGeometry=function(Be){return this.setPositions(Be.attributes.position.array),this},Se.prototype.fromEdgesGeometry=function(Be){return this.setPositions(Be.attributes.position.array),this},Se.prototype.fromMesh=function(Be){return this.fromWireframeGeometry(new WireframeGeometry(Be.geometry)),this},Se.prototype.fromLineSegments=function(Be){var De=Be.geometry;if(De instanceof Geometry){var Ve=new BufferGeometry().fromGeometry(De);this.setPositions(Ve.attributes.position.array)}else De instanceof BufferGeometry&&this.setPositions(De.attributes.position.array);return this},Se.prototype.computeBoundingBox=function(){this.boundingBox===null&&(this.boundingBox=new Box3);var Be=this.attributes.instanceStart,De=this.attributes.instanceEnd;if(Be!==void 0&&De!==void 0){var Ve=new Box3;this.boundingBox.setFromBufferAttribute(Be),Ve.setFromBufferAttribute(De),this.boundingBox.union(Ve)}},Se.prototype.computeBoundingSphere=function(){this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingBox===null&&this.computeBoundingBox();var Be=this.attributes.instanceStart,De=this.attributes.instanceEnd;if(Be!==void 0&&De!==void 0){var Ve=this.boundingSphere.center;this.boundingBox.getCenter(Ve);for(var Fe=0,Je=new Vector3,Xe=0,Ke=Be.count;Xe<Ke;Xe++)Je.fromBufferAttribute(Be,Xe),Fe=Math.max(Fe,Ve.distanceToSquared(Je)),Je.fromBufferAttribute(De,Xe),Fe=Math.max(Fe,Ve.distanceToSquared(Je));this.boundingSphere.radius=Math.sqrt(Fe),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}},Se.prototype.toJSON=function(){},Se}(InstancedBufferGeometry);Object.assign(LineSegmentsGeometry.prototype,{isLineSegmentsGeometry:!0});var lineShader={uniforms:UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,{linewidth:{value:1},resolution:{value:new Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1},opacity:{value:1}}]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		varying vec2 vUv;

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;

			#endif

			float aspect = resolution.x / resolution.y;

			vUv = uv;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec2 ndcStart = clipStart.xy / clipStart.w;
			vec2 ndcEnd = clipEnd.xy / clipEnd.w;

			// direction
			vec2 dir = ndcEnd - ndcStart;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			// perpendicular to dir
			vec2 offset = vec2( dir.y, - dir.x );

			// undo aspect ratio adjustment
			dir.x /= aspect;
			offset.x /= aspect;

			// sign flip
			if ( position.x < 0.0 ) offset *= - 1.0;

			// endcaps
			if ( position.y < 0.0 ) {

				offset += - dir;

			} else if ( position.y > 1.0 ) {

				offset += dir;

			}

			// adjust for linewidth
			offset *= linewidth;

			// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
			offset /= resolution.y;

			// select end
			vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

			// back to clip space
			offset *= clip.w;

			clip.xy += offset;

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;

		#ifdef USE_DASH

			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		varying vec2 vUv;

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			if ( abs( vUv.y ) > 1.0 ) {

				float a = vUv.x;
				float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
				float len2 = a * a + b * b;

				if ( len2 > 1.0 ) discard;

			}

			vec4 diffuseColor = vec4( diffuse, opacity );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );

			#include <tonemapping_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`},LineMaterial=function($e){__extends(Se,$e);function Se(Be){var De=$e.call(this,{uniforms:UniformsUtils.clone(lineShader.uniforms),vertexShader:lineShader.vertexShader,fragmentShader:lineShader.fragmentShader,clipping:!0})||this;return De.type="LineMaterial",De.dashed=!1,Object.defineProperties(De,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(Ve){this.uniforms.diffuse.value=Ve}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(Ve){this.uniforms.linewidth.value=Ve}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(Ve){this.uniforms.dashScale.value=Ve}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(Ve){this.uniforms.dashSize.value=Ve}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(Ve){this.uniforms.gapSize.value=Ve}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(Ve){this.uniforms.opacity.value=Ve}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(Ve){this.uniforms.resolution.value.copy(Ve)}}}),De.setValues(Be),De}return Se}(ShaderMaterial);Object.assign(LineMaterial.prototype,{isLineMaterial:!0});var LineSegments2=function($e){__extends(Se,$e);function Se(Be,De){var Ve=$e.call(this)||this;return Ve.type="LineSegments2",Ve.geometry=Be!==void 0?Be:new LineSegmentsGeometry,Ve.material=De!==void 0?De:new LineMaterial({color:Math.random()*16777215}),Ve}return Se.prototype.computeLineDistances=function(){for(var Be=this.geometry,De=Be.attributes.instanceStart,Ve=Be.attributes.instanceEnd,Fe=new Float32Array(2*De.count),Je=new Vector3,Xe=new Vector3,Ke=0,Ye=0,or=De.count;Ke<or;Ke++,Ye+=2)Je.fromBufferAttribute(De,Ke),Xe.fromBufferAttribute(Ve,Ke),Fe[Ye]=Ye===0?0:Fe[Ye-1],Fe[Ye+1]=Fe[Ye]+Je.distanceTo(Xe);var sr=new InstancedInterleavedBuffer(Fe,2,1);return Be.setAttribute("instanceDistanceStart",new InterleavedBufferAttribute(sr,1,0)),Be.setAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(sr,1,1)),this},Se.prototype.raycast=function(Be,De){Be.camera===null&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var Ve=Be.ray,Fe=Be.camera,Je=Fe.projectionMatrix,Xe=this.geometry,Ke=this.material,Ye=Ke.resolution,or=Ke.linewidth,sr=Xe.attributes.instanceStart,cr=Xe.attributes.instanceEnd,Br=new Vector4,tn=new Vector4,en=new Vector4,an=new Vector3,rn=new Matrix4,on=new Line3,sn=new Vector3;Ve.at(1,en),en.w=1,en.applyMatrix4(Fe.matrixWorldInverse),en.applyMatrix4(Je),en.multiplyScalar(1/en.w),en.x*=Ye.x/2,en.y*=Ye.y/2,en.z=0,an.copy(en);var ln=this.matrixWorld;rn.multiplyMatrices(Fe.matrixWorldInverse,ln);for(var cn=0,hn=sr.count;cn<hn;cn++){Br.fromBufferAttribute(sr,cn),tn.fromBufferAttribute(cr,cn),Br.w=1,tn.w=1,Br.applyMatrix4(rn),tn.applyMatrix4(rn),Br.applyMatrix4(Je),tn.applyMatrix4(Je),Br.multiplyScalar(1/Br.w),tn.multiplyScalar(1/tn.w);var mn=Br.z<-1&&tn.z<-1,An=Br.z>1&&tn.z>1;if(!(mn||An)){Br.x*=Ye.x/2,Br.y*=Ye.y/2,tn.x*=Ye.x/2,tn.y*=Ye.y/2,on.start.copy(Br),on.start.z=0,on.end.copy(tn),on.end.z=0;var xn=on.closestPointToPointParameter(an,!0);on.at(xn,sn);var pn=MathUtils.lerp(Br.z,tn.z,xn),dn=pn>=-1&&pn<=1,fn=an.distanceTo(sn)<or*.5;if(dn&&fn){on.start.fromBufferAttribute(sr,cn),on.end.fromBufferAttribute(cr,cn),on.start.applyMatrix4(ln),on.end.applyMatrix4(ln);var yn=new Vector3,Sn=new Vector3;Ve.distanceSqToSegment(on.start,on.end,Sn,yn),De.push({point:Sn,pointOnLine:yn,distance:Ve.origin.distanceTo(Sn),object:this,faceIndex:cn})}}}},Se}(Mesh);Object.assign(LineSegments2.prototype,{isLineSegments2:!0});var Line2=function($e){__extends(Se,$e);function Se(Be,De){var Ve=$e.call(this,Be,De)||this;return Ve.type="Line2",Ve}return Se}(LineSegments2);Object.assign(Line2.prototype,{isLine2:!0});var LineGeometry=function($e){__extends(Se,$e);function Se(){var Be=$e.call(this)||this;return Be.type="LineGeometry",Be}return Se.prototype.setPositions=function(Be){for(var De=Be.length-3,Ve=new Float32Array(2*De),Fe=0;Fe<De;Fe+=3)Ve[2*Fe]=Be[Fe],Ve[2*Fe+1]=Be[Fe+1],Ve[2*Fe+2]=Be[Fe+2],Ve[2*Fe+3]=Be[Fe+3],Ve[2*Fe+4]=Be[Fe+4],Ve[2*Fe+5]=Be[Fe+5];return $e.prototype.setPositions.call(this,Ve),this},Se.prototype.setColors=function(Be){for(var De=Be.length-3,Ve=new Float32Array(2*De),Fe=0;Fe<De;Fe+=3)Ve[2*Fe]=Be[Fe],Ve[2*Fe+1]=Be[Fe+1],Ve[2*Fe+2]=Be[Fe+2],Ve[2*Fe+3]=Be[Fe+3],Ve[2*Fe+4]=Be[Fe+4],Ve[2*Fe+5]=Be[Fe+5];return $e.prototype.setColors.call(this,Ve),this},Se.prototype.fromLine=function(Be){var De=Be.geometry;if(De instanceof Geometry){var Ve=new BufferGeometry().fromGeometry(De);this.setPositions(Ve.attributes.position.array)}else De instanceof BufferGeometry&&this.setPositions(De.attributes.position.array);return this},Se.prototype.copy=function(){return this},Se}(LineSegmentsGeometry);Object.assign(LineGeometry.prototype,{isLineGeometry:!0});var circleImageURL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sHDgwCEMBJZu0AAAAdaVRYdENvbW1lbnQAAAAAAENyZWF0ZWQgd2l0aCBHSU1QZC5lBwAABM5JREFUWMO1V0tPG2cUPZ4Hxh6DazIOrjFNqJs0FIMqWFgWQkatsmvVbtggKlSVRVf5AWz4AWz4AUSKEChll19QJYSXkECuhFxsHjEhxCYm+DWGMZ5HF72DJq4bAzFXurI0M/I5997v3u9cC65vTJVn2lX/xHINQOYSBLTLEuIuCWw4Z3IGAEvf6ASmVHjNzHCXBG4A0AjACsAOwEbO0nsFQBnAGYASAIl+ZRMR7SolMEdsByD09fV5R0ZGgg8ePPjW5/N1iqLYpuu6RZblciKR2I9Go69evnwZnZ+fjwI4IS8AKBIRzeQfJWCANwKwh0KhtrGxsYehUOin1tbW+zzP23ietzY2NnIAoGmaLsuyUiqVyvl8XtrY2NiamZn589mzZxsAUgCOAeQAnFI2tI+VxIjaAeDzoaGh7xYWFuZOTk6OZVk+12uYqqq6JEnn0Wg0OT4+/geAXwGEAdwDIFJQXC1wO4DWR48e/RCPxxclSSroVzRFUbSDg4P848ePFwH8DuAhkWih83TRQWxFOXgAwvDwcOfo6OhvXV1d39tsNtuVBwTDWBwOh1UUxVsMw1hXVlbSdCgNV43uYSvrHg6H24aHh38eHBz85TrgF9FYLHA4HLzH43FvbW2d7u/vG+dANp8FpqIlbd3d3V8Fg8EfBUFw4BONZVmL3+9vHhkZCQL4AoAHgJPK8G+yzC0XDofdoVAo5PP5vkadTBAEtr+/39ff3x8gAp/RPOEqx2qjx+NpvXv3bk9DQ0NDvQgwDIOWlhZrMBj8kgi0UJdxRgYMArzL5XJ7vd57qLPZ7Xamp6fnNgBXtQxcjFuHw+Hyer3t9SYgCAITCAScAJoBNNEY/08GOFVVrfVMv7kMNDntFD1vjIAPrlRN0xjckOm6biFQ3jwNPwDMZrOnqVTqfb3Bi8Wivru7W/VCYkwPlKOjo0IikXh7EwQikYgE4Nw0CfXKDCipVCoTj8df3QABbW1tLUc6oUgkFPMkVACUNjc337148eKvw8PDbJ2jP1taWkoCyNDVXDSECmNSK4qiKNLq6urW8+fPI/UicHx8rD59+jSVy+WOAKSJhKENwFItLtoxk8mwsixzHR0dHe3t7c5PAU+n09rs7OzJkydPYqVSaQfANoDXALIk31S2smU1TWMPDg7K5XKZ7+3t9TudTut1U7+wsFCcmJiIpdPpbQBxADsAknQWymYCOukBHYCuKApisdhpMpnURFEU79y503TVyKenpzOTk5M7e3t7MQKPV0Zv1gNm+awB0MvlshqLxfLb29uyJElWURSbXC4XXyvqxcXFs6mpqeTc3Nzu3t7e3wQcA7BPZ8Cov1pNlJplmQtAG8MwHV6v95tAINA5MDBwPxAIuLu6upr8fr/VAN3c3JQjkcjZ+vp6fnl5+d2bN29SuVzuNYAEpf01CdRChUL+X1VskHACuA3Ay3Fcu9vt7nA6nZ7m5uYWQRCaNE3jVVW15PP580KhIGUymWw2m00DOAJwSP4WwPtq4LX2Ao6USxNlQyS/RcQcdLGwlNIz6vEMAaZpNzCk2Pll94LK/cDYimxERiBwG10sxjgvEZBE0UpE6vxj+0Ct5bTaXthgEhRmja8QWNkkPGsuIpfdjpkK+cZUWTC0KredVmtD/gdlSl6EG4AMvQAAAABJRU5ErkJggg==",DEFAULT_COLOR=14467195,POINT_SIZE=8,DEFAULT_LINEWIDTH=2,DEFAULT_DASHSCALE=20,sharedCircleTexture=null,FiveLine=function($e){__extends(Se,$e);function Se(Be,De){Be===void 0&&(Be=new Vector3),De===void 0&&(De=new Vector3);var Ve=$e.call(this)||this;Ve.type="FiveLine",Ve.needsRender=!0;var Fe=new LineGeometry,Je=new LineMaterial({color:DEFAULT_COLOR,linewidth:DEFAULT_LINEWIDTH,dashScale:DEFAULT_DASHSCALE,dashed:!1});Ve.line=new Line2(Fe,Je);var Xe=new BufferGeometry,Ke=new PointsMaterial({color:DEFAULT_COLOR,size:POINT_SIZE,map:sharedCircleTexture||(sharedCircleTexture=new TextureLoader$1().load(circleImageURL)),sizeAttenuation:!1,transparent:!0});return Ve.points=new Points(Xe,Ke),Ve.points.renderOrder=11,Ve.points.frustumCulled=!1,Ve.setPoints(Be,De),Ve.add(Ve.line,Ve.points),Ve}return Object.defineProperty(Se,"version",{get:function(){return"6.4.0-alpha.38"},enumerable:!1,configurable:!0}),Se.prototype.setPoints=function(Be,De){var Ve=[].concat(Be.toArray(),De.toArray());this.points.geometry.setAttribute("position",new BufferAttribute(new Float32Array(Ve),3)),this.line.geometry.setPositions(Ve),this.line.computeLineDistances(),this.needsRender=!0},Se.prototype.getPoints=function(){var Be=this.points.geometry.attributes.position.array;return[new Vector3(Be[0],Be[1],Be[2]),new Vector3(Be[3],Be[4],Be[5])]},Se.prototype.setMaterial=function(Be){var De=this.line.material;for(var Ve in Be)if(Be.hasOwnProperty(Ve)){var Fe=Be[Ve];Ve==="dashed"?(De.dashed=Fe,Fe?De.defines.USE_DASH="":delete De.defines.USE_DASH,De.needsUpdate=!0):De[Ve]=Be[Ve]}this.needsRender=!0},Se.prototype.setResolution=function(Be,De){var Ve=this.line.material.resolution;(Ve.x!==Be||Ve.y!==De)&&(Ve.set(Be,De),this.needsRender=!0)},Se}(Object3D);Object.assign(FiveLine.prototype,{isFiveLine:!0});var Constants={ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function fetchJsonFile($e){return __awaiter(this,void 0,void 0,function(){var Se;return __generator(this,function(Be){switch(Be.label){case 0:return[4,fetch($e)];case 1:if(Se=Be.sent(),Se.ok)return[2,Se.json()];throw new Error(Se.statusText)}})})}function fetchProfilesList($e){return __awaiter(this,void 0,void 0,function(){var Se,Be;return __generator(this,function(De){switch(De.label){case 0:if(!$e)throw new Error("No basePath supplied");return Se="profilesList.json",[4,fetchJsonFile("".concat($e,"/").concat(Se))];case 1:return Be=De.sent(),[2,Be]}})})}function fetchProfile($e,Se){return __awaiter(this,arguments,void 0,function(Be,De,Ve,Fe){var Je,Xe,Ke,Ye,or,sr;return Ve===void 0&&(Ve=null),Fe===void 0&&(Fe=!0),__generator(this,function(cr){switch(cr.label){case 0:if(!Be)throw new Error("No xrInputSource supplied");if(!De)throw new Error("No basePath supplied");return[4,fetchProfilesList(De)];case 1:if(Je=cr.sent(),Be.profiles.some(function(Br){var tn=Je[Br];return tn&&(Xe={profileId:Br,profilePath:"".concat(De,"/").concat(tn.path),deprecated:!!tn.deprecated}),!!Xe}),!Xe){if(!Ve)throw new Error("No matching profile name found");if(Ke=Je[Ve],!Ke)throw new Error('No matching profile name found and default profile "'.concat(Ve,'" missing.'));Xe={profileId:Ve,profilePath:"".concat(De,"/").concat(Ke.path),deprecated:!!Ke.deprecated}}return[4,fetchJsonFile(Xe.profilePath)];case 2:if(Ye=cr.sent(),Fe){if(sr=void 0,sr=Ye.layouts[Be.handedness],!sr)throw new Error("No matching handedness, ".concat(Be.handedness,", in profile ").concat(Xe.profileId));sr.assetPath&&(or=Xe.profilePath.replace("profile.json",sr.assetPath))}return[2,{profile:Ye,assetPath:or}]}})})}var defaultComponentValues={xAxis:0,yAxis:0,button:0,state:Constants.ComponentState.DEFAULT};function normalizeAxes($e,Se){$e===void 0&&($e=0),Se===void 0&&(Se=0);var Be=$e,De=Se,Ve=Math.sqrt($e*$e+Se*Se);if(Ve>1){var Fe=Math.atan2(Se,$e);Be=Math.cos(Fe),De=Math.sin(Fe)}var Je={normalizedXAxis:Be*.5+.5,normalizedYAxis:De*.5+.5};return Je}var VisualResponse=function(){function $e(Se){this.componentProperty=Se.componentProperty,this.states=Se.states,this.valueNodeName=Se.valueNodeName,this.valueNodeProperty=Se.valueNodeProperty,this.valueNodeProperty===Constants.VisualResponseProperty.TRANSFORM&&(this.minNodeName=Se.minNodeName,this.maxNodeName=Se.maxNodeName),this.value=0,this.updateFromComponent(defaultComponentValues)}return $e.prototype.updateFromComponent=function(Se){var Be=Se.xAxis,De=Se.yAxis,Ve=Se.button,Fe=Se.state,Je=normalizeAxes(Be,De),Xe=Je.normalizedXAxis,Ke=Je.normalizedYAxis;switch(this.componentProperty){case Constants.ComponentProperty.X_AXIS:this.value=this.states.includes(Fe)?Xe:.5;break;case Constants.ComponentProperty.Y_AXIS:this.value=this.states.includes(Fe)?Ke:.5;break;case Constants.ComponentProperty.BUTTON:this.value=this.states.includes(Fe)?Ve:0;break;case Constants.ComponentProperty.STATE:this.valueNodeProperty===Constants.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(Fe):this.value=this.states.includes(Fe)?1:0;break;default:throw new Error("Unexpected visualResponse componentProperty ".concat(this.componentProperty))}},$e}(),Component=function(){function $e(Se,Be){var De=this;if(!Se||!Be||!Be.visualResponses||!Be.gamepadIndices||Object.keys(Be.gamepadIndices).length===0)throw new Error("Invalid arguments supplied");this.id=Se,this.type=Be.type,this.rootNodeName=Be.rootNodeName,this.touchPointNodeName=Be.touchPointNodeName,this.visualResponses={},Object.keys(Be.visualResponses).forEach(function(Ve){var Fe=new VisualResponse(Be.visualResponses[Ve]);De.visualResponses[Ve]=Fe}),this.gamepadIndices=Object.assign({},Be.gamepadIndices),this.values={state:Constants.ComponentState.DEFAULT,button:this.gamepadIndices.button!==void 0?0:void 0,xAxis:this.gamepadIndices.xAxis!==void 0?0:void 0,yAxis:this.gamepadIndices.yAxis!==void 0?0:void 0}}return Object.defineProperty($e.prototype,"data",{get:function(){var Se=__assign({id:this.id},this.values);return Se},enumerable:!1,configurable:!0}),$e.prototype.updateFromGamepad=function(Se){var Be=this;if(this.values.state=Constants.ComponentState.DEFAULT,this.gamepadIndices.button!==void 0&&Se.buttons.length>this.gamepadIndices.button){var De=Se.buttons[this.gamepadIndices.button];this.values.button=De.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,De.pressed||this.values.button===1?this.values.state=Constants.ComponentState.PRESSED:(De.touched||this.values.button>Constants.ButtonTouchThreshold)&&(this.values.state=Constants.ComponentState.TOUCHED)}this.gamepadIndices.xAxis!==void 0&&Se.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=Se.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===Constants.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>Constants.AxisTouchThreshold&&(this.values.state=Constants.ComponentState.TOUCHED)),this.gamepadIndices.yAxis!==void 0&&Se.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=Se.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===Constants.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>Constants.AxisTouchThreshold&&(this.values.state=Constants.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(function(Ve){Ve.updateFromComponent(Be.values)})},$e}(),MotionController=function(){function $e(Se,Be,De){var Ve=this;if(!Se)throw new Error("No xrInputSource supplied");if(!Be)throw new Error("No profile supplied");this.xrInputSource=Se,this.assetUrl=De,this.id=Be.profileId,this.layoutDescription=Be.layouts[Se.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(function(Fe){var Je=Ve.layoutDescription.components[Fe];Ve.components[Fe]=new Component(Fe,Je)}),this.updateFromGamepad()}return Object.defineProperty($e.prototype,"gripSpace",{get:function(){return this.xrInputSource.gripSpace},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"targetRaySpace",{get:function(){return this.xrInputSource.targetRaySpace},enumerable:!1,configurable:!0}),Object.defineProperty($e.prototype,"data",{get:function(){var Se=[];return Object.values(this.components).forEach(function(Be){Se.push(Be.data)}),Se},enumerable:!1,configurable:!0}),$e.prototype.updateFromGamepad=function(){var Se=this;Object.values(this.components).forEach(function(Be){Be.updateFromGamepad(Se.xrInputSource.gamepad)})},$e}(),DEFAULT_PROFILES_PATH="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",DEFAULT_PROFILE="generic-trigger",XRControllerModel=function($e){__extends(Se,$e);function Se(){var Be=$e.call(this)||this;return Be.motionController=null,Be.envMap=null,Be}return Se.prototype.setEnvironmentMap=function(Be){var De=this;return this.envMap==Be?this:(this.envMap=Be,this.traverse(function(Ve){Ve instanceof Mesh&&Ve.isMesh&&(Ve.material.envMap=De.envMap,Ve.material.needsUpdate=!0)}),this)},Se.prototype.updateMatrixWorld=function(Be){$e.prototype.updateMatrixWorld.call(this,Be),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(function(De){Object.values(De.visualResponses).forEach(function(Ve){var Fe=Ve.valueNode,Je=Ve.minNode,Xe=Ve.maxNode,Ke=Ve.value,Ye=Ve.valueNodeProperty;Fe&&(Ye===Constants.VisualResponseProperty.VISIBILITY?Fe.visible=Ke:Ye===Constants.VisualResponseProperty.TRANSFORM&&(Fe.quaternion.copy(Je.quaternion).slerp(Xe.quaternion,Ke),Fe.position.lerpVectors(Je.position,Xe.position,Ke)))})}))},Se}(Object3D);function findNodes($e,Se){Object.values($e.components).forEach(function(Be){var De=Be.type,Ve=Be.touchPointNodeName,Fe=Be.visualResponses;if(De===Constants.ComponentType.TOUCHPAD)if(Be.touchPointNode=Se.getObjectByName(Ve),Be.touchPointNode){var Je=new SphereGeometry(.001),Xe=new MeshBasicMaterial({color:255}),Ke=new Mesh(Je,Xe);Be.touchPointNode.add(Ke)}else console.warn("Could not find touch dot, ".concat(Be.touchPointNodeName,", in touchpad component ").concat(Be.id));Object.values(Fe).forEach(function(Ye){var or=Ye.valueNodeName,sr=Ye.minNodeName,cr=Ye.maxNodeName,Br=Ye.valueNodeProperty;if(Br===Constants.VisualResponseProperty.TRANSFORM){if(Ye.minNode=Se.getObjectByName(sr),Ye.maxNode=Se.getObjectByName(cr),!Ye.minNode){console.warn("Could not find ".concat(sr," in the model"));return}if(!Ye.maxNode){console.warn("Could not find ".concat(cr," in the model"));return}}Ye.valueNode=Se.getObjectByName(or),Ye.valueNode||console.warn("Could not find ".concat(or," in the model"))})})}function addAssetSceneToControllerModel($e,Se){findNodes($e.motionController,Se),$e.envMap&&Se.traverse(function(Be){Be instanceof Mesh&&Be.isMesh&&(Be.material.envMap=$e.envMap,Be.material.needsUpdate=!0)}),$e.add(Se)}var XRControllerModelFactory=function(){function $e(Se){Se===void 0&&(Se=null),this.gltfLoader=Se,this.path=DEFAULT_PROFILES_PATH,this._assetCache={}}return $e.prototype.createControllerModel=function(Se){var Be=this,De=new XRControllerModel,Ve=null;return Se.addEventListener("connected",function(Fe){var Je=Fe.data;Je.targetRayMode!=="tracked-pointer"||!Je.gamepad||fetchProfile(Je,Be.path,DEFAULT_PROFILE).then(function(Xe){var Ke=Xe.profile,Ye=Xe.assetPath;De.motionController=new MotionController(Je,Ke,Ye);var or=Be._assetCache[De.motionController.assetUrl];if(or)Ve=or.scene.clone(),addAssetSceneToControllerModel(De,Ve);else{if(!Be.gltfLoader)throw new Error("GLTFLoader not set.");Be.gltfLoader.load(De.motionController.assetUrl,function(sr){Be._assetCache[De.motionController.assetUrl]=sr,Ve=sr.scene.clone(),addAssetSceneToControllerModel(De,Ve)})}}).catch(function(Xe){console.warn(Xe)})}),Se.addEventListener("disconnected",function(){De.motionController=null,De.remove(Ve),Ve=null}),De},$e}();__assign({},omit(defaultPanoramaControllerCustomInitArgs,["maxLatitude","minLatitude"]));function mapPanoResource($e,Se){return $e}var CONTROLLER_EVNET_DELTA_TIME=300,ROTATE_Y_PI_MATRIX=new Matrix4().makeRotationAxis(new Vector3(0,1,0),Math.PI),PANO_TEXTURE_SCALE=new Vector3(-1,1,1),XRPanoramaController=function($e){__extends(Se,$e);function Se(Be){var De=$e.call(this,Be)||this;De.xrManager=new XRManager(De.renderer,De.renderer.getContext(),{onSessionStart:function(Ke){De.emit("xr.session.start",createEvent("xr.session.start",{session:Ke,machineType:De.xrManager.machineType}))},onSessionEnd:function(){De.emit("xr.session.end",createEvent("xr.session.end",{session:null,machineType:De.xrManager.machineType}))}}),De.xrControllerRay={left:new Raycaster,right:new Raycaster},De.xrControllerRay.left.params.Points={threshold:.1},De.xrControllerRay.right.params.Points={threshold:.1},De.gazeRay=null,De.pointerLines={left:new FiveLine,right:new FiveLine},De.pointerLines.left.visible=!1,De.pointerLines.right.visible=!0,De.pointerLines.left.setMaterial({color:new Vector3(1,1,1)}),De.pointerLines.left.points.material.depthTest=!1,De.pointerLines.right.setMaterial({color:new Vector3(1,1,1)}),De.pointerLines.right.points.material.depthTest=!1,De.controllerWrappers=[new Group$1,new Group$1];var Ve=De.xrManager.getController(0);De.controllerWrappers[0].add(Ve);var Fe=De.xrManager.getController(1);De.controllerWrappers[1].add(Fe);var Je=new XRControllerModelFactory;Je.gltfLoader={load:function(Ke,Ye){internalFetcher.ajax(Ke,{responseType:"arraybuffer"}).then(function(or){var sr;return parseGltf(or.body,{resourcePath:Ke.slice(0,Ke.lastIndexOf("/")+1),search:(sr=Ke.split("?")[1])!==null&&sr!==void 0?sr:"",fetcher:internalFetcher})}).then(function(or){return Ye(or)})}},(De.xrManager.machineType==="Oculus"||De.xrManager.machineType==="Pico")&&De.scene.add(De.pointerLines.left,De.pointerLines.right,De.controllerWrappers[0],De.controllerWrappers[1]),De.panoResources={},De.panoResources[De.locationMotion.keyframes[0].key=De.locationMotion.keyframes[1].key=createUuid()]={panoId:panoStringify(De.currentPano),leftPanoPicture:null,position:De.camera.pose.offset.clone(),effect:"fade",fixCameraTransform:new Matrix4},De.parallaxCameraMatrixs=[];var Xe=AnimationFrameLoop.shared.getContext();return Xe?(De.on("xr.session.end",function(){De.scene.remove(De.pointerLines.left,De.pointerLines.right)}),De.xrManager.setSession(Xe),De.on("xr.session.start",function(){var Ke=De.xrManager.getControllerGrip(0);Ke.add(Je.createControllerModel(Ke)),De.controllerWrappers[0].add(Ke);var Ye=De.xrManager.getControllerGrip(1);Ye.add(Je.createControllerModel(Ye)),De.controllerWrappers[1].add(Ye)}),De.xrHandleState={LeftAxesUp:{touchStartTime:0,touchStart:!1},LeftAxesDown:{touchStartTime:0,touchStart:!1},LeftAxesLeft:{touchStartTime:0,touchStart:!1},LeftAxesRight:{touchStartTime:0,touchStart:!1},LeftTrigger:{touchStartTime:0,touchStart:!1},LeftPinch:{touchStartTime:0,touchStart:!1},RightAxesUp:{touchStartTime:0,touchStart:!1},RightAxesDown:{touchStartTime:0,touchStart:!1},RightAxesLeft:{touchStartTime:0,touchStart:!1},RightAxesRight:{touchStartTime:0,touchStart:!1},RightTrigger:{touchStartTime:0,touchStart:!1},RightPinch:{touchStartTime:0,touchStart:!1},Y:{touchStartTime:0,touchStart:!1},X:{touchStartTime:0,touchStart:!1},A:{touchStartTime:0,touchStart:!1},B:{touchStartTime:0,touchStart:!1}},De.xrManager.machineType==="VP"&&De.initHandEvent(),De):(console.error("获取session失败，请退出重试"),De)}return Se.parseArgs=function(Be){if(Be instanceof Se)return Be;var De=__assign(__assign({},Be),{maxLatitude:Math.PI/2,minLatitude:-Math.PI/2});return $e.parseArgs.call(this,De)},Se.initAnimationEndState=function(Be){var De=this.parseArgs(Be),Ve=$e.initAnimationEndState.call(this,De);return __assign(__assign({},Ve),{mode:"XRPanorama"})},Se.prototype.updateConfiguration=function(Be){return $e.prototype.updateConfiguration.call(this,__assign(__assign({},Be),{maxLatitude:Math.PI/2,minLatitude:-Math.PI/2}))},Se.prototype.moveToPano=function(Be,De,Ve){var Fe=this,Je,Xe,Ke,Ye,or=(Je=De.effect)!==null&&Je!==void 0?Je:"fade";this.userAction=Ve,this.stopMomentumMovement();var sr=this.works.getResolvedObserver(Be);if(!sr)throw new Error("Invalid PanoIndex");var cr=getImageSizeFromURL(sr.images.up),Br=this.imageOptions.size;typeof Br>"u"&&sr&&cr&&(Br=Number(cr)),typeof Br>"u"&&(Br=2048);var tn=this.imageOptions.transform,en=function(dn,fn){return mapPanoResource(applyImageURLOptions(dn,tn,fn))},an=__assign({key:"pano.".concat(sr.panoId)},pick(this.imageOptions,["format","size","quality"])),rn=sr.images,on=(Ke=(Xe=sr.images.tiles)===null||Xe===void 0?void 0:Xe.filter(function(dn){return dn.size>Br}))!==null&&Ke!==void 0?Ke:null,sn="pano:"+jsonHash([rn,an,tn]);if(this.pendingTextureTask){if(this.pendingTextureTask.hash===sn)return;var ln=this.pendingTextureTask.panoId;(Ye=this.panoMeshes[ln])===null||Ye===void 0||Ye.setProgress(0),this.emit("pano.texture.abort",createEvent("pano.texture.abort",{error:null,progress:0,meta:null,pano:sr.pano}))}var cn=this.models.getMaterial()||{},hn=cn.pano0,mn=cn.pano1,An;if(hn?.map.name===sn?An=hn:mn?.map.name===sn&&(An=mn),An){var xn={panoId:sr.panoId,effect:or,leftPanoPicture:{zoom:1,map:An.map,luminanceMap:An.luminanceMap,matrix:new Matrix4().compose(sr.position,sr.quaternion,PANO_TEXTURE_SCALE)},position:sr.position.clone(),fixCameraTransform:new Matrix4};this.doMoveToPano(sr.pano,xn,De);return}var pn="move-to-pano-"+sr.panoId;this.pending.add(pn),this.pendingTextureTask={panoId:sr.panoId,hash:sn,onLoad:function(dn){if(Fe.pending.delete(pn),Fe.destroyed)dn.body.dispose();else{dn.body.name=sn;var fn={panoId:sr.panoId,effect:or,leftPanoPicture:{zoom:1,map:dn.body,luminanceMap:null,matrix:new Matrix4().compose(sr.position,sr.quaternion,PANO_TEXTURE_SCALE)},position:sr.position.clone(),fixCameraTransform:new Matrix4};Fe.doMoveToPano(sr.pano,fn,De)}},onError:function(dn){Fe.pending.delete(pn);var fn=__assign(__assign(__assign({},sr.pano),{mode:Fe.mode}),clonePose(Fe.camera.pose));Fe.emit("pano.error",createEvent("pano.error",{error:dn,userAction:Fe.userAction,options:De,prevPano:Fe.currentPano,progress:0,state:fn})),Fe.emit("pano.cancel",createEvent("pano.cancel",{error:null,userAction:Fe.userAction,options:De,prevPano:Fe.currentPano,progress:0,state:fn})),De.moveCancelCallback&&De.moveCancelCallback()}},Promise.all([this.tileLevelForFov&&on&&on.length?this.textureLoader.loadTiledCubeTexture(rn,on,{tileMaxLevel:this.tiledCubeTextureLevel,imageURL:{transform:en,options:an},format:RGBAFormat,minFilter:LinearFilter,magFilter:LinearFilter,generateMipmaps:!1,viaAjax:!0,fetcher:getFetcher(sr.work)},void 0,void 0,function(dn){var fn,yn;Fe.emit("pano.texture.progress",createEvent("pano.texture.progress",{error:null,progress:dn,meta:null,pano:sr.pano})),((fn=Fe.pendingTextureTask)===null||fn===void 0?void 0:fn.hash)===sn&&((yn=Fe.panoMeshes[sr.panoId])===null||yn===void 0||yn.setProgress(dn))},this.renderer):this.textureLoader.loadCubeTexture(rn,{imageURL:{transform:en,options:an},format:RGBAFormat,fetcher:getFetcher(sr.work)},void 0,void 0,function(dn){var fn,yn;((fn=Fe.pendingTextureTask)===null||fn===void 0?void 0:fn.hash)===sn&&((yn=Fe.panoMeshes[sr.panoId])===null||yn===void 0||yn.setProgress(dn)),Fe.emit("pano.texture.progress",createEvent("pano.texture.progress",{error:null,progress:dn,meta:null,pano:sr.pano}))},this.renderer)]).then(function(dn){var fn,yn,Sn=dn[0];((fn=Fe.pendingTextureTask)===null||fn===void 0?void 0:fn.hash)===sn?(Fe.pendingTextureTask.onLoad(Sn),(yn=Fe.panoMeshes[sr.panoId])===null||yn===void 0||yn.setProgress(0),delete Fe.pendingTextureTask,Fe.emit("pano.texture.success",createEvent("pano.texture.success",{error:null,progress:1,meta:Sn.meta,pano:sr.pano}))):Sn.body.dispose()}).catch(function(dn){var fn,yn;((fn=Fe.pendingTextureTask)===null||fn===void 0?void 0:fn.hash)===sn&&(Fe.pendingTextureTask.onError(dn),(yn=Fe.panoMeshes[sr.panoId])===null||yn===void 0||yn.setProgress(0),delete Fe.pendingTextureTask,Fe.emit("pano.texture.error",createEvent("pano.texture.error",{error:dn,progress:0,meta:null,pano:sr.pano})),Fe.emit("error",dn))}),this.emit("pano.texture.load",createEvent("pano.texture.load",{error:null,progress:0,meta:null,pano:sr.pano}))},Se.prototype.doMoveToPano=function(Be,De,Ve){var Fe=this,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en;Ve===void 0&&(Ve={});var an=now$2(),rn=createUuid();this.panoResources[rn]=De;var on=1,sn,ln,cn;if(this.locationMotion.ended){var hn=this.locationMotion.getKeyFrameSegment(an);hn[0];var mn=hn[1],An=this.locationMotion.value,xn=this.panoResourceFromLocationMotionKeyframe(mn).position,pn=De.position;sn=Math.max(xn.distanceTo(pn),on),ln=[{key:mn.key,progress:0,value:__assign(__assign({},An),{count:0})},{key:rn,progress:1,value:{distance:0,count:1}}],cn=0}else{var dn=this.locationMotion.getKeyFrameSegment(an),fn=dn[0],mn=dn[1],An=this.locationMotion.value,yn=this.panoResourceFromLocationMotionKeyframe(fn).position,xn=this.panoResourceFromLocationMotionKeyframe(mn).position,pn=De.position,Sn=mn.value.count-An.count,gn=Math.max(yn.distanceTo(xn),on)*Sn,Cn=Math.max(xn.distanceTo(pn),on);sn=gn+Cn,ln=[{key:fn.key,progress:0,value:__assign({},An)},{key:mn.key,progress:gn/sn,value:mn.value},{key:rn,progress:1,value:{count:mn.value.count+1,distance:0}}];var Mn=this.locationMotionKeyframesLength(this.locationMotion.keyframes),Bn=this.locationMotionKeyframesLength(ln);cn=this.locationMotion.getProgressVelocity(an)*Mn/Bn}var kn=De.effect==="instant"?0:this.calculateMovingDuration(Ve.duration,De.effect==="fly"?sn:0),Ln={longitude:Ve.longitude,latitude:Ve.latitude,fov:Ve.fov},Pn=__assign(__assign({},Be),{mode:this.mode,longitude:(Je=Ln.longitude)!==null&&Je!==void 0?Je:this.camera.pose.longitude,latitude:(Xe=Ln.latitude)!==null&&Xe!==void 0?Xe:this.camera.pose.latitude,fov:(Ke=Ln.fov)!==null&&Ke!==void 0?Ke:this.camera.pose.fov,offset:De.position.clone(),distance:0}),Vn=this.currentPano;if(this.emit("pano.moveTo",createEvent("pano.moveTo",{options:Ve,prevPano:Vn,progress:0,state:Pn,userAction:this.userAction,error:null})),Ve.moveStartCallback&&Ve.moveStartCallback(Pn),this.videoTexture&&this.videoTexture.image instanceof HTMLVideoElement&&this.videoTexture.image.getAttribute("src")&&(this.videoTexture.image.pause(),this.videoTexture.image.removeAttribute("uuid"),this.videoTexture.image.removeAttribute("src"),this.videoTexture.image.oncanplay=noop$1,this.videoTexture.needsUpdate=!0),this.panoVideo.setMaterial(null),De.effect==="fly")this.cameraMotion.set(Ln,kn).catch(noop$1);else{var Yn=coordinatesToVector({longitude:this.cameraMotion.value.longitude,latitude:this.cameraMotion.value.latitude}),ni=coordinatesToVector({longitude:(Ye=Ln.longitude)!==null&&Ye!==void 0?Ye:this.cameraMotion.value.longitude,latitude:(or=Ln.latitude)!==null&&or!==void 0?or:this.cameraMotion.value.latitude}),Rn=new Object3D;Rn.lookAt(Yn);var In=new Matrix4().makeRotationFromQuaternion(Rn.quaternion);Rn.lookAt(ni);var Gn=new Matrix4().makeRotationFromQuaternion(Rn.quaternion),Fn=new Matrix4().getInverse(In).premultiply(Gn),Hn=this.cameraMotion.value.fov,Dn=(sr=Ln.fov)!==null&&sr!==void 0?sr:this.cameraMotion.value.fov,zn=1;De.effect==="zoomin"?zn=1.5:De.effect==="zoomout"&&(zn=.4);for(var Qn=Dn*zn,Zn=0;Zn<ln.length-1;Zn++){var si=ln[Zn].key;if(si){var ei=this.panoResources[si];ei&&(ei.fixCameraTransform.copy(Fn),ei.leftPanoPicture&&(ei.leftPanoPicture.zoom=Math.tan(Hn/2/180*Math.PI)/Math.tan(Qn/2/180*Math.PI)))}}this.cameraMotion.setKeyframes([{progress:0,value:{longitude:this.cameraMotion.value.longitude,latitude:this.cameraMotion.value.latitude,fov:this.cameraMotion.value.fov}},{progress:0,value:{longitude:(cr=Ln.longitude)!==null&&cr!==void 0?cr:this.cameraMotion.value.longitude,latitude:(Br=Ln.latitude)!==null&&Br!==void 0?Br:this.cameraMotion.value.latitude,fov:Qn}},{progress:1,value:{longitude:(tn=Ln.longitude)!==null&&tn!==void 0?tn:this.cameraMotion.value.longitude,latitude:(en=Ln.latitude)!==null&&en!==void 0?en:this.cameraMotion.value.latitude,fov:Dn}}],kn).catch(noop$1)}var hi=this.locationMotion.setKeyframes(ln,kn,cn);hi.then(function(){for(var Un,Wn,Ai,oi=0,ci=Fe.models;oi<ci.length;oi++){var ai=ci[oi];ai.show()}var wi=__assign(__assign({},Be),{mode:Fe.mode,longitude:Fe.camera.pose.longitude,latitude:Fe.camera.pose.latitude,fov:Fe.camera.pose.fov,offset:Fe.camera.pose.offset.clone(),distance:0});Fe.emit("pano.arrived",createEvent("pano.arrived",{options:Ve,prevPano:Vn,progress:1,state:wi,userAction:Fe.userAction,error:null})),Ve.moveEndCallback&&Ve.moveEndCallback(wi);var Pi=Fe.works.getResolvedObserver(Fe.currentPano);if(Pi&&Pi.video&&Fe.videoTexture&&Fe.videoTexture.image instanceof HTMLVideoElement){var Oi=ROTATE_Y_PI_MATRIX.clone().multiply((Ai=(Wn=(Un=Fe.models.getMaterial())===null||Un===void 0?void 0:Un.pano1)===null||Wn===void 0?void 0:Wn.matrix)!==null&&Ai!==void 0?Ai:new Matrix4).multiply(Pi.video.matrix),Ri={map:Fe.videoTexture,size:Pi.video.size,matrix:Oi,alpha:1},_i=createUuid(),Mi=Fe.videoTexture.image;Mi.setAttribute("uuid",_i),canplayVideo().then(function($i){$i&&Pi.video&&Mi.getAttribute("uuid")===_i&&(Mi.oncanplay=function(){Mi.oncanplay=noop$1,Mi.play()},Mi.ontimeupdate=function(){Mi.currentTime>.5&&(Mi.ontimeupdate=noop$1,Fe.panoVideo.setMaterial(Ri))},Mi.src=Pi.video.source)}).catch(function(){Mi.removeAttribute("uuid")})}},function(){Fe.emit("pano.cancel",createEvent("pano.cancel",{options:Ve,prevPano:Vn,progress:0,state:Pn,userAction:Fe.userAction,error:null})),Ve.moveCancelCallback&&Ve.moveCancelCallback()})},Se.prototype.checkSelectedPano=function(Be){var De=this,Ve,Fe,Je,Xe;this.stopMomentumMovement();var Ke=this.camera.getDirection(new Vector3).setY(0),Ye=null,or=this.works.getResolvedObserver(this.currentPano);if(!or)return null;var sr=or.accessibleIds.filter(function(ni){var Rn=panoParse(ni);if(panoEqual(Rn,De.currentPano))return!1;var In=De.works.getResolvedObserver(Rn);return!In||In.position.distanceTo(De.camera.position)>De.maxAccessibleDistance?!1:In.loadable||In.active}),cr=this.models.intersectRaycaster(Be)[0];if(cr){var Br=arrayMin(sr,function(ni){var Rn=De.works.getResolvedObserver(ni);if(!Rn)return 1/0;var In=Rn.standingPosition.clone();return In.distanceTo(cr.point)},!0),tn=Br[0],en=Br[1];tn&&en<this.panoTapTriggerRadius&&(Ye=(Ve=this.works.getResolvedObserver(tn))!==null&&Ve!==void 0?Ve:null)}if(isNil(Ye)){var an=this.getForwardObserverOrNot(Be);an&&(Ye=an)}for(var rn=0,on=this.locationMotion.keyframes;rn<on.length;rn++){var sn=on[rn],ln=this.panoResourceFromLocationMotionKeyframe(sn);if(!(sn.progress<this.locationMotion.progress)&&Ye&&ln.panoId===Ye.panoId){Ye=null;break}}if(isNil(Ye))return this.locationMotion.ended===!0&&this.cameraBounce(),null;if(Ye&&!Ye.active){var cn=Ye.panoId;this.panoMeshes[cn]&&(this.panoMeshes[cn].setDisabled(!1),this.panoMeshes[cn].setLoading(!0))}var hn={};if(Ye){for(var mn=Math.PI/6,An=Math.PI/12,xn=new Vector3(0,1,0),pn=Ye.position.clone().setY(0).sub(or.position.clone().setY(0)).normalize(),dn=pn.clone().applyAxisAngle(xn,mn),fn=pn.clone().applyAxisAngle(xn,-mn),yn=[],Sn=[],gn=[],Cn=0,Mn=Ye.accessibleIds;Cn<Mn.length;Cn++){var tn=Mn[Cn],Bn=panoParse(tn);if(!(panoEqual(Bn,this.currentPano)||panoEqual(Bn,Ye.pano))){var kn=this.works.getResolvedObserver(tn);if(kn){var Ln=kn.position.clone().sub(Ye.position).setY(0);pn.angleTo(Ln)<mn?gn.push(Ln):dn.angleTo(Ln)<mn?yn.push(Ln):fn.angleTo(Ln)<mn&&Sn.push(Ln)}}}var Pn=gn.length>0?gn:__spreadArray(__spreadArray([],yn,!0),Sn,!0),Vn=Pn.slice().sort(function(ni,Rn){return ni.angleTo(pn)-Rn.angleTo(pn)})[0];Vn&&Vn.angleTo(Ke)>An&&(hn.longitude=Math.atan2(-Vn.x,-Vn.z))}this.cameraMotion.value.latitude<-Math.PI/4&&(hn.latitude=clamp$1(0,this.minLatitude,this.maxLatitude)),this.cameraMotion.value.fov<60&&(hn.fov=this.defaultFov);var Yn={workCode:Ye.pano.workCode,panoIndex:Ye.pano.panoIndex,mode:this.mode,longitude:(Fe=hn.longitude)!==null&&Fe!==void 0?Fe:this.camera.pose.longitude,latitude:(Je=hn.latitude)!==null&&Je!==void 0?Je:this.camera.pose.latitude,fov:(Xe=hn.fov)!==null&&Xe!==void 0?Xe:this.camera.pose.fov,distance:0,offset:Ye?Ye.position.clone():new Vector3};return this.emit("pano.select",createEvent("pano.select",{prevPano:this.currentPano,state:Yn,userAction:!0,options:hn,progress:0,error:null})),Ye&&Ye.active?(this.emit("pano.request",createEvent("pano.request",{userAction:!0,prevPano:this.currentPano,progress:0,state:Yn,options:hn,error:null})),Ye.pano):null},Se.prototype.destroy=function(){$e.prototype.destroy.call(this)},Se.prototype.isReady=function(){return!1},Se.prototype.updateCamera=function(Be,De,Ve){return Promise.resolve()},Se.prototype.updateCameraWithKeyframes=function(Be,De,Ve){return Promise.resolve()},Se.prototype.updateTime=function(Be,De){for(var Ve=this,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br=[],tn=2;tn<arguments.length;tn++)Br[tn-2]=arguments[tn];this.userAction=!0;var en={},an={},rn=this.panoResourceFromLocationMotionKeyframe(this.locationMotion.keyframes[0]),on=this.panoResourceFromLocationMotionKeyframe(this.locationMotion.keyframes[this.locationMotion.keyframes.length-1]),sn=!1;if(this.cameraMotion.ended===!1&&(this.cameraMotion.update(Be),an.longitude=this.cameraMotion.value.longitude,an.latitude=this.cameraMotion.value.latitude,an.fov=this.cameraMotion.value.fov),this.modelAlphaMotion.ended===!1&&(this.modelAlphaMotion.update(Be),en.modelAlpha=this.modelAlphaMotion.value.modelAlpha),this.perspToOrthoMotion.ended===!1&&(this.perspToOrthoMotion.update(Be),this.camera.perspToOrtho.setScalar(clamp$1(this.perspToOrthoMotion.value.perspToOrtho,0,1))),this.locationMotion.ended===!1){this.locationMotion.update(Be);var ln=this.locationMotion.getKeyFrameSegment(Be),cn=ln[0],hn=ln[1],mn=this.panoResourceFromLocationMotionKeyframe(cn),An=this.panoResourceFromLocationMotionKeyframe(hn),xn=new Vector3().copy(mn.position),pn=new Vector3().copy(An.position),dn=this.locationMotion.value.count-hn.value.count+1;en.progress=dn,An.leftPanoPicture&&(dn<1?mn.leftPanoPicture&&(en.pano0=mn.leftPanoPicture):en.pano0=An.leftPanoPicture,en.pano1=An.leftPanoPicture),An.effect==="montage"?en.transition="BLACK":An.effect==="spread"?en.transition="SPREAD":en.transition="FADE",(An.effect==="zoomin"||An.effect==="zoomout")&&(en.progress=Math.pow(dn,3)),dn<1&&An.effect!=="fly"&&(en.pano0&&mn.leftPanoPicture&&(en.pano0={map:en.pano0.map,zoom:en.pano0.zoom,luminanceMap:en.pano0.luminanceMap,matrix:mn.leftPanoPicture.matrix.clone().setPosition(An.position)}),xn.copy(pn),sn=!0),an.distance=this.locationMotion.value.distance,an.offset=new Vector3(xn.x+(pn.x-xn.x)*dn,xn.y+(pn.y-xn.y)*dn,xn.z+(pn.z-xn.z)*dn);for(var fn=[],yn=[],Sn=0,gn=this.locationMotion.keyframes;Sn<gn.length;Sn++){var Cn=gn[Sn],Mn=Cn.key,Bn=Cn.progress;Mn!==void 0&&(fn.push(Mn),Bn>this.locationMotion.progress&&yn.push(Mn))}for(var kn=0,Ln=Object.keys(this.panoResources);kn<Ln.length;kn++){var Pn=Ln[kn];if(!(yn.indexOf(Pn)>=0)){var Vn=this.panoResources[Pn];if(Vn.leftPanoPicture){var Yn=Vn.leftPanoPicture.map;if(Yn){if(Yn===((Fe=en.pano0)===null||Fe===void 0?void 0:Fe.map)||Yn===((Je=en.pano1)===null||Je===void 0?void 0:Je.map))continue;Yn instanceof TileCubeTextureTarget&&Yn.cubeRenderTarget&&this.colorCubeRenderTargetPool.push(Yn.cubeRenderTarget),Yn.dispose(),Vn.leftPanoPicture=null}}fn.indexOf(Pn)>=0||delete this.panoResources[Pn]}}this.currentPano=panoParse(An.panoId),this.emit("pano.moving",createEvent("pano.moving",{userAction:this.userAction,prevPano:panoParse(rn.panoId),state:__assign(__assign(__assign(__assign({},panoParse(on.panoId)),{mode:this.mode}),clonePose(this.camera.pose)),an),options:{},progress:this.locationMotion.progress,error:null}))}isEmptyObject(en)===!1&&(!((Xe=en.pano0)===null||Xe===void 0)&&Xe.map&&en.pano0.map instanceof TileCubeTextureTarget&&!en.pano0.map.cubeRenderTarget&&(en.pano0.map.cubeRenderTarget=this.colorCubeRenderTargetPool.pop()),!((Ke=en.pano1)===null||Ke===void 0)&&Ke.map&&en.pano1.map instanceof TileCubeTextureTarget&&!en.pano1.map.cubeRenderTarget&&(en.pano1.map.cubeRenderTarget=this.colorCubeRenderTargetPool.pop()),this.models.setMaterial(en)),isEmptyObject(an)===!1&&this.setCamera(an);var ni=this.works.getResolvedObserver(this.currentPano),Rn=Br[1];if(!Rn){console.error("xrFrame丢失，请重试");return}if(!this.xrManager.session){console.error("session丢失，请重试");return}var In=this.xrManager.referenceSpace;if(In){var Gn=this.xrManager.cameraVR,Fn=this.xrManager.cameraL,Hn=this.xrManager.cameraR,Dn=[Fn,Hn],zn=Rn.getViewerPose(In),Qn=new Vector3(0,0,0);if(zn){var Zn;Zn=this.xrManager.session.renderState.baseLayer;var si=zn.views;if(!Zn){console.error("no layer found");return}this.renderer.setFramebuffer(Zn.framebuffer);var ei=!1;si.length!==Gn.cameras.length&&(Gn.cameras.length=0,ei=!0),this.parallaxCameraMatrixs=[];var hi=new Vector3,Un=new Vector3;new Matrix4().fromArray(si[0].transform.matrix).decompose(hi,new Quaternion,new Vector3),new Matrix4().fromArray(si[1].transform.matrix).decompose(Un,new Quaternion,new Vector3),Un.clone().sub(hi).normalize();var Wn=new Vector3,Ai=new Quaternion,oi=new Vector3;this.camera.matrix.decompose(Wn,Ai,oi);for(var ci=0;ci<si.length;ci++){var ai=si[ci],wi=Zn.getViewport(ai),Pi=Dn[ci];Pi.matrix.fromArray(ai.transform.matrix);var Oi=new Vector3,Ri=new Quaternion,_i=new Vector3;Pi.matrix.decompose(Oi,Ri,_i),Qn.copy(Wn),Pi.position.copy(Wn),Pi.quaternion.copy(Ri),Pi.scale.copy(_i),Pi.updateMatrix(),Pi.projectionMatrix.fromArray(ai.projectionMatrix),Pi.viewport.set(wi.x,wi.y,wi.width,wi.height),ei===!0&&Gn.cameras.push(Pi)}if(this.xrManager.session&&this.xrManager.session.inputSources){for(var ci=0;ci<this.xrManager.session.inputSources.length;ci++)if(this.xrManager.session.inputSources[ci]&&this.xrManager.session.inputSources[ci].targetRayMode==="transient-pointer"){var Mi=Rn.getPose(this.xrManager.session.inputSources[ci].targetRaySpace,In);if(Mi){var $i=new Vector3(0,0,-1).applyQuaternion(Mi.transform.orientation),vi=new Raycaster(this.camera.position,$i);this.gazeRay=vi}}}if(this.xrManager.machineType==="Oculus"||this.xrManager.machineType==="Pico"){for(var ri=this.xrManager.session.inputSources,ci=0;ci<ri.length;ci++){var Ti=this.xrManager.controllers[ci],Bi=ri[ci];if(Bi){Ti&&Ti.update(Bi,Rn,In);var vi=this.xrManager.getController(ci),qi=new Vector3(0,1.2,0),Ii=vi.position.clone().add(Qn).sub(qi);Bi.handedness==="left"?this.xrControllerRay.left.set(Ii,new Vector3(0,0,-1).applyEuler(vi.rotation)):Bi.handedness==="right"&&this.xrControllerRay.right.set(Ii,new Vector3(0,0,-1).applyEuler(vi.rotation)),this.controllerWrappers[ci].position.copy(new Vector3(0,0,0).add(Qn).sub(qi));var Ui=this.models.intersectRaycaster(this.xrControllerRay.right);if(Ui.length===0&&(Ui=this.xrControllerRay.right.intersectObject(this.boundingMesh,!0).map(function(Ho){var Io;return __assign({floor:(Io=ni?.floorIndex)!==null&&Io!==void 0?Io:0},Ho)})),Ui.length>=1&&Ui[0].face)if(Bi.handedness==="right"){var ho=this.xrControllerRay.right.intersectObject(this.xrCustomObjectsScene,!0),lo=Ui[0].face.normal,po=lo.clone(),co=Ui[0].point.clone();this.intersectMesh.position.copy(co);var go=co.clone().add(po);if(this.intersectMesh.lookAt(go),Math.abs(lo.y)>.99){var vo=this.camera.position.clone().sub(co);this.intersectMesh.rotation.z=-Math.atan2(vo.z,vo.x)}this.intersectMesh.visible=!0,this.needsRender=!0,ho.length>0?(this.pointerLines.right.setPoints(Ii,ho[0].point),this.pointerLines.right.points.visible=!0,this.intersectMesh.visible=!1):(this.pointerLines.right.points.visible=!1,this.pointerLines.right.setPoints(Ii,Ui[0].point));var Eo=Ui[0],Oo=createEvent("intersect.update",{raycaster:(Ye=this.xrControllerRay.right)!==null&&Ye!==void 0?Ye:null,intersection:Eo??null,object:this.intersectMesh});if(this.emit("intersect.update",Oo),Oo.defaultPrevented){this.hideIntersectMesh();return}}else this.pointerLines.left.setPoints(Ii,Ui[0].point)}}this.updateControllerHelper(ri,Be,De)}if(this.camera.pose.distance>.1||sn)for(var Bo=0,Po=Object.keys(this.panoMeshes);Bo<Po.length;Bo++){var Kn=Po[Bo],mi=this.panoMeshes[Kn];mi.setOpacity(0),mi.setCurrent(!1),mi.updateTime&&mi.updateTime(Be,De),mi.visible=!1}else if(ni){var gi=arrayMin(ni.visibleIds,function(To){var _o=Ve.works.getResolvedObserver(To);return _o?ni.standingPosition.distanceTo(_o.standingPosition):1/0},!0),xi=gi[1];xi=clamp$1(xi,2.5,1/0);for(var ki=ni.visibleIds.concat(panoStringify(this.currentPano)),Ki=this.getForwardObserverOrNot(),Yi=this.camera.getDirection(new Vector3),ji=0,Wi=Object.keys(this.panoMeshes);ji<Wi.length;ji++){var Kn=Wi[ji],mi=this.panoMeshes[Kn],Gi=this.works.getResolvedObserver(Kn);if(ki.indexOf(Kn)===-1)mi.setCurrent(!1),mi.setOpacity(0);else if(!Gi)mi.setCurrent(!1),mi.setOpacity(0);else if(!Gi.loadable&&!Gi.active)mi.setCurrent(!1),mi.setOpacity(0);else{var Mo=mi.position.clone().setY(this.camera.position.y).distanceTo(this.camera.position);mi.setCurrent(!mi.loading&&mi.progress===0&&Ki!==null&&Ki.panoId===Kn),mi.setOpacity(Mo<.01?0:clamp$1(xi/Mo*1.2,.65,.98));var bo=this.camera.position.clone().setY(mi.position.y),$i=new Vector3().copy(mi.position).sub(bo).normalize();if(Kn===panoStringify(this.currentPano)){var fo=clamp$1((.5-bo.distanceTo(mi.position))/.5,0,1);$i.multiplyScalar(1-fo).add(Yi.clone().multiplyScalar(fo))}$i.length()>0&&mi.quaternion.setFromEuler(new Euler(0,Math.atan2($i.x,$i.z),0))}mi.updateTime&&mi.updateTime(Be,De)}}var Hi=function(){return 4}(),eo=function(){var To=new PerspectiveCamera;To.applyMatrix4(Gn.matrix),To.position.set(0,0,0);var _o=Ve.works.getResolvedObserver(on.panoId),Ho=_o??ni;Ho&&To.quaternion.premultiply(Ho.quaternion.clone().inverse()),To.updateProjectionMatrix(),To.updateMatrixWorld(!0);var Io=new Frustum().setFromProjectionMatrix(new Matrix4().multiplyMatrices(To.projectionMatrix,To.matrixWorldInverse));return Io}();on.panoId===panoStringify(this.currentPano)&&((or=on.leftPanoPicture)===null||or===void 0?void 0:or.map)instanceof TileCubeTextureTarget&&(on.leftPanoPicture.map.maxRequest=this.tileMaxRequest,on.leftPanoPicture.map.update(eo,Hi),on.leftPanoPicture.map.needsRender===!0&&(this.needsRender=!0,this.modelSceneNeedsRender=!0));{var mo=this.tiling.object.visible;if(this.initAnimationed){var xo=on.panoId,ro=this.works.getResolvedObserver(xo);ro?isSimilarVector3(this.camera.position,ro.position)&&this.locationMotion.ended?(this.tiling.object.visible=!0,this.tiling.panoId!==xo&&this.tiling.cleanup(),this.tiling.panoId=xo,this.tiling.setResource((cr=(sr=ro.images)===null||sr===void 0?void 0:sr.tiles)!==null&&cr!==void 0?cr:[],this.enableIOSEDR&&ro.images.luminance?ro.images.luminance:null),this.tiling.setFetcher(getFetcher(ro.work)),this.tiling.setRotation(ro.quaternion),this.tiling.setPosition(ro.position),this.tiling.maxRequest=this.tileMaxRequest,Hi>this.tiledCubeTextureLevel?this.tiling.update(eo,Hi,Be):this.tiling.update(eo,0,Be)):this.tiling.object.visible=!1:this.tiling.object.visible=!1}else this.tiling.object.visible=!1;mo!==this.tiling.object.visible&&(this.tiling.object.needsRender=!0,this.modelSceneNeedsRender=!0)}this.panoVideo.object.position.copy(this.camera.position),this.panoVideo.updateTime(Be)}}},Se.prototype.render=function(){var Be=this.xrManager.getCamera(this.camera);this.renderer.render(this.modelScene,Be),this.renderer.autoClearColor=!1,this.renderer.autoClearDepth=!1,this.renderer.render(this.scene,Be),this.renderer.autoClearColor=!0,this.renderer.autoClearDepth=!0},Se.prototype.onPanGesture=function(){},Se.prototype.onTapGesture=function(){},Se.prototype.onPinchGesture=function(){},Se.prototype.onMouseMove=function(){},Se.prototype.onMouseOut=function(){},Se.prototype.panoResourceFromLocationMotionKeyframe=function(Be){return this.panoResources[Be.key]},Se.prototype.updateControllerHelper=function(Be,De,Ve){var Fe=this.xrControllerRay.left,Je=this.xrControllerRay.right;if(!(!Be||Be.length===0)){for(var Xe={buttons:{X:!1,Y:!1,LeftTrigger:!1,LeftPinch:!1,A:!1,B:!1,RightTrigger:!1,RightPinch:!1}},Ke=0;Ke<Be.length;Ke++){var Ye=Be[Ke].handedness,or=Be[Ke].gamepad;switch(Ye){case"left":or.axes&&(this.emitHandleEvent(or.axes[2]===-1,"LeftAxesLeft",De),this.emitHandleEvent(or.axes[2]===1,"LeftAxesRight",De),this.emitHandleEvent(or.axes[3]===-1,"LeftAxesUp",De),this.emitHandleEvent(or.axes[3]===1,"LeftAxesDown",De)),or!=null&&or.buttons&&(or.buttons[4]&&this.emitHandleEvent(or.buttons[4].pressed,"X",De),or.buttons[5]&&this.emitHandleEvent(or.buttons[5].pressed,"Y",De),or.buttons[0]&&this.emitHandleEvent(or.buttons[0].pressed,"LeftTrigger",De),or.buttons[1]&&this.emitHandleEvent(or.buttons[1].pressed,"LeftPinch",De));var sr={raycaster:Fe,axes:{up:or.axes&&or.axes[3]<0?Math.abs(or.axes[3]):0,down:or.axes&&or.axes[3]<0?0:Math.abs(or.axes[3]),left:or.axes&&or.axes[2]<0?Math.abs(or.axes[2]):0,right:or.axes&&or.axes[2]<0?0:Math.abs(or.axes[2])},deltaTime:Ve};Xe.buttons.X=or.buttons&&or.buttons[4]?or.buttons[4].pressed:!1,Xe.buttons.Y=or.buttons&&or.buttons[5]?or?.buttons[5].pressed:!1,Xe.buttons.LeftTrigger=or.buttons&&or.buttons[0]?or?.buttons[0].pressed:!1,Xe.buttons.LeftPinch=or.buttons&&or.buttons[1]?or?.buttons[1].pressed:!1,Xe.left=sr;break;case"right":or.axes&&(this.emitHandleEvent(or.axes[2]===-1,"RightAxesLeft",De),this.emitHandleEvent(or.axes[2]===1,"RightAxesRight",De),this.emitHandleEvent(or.axes[3]===-1,"RightAxesUp",De),this.emitHandleEvent(or.axes[3]===1,"RightAxesDown",De)),or.buttons&&(or.buttons[4]&&this.emitHandleEvent(or.buttons[4].pressed,"A",De),or.buttons[5]&&this.emitHandleEvent(or.buttons[5].pressed,"B",De),or.buttons[0]&&this.emitHandleEvent(or.buttons[0].pressed,"RightTrigger",De),or.buttons[1]&&this.emitHandleEvent(or.buttons[1].pressed,"RightPinch",De));var cr={raycaster:Je,axes:{up:or.axes&&or.axes[3]<0?Math.abs(or.axes[3]):0,down:or.axes&&or.axes[3]<0?0:Math.abs(or.axes[3]),left:or.axes&&or.axes[2]<0?Math.abs(or.axes[2]):0,right:or.axes&&or.axes[2]<0?0:Math.abs(or.axes[2])},deltaTime:Ve};Xe.right=cr,Xe.buttons.A=or.buttons&&or.buttons[4]?or?.buttons[4].pressed:!1,Xe.buttons.B=or.buttons&&or.buttons[5]?or?.buttons[5].pressed:!1,Xe.buttons.RightTrigger=or.buttons&&or.buttons[0]?or?.buttons[0].pressed:!1,Xe.buttons.RightPinch=or.buttons&&or.buttons[1]?or?.buttons[1].pressed:!1;break}}this.emit("xr.controller.update",createEvent("xr.controller.update",Xe))}},Se.prototype.emitHandleEvent=function(Be,De,Ve){var Fe=this.xrControllerRay.left,Je=this.xrControllerRay.right;if(Be)if(this.xrHandleState[De].touchStart===!1)this.xrHandleState[De].touchStartTime=Ve,this.xrHandleState[De].touchStart=!0,this.emit("xr.gesture.buttonDown",createEvent("xr.gesture.buttonDown",{session:this.xrManager.session,machineType:this.xrManager.machineType,buttons:De,isFinal:!1,isFirst:!0,controllers:{raycaster:{leftRay:Fe,rightRay:Je}}}));else{var Xe=Ve-this.xrHandleState[De].touchStartTime;Xe>CONTROLLER_EVNET_DELTA_TIME&&this.emit("xr.gesture.press",createEvent("xr.gesture.tap",{session:this.xrManager.session,machineType:this.xrManager.machineType,buttons:De,isFinal:!0,isFirst:!0,controllers:{raycaster:{leftRay:Fe,rightRay:Je}}}))}else if(this.xrHandleState[De].touchStart===!0){this.emit("xr.gesture.buttonUp",createEvent("xr.gesture.buttonUp",{session:this.xrManager.session,machineType:this.xrManager.machineType,buttons:De,isFinal:!0,isFirst:!1,controllers:{raycaster:{leftRay:Fe,rightRay:Je}}}));var Xe=Ve-this.xrHandleState[De].touchStartTime;if(Xe<=CONTROLLER_EVNET_DELTA_TIME){var Ke=createEvent("xr.gesture.tap",{session:this.xrManager.session,machineType:this.xrManager.machineType,buttons:De,isFinal:!0,isFirst:!1,controllers:{raycaster:{leftRay:Fe,rightRay:Je}}}),Ye=this.emit("xr.gesture.tap",Ke);!Ye&&!Ke.defaultPrevented&&De==="RightTrigger"&&this.checkSelectedPano(this.xrControllerRay.right)}this.xrHandleState[De].touchStart=!1,this.xrHandleState[De].touchStartTime=0}},Se.prototype.initHandEvent=function(){var Be=this;if(!this.xrManager.session)throw new Error("初始化失败");this.xrManager.session.addEventListener("select",function(De){Be.gazeRay&&Be.checkSelectedPano(Be.gazeRay)})},Se}(PanoramaController),Controllers={Floorplan:FloorplanController,Topview:TopviewController,Panorama:PanoramaController,VRPanorama:VRPanoramaController,Model:ModelController,Mapview:MapviewController,XRPanorama:XRPanoramaController},PROXY_CONTROLLER_EVENT_NAMES=["gesture.pan","gesture.tap","gesture.dbltap","gesture.press","gesture.pinch","gesture.mousewheel","gesture.mousemove","gesture.momentum","initAnimation.start","initAnimation.end","camera.update","intersect.update","pano.select","pano.moveTo","pano.moving","pano.arrived","pano.cancel","pano.error","pano.texture.load","pano.texture.progress","pano.texture.success","pano.texture.error","pano.texture.abort","xr.session.start","xr.session.end","xr.gesture.tap","xr.gesture.press","xr.gesture.buttonUp","xr.gesture.buttonDown","xr.controller.update"];function initLegacyEvent($e){$e.on("initAnimation.start",function(Se){$e.emit("initAnimationWillStart",Se.state.panoIndex,Se.state,Se.userAction)}),$e.on("initAnimation.end",function(Se){$e.emit("initAnimationEnded",Se.state.panoIndex,Se.state,Se.userAction)}),$e.on("gesture.pan",function(Se){var Be=!1;Be=$e.emit("wantsGesture","pan",Se.pointers,Se.isFinal),Be&&Se.preventDefault(),Be=$e.emit("wantsPanGesture",Se.state,Se.isFinal),Be&&Se.preventDefault(),Se.defaultPrevented||($e.emit("gesture","pan",Se.pointers,Se.isFinal),$e.emit("panGesture",Se.state,Se.isFinal))}),$e.on("gesture.tap",function(Se){var Be=!1;Be=$e.emit("wantsGesture","tap",Se.pointers,Se.isFinal),Be&&Se.preventDefault(),Be=$e.emit("wantsTapGesture",Se.center.raycaster,Se.center.coords,Se.isFinal),Be&&Se.preventDefault(),Se.defaultPrevented||($e.emit("gesture","tap",Se.pointers,Se.isFinal),$e.emit("tapGesture",Se.center.raycaster,Se.center.coords,Se.isFinal))}),$e.on("gesture.dbltap",function(Se){var Be=!1;Be=$e.emit("wantsGesture","dbltap",Se.pointers,Se.isFinal),Be&&Se.preventDefault(),Be=$e.emit("wantsDblTapGesture",Se.center.raycaster,Se.center.coords,Se.isFinal),Be&&Se.preventDefault(),Se.defaultPrevented||($e.emit("gesture","dbltap",Se.pointers,Se.isFinal),$e.emit("dblTapGesture",Se.center.raycaster,Se.center.coords,Se.isFinal))}),$e.on("gesture.press",function(Se){var Be=!1;Be=$e.emit("wantsGesture","press",Se.pointers,Se.isFinal),Be&&Se.preventDefault(),Be=$e.emit("wantsPressGesture",Se.center.raycaster,Se.center.coords,Se.center.delta,Se.isFinal),Be&&Se.preventDefault(),Se.defaultPrevented||($e.emit("gesture","press",Se.pointers,Se.isFinal),$e.emit("pressGesture",Se.center.raycaster,Se.center.coords,Se.center.delta,Se.isFinal))}),$e.on("gesture.pinch",function(Se){var Be=!1;Be=$e.emit("wantsGesture","pinch",Se.pointers,Se.isFinal),Be&&Se.preventDefault(),Be=$e.emit("wantsPinchGesture",Se.scale,Se.state.fov,Se.isFinal),Be&&Se.preventDefault(),Se.defaultPrevented||($e.emit("gesture","pinch",Se.pointers,Se.isFinal),$e.emit("pinchGesture",Se.scale,Se.state.fov,Se.isFinal))}),$e.on("gesture.mousewheel",function(Se){var Be=!1;Be=$e.emit("wantsGesture","mouseWheel",Se.pointers,Se.isFinal),Be&&Se.preventDefault(),Be=$e.emit("wantsMouseWheel",Se.center.delta,Se.state.fov,Se.isFinal),Be&&Se.preventDefault(),Se.defaultPrevented||($e.emit("gesture","mouseWheel",Se.pointers,Se.isFinal),$e.emit("mouseWheel",Se.center.delta,Se.state.fov,Se.isFinal))}),$e.on("gesture.mousemove",function(Se){var Be=!1;Be=$e.emit("wantsGesture","mouseMove",Se.pointers,Se.isFinal),Be&&Se.preventDefault(),Se.defaultPrevented||($e.emit("gesture","mouseMove",Se.pointers,Se.isFinal),Be=$e.emit("wantsChangeCameraFov",Se.state.fov),Be&&Se.preventDefault())}),$e.on("gesture.momentum",function(Se){var Be=!1;Be=$e.emit("wantsInteriaPan",Se.state),Be&&Se.preventDefault(),Se.defaultPrevented||$e.emit("interiaPan",Se.state,Se.isFinal)}),$e.on("camera.update",function(Se){$e.emit("cameraFovUpdate",Se.state.fov,Se.userAction),$e.emit("cameraDirectionUpdate",Se.state,Se.userAction);var Be=coordinatesToVector(Se.state);Be.setLength(Se.state.distance);var De=Se.state.offset.clone().sub(Be);$e.emit("cameraPositionUpdate",De,Se.userAction),$e.emit("cameraUpdate",Se.state,Se.userAction)}),$e.on("intersect.update",function(Se){if(Se.intersection){var Be=!1;Be=$e.emit("wantsShowIntersectionOnModel",Se.raycaster),Be&&Se.preventDefault(),Se.defaultPrevented||$e.emit("intersectionOnModelUpdate",Se.intersection,Se.object)}else $e.emit("intersectionHidden")}),$e.on("pano.request",function(Se){var Be=$e.emit("wantsMoveToPano",Se.state.panoIndex,Se.options,Se.userAction);Be||(Be=$e.emit("wantsToMoveToPano",Se.state.panoIndex,Se.options,Se.userAction)),Be&&Se.preventDefault(),Se.defaultPrevented||$e.emit("panoWillLoad",Se.state.panoIndex)}),$e.on("pano.select",function(Se){$e.emit("panoSelected",Se.state.panoIndex)}),$e.on("pano.moveTo",function(Se){$e.emit("panoLoaded",Se.state.panoIndex),$e.emit("moveToPano",Se.state.panoIndex,Se.userAction),$e.emit("panoWillArrive",Se.state.panoIndex,Se.state,Se.userAction)}),$e.on("pano.moving",function(Se){$e.emit("movingToPano",Se.state.panoIndex,Se.prevPano.panoIndex,Se.progress)}),$e.on("pano.arrived",function(Se){$e.emit("panoArrived",Se.state.panoIndex,Se.state,Se.userAction)}),$e.on("pano.cancel",function(Se){$e.emit("moveToPanoCanceled",Se.state.panoIndex)}),$e.on("pano.error",function(Se){$e.emit("panoLoadError",Se.error,Se.state.panoIndex)}),$e.on("pano.texture.load",function(Se){$e.emit("textureStartLoad",Se.pano.panoIndex)}),$e.on("pano.texture.success",function(Se){$e.emit("textureLoaded",Se.pano.panoIndex,Se.meta)}),$e.on("pano.texture.error",function(Se){$e.emit("textureError",Se.error,Se.pano.panoIndex)}),$e.on("pano.texture.abort",function(Se){$e.emit("textureAbort",Se.pano.panoIndex)}),$e.on("pano.texture.progress",function(Se){$e.emit("textureLoading",Se.progress,Se.pano.panoIndex)}),$e.on("xr.session.start",function(Se){$e.emit("webXRSessionStart")}),$e.on("xr.session.end",function(Se){$e.emit("webXRSessionEnd")}),$e.on("xr.gesture.tap",function(Se){$e.emit("webXRControllerEvent","tap",Se.buttons,{raycaster:Se.controllers.raycaster})}),$e.on("xr.gesture.press",function(Se){$e.emit("webXRControllerEvent","press",Se.buttons,{raycaster:Se.controllers.raycaster})}),$e.on("xr.gesture.buttonUp",function(Se){$e.emit("webXRControllerEvent","buttonUp",Se.buttons,{raycaster:Se.controllers.raycaster})}),$e.on("xr.gesture.buttonDown",function(Se){$e.emit("webXRControllerEvent","buttonDown",Se.buttons,{raycaster:Se.controllers.raycaster})}),$e.on("xr.controller.update",function(Se){$e.emit("webXRControllerRayUpdate",{leftRay:Se.left?Se.left.raycaster:void 0,rightRay:Se.right?Se.right.raycaster:void 0}),Se.left&&$e.emit("webXRAxesUpdate","left",{raycaster:{leftRay:Se.left?Se.left.raycaster:void 0,rightRay:Se.right?Se.right.raycaster:void 0},axesState:{up:Se.left.axes.up,down:Se.left.axes.down,left:Se.left.axes.left,right:Se.left.axes.right},deltaTime:Se.left.deltaTime}),Se.right&&$e.emit("webXRAxesUpdate","right",{raycaster:{leftRay:Se.left?Se.left.raycaster:void 0,rightRay:Se.right?Se.right.raycaster:void 0},axesState:{up:Se.right.axes.up,down:Se.right.axes.down,left:Se.right.axes.left,right:Se.right.axes.right},deltaTime:Se.right.deltaTime})}),$e.on("works.request",function(Se){$e.emit("willLoad",Se.input,Se.works[0],Se.state)}),$e.on("works.load",function(Se){$e.emit("load",Se.input,Se.works[0],Se.state)}),$e.on("works.ready",function(Se){$e.emit("loaded",Se.input,Se.works[0])}),$e.on("state.change",function(Se){$e.emit("stateChange",Se.state,Se.userAction)}),$e.on("currentState.change",function(Se){$e.emit("currentStateChange",Se.state,Se.userAction)}),$e.on("state.set",function(Se){$e.emit("setState",Se.state)}),$e.on("state.synced",function(Se){$e.emit("stateSynced",Se.state)}),$e.on("model.request",function(Se){$e.emit("modelWillLoad",Se.work.model)}),$e.on("model.error",function(Se){$e.emit("modelLoadError",Se.error,Se.model)}),$e.on("model.load",function(Se){$e.emit("modelLoaded",Se.model)}),$e.on("model.changeShownFloor",function(Se){$e.emit("modelShownFloorChange",Se.model.shownFloor,Se.model.floorLength)}),$e.on("render",function(Se){$e.emit("renderFrame",Se.needsRender)}),$e.on("mode.change.request",function(Se){$e.emit("wantsChangeMode",Se.mode,Se.prevMode)}),$e.on("mode.change",function(Se){$e.emit("modeChange",Se.mode,Se.prevMode,Se.state.panoIndex,Se.state,Se.userAction)}),$e.on("helpers.visible",function(Se){$e.emit("helpersVisibleChange",Se.object.visible)}),$e.on("network.resource",function(Se){$e.emit("network",Se.source,Se.requestType,Se.requestState,Se.detail)})}function generateDefaultVideoElement(){if(typeof window<"u"){var $e=document.createElement("video");$e.loop=!0,$e.autoplay=!0,$e.playsInline=!0,$e.muted=!0,$e.crossOrigin="";var Se=function(){document.removeEventListener("touchstart",Se,!1),document.removeEventListener("mousedown",Se,!1),$e.muted=!1};return document.addEventListener("touchstart",Se,!1),document.addEventListener("mousedown",Se,!1),$e}else return{}}function initLights($e){var Se=new Group$1;Se.name="internalLights";{var Be=new DirectionalLight(16777215,.3);Be.position.copy(new Vector3(1,1,1)),Se.add(Be)}{var Be=new DirectionalLight(16777215,.1);Be.position.copy(new Vector3(-1,-1,-1)),Se.add(Be)}{var Be=new DirectionalLight(16777215,.1);Se.add(Be)}{var Be=new AmbientLight(16777215,.6);Se.add(Be)}$e.add(Se)}function parseKeyValue($e){for(var Se,Be,De={},Ve=$e.split(/(\;|\,)/),Fe=0,Je=Ve;Fe<Je.length;Fe++){var Xe=Je[Fe],Ke=Xe.split("="),Ye=(Se=Ke[0])===null||Se===void 0?void 0:Se.trim(),or=(Be=Ke[1])===null||Be===void 0?void 0:Be.trim();Ye&&or&&(De[Ye]=or)}return De}function getViewportScale(){var $e;if(typeof document<"u")for(var Se=document.getElementsByTagName("meta"),Be=0;Be<Se.length;Be++){var De=Se[Be];if(De.getAttribute("name")==="viewport"){var Ve=parseKeyValue(($e=De.getAttribute("content"))!==null&&$e!==void 0?$e:""),Fe=Number(Ve["initial-scale"]);if(!isNaN(Fe))return Fe}}return 1}const textureURL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAV8AAAA/CAQAAADtPwPkAAAR+0lEQVR4AezYg3LEQACH8d1cbdu23Q5qG9G47z/TN/h6tn2b/H+TUTLc7yjcOXV46OUAnUs6EbUp022ZBXc1NhoZYYd7fjDRvdcHAwrlK2QBVJ4sgoqONmY45RUT23sZ6H42F2hK5CtkMbjhZlDmUUcvq1zyieUVyjbE4I1GBfItwxG56YaUZTQwyh4P6NgJ4YYYvCuQb5kOyI03pORjiqe4Lwpq5pt1vJqfUwKWJVbSMYfppYconG+maNNQOWBZuwHTzicGel75NtFOkxr5apmV8cikcko0DrDQs863AeGl0cE0+1xy573m0/wf0cEKW6H7BWtggiMG8sy3oHRDpJMw4NWb6am/bv9znkqEzjd61t5oo5clTrjhwevO75EJRBKSRt745Z16ZEjcM73sccZplBPm8PyTcxZAkSRdHm/acJ0Z3JZhHB0BxqDHgWFZFmm0ZbCw87twI/zc3e/Cz93vPneXtU/WdQS3oTviXdY/q5PsJKfoGuQjZuO/0in1qsj85cuXrxqeAOJpGqdJOqrUutgVl2Qb0BWqp/RE8AWWVB7t2KrIzY2Wx2fWKl7yfswgxqj8lYummYa3hfwF9MuQRmbfQE4ocPDjtUWQ6Tq1M2w7gC2EcrMGtWS6xlpGKEDDcb1vUQ25zT4lrC2s0dU4gFPppKkbeIYr7NMpqjStuFg5rNU9epGyt8PXyfX4DE1bKLhR/1XPxwJhp5DAV67T9ZPwFdovhBMIGUYoRBN4wim6S3eoXVEHXdLgmwY0x6BQnO4xPJ0Ar5OVxhQF0L9UslRM4yaQQfQImnBegi8vhY2A1k6YLlrj61TwDdNQnIISwiPvpD7TwYQTssZXK47vg8y9Gp2nxRcATkozOEmdCeObSt3IIo+xf/00IDRKAaZ89PBTkHqpkA5LagKeNZKlIhqX8RcQ95GHtdYA62Y6rOg5LLsOSnoyvk4V38hFhytef+V9/3DER1P48W89o1GxE9o5vns2Mk+F7yiftafEN4nhmUv9DKEeyqI0U+l0CQg+B//sZ5+6lOuqKaTgm0LH41RHw/CsLZRk4huiYxrvP2SNr1OSS+Dr1ulBMR+K9SqHa58Oec49VgL3mXHvDr7QfuM7LMNrH1/IS30Moe64SLYBuFVJ+MbnJY7L+GrVQkFcl4ISx/fEll4ZWnz18DpcSzUCX602LqD9svDLzmdaLkP28P1+VsJjsx/4hmh6x/gmm/i6pbrGneCL9iCOg0dQUvF1UwEdVvG19r2uTXxXLz0J37eLjfZoF++tTtPnU/cWp5e8n3An0m/G+U7qjiy4PpHyV16HKx5flCxAV/H9A88nUnZ7l7KN78SBxPcQgzLAepxEScU3l7pZ6fL2+Dot8fXECfj+QRoGYAwlAfBSPrXQXQri0Pd85NJKcVw8XUdt1LZapk7YRhO1RdpmFJwW8ozekYvx2/fjM5Hr5MfQ95HvcY2a/9hoNK4yEntL+dEuGseTdNmxIPqd5v2YRjeaX8pQ8IW2ohuP7+dTN87RMK4aitx8XPsH0r2oBqNRqrv7+gmjjY7uIr6TBxBfL2MlxNRKSVp8S5CTuGgHXxfkFvh69Pq3LD4pkkd2bdRvHaSNC3/l2sQXAccdlIS+lc57qhPJwxPybT7XSxnUrdqnXuHlJHS+mjZfJfUZR9s2FuQR+EQKdSi9Am8UTnsEvlYS+L6TFwW6kl74Vjr6AFHsX89rgg8njRltK0XPOL7NyDL0IurV4VtMwafB1709vu9X4OjWHoP3z1Ii7eaQdG00Lx5n8HXyDSva/dU0Pq2vZnKYxHYMYRo1WY5ov1G7Vh4r3y+kMdgbilxeOrV0aqOFenFl8GGJig7rG0bbPRqiSRpP2AL0w+yon9dHbi43zFetnKcuw9ZLeSa+7kTw/TDfuFu0Z7Vp/uhyHfPkAZ5ufP9wLIfD49E3clR818rR089Lzyy+VRREPneICnYLX9cT8PVKQs36TbQ3i6NcCwYkxEAQ3phN4CjAvC4mFr5vrlKe7AizBKj8cu33s7i9GbeY7BHYujTjjd3Bx54SSyT4m8mxOoYOAGX/DtwvnGE1M+5v5Bgt1hbkJRW9Cxv9X81GL2i5jqaoJ4avBcCsLYp+Ru+VC5sWPpFhXt8/EPvJL2F/alJDEeIjUhcrP5P45rDeATPj+wKl7gBf1fcq+HpVnfHO1vEf//UCHgt/OxfDE3onj5UkfTaThrg3NCGoBUCtZjvgMnwQB0bG5XENeraJ5XEWvtiHkqSVRqN+uQ4lEx2o+69SeY1dC++Wcsj+LCW+H0ZE4KtDWHkGwCtrxstbFqr51e9wbz42E2fpjRQsqEn50PnM4eumO9IbujCi393Hd+3q72TI+p9DPyyfraF+c3rOx0KJyB2z7Fa1yCO8HoHzlDFhPiWD8XoB3aPppRrUQdRp1D8qE9exdgr+Zbpqf8BLfmZ/bMYbh87k58VCSswCjQoLPPw4Jnp4uFi/YQlfKB5eBd/gr6aqB973zbDAF+v5PN+NZEvm+84bSkhxUPE9C9wqbeJ7Hi+gA9Jr5ZM7x9el4mulyK0Bb2xiMTj3/iBtK77Tnii27H/MlCfsjcJY+2oTg2/U4TYWQERE0r+aCouBcx5zEZzEYrqui8JXsQW/X8FLHJ3IVbWXhQV3zAJCjFQst1F25y1arlXwhRR4Bb4rZ3VPy5d+bHEtHIPF27K16ItYuKXM5kHD10M9DKFeSpbqLlOYAlRiC99yCiDmbUf0206jPPO7b/iud71avBkHf+kQP0OrWHBFrhmt75ZyPzbLg5KmWK9oH4Oq1eFZOm0c6n48mdfer46HcLUZU3pGB8R9IDBbJ+N7v1q0J2xhudZ45tcL8PN16vq9WizwtRLwFQtKER+NDypj4QQOdJNY3NC7GEsaGtiSmDsA+CZhyx+hXFHjYrgGGXpZNvDNpn5gWWuiWkUtyEB0UcrO8Y2L9KI9K+cXLmxqruGd6pcKfycj/ij3URVgu6bPUaycN1qXTHD+KoOmjGORnH57q8rh+e9sTHk5r1+7zpEXk36bp7iiXRrBW61e5k/D0fn+EXF/OxYEypFW3ZH1HzPt4Pv5PN2Rd7VJLDZeboGnbpSPwPDcBw5f6AIysadFOR9Hr7vksoFvE91jdbdYvzpYqyIvdQPU87uKL45u3u213CA8qkYPT6H1YgwIfkz7RI5xJdomfjoV4PXjfjgaRkNGhHwG1mNt1oq0y/j+SaZ5pV0LnrlG89Dl1YkmEsc3nKKzMKskJD+fx6NhlFiohdTe5EsZIig5WPgWUYCC9Dx5TG/sA5x15LCBbzXDtx/+uh74VmMZjLDamh8JvhzQtSsoeVTNNXB/Euv96LRR/qjO+By5xTxxJ683/FB00Pj0fZz9F2GPa70Ld2hbbVptWmjWabbGCl/ZAiTsbJa5hQ9OK/eWFE4xva9nG3z1zwCtnFXjYr6c3ykxPn9QiYWEWPhA4uuiDnzBpt4EMcg0QOm28M0gP76hJuELbIdZi4PqaILpJI+RYz4ZV42y+q49wBcxIbyXTmtXgevRWPl3MmjSSJU5vB3J0TA2Uu8mtP+R5/Au4iiF6NrUUiuCieOiJpnJq8gSXzwFLFiLP8X6bV0bYvzt8TXj75eLtKPRauY1RM1HR7GwEHpFbonIWAPwjxpfqJSCyBVUsk/DFOChhC18kyiPHFvwdVGh6XFbmfLx+RRi4jaqYiCnUDO1wc4u4ovo7pfS+XFD32e9GzndwxJiHcbQ/Vz6JrBMDGYyYK5l7YOsfkS2MVePfGkLsNXLGl9hIVbWXAv9fQ5i/j6UFL1RaQffB9qlwn3tS4WxMhaxETCMz6T9ZTqCk5FznoOKL9SEXMMIUwAZW6dNfCEVX61azdxwmIbg4aHdwtcj5KVBeNiqrb2+g5M8hTskSB6exHZ5bMEIF/wCoOT128zvdXziMLbvuDu/Usmh0oG7doMmafKNSmt8hQWUnmzhjJf/RskXCzQL8aYNfLG/QPGLY5KjKtcuNPGsyGytmj0/kPi6qdXwwJCPvOTYI3zTaICCNEh9FGSWM54OX4+A1UI80RV98czWKceJf65ervsleJm164/7ganACHHn+IPz8Nby1ptcnRztRWbipArvp4/gRchodbIFvsBSWPBaW+CHtzWfauFfcmnKRuyr+Fiu1WbzGKtCPWWMHjIgU1/Mgn2B74GKfbkajHwtVIHy3uBbh0Ocj9oplCC+kIJvYuKvI9bbkUUQ2+JaG7AeknwvhLd0YUxx+SZIf4XkGeqHUCNt9N8sQdvYlwtl9H4hMzqI5dHosMIX2taCl2s6LRowaubPyld/IgcvHBJPnKGnHDLh0ArfqzlYtkv5D8++4RsAvPbwTaJzgDcIDzxIRXuEbx4NIsYupjt7gi/6idL3j1AIqPY+OPH5PGO67x/jUS9NvF6hTte7x2kaCvtSZJiMlxjxMSqEtqXr3GPMn/9y4cXUypS/ymPxbIAvmurtYl9o7dqmBV9KdbLOgsik4B3d6xW/lO7w/kfe+yfx7bFuGkwY3/C6sURDj8584rCxJH5QtnYFVrFQVL35HNoQgO0jvt228XVRC4WQPLtANyiEzb1gD/BNoy5kHa5QEnUmiq/uG2fubeXh+kwuNj8IRxAoOqiLIqfTaNw84SfLWsDmqo08k30prHVKbHuYDo7ez6U7EsLX0oJX1ltV2AOg2KfoMPPA/sTx/ZPMqF9YiN11AsHLFrHgaAT3GBvw7hO+U9TH4bX10rgVx7YgMr0p7Pow4tL8XcY3l1kJMfVQmsA3fa/wFQh3JK9eivtV+tCaD4cUjdZvIRI9BfDUDd6PkkbfKhVbOJf/jUpuQcXXlgVNv68ejr4gTflk5AZ71+jR4AvEdPg6PDNpaz6a2AQm2otoWKvVS+LVTyL4OnaE7wSNUjfdpnZb+KbQdcA7Jr5ek0od8MD9dNjiN43t4etk1v0ITfyw6gS+Q4l5XwGwbXli+u/sj6pWGu9XfyYXx75d18+lf6t0tnau/pXKv8+xzorIkltn0l4r2dYCXlO8XDRbu9xw/9g/Zko2FXSFtKPxOxn3q+caluteK5lJsboXwVP/S27cPVz28X3i3/Ll/v8eDVMPDmzwvDbwddMt+NoROhq3yXcC4D7KpmTyA+XnqEzSFQrawDeLrsNemHrEL2+24r7NlENZUMa2vyxkH2DIs628e669ubdsR4VXC7C9u79eIVJtOwgdgO/dOICHGK6jQHaIwdXN4Lwt0LWHr4d6kX8tV+ozqAs+uYCSmO2w+jd4zGNeUYL4nqZxeN5WKVgooSAClmEaYhqhdit89QC7niSbCEM2sdkBuHYxQg9ri5ZjkuhI6DMP+J7cTvEtokEx0aPscyddoFJKpSZqV7G1GTxcpmEthpnw5058c6GfwqpwzGOtGjXSJI3FLYhc+O+jSr9aGhPWQlRshS8AticLX7wnsgbXxt6gsWCpRBa0vRGQM8oB9dhmP3QAwFX4c079dJNq6Qi5xbuyTmpPSJ1Ur4UtF7GoTtmUL3zxaWqMU8P/k3cXSQ1EQRjHGdzdHTa4u7tzBs7CedhykNwF2/5jq56iU11db6Lv2yTj8hs3JoiU9sZZp5/62J5v1z9NjrDHaSbnbFMf52sHrDUVaidDxNG0o9+uLjfosfdb3jT5d5j757riJgst9NIZQ2Pn+ySZll80vjI6Wz/hQJG4vPG0L/H6poQch/dW3vL3B0u8jl0HvVj5PvHCElEF8DUAFikVYTcvmfBdDzQlvvMXSV5lP5zrXj/fJ54zuWaeeuoqkW8AwCIaqeTZKkmYrpPwR2eqN9X72W7EG57vU67OBeuMV8KXLUzv93UTTj42tvaFS++GVsc5JRyLSLJ8nzO555hFBmiSRCqMr4GwrcmGkib5xSvcwmzFK6e8s7DMa2xH4YZdZumSOwsVzFeBWdr37tpIhOpSwXqONNgZq/2KgvBt54znHN1HzlljTO4oVD5fb+prNIJXQNL1ofDKQisbPLJDv3jNSLq9OkYBEIihKIj3v7S1TRQCX5Kdl1ZQlol7LF+E++fwirfiq2sf4cTXxc6hzxffPuLEeqSWrPGWMF58TWr5viyJAP5/4EV4KePiaSE8eNRgjDy8/tyRW+FZjhS+2tlovNJovtJovNJ0uhK6Wo64SDdxEbM//KesjwAAAABJRU5ErkJggg==";var imageSize=[351,63],imageOffset=[20,20],vertices=new Float32Array([-.5,-.5,0,.5,-.5,0,-.5,.5,0,.5,.5,0]),uvs=new Float32Array([0,0,1,0,0,1,1,1]),index=new Uint8Array([0,1,2,1,3,2]),geometry=new BufferGeometry;geometry.setAttribute("position",new BufferAttribute(vertices,3));geometry.setAttribute("uv",new BufferAttribute(uvs,2));geometry.setIndex(new BufferAttribute(index,1));var material=new MeshBasicMaterial({transparent:!0,depthTest:!1,depthWrite:!1,stencilWrite:!1,fog:!1}),mesh=new Mesh(geometry,material);mesh.matrixAutoUpdate=!1;var scene=new Scene$1;scene.add(mesh);scene.matrixAutoUpdate=!1;var camera=new OrthographicCamera(-.5,.5,.5,-.5,.1,1);camera.position.set(0,0,.5);camera.lookAt(0,0,0);camera.updateMatrixWorld(!0);camera.matrixAutoUpdate=!1;var prevViewport=new Vector4,prevScissor=new Vector4;function renderPoweredByRealsee($e){if(material.map){var Se=$e.getViewport(prevViewport),Be=$e.getScissor(prevScissor),De=$e.getScissorTest(),Ve=$e.autoClear,Fe=Be.x+imageOffset[0]/3,Je=Be.y+imageOffset[1]/3,Xe=imageSize[0]/3,Ke=imageSize[1]/3;$e.setViewport(Fe,Je,Xe,Ke),$e.setScissor(Fe,Je,Xe,Ke),$e.setScissorTest(!0),$e.autoClear=!1,$e.render(scene,camera),$e.setViewport(Se),$e.setScissor(Be),$e.setScissorTest(De),$e.autoClear=Ve}else{var Ye=new Texture,or=new Image;or.onload=function(){Ye.image=or,Ye.wrapS=ClampToEdgeWrapping,Ye.wrapT=ClampToEdgeWrapping,Ye.minFilter=LinearFilter,Ye.needsUpdate=!0,Ye.generateMipmaps=!1,material.needsUpdate=!0,or.onload=noop$1},or.src=textureURL,material.map=Ye}}var DEFAULT_MODE_CHANGE_DURATION=800,DEFAULT_CAMERA_FOV=90,DEFAULT_REQUEST_PROXY=function($e){return $e.replace("//vrlab-public.ljcdn.com/","//vr-public.realsee-cdn.cn/").replace("//vrlab-image4.ljcdn.com/","//vr-image-4.realsee-cdn.cn/").replace("//vrlab-image3.ljcdn.com/","//vr-image-3.realsee-cdn.cn/").replace("//vrlab-image2.ljcdn.com/","//vr-image-2.realsee-cdn.cn/").replace("//vrlab-image1.ljcdn.com/","//vr-image-1.realsee-cdn.cn/")},sharedVector2=new Vector2,sharedSphere=new Sphere,sharedFrustum=new Frustum,sharedProjScreenMatrix=new Matrix4,clockForMixer=new WeakMap,worksMap=new WeakMap,emptyWorks=createWorks([]);new Scene;var Five=function($e){__extends(Se,$e);function Se(Be){Be===void 0&&(Be={});var De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en=$e.call(this)||this;if(en.ident=createUuid(),typeof window<"u"&&(__FIVE_DEBUG__.instances[en.ident]=en),en.renderSwitch01=0,en.currentMode="Panorama",en.pano={workCode:"",panoIndex:0},en.needsRender=!1,en.modelSceneNeedsRender=!1,en.onlyRenderIfNeeds=(De=Be.onlyRenderIfNeeds)!==null&&De!==void 0?De:!0,en.imageOptions=__assign({},(Ve=Be.imageOptions)!==null&&Ve!==void 0?Ve:{}),en.textureOptions=__assign({},(Fe=Be.textureOptions)!==null&&Fe!==void 0?Fe:{}),en.poweredByRealsee=(Je=Be.poweredByRealsee)!==null&&Je!==void 0?Je:!0,en.extraElements=[],en.controllerInits={Panorama:Object.assign({},Be.panorama),Model:Object.assign({},Be.model),Floorplan:Object.assign({},Be.floorplan),Topview:Object.assign({},Be.topview),Mapview:Object.assign({},Be.mapview),VRPanorama:Object.assign({},Be.vrPanorama),XRPanorama:Object.assign({},Be.xrPanorama)},en.fps={testCount:0,testTime:now$2()},en.info=null,en.modeChangeDuration=(Xe=Be.modeChangeDuration)!==null&&Xe!==void 0?Xe:DEFAULT_MODE_CHANGE_DURATION,en.enableWheel=(Ke=Be.enableWheel)!==null&&Ke!==void 0?Ke:!0,typeof window<"u")if("renderer"in Be)Be.renderer instanceof InternalWebGLRenderer&&en.throwError(new Error("cannot render a internal renderer")),en.renderer=Be.renderer;else try{en.renderer=new InternalWebGLRenderer({preserveDrawingBuffer:Be.preserveDrawingBuffer,backgroundColor:Be.backgroundColor,backgroundAlpha:Be.backgroundAlpha,antialias:Be.antialias,webgl2:Be.webgl2,logarithmicDepthBuffer:Be.logarithmicDepthBuffer,precision:Be.precision,powerPreference:Be.powerPreference});var an=getViewportScale();en.renderer.setPixelRatio(an===1?window.devicePixelRatio:1),en.renderer.setSize(512,512)}catch(dn){dn instanceof Error&&en.throwError(dn)}en.getPixelsRenderTarget=new WebGLRenderTarget(1,1,{encoding:(or=(Ye=en.renderer)===null||Ye===void 0?void 0:Ye.outputEncoding)!==null&&or!==void 0?or:sRGBEncoding,generateMipmaps:!1});var rn=new DepthTexture(1,1);rn.generateMipmaps=!1,rn.format=DepthStencilFormat,rn.type=UnsignedInt248Type,en.modelRenderTarget=new WebGLRenderTarget(1,1,{encoding:(cr=(sr=en.renderer)===null||sr===void 0?void 0:sr.outputEncoding)!==null&&cr!==void 0?cr:sRGBEncoding,depthTexture:rn,generateMipmaps:!1,depthBuffer:!0,stencilBuffer:!0}),en.scissor=Object.assign({left:0,bottom:0,width:1,height:1},Be.scissor),en.camera=new Camera(DEFAULT_CAMERA_FOV),en.scene=new Scene,en.xrCustomObjectsScene=new Scene$1,en.scene.add(en.xrCustomObjectsScene),en.scene.matrixAutoUpdate=!1,en.lastLoadWorkTask=Promise.resolve(),en.requestProxy=(Br=Be.requestProxy)!==null&&Br!==void 0?Br:DEFAULT_REQUEST_PROXY,en.networkSubscribe=new NetworkSubscribe,en.networkSubscribe.on("network",function(dn,fn,yn,Sn){var gn;en.emit("network.resource",createEvent("network.resource",{source:dn,requestType:fn,requestState:yn,detail:Sn})),(gn=en.analysis)===null||gn===void 0||gn.network(en.works,dn,fn,yn,Sn)}),en.boundingMesh=generateBoundingMesh(new Box3(new Vector3(-.5,-.5,-.5),new Vector3(.5,.5,.5))),en.boundingMesh.name="bounding",en.models=createModels(),en.models.push(new Model),en.lastModels=createModels(),en.lastWorks=createWorks([]),en.readyCallbacks=[],en.syncingState=!1,en.helperGroup=new Group$1,en.helperGroup.name="helper",en.helperGroup.matrixAutoUpdate=!1,en.scene.add(en.helperGroup),en.modelGroup=new Group$1,en.modelGroup.visible=!1,en.modelGroup.name="model",en.modelGroup.matrixAutoUpdate=!1,en.modelScene=new Scene$1,en.modelScene.add(en.modelGroup),en.modelScene.add(en.boundingMesh),en.modelScene.matrixAutoUpdate=!1,en.videoTexture=new VideoTexture(Be.videoInstance||generateDefaultVideoElement()),initLights(en.scene),initLights(en.modelScene),en.state={mode:en.currentMode,workCode:en.pano.workCode,panoIndex:en.pano.panoIndex,longitude:en.camera.pose.longitude,latitude:en.camera.pose.latitude,fov:en.camera.pose.fov,offset:en.camera.pose.offset.clone(),distance:en.camera.pose.distance},en.stateSynced=!1,en._enablePostProcessing=!1,en._enableIOSEDR=!1,en._enableEDL=!1,en._enableHQ=!1,en.destroyed=!1,en.paused=!0,typeof window<"u"&&(Be.play!==!1&&en.play(),en.stopAnimationLoop=AnimationFrameLoop.shared.add(function(dn,fn){for(var yn=[],Sn=2;Sn<arguments.length;Sn++)yn[Sn-2]=arguments[Sn];en.updateTime.apply(en,__spreadArray([dn,fn],yn,!1))},!1,0,10));var on=function(){typeof document<"u"&&document.fullscreenElement===null&&en.currentMode==="VRPanorama"&&en.controller.emit("vr.requestExit",createEvent("vr.requestExit",{}))},sn=function(){en.needsRender=!0,en.modelSceneNeedsRender=!0};if(typeof document<"u"&&document.addEventListener("fullscreenchange",on,!1),en.renderer&&en.renderer.domElement.addEventListener("webglcontextrestored",sn,!1),en.removeEventListeners=function(){typeof document<"u"&&document.removeEventListener("fullscreenchange",on,!1),en.renderer&&en.renderer.domElement.removeEventListener("webglcontextrestored",sn,!1)},en.plugins={},Be.plugins&&Be.plugins.length)for(var ln=0,cn=Be.plugins;ln<cn.length;ln++){var hn=cn[ln];if(typeof hn=="function")hn(en);else if(Array.isArray(hn)){var mn=hn[0],An=hn[1],xn=hn[2];if(typeof mn=="function"){var pn=mn(en,xn);typeof An=="string"&&(en.plugins[An]?en.throwError(new Error("plugin name ".concat(An," is exists."))):en.plugins[An]=pn)}}}return en.gpuPickingRenderTarget=new WebGLRenderTarget(1,1,{generateMipmaps:!1}),en.meshReplaceMaterialMap=new Map,en.meshOriginMaterialMap=new Map,initLegacyEvent(en),en.enableLayeringRendering=(tn=Be.enableLayeringRendering)!==null&&tn!==void 0?tn:!1,en}return Object.defineProperty(Se,"version",{get:function(){return"6.4.0-alpha.38"},enumerable:!1,configurable:!0}),Object.defineProperty(Se,"dracoPath",{get:function(){return draco.decoderPath},set:function(Be){draco.setDecoderPath(Be)},enumerable:!1,configurable:!0}),Object.defineProperty(Se,"ktx2Path",{get:function(){return ktx2.transcoderPath},set:function(Be){ktx2.setTranscoderPath(Be)},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"panoIndex",{get:function(){return this.pano.panoIndex},enumerable:!1,configurable:!0}),Se.prototype.getGPUPicking=function(Be,De,Ve,Fe,Je){var Xe=this;if(Fe===void 0&&(Fe=1),Je===void 0&&(Je=new Vector3(0,0,0)),!this.renderer)throw new Error("renderer is not initialized.");var Ke=this.models.getMaterial(),Ye=Ke.constantColor,or=Ke.colorStyle;this.models.setMaterial({colorStyle:"CONSTANT",constantColor:Je}),this.scene.traverse(function(tn){if(!(!(tn instanceof Mesh)||tn instanceof PBMMesh||tn instanceof PBMSkinnedMesh)){var en=Object.keys(Ve).filter(function(rn){return rn===tn.uuid})[0];if(en)if(Xe.meshOriginMaterialMap.set(en,tn.material),Xe.meshReplaceMaterialMap.get(en))tn.material=Xe.meshReplaceMaterialMap.get(en);else{var an=new ShaderMaterial({uniforms:{color:{value:Ve[en]}},vertexShader:`
          void main() {
            vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
            gl_Position = projectionMatrix * mvPosition;
          }
          `,fragmentShader:`
          uniform vec3 color;
          void main() {
            gl_FragColor = vec4( color, 1.0 );
          }
          `});an.depthTest=tn.material.depthTest,an.side=tn.material.side,Xe.meshReplaceMaterialMap.set(en,an),tn.material=an}}});var sr=this.renderer.getSize(new Vector2);this.camera.setViewOffset(sr.width,sr.height,Be*Fe,De*Fe,1,1),this.renderer.setRenderTarget(this.gpuPickingRenderTarget),this.render();var cr=new Uint8Array(4);this.renderer.readRenderTargetPixels(this.gpuPickingRenderTarget,0,0,1,1,cr),this.renderer.setRenderTarget(null),this.camera.clearViewOffset(),this.scene.traverse(function(tn){!(tn instanceof Mesh)||tn instanceof PBMMesh||tn instanceof PBMSkinnedMesh||Xe.meshOriginMaterialMap.get(tn.uuid)&&(tn.material=Xe.meshOriginMaterialMap.get(tn.uuid))}),this.models.setMaterial({colorStyle:or,constantColor:Ye});var Br=Object.keys(Ve).filter(function(tn){return Ve[tn].equals(new Color().setRGB(cr[0]/255,cr[1]/255,cr[2]/255))})[0];return Br||!1},Se.prototype.dispose=function(){var Be,De;if(this.destroyed!==!0){delete __FIVE_DEBUG__.instances[this.ident],this.emit("dispose"),this.destroyed=!0,this.pause(),this.stopAnimationLoop&&(this.stopAnimationLoop(),delete this.stopAnimationLoop),(Be=this.renderer)===null||Be===void 0||Be.setAnimationLoop(null),this.off(),this.networkSubscribe.off(),this.controller&&(this.controller.destroy(),this.controller=void 0);var Ve=this.getElement();Ve&&Ve.parentNode&&Ve.parentNode.removeChild(Ve);var Fe=this.models.getMaterial();Fe&&(Fe.pano0&&Fe.pano0.map.dispose(),Fe.pano1&&Fe.pano1.map!==((De=Fe.pano0)===null||De===void 0?void 0:De.map)&&Fe.pano1.map.dispose());for(var Je=0,Xe=this.models;Je<Xe.length;Je++){var Ke=Xe[Je];Ke.dispose()}this.models.length=0,this.models.setMaterial({pano0:null,pano1:null}),this.meshReplaceMaterialMap.forEach(function(Ye){Ye.dispose()}),this.meshOriginMaterialMap.forEach(function(Ye){Ye.dispose()}),this.renderer instanceof InternalWebGLRenderer&&this.renderer.forceContextLoss&&this.renderer.forceContextLoss()}},Se.prototype.setScissor=function(Be){var De;if(Object.assign(this.scissor,Be),this.controller&&this.controller.updateRenderSize){var Ve=new Vector2;(De=this.renderer)===null||De===void 0||De.getDrawingBufferSize(Ve),this.controller.updateRenderSize(Ve)}},Object.defineProperty(Se.prototype,"helperVisible",{get:function(){return this.helperGroup.visible},set:function(Be){this.helperGroup.visible!==Be&&(this.helperGroup.visible=Be,this.emit("helpers.visible",createEvent("helpers.visible",{object:this.helperGroup})),this.needsRender=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"enableIOSEDR",{get:function(){return this._enableIOSEDR},set:function(Be){this._enableIOSEDR!==Be&&(this._enableIOSEDR=Be,this.currentMode&&this.currentMode==="Panorama"&&this.changeMode(this.currentMode,this.getCurrentState(),0,!1,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"postProcessingType",{get:function(){return this.currentMode==="Panorama"&&this.enableIOSEDR&&this.enablePostProcessing?"luminance":this.currentMode==="Mapview"&&this.enableEDL?"edl":this.currentMode==="Mapview"&&this.enableHQ?"hq":null},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"enableEDL",{get:function(){return this._enableEDL},set:function(Be){if(Be===!0&&this.currentMode!==Se.Mode.Mapview)throw new Error("只支持Mapview下开启EDL");this._enableEDL!==Be&&(this._enableEDL=Be,this.boundingMesh.visible=!Be,this.needsRender=!0,this.modelSceneNeedsRender=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"enableHQ",{get:function(){return this._enableHQ},set:function(Be){if(Be===!0&&this.currentMode!==Se.Mode.Mapview)throw new Error("只支持Mapview下开启HQ");this._enableHQ!==Be&&(this._enableHQ=Be,this.boundingMesh.visible=!Be,this.needsRender=!0,this.modelSceneNeedsRender=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"enablePostProcessing",{get:function(){return this._enablePostProcessing},set:function(Be){this._enablePostProcessing!==Be&&(this._enablePostProcessing=Be),this.needsRender=!0,this.modelSceneNeedsRender=!0},enumerable:!1,configurable:!0}),Se.prototype.updateConfiguration=function(Be,De){De===void 0&&(De=!0);var Ve=!1;if(Be.panorama&&(Object.assign(this.controllerInits.Panorama,omitUndefinedFields(Be.panorama)),this.currentMode==="Panorama"&&(Ve=!0)),Be.model&&(Object.assign(this.controllerInits.Model,omitUndefinedFields(Be.model)),this.currentMode==="Model"&&(Ve=!0)),Be.floorplan&&(Object.assign(this.controllerInits.Floorplan,omitUndefinedFields(Be.floorplan)),this.currentMode==="Floorplan"&&(Ve=!0)),Be.topview&&(Object.assign(this.controllerInits.Topview,omitUndefinedFields(Be.topview)),this.currentMode==="Topview"&&(Ve=!0)),Be.mapview&&(Object.assign(this.controllerInits.Mapview,omitUndefinedFields(Be.mapview)),this.currentMode==="Mapview"&&(Ve=!0)),Be.vrPanorama&&(Object.assign(this.controllerInits.VRPanorama,omitUndefinedFields(Be.vrPanorama)),this.currentMode==="VRPanorama"&&(Ve=!0)),Be.imageOptions&&(Object.assign(this.imageOptions,Be.imageOptions),(this.currentMode==="Panorama"||this.currentMode==="VRPanorama")&&(Ve=!0)),Be.textureOptions&&Object.assign(this.textureOptions,Be.textureOptions),De&&Ve&&this.controller&&this.currentMode){var Fe=this.controller.updateConfiguration(this.controllerInits[this.currentMode]);Fe||this.changeMode(this.currentMode,this.getCurrentState(),0,!1,!0)}},Se.prototype.appendTo=function(Be,De){if(De===void 0&&(De={}),!!this.renderer){if(!(this.renderer instanceof InternalWebGLRenderer)){this.throwError(new Error("cannot call appendTo method when render a external renderer"));return}var Ve=this.getElement();if(Ve){Be.appendChild(Ve),this.refresh(De);var Fe=window.getComputedStyle(Be).position;Fe!=="relative"&&Fe!=="absolute"&&Fe!=="fixed"&&Fe!=="sticky"&&(Be.style.position="relative")}}},Se.prototype.refresh=function(Be,De){if(Be===void 0&&(Be={}),!!this.renderer){var Ve=this.getElement();if(Ve){var Fe=Ve.parentNode;if(Fe&&Fe.nodeName){var Je=Be.width,Xe=Je===void 0?Fe.offsetWidth:Je,Ke=Be.height,Ye=Ke===void 0?Fe.offsetHeight:Ke;this.renderer instanceof InternalWebGLRenderer&&(De&&this.renderer.setPixelRatio(De),this.renderer.setSize(Xe,Ye))}var or=new Vector2;if(this.renderer.getDrawingBufferSize(or),this.controller&&this.controller.updateRenderSize&&this.controller.updateRenderSize(or),this.modelRenderTarget.width!==or.x||this.modelRenderTarget.height!==or.y){this.modelRenderTarget.setSize(or.x,or.y),this.modelRenderTarget.depthTexture.dispose();var sr=new DepthTexture(or.x,or.y);sr.generateMipmaps=!1,sr.format=DepthStencilFormat,sr.type=UnsignedInt248Type,this.modelRenderTarget.depthTexture=sr,this.modelRenderTarget.depthTexture.needsUpdate=!0}this.needsRender=!0,this.modelSceneNeedsRender=!0,this.render(noop$1,!0)}}},Se.prototype.addExtraElement=function(Be){var De=this;return this.extraElements.indexOf(Be)===-1&&(this.extraElements.push(Be),this.controller&&this.controller.bindExtraElement(Be)),function(){return De.removeExtraElement(Be)}},Se.prototype.removeExtraElement=function(Be){var De=this.extraElements.indexOf(Be);De!==-1&&(this.extraElements.splice(De,1),this.controller&&this.controller.unbindExtraElement(Be))},Se.prototype.getPose=function(){var Be=this.camera.copyPose(),De=Be.longitude,Ve=Be.latitude,Fe=Be.fov,Je=Be.offset,Xe=Be.distance;return{longitude:De,latitude:Ve,fov:Fe,offset:Je.clone(),distance:Xe}},Se.prototype.getSize=function(Be){if(!this.renderer)throw new Error("renderer is not initialized");return this.renderer.getSize(Be),Be.x*=this.scissor.width,Be.y*=this.scissor.height,Be},Se.prototype.getDrawingBufferSize=function(Be){if(!this.renderer)throw new Error("renderer is not initialized");return this.renderer.getDrawingBufferSize(Be),Be.x*=this.scissor.width,Be.y*=this.scissor.height,Be},Se.prototype.updateCamera=function(Be,De,Ve){if(Ve===void 0&&(Ve=!0),!this.controller)throw new Error("controller is not initialized.");return this.controller.updateCamera(Be,De,Ve)},Se.prototype.updateCameraWithKeyframes=function(Be,De,Ve){if(Ve===void 0&&(Ve=!0),!this.controller)throw new Error("controller is not initialized.");return this.controller.updateCameraWithKeyframes(Be,De,Ve)},Se.prototype.getLongitudeAndLatitude=function(){var Be=this.getPose(),De=Be.longitude,Ve=Be.latitude;return{longitude:De,latitude:Ve}},Se.prototype.getOffset=function(){return this.getPose().offset},Se.prototype.getCameraLocal=function(){if(this.pano.workCode&&this.controller&&this.works){var Be=this.works.getResolvedObserver(this.pano);if(Be){var De=new Object3D;return De.position.copy(Be.position),De.quaternion.copy(Be.quaternion),De.scale.set(1,1,1),De.matrix.compose(De.position,De.quaternion,De.scale),De.matrixAutoUpdate=!1,cameraWorldToLocal(this.camera,De)}}return null},Object.defineProperty(Se.prototype,"works",{get:function(){var Be=worksMap.get(this);if(!Be)return emptyWorks;for(var De=0,Ve=Be;De<Ve.length;De++){var Fe=Ve[De];if(!workRawMapping.has(Fe))return emptyWorks}return Be},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"work",{get:function(){return this.works[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Se.prototype,"model",{get:function(){return this.models[0]},enumerable:!1,configurable:!0}),Se.prototype.load=function(Be,De,Ve,Fe){var Je=this;if(Fe===void 0&&(Fe=!0),!this.renderer)throw new Error("renderer is not initialized");var Xe=this.lastLoadWorkTask.then(function(){return isPromise(Be)?Be.then(function(Ke){return Je.load_(Ke,De,Ve,Fe)}):Je.load_(Be,De,Ve,Fe)});return this.lastLoadWorkTask=Xe.catch(function(Ke){Je.throwError(Ke)}),Xe},Se.prototype.load_=function(Be,De,Ve,Fe){var Je=this,Xe,Ke,Ye,or,sr,cr,Br,tn;Fe===void 0&&(Fe=!0);var en={};typeof Ve=="number"?en.duration=Ve:typeof Ve=="object"&&Object.assign(en,Ve),this.works===emptyWorks&&(en.duration===void 0&&(en.duration=0),en.effect===void 0&&(en.effect="instant"));var an=[];if(Array.isArray(Be))for(var rn=0,on=Be;rn<on.length;rn++){var sn=on[rn];typeof sn!="string"&&"work"in sn?an.push(parseWork(sn.work,sn)):an.push(parseWork(sn))}else an.push(parseWork(Be));for(var ln=createWorks(an),cn=function(ni){var Rn=hn,In=new Fetcher({allowHosts:ni.allowHosts,get requestProxy(){return Rn.requestProxy},get networkSubscribe(){return Rn.networkSubscribe}});registerFetcher(ni,In)},hn=this,mn=0,An=ln;mn<An.length;mn++){var xn=An[mn];cn(xn)}this.lastWorks=this.works,De===void 0&&(De="inherit"),De==="inherit"&&this.lastWorks.length===0&&(De="initial");var pn=ln.initial,dn=pn.work.observers[0],fn=dn?{workCode:dn.work.workCode,panoIndex:dn.panoIndex}:{workCode:pn.work.workCode,panoIndex:0},yn=(Xe=pn.mode)!==null&&Xe!==void 0?Xe:dn?"Panorama":"Mapview",Sn={};if(De==="inherit"){yn=this.currentMode;var gn=ln.resolvedObservers[this.panoIndex];gn?fn={workCode:gn.work.workCode,panoIndex:gn.panoIndex}:typeof ln.initial.panoIndex=="number"?fn={workCode:ln.initial.work.workCode,panoIndex:ln.initial.panoIndex}:(yn==="Panorama"||yn==="VRPanorama"||yn==="XRPanorama")&&(yn="Mapview"),Sn={longitude:this.camera.pose.longitude,latitude:this.camera.pose.latitude,fov:this.camera.pose.fov,distance:void 0,offset:void 0}}else if(De==="initial")typeof pn.panoIndex=="number"&&(fn={workCode:pn.work.workCode,panoIndex:pn.panoIndex}),pn.mode&&(yn=pn.mode),Sn={longitude:pn.longitude,latitude:pn.latitude,fov:pn.fov,distance:pn.distance,offset:(Ke=pn.offset)===null||Ke===void 0?void 0:Ke.clone()};else{if(yn=(Ye=De.mode)!==null&&Ye!==void 0?Ye:this.currentMode,typeof De.panoIndex=="number"){var gn=ln.getResolvedObserver({workCode:(sr=(or=De.workCode)!==null&&or!==void 0?or:pn.work.workCode)!==null&&sr!==void 0?sr:"",panoIndex:De.panoIndex});gn&&(fn={workCode:gn.work.workCode,panoIndex:gn.panoIndex})}Sn={longitude:De.longitude,latitude:De.latitude,fov:De.fov,distance:De.distance,offset:De.offset}}var Cn=__assign(__assign(__assign({},fn),{mode:yn}),Sn),Mn=this.getCurrentState(),Bn=(cr=en.duration)!==null&&cr!==void 0?cr:this.modeChangeDuration;(yn==="Floorplan"||yn==="Topview"||yn==="Mapview")&&this.currentMode===yn&&(Bn=0);var kn="fly";(yn==="Panorama"||yn==="VRPanorama"||yn==="XRPanorama")&&this.currentMode===yn&&(kn=(Br=en.effect)!==null&&Br!==void 0?Br:"fade"),this.emit("works.request",createEvent("works.request",{input:Be,works:ln,state:Cn,userAction:Fe}));var Ln=function(){Je.modelGroup.visible=!0,Je.pano=fn;var ni=__assign(__assign({initial:{state:Cn,currentState:Mn,duration:Bn,effect:kn,userAction:Fe}},Je.commonParams()),Je.controllerInits[yn]),Rn=Controllers[yn].initAnimationEndState(ni);if(Je.controller&&Je.currentMode===yn)Je.controller.updateWork(ln,Rn,{effect:kn,duration:Bn},Fe)===!1&&(Je.controller.destroy(),Je.controller=Je.applyController(yn,ni));else{var In=Je.currentMode;if(Je.controller)Je.controller.destroy();else{var Gn=Controllers[yn].initAnimationEndState(ni);Je.camera.setFromPose(Gn),Je.emit("camera.update",createEvent("camera.update",{state:Je.getCurrentState(),userAction:Fe}))}Je.controller=Je.applyController(yn,ni);var Fn=createEvent("mode.change",{prevMode:In,mode:yn,state:Rn,userAction:Fe});Je.emit("mode.change",Fn)}};worksMap.set(this,ln);var Pn=Promise.resolve();if(yn===Se.Mode.Floorplan||yn===Se.Mode.Topview||yn===Se.Mode.Mapview||yn===Se.Mode.Model)this.models.loaded===!1&&(this.camera.setFromPose(Cn),assignPose(this.state,this.camera.pose)),this.controller||(this.currentMode=yn),Pn=this.loadModel(ln,en).then(function(){Je.needsRender=!0,Je.modelSceneNeedsRender=!0,Ln(),Je.emit("camera.update",createEvent("camera.update",{state:Je.getCurrentState(),userAction:Fe}))});else{Ln();var Vn=!1,Yn=function(){Je.works===ln&&Vn===!1&&(Je.needsRender=!0,Je.modelSceneNeedsRender=!0,Je.emit("camera.update",createEvent("camera.update",{state:Je.getCurrentState(),userAction:Fe})),Je.loadModel(ln,en),Vn=!0)};this.controller.once("pano.arrived",Yn),this.controller.once("pano.cancel",Yn),setTimeout(Yn,((tn=en.duration)!==null&&tn!==void 0?tn:this.modeChangeDuration)+1e3)}return this.emit("works.load",createEvent("works.load",{input:Be,state:this.getCurrentState(),userAction:Fe,works:ln})),Pn.then(function(){return Je.ready()}).then(function(){var ni;Je.emit("works.ready",createEvent("works.ready",{input:Be,state:Je.getCurrentState(),userAction:Fe,works:ln})),(ni=Je.analysis)===null||ni===void 0||ni.work(ln)})},Se.prototype.reset=function(){var Be=this,De=this.lastLoadWorkTask.then(function(){return Be.reset_()});return this.lastLoadWorkTask=De.catch(function(Ve){Be.throwError(Ve)}),De},Se.prototype.reset_=function(){var Be=this;return new Promise(function(De){var Ve;Be.controller&&(Be.controller.destroy(),Be.controller=void 0);var Fe=Be.models.getMaterial();Fe&&(Fe.pano0&&Fe.pano0.map.dispose(),Fe.pano1&&Fe.pano1.map!==((Ve=Fe.pano0)===null||Ve===void 0?void 0:Ve.map)&&Fe.pano1.map.dispose()),Be.models.setMaterial({pano0:null,pano1:null,modelAlpha:1}),Be.lastModels.setMaterial({pano0:null,pano1:null,modelAlpha:1}),Be.renderer&&(Be.models.update(Be.renderer,Be.camera,Be.currentMode),Be.lastModels.update(Be.renderer,Be.camera,Be.currentMode),Be.model&&Be.boundingMesh.update(Be.renderer,Be.camera,Be.model));for(var Je=0,Xe=Be.models;Je<Xe.length;Je++){var Ke=Xe[Je];Be.lastModels.push(Ke)}if(Be.models.length=0,Be.lastModels.length>0){for(var Ye=0,or=Be.lastModels;Ye<or.length;Ye++){var Ke=or[Ye];Be.modelGroup.remove(Ke),Ke.dispose(),Be.needsRender=!0,Be.modelSceneNeedsRender=!0}Be.lastModels.length=0}Be.lastWorks&&delete Be.lastWorks,worksMap.delete(Be),Be.currentMode="Mapview",Be.pano={workCode:"",panoIndex:0},Be.camera.setFromPose({distance:0,fov:DEFAULT_CAMERA_FOV,longitude:0,latitude:0,offset:new Vector3(0,0,0)}),Be.state={mode:Be.currentMode,workCode:Be.pano.workCode,panoIndex:Be.pano.panoIndex,longitude:Be.camera.pose.longitude,latitude:Be.camera.pose.latitude,fov:Be.camera.pose.fov,offset:Be.camera.pose.offset.clone(),distance:Be.camera.pose.distance},Be.models.needsRender=!1,Be.camera.needsRender=!1,Be.needsRender=!1,Be.modelSceneNeedsRender=!1,De()})},Se.prototype.changeMode=function(Be,De,Ve,Fe,Je){var Xe=this;return De===void 0&&(De={}),Fe===void 0&&(Fe=!0),Je===void 0&&(Je=!1),new Promise(function(Ke,Ye){var or,sr,cr,Br;if(!Xe.renderer)throw new Error("renderer is not initialized.");De=__assign({},De);var tn=0;Xe.controller&&(typeof Ve=="number"?tn=Ve:tn=(or=Ve?.duration)!==null&&or!==void 0?or:Xe.modeChangeDuration);var en="fly";Xe.controller&&typeof Ve=="object"&&Ve.effect&&(en=Ve.effect);var an=typeof De.panoIndex=="number"?{workCode:(Br=(sr=De.workCode)!==null&&sr!==void 0?sr:(cr=Xe.work)===null||cr===void 0?void 0:cr.workCode)!==null&&Br!==void 0?Br:"",panoIndex:De.panoIndex}:Xe.pano;if(!Se.Mode.hasOwnProperty(Be)){var rn=new Error('mode "'.concat(Be,'" is not existed'));Xe.throwError(rn),Ye(rn);return}if((Be===Se.Mode.Panorama||Be===Se.Mode.VRPanorama||Be===Se.Mode.XRPanorama)&&!Xe.works.getResolvedObserver(an)){var rn=new Error("PanoId ".concat(panoStringify(an)," not existed."));Xe.throwError(rn),Ye(rn);return}(Be===Se.Mode.Floorplan||Be===Se.Mode.Topview||Be===Se.Mode.Mapview||Be===Se.Mode.Model)&&(Xe.models.loaded||(tn=0));var on=Xe.controller,sn=Xe.currentMode,ln=function(){if(Xe.controller&&Xe.controller.stopMomentumMovement(),Xe.controller&&Je===!1&&sn===Be)Be===Se.Mode.Panorama||Be===Se.Mode.Model||Be===Se.Mode.VRPanorama||Be===Se.Mode.XRPanorama?!panoEqual(Xe.pano,an)&&"moveToPano"in Xe.controller&&typeof Xe.controller.moveToPano=="function"?Xe.controller.moveToPano(an,__assign({duration:tn},De),Fe):Xe.controller.updateCamera(De,tn,Fe).catch(noop$1):(panoEqual(Xe.pano,an)||(Xe.pano=an),Xe.controller.updateCamera(De,tn,Fe).catch(noop$1));else{var hn=__assign(__assign({},De),an),mn=__assign(__assign({initial:{state:hn,currentState:Xe.getCurrentState(),duration:tn,effect:en,userAction:Fe}},Xe.commonParams()),Xe.controllerInits[Be]),An=Controllers[Be].initAnimationEndState(mn),xn=createEvent("mode.change.request",{prevMode:Xe.currentMode,mode:Be,state:An,userAction:Fe});if(Xe.emit("mode.change.request",xn),!xn.defaultPrevented){on&&on.destroy(),Xe.controller=Xe.applyController(Be,mn);var pn=createEvent("mode.change",{prevMode:Xe.currentMode,mode:Be,state:An,userAction:Fe});Xe.emit("mode.change",pn)}}Ke()};if(Be===Se.Mode.VRPanorama)Xe.requestFullscreen(),requestDeviceOrientationPermission().then(function(){return ln()}).catch(function(hn){hn instanceof Error&&(Xe.exitFullscreen(),Xe.throwError(hn),Ye(hn))});else if(Be===Se.Mode.XRPanorama){var cn=AnimationFrameLoop.shared.getContext();cn?cn.end():requestXRSessionPermission().then(function(hn){AnimationFrameLoop.shared.setContext(hn),ln()}).catch(function(hn){hn instanceof Error&&(Xe.throwError(hn),Ye(hn))})}else ln()})},Se.prototype.getPixels=function(Be,De,Ve,Fe,Je,Xe,Ke){if(!this.renderer)throw new Error("renderer is not initialized.");var Ye=this.renderer.getPixelRatio(),or=this.renderer.getRenderTarget(),sr=this.renderer.getSize(new Vector2),cr=0,Br=0,tn=1,en=1,an,rn,on,sn,ln;typeof Be=="number"?(cr=Be,typeof De=="number"&&(Br=De),typeof Ve=="number"&&(tn=Ve),typeof Fe=="number"&&(en=Fe),an=Je,rn=Xe,ln=Ke):(cr=Be.x,Br=Be.y,tn=Be.width,en=Be.height,an=Be.pixelRatio,rn=Be.flipY,on=Be.helperVisible,sn=Be.skipPanorama,ln=Be.buffer),cr=Math.ceil(cr),Br=Math.ceil(Br),tn=Math.ceil(tn),en=Math.ceil(en),an=Math.ceil(an??Ye),rn=rn??!1;var cn=this.getPixelsRenderTarget;cn.setSize(tn*an,en*an),this.renderer.setRenderTarget(cn),this.camera.pixelRatio=an,this.camera.resolution.set(tn,en),this.camera.setViewOffset(sr.width,sr.height,cr,sr.height-Br-en,tn,en);for(var hn=0,mn=this.scene.children;hn<mn.length;hn++){var An=mn[hn];An instanceof Object3D&&An.traverseVisible(function(Yn){Yn.setResolution&&Yn.setResolution(tn*an/Ye,en*an/Ye)})}this.models.autoUpdate=!1;var xn=!0,pn=0;sn&&(this.controller instanceof Controllers.Panorama||this.controller instanceof Controllers.VRPanorama||this.controller instanceof Controllers.XRPanorama)&&(xn=this.controller.tiling.object.visible,this.controller.tiling.object.visible=!1,pn=this.models.getMaterial().modelAlpha,this.models.setMaterial({modelAlpha:sn===!0?1:pn}));var dn=this.helperVisible;on===!1&&(this.helperVisible=!1),this.models.update(this.renderer,this.camera,this.currentMode),this.controller?(this.controller.updateRenderSize(new Vector2(tn*an,en*an)),this.controller.render(!0,this.postProcessingType)):(this.renderer.render(this.scene,this.camera),this.renderer.autoClearDepth=!1,this.renderer.autoClearColor=!1,this.renderer.render(this.modelScene,this.camera),this.renderer.autoClearDepth=!0,this.renderer.autoClearColor=!0),this.helperVisible=dn,sn&&(this.controller instanceof Controllers.Panorama||this.controller instanceof Controllers.VRPanorama||this.controller instanceof Controllers.XRPanorama)&&(this.controller.tiling.object.visible=xn,this.models.setMaterial({modelAlpha:pn})),this.models.update(this.renderer,this.camera,this.currentMode),this.models.autoUpdate=!0;var fn=tn*an,yn=en*an,Sn=fn*yn,gn=Sn*4,Cn;try{if(ln){if(ln.length!==gn)throw new Error("buffer length is not equals pixels ".concat(gn))}else ln=new Uint8Array(gn);if(this.renderer.readRenderTargetPixels(cn,0,0,tn*an,en*an,ln),rn)for(var Mn=Sn/2,Bn=0,kn=0,Ln=0,Pn=0;kn<Mn;kn++)for(Pn=(yn-Math.floor(kn/fn)-1)*fn+kn%fn,Ln=0;Ln<4;Ln++)Bn=ln[kn*4+Ln],ln[kn*4+Ln]=ln[Pn*4+Ln],ln[Pn*4+Ln]=Bn}catch(Yn){Cn=Yn}if(this.renderer.setRenderTarget(or),this.controller&&this.controller.updateRenderSize){var Vn=new Vector2;this.renderer.getDrawingBufferSize(Vn),this.controller.updateRenderSize(Vn)}if(this.camera.clearViewOffset(),this.camera.pixelRatio=Ye,this.getSize(this.camera.resolution),this.camera.aspect=this.camera.resolution.width/this.camera.resolution.height,Cn)throw Cn;return ln},Se.prototype.getElement=function(){var Be;return(Be=this.renderer)===null||Be===void 0?void 0:Be.domElement},Object.defineProperty(Se.prototype,"observers",{get:function(){return this.works.resolvedObservers},enumerable:!1,configurable:!0}),Se.prototype.render=function(Be,De){var Ve=this;if(De===void 0&&(De=!1),!this.renderer)return null;if(De){var Fe=this.renderer.getSize(sharedVector2);this.scene.traverseVisible(function(Je){Je.setResolution&&Je.setResolution(Fe.x,Fe.y)})}return this.aroundScissor(function(){if(Ve.renderer){var Je=Ve.scene.background;Ve.modelScene.background=Ve.camera.isOrthographicCamera?null:Je,Ve.modelScene.environment=Ve.scene.environment,Ve.scene.background=null,Ve.controller?(Ve.controller.render(Ve.onlyRenderIfNeeds?Ve.modelSceneNeedsRender:!0,Ve.postProcessingType),Ve.info={memory:__assign({},Ve.controller.renderer.info.memory),render:__assign({},Ve.controller.renderer.info.render)}):(Ve.renderer.render(Ve.scene,Ve.camera),Ve.info={memory:__assign({},Ve.renderer.info.memory),render:__assign({},Ve.renderer.info.render)}),Ve.scene.background=Je,Ve.modelScene.background=null,Ve.modelScene.environment=null,Ve.poweredByRealsee&&Ve.currentMode!=="VRPanorama"&&Ve.currentMode!=="XRPanorama"&&Ve.renderer.getRenderTarget()!==Ve.getPixelsRenderTarget&&renderPoweredByRealsee(Ve.renderer)}Be&&AnimationFrameLoop.shared.add(Be,!0)}),null},Se.prototype.updateTime=function(Be,De){for(var Ve,Fe=this,Je=[],Xe=2;Xe<arguments.length;Xe++)Je[Xe-2]=arguments[Xe];if(!this.destroyed){if(this.works.update(),this.syncingState=this.syncState(Be,De),this.controller&&(Ve=this.controller).updateTime.apply(Ve,__spreadArray([Be,De],Je,!1)),this.renderer&&(this.camera.pixelRatio=this.renderer.getPixelRatio(),this.getSize(this.camera.resolution),this.camera.aspect=this.camera.resolution.width/this.camera.resolution.height),this.camera.environment=this.scene.environment,this.camera.updateTime(Be),this.renderer){ktx2.detectSupport(this.renderer);var Ke=this.models.loaded,Ye=this.models.refined;if(this.models.update(this.renderer,this.camera,this.currentMode),this.camera.autoNearFar){var or=this.models.bounding.getBoundingSphere(sharedSphere),sr=or.radius*2;or.containsPoint(this.camera.position)||(sr=this.camera.position.distanceTo(or.center)+or.radius),sr=clamp$1(sr,800,5e4),this.camera.far!==sr&&(this.camera.far=sr);var cr=sr/1e4;cr=clamp$1(cr,.03,.1),this.camera.near!==cr&&(this.camera.near=cr)}if(Ke===!1&&this.models.loaded===!0&&this.emit("models.load",createEvent("models.load",{models:this.models})),Ye===!1&&this.models.refined===!0&&this.emit("models.refined",createEvent("models.refined",{models:this.models})),this.models.loaded){for(var Br=0,tn=this.models;Br<tn.length;Br++){var en=tn[Br];en.parent!==this.modelGroup&&(this.modelGroup.add(en),this.needsRender=!0,this.modelSceneNeedsRender=!0)}if(this.lastModels.length>0){for(var an=0,rn=this.lastModels;an<rn.length;an++){var en=rn[an];this.modelGroup.remove(en),en.dispose(),this.needsRender=!0,this.modelSceneNeedsRender=!0}this.lastModels.length=0}this.lastWorks&&delete this.lastWorks}this.lastModels.setMaterial(this.models.getMaterial()),this.lastModels.materialVersion=this.models.materialVersion,this.lastModels.update(this.renderer,this.camera,this.currentMode)}this.syncingState=!1;var on=new Vector2(512,512),sn=new Vector2(512,512);this.renderer&&(this.renderer.getSize(on),on.x*=this.scissor.width,on.y*=this.scissor.height,this.renderer.getDrawingBufferSize(sn),sn.x*=this.scissor.width,sn.y*=this.scissor.height);{for(var ln=new Box3,cn=new Box3,hn=new Vector3(4,4,4),mn=0,An=this.works.resolvedObservers;mn<An.length;mn++){var xn=An[mn];cn.setFromCenterAndSize(xn.position,hn),ln.union(cn)}if(ln.union(this.models.bounding),this.lastWorks)for(var pn=0,dn=this.lastWorks.resolvedObservers;pn<dn.length;pn++){var xn=dn[pn];cn.setFromCenterAndSize(xn.position,hn),ln.union(cn)}ln.union(this.lastModels.bounding),ln.getCenter(this.boundingMesh.position),ln.getSize(this.boundingMesh.scale),this.boundingMesh.boundingBox.copy(ln),this.renderer&&this.model&&this.boundingMesh.update(this.renderer,this.camera,this.model)}var fn=createEvent("render.prepare",{needsRender:!0,info:null});if(this.emit("render.prepare",fn),!fn.defaultPrevented){var yn=[];sharedProjScreenMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),sharedFrustum.setFromProjectionMatrix(sharedProjScreenMatrix);for(var Sn=0,gn=this.scene.children;Sn<gn.length;Sn++){var Cn=gn[Sn];Cn!==this.modelGroup&&Cn!==this.boundingMesh&&Cn.traverseVisible(function(Vn){if(Vn.setResolution&&Vn.setResolution(on.x,on.y),Vn.setTime&&Vn.setTime(Be),Vn.mixer instanceof AnimationMixer){var Yn=clockForMixer.get(Vn.mixer);Yn||(Yn=new Clock,clockForMixer.set(Vn.mixer,Yn)),Vn.mixer.update(Yn.getDelta())}(Vn instanceof Mesh||Vn instanceof Line||Vn instanceof Points)&&(Vn instanceof ImmediateRenderObject||!Vn.frustumCulled||sharedFrustum.intersectsObject(Vn))&&yn.push(Vn)})}if(sn.width*sn.height>4096*2048?this.renderSwitch01=this.renderSwitch01^1:this.renderSwitch01=0,this.renderer&&this.paused===!1&&this.renderSwitch01===0){var Mn=void 0;if(this.onlyRenderIfNeeds!==!0)Mn=this.render();else{if(this.controller&&(this.controller.needsRender===!0&&(this.controller.needsRender=!1,this.needsRender=!0),this.controller.modelSceneNeedsRender===!0&&(this.controller.modelSceneNeedsRender=!1,this.modelSceneNeedsRender=!0)),this.camera.needsRender===!0&&(this.camera.needsRender=!1,this.needsRender=!0,this.modelSceneNeedsRender=!0),this.models.needsRender===!0&&(this.models.needsRender=!1,this.needsRender=!0,this.modelSceneNeedsRender=!0),this.needsRender!==!0)for(var Bn=0,kn=yn;Bn<kn.length;Bn++){var Ln=kn[Bn],Pn=function(Vn){Vn.needsRender===!0?(Vn.needsRender=!1,Fe.needsRender=!0):Vn.mixer&&Vn.mixer.stats.actions.inUse>0&&(Fe.needsRender=!0)};Pn(Ln),Ln.traverseAncestors(Pn)}(this.needsRender!==!1||this.modelSceneNeedsRender!==!1)&&(Mn=this.render())}this.needsRender=!1,this.modelSceneNeedsRender=!1,this.hasListener("render")&&this.emit("render",createEvent("render",{needsRender:Mn!==void 0,info:this.info}))}this.needsRender=!1,this.modelSceneNeedsRender=!1}this.fps.testTime&&Be-this.fps.testTime<1e3?this.fps.testCount++:(this.emit("fps",this.fps.testCount),this.fps.testTime=Be,this.fps.testCount=0)}},Se.prototype.pause=function(){this.paused=!0,this.renderer&&this.renderer instanceof InternalWebGLRenderer&&this.renderer.clear(!0,!0,!0)},Se.prototype.play=function(){this.needsRender=!0,this.modelSceneNeedsRender=!0,this.paused=!1},Se.prototype.moveToPano=function(Be,De,Ve){De===void 0&&(De={}),Ve===void 0&&(Ve=!0);var Fe=this,Je=Fe.controller,Xe=Fe.renderer;if(!Je)return this.throwError(new Error("controller is not initialized.")),Promise.resolve();if(!Xe)return this.throwError(new Error("renderer is not initialized.")),Promise.resolve();var Ke=this.works.getResolvedObserver(Be);if(!Ke)return this.throwError(new Error("pano ".concat(JSON.stringify(Be)," not existed."))),Promise.resolve();var Ye={workCode:Ke.work.workCode,panoIndex:Ke.panoIndex};return"moveToPano"in Je&&typeof Je.moveToPano=="function"?Je.moveToPano(Ye,De,Ve):Ke&&(this.pano=Ye,this.once("initAnimation.start",function(or){De.moveStartCallback&&De.moveStartCallback(or.state)}),this.once("initAnimation.end",function(or){De.moveEndCallback&&De.moveEndCallback(or.state)}),this.changeMode(Se.Mode.Panorama,De,{effect:De.effect},Ve)),this.ready()},Se.prototype.preloadPano=function(Be,De){var Ve=this;De===void 0&&(De=noop$1);var Fe=this.works.getResolvedObserver(Be);if(!Fe)return Promise.reject(new Error("Pano ".concat(JSON.stringify(Be)," never found")));var Je=["right","left","up","down","front","back"],Xe=now$2();return Promise.all(Je.map(function(Ke){var Ye=__assign({key:"pano.".concat(Fe.panoId,".").concat(Ke)},pick(Ve.imageOptions,["size","format","quality","mappings"])),or=Fe.images[Ke],sr=Ve.imageOptions.transform?Ve.imageOptions.transform(or,Ye):imageURL(or,Ye);return getFetcher(Fe.work).preload(sr)})).then(function(){var Ke=now$2()-Xe;return De(Ke),Ke})},Se.prototype.project2d=function(Be,De){if(De===void 0&&(De=!1),!this.renderer)return null;if(this.models.length>0&&De){var Ve=this.camera.position,Fe=Be.clone().sub(Ve),Je=new Raycaster(Ve,Fe.clone().normalize());Je.params.Points={threshold:.1};var Xe=this.models.intersectRaycaster(Je)[0];if(Xe&&Xe.distance+.01<Fe.length())return null}var Ke=Be.clone().project(this.camera);if(Math.abs(Ke.z)>1)return null;var Ye=this.renderer.getSize(new Vector2),or=Ye.x*this.scissor.width,sr=Ye.y*this.scissor.height,cr=Ye.x*this.scissor.left+(Ke.x+1)/2*or,Br=Ye.y*(1-this.scissor.bottom-this.scissor.height)+(-Ke.y+1)/2*sr;return new Vector2(cr,Br)},Se.prototype.getRenderObjects=function(Be){sharedProjScreenMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),sharedFrustum.setFromProjectionMatrix(sharedProjScreenMatrix),Be||(Be=this.scene);var De=[];return Be.traverseVisible(function(Ve){(Ve instanceof Mesh||Ve instanceof Line||Ve instanceof Points)&&(Ve instanceof ImmediateRenderObject||!Ve.frustumCulled||sharedFrustum.intersectsObject(Ve))&&De.push(Ve)}),De},Se.prototype.getCurrentState=function(){return __assign(__assign({},this.getPose()),{mode:this.currentMode,workCode:this.pano.workCode,panoIndex:this.pano.panoIndex})},Se.prototype.setState=function(Be,De,Ve){var Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn;De===void 0&&(De=!1),Ve===void 0&&(Ve=!0),Be=Object.assign({},Be),Be.offset&&!(Be instanceof Vector3)&&(Be.offset=new Vector3(Be.offset.x,Be.offset.y,Be.offset.z));var en;if(typeof Be.panoIndex=="number")if(Be.workCode)en={workCode:Be.workCode,panoIndex:Be.panoIndex};else{var an=(Je=(Fe=this.work)===null||Fe===void 0?void 0:Fe.workCode)!==null&&Je!==void 0?Je:"",rn=this.state.workCode;this.works.filter(function(fn){return fn.workCode===rn}).length>0&&(an=rn),en={workCode:an,panoIndex:Be.panoIndex}}var on=(Xe=Be.mode)!==null&&Xe!==void 0?Xe:this.state.mode,sn,ln,cn,hn,mn;if(this.controller&&this.controller.stopMomentumMovement(),this.state.mode!==on){if(on==="VRPanorama"){this.changeMode("VRPanorama",void 0,void 0,!0);return}var An={workCode:en?.workCode,panoIndex:en?.panoIndex};typeof Be.longitude=="number"&&(An.longitude=Be.longitude),typeof Be.latitude=="number"&&(An.latitude=Be.latitude),typeof Be.fov=="number"&&(An.fov=Be.fov),typeof Be.distance=="number"&&(An.distance=Be.distance),Be.offset instanceof Vector3&&(An.offset=Be.offset);var xn=__assign(__assign({initial:{state:An,currentState:this.getCurrentState(),duration:this.modeChangeDuration,effect:"fly",userAction:!1}},this.commonParams()),this.controllerInits[on]),pn=Controllers[on].initAnimationEndState(xn);sn=pn.longitude,ln=pn.latitude,cn=pn.fov,hn=pn.offset,mn=pn.distance}else sn=(Ke=Be.longitude)!==null&&Ke!==void 0?Ke:this.state.longitude,ln=(Ye=Be.latitude)!==null&&Ye!==void 0?Ye:this.state.latitude,cn=(or=Be.fov)!==null&&or!==void 0?or:this.state.fov,hn=(sr=Be.offset)!==null&&sr!==void 0?sr:this.state.offset,mn=(cr=Be.distance)!==null&&cr!==void 0?cr:this.state.distance;var dn={workCode:(en??this.pano).workCode,panoIndex:(en??this.pano).panoIndex,mode:on,longitude:sn,latitude:ln,fov:cn,offset:hn,distance:mn};this.emit("state.set",createEvent("state.set",{userAction:Ve,state:dn})),stateEqual(this.state,dn)||(this.controller&&dn.mode==="VRPanorama"&&dn.mode!==this.state.mode?(assignState(this.state,dn),this.changeMode("VRPanorama")):this.controller&&dn.mode==="XRPanorama"&&dn.mode!==this.state.mode?(assignState(this.state,dn),this.changeMode("XRPanorama")):(assignState(this.state,dn),this.controller&&Ve&&(this.controller.userAction=!1),De&&this.state.mode===dn.mode&&(this.syncingState=this.syncState(now$2(),0,De),this.syncingState&&((Br=this.controller)===null||Br===void 0||Br.updateTime(now$2(),0),this.syncingState=!1)),this.emit("state.change",createEvent("state.change",{userAction:Ve,state:this.state})),(tn=this.analysis)===null||tn===void 0||tn.state(this.works,this.state)))},Se.prototype.aroundScissor=function(Be){if(this.renderer){if(this.state.mode==="XRPanorama"){Be();return}var De=new Vector2,Ve=this.scissor.left!==0||this.scissor.bottom!==0||this.scissor.width!==1||this.scissor.height!==1;if(Ve){this.renderer.getSize(De);var Fe=Math.floor(De.x*this.scissor.left),Je=Math.floor(De.y*this.scissor.bottom),Xe=Math.floor(De.x*this.scissor.width),Ke=Math.floor(De.y*this.scissor.height);this.renderer.setViewport(Fe,Je,Xe,Ke),this.renderer.setScissor(Fe,Je,Xe,Ke),this.renderer.setScissorTest(!0)}Be(),Ve&&(this.renderer.setViewport(0,0,De.x,De.y),this.renderer.setScissor(0,0,De.x,De.y),this.renderer.setScissorTest(!1))}},Se.prototype.syncState=function(Be,De,Ve){Ve===void 0&&(Ve=!1);var Fe=this.stateSynced;if(this.stateSynced=!1,!this.controller)return!1;if(this.state.mode!==this.currentMode){var Je={mode:this.state.mode,workCode:this.state.workCode,panoIndex:this.state.panoIndex,longitude:this.state.longitude,latitude:this.state.latitude,fov:this.state.fov,offset:this.state.offset,distance:this.state.distance};return this.changeMode(this.state.mode,Je,this.modeChangeDuration,this.controller.userAction),!0}if(!this.controller.isReady())return!1;if(this.controller instanceof Controllers.Model){if(notSimilarVector3(this.camera.pose.offset,this.state.offset)){var Xe={longitude:this.state.longitude,latitude:this.state.latitude,fov:this.state.fov,offset:this.state.offset};return this.controller.moveToPosition(this.state.offset,__assign(__assign({},Xe),{duration:Ve?0:void 0}),!1),!0}}else{var Ke={workCode:this.state.workCode,panoIndex:this.state.panoIndex};if(!panoEqual(Ke,this.pano)&&"moveToPano"in this.controller&&typeof this.controller.moveToPano=="function"){var Xe={longitude:this.state.longitude,latitude:this.state.latitude,fov:this.state.fov,offset:this.state.offset,distance:this.state.distance};return this.controller.moveToPano(Ke,Xe,!1),!0}}if(this.controller instanceof Controllers.Floorplan||this.controller instanceof Controllers.Topview||this.controller instanceof Controllers.Mapview){var Ye=1,or=.2,sr=.2,cr=Math.PI/45,Br=Ve?this.state.fov:stepNumber(this.camera.pose.fov,this.state.fov,Ye),tn=Math.abs(this.camera.pose.distance-this.state.distance),en=tn>sr*15?tn/15:or,an=Ve?this.state.distance:stepNumber(this.camera.pose.distance,this.state.distance,en),rn=this.camera.pose.offset.distanceTo(this.state.offset),on=rn>sr*15?rn/15:sr,sn=Ve?new Vector3().copy(this.state.offset):stepVector(this.camera.pose.offset,this.state.offset,on),ln=Ve?{longitude:this.state.longitude,latitude:this.state.latitude}:stepCoordinates({longitude:this.camera.pose.longitude,latitude:this.camera.pose.latitude},{longitude:this.state.longitude,latitude:this.state.latitude},cr),cn=ln.longitude,hn=ln.latitude;if(notSimilarValue(Br,this.camera.pose.fov)||notSimilarVector3(sn,this.camera.pose.offset)||notSimilarValue(an,this.camera.pose.distance)||notSimilarValue(cn,this.camera.pose.longitude,Math.PI*2)||notSimilarValue(hn,this.camera.pose.latitude)){var mn={x:sn.x,y:sn.y,z:sn.z},An={fov:Br};return Object.assign(mn,{distance:an}),Object.assign(An,{longitude:cn,latitude:hn}),this.controller.stopMomentumMovement(),this.controller.cameraMotion.set(An,0).catch(noop$1),this.controller.locationMotion.set(mn,0).catch(noop$1),!0}}else{var xn=1,pn=Math.PI/45,Br=Ve?this.state.fov:stepNumber(this.camera.pose.fov,this.state.fov,xn),dn=Ve?{longitude:this.state.longitude,latitude:this.state.latitude}:stepCoordinates({longitude:this.camera.pose.longitude,latitude:this.camera.pose.latitude},{longitude:this.state.longitude,latitude:this.state.latitude},pn),cn=dn.longitude,hn=dn.latitude,an=this.state.distance,sn=new Vector3().copy(this.state.offset);if(notSimilarValue(an,this.camera.pose.distance)&&(this.state.distance=this.camera.pose.distance),notSimilarVector3(sn,this.camera.pose.offset)&&(this.state.offset=this.camera.pose.offset.clone()),notSimilarValue(cn,this.camera.pose.longitude,Math.PI*2)||notSimilarValue(hn,this.camera.pose.latitude)||notSimilarValue(Br,this.camera.pose.fov))return this.controller.stopMomentumMovement(),this.controller.cameraMotion.set({longitude:cn,latitude:hn,fov:Br},0).catch(noop$1),!0}if(this.stateSynced=!0,Fe===!1&&this.emit("state.synced",createEvent("state.synced",{userAction:!1,state:this.state})),this.readyCallbacks.length&&this.stateSynced){var fn=this.currentMode,yn=fn===Se.Mode.Floorplan||fn===Se.Mode.Topview||fn===Se.Mode.Mapview||fn===Se.Mode.Model;if(!yn||this.models.loaded){var Sn=this.readyCallbacks.slice();this.readyCallbacks.length=0;for(var gn=0,Cn=Sn;gn<Cn.length;gn++){var Mn=Cn[gn];this.controller instanceof Controllers.Panorama&&Mn.tile===!0&&!this.controller.isTileReady()?this.readyCallbacks.push(Mn):Mn()}}}return!1},Se.prototype.ready=function(Be){var De=this;return Be===void 0&&(Be={}),new Promise(function(Ve){var Fe;De.readyCallbacks.push(Object.assign(Ve,{tile:(Fe=Be.tile)!==null&&Fe!==void 0?Fe:!1}))})},Se.prototype.requestFullscreen=function(){var Be;if(isMobile){var De=(Be=this.getElement())===null||Be===void 0?void 0:Be.parentNode;De&&"requestFullscreen"in De&&typeof document<"u"&&document.fullscreenElement===null&&De.requestFullscreen()}},Se.prototype.exitFullscreen=function(){typeof document<"u"&&document.fullscreenElement&&"exitFullscreen"in document&&document.exitFullscreen()},Se.prototype.throwError=function(Be){this.hasListener("error")?this.emit("error",Be):console.error(Be)},Se.prototype.loadModel=function(Be,De){for(var Ve=this,Fe,Je,Xe,Ke,Ye,or,sr=[],cr=function(hn){var mn=Br.models.filter(function(dn){var fn;return((fn=dn.work)===null||fn===void 0?void 0:fn.workCode)===hn.workCode})[0];if(mn)mn.work=hn,sr.push(mn);else{var An=new Model({onError:function(dn){Ve.emit("model.error",createEvent("model.error",{work:hn,model:An,error:dn})),Ve.throwError(dn)},onShownFloorChange:function(dn){Ve.emit("model.changeShownFloor",createEvent("model.changeShownFloor",{work:hn,model:An,error:null}))},onLoad:function(){Ve.emit("model.load",createEvent("model.load",{work:hn,model:An,error:null}))}});sr.push(An),Br.emit("model.request",createEvent("model.request",{work:hn,model:An,error:null}));var xn=(Xe=(Je=(Fe=De.model)===null||Fe===void 0?void 0:Fe.textureOptions)!==null&&Je!==void 0?Je:De.textureOptions)!==null&&Xe!==void 0?Xe:Br.textureOptions,pn=(Ye=(Ke=De.model)===null||Ke===void 0?void 0:Ke["3d-tiles"])!==null&&Ye!==void 0?Ye:De["3d-tiles"];An.load(hn,{light:(or=De.model)===null||or===void 0?void 0:or.light,textureOptions:xn,"3d-tiles":pn})}},Br=this,tn=0,en=Be;tn<en.length;tn++){var an=en[tn];cr(an)}if(this.models.length>0){for(var rn=0,on=this.models;rn<on.length;rn++){var sn=on[rn];sr.indexOf(sn)===-1&&this.lastModels.push(sn)}this.models.length=0}for(var ln=0,cn=sr;ln<cn.length;ln++){var sn=cn[ln];this.models.push(sn)}return this.renderer&&(this.models.loaded=!1),new Promise(function(hn){Ve.on("models.load",function(){Ve.controller&&Ve.controller.updateModel(Ve.models),hn()})})},Se.prototype.commonParams=function(){return{ident:this.ident,scene:this.scene,xrCustomObjectsScene:this.xrCustomObjectsScene,helper:this.helperGroup,boundingMesh:this.boundingMesh,camera:this.camera,renderer:this.renderer,scissor:this.scissor,element:this.getElement(),models:this.models,works:this.works,imageOptions:this.imageOptions,enableWheel:this.enableWheel,enableIOSEDR:this._enableIOSEDR,enableEDL:this.enableEDL,enableHQ:this.enableHQ,extraElements:this.extraElements,videoTexture:this.videoTexture,modelScene:this.modelScene,modelRenderTarget:this.modelRenderTarget,enableLayeringRendering:this.enableLayeringRendering}},Se.prototype.applyController=function(Be,De){var Ve=this;if(!this.renderer)throw new Error("renderer is not initialized.");Be!==Se.Mode.Mapview&&(this.enableEDL=!1,this.enableHQ=!1);var Fe=Controllers[Be];this.currentMode=Be;for(var Je=new Fe(De),Xe=function(Br){Je.on(Br,function(){for(var tn=[],en=0;en<arguments.length;en++)tn[en]=arguments[en];var an=Ve.emit.apply(Ve,__spreadArray([Br],tn,!1));if(an)return!1})},Ke=0,Ye=PROXY_CONTROLLER_EVENT_NAMES;Ke<Ye.length;Ke++){var or=Ye[Ke];Xe(or)}{var sr=Controllers[Be].initAnimationEndState(De),cr=De.initial.userAction;stateEqual(this.state,sr)||(assignState(this.state,sr),this.emit("state.change",createEvent("state.change",{userAction:cr,state:this.state}))),this.emit("currentState.change",createEvent("currentState.change",{userAction:cr,state:this.getCurrentState()}))}return Je.on("camera.update",function(Br){var tn;if(Ve.controller){var en=Ve.controller.getTargetState();Br.userAction&&Ve.syncingState===!1&&Ve.state.mode===en.mode&&!stateEqual(Ve.state,en)&&(assignState(Ve.state,en),Ve.emit("state.change",createEvent("state.change",{userAction:Br.userAction,state:Ve.state})),(tn=Ve.analysis)===null||tn===void 0||tn.state(Ve.works,Ve.state))}Ve.emit("currentState.change",createEvent("currentState.change",{userAction:Br.userAction,state:Ve.getCurrentState()}))}),Je.on("initAnimation.start",function(Br){var tn,en=Br.state,an=Br.userAction;an&&Ve.state.mode===en.mode&&!stateEqual(Ve.state,en)&&(assignState(Ve.state,en),Ve.emit("state.change",createEvent("state.change",{userAction:an,state:Ve.state})),(tn=Ve.analysis)===null||tn===void 0||tn.state(Ve.works,Ve.state))}),Je.on("initAnimation.end",function(Br){var tn,en=Br.state,an=Br.userAction;Ve.pano={workCode:en.workCode,panoIndex:en.panoIndex},an&&Ve.state.mode===en.mode&&!stateEqual(Ve.state,en)&&(assignState(Ve.state,en),Ve.emit("state.change",createEvent("state.change",{userAction:an,state:Ve.state})),(tn=Ve.analysis)===null||tn===void 0||tn.state(Ve.works,Ve.state))}),Je.on("pano.moveTo",function(Br){var tn,en=Br.state,an=Br.userAction;Ve.pano={workCode:en.workCode,panoIndex:en.panoIndex},an&&Ve.state.mode===en.mode&&!stateEqual(Ve.state,en)&&(assignState(Ve.state,en),Ve.emit("state.change",createEvent("state.change",{userAction:an,state:Ve.state})),(tn=Ve.analysis)===null||tn===void 0||tn.state(Ve.works,Ve.state))}),Je.on("pano.arrived",function(Br){var tn,en=Br.state,an=Br.userAction;Ve.pano={workCode:en.workCode,panoIndex:en.panoIndex},an&&Ve.state.mode===en.mode&&!stateEqual(Ve.state,en)&&(assignState(Ve.state,en),Ve.emit("state.change",createEvent("state.change",{userAction:an,state:Ve.state})),(tn=Ve.analysis)===null||tn===void 0||tn.state(Ve.works,Ve.state))}),Je.on("pano.cancel",function(Br){var tn,en=Br.state,an=Br.userAction;an&&Ve.state.mode===en.mode&&!stateEqual(Ve.state,en)&&(assignState(Ve.state,en),Ve.emit("state.change",createEvent("state.change",{userAction:an,state:Ve.state})),(tn=Ve.analysis)===null||tn===void 0||tn.state(Ve.works,Ve.state))}),Je.on("pano.moveTo",function(Br){var tn=Br.userAction;Ve.emit("currentState.change",createEvent("currentState.change",{userAction:tn,state:Ve.getCurrentState()}))}),Je.on("pano.request",function(Br){Ve.emit("pano.request",Br),Br.defaultPrevented||Ve.moveToPano(Br.state,Br.options,Br.userAction)}),Je.on("vr.requestExit",function(){Ve.currentMode===Se.Mode.VRPanorama&&(Ve.exitFullscreen(),Ve.changeMode(Se.Mode.Panorama))}),Je.on("error",function(Br){return Ve.throwError(Br)}),Je},Se.prototype.removeEventListeners=function(){},Se.prototype.getWorkResources=function(Be){var De=this,Ve,Fe=this.models.find(function(Ye){return Ye.work===Be}),Je=((Ve=Fe?.viewLayers)!==null&&Ve!==void 0?Ve:[]).map(function(Ye){return Ye.scene});function Xe(Ye){var or=/([0-9a-z\.\_\-]+)([\?\#].*)?$/i.exec(Ye);if(or){var sr=String(or[1]).trim().split(".").slice(1).reverse()[0];if(sr)return sr}return""}function Ke(Ye,or){or===void 0&&(or=0);var sr=[];if(Ye.content&&Ye.content.uri){var cr=Xe(Ye.content.uri);if(cr==="json"){var Br=imageURL(Ye.content.uri,{key:"model.".concat(or)});sr.push({url:Br,type:"tileset"})}else if(cr==="at3d"&&Ye.extras[cr]){var Br=Ye.content.uri;sr.push({url:Br,type:"model"});for(var tn=Ye.extras[cr],en=tn.textureArray,an=tn.textureOptions,rn=0,on=en;rn<on.length;rn++){var sn=on[rn],ln=__assign({key:"texture.pbm"},pick(an,["format","quality","size","sharpen","mappings"])),cn=applyImageURLOptions(sn,an?.transform,ln);sr.push({url:cn,type:"texture"})}}else{var Br=imageURL(Ye.content.uri,{key:"model.".concat(or)});sr.push({url:Br,type:"model"})}}if(Ye.children)for(var hn=0;hn<Ye.children.length;hn++){var mn=Ye.children[hn];sr.push.apply(sr,Ke(mn,hn))}return sr}return Promise.all(Je.map(function(Ye){return Ye.loadAllTilesets()})).then(function(){for(var Ye=[],or=["right","left","up","down","front","back"],sr=0,cr=Be.observers;sr<cr.length;sr++){for(var Br=cr[sr],tn=0,en=or;tn<en.length;tn++){var an=en[tn],rn=__assign({key:"pano.".concat(panoStringify(Br.pano),".").concat(an)},pick(De.imageOptions,["size","format","quality","mappings"])),on=Br.images[an],sn=applyImageURLOptions(on,De.imageOptions.transform,rn);Ye.push({url:sn,type:"pano"})}if(Br.images.tiles)for(var ln=0,cn=Br.images.tiles;ln<cn.length;ln++)for(var hn=cn[ln],mn=0,An=or;mn<An.length;mn++)for(var an=An[mn],xn=hn.size,pn=Math.pow(2,hn.level),dn=1/pn,fn=0;fn<pn;fn++)for(var yn=0;yn<pn;yn++){var Sn="".concat(Br.panoId,".").concat(an,".").concat(hn.level,".").concat(fn,".").concat(yn),rn=__assign(__assign({key:"pano_tile.".concat(Sn)},pick(De.imageOptions,["format","size","quality","sharpen","mappings"])),{size:hn.scale>=1?void 0:xn*dn*hn.scale,cut:dn===1?void 0:[xn*dn*yn,xn*dn*fn,xn*dn,xn*dn]}),sn=applyImageURLOptions(hn[an],De.imageOptions.transform,rn);Ye.push({url:sn,type:"pano_tile"})}}for(var gn=0,Cn=Je;gn<Cn.length;gn++){var Mn=Cn[gn];Mn.tileset.url&&Ye.push({url:Mn.tileset.url,type:"model"}),Ye.push.apply(Ye,Ke(Mn.tileset.root))}return Ye})},Object.defineProperty(Se.prototype,"internalLightsEnabled",{get:function(){var Be=this.scene.children.find(function(De){return De.name==="internalLights"});return Be?Be.visible:!1},set:function(Be){var De=this.scene.children.find(function(Ve){return Ve.name==="internalLights"});De&&(De.visible=Be),De=this.modelScene.children.find(function(Ve){return Ve.name==="internalLights"}),De&&(De.visible=Be)},enumerable:!1,configurable:!0}),Se.Mode={Panorama:"Panorama",Model:"Model",Floorplan:"Floorplan",Topview:"Topview",Mapview:"Mapview",VRPanorama:"VRPanorama",XRPanorama:"XRPanorama"},Se.Line=null,Se}(Subscribe),__FIVE_DEBUG__={instances:{},constructor:Five};typeof window<"u"&&Object.assign(window,{__FIVE_DEBUG__});var k$q=function($e,Se){return k$q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Be,De){Be.__proto__=De}||function(Be,De){for(var Ve in De)Object.prototype.hasOwnProperty.call(De,Ve)&&(Be[Ve]=De[Ve])},k$q($e,Se)};function B$s($e,Se){if(typeof Se!="function"&&Se!==null)throw new TypeError("Class extends value "+String(Se)+" is not a constructor or null");k$q($e,Se);function Be(){this.constructor=$e}$e.prototype=Se===null?Object.create(Se):(Be.prototype=Se.prototype,new Be)}var g$C=function(){return g$C=Object.assign||function($e){for(var Se,Be=1,De=arguments.length;Be<De;Be++){Se=arguments[Be];for(var Ve in Se)Object.prototype.hasOwnProperty.call(Se,Ve)&&($e[Ve]=Se[Ve])}return $e},g$C.apply(this,arguments)},E$x=[],R$q=[];function ie$5($e){var Se=$e===void 0?{}:$e,Be=Se.backgroundColor,De=Be===void 0?1579548:Be,Ve=Se.backgroundAlpha,Fe=Ve===void 0?1:Ve,Je=Se.preserveDrawingBuffer,Xe=Je===void 0?!0:Je,Ke=Se.pixelRatio,Ye=Ke===void 0?1:Ke,or=Se.webgl2,sr=or===void 0?!1:or;if(typeof window<"u"){var cr=null;if(sr?cr=E$x.shift():cr=R$q.shift(),!cr){if(sr){var Br=document.createElement("canvas"),tn=Br.getContext("webgl2");tn?cr=new WebGLRenderer({preserveDrawingBuffer:Xe,antialias:!0,alpha:!0,stencil:!0,canvas:Br,context:tn}):(console.error("error occurred when getting webgl2 canvas context, mybe webgl2 not support, fallback to webgl."),cr=new WebGLRenderer({preserveDrawingBuffer:Xe,antialias:!1,alpha:!0,stencil:!0}))}else cr=new WebGLRenderer({preserveDrawingBuffer:Xe,antialias:!1,alpha:!0,stencil:!0});cr.outputEncoding=sRGBEncoding}return cr.setPixelRatio(Ye),cr.setClearColor(De,Fe),cr.autoClear=!0,cr}}function se$4($e){if($e){var Se=$e.capabilities.isWebGL2;Se?R$q.indexOf($e)===-1&&R$q.push($e):E$x.indexOf($e)===-1&&E$x.push($e)}}var L$p=reactExports.createContext(null);function p$C(){var $e=reactExports.useContext(L$p);if(!$e)throw new Error("FiveProvider never found.");return $e.five}function ce$3($e,Se){var Be=Array.isArray($e)?$e:[$e],De=Array.isArray(Se)?Se:[Se];if(Be.length!==De.length)return!1;for(var Ve=0;Ve<Be.length;Ve++)if(Be[Ve].workCode!==De[Ve].workCode)return!1;return!0}function Ge$1($e){return $e===void 0&&($e={}),function(Se){B$s(Be,Se);function Be(De){var Ve=Se.call(this,De)||this;return Ve.__fiveEventDisposers=[],Ve.__fiveDisposeTimer=null,Ve.five=new Five(g$C(g$C({},$e),{renderer:void 0})),Ve.loadWork=Ve.loadWork.bind(Ve),Ve.state={},Ve}return Be.prototype.loadWork=function(De,Ve,Fe,Je){if(Je===void 0&&(Je=!0),this.props.work)throw new Error("props 'works' is set in fiveProvider, if you need modify work internal, use 'initialWork' instead.");return this.five.load(De,Ve,Fe,Je)},Be.prototype.shouldComponentUpdate=function(De){return this.five.renderer&&this.five&&De.work&&!ce$3(De.work,this.five.works)&&this.five.load(De.work,De.initialState,De.initialOptions),!0},Be.prototype.componentDidMount=function(){var De=this,Ve;clearTimeout(this.__fiveDisposeTimer),this.__fiveDisposeTimer=null;var Fe;if(typeof window<"u"){var Je=getViewportScale(),Xe=Je===1?window.devicePixelRatio:1;Fe=ie$5({pixelRatio:Xe,backgroundAlpha:$e.backgroundAlpha,backgroundColor:$e.backgroundColor,webgl2:$e?.webgl2,preserveDrawingBuffer:$e?.preserveDrawingBuffer})}this.five.renderer=Fe,this.setState({renderer:Fe}),this.__fiveEventDisposers.push(this.five.on("load",function(){De.props.onWorksChange&&De.props.onWorksChange(De.five.works)})),this.__fiveEventDisposers.push(this.five.on("stateChange",function(Ye,or){De.props.onStateChange&&De.props.onStateChange(Ye,or)})),this.__fiveEventDisposers.push(this.five.on("currentStateChange",function(Ye,or){De.props.onCurrentStateChange&&De.props.onCurrentStateChange(Ye,or)})),this.__fiveEventDisposers.push(this.five.on("error",function(Ye){De.props.onError?De.props.onError(Ye):console.warn(Ye.message)}));var Ke=this.props.work||this.props.initialWork;Ke&&this.five.load(Ke,this.props.initialState,this.props.initialOptions,(Ve=this.props.initialUserAction)!==null&&Ve!==void 0?Ve:!0)},Be.prototype.componentWillUnmount=function(){var De=this,Ve;(Ve=this.five.controller)===null||Ve===void 0||Ve.destroy();var Fe=this.five.renderer;this.five.renderer=void 0,se$4(Fe),this.setState({renderer:void 0}),this.__fiveDisposeTimer=setTimeout(function(){De.__fiveDisposeTimer=null,De.five.dispose()},1e3)},Be.prototype.render=function(){var De=this.five,Ve=this.loadWork,Fe=this.state.renderer;return reactExports.createElement(L$p.Provider,{value:{renderer:Fe,five:De,loadWork:Ve}},this.props.children)},Be}(reactExports.Component)}var fe$6=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,le$2={display:"inline-block",overflow:"hidden"},Ae$3=function($e){var Se=$e.width,Be=$e.height,De=p$C(),Ve=reactExports.createRef(),Fe=g$C({width:Se,height:Be},le$2);return fe$6(function(){var Je=Ve.current;if(Je&&De.renderer){var Xe=De.renderer.domElement;if(Xe.parentNode!==null&&Xe.parentNode!==Je)throw new Error("There are more than 2 fiveCanvas in this context.");return Xe.parentNode!==Je&&Je.appendChild(Xe),De.camera.aspect=Se/Be,De.camera.updateProjectionMatrix(),De.renderer.setSize(Se,Be),De.refresh({width:Se,height:Be}),De.needsRender=!0,function(){Xe.parentNode===Je&&Je.removeChild(Xe)}}},[De,De.renderer,Se,Be,Ve.current]),reactExports.createElement("div",{ref:Ve,style:Fe})};function Ie$2(){return p$C()}var classnames={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,function($e){(function(){var Se={}.hasOwnProperty;function Be(){for(var De=[],Ve=0;Ve<arguments.length;Ve++){var Fe=arguments[Ve];if(Fe){var Je=typeof Fe;if(Je==="string"||Je==="number")De.push(Fe);else if(Array.isArray(Fe)){if(Fe.length){var Xe=Be.apply(null,Fe);Xe&&De.push(Xe)}}else if(Je==="object")if(Fe.toString===Object.prototype.toString)for(var Ke in Fe)Se.call(Fe,Ke)&&Fe[Ke]&&De.push(Ke);else De.push(Fe.toString())}}return De.join(" ")}$e.exports?(Be.default=Be,$e.exports=Be):window.classNames=Be})()}(classnames)),classnames.exports}var classnamesExports=requireClassnames();const classNames=getDefaultExportFromCjs(classnamesExports);function die($e){for(var Se=arguments.length,Be=new Array(Se>1?Se-1:0),De=1;De<Se;De++)Be[De-1]=arguments[De];throw new Error(typeof $e=="number"?"[MobX] minified error nr: "+$e+(Be.length?" "+Be.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+$e)}var mockGlobal={};function getGlobal(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:mockGlobal}var assign=Object.assign,getDescriptor=Object.getOwnPropertyDescriptor,defineProperty=Object.defineProperty,objectPrototype=Object.prototype,EMPTY_ARRAY=[];Object.freeze(EMPTY_ARRAY);var EMPTY_OBJECT={};Object.freeze(EMPTY_OBJECT);var hasProxy=typeof Proxy<"u",plainObjectString=Object.toString();function assertProxies(){hasProxy||die("Proxy not available")}function once($e){var Se=!1;return function(){if(!Se)return Se=!0,$e.apply(this,arguments)}}var noop=function $e(){};function isFunction($e){return typeof $e=="function"}function isStringish($e){var Se=typeof $e;switch(Se){case"string":case"symbol":case"number":return!0}return!1}function isObject($e){return $e!==null&&typeof $e=="object"}function isPlainObject($e){if(!isObject($e))return!1;var Se=Object.getPrototypeOf($e);if(Se==null)return!0;var Be=Object.hasOwnProperty.call(Se,"constructor")&&Se.constructor;return typeof Be=="function"&&Be.toString()===plainObjectString}function isGenerator($e){var Se=$e?.constructor;return Se?Se.name==="GeneratorFunction"||Se.displayName==="GeneratorFunction":!1}function addHiddenProp($e,Se,Be){defineProperty($e,Se,{enumerable:!1,writable:!0,configurable:!0,value:Be})}function addHiddenFinalProp($e,Se,Be){defineProperty($e,Se,{enumerable:!1,writable:!1,configurable:!0,value:Be})}function createInstanceofPredicate($e,Se){var Be="isMobX"+$e;return Se.prototype[Be]=!0,function(De){return isObject(De)&&De[Be]===!0}}function isES6Map($e){return $e instanceof Map}function isES6Set($e){return $e instanceof Set}var hasGetOwnPropertySymbols=typeof Object.getOwnPropertySymbols<"u";function getPlainObjectKeys($e){var Se=Object.keys($e);if(!hasGetOwnPropertySymbols)return Se;var Be=Object.getOwnPropertySymbols($e);return Be.length?[].concat(Se,Be.filter(function(De){return objectPrototype.propertyIsEnumerable.call($e,De)})):Se}var ownKeys=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:hasGetOwnPropertySymbols?function($e){return Object.getOwnPropertyNames($e).concat(Object.getOwnPropertySymbols($e))}:Object.getOwnPropertyNames;function toPrimitive($e){return $e===null?null:typeof $e=="object"?""+$e:$e}function hasProp($e,Se){return objectPrototype.hasOwnProperty.call($e,Se)}var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function $e(Se){var Be={};return ownKeys(Se).forEach(function(De){Be[De]=getDescriptor(Se,De)}),Be};function _defineProperties($e,Se){for(var Be=0;Be<Se.length;Be++){var De=Se[Be];De.enumerable=De.enumerable||!1,De.configurable=!0,"value"in De&&(De.writable=!0),Object.defineProperty($e,De.key,De)}}function _createClass($e,Se,Be){return Se&&_defineProperties($e.prototype,Se),Object.defineProperty($e,"prototype",{writable:!1}),$e}function _extends(){return _extends=Object.assign||function($e){for(var Se=1;Se<arguments.length;Se++){var Be=arguments[Se];for(var De in Be)Object.prototype.hasOwnProperty.call(Be,De)&&($e[De]=Be[De])}return $e},_extends.apply(this,arguments)}function _inheritsLoose($e,Se){$e.prototype=Object.create(Se.prototype),$e.prototype.constructor=$e,_setPrototypeOf($e,Se)}function _setPrototypeOf($e,Se){return _setPrototypeOf=Object.setPrototypeOf||function(De,Ve){return De.__proto__=Ve,De},_setPrototypeOf($e,Se)}function _assertThisInitialized($e){if($e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $e}function _unsupportedIterableToArray($e,Se){if($e){if(typeof $e=="string")return _arrayLikeToArray($e,Se);var Be=Object.prototype.toString.call($e).slice(8,-1);if(Be==="Object"&&$e.constructor&&(Be=$e.constructor.name),Be==="Map"||Be==="Set")return Array.from($e);if(Be==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Be))return _arrayLikeToArray($e,Se)}}function _arrayLikeToArray($e,Se){(Se==null||Se>$e.length)&&(Se=$e.length);for(var Be=0,De=new Array(Se);Be<Se;Be++)De[Be]=$e[Be];return De}function _createForOfIteratorHelperLoose($e,Se){var Be=typeof Symbol<"u"&&$e[Symbol.iterator]||$e["@@iterator"];if(Be)return(Be=Be.call($e)).next.bind(Be);if(Array.isArray($e)||(Be=_unsupportedIterableToArray($e))||Se){Be&&($e=Be);var De=0;return function(){return De>=$e.length?{done:!0}:{done:!1,value:$e[De++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var storedAnnotationsSymbol=Symbol("mobx-stored-annotations");function createDecoratorAnnotation($e){function Se(Be,De){storeAnnotation(Be,De,$e)}return Object.assign(Se,$e)}function storeAnnotation($e,Se,Be){hasProp($e,storedAnnotationsSymbol)||addHiddenProp($e,storedAnnotationsSymbol,_extends({},$e[storedAnnotationsSymbol])),isOverride(Be)||($e[storedAnnotationsSymbol][Se]=Be)}function collectStoredAnnotations($e){return hasProp($e,storedAnnotationsSymbol)||addHiddenProp($e,storedAnnotationsSymbol,_extends({},$e[storedAnnotationsSymbol])),$e[storedAnnotationsSymbol]}var $mobx=Symbol("mobx administration"),Atom=function(){function $e(Be){Be===void 0&&(Be="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=IDerivationState_.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=Be}var Se=$e.prototype;return Se.onBO=function(){this.onBOL&&this.onBOL.forEach(function(De){return De()})},Se.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(De){return De()})},Se.reportObserved=function(){return reportObserved(this)},Se.reportChanged=function(){startBatch(),propagateChanged(this),endBatch()},Se.toString=function(){return this.name_},$e}(),isAtom=createInstanceofPredicate("Atom",Atom);function createAtom($e,Se,Be){Se===void 0&&(Se=noop),Be===void 0&&(Be=noop);var De=new Atom($e);return Se!==noop&&onBecomeObserved(De,Se),Be!==noop&&onBecomeUnobserved(De,Be),De}function structuralComparer($e,Se){return deepEqual($e,Se)}function defaultComparer($e,Se){return Object.is?Object.is($e,Se):$e===Se?$e!==0||1/$e===1/Se:$e!==$e&&Se!==Se}var comparer={structural:structuralComparer,default:defaultComparer};function deepEnhancer($e,Se,Be){return isObservable($e)?$e:Array.isArray($e)?observable.array($e,{name:Be}):isPlainObject($e)?observable.object($e,void 0,{name:Be}):isES6Map($e)?observable.map($e,{name:Be}):isES6Set($e)?observable.set($e,{name:Be}):typeof $e=="function"&&!isAction($e)&&!isFlow($e)?isGenerator($e)?flow($e):autoAction(Be,$e):$e}function shallowEnhancer($e,Se,Be){if($e==null||isObservableObject($e)||isObservableArray($e)||isObservableMap($e)||isObservableSet($e))return $e;if(Array.isArray($e))return observable.array($e,{name:Be,deep:!1});if(isPlainObject($e))return observable.object($e,void 0,{name:Be,deep:!1});if(isES6Map($e))return observable.map($e,{name:Be,deep:!1});if(isES6Set($e))return observable.set($e,{name:Be,deep:!1})}function referenceEnhancer($e){return $e}function refStructEnhancer($e,Se){return deepEqual($e,Se)?Se:$e}var OVERRIDE="override";function isOverride($e){return $e.annotationType_===OVERRIDE}function createActionAnnotation($e,Se){return{annotationType_:$e,options_:Se,make_:make_$1,extend_:extend_$1}}function make_$1($e,Se,Be,De){var Ve;if((Ve=this.options_)!=null&&Ve.bound)return this.extend_($e,Se,Be,!1)===null?0:1;if(De===$e.target_)return this.extend_($e,Se,Be,!1)===null?0:2;if(isAction(Be.value))return 1;var Fe=createActionDescriptor($e,this,Se,Be,!1);return defineProperty(De,Se,Fe),2}function extend_$1($e,Se,Be,De){var Ve=createActionDescriptor($e,this,Se,Be);return $e.defineProperty_(Se,Ve,De)}function assertActionDescriptor($e,Se,Be,De){Se.annotationType_,De.value}function createActionDescriptor($e,Se,Be,De,Ve){var Fe,Je,Xe,Ke,Ye,or,sr;Ve===void 0&&(Ve=globalState.safeDescriptors),assertActionDescriptor($e,Se,Be,De);var cr=De.value;if((Fe=Se.options_)!=null&&Fe.bound){var Br;cr=cr.bind((Br=$e.proxy_)!=null?Br:$e.target_)}return{value:createAction((Je=(Xe=Se.options_)==null?void 0:Xe.name)!=null?Je:Be.toString(),cr,(Ke=(Ye=Se.options_)==null?void 0:Ye.autoAction)!=null?Ke:!1,(or=Se.options_)!=null&&or.bound?(sr=$e.proxy_)!=null?sr:$e.target_:void 0),configurable:Ve?$e.isPlainObject_:!0,enumerable:!1,writable:!Ve}}function createFlowAnnotation($e,Se){return{annotationType_:$e,options_:Se,make_:make_$2,extend_:extend_$2}}function make_$2($e,Se,Be,De){var Ve;if(De===$e.target_)return this.extend_($e,Se,Be,!1)===null?0:2;if((Ve=this.options_)!=null&&Ve.bound&&(!hasProp($e.target_,Se)||!isFlow($e.target_[Se]))&&this.extend_($e,Se,Be,!1)===null)return 0;if(isFlow(Be.value))return 1;var Fe=createFlowDescriptor($e,this,Se,Be,!1,!1);return defineProperty(De,Se,Fe),2}function extend_$2($e,Se,Be,De){var Ve,Fe=createFlowDescriptor($e,this,Se,Be,(Ve=this.options_)==null?void 0:Ve.bound);return $e.defineProperty_(Se,Fe,De)}function assertFlowDescriptor($e,Se,Be,De){Se.annotationType_,De.value}function createFlowDescriptor($e,Se,Be,De,Ve,Fe){Fe===void 0&&(Fe=globalState.safeDescriptors),assertFlowDescriptor($e,Se,Be,De);var Je=De.value;if(isFlow(Je)||(Je=flow(Je)),Ve){var Xe;Je=Je.bind((Xe=$e.proxy_)!=null?Xe:$e.target_),Je.isMobXFlow=!0}return{value:Je,configurable:Fe?$e.isPlainObject_:!0,enumerable:!1,writable:!Fe}}function createComputedAnnotation($e,Se){return{annotationType_:$e,options_:Se,make_:make_$3,extend_:extend_$3}}function make_$3($e,Se,Be){return this.extend_($e,Se,Be,!1)===null?0:1}function extend_$3($e,Se,Be,De){return assertComputedDescriptor($e,this,Se,Be),$e.defineComputedProperty_(Se,_extends({},this.options_,{get:Be.get,set:Be.set}),De)}function assertComputedDescriptor($e,Se,Be,De){Se.annotationType_,De.get}function createObservableAnnotation($e,Se){return{annotationType_:$e,options_:Se,make_:make_$4,extend_:extend_$4}}function make_$4($e,Se,Be){return this.extend_($e,Se,Be,!1)===null?0:1}function extend_$4($e,Se,Be,De){var Ve,Fe;return assertObservableDescriptor($e,this),$e.defineObservableProperty_(Se,Be.value,(Ve=(Fe=this.options_)==null?void 0:Fe.enhancer)!=null?Ve:deepEnhancer,De)}function assertObservableDescriptor($e,Se,Be,De){Se.annotationType_}var AUTO="true",autoAnnotation=createAutoAnnotation();function createAutoAnnotation($e){return{annotationType_:AUTO,options_:$e,make_:make_$5,extend_:extend_$5}}function make_$5($e,Se,Be,De){var Ve,Fe;if(Be.get)return computed.make_($e,Se,Be,De);if(Be.set){var Je=createAction(Se.toString(),Be.set);return De===$e.target_?$e.defineProperty_(Se,{configurable:globalState.safeDescriptors?$e.isPlainObject_:!0,set:Je})===null?0:2:(defineProperty(De,Se,{configurable:!0,set:Je}),2)}if(De!==$e.target_&&typeof Be.value=="function"){var Xe;if(isGenerator(Be.value)){var Ke,Ye=(Ke=this.options_)!=null&&Ke.autoBind?flow.bound:flow;return Ye.make_($e,Se,Be,De)}var or=(Xe=this.options_)!=null&&Xe.autoBind?autoAction.bound:autoAction;return or.make_($e,Se,Be,De)}var sr=((Ve=this.options_)==null?void 0:Ve.deep)===!1?observable.ref:observable;if(typeof Be.value=="function"&&(Fe=this.options_)!=null&&Fe.autoBind){var cr;Be.value=Be.value.bind((cr=$e.proxy_)!=null?cr:$e.target_)}return sr.make_($e,Se,Be,De)}function extend_$5($e,Se,Be,De){var Ve,Fe;if(Be.get)return computed.extend_($e,Se,Be,De);if(Be.set)return $e.defineProperty_(Se,{configurable:globalState.safeDescriptors?$e.isPlainObject_:!0,set:createAction(Se.toString(),Be.set)},De);if(typeof Be.value=="function"&&(Ve=this.options_)!=null&&Ve.autoBind){var Je;Be.value=Be.value.bind((Je=$e.proxy_)!=null?Je:$e.target_)}var Xe=((Fe=this.options_)==null?void 0:Fe.deep)===!1?observable.ref:observable;return Xe.extend_($e,Se,Be,De)}var OBSERVABLE="observable",OBSERVABLE_REF="observable.ref",OBSERVABLE_SHALLOW="observable.shallow",OBSERVABLE_STRUCT="observable.struct",defaultCreateObservableOptions={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(defaultCreateObservableOptions);function asCreateObservableOptions($e){return $e||defaultCreateObservableOptions}var observableAnnotation=createObservableAnnotation(OBSERVABLE),observableRefAnnotation=createObservableAnnotation(OBSERVABLE_REF,{enhancer:referenceEnhancer}),observableShallowAnnotation=createObservableAnnotation(OBSERVABLE_SHALLOW,{enhancer:shallowEnhancer}),observableStructAnnotation=createObservableAnnotation(OBSERVABLE_STRUCT,{enhancer:refStructEnhancer}),observableDecoratorAnnotation=createDecoratorAnnotation(observableAnnotation);function getEnhancerFromOptions($e){return $e.deep===!0?deepEnhancer:$e.deep===!1?referenceEnhancer:getEnhancerFromAnnotation($e.defaultDecorator)}function getAnnotationFromOptions($e){var Se;return $e?(Se=$e.defaultDecorator)!=null?Se:createAutoAnnotation($e):void 0}function getEnhancerFromAnnotation($e){var Se,Be;return $e&&(Se=(Be=$e.options_)==null?void 0:Be.enhancer)!=null?Se:deepEnhancer}function createObservable($e,Se,Be){if(isStringish(Se)){storeAnnotation($e,Se,observableAnnotation);return}return isObservable($e)?$e:isPlainObject($e)?observable.object($e,Se,Be):Array.isArray($e)?observable.array($e,Se):isES6Map($e)?observable.map($e,Se):isES6Set($e)?observable.set($e,Se):typeof $e=="object"&&$e!==null?$e:observable.box($e,Se)}Object.assign(createObservable,observableDecoratorAnnotation);var observableFactories={box:function $e(Se,Be){var De=asCreateObservableOptions(Be);return new ObservableValue(Se,getEnhancerFromOptions(De),De.name,!0,De.equals)},array:function $e(Se,Be){var De=asCreateObservableOptions(Be);return(globalState.useProxies===!1||De.proxy===!1?createLegacyArray:createObservableArray)(Se,getEnhancerFromOptions(De),De.name)},map:function $e(Se,Be){var De=asCreateObservableOptions(Be);return new ObservableMap(Se,getEnhancerFromOptions(De),De.name)},set:function $e(Se,Be){var De=asCreateObservableOptions(Be);return new ObservableSet(Se,getEnhancerFromOptions(De),De.name)},object:function $e(Se,Be,De){return extendObservable(globalState.useProxies===!1||De?.proxy===!1?asObservableObject({},De):asDynamicObservableObject({},De),Se,Be)},ref:createDecoratorAnnotation(observableRefAnnotation),shallow:createDecoratorAnnotation(observableShallowAnnotation),deep:observableDecoratorAnnotation,struct:createDecoratorAnnotation(observableStructAnnotation)},observable=assign(createObservable,observableFactories),COMPUTED="computed",COMPUTED_STRUCT="computed.struct",computedAnnotation=createComputedAnnotation(COMPUTED),computedStructAnnotation=createComputedAnnotation(COMPUTED_STRUCT,{equals:comparer.structural}),computed=function $e(Se,Be){if(isStringish(Be))return storeAnnotation(Se,Be,computedAnnotation);if(isPlainObject(Se))return createDecoratorAnnotation(createComputedAnnotation(COMPUTED,Se));var De=isPlainObject(Be)?Be:{};return De.get=Se,De.name||(De.name=Se.name||""),new ComputedValue(De)};Object.assign(computed,computedAnnotation);computed.struct=createDecoratorAnnotation(computedStructAnnotation);var _getDescriptor$config,_getDescriptor,currentActionId=0,nextActionId=1,isFunctionNameConfigurable=(_getDescriptor$config=(_getDescriptor=getDescriptor(function(){},"name"))==null?void 0:_getDescriptor.configurable)!=null?_getDescriptor$config:!1,tmpNameDescriptor={value:"action",configurable:!0,writable:!1,enumerable:!1};function createAction($e,Se,Be,De){Be===void 0&&(Be=!1);function Ve(){return executeAction($e,Be,Se,De||this,arguments)}return Ve.isMobxAction=!0,isFunctionNameConfigurable&&(tmpNameDescriptor.value=$e,Object.defineProperty(Ve,"name",tmpNameDescriptor)),Ve}function executeAction($e,Se,Be,De,Ve){var Fe=_startAction($e,Se);try{return Be.apply(De,Ve)}catch(Je){throw Fe.error_=Je,Je}finally{_endAction(Fe)}}function _startAction($e,Se,Be,De){var Ve=!1,Fe=0,Je=globalState.trackingDerivation,Xe=!Se||!Je;startBatch();var Ke=globalState.allowStateChanges;Xe&&(untrackedStart(),Ke=allowStateChangesStart(!0));var Ye=allowStateReadsStart(!0),or={runAsAction_:Xe,prevDerivation_:Je,prevAllowStateChanges_:Ke,prevAllowStateReads_:Ye,notifySpy_:Ve,startTime_:Fe,actionId_:nextActionId++,parentActionId_:currentActionId};return currentActionId=or.actionId_,or}function _endAction($e){currentActionId!==$e.actionId_&&die(30),currentActionId=$e.parentActionId_,$e.error_!==void 0&&(globalState.suppressReactionErrors=!0),allowStateChangesEnd($e.prevAllowStateChanges_),allowStateReadsEnd($e.prevAllowStateReads_),endBatch(),$e.runAsAction_&&untrackedEnd($e.prevDerivation_),globalState.suppressReactionErrors=!1}function allowStateChanges($e,Se){var Be=allowStateChangesStart($e);try{return Se()}finally{allowStateChangesEnd(Be)}}function allowStateChangesStart($e){var Se=globalState.allowStateChanges;return globalState.allowStateChanges=$e,Se}function allowStateChangesEnd($e){globalState.allowStateChanges=$e}var _Symbol$toPrimitive;_Symbol$toPrimitive=Symbol.toPrimitive;var ObservableValue=function($e,Se){_inheritsLoose(Be,$e);function Be(Ve,Fe,Je,Xe,Ke){var Ye;return Je===void 0&&(Je="ObservableValue"),Ke===void 0&&(Ke=comparer.default),Ye=$e.call(this,Je)||this,Ye.enhancer=void 0,Ye.name_=void 0,Ye.equals=void 0,Ye.hasUnreportedChange_=!1,Ye.interceptors_=void 0,Ye.changeListeners_=void 0,Ye.value_=void 0,Ye.dehancer=void 0,Ye.enhancer=Fe,Ye.name_=Je,Ye.equals=Ke,Ye.value_=Fe(Ve,void 0,Je),Ye}var De=Be.prototype;return De.dehanceValue=function(Fe){return this.dehancer!==void 0?this.dehancer(Fe):Fe},De.set=function(Fe){this.value_,Fe=this.prepareNewValue_(Fe),Fe!==globalState.UNCHANGED&&this.setNewValue_(Fe)},De.prepareNewValue_=function(Fe){if(hasInterceptors(this)){var Je=interceptChange(this,{object:this,type:UPDATE,newValue:Fe});if(!Je)return globalState.UNCHANGED;Fe=Je.newValue}return Fe=this.enhancer(Fe,this.value_,this.name_),this.equals(this.value_,Fe)?globalState.UNCHANGED:Fe},De.setNewValue_=function(Fe){var Je=this.value_;this.value_=Fe,this.reportChanged(),hasListeners(this)&&notifyListeners(this,{type:UPDATE,object:this,newValue:Fe,oldValue:Je})},De.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},De.intercept_=function(Fe){return registerInterceptor(this,Fe)},De.observe_=function(Fe,Je){return Je&&Fe({observableKind:"value",debugObjectName:this.name_,object:this,type:UPDATE,newValue:this.value_,oldValue:void 0}),registerListener(this,Fe)},De.raw=function(){return this.value_},De.toJSON=function(){return this.get()},De.toString=function(){return this.name_+"["+this.value_+"]"},De.valueOf=function(){return toPrimitive(this.get())},De[Se]=function(){return this.valueOf()},Be}(Atom,_Symbol$toPrimitive),_Symbol$toPrimitive$1;_Symbol$toPrimitive$1=Symbol.toPrimitive;var ComputedValue=function($e){function Se(De){this.dependenciesState_=IDerivationState_.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=IDerivationState_.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new CaughtException(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=TraceMode.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,De.get||die(31),this.derivation=De.get,this.name_=De.name||"ComputedValue",De.set&&(this.setter_=createAction("ComputedValue-setter",De.set)),this.equals_=De.equals||(De.compareStructural||De.struct?comparer.structural:comparer.default),this.scope_=De.context,this.requiresReaction_=De.requiresReaction,this.keepAlive_=!!De.keepAlive}var Be=Se.prototype;return Be.onBecomeStale_=function(){propagateMaybeChanged(this)},Be.onBO=function(){this.onBOL&&this.onBOL.forEach(function(Ve){return Ve()})},Be.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(Ve){return Ve()})},Be.get=function(){if(this.isComputing_&&die(32,this.name_,this.derivation),globalState.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)shouldCompute(this)&&(this.warnAboutUntrackedRead_(),startBatch(),this.value_=this.computeValue_(!1),endBatch());else if(reportObserved(this),shouldCompute(this)){var Ve=globalState.trackingContext;this.keepAlive_&&!Ve&&(globalState.trackingContext=this),this.trackAndCompute()&&propagateChangeConfirmed(this),globalState.trackingContext=Ve}var Fe=this.value_;if(isCaughtException(Fe))throw Fe.cause;return Fe},Be.set=function(Ve){if(this.setter_){this.isRunningSetter_&&die(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,Ve)}finally{this.isRunningSetter_=!1}}else die(34,this.name_)},Be.trackAndCompute=function(){var Ve=this.value_,Fe=this.dependenciesState_===IDerivationState_.NOT_TRACKING_,Je=this.computeValue_(!0),Xe=Fe||isCaughtException(Ve)||isCaughtException(Je)||!this.equals_(Ve,Je);return Xe&&(this.value_=Je),Xe},Be.computeValue_=function(Ve){this.isComputing_=!0;var Fe=allowStateChangesStart(!1),Je;if(Ve)Je=trackDerivedFunction(this,this.derivation,this.scope_);else if(globalState.disableErrorBoundaries===!0)Je=this.derivation.call(this.scope_);else try{Je=this.derivation.call(this.scope_)}catch(Xe){Je=new CaughtException(Xe)}return allowStateChangesEnd(Fe),this.isComputing_=!1,Je},Be.suspend_=function(){this.keepAlive_||(clearObserving(this),this.value_=void 0)},Be.observe_=function(Ve,Fe){var Je=this,Xe=!0,Ke=void 0;return autorun(function(){var Ye=Je.get();if(!Xe||Fe){var or=untrackedStart();Ve({observableKind:"computed",debugObjectName:Je.name_,type:UPDATE,object:Je,newValue:Ye,oldValue:Ke}),untrackedEnd(or)}Xe=!1,Ke=Ye})},Be.warnAboutUntrackedRead_=function(){},Be.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},Be.valueOf=function(){return toPrimitive(this.get())},Be[$e]=function(){return this.valueOf()},Se}(_Symbol$toPrimitive$1),isComputedValue=createInstanceofPredicate("ComputedValue",ComputedValue),IDerivationState_;(function($e){$e[$e.NOT_TRACKING_=-1]="NOT_TRACKING_",$e[$e.UP_TO_DATE_=0]="UP_TO_DATE_",$e[$e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",$e[$e.STALE_=2]="STALE_"})(IDerivationState_||(IDerivationState_={}));var TraceMode;(function($e){$e[$e.NONE=0]="NONE",$e[$e.LOG=1]="LOG",$e[$e.BREAK=2]="BREAK"})(TraceMode||(TraceMode={}));var CaughtException=function $e(Se){this.cause=void 0,this.cause=Se};function isCaughtException($e){return $e instanceof CaughtException}function shouldCompute($e){switch($e.dependenciesState_){case IDerivationState_.UP_TO_DATE_:return!1;case IDerivationState_.NOT_TRACKING_:case IDerivationState_.STALE_:return!0;case IDerivationState_.POSSIBLY_STALE_:{for(var Se=allowStateReadsStart(!0),Be=untrackedStart(),De=$e.observing_,Ve=De.length,Fe=0;Fe<Ve;Fe++){var Je=De[Fe];if(isComputedValue(Je)){if(globalState.disableErrorBoundaries)Je.get();else try{Je.get()}catch{return untrackedEnd(Be),allowStateReadsEnd(Se),!0}if($e.dependenciesState_===IDerivationState_.STALE_)return untrackedEnd(Be),allowStateReadsEnd(Se),!0}}return changeDependenciesStateTo0($e),untrackedEnd(Be),allowStateReadsEnd(Se),!1}}}function checkIfStateModificationsAreAllowed($e){}function trackDerivedFunction($e,Se,Be){var De=allowStateReadsStart(!0);changeDependenciesStateTo0($e),$e.newObserving_=new Array($e.observing_.length+100),$e.unboundDepsCount_=0,$e.runId_=++globalState.runId;var Ve=globalState.trackingDerivation;globalState.trackingDerivation=$e,globalState.inBatch++;var Fe;if(globalState.disableErrorBoundaries===!0)Fe=Se.call(Be);else try{Fe=Se.call(Be)}catch(Je){Fe=new CaughtException(Je)}return globalState.inBatch--,globalState.trackingDerivation=Ve,bindDependencies($e),allowStateReadsEnd(De),Fe}function bindDependencies($e){for(var Se=$e.observing_,Be=$e.observing_=$e.newObserving_,De=IDerivationState_.UP_TO_DATE_,Ve=0,Fe=$e.unboundDepsCount_,Je=0;Je<Fe;Je++){var Xe=Be[Je];Xe.diffValue_===0&&(Xe.diffValue_=1,Ve!==Je&&(Be[Ve]=Xe),Ve++),Xe.dependenciesState_>De&&(De=Xe.dependenciesState_)}for(Be.length=Ve,$e.newObserving_=null,Fe=Se.length;Fe--;){var Ke=Se[Fe];Ke.diffValue_===0&&removeObserver(Ke,$e),Ke.diffValue_=0}for(;Ve--;){var Ye=Be[Ve];Ye.diffValue_===1&&(Ye.diffValue_=0,addObserver(Ye,$e))}De!==IDerivationState_.UP_TO_DATE_&&($e.dependenciesState_=De,$e.onBecomeStale_())}function clearObserving($e){var Se=$e.observing_;$e.observing_=[];for(var Be=Se.length;Be--;)removeObserver(Se[Be],$e);$e.dependenciesState_=IDerivationState_.NOT_TRACKING_}function untracked($e){var Se=untrackedStart();try{return $e()}finally{untrackedEnd(Se)}}function untrackedStart(){var $e=globalState.trackingDerivation;return globalState.trackingDerivation=null,$e}function untrackedEnd($e){globalState.trackingDerivation=$e}function allowStateReadsStart($e){var Se=globalState.allowStateReads;return globalState.allowStateReads=$e,Se}function allowStateReadsEnd($e){globalState.allowStateReads=$e}function changeDependenciesStateTo0($e){if($e.dependenciesState_!==IDerivationState_.UP_TO_DATE_){$e.dependenciesState_=IDerivationState_.UP_TO_DATE_;for(var Se=$e.observing_,Be=Se.length;Be--;)Se[Be].lowestObserverState_=IDerivationState_.UP_TO_DATE_}}var MobXGlobals=function $e(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},canMergeGlobalState=!0,isolateCalled=!1,globalState=function(){var $e=getGlobal();return $e.__mobxInstanceCount>0&&!$e.__mobxGlobals&&(canMergeGlobalState=!1),$e.__mobxGlobals&&$e.__mobxGlobals.version!==new MobXGlobals().version&&(canMergeGlobalState=!1),canMergeGlobalState?$e.__mobxGlobals?($e.__mobxInstanceCount+=1,$e.__mobxGlobals.UNCHANGED||($e.__mobxGlobals.UNCHANGED={}),$e.__mobxGlobals):($e.__mobxInstanceCount=1,$e.__mobxGlobals=new MobXGlobals):(setTimeout(function(){isolateCalled||die(35)},1),new MobXGlobals)}();function isolateGlobalState(){if((globalState.pendingReactions.length||globalState.inBatch||globalState.isRunningReactions)&&die(36),isolateCalled=!0,canMergeGlobalState){var $e=getGlobal();--$e.__mobxInstanceCount===0&&($e.__mobxGlobals=void 0),globalState=new MobXGlobals}}function addObserver($e,Se){$e.observers_.add(Se),$e.lowestObserverState_>Se.dependenciesState_&&($e.lowestObserverState_=Se.dependenciesState_)}function removeObserver($e,Se){$e.observers_.delete(Se),$e.observers_.size===0&&queueForUnobservation($e)}function queueForUnobservation($e){$e.isPendingUnobservation_===!1&&($e.isPendingUnobservation_=!0,globalState.pendingUnobservations.push($e))}function startBatch(){globalState.inBatch++}function endBatch(){if(--globalState.inBatch===0){runReactions();for(var $e=globalState.pendingUnobservations,Se=0;Se<$e.length;Se++){var Be=$e[Se];Be.isPendingUnobservation_=!1,Be.observers_.size===0&&(Be.isBeingObserved_&&(Be.isBeingObserved_=!1,Be.onBUO()),Be instanceof ComputedValue&&Be.suspend_())}globalState.pendingUnobservations=[]}}function reportObserved($e){var Se=globalState.trackingDerivation;return Se!==null?(Se.runId_!==$e.lastAccessedBy_&&($e.lastAccessedBy_=Se.runId_,Se.newObserving_[Se.unboundDepsCount_++]=$e,!$e.isBeingObserved_&&globalState.trackingContext&&($e.isBeingObserved_=!0,$e.onBO())),!0):($e.observers_.size===0&&globalState.inBatch>0&&queueForUnobservation($e),!1)}function propagateChanged($e){$e.lowestObserverState_!==IDerivationState_.STALE_&&($e.lowestObserverState_=IDerivationState_.STALE_,$e.observers_.forEach(function(Se){Se.dependenciesState_===IDerivationState_.UP_TO_DATE_&&Se.onBecomeStale_(),Se.dependenciesState_=IDerivationState_.STALE_}))}function propagateChangeConfirmed($e){$e.lowestObserverState_!==IDerivationState_.STALE_&&($e.lowestObserverState_=IDerivationState_.STALE_,$e.observers_.forEach(function(Se){Se.dependenciesState_===IDerivationState_.POSSIBLY_STALE_?Se.dependenciesState_=IDerivationState_.STALE_:Se.dependenciesState_===IDerivationState_.UP_TO_DATE_&&($e.lowestObserverState_=IDerivationState_.UP_TO_DATE_)}))}function propagateMaybeChanged($e){$e.lowestObserverState_===IDerivationState_.UP_TO_DATE_&&($e.lowestObserverState_=IDerivationState_.POSSIBLY_STALE_,$e.observers_.forEach(function(Se){Se.dependenciesState_===IDerivationState_.UP_TO_DATE_&&(Se.dependenciesState_=IDerivationState_.POSSIBLY_STALE_,Se.onBecomeStale_())}))}var Reaction=function(){function $e(Be,De,Ve,Fe){Be===void 0&&(Be="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=IDerivationState_.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=TraceMode.NONE,this.name_=Be,this.onInvalidate_=De,this.errorHandler_=Ve,this.requiresObservable_=Fe}var Se=$e.prototype;return Se.onBecomeStale_=function(){this.schedule_()},Se.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,globalState.pendingReactions.push(this),runReactions())},Se.isScheduled=function(){return this.isScheduled_},Se.runReaction_=function(){if(!this.isDisposed_){startBatch(),this.isScheduled_=!1;var De=globalState.trackingContext;if(globalState.trackingContext=this,shouldCompute(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(Ve){this.reportExceptionInDerivation_(Ve)}}globalState.trackingContext=De,endBatch()}},Se.track=function(De){if(!this.isDisposed_){startBatch(),this.isRunning_=!0;var Ve=globalState.trackingContext;globalState.trackingContext=this;var Fe=trackDerivedFunction(this,De,void 0);globalState.trackingContext=Ve,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&clearObserving(this),isCaughtException(Fe)&&this.reportExceptionInDerivation_(Fe.cause),endBatch()}},Se.reportExceptionInDerivation_=function(De){var Ve=this;if(this.errorHandler_){this.errorHandler_(De,this);return}if(globalState.disableErrorBoundaries)throw De;var Fe="[mobx] uncaught error in '"+this+"'";globalState.suppressReactionErrors||console.error(Fe,De),globalState.globalReactionErrorHandlers.forEach(function(Je){return Je(De,Ve)})},Se.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(startBatch(),clearObserving(this),endBatch()))},Se.getDisposer_=function(){var De=this.dispose.bind(this);return De[$mobx]=this,De},Se.toString=function(){return"Reaction["+this.name_+"]"},Se.trace=function(De){De===void 0&&(De=!1),trace(this,De)},$e}(),MAX_REACTION_ITERATIONS=100,reactionScheduler=function $e(Se){return Se()};function runReactions(){globalState.inBatch>0||globalState.isRunningReactions||reactionScheduler(runReactionsHelper)}function runReactionsHelper(){globalState.isRunningReactions=!0;for(var $e=globalState.pendingReactions,Se=0;$e.length>0;){++Se===MAX_REACTION_ITERATIONS&&(console.error("[mobx] cycle in reaction: "+$e[0]),$e.splice(0));for(var Be=$e.splice(0),De=0,Ve=Be.length;De<Ve;De++)Be[De].runReaction_()}globalState.isRunningReactions=!1}var isReaction=createInstanceofPredicate("Reaction",Reaction);function setReactionScheduler($e){var Se=reactionScheduler;reactionScheduler=function(De){return $e(function(){return Se(De)})}}function isSpyEnabled(){return!1}function spyReport($e){}function spyReportStart($e){}function spyReportEnd($e){}function spy($e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var ACTION="action",ACTION_BOUND="action.bound",AUTOACTION="autoAction",AUTOACTION_BOUND="autoAction.bound",DEFAULT_ACTION_NAME="<unnamed action>",actionAnnotation=createActionAnnotation(ACTION),actionBoundAnnotation=createActionAnnotation(ACTION_BOUND,{bound:!0}),autoActionAnnotation=createActionAnnotation(AUTOACTION,{autoAction:!0}),autoActionBoundAnnotation=createActionAnnotation(AUTOACTION_BOUND,{autoAction:!0,bound:!0});function createActionFactory($e){var Se=function(De,Ve){if(isFunction(De))return createAction(De.name||DEFAULT_ACTION_NAME,De,$e);if(isFunction(Ve))return createAction(De,Ve,$e);if(isStringish(Ve))return storeAnnotation(De,Ve,$e?autoActionAnnotation:actionAnnotation);if(isStringish(De))return createDecoratorAnnotation(createActionAnnotation($e?AUTOACTION:ACTION,{name:De,autoAction:$e}))};return Se}var action=createActionFactory(!1);Object.assign(action,actionAnnotation);var autoAction=createActionFactory(!0);Object.assign(autoAction,autoActionAnnotation);action.bound=createDecoratorAnnotation(actionBoundAnnotation);autoAction.bound=createDecoratorAnnotation(autoActionBoundAnnotation);function runInAction($e){return executeAction($e.name||DEFAULT_ACTION_NAME,!1,$e,this,void 0)}function isAction($e){return isFunction($e)&&$e.isMobxAction===!0}function autorun($e,Se){var Be,De;Se===void 0&&(Se=EMPTY_OBJECT);var Ve=(Be=(De=Se)==null?void 0:De.name)!=null?Be:"Autorun",Fe=!Se.scheduler&&!Se.delay,Je;if(Fe)Je=new Reaction(Ve,function(){this.track(Ye)},Se.onError,Se.requiresObservable);else{var Xe=createSchedulerFromOptions(Se),Ke=!1;Je=new Reaction(Ve,function(){Ke||(Ke=!0,Xe(function(){Ke=!1,Je.isDisposed_||Je.track(Ye)}))},Se.onError,Se.requiresObservable)}function Ye(){$e(Je)}return Je.schedule_(),Je.getDisposer_()}var run=function $e(Se){return Se()};function createSchedulerFromOptions($e){return $e.scheduler?$e.scheduler:$e.delay?function(Se){return setTimeout(Se,$e.delay)}:run}function reaction($e,Se,Be){var De;Be===void 0&&(Be=EMPTY_OBJECT);var Ve=(De=Be.name)!=null?De:"Reaction",Fe=action(Ve,Be.onError?wrapErrorHandler(Be.onError,Se):Se),Je=!Be.scheduler&&!Be.delay,Xe=createSchedulerFromOptions(Be),Ke=!0,Ye=!1,or,sr,cr=Be.compareStructural?comparer.structural:Be.equals||comparer.default,Br=new Reaction(Ve,function(){Ke||Je?tn():Ye||(Ye=!0,Xe(tn))},Be.onError,Be.requiresObservable);function tn(){if(Ye=!1,!Br.isDisposed_){var en=!1;Br.track(function(){var an=allowStateChanges(!1,function(){return $e(Br)});en=Ke||!cr(or,an),sr=or,or=an}),(Ke&&Be.fireImmediately||!Ke&&en)&&Fe(or,sr,Br),Ke=!1}}return Br.schedule_(),Br.getDisposer_()}function wrapErrorHandler($e,Se){return function(){try{return Se.apply(this,arguments)}catch(Be){$e.call(this,Be)}}}var ON_BECOME_OBSERVED="onBO",ON_BECOME_UNOBSERVED="onBUO";function onBecomeObserved($e,Se,Be){return interceptHook(ON_BECOME_OBSERVED,$e,Se,Be)}function onBecomeUnobserved($e,Se,Be){return interceptHook(ON_BECOME_UNOBSERVED,$e,Se,Be)}function interceptHook($e,Se,Be,De){var Ve=getAtom(Se),Fe=isFunction(De)?De:Be,Je=$e+"L";return Ve[Je]?Ve[Je].add(Fe):Ve[Je]=new Set([Fe]),function(){var Xe=Ve[Je];Xe&&(Xe.delete(Fe),Xe.size===0&&delete Ve[Je])}}var NEVER="never",ALWAYS="always",OBSERVED="observed";function configure($e){$e.isolateGlobalState===!0&&isolateGlobalState();var Se=$e.useProxies,Be=$e.enforceActions;if(Se!==void 0&&(globalState.useProxies=Se===ALWAYS?!0:Se===NEVER?!1:typeof Proxy<"u"),Se==="ifavailable"&&(globalState.verifyProxies=!0),Be!==void 0){var De=Be===ALWAYS?ALWAYS:Be===OBSERVED;globalState.enforceActions=De,globalState.allowStateChanges=!(De===!0||De===ALWAYS)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(Ve){Ve in $e&&(globalState[Ve]=!!$e[Ve])}),globalState.allowStateReads=!globalState.observableRequiresReaction,$e.reactionScheduler&&setReactionScheduler($e.reactionScheduler)}function extendObservable($e,Se,Be,De){var Ve=getOwnPropertyDescriptors(Se),Fe=asObservableObject($e,De)[$mobx];startBatch();try{ownKeys(Ve).forEach(function(Je){Fe.extend_(Je,Ve[Je],Be&&Je in Be?Be[Je]:!0)})}finally{endBatch()}return $e}function getDependencyTree($e,Se){return nodeToDependencyTree(getAtom($e,Se))}function nodeToDependencyTree($e){var Se={name:$e.name_};return $e.observing_&&$e.observing_.length>0&&(Se.dependencies=unique($e.observing_).map(nodeToDependencyTree)),Se}function unique($e){return Array.from(new Set($e))}var generatorId=0;function FlowCancellationError(){this.message="FLOW_CANCELLED"}FlowCancellationError.prototype=Object.create(Error.prototype);var flowAnnotation=createFlowAnnotation("flow"),flowBoundAnnotation=createFlowAnnotation("flow.bound",{bound:!0}),flow=Object.assign(function $e(Se,Be){if(isStringish(Be))return storeAnnotation(Se,Be,flowAnnotation);var De=Se,Ve=De.name||"<unnamed flow>",Fe=function(){var Xe=this,Ke=arguments,Ye=++generatorId,or=action(Ve+" - runid: "+Ye+" - init",De).apply(Xe,Ke),sr,cr=void 0,Br=new Promise(function(tn,en){var an=0;sr=en;function rn(ln){cr=void 0;var cn;try{cn=action(Ve+" - runid: "+Ye+" - yield "+an++,or.next).call(or,ln)}catch(hn){return en(hn)}sn(cn)}function on(ln){cr=void 0;var cn;try{cn=action(Ve+" - runid: "+Ye+" - yield "+an++,or.throw).call(or,ln)}catch(hn){return en(hn)}sn(cn)}function sn(ln){if(isFunction(ln?.then)){ln.then(sn,en);return}return ln.done?tn(ln.value):(cr=Promise.resolve(ln.value),cr.then(rn,on))}rn(void 0)});return Br.cancel=action(Ve+" - runid: "+Ye+" - cancel",function(){try{cr&&cancelPromise(cr);var tn=or.return(void 0),en=Promise.resolve(tn.value);en.then(noop,noop),cancelPromise(en),sr(new FlowCancellationError)}catch(an){sr(an)}}),Br};return Fe.isMobXFlow=!0,Fe},flowAnnotation);flow.bound=createDecoratorAnnotation(flowBoundAnnotation);function cancelPromise($e){isFunction($e.cancel)&&$e.cancel()}function isFlow($e){return $e?.isMobXFlow===!0}function _isObservable($e,Se){return $e?isObservableObject($e)||!!$e[$mobx]||isAtom($e)||isReaction($e)||isComputedValue($e):!1}function isObservable($e){return _isObservable($e)}function trace(){die("trace() is not available in production builds");for(var $e=!1,Se=arguments.length,Be=new Array(Se),De=0;De<Se;De++)Be[De]=arguments[De];typeof Be[Be.length-1]=="boolean"&&($e=Be.pop());var Ve=getAtomFromArgs(Be);if(!Ve)return die("'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");Ve.isTracing_===TraceMode.NONE&&console.log("[mobx.trace] '"+Ve.name_+"' tracing enabled"),Ve.isTracing_=$e?TraceMode.BREAK:TraceMode.LOG}function getAtomFromArgs($e){switch($e.length){case 0:return globalState.trackingDerivation;case 1:return getAtom($e[0]);case 2:return getAtom($e[0],$e[1])}}function transaction($e,Se){Se===void 0&&(Se=void 0),startBatch();try{return $e.apply(Se)}finally{endBatch()}}function getAdm($e){return $e[$mobx]}var objectProxyTraps={has:function $e(Se,Be){return getAdm(Se).has_(Be)},get:function $e(Se,Be){return getAdm(Se).get_(Be)},set:function $e(Se,Be,De){var Ve;return isStringish(Be)?(Ve=getAdm(Se).set_(Be,De,!0))!=null?Ve:!0:!1},deleteProperty:function $e(Se,Be){var De;return isStringish(Be)?(De=getAdm(Se).delete_(Be,!0))!=null?De:!0:!1},defineProperty:function $e(Se,Be,De){var Ve;return(Ve=getAdm(Se).defineProperty_(Be,De))!=null?Ve:!0},ownKeys:function $e(Se){return getAdm(Se).ownKeys_()},preventExtensions:function $e(Se){die(13)}};function asDynamicObservableObject($e,Se){var Be,De;return assertProxies(),$e=asObservableObject($e,Se),(De=(Be=$e[$mobx]).proxy_)!=null?De:Be.proxy_=new Proxy($e,objectProxyTraps)}function hasInterceptors($e){return $e.interceptors_!==void 0&&$e.interceptors_.length>0}function registerInterceptor($e,Se){var Be=$e.interceptors_||($e.interceptors_=[]);return Be.push(Se),once(function(){var De=Be.indexOf(Se);De!==-1&&Be.splice(De,1)})}function interceptChange($e,Se){var Be=untrackedStart();try{for(var De=[].concat($e.interceptors_||[]),Ve=0,Fe=De.length;Ve<Fe&&(Se=De[Ve](Se),Se&&!Se.type&&die(14),!!Se);Ve++);return Se}finally{untrackedEnd(Be)}}function hasListeners($e){return $e.changeListeners_!==void 0&&$e.changeListeners_.length>0}function registerListener($e,Se){var Be=$e.changeListeners_||($e.changeListeners_=[]);return Be.push(Se),once(function(){var De=Be.indexOf(Se);De!==-1&&Be.splice(De,1)})}function notifyListeners($e,Se){var Be=untrackedStart(),De=$e.changeListeners_;if(De){De=De.slice();for(var Ve=0,Fe=De.length;Ve<Fe;Ve++)De[Ve](Se);untrackedEnd(Be)}}function makeObservable($e,Se,Be){var De=asObservableObject($e,Be)[$mobx];startBatch();try{var Ve;(Ve=Se)!=null||(Se=collectStoredAnnotations($e)),ownKeys(Se).forEach(function(Fe){return De.make_(Fe,Se[Fe])})}finally{endBatch()}return $e}var SPLICE="splice",UPDATE="update",MAX_SPLICE_SIZE=1e4,arrayTraps={get:function $e(Se,Be){var De=Se[$mobx];return Be===$mobx?De:Be==="length"?De.getArrayLength_():typeof Be=="string"&&!isNaN(Be)?De.get_(parseInt(Be)):hasProp(arrayExtensions,Be)?arrayExtensions[Be]:Se[Be]},set:function $e(Se,Be,De){var Ve=Se[$mobx];return Be==="length"&&Ve.setArrayLength_(De),typeof Be=="symbol"||isNaN(Be)?Se[Be]=De:Ve.set_(parseInt(Be),De),!0},preventExtensions:function $e(){die(15)}},ObservableArrayAdministration=function(){function $e(Be,De,Ve,Fe){Be===void 0&&(Be="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=Ve,this.legacyMode_=Fe,this.atom_=new Atom(Be),this.enhancer_=function(Je,Xe){return De(Je,Xe,"ObservableArray[..]")}}var Se=$e.prototype;return Se.dehanceValue_=function(De){return this.dehancer!==void 0?this.dehancer(De):De},Se.dehanceValues_=function(De){return this.dehancer!==void 0&&De.length>0?De.map(this.dehancer):De},Se.intercept_=function(De){return registerInterceptor(this,De)},Se.observe_=function(De,Ve){return Ve===void 0&&(Ve=!1),Ve&&De({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),registerListener(this,De)},Se.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},Se.setArrayLength_=function(De){(typeof De!="number"||isNaN(De)||De<0)&&die("Out of range: "+De);var Ve=this.values_.length;if(De!==Ve)if(De>Ve){for(var Fe=new Array(De-Ve),Je=0;Je<De-Ve;Je++)Fe[Je]=void 0;this.spliceWithArray_(Ve,0,Fe)}else this.spliceWithArray_(De,Ve-De)},Se.updateArrayLength_=function(De,Ve){De!==this.lastKnownLength_&&die(16),this.lastKnownLength_+=Ve,this.legacyMode_&&Ve>0&&reserveArrayBuffer(De+Ve+1)},Se.spliceWithArray_=function(De,Ve,Fe){var Je=this;this.atom_;var Xe=this.values_.length;if(De===void 0?De=0:De>Xe?De=Xe:De<0&&(De=Math.max(0,Xe+De)),arguments.length===1?Ve=Xe-De:Ve==null?Ve=0:Ve=Math.max(0,Math.min(Ve,Xe-De)),Fe===void 0&&(Fe=EMPTY_ARRAY),hasInterceptors(this)){var Ke=interceptChange(this,{object:this.proxy_,type:SPLICE,index:De,removedCount:Ve,added:Fe});if(!Ke)return EMPTY_ARRAY;Ve=Ke.removedCount,Fe=Ke.added}if(Fe=Fe.length===0?Fe:Fe.map(function(sr){return Je.enhancer_(sr,void 0)}),this.legacyMode_){var Ye=Fe.length-Ve;this.updateArrayLength_(Xe,Ye)}var or=this.spliceItemsIntoValues_(De,Ve,Fe);return(Ve!==0||Fe.length!==0)&&this.notifyArraySplice_(De,Fe,or),this.dehanceValues_(or)},Se.spliceItemsIntoValues_=function(De,Ve,Fe){if(Fe.length<MAX_SPLICE_SIZE){var Je;return(Je=this.values_).splice.apply(Je,[De,Ve].concat(Fe))}else{var Xe=this.values_.slice(De,De+Ve),Ke=this.values_.slice(De+Ve);this.values_.length+=Fe.length-Ve;for(var Ye=0;Ye<Fe.length;Ye++)this.values_[De+Ye]=Fe[Ye];for(var or=0;or<Ke.length;or++)this.values_[De+Fe.length+or]=Ke[or];return Xe}},Se.notifyArrayChildUpdate_=function(De,Ve,Fe){var Je=!this.owned_&&isSpyEnabled(),Xe=hasListeners(this),Ke=Xe||Je?{observableKind:"array",object:this.proxy_,type:UPDATE,debugObjectName:this.atom_.name_,index:De,newValue:Ve,oldValue:Fe}:null;this.atom_.reportChanged(),Xe&&notifyListeners(this,Ke)},Se.notifyArraySplice_=function(De,Ve,Fe){var Je=!this.owned_&&isSpyEnabled(),Xe=hasListeners(this),Ke=Xe||Je?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:SPLICE,index:De,removed:Fe,added:Ve,removedCount:Fe.length,addedCount:Ve.length}:null;this.atom_.reportChanged(),Xe&&notifyListeners(this,Ke)},Se.get_=function(De){if(De<this.values_.length)return this.atom_.reportObserved(),this.dehanceValue_(this.values_[De]);console.warn("[mobx.array] Attempt to read an array index ("+De+") that is out of bounds ("+this.values_.length+"). Please check length first. Out of bound indices will not be tracked by MobX")},Se.set_=function(De,Ve){var Fe=this.values_;if(De<Fe.length){this.atom_;var Je=Fe[De];if(hasInterceptors(this)){var Xe=interceptChange(this,{type:UPDATE,object:this.proxy_,index:De,newValue:Ve});if(!Xe)return;Ve=Xe.newValue}Ve=this.enhancer_(Ve,Je);var Ke=Ve!==Je;Ke&&(Fe[De]=Ve,this.notifyArrayChildUpdate_(De,Ve,Je))}else De===Fe.length?this.spliceWithArray_(De,0,[Ve]):die(17,De,Fe.length)},$e}();function createObservableArray($e,Se,Be,De){Be===void 0&&(Be="ObservableArray"),De===void 0&&(De=!1),assertProxies();var Ve=new ObservableArrayAdministration(Be,Se,De,!1);addHiddenFinalProp(Ve.values_,$mobx,Ve);var Fe=new Proxy(Ve.values_,arrayTraps);if(Ve.proxy_=Fe,$e&&$e.length){var Je=allowStateChangesStart(!0);Ve.spliceWithArray_(0,0,$e),allowStateChangesEnd(Je)}return Fe}var arrayExtensions={clear:function $e(){return this.splice(0)},replace:function $e(Se){var Be=this[$mobx];return Be.spliceWithArray_(0,Be.values_.length,Se)},toJSON:function $e(){return this.slice()},splice:function $e(Se,Be){for(var De=arguments.length,Ve=new Array(De>2?De-2:0),Fe=2;Fe<De;Fe++)Ve[Fe-2]=arguments[Fe];var Je=this[$mobx];switch(arguments.length){case 0:return[];case 1:return Je.spliceWithArray_(Se);case 2:return Je.spliceWithArray_(Se,Be)}return Je.spliceWithArray_(Se,Be,Ve)},spliceWithArray:function $e(Se,Be,De){return this[$mobx].spliceWithArray_(Se,Be,De)},push:function $e(){for(var Se=this[$mobx],Be=arguments.length,De=new Array(Be),Ve=0;Ve<Be;Ve++)De[Ve]=arguments[Ve];return Se.spliceWithArray_(Se.values_.length,0,De),Se.values_.length},pop:function $e(){return this.splice(Math.max(this[$mobx].values_.length-1,0),1)[0]},shift:function $e(){return this.splice(0,1)[0]},unshift:function $e(){for(var Se=this[$mobx],Be=arguments.length,De=new Array(Be),Ve=0;Ve<Be;Ve++)De[Ve]=arguments[Ve];return Se.spliceWithArray_(0,0,De),Se.values_.length},reverse:function $e(){return globalState.trackingDerivation&&die(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function $e(){globalState.trackingDerivation&&die(37,"sort");var Se=this.slice();return Se.sort.apply(Se,arguments),this.replace(Se),this},remove:function $e(Se){var Be=this[$mobx],De=Be.dehanceValues_(Be.values_).indexOf(Se);return De>-1?(this.splice(De,1),!0):!1}};addArrayExtension("concat",simpleFunc);addArrayExtension("flat",simpleFunc);addArrayExtension("includes",simpleFunc);addArrayExtension("indexOf",simpleFunc);addArrayExtension("join",simpleFunc);addArrayExtension("lastIndexOf",simpleFunc);addArrayExtension("slice",simpleFunc);addArrayExtension("toString",simpleFunc);addArrayExtension("toLocaleString",simpleFunc);addArrayExtension("every",mapLikeFunc);addArrayExtension("filter",mapLikeFunc);addArrayExtension("find",mapLikeFunc);addArrayExtension("findIndex",mapLikeFunc);addArrayExtension("flatMap",mapLikeFunc);addArrayExtension("forEach",mapLikeFunc);addArrayExtension("map",mapLikeFunc);addArrayExtension("some",mapLikeFunc);addArrayExtension("reduce",reduceLikeFunc);addArrayExtension("reduceRight",reduceLikeFunc);function addArrayExtension($e,Se){typeof Array.prototype[$e]=="function"&&(arrayExtensions[$e]=Se($e))}function simpleFunc($e){return function(){var Se=this[$mobx];Se.atom_.reportObserved();var Be=Se.dehanceValues_(Se.values_);return Be[$e].apply(Be,arguments)}}function mapLikeFunc($e){return function(Se,Be){var De=this,Ve=this[$mobx];Ve.atom_.reportObserved();var Fe=Ve.dehanceValues_(Ve.values_);return Fe[$e](function(Je,Xe){return Se.call(Be,Je,Xe,De)})}}function reduceLikeFunc($e){return function(){var Se=this,Be=this[$mobx];Be.atom_.reportObserved();var De=Be.dehanceValues_(Be.values_),Ve=arguments[0];return arguments[0]=function(Fe,Je,Xe){return Ve(Fe,Je,Xe,Se)},De[$e].apply(De,arguments)}}var isObservableArrayAdministration=createInstanceofPredicate("ObservableArrayAdministration",ObservableArrayAdministration);function isObservableArray($e){return isObject($e)&&isObservableArrayAdministration($e[$mobx])}var _Symbol$iterator,_Symbol$toStringTag,ObservableMapMarker={},ADD="add",DELETE="delete";_Symbol$iterator=Symbol.iterator;_Symbol$toStringTag=Symbol.toStringTag;var ObservableMap=function($e,Se){function Be(Ve,Fe,Je){var Xe=this;Fe===void 0&&(Fe=deepEnhancer),Je===void 0&&(Je="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[$mobx]=ObservableMapMarker,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=Fe,this.name_=Je,isFunction(Map)||die(18),this.keysAtom_=createAtom("ObservableMap.keys()"),this.data_=new Map,this.hasMap_=new Map,allowStateChanges(!0,function(){Xe.merge(Ve)})}var De=Be.prototype;return De.has_=function(Fe){return this.data_.has(Fe)},De.has=function(Fe){var Je=this;if(!globalState.trackingDerivation)return this.has_(Fe);var Xe=this.hasMap_.get(Fe);if(!Xe){var Ke=Xe=new ObservableValue(this.has_(Fe),referenceEnhancer,"ObservableMap.key?",!1);this.hasMap_.set(Fe,Ke),onBecomeUnobserved(Ke,function(){return Je.hasMap_.delete(Fe)})}return Xe.get()},De.set=function(Fe,Je){var Xe=this.has_(Fe);if(hasInterceptors(this)){var Ke=interceptChange(this,{type:Xe?UPDATE:ADD,object:this,newValue:Je,name:Fe});if(!Ke)return this;Je=Ke.newValue}return Xe?this.updateValue_(Fe,Je):this.addValue_(Fe,Je),this},De.delete=function(Fe){var Je=this;if(this.keysAtom_,hasInterceptors(this)){var Xe=interceptChange(this,{type:DELETE,object:this,name:Fe});if(!Xe)return!1}if(this.has_(Fe)){var Ke=isSpyEnabled(),Ye=hasListeners(this),or=Ye||Ke?{observableKind:"map",debugObjectName:this.name_,type:DELETE,object:this,oldValue:this.data_.get(Fe).value_,name:Fe}:null;return transaction(function(){var sr;Je.keysAtom_.reportChanged(),(sr=Je.hasMap_.get(Fe))==null||sr.setNewValue_(!1);var cr=Je.data_.get(Fe);cr.setNewValue_(void 0),Je.data_.delete(Fe)}),Ye&&notifyListeners(this,or),!0}return!1},De.updateValue_=function(Fe,Je){var Xe=this.data_.get(Fe);if(Je=Xe.prepareNewValue_(Je),Je!==globalState.UNCHANGED){var Ke=isSpyEnabled(),Ye=hasListeners(this),or=Ye||Ke?{observableKind:"map",debugObjectName:this.name_,type:UPDATE,object:this,oldValue:Xe.value_,name:Fe,newValue:Je}:null;Xe.setNewValue_(Je),Ye&&notifyListeners(this,or)}},De.addValue_=function(Fe,Je){var Xe=this;this.keysAtom_,transaction(function(){var sr,cr=new ObservableValue(Je,Xe.enhancer_,"ObservableMap.key",!1);Xe.data_.set(Fe,cr),Je=cr.value_,(sr=Xe.hasMap_.get(Fe))==null||sr.setNewValue_(!0),Xe.keysAtom_.reportChanged()});var Ke=isSpyEnabled(),Ye=hasListeners(this),or=Ye||Ke?{observableKind:"map",debugObjectName:this.name_,type:ADD,object:this,name:Fe,newValue:Je}:null;Ye&&notifyListeners(this,or)},De.get=function(Fe){return this.has(Fe)?this.dehanceValue_(this.data_.get(Fe).get()):this.dehanceValue_(void 0)},De.dehanceValue_=function(Fe){return this.dehancer!==void 0?this.dehancer(Fe):Fe},De.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},De.values=function(){var Fe=this,Je=this.keys();return makeIterable({next:function(){var Ke=Je.next(),Ye=Ke.done,or=Ke.value;return{done:Ye,value:Ye?void 0:Fe.get(or)}}})},De.entries=function(){var Fe=this,Je=this.keys();return makeIterable({next:function(){var Ke=Je.next(),Ye=Ke.done,or=Ke.value;return{done:Ye,value:Ye?void 0:[or,Fe.get(or)]}}})},De[$e]=function(){return this.entries()},De.forEach=function(Fe,Je){for(var Xe=_createForOfIteratorHelperLoose(this),Ke;!(Ke=Xe()).done;){var Ye=Ke.value,or=Ye[0],sr=Ye[1];Fe.call(Je,sr,or,this)}},De.merge=function(Fe){var Je=this;return isObservableMap(Fe)&&(Fe=new Map(Fe)),transaction(function(){isPlainObject(Fe)?getPlainObjectKeys(Fe).forEach(function(Xe){return Je.set(Xe,Fe[Xe])}):Array.isArray(Fe)?Fe.forEach(function(Xe){var Ke=Xe[0],Ye=Xe[1];return Je.set(Ke,Ye)}):isES6Map(Fe)?(Fe.constructor!==Map&&die(19,Fe),Fe.forEach(function(Xe,Ke){return Je.set(Ke,Xe)})):Fe!=null&&die(20,Fe)}),this},De.clear=function(){var Fe=this;transaction(function(){untracked(function(){for(var Je=_createForOfIteratorHelperLoose(Fe.keys()),Xe;!(Xe=Je()).done;){var Ke=Xe.value;Fe.delete(Ke)}})})},De.replace=function(Fe){var Je=this;return transaction(function(){for(var Xe=convertToMap(Fe),Ke=new Map,Ye=!1,or=_createForOfIteratorHelperLoose(Je.data_.keys()),sr;!(sr=or()).done;){var cr=sr.value;if(!Xe.has(cr)){var Br=Je.delete(cr);if(Br)Ye=!0;else{var tn=Je.data_.get(cr);Ke.set(cr,tn)}}}for(var en=_createForOfIteratorHelperLoose(Xe.entries()),an;!(an=en()).done;){var rn=an.value,on=rn[0],sn=rn[1],ln=Je.data_.has(on);if(Je.set(on,sn),Je.data_.has(on)){var cn=Je.data_.get(on);Ke.set(on,cn),ln||(Ye=!0)}}if(!Ye)if(Je.data_.size!==Ke.size)Je.keysAtom_.reportChanged();else for(var hn=Je.data_.keys(),mn=Ke.keys(),An=hn.next(),xn=mn.next();!An.done;){if(An.value!==xn.value){Je.keysAtom_.reportChanged();break}An=hn.next(),xn=mn.next()}Je.data_=Ke}),this},De.toString=function(){return"[object ObservableMap]"},De.toJSON=function(){return Array.from(this)},De.observe_=function(Fe,Je){return registerListener(this,Fe)},De.intercept_=function(Fe){return registerInterceptor(this,Fe)},_createClass(Be,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Se,get:function(){return"Map"}}]),Be}(_Symbol$iterator,_Symbol$toStringTag),isObservableMap=createInstanceofPredicate("ObservableMap",ObservableMap);function convertToMap($e){if(isES6Map($e)||isObservableMap($e))return $e;if(Array.isArray($e))return new Map($e);if(isPlainObject($e)){var Se=new Map;for(var Be in $e)Se.set(Be,$e[Be]);return Se}else return die(21,$e)}var _Symbol$iterator$1,_Symbol$toStringTag$1,ObservableSetMarker={};_Symbol$iterator$1=Symbol.iterator;_Symbol$toStringTag$1=Symbol.toStringTag;var ObservableSet=function($e,Se){function Be(Ve,Fe,Je){Fe===void 0&&(Fe=deepEnhancer),Je===void 0&&(Je="ObservableSet"),this.name_=void 0,this[$mobx]=ObservableSetMarker,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=Je,isFunction(Set)||die(22),this.atom_=createAtom(this.name_),this.enhancer_=function(Xe,Ke){return Fe(Xe,Ke,Je)},Ve&&this.replace(Ve)}var De=Be.prototype;return De.dehanceValue_=function(Fe){return this.dehancer!==void 0?this.dehancer(Fe):Fe},De.clear=function(){var Fe=this;transaction(function(){untracked(function(){for(var Je=_createForOfIteratorHelperLoose(Fe.data_.values()),Xe;!(Xe=Je()).done;){var Ke=Xe.value;Fe.delete(Ke)}})})},De.forEach=function(Fe,Je){for(var Xe=_createForOfIteratorHelperLoose(this),Ke;!(Ke=Xe()).done;){var Ye=Ke.value;Fe.call(Je,Ye,Ye,this)}},De.add=function(Fe){var Je=this;if(this.atom_,hasInterceptors(this)){var Xe=interceptChange(this,{type:ADD,object:this,newValue:Fe});if(!Xe)return this}if(!this.has(Fe)){transaction(function(){Je.data_.add(Je.enhancer_(Fe,void 0)),Je.atom_.reportChanged()});var Ke=!1,Ye=hasListeners(this),or=Ye||Ke?{observableKind:"set",debugObjectName:this.name_,type:ADD,object:this,newValue:Fe}:null;Ye&&notifyListeners(this,or)}return this},De.delete=function(Fe){var Je=this;if(hasInterceptors(this)){var Xe=interceptChange(this,{type:DELETE,object:this,oldValue:Fe});if(!Xe)return!1}if(this.has(Fe)){var Ke=!1,Ye=hasListeners(this),or=Ye||Ke?{observableKind:"set",debugObjectName:this.name_,type:DELETE,object:this,oldValue:Fe}:null;return transaction(function(){Je.atom_.reportChanged(),Je.data_.delete(Fe)}),Ye&&notifyListeners(this,or),!0}return!1},De.has=function(Fe){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(Fe))},De.entries=function(){var Fe=0,Je=Array.from(this.keys()),Xe=Array.from(this.values());return makeIterable({next:function(){var Ye=Fe;return Fe+=1,Ye<Xe.length?{value:[Je[Ye],Xe[Ye]],done:!1}:{done:!0}}})},De.keys=function(){return this.values()},De.values=function(){this.atom_.reportObserved();var Fe=this,Je=0,Xe=Array.from(this.data_.values());return makeIterable({next:function(){return Je<Xe.length?{value:Fe.dehanceValue_(Xe[Je++]),done:!1}:{done:!0}}})},De.replace=function(Fe){var Je=this;return isObservableSet(Fe)&&(Fe=new Set(Fe)),transaction(function(){Array.isArray(Fe)?(Je.clear(),Fe.forEach(function(Xe){return Je.add(Xe)})):isES6Set(Fe)?(Je.clear(),Fe.forEach(function(Xe){return Je.add(Xe)})):Fe!=null&&die("Cannot initialize set from "+Fe)}),this},De.observe_=function(Fe,Je){return registerListener(this,Fe)},De.intercept_=function(Fe){return registerInterceptor(this,Fe)},De.toJSON=function(){return Array.from(this)},De.toString=function(){return"[object ObservableSet]"},De[$e]=function(){return this.values()},_createClass(Be,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Se,get:function(){return"Set"}}]),Be}(_Symbol$iterator$1,_Symbol$toStringTag$1),isObservableSet=createInstanceofPredicate("ObservableSet",ObservableSet),descriptorCache=Object.create(null),REMOVE="remove",ObservableObjectAdministration=function(){function $e(Be,De,Ve,Fe){De===void 0&&(De=new Map),Fe===void 0&&(Fe=autoAnnotation),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=Be,this.values_=De,this.name_=Ve,this.defaultAnnotation_=Fe,this.keysAtom_=new Atom("ObservableObject.keys"),this.isPlainObject_=isPlainObject(this.target_)}var Se=$e.prototype;return Se.getObservablePropValue_=function(De){return this.values_.get(De).get()},Se.setObservablePropValue_=function(De,Ve){var Fe=this.values_.get(De);if(Fe instanceof ComputedValue)return Fe.set(Ve),!0;if(hasInterceptors(this)){var Je=interceptChange(this,{type:UPDATE,object:this.proxy_||this.target_,name:De,newValue:Ve});if(!Je)return null;Ve=Je.newValue}if(Ve=Fe.prepareNewValue_(Ve),Ve!==globalState.UNCHANGED){var Xe=hasListeners(this),Ke=!1,Ye=Xe||Ke?{type:UPDATE,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:Fe.value_,name:De,newValue:Ve}:null;Fe.setNewValue_(Ve),Xe&&notifyListeners(this,Ye)}return!0},Se.get_=function(De){return globalState.trackingDerivation&&!hasProp(this.target_,De)&&this.has_(De),this.target_[De]},Se.set_=function(De,Ve,Fe){return Fe===void 0&&(Fe=!1),hasProp(this.target_,De)?this.values_.has(De)?this.setObservablePropValue_(De,Ve):Fe?Reflect.set(this.target_,De,Ve):(this.target_[De]=Ve,!0):this.extend_(De,{value:Ve,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,Fe)},Se.has_=function(De){if(!globalState.trackingDerivation)return De in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var Ve=this.pendingKeys_.get(De);return Ve||(Ve=new ObservableValue(De in this.target_,referenceEnhancer,"ObservableObject.key?",!1),this.pendingKeys_.set(De,Ve)),Ve.get()},Se.make_=function(De,Ve){if(Ve===!0&&(Ve=this.defaultAnnotation_),Ve!==!1){if(!(De in this.target_)){var Fe;if((Fe=this.target_[storedAnnotationsSymbol])!=null&&Fe[De])return;die(1,Ve.annotationType_,this.name_+"."+De.toString())}for(var Je=this.target_;Je&&Je!==objectPrototype;){var Xe=getDescriptor(Je,De);if(Xe){var Ke=Ve.make_(this,De,Xe,Je);if(Ke===0)return;if(Ke===1)break}Je=Object.getPrototypeOf(Je)}recordAnnotationApplied(this,Ve,De)}},Se.extend_=function(De,Ve,Fe,Je){if(Je===void 0&&(Je=!1),Fe===!0&&(Fe=this.defaultAnnotation_),Fe===!1)return this.defineProperty_(De,Ve,Je);var Xe=Fe.extend_(this,De,Ve,Je);return Xe&&recordAnnotationApplied(this,Fe,De),Xe},Se.defineProperty_=function(De,Ve,Fe){Fe===void 0&&(Fe=!1);try{startBatch();var Je=this.delete_(De);if(!Je)return Je;if(hasInterceptors(this)){var Xe=interceptChange(this,{object:this.proxy_||this.target_,name:De,type:ADD,newValue:Ve.value});if(!Xe)return null;var Ke=Xe.newValue;Ve.value!==Ke&&(Ve=_extends({},Ve,{value:Ke}))}if(Fe){if(!Reflect.defineProperty(this.target_,De,Ve))return!1}else defineProperty(this.target_,De,Ve);this.notifyPropertyAddition_(De,Ve.value)}finally{endBatch()}return!0},Se.defineObservableProperty_=function(De,Ve,Fe,Je){Je===void 0&&(Je=!1);try{startBatch();var Xe=this.delete_(De);if(!Xe)return Xe;if(hasInterceptors(this)){var Ke=interceptChange(this,{object:this.proxy_||this.target_,name:De,type:ADD,newValue:Ve});if(!Ke)return null;Ve=Ke.newValue}var Ye=getCachedObservablePropDescriptor(De),or={configurable:globalState.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:Ye.get,set:Ye.set};if(Je){if(!Reflect.defineProperty(this.target_,De,or))return!1}else defineProperty(this.target_,De,or);var sr=new ObservableValue(Ve,Fe,"ObservableObject.key",!1);this.values_.set(De,sr),this.notifyPropertyAddition_(De,sr.value_)}finally{endBatch()}return!0},Se.defineComputedProperty_=function(De,Ve,Fe){Fe===void 0&&(Fe=!1);try{startBatch();var Je=this.delete_(De);if(!Je)return Je;if(hasInterceptors(this)){var Xe=interceptChange(this,{object:this.proxy_||this.target_,name:De,type:ADD,newValue:void 0});if(!Xe)return null}Ve.name||(Ve.name="ObservableObject.key"),Ve.context=this.proxy_||this.target_;var Ke=getCachedObservablePropDescriptor(De),Ye={configurable:globalState.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:Ke.get,set:Ke.set};if(Fe){if(!Reflect.defineProperty(this.target_,De,Ye))return!1}else defineProperty(this.target_,De,Ye);this.values_.set(De,new ComputedValue(Ve)),this.notifyPropertyAddition_(De,void 0)}finally{endBatch()}return!0},Se.delete_=function(De,Ve){if(Ve===void 0&&(Ve=!1),!hasProp(this.target_,De))return!0;if(hasInterceptors(this)){var Fe=interceptChange(this,{object:this.proxy_||this.target_,name:De,type:REMOVE});if(!Fe)return null}try{var Je,Xe;startBatch();var Ke=hasListeners(this),Ye=!1,or=this.values_.get(De),sr=void 0;if(!or&&(Ke||Ye)){var cr;sr=(cr=getDescriptor(this.target_,De))==null?void 0:cr.value}if(Ve){if(!Reflect.deleteProperty(this.target_,De))return!1}else delete this.target_[De];if(or&&(this.values_.delete(De),or instanceof ObservableValue&&(sr=or.value_),propagateChanged(or)),this.keysAtom_.reportChanged(),(Je=this.pendingKeys_)==null||(Xe=Je.get(De))==null||Xe.set(De in this.target_),Ke||Ye){var Br={type:REMOVE,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:sr,name:De};Ke&&notifyListeners(this,Br)}}finally{endBatch()}return!0},Se.observe_=function(De,Ve){return registerListener(this,De)},Se.intercept_=function(De){return registerInterceptor(this,De)},Se.notifyPropertyAddition_=function(De,Ve){var Fe,Je,Xe=hasListeners(this),Ke=!1;if(Xe||Ke){var Ye=Xe||Ke?{type:ADD,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:De,newValue:Ve}:null;Xe&&notifyListeners(this,Ye)}(Fe=this.pendingKeys_)==null||(Je=Fe.get(De))==null||Je.set(!0),this.keysAtom_.reportChanged()},Se.ownKeys_=function(){return this.keysAtom_.reportObserved(),ownKeys(this.target_)},Se.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},$e}();function asObservableObject($e,Se){var Be;if(hasProp($e,$mobx))return $e;var De=(Be=Se?.name)!=null?Be:"ObservableObject",Ve=new ObservableObjectAdministration($e,new Map,String(De),getAnnotationFromOptions(Se));return addHiddenProp($e,$mobx,Ve),$e}var isObservableObjectAdministration=createInstanceofPredicate("ObservableObjectAdministration",ObservableObjectAdministration);function getCachedObservablePropDescriptor($e){return descriptorCache[$e]||(descriptorCache[$e]={get:function(){return this[$mobx].getObservablePropValue_($e)},set:function(Be){return this[$mobx].setObservablePropValue_($e,Be)}})}function isObservableObject($e){return isObject($e)?isObservableObjectAdministration($e[$mobx]):!1}function recordAnnotationApplied($e,Se,Be){var De;(De=$e.target_[storedAnnotationsSymbol])==null||delete De[Be]}var OBSERVABLE_ARRAY_BUFFER_SIZE=0,StubArray=function $e(){};function inherit($e,Se){Object.setPrototypeOf?Object.setPrototypeOf($e.prototype,Se):$e.prototype.__proto__!==void 0?$e.prototype.__proto__=Se:$e.prototype=Se}inherit(StubArray,Array.prototype);var LegacyObservableArray=function($e,Se,Be){_inheritsLoose(De,$e);function De(Fe,Je,Xe,Ke){var Ye;Xe===void 0&&(Xe="ObservableArray"),Ke===void 0&&(Ke=!1),Ye=$e.call(this)||this;var or=new ObservableArrayAdministration(Xe,Je,Ke,!0);if(or.proxy_=_assertThisInitialized(Ye),addHiddenFinalProp(_assertThisInitialized(Ye),$mobx,or),Fe&&Fe.length){var sr=allowStateChangesStart(!0);Ye.spliceWithArray(0,0,Fe),allowStateChangesEnd(sr)}return Ye}var Ve=De.prototype;return Ve.concat=function(){this[$mobx].atom_.reportObserved();for(var Je=arguments.length,Xe=new Array(Je),Ke=0;Ke<Je;Ke++)Xe[Ke]=arguments[Ke];return Array.prototype.concat.apply(this.slice(),Xe.map(function(Ye){return isObservableArray(Ye)?Ye.slice():Ye}))},Ve[Be]=function(){var Fe=this,Je=0;return makeIterable({next:function(){return Je<Fe.length?{value:Fe[Je++],done:!1}:{done:!0,value:void 0}}})},_createClass(De,[{key:"length",get:function(){return this[$mobx].getArrayLength_()},set:function(Je){this[$mobx].setArrayLength_(Je)}},{key:Se,get:function(){return"Array"}}]),De}(StubArray,Symbol.toStringTag,Symbol.iterator);Object.entries(arrayExtensions).forEach(function($e){var Se=$e[0],Be=$e[1];Se!=="concat"&&addHiddenProp(LegacyObservableArray.prototype,Se,Be)});function createArrayEntryDescriptor($e){return{enumerable:!1,configurable:!0,get:function(){return this[$mobx].get_($e)},set:function(Be){this[$mobx].set_($e,Be)}}}function createArrayBufferItem($e){defineProperty(LegacyObservableArray.prototype,""+$e,createArrayEntryDescriptor($e))}function reserveArrayBuffer($e){if($e>OBSERVABLE_ARRAY_BUFFER_SIZE){for(var Se=OBSERVABLE_ARRAY_BUFFER_SIZE;Se<$e+100;Se++)createArrayBufferItem(Se);OBSERVABLE_ARRAY_BUFFER_SIZE=$e}}reserveArrayBuffer(1e3);function createLegacyArray($e,Se,Be){return new LegacyObservableArray($e,Se,Be)}function getAtom($e,Se){if(typeof $e=="object"&&$e!==null){if(isObservableArray($e))return Se!==void 0&&die(23),$e[$mobx].atom_;if(isObservableSet($e))return $e[$mobx];if(isObservableMap($e)){if(Se===void 0)return $e.keysAtom_;var Be=$e.data_.get(Se)||$e.hasMap_.get(Se);return Be||die(25,Se,getDebugName($e)),Be}if(isObservableObject($e)){if(!Se)return die(26);var De=$e[$mobx].values_.get(Se);return De||die(27,Se,getDebugName($e)),De}if(isAtom($e)||isComputedValue($e)||isReaction($e))return $e}else if(isFunction($e)&&isReaction($e[$mobx]))return $e[$mobx];die(28)}function getAdministration($e,Se){if($e||die(29),isAtom($e)||isComputedValue($e)||isReaction($e)||isObservableMap($e)||isObservableSet($e))return $e;if($e[$mobx])return $e[$mobx];die(24,$e)}function getDebugName($e,Se){var Be;if(Se!==void 0)Be=getAtom($e,Se);else{if(isAction($e))return $e.name;isObservableObject($e)||isObservableMap($e)||isObservableSet($e)?Be=getAdministration($e):Be=getAtom($e)}return Be.name_}var toString=objectPrototype.toString;function deepEqual($e,Se,Be){return Be===void 0&&(Be=-1),eq($e,Se,Be)}function eq($e,Se,Be,De,Ve){if($e===Se)return $e!==0||1/$e===1/Se;if($e==null||Se==null)return!1;if($e!==$e)return Se!==Se;var Fe=typeof $e;if(Fe!=="function"&&Fe!=="object"&&typeof Se!="object")return!1;var Je=toString.call($e);if(Je!==toString.call(Se))return!1;switch(Je){case"[object RegExp]":case"[object String]":return""+$e==""+Se;case"[object Number]":return+$e!=+$e?+Se!=+Se:+$e==0?1/+$e===1/Se:+$e==+Se;case"[object Date]":case"[object Boolean]":return+$e==+Se;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call($e)===Symbol.valueOf.call(Se);case"[object Map]":case"[object Set]":Be>=0&&Be++;break}$e=unwrap($e),Se=unwrap(Se);var Xe=Je==="[object Array]";if(!Xe){if(typeof $e!="object"||typeof Se!="object")return!1;var Ke=$e.constructor,Ye=Se.constructor;if(Ke!==Ye&&!(isFunction(Ke)&&Ke instanceof Ke&&isFunction(Ye)&&Ye instanceof Ye)&&"constructor"in $e&&"constructor"in Se)return!1}if(Be===0)return!1;Be<0&&(Be=-1),De=De||[],Ve=Ve||[];for(var or=De.length;or--;)if(De[or]===$e)return Ve[or]===Se;if(De.push($e),Ve.push(Se),Xe){if(or=$e.length,or!==Se.length)return!1;for(;or--;)if(!eq($e[or],Se[or],Be-1,De,Ve))return!1}else{var sr=Object.keys($e),cr;if(or=sr.length,Object.keys(Se).length!==or)return!1;for(;or--;)if(cr=sr[or],!(hasProp(Se,cr)&&eq($e[cr],Se[cr],Be-1,De,Ve)))return!1}return De.pop(),Ve.pop(),!0}function unwrap($e){return isObservableArray($e)?$e.slice():isES6Map($e)||isObservableMap($e)||isES6Set($e)||isObservableSet($e)?Array.from($e.entries()):$e}function makeIterable($e){return $e[Symbol.iterator]=getSelf,$e}function getSelf(){return this}["Symbol","Map","Set"].forEach(function($e){var Se=getGlobal();typeof Se[$e]>"u"&&die("MobX requires global '"+$e+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy,extras:{getDebugName},$mobx});if(!reactExports.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!makeObservable)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function defaultNoopBatch($e){$e()}function observerBatching($e){$e||($e=defaultNoopBatch),configure({reactionScheduler:$e})}function printDebugValue($e){return getDependencyTree($e)}var FinalizationRegistryLocal=typeof FinalizationRegistry>"u"?void 0:FinalizationRegistry;function createTrackingData($e){var Se={reaction:$e,mounted:!1,changedBeforeMount:!1,cleanAt:Date.now()+CLEANUP_LEAKED_REACTIONS_AFTER_MILLIS};return Se}var CLEANUP_LEAKED_REACTIONS_AFTER_MILLIS=1e4,CLEANUP_TIMER_LOOP_MILLIS=1e4;function createReactionCleanupTrackingUsingFinalizationRegister($e){var Se=new Map,Be=1,De=new $e(function(Fe){var Je=Se.get(Fe);Je&&(Je.reaction.dispose(),Se.delete(Fe))});return{addReactionToTrack:function(Ve,Fe,Je){var Xe=Be++;return De.register(Je,Xe,Ve),Ve.current=createTrackingData(Fe),Ve.current.finalizationRegistryCleanupToken=Xe,Se.set(Xe,Ve.current),Ve.current},recordReactionAsCommitted:function(Ve){De.unregister(Ve),Ve.current&&Ve.current.finalizationRegistryCleanupToken&&Se.delete(Ve.current.finalizationRegistryCleanupToken)},forceCleanupTimerToRunNowForTests:function(){},resetCleanupScheduleForTests:function(){}}}var __values=function($e){var Se=typeof Symbol=="function"&&Symbol.iterator,Be=Se&&$e[Se],De=0;if(Be)return Be.call($e);if($e&&typeof $e.length=="number")return{next:function(){return $e&&De>=$e.length&&($e=void 0),{value:$e&&$e[De++],done:!$e}}};throw new TypeError(Se?"Object is not iterable.":"Symbol.iterator is not defined.")};function createTimerBasedReactionCleanupTracking(){var $e=new Set,Se;function Be(){Se&&(clearTimeout(Se),Xe())}function De(){var Ke,Ye;if($e.size>0){try{for(var or=__values($e),sr=or.next();!sr.done;sr=or.next()){var cr=sr.value,Br=cr.current;Br&&(Br.reaction.dispose(),cr.current=null)}}catch(tn){Ke={error:tn}}finally{try{sr&&!sr.done&&(Ye=or.return)&&Ye.call(or)}finally{if(Ke)throw Ke.error}}$e.clear()}Se&&(clearTimeout(Se),Se=void 0)}function Ve(){Se===void 0&&(Se=setTimeout(Xe,CLEANUP_TIMER_LOOP_MILLIS))}function Fe(Ke){$e.add(Ke),Ve()}function Je(Ke){$e.delete(Ke)}function Xe(){Se=void 0;var Ke=Date.now();$e.forEach(function(Ye){var or=Ye.current;or&&Ke>=or.cleanAt&&(or.reaction.dispose(),Ye.current=null,$e.delete(Ye))}),$e.size>0&&Ve()}return{addReactionToTrack:function(Ke,Ye,or){return Ke.current=createTrackingData(Ye),Fe(Ke),Ke.current},recordReactionAsCommitted:Je,forceCleanupTimerToRunNowForTests:Be,resetCleanupScheduleForTests:De}}var _a=FinalizationRegistryLocal?createReactionCleanupTrackingUsingFinalizationRegister(FinalizationRegistryLocal):createTimerBasedReactionCleanupTracking(),addReactionToTrack=_a.addReactionToTrack,recordReactionAsCommitted=_a.recordReactionAsCommitted,__read=function($e,Se){var Be=typeof Symbol=="function"&&$e[Symbol.iterator];if(!Be)return $e;var De=Be.call($e),Ve,Fe=[],Je;try{for(;(Se===void 0||Se-- >0)&&!(Ve=De.next()).done;)Fe.push(Ve.value)}catch(Xe){Je={error:Xe}}finally{try{Ve&&!Ve.done&&(Be=De.return)&&Be.call(De)}finally{if(Je)throw Je.error}}return Fe};function observerComponentNameFor($e){return"observer".concat($e)}var ObjectToBeRetainedByReact=function(){function $e(){}return $e}();function objectToBeRetainedByReactFactory(){return new ObjectToBeRetainedByReact}function useObserver($e,Se){Se===void 0&&(Se="observed");var Be=__read(React.useState(objectToBeRetainedByReactFactory),1),De=Be[0],Ve=__read(React.useState(),2),Fe=Ve[1],Je=function(){return Fe([])},Xe=React.useRef(null);if(!Xe.current)var Ke=new Reaction(observerComponentNameFor(Se),function(){Ye.mounted?Je():Ye.changedBeforeMount=!0}),Ye=addReactionToTrack(Xe,Ke,De);var or=Xe.current.reaction;React.useDebugValue(or,printDebugValue),React.useEffect(function(){return recordReactionAsCommitted(Xe),Xe.current?(Xe.current.mounted=!0,Xe.current.changedBeforeMount&&(Xe.current.changedBeforeMount=!1,Je())):(Xe.current={reaction:new Reaction(observerComponentNameFor(Se),function(){Je()}),mounted:!0,changedBeforeMount:!1,cleanAt:1/0},Je()),function(){Xe.current.reaction.dispose(),Xe.current=null}},[]);var sr,cr;if(or.track(function(){try{sr=$e()}catch(Br){cr=Br}}),cr)throw cr;return sr}var hasSymbol=typeof Symbol=="function"&&Symbol.for,ReactForwardRefSymbol=hasSymbol?Symbol.for("react.forward_ref"):typeof reactExports.forwardRef=="function"&&reactExports.forwardRef(function($e){return null}).$$typeof,ReactMemoSymbol=hasSymbol?Symbol.for("react.memo"):typeof reactExports.memo=="function"&&reactExports.memo(function($e){return null}).$$typeof;function observer$1($e,Se){var Be;if(ReactMemoSymbol&&$e.$$typeof===ReactMemoSymbol)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var De=(Be=void 0)!==null&&Be!==void 0?Be:!1,Ve=$e,Fe=$e.displayName||$e.name;if(ReactForwardRefSymbol&&$e.$$typeof===ReactForwardRefSymbol&&(De=!0,Ve=$e.render,typeof Ve!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var Je=function(Xe,Ke){return useObserver(function(){return Ve(Xe,Ke)},Fe)};return Fe!==""&&(Je.displayName=Fe),$e.contextTypes&&(Je.contextTypes=$e.contextTypes),De&&(Je=reactExports.forwardRef(Je)),Je=reactExports.memo(Je),copyStaticProperties($e,Je),Je}var hoistBlackList={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function copyStaticProperties($e,Se){Object.keys($e).forEach(function(Be){hoistBlackList[Be]||Object.defineProperty(Se,Be,Object.getOwnPropertyDescriptor($e,Be))})}observerBatching(reactDomExports.unstable_batchedUpdates);var symbolId=0;function createSymbol($e){if(typeof Symbol=="function")return Symbol($e);var Se="__$mobx-react "+$e+" ("+symbolId+")";return symbolId++,Se}var createdSymbols={};function newSymbol($e){return createdSymbols[$e]||(createdSymbols[$e]=createSymbol($e)),createdSymbols[$e]}function shallowEqual($e,Se){if(is($e,Se))return!0;if(typeof $e!="object"||$e===null||typeof Se!="object"||Se===null)return!1;var Be=Object.keys($e),De=Object.keys(Se);if(Be.length!==De.length)return!1;for(var Ve=0;Ve<Be.length;Ve++)if(!Object.hasOwnProperty.call(Se,Be[Ve])||!is($e[Be[Ve]],Se[Be[Ve]]))return!1;return!0}function is($e,Se){return $e===Se?$e!==0||1/$e===1/Se:$e!==$e&&Se!==Se}function setHiddenProp($e,Se,Be){Object.hasOwnProperty.call($e,Se)?$e[Se]=Be:Object.defineProperty($e,Se,{enumerable:!1,configurable:!0,writable:!0,value:Be})}var mobxMixins=newSymbol("patchMixins"),mobxPatchedDefinition=newSymbol("patchedDefinition");function getMixins($e,Se){var Be=$e[mobxMixins]=$e[mobxMixins]||{},De=Be[Se]=Be[Se]||{};return De.locks=De.locks||0,De.methods=De.methods||[],De}function wrapper($e,Se){for(var Be=this,De=arguments.length,Ve=new Array(De>2?De-2:0),Fe=2;Fe<De;Fe++)Ve[Fe-2]=arguments[Fe];Se.locks++;try{var Je;return $e!=null&&(Je=$e.apply(this,Ve)),Je}finally{Se.locks--,Se.locks===0&&Se.methods.forEach(function(Xe){Xe.apply(Be,Ve)})}}function wrapFunction($e,Se){var Be=function(){for(var Ve=arguments.length,Fe=new Array(Ve),Je=0;Je<Ve;Je++)Fe[Je]=arguments[Je];wrapper.call.apply(wrapper,[this,$e,Se].concat(Fe))};return Be}function patch($e,Se,Be){var De=getMixins($e,Se);De.methods.indexOf(Be)<0&&De.methods.push(Be);var Ve=Object.getOwnPropertyDescriptor($e,Se);if(!(Ve&&Ve[mobxPatchedDefinition])){var Fe=$e[Se],Je=createDefinition($e,Se,Ve?Ve.enumerable:void 0,De,Fe);Object.defineProperty($e,Se,Je)}}function createDefinition($e,Se,Be,De,Ve){var Fe,Je=wrapFunction(Ve,De);return Fe={},Fe[mobxPatchedDefinition]=!0,Fe.get=function(){return Je},Fe.set=function(Ke){if(this===$e)Je=wrapFunction(Ke,De);else{var Ye=createDefinition(this,Se,Be,De,Ke);Object.defineProperty(this,Se,Ye)}},Fe.configurable=!0,Fe.enumerable=Be,Fe}var mobxAdminProperty=$mobx||"$mobx",mobxObserverProperty=newSymbol("isMobXReactObserver"),mobxIsUnmounted=newSymbol("isUnmounted"),skipRenderKey=newSymbol("skipRender"),isForcingUpdateKey=newSymbol("isForcingUpdate");function makeClassComponentObserver($e){var Se=$e.prototype;if($e[mobxObserverProperty]){var Be=getDisplayName(Se);console.warn("The provided component class ("+Be+`) 
                has already been declared as an observer component.`)}else $e[mobxObserverProperty]=!0;if(Se.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if($e.__proto__!==reactExports.PureComponent){if(!Se.shouldComponentUpdate)Se.shouldComponentUpdate=observerSCU;else if(Se.shouldComponentUpdate!==observerSCU)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}makeObservableProp(Se,"props"),makeObservableProp(Se,"state");var De=Se.render;if(typeof De!="function"){var Ve=getDisplayName(Se);throw new Error("[mobx-react] class component ("+Ve+") is missing `render` method.\n`observer` requires `render` being a function defined on prototype.\n`render = () => {}` or `render = function() {}` is not supported.")}return Se.render=function(){return makeComponentReactive.call(this,De)},patch(Se,"componentWillUnmount",function(){var Fe;if((Fe=this.render[mobxAdminProperty])==null||Fe.dispose(),this[mobxIsUnmounted]=!0,!this.render[mobxAdminProperty]){var Je=getDisplayName(this);console.warn("The reactive render of an observer class component ("+Je+`) 
                was overriden after MobX attached. This may result in a memory leak if the 
                overriden reactive render was not properly disposed.`)}}),$e}function getDisplayName($e){return $e.displayName||$e.name||$e.constructor&&($e.constructor.displayName||$e.constructor.name)||"<component>"}function makeComponentReactive($e){var Se=this;setHiddenProp(this,skipRenderKey,!1),setHiddenProp(this,isForcingUpdateKey,!1);var Be=getDisplayName(this),De=$e.bind(this),Ve=!1,Fe=new Reaction(Be+".render()",function(){if(!Ve&&(Ve=!0,Se[mobxIsUnmounted]!==!0)){var Xe=!0;try{setHiddenProp(Se,isForcingUpdateKey,!0),Se[skipRenderKey]||reactExports.Component.prototype.forceUpdate.call(Se),Xe=!1}finally{setHiddenProp(Se,isForcingUpdateKey,!1),Xe&&Fe.dispose()}}});Fe.reactComponent=this,Je[mobxAdminProperty]=Fe,this.render=Je;function Je(){Ve=!1;var Xe=void 0,Ke=void 0;if(Fe.track(function(){try{Ke=allowStateChanges(!1,De)}catch(Ye){Xe=Ye}}),Xe)throw Xe;return Ke}return Je.call(this)}function observerSCU($e,Se){return this.state!==Se?!0:!shallowEqual(this.props,$e)}function makeObservableProp($e,Se){var Be=newSymbol("reactProp_"+Se+"_valueHolder"),De=newSymbol("reactProp_"+Se+"_atomHolder");function Ve(){return this[De]||setHiddenProp(this,De,createAtom("reactive "+Se)),this[De]}Object.defineProperty($e,Se,{configurable:!0,enumerable:!0,get:function(){var Je=!1;return allowStateReadsStart&&allowStateReadsEnd&&(Je=allowStateReadsStart(!0)),Ve.call(this).reportObserved(),allowStateReadsStart&&allowStateReadsEnd&&allowStateReadsEnd(Je),this[Be]},set:function(Je){!this[isForcingUpdateKey]&&!shallowEqual(this[Be],Je)?(setHiddenProp(this,Be,Je),setHiddenProp(this,skipRenderKey,!0),Ve.call(this).reportChanged(),setHiddenProp(this,skipRenderKey,!1)):setHiddenProp(this,Be,Je)}})}function observer($e){return $e.isMobxInjector===!0&&console.warn("Mobx observer: You are trying to use `observer` on a component that already has `inject`. Please apply `observer` before applying `inject`"),Object.prototype.isPrototypeOf.call(reactExports.Component,$e)||Object.prototype.isPrototypeOf.call(reactExports.PureComponent,$e)?makeClassComponentObserver($e):observer$1($e)}if(!reactExports.Component)throw new Error("mobx-react requires React to be available");if(!observable)throw new Error("mobx-react requires mobx to be available");const _requestAnimationFrame=window.requestAnimationFrame||($e=>window.setTimeout(()=>$e(performance.now()),16)),_cancelAnimationFrame=window.cancelAnimationFrame||($e=>window.clearTimeout($e));function requestAnimationFrameInterval($e,Se=60){let Be=-1,De=0,Ve=-1;const Fe=1e3/Se;function Je(Xe){Ve===-1&&(Ve=Xe),Be=_requestAnimationFrame(Je),!(Xe-De<Fe)&&(De=Xe,$e&&$e(Xe-Ve))}return Be=_requestAnimationFrame(Je),function(){_cancelAnimationFrame(Be)}}var VreoKeyframeEnum=($e=>($e.CameraMovement="CameraMovement",$e.PanoTag="PanoTag",$e.PanoTextLabel="PanoTextLabel",$e.Prompter="Prompter",$e.UpdateVRPanorama="UpdateVRPanorama",$e.ModelVideo="ModelVideo",$e.PanoEffect="PanoEffect",$e.InfoPanel="InfoPanel",$e.VideoEffect="VideoEffect",$e.BgMusic="BgMusic",$e.Exit="Exit",$e.Custom="Custom",$e))(VreoKeyframeEnum||{}),InfoPanelTypeEnum=($e=>($e.Image="Image",$e.Video="Video",$e))(InfoPanelTypeEnum||{}),InfoPanelStyleEnum=($e=>($e.Drawer="Drawer",$e.PopUp="PopUp",$e))(InfoPanelStyleEnum||{});function setElementDataset($e,Se){$e&&Object.keys(Se).forEach(Be=>{const De=Se[Be].toString();$e instanceof Element?$e.setAttribute(`data-${Be}`,De):$e instanceof Document?$e.documentElement.setAttribute(`data-${Be}`,De):$e instanceof HTMLElement?$e.dataset[Be]=De:$e.setAttribute(`data-${Be}`,De)})}function getFileExpandedName($e){if(!$e)return"";const Se=$e.lastIndexOf(".");return Se===-1?"":$e.substring(Se+1).toLowerCase()}function getMediaType($e){const Se=getFileExpandedName($e);return getMediaTypeByExpandedName(Se)}function getMediaTypeByExpandedName($e){return $e?/^(jpg|jpeg|png)$/i.test($e)?"image":/^(mp3|wav)$/i.test($e)?"audio":/^(avi|wmv|mpeg|mp4|m4v|mov|asf|flv|f4v|rmvb|rm|3gp|vob)$/i.test($e)?"video":"unknown":"unknown"}class Controller extends Subscribe{five;configs;videoAgentScene;vreoUnit;stopInterval;playing=!1;ended=!1;loading=!1;containerSize={width:0,height:0};appSize;container;waveAppearance=null;appearance={waveStyle:"wave"};avatar={};visible=!1;get agentType(){const Se=getMediaType(this.videoAgentScene?.videoAgentMesh.videoUrl);return this.avatar?.force?"avatar":Se==="video"?"video":"none"}popUp=null;openPopUp(Se){if(!Se){this.popUp=null;return}this.popUp=Se}setLoading(Se){this.loading=Se}drawerConfig=null;setAvatar(Se){this.avatar=Se}setContainerSize(Se,Be){this.containerSize={width:Se,height:Be}}setVisible(Se){this.visible=Se}setPlaying(Se){this.playing=Se}setEnded(Se){this.ended=Se}setAppearance(Se){this.appearance={...this.appearance,...Se}}openDrawer(Se){if(!Se){this.drawerConfig={content:"",height:this.drawerConfig?.height};return}this.drawerConfig=Se}constructor({five:Se,container:Be,configs:De}){super(),this.configs=De,this.container=Be,this.five=Se,this.appSize=De.appSize,this.appearance={...this.appearance,...De.appearance},makeObservable(this,{visible:observable,setVisible:action,playing:observable,setPlaying:action,loading:observable,setLoading:action,popUp:observable.ref,openPopUp:action,drawerConfig:observable.ref,openDrawer:action,ended:observable,waveAppearance:observable,avatar:observable,containerSize:observable,setContainerSize:action,appearance:observable,setAppearance:action,configs:observable.ref,setEnded:action,setAvatar:action}),reaction(()=>[this.appearance.waveStyle,this.loading],([Ve,Fe])=>{if(Fe===null){this.waveAppearance=null;return}if(Ve==="wave")switch(Fe){case!0:this.waveAppearance="double";break;case!1:this.waveAppearance="solid";break}else if(Ve==="solid")switch(Fe){case!0:this.waveAppearance="swap";break;case!1:this.waveAppearance="expand";break}},{fireImmediately:!0}),this.appSize?setElementDataset(this.container,{size:this.appSize}):reaction(()=>this.containerSize,Ve=>{if(!Ve?.width)return;const Fe=Ve.width,Je=Ve.height,Xe=Fe<=500?"S":Fe<=1024?"M":Fe<=2048?"L":"XL",Ke=Je>Fe?"portrait":"landscape";setElementDataset(this.container,{size:Xe}),setElementDataset(this.container,{orientation:Ke})},{fireImmediately:!0}),reaction(()=>this.ended,Ve=>{Ve&&this.emit("paused",!0)}),reaction(()=>this.playing,Ve=>{this.ended||this.emit(Ve?"playing":"paused")})}get ready(){return!!this.videoAgentScene}get currentTime(){return this.videoAgentScene?.videoAgentMesh.currentTime||0}get currentKeyframes(){return this.vreoUnit?this.vreoUnit.keyframes.filter(Be=>{if(Be.parsed||Be.end<this.currentTime||Be.start>this.currentTime)return!1;if(Be.type===VreoKeyframeEnum.BgMusic)return!0;const De=this.currentTime-Be.start;return De<=100&&De>=0}):[]}get mediaInstance(){return this.videoAgentScene?.videoAgentMesh.mediaInstance}requestAnimationFrameLoop(Se){if(this.mediaInstance?.ended&&this.mediaInstance.currentTime!==0){if(this.ended)return;this.vreoUnit?.keyframes.forEach(De=>De.parsed=!1),this.setEnded(!0),this.setPlaying(!1),this.mediaInstance.pause(),this.mediaInstance.currentTime=0;return}if(!this.playing){this.mediaInstance?.paused||this.mediaInstance?.pause();return}this.mediaInstance?.paused&&this.playing&&this.mediaInstance.play(),this.currentKeyframes.forEach(De=>{De.parsed||(De.parsed=!0,this.emit(De.type,De,this.currentTime),Se&&Se(De.type,De,this.currentTime))})}run(Se){this.stopInterval||(this.stopInterval=requestAnimationFrameInterval(()=>this.requestAnimationFrameLoop(Se)))}clear(){this.setPlaying(!1),this.vreoUnit?.keyframes.forEach(Se=>Se.parsed=!1),this.vreoUnit=void 0,this.mediaInstance&&(this.mediaInstance.pause(),this.mediaInstance.currentTime=0),this.stopInterval?.(),this.stopInterval=void 0}dispose(){this.clear()}}const ControllerContext=reactExports.createContext(null);function useController(){const $e=React.useContext(ControllerContext);if(!$e)throw new Error('没有找到 "ControllerContext"');return $e}function useFiveInstance(){const $e=useController();if(!$e.five)throw new Error('没有找到 "five" 实例');return $e.five}function useFiveProject2d(){const $e=useFiveInstance();return Se=>$e.project2d(Se,!1)}var CameraMovementEffect=($e=>($e.Move="Move",$e.Rotate="Rotate",$e))(CameraMovementEffect||{}),Rotation=($e=>($e.Clockwise="Clockwise",$e.Anticlockwise="Anticlockwise",$e.Loop="Loop",$e))(Rotation||{});const PI$1=Math.PI,PI_2$1=PI$1*2;let moving=!1;function progressNumber($e,Se,Be){return $e===Se?$e:$e+(Se-$e)*Be}function progressLongitude($e,Se,Be,De){const Ve=Be===Rotation.Clockwise,Je=(Ve?$e-Se:Se-$e)%PI_2$1,Xe=Je<0?Je+PI_2$1:Je,Ke=Ve?-Xe:Xe;return($e+Ke*De)%PI_2$1}const CameraMovementPlugin=$e=>({move:(De,Ve,Fe={preload:!0})=>new Promise(async(Je,Xe)=>{if(moving=!0,Fe.asyncStartCallback&&Fe.asyncStartCallback(),$e.panoIndex===void 0)return Xe(!1);if(De.mode&&De.mode!==$e.currentMode)return await $e.changeMode(De.mode,De,Ve),Je(!0);if(De.mode===Five.Mode.Floorplan||(Fe.preload&&De.panoIndex!==void 0&&De.panoIndex!==$e.panoIndex&&await $e.preloadPano(De.panoIndex),Fe.asyncEndCallback?.(),De.panoIndex===void 0&&De.fov===void 0&&De.latitude===void 0&&De.longitude===void 0))return Je(!0);const Ke=De.panoIndex!==void 0?De.panoIndex:$e.panoIndex;if(Ke!==void 0){const Ye=performance.now();await $e.ready();const or=Object.assign({},De,{duration:Ve-(performance.now()-Ye),moveEndCallback:()=>Je(!0),moveCancelCallback:()=>{Je(!0)},effect:De.transEffect||"fly"});await $e.moveToPano(Ke,or)}else Xe(!1)}),rotate:async(De,Ve,Fe={})=>{moving=!1,Fe.asyncStartCallback?.(),De.mode&&$e.currentMode!==De.mode&&await $e.changeMode(De.mode,De.mode===Five.Mode.Panorama?{latitude:0}:void 0),De.mode===Five.Mode.Panorama&&$e.currentMode===Five.Mode.Panorama&&De.panoIndex!==void 0&&De.panoIndex!==$e.panoIndex&&(Fe.preload&&await $e.preloadPano(De.panoIndex),await new Promise((cr,Br)=>{$e.moveToPano(De.panoIndex,{moveEndCallback:()=>cr(!0),moveCancelCallback:()=>Br(!1),effect:"fade"})})),await $e.ready(),Fe.asyncEndCallback?.();const Je=$e.getCurrentState(),Xe=De;let Ke=!1;const Ye=performance.now();let or=Ve;De.rotation===Rotation.Loop&&(or=De.rotateSpeed?Math.ceil(Math.abs(Xe.longitude-Je.longitude)/De.rotateSpeed*1e3):Ve,or=Math.min(Ve,or));const sr=()=>{if(Ke||moving){$e.off("renderFrame",sr);return}let cr={};if(De.rotation!==Rotation.Loop){const Br=(performance.now()-Ye)/Ve;cr={fov:progressNumber(Je.fov,Xe.fov,Br),latitude:progressNumber(Je.latitude,Xe.latitude,Br),longitude:progressLongitude(Je.longitude,Xe.longitude,De.rotation,Br)}}else{const Br=(performance.now()-Ye)/or,tn=Math.floor(Br),en=Br-tn,rn=tn%2===1?1-en:en;cr={fov:progressNumber(Je.fov,Xe.fov,rn),latitude:progressNumber(Je.latitude,Xe.latitude,rn),longitude:progressNumber(Je.longitude,Xe.longitude,rn)}}$e.setState(cr,!0)};return $e.on("renderFrame",sr),await new Promise(cr=>{setTimeout(()=>{Ke=!0,$e.off("renderFrame",sr),cr(!0)},Ve)})}});function CameraMovement(){const $e=useController(),Se=useFiveInstance(),Be=reactExports.useRef();return reactExports.useEffect(()=>{const De=async Ve=>{Be.current||(Be.current=CameraMovementPlugin(Se));const{start:Fe,end:Je,data:Xe}=Ve,Ke=Xe,Ye=Ke.effect,or=Je-Fe;Ye===CameraMovementEffect.Rotate?await Be.current.rotate(Xe,or):Ye===CameraMovementEffect.Move?await Be.current.move(Xe,or):Ke.panoIndex!==void 0&&Ke.panoIndex!==Se.panoIndex?await Be.current.move(Xe,or):await Be.current.rotate(Xe,or)};return $e.on(VreoKeyframeEnum.CameraMovement,De),()=>{$e.off(VreoKeyframeEnum.CameraMovement,De)}},[$e]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}const resizeObserverCache=new Map;function addResizeListener($e,Se,Be=!0){if(!$e)return()=>{};if(Be&&Se($e.clientWidth,$e.clientHeight),typeof ResizeObserver<"u"&&ResizeObserver){const De=new ResizeObserver(()=>Se($e.clientWidth,$e.clientHeight));return De.observe($e),resizeObserverCache.set($e,resizeObserverCache.get($e)||1),()=>{$e&&De.unobserve($e),resizeObserverCache.get($e)===1&&resizeObserverCache.delete($e)}}else{const De=document.createElement("iframe");return De.style.cssText="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;opacity:0;visibility:hidden;margin:0;border:0;padding:0;z-index:-1;",De.classList.add("resize-sensor-iframe"),$e.appendChild(De),De.contentWindow?(De.contentWindow.addEventListener("resize",()=>{Se(De.clientWidth,De.clientHeight)}),resizeObserverCache.set($e,resizeObserverCache.get($e)||1),()=>{$e.removeChild(De),resizeObserverCache.get($e)===1&&resizeObserverCache.delete($e)}):()=>{}}}function hasResizeListener($e){return $e&&resizeObserverCache.get($e)||!1}function ResizeObserver$1(){const $e=React.useRef(null),Se=useController();return React.useEffect(()=>{if(!$e.current)return;const Be=Se.container.parentElement;if(hasResizeListener(Be))return;const De=addResizeListener(Be,(Ve,Fe)=>{Se.setContainerSize(Ve,Fe)});return()=>{De()}},[]),jsxRuntimeExports.jsx("div",{className:"resizeObserver-element",ref:$e})}const isWX=navigator.userAgent.toLowerCase().indexOf("micromessenger")!==-1,isIOS=navigator.userAgent.toLowerCase().indexOf("iphone")!==-1,isIOSorWX=isIOS||isWX,_videoElement=document.createElement("video");_videoElement.setAttribute("playsinline","true");_videoElement.setAttribute("webkit-playsinline","true");isIOSorWX&&_videoElement.paused&&_videoElement.addEventListener("click",()=>_videoElement.play(),{once:!0});function InfoPanelImg({url:$e,children:Se}){return jsxRuntimeExports.jsx("div",{className:"vreo-infoPanel-container",children:jsxRuntimeExports.jsxs("div",{className:"vreo-infoPanel",children:[Se,jsxRuntimeExports.jsx("img",{src:$e})]})})}function InfoPanelVideo({url:$e,children:Se}){const Be=reactExports.useRef(null),De=useController();return reactExports.useEffect(()=>{const Ve=De.configs?.videos?.videoPanel||_videoElement;if(!Be.current)return;Ve.src=$e,Be.current.contains(Ve)||Be.current.appendChild(Ve);const Fe=()=>{Ve.removeEventListener("canplaythrough",Fe);try{Ve.play()}catch{}};return Ve.addEventListener("canplaythrough",Fe),Ve.load(),()=>{Ve.pause(),Be.current?.contains(Ve)&&Be.current.removeChild(Ve)}},[Be.current]),jsxRuntimeExports.jsx("div",{className:"vreo-infoPanel-container",children:jsxRuntimeExports.jsxs("div",{className:"vreo-infoPanel",children:[Se,jsxRuntimeExports.jsx("div",{className:"vreo-infoPanel-inner",ref:Be})]})})}const Title=$e=>!$e.title&&!$e.subTitle?null:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"vreo-infoPanel-title",children:[jsxRuntimeExports.jsx("div",{className:"vreo-infoPanel-t1",children:$e.title}),jsxRuntimeExports.jsx("div",{className:"vreo-infoPanel-t2",children:$e.subTitle})]})});function InfoPanel(){const $e=reactExports.useRef(),Se=useController();return reactExports.useEffect(()=>{if(Se.configs?.keyframeMap.InfoPanel===!1)return;const Be=De=>{const{start:Ve,end:Fe,data:Je}=De,Xe=Je,{title:Ke,subTitle:Ye,style:or}=Xe;do{if(or===InfoPanelStyleEnum.PopUp){Xe.type===InfoPanelTypeEnum.Image?Se.openPopUp(jsxRuntimeExports.jsx(InfoPanelImg,{url:Xe.url,children:jsxRuntimeExports.jsx(Title,{title:Ke,subTitle:Ye})})):Xe.type===InfoPanelTypeEnum.Video&&Se.openPopUp(jsxRuntimeExports.jsx(InfoPanelVideo,{url:Xe.url,children:jsxRuntimeExports.jsx(Title,{title:Ke,subTitle:Ye})}));break}Xe.type===InfoPanelTypeEnum.Image?Se.openDrawer({content:jsxRuntimeExports.jsx(InfoPanelImg,{url:Xe.url,children:jsxRuntimeExports.jsx(Title,{title:Ke,subTitle:Ye})}),height:"60vh"}):Xe.type===InfoPanelTypeEnum.Video&&Se.openDrawer({content:jsxRuntimeExports.jsx(InfoPanelVideo,{url:Xe.url,children:jsxRuntimeExports.jsx(Title,{title:Ke,subTitle:Ye})}),height:"60vh"})}while(!1);$e.current=setTimeout(()=>{Se.openDrawer(!1),Se.openPopUp(!1)},Fe-Ve)};return Se.on(VreoKeyframeEnum.InfoPanel,Be),Se.on("ended",()=>{Se.openPopUp(!1)}),Se.on("paused",()=>{Se.openPopUp(!1)}),()=>{Se.off(VreoKeyframeEnum.InfoPanel,Be),$e.current&&clearTimeout($e.current)}},[Se]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}const ModelTVVideoPlugin=($e,{videoElement:Se})=>{const Be={videoMeshes:[],videoTextureEnabled:!1,videoSource:"",rectPoints:[],enabled:!1,videoElement:Se},De=sr=>{Be.videoTexture&&(Be.videoTexture.image.muted=sr,Be.videoTexture.image.play())},Ve=()=>Be.videoTexture?Be.videoTexture.image.muted:!0,Fe=()=>{if(Be.enabled||!Be.videoTexture)return;Be.enabled=!0,Be.videoMeshes=Xe(),Be.videoMeshes.forEach(cr=>$e.scene.add(cr));const sr=()=>{if(!Be.videoTexture)return;const cr=()=>{Be.videoTexture&&(Be.videoTexture?.image.removeEventListener("timeupdate",cr),Be.videoTextureEnabled=!0,Be.videoMeshes.forEach(Br=>{Br.material.map!==Be.videoTexture&&(Br.material.map=Be.videoTexture)}),$e.needsRender=!0)};Be.videoTexture.image.addEventListener("timeupdate",cr),Be.videoTexture&&Be.videoMeshes.length&&Be.videoTexture.image.play()};if($e.model.loaded)sr();else return $e.once("modelLoaded",()=>sr())},Je=()=>{Be.enabled&&(Be.enabled=!1,Be.videoMeshes.forEach(sr=>{sr.geometry.dispose(),sr.material.dispose(),$e.scene.remove(sr),Be.videoTexture&&Be.videoTexture.image.pause()}),Be.videoMeshes=[],$e.needsRender=!0)},Xe=()=>Be.rectPoints.map((sr,cr)=>{const Br=new BufferGeometry,tn=128,en=[];en.push(sr[0].x,sr[0].y,sr[0].z);for(let ln=1;ln<tn;ln++)en.push(sr[0].x+(sr[1].x-sr[0].x)*ln/tn,sr[0].y+(sr[1].y-sr[0].y)*ln/tn,sr[0].z+(sr[1].z-sr[0].z)*ln/tn);en.push(sr[1].x,sr[1].y,sr[1].z),en.push(sr[2].x,sr[2].y,sr[2].z);for(let ln=1;ln<tn;ln++)en.push(sr[2].x+(sr[3].x-sr[2].x)*ln/tn,sr[2].y+(sr[3].y-sr[2].y)*ln/tn,sr[2].z+(sr[3].z-sr[2].z)*ln/tn);en.push(sr[3].x,sr[3].y,sr[3].z);const an=[];an.push(0,1);for(let ln=1;ln<tn;ln++)an.push(0,1-ln/tn);an.push(0,0),an.push(1,0);for(let ln=1;ln<tn;ln++)an.push(1,ln/tn);an.push(1,1);const rn=[];for(let ln=0;ln<tn;ln++)rn.push(ln,ln+1,tn*2-ln,ln,tn*2-ln,tn*2+1-ln);Br.setAttribute("position",new BufferAttribute(new Float32Array(en),3)),Br.setAttribute("uv",new BufferAttribute(new Float32Array(an),2)),Br.setIndex(new BufferAttribute(new Uint32Array(rn),1));const on=new MeshBasicMaterial({map:Be.videoTextureEnabled?Be.videoTexture:Be.imageTexture,side:DoubleSide}),sn=new Mesh(Br,on);return sn.renderOrder=1,sn.name=`video-${cr}-${performance.now()}`,sn}),Ke=sr=>{const cr=new TextureLoader$1().load(sr);return cr.minFilter=LinearFilter,cr.magFilter=LinearFilter,cr.format=RGBFormat,cr},Ye=(sr,cr)=>new Promise((Br,tn)=>{const en=new XMLHttpRequest;en.onreadystatechange=()=>{if(en.readyState==4)if(en.status==200){const an=window.URL||window.webkitURL;cr=cr||document.createElement("video"),cr.crossOrigin="anonymous",cr.autoplay=!0,cr.muted=!0,cr.loop=!0,cr.playsInline=!0,cr.src=an.createObjectURL(en.response);const rn=new VideoTexture(cr);rn.minFilter=LinearFilter,rn.magFilter=LinearFilter,rn.format=RGBFormat,Br(Object.assign(rn,{videoSource:sr}))}else tn(new Error("Video download Error: "+en.status))},en.onerror=an=>tn(an),en.open("GET",sr),en.responseType="blob",en.send()}),or=async(sr,cr)=>{const{video_src:Br,video_poster_src:tn,points:en}=sr;Be.videoSource=Br,Be.rectPoints=en.map(an=>an.map(({x:rn,y:on,z:sn})=>new Vector3(rn,on,sn))),Be.imageTexture=Ke(tn),cr&&(Be.videoElement=cr),Be.videoTexture=await Ye(Be.videoSource,Be.videoElement),Be.enabled=!!sr.enable,Be.enabled&&Fe()};return $e.on("modeChange",()=>De(!0)),$e.on("wantsTapGesture",sr=>{if(!Be.enabled)return;const[cr]=sr.intersectObjects($e.scene.children,!0);if(cr&&/^video/.test(cr.object.name))return Be.videoTexture&&De(!Be.videoTexture.image.muted),!1}),$e.on("panoArrived",()=>{if(!Be.enabled||Ve())return;const sr=$e.camera.position;Be.rectPoints.find(Br=>{const tn=Br.reduce((en,an)=>new Vector3(en.x+an.x/Br.length,en.y+an.y/Br.length,en.z+an.z/Br.length),new Vector3);return Br.map(en=>new Vector3((en.x+tn.x)/2,(en.y+tn.y)/2,(en.z+tn.z)/2)).filter(en=>{en=en.clone().sub(sr).normalize();const an=new Raycaster(sr,en),[rn]=an.intersectObjects($e.scene.children,!0);return!!rn&&/^video/.test(rn.object.name)}).length>=2})||De(!0)}),$e.on("renderFrame",()=>{Be.videoMeshes.forEach(sr=>{sr&&(sr.needsRender=!0)})}),$e.on("load",sr=>{sr.modelTVVideoData&&or(sr.modelTVVideoData)}),{enable:Fe,disable:Je,load:or}};function createTransMatrix($e){const Se=new Matrix4;return Se.fromArray($e),Be=>{const De=new Vector3(...Be);return De.applyMatrix4(Se),De.toArray()}}function ModelVideo(){const $e=useController(),Se=useFiveInstance(),Be=reactExports.useRef(),De=reactExports.useRef();return reactExports.useEffect(()=>{const Ve=async Fe=>{Be.current||(Be.current=ModelTVVideoPlugin(Se,{}));const{start:Je,end:Xe}=Fe,{videoSrc:Ke,videoPosterSrc:Ye,vertexs:or,matrixWorld:sr}=Fe.data,cr=(()=>{if(or.length<4)throw new Error("ModelVideo: 顶点数据集合不够，无法组成矩形 ....");if(or.length===4)return or;const tn=new Box3;return or.forEach(en=>tn.expandByPoint(new Vector3(en.x,en.y,en.z))),[new Vector3(tn.min.x,tn.max.y,tn.max.z),new Vector3(tn.min.x,tn.min.y,tn.max.z),new Vector3(tn.max.x,tn.min.y,tn.max.z),new Vector3(tn.max.x,tn.max.y,tn.max.z)]})(),Br=(()=>{if(sr){const tn=createTransMatrix(sr);return[cr.map(en=>{const an=tn([en.x,en.y,en.z]);return{x:an[0],y:an[1],z:an[2]}})]}return[cr]})();Be.current.disable(),await Be.current.load({video_src:Ke,video_poster_src:Ye,points:Br},$e.configs?.videos?.modelTVVideo),Be.current.enable(),De.current=setTimeout(()=>Be.current?.disable(),Xe-Je)};return $e.on(VreoKeyframeEnum.ModelVideo,Ve),()=>{$e.off(VreoKeyframeEnum.ModelVideo,Ve),De.current&&clearTimeout(De.current)}},[$e]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}var E$w=function($e,Se){return E$w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Be,De){Be.__proto__=De}||function(Be,De){for(var Ve in De)Object.prototype.hasOwnProperty.call(De,Ve)&&(Be[Ve]=De[Ve])},E$w($e,Se)};function A$A($e,Se){if(typeof Se!="function"&&Se!==null)throw new TypeError("Class extends value "+String(Se)+" is not a constructor or null");E$w($e,Se);function Be(){this.constructor=$e}$e.prototype=Se===null?Object.create(Se):(Be.prototype=Se.prototype,new Be)}var B$r=function($e){A$A(Se,$e);function Se(){var Be=$e.call(this)||this;Be.type="LineSegmentsGeometry";var De=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],Ve=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],Fe=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];return Be.setIndex(Fe),Be.setAttribute("position",new Float32BufferAttribute(De,3)),Be.setAttribute("uv",new Float32BufferAttribute(Ve,2)),Be}return Se.prototype.applyMatrix4=function(Be){var De=this.attributes.instanceStart,Ve=this.attributes.instanceEnd;return De!==void 0&&(De.applyMatrix4(Be),Ve.applyMatrix4(Be),De.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},Se.prototype.setPositions=function(Be){var De;Be instanceof Float32Array?De=Be:Array.isArray(Be)?De=new Float32Array(Be):De=new Float32Array;var Ve=new InstancedInterleavedBuffer(De,6,1);return this.setAttribute("instanceStart",new InterleavedBufferAttribute(Ve,3,0)),this.setAttribute("instanceEnd",new InterleavedBufferAttribute(Ve,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},Se.prototype.setColors=function(Be){var De;Be instanceof Float32Array?De=Be:Array.isArray(Be)?De=new Float32Array(Be):De=new Float32Array;var Ve=new InstancedInterleavedBuffer(De,6,1);return this.setAttribute("instanceColorStart",new InterleavedBufferAttribute(Ve,3,0)),this.setAttribute("instanceColorEnd",new InterleavedBufferAttribute(Ve,3,3)),this},Se.prototype.fromWireframeGeometry=function(Be){return this.setPositions(Be.attributes.position.array),this},Se.prototype.fromEdgesGeometry=function(Be){return this.setPositions(Be.attributes.position.array),this},Se.prototype.fromMesh=function(Be){return this.fromWireframeGeometry(new WireframeGeometry(Be.geometry)),this},Se.prototype.fromLineSegments=function(Be){var De=Be.geometry;if(De instanceof Geometry){var Ve=new BufferGeometry().fromGeometry(De);this.setPositions(Ve.attributes.position.array)}else De instanceof BufferGeometry&&this.setPositions(De.attributes.position.array);return this},Se.prototype.computeBoundingBox=function(){this.boundingBox===null&&(this.boundingBox=new Box3);var Be=this.attributes.instanceStart,De=this.attributes.instanceEnd;if(Be!==void 0&&De!==void 0){var Ve=new Box3;this.boundingBox.setFromBufferAttribute(Be),Ve.setFromBufferAttribute(De),this.boundingBox.union(Ve)}},Se.prototype.computeBoundingSphere=function(){this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingBox===null&&this.computeBoundingBox();var Be=this.attributes.instanceStart,De=this.attributes.instanceEnd;if(Be!==void 0&&De!==void 0){var Ve=this.boundingSphere.center;this.boundingBox.getCenter(Ve);for(var Fe=0,Je=new Vector3,Xe=0,Ke=Be.count;Xe<Ke;Xe++)Je.fromBufferAttribute(Be,Xe),Fe=Math.max(Fe,Ve.distanceToSquared(Je)),Je.fromBufferAttribute(De,Xe),Fe=Math.max(Fe,Ve.distanceToSquared(Je));this.boundingSphere.radius=Math.sqrt(Fe),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}},Se.prototype.toJSON=function(){},Se}(InstancedBufferGeometry);Object.assign(B$r.prototype,{isLineSegmentsGeometry:!0});var x$u={uniforms:UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,{linewidth:{value:1},resolution:{value:new Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1},opacity:{value:1}}]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		varying vec2 vUv;

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;

			#endif

			float aspect = resolution.x / resolution.y;

			vUv = uv;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec2 ndcStart = clipStart.xy / clipStart.w;
			vec2 ndcEnd = clipEnd.xy / clipEnd.w;

			// direction
			vec2 dir = ndcEnd - ndcStart;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			// perpendicular to dir
			vec2 offset = vec2( dir.y, - dir.x );

			// undo aspect ratio adjustment
			dir.x /= aspect;
			offset.x /= aspect;

			// sign flip
			if ( position.x < 0.0 ) offset *= - 1.0;

			// endcaps
			if ( position.y < 0.0 ) {

				offset += - dir;

			} else if ( position.y > 1.0 ) {

				offset += dir;

			}

			// adjust for linewidth
			offset *= linewidth;

			// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
			offset /= resolution.y;

			// select end
			vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

			// back to clip space
			offset *= clip.w;

			clip.xy += offset;

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;

		#ifdef USE_DASH

			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		varying vec2 vUv;

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			if ( abs( vUv.y ) > 1.0 ) {

				float a = vUv.x;
				float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
				float len2 = a * a + b * b;

				if ( len2 > 1.0 ) discard;

			}

			vec4 diffuseColor = vec4( diffuse, opacity );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );

			#include <tonemapping_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`},L$o=function($e){A$A(Se,$e);function Se(Be){var De=$e.call(this,{uniforms:UniformsUtils.clone(x$u.uniforms),vertexShader:x$u.vertexShader,fragmentShader:x$u.fragmentShader,clipping:!0})||this;return De.type="LineMaterial",De.dashed=!1,Object.defineProperties(De,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(Ve){this.uniforms.diffuse.value=Ve}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(Ve){this.uniforms.linewidth.value=Ve}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(Ve){this.uniforms.dashScale.value=Ve}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(Ve){this.uniforms.dashSize.value=Ve}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(Ve){this.uniforms.gapSize.value=Ve}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(Ve){this.uniforms.opacity.value=Ve}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(Ve){this.uniforms.resolution.value.copy(Ve)}}}),De.setValues(Be),De}return Se}(ShaderMaterial);Object.assign(L$o.prototype,{isLineMaterial:!0});var F$l=function($e){A$A(Se,$e);function Se(Be,De){var Ve=$e.call(this)||this;return Ve.type="LineSegments2",Ve.geometry=Be!==void 0?Be:new B$r,Ve.material=De!==void 0?De:new L$o({color:Math.random()*16777215}),Ve}return Se.prototype.computeLineDistances=function(){for(var Be=this.geometry,De=Be.attributes.instanceStart,Ve=Be.attributes.instanceEnd,Fe=new Float32Array(2*De.count),Je=new Vector3,Xe=new Vector3,Ke=0,Ye=0,or=De.count;Ke<or;Ke++,Ye+=2)Je.fromBufferAttribute(De,Ke),Xe.fromBufferAttribute(Ve,Ke),Fe[Ye]=Ye===0?0:Fe[Ye-1],Fe[Ye+1]=Fe[Ye]+Je.distanceTo(Xe);var sr=new InstancedInterleavedBuffer(Fe,2,1);return Be.setAttribute("instanceDistanceStart",new InterleavedBufferAttribute(sr,1,0)),Be.setAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(sr,1,1)),this},Se.prototype.raycast=function(Be,De){Be.camera===null&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var Ve=Be.ray,Fe=Be.camera,Je=Fe.projectionMatrix,Xe=this.geometry,Ke=this.material,Ye=Ke.resolution,or=Ke.linewidth,sr=Xe.attributes.instanceStart,cr=Xe.attributes.instanceEnd,Br=new Vector4,tn=new Vector4,en=new Vector4,an=new Vector3,rn=new Matrix4,on=new Line3,sn=new Vector3;Ve.at(1,en),en.w=1,en.applyMatrix4(Fe.matrixWorldInverse),en.applyMatrix4(Je),en.multiplyScalar(1/en.w),en.x*=Ye.x/2,en.y*=Ye.y/2,en.z=0,an.copy(en);var ln=this.matrixWorld;rn.multiplyMatrices(Fe.matrixWorldInverse,ln);for(var cn=0,hn=sr.count;cn<hn;cn++){Br.fromBufferAttribute(sr,cn),tn.fromBufferAttribute(cr,cn),Br.w=1,tn.w=1,Br.applyMatrix4(rn),tn.applyMatrix4(rn),Br.applyMatrix4(Je),tn.applyMatrix4(Je),Br.multiplyScalar(1/Br.w),tn.multiplyScalar(1/tn.w);var mn=Br.z<-1&&tn.z<-1,An=Br.z>1&&tn.z>1;if(!(mn||An)){Br.x*=Ye.x/2,Br.y*=Ye.y/2,tn.x*=Ye.x/2,tn.y*=Ye.y/2,on.start.copy(Br),on.start.z=0,on.end.copy(tn),on.end.z=0;var xn=on.closestPointToPointParameter(an,!0);on.at(xn,sn);var pn=MathUtils.lerp(Br.z,tn.z,xn),dn=pn>=-1&&pn<=1,fn=an.distanceTo(sn)<or*.5;if(dn&&fn){on.start.fromBufferAttribute(sr,cn),on.end.fromBufferAttribute(cr,cn),on.start.applyMatrix4(ln),on.end.applyMatrix4(ln);var yn=new Vector3,Sn=new Vector3;Ve.distanceSqToSegment(on.start,on.end,Sn,yn),De.push({point:Sn,pointOnLine:yn,distance:Ve.origin.distanceTo(Sn),object:this,faceIndex:cn})}}}},Se}(Mesh);Object.assign(F$l.prototype,{isLineSegments2:!0});var I$r=function($e){A$A(Se,$e);function Se(Be,De){var Ve=$e.call(this,Be,De)||this;return Ve.type="Line2",Ve}return Se}(F$l);Object.assign(I$r.prototype,{isLine2:!0});var O$m=function($e){A$A(Se,$e);function Se(){var Be=$e.call(this)||this;return Be.type="LineGeometry",Be}return Se.prototype.setPositions=function(Be){for(var De=Be.length-3,Ve=new Float32Array(2*De),Fe=0;Fe<De;Fe+=3)Ve[2*Fe]=Be[Fe],Ve[2*Fe+1]=Be[Fe+1],Ve[2*Fe+2]=Be[Fe+2],Ve[2*Fe+3]=Be[Fe+3],Ve[2*Fe+4]=Be[Fe+4],Ve[2*Fe+5]=Be[Fe+5];return $e.prototype.setPositions.call(this,Ve),this},Se.prototype.setColors=function(Be){for(var De=Be.length-3,Ve=new Float32Array(2*De),Fe=0;Fe<De;Fe+=3)Ve[2*Fe]=Be[Fe],Ve[2*Fe+1]=Be[Fe+1],Ve[2*Fe+2]=Be[Fe+2],Ve[2*Fe+3]=Be[Fe+3],Ve[2*Fe+4]=Be[Fe+4],Ve[2*Fe+5]=Be[Fe+5];return $e.prototype.setColors.call(this,Ve),this},Se.prototype.fromLine=function(Be){var De=Be.geometry;if(De instanceof Geometry){var Ve=new BufferGeometry().fromGeometry(De);this.setPositions(Ve.attributes.position.array)}else De instanceof BufferGeometry&&this.setPositions(De.attributes.position.array);return this},Se.prototype.copy=function(){return this},Se}(B$r);Object.assign(O$m.prototype,{isLineGeometry:!0});var T$n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sHDgwCEMBJZu0AAAAdaVRYdENvbW1lbnQAAAAAAENyZWF0ZWQgd2l0aCBHSU1QZC5lBwAABM5JREFUWMO1V0tPG2cUPZ4Hxh6DazIOrjFNqJs0FIMqWFgWQkatsmvVbtggKlSVRVf5AWz4AWz4AUSKEChll19QJYSXkECuhFxsHjEhxCYm+DWGMZ5HF72DJq4bAzFXurI0M/I5997v3u9cC65vTJVn2lX/xHINQOYSBLTLEuIuCWw4Z3IGAEvf6ASmVHjNzHCXBG4A0AjACsAOwEbO0nsFQBnAGYASAIl+ZRMR7SolMEdsByD09fV5R0ZGgg8ePPjW5/N1iqLYpuu6RZblciKR2I9Go69evnwZnZ+fjwI4IS8AKBIRzeQfJWCANwKwh0KhtrGxsYehUOin1tbW+zzP23ietzY2NnIAoGmaLsuyUiqVyvl8XtrY2NiamZn589mzZxsAUgCOAeQAnFI2tI+VxIjaAeDzoaGh7xYWFuZOTk6OZVk+12uYqqq6JEnn0Wg0OT4+/geAXwGEAdwDIFJQXC1wO4DWR48e/RCPxxclSSroVzRFUbSDg4P848ePFwH8DuAhkWih83TRQWxFOXgAwvDwcOfo6OhvXV1d39tsNtuVBwTDWBwOh1UUxVsMw1hXVlbSdCgNV43uYSvrHg6H24aHh38eHBz85TrgF9FYLHA4HLzH43FvbW2d7u/vG+dANp8FpqIlbd3d3V8Fg8EfBUFw4BONZVmL3+9vHhkZCQL4AoAHgJPK8G+yzC0XDofdoVAo5PP5vkadTBAEtr+/39ff3x8gAp/RPOEqx2qjx+NpvXv3bk9DQ0NDvQgwDIOWlhZrMBj8kgi0UJdxRgYMArzL5XJ7vd57qLPZ7Xamp6fnNgBXtQxcjFuHw+Hyer3t9SYgCAITCAScAJoBNNEY/08GOFVVrfVMv7kMNDntFD1vjIAPrlRN0xjckOm6biFQ3jwNPwDMZrOnqVTqfb3Bi8Wivru7W/VCYkwPlKOjo0IikXh7EwQikYgE4Nw0CfXKDCipVCoTj8df3QABbW1tLUc6oUgkFPMkVACUNjc337148eKvw8PDbJ2jP1taWkoCyNDVXDSECmNSK4qiKNLq6urW8+fPI/UicHx8rD59+jSVy+WOAKSJhKENwFItLtoxk8mwsixzHR0dHe3t7c5PAU+n09rs7OzJkydPYqVSaQfANoDXALIk31S2smU1TWMPDg7K5XKZ7+3t9TudTut1U7+wsFCcmJiIpdPpbQBxADsAknQWymYCOukBHYCuKApisdhpMpnURFEU79y503TVyKenpzOTk5M7e3t7MQKPV0Zv1gNm+awB0MvlshqLxfLb29uyJElWURSbXC4XXyvqxcXFs6mpqeTc3Nzu3t7e3wQcA7BPZ8Cov1pNlJplmQtAG8MwHV6v95tAINA5MDBwPxAIuLu6upr8fr/VAN3c3JQjkcjZ+vp6fnl5+d2bN29SuVzuNYAEpf01CdRChUL+X1VskHACuA3Ay3Fcu9vt7nA6nZ7m5uYWQRCaNE3jVVW15PP580KhIGUymWw2m00DOAJwSP4WwPtq4LX2Ao6USxNlQyS/RcQcdLGwlNIz6vEMAaZpNzCk2Pll94LK/cDYimxERiBwG10sxjgvEZBE0UpE6vxj+0Ct5bTaXthgEhRmja8QWNkkPGsuIpfdjpkK+cZUWTC0KredVmtD/gdlSl6EG4AMvQAAAABJRU5ErkJggg==",V$d=14467195,H$r=8,R$p=2,k$p=20,D$r=null,Q$e=function($e){A$A(Se,$e);function Se(Be,De){Be===void 0&&(Be=new Vector3),De===void 0&&(De=new Vector3);var Ve=$e.call(this)||this;Ve.type="FiveLine",Ve.needsRender=!0;var Fe=new O$m,Je=new L$o({color:V$d,linewidth:R$p,dashScale:k$p,dashed:!1});Ve.line=new I$r(Fe,Je);var Xe=new BufferGeometry,Ke=new PointsMaterial({color:V$d,size:H$r,map:D$r||(D$r=new TextureLoader$1().load(T$n)),sizeAttenuation:!1,transparent:!0});return Ve.points=new Points(Xe,Ke),Ve.points.renderOrder=11,Ve.points.frustumCulled=!1,Ve.setPoints(Be,De),Ve.add(Ve.line,Ve.points),Ve}return Object.defineProperty(Se,"version",{get:function(){return"6.4.0-alpha.38"},enumerable:!1,configurable:!0}),Se.prototype.setPoints=function(Be,De){var Ve=[].concat(Be.toArray(),De.toArray());this.points.geometry.setAttribute("position",new BufferAttribute(new Float32Array(Ve),3)),this.line.geometry.setPositions(Ve),this.line.computeLineDistances(),this.needsRender=!0},Se.prototype.getPoints=function(){var Be=this.points.geometry.attributes.position.array;return[new Vector3(Be[0],Be[1],Be[2]),new Vector3(Be[3],Be[4],Be[5])]},Se.prototype.setMaterial=function(Be){var De=this.line.material;for(var Ve in Be)if(Be.hasOwnProperty(Ve)){var Fe=Be[Ve];Ve==="dashed"?(De.dashed=Fe,Fe?De.defines.USE_DASH="":delete De.defines.USE_DASH,De.needsUpdate=!0):De[Ve]=Be[Ve]}this.needsRender=!0},Se.prototype.setResolution=function(Be,De){var Ve=this.line.material.resolution;(Ve.x!==Be||Ve.y!==De)&&(Ve.set(Be,De),this.needsRender=!0)},Se}(Object3D);Object.assign(Q$e.prototype,{isFiveLine:!0});var Easing={Linear:{None:function($e){return $e}},Quadratic:{In:function($e){return $e*$e},Out:function($e){return $e*(2-$e)},InOut:function($e){return($e*=2)<1?.5*$e*$e:-.5*(--$e*($e-2)-1)}},Cubic:{In:function($e){return $e*$e*$e},Out:function($e){return--$e*$e*$e+1},InOut:function($e){return($e*=2)<1?.5*$e*$e*$e:.5*(($e-=2)*$e*$e+2)}},Quartic:{In:function($e){return $e*$e*$e*$e},Out:function($e){return 1- --$e*$e*$e*$e},InOut:function($e){return($e*=2)<1?.5*$e*$e*$e*$e:-.5*(($e-=2)*$e*$e*$e-2)}},Quintic:{In:function($e){return $e*$e*$e*$e*$e},Out:function($e){return--$e*$e*$e*$e*$e+1},InOut:function($e){return($e*=2)<1?.5*$e*$e*$e*$e*$e:.5*(($e-=2)*$e*$e*$e*$e+2)}},Sinusoidal:{In:function($e){return 1-Math.cos($e*Math.PI/2)},Out:function($e){return Math.sin($e*Math.PI/2)},InOut:function($e){return .5*(1-Math.cos(Math.PI*$e))}},Exponential:{In:function($e){return $e===0?0:Math.pow(1024,$e-1)},Out:function($e){return $e===1?1:1-Math.pow(2,-10*$e)},InOut:function($e){return $e===0?0:$e===1?1:($e*=2)<1?.5*Math.pow(1024,$e-1):.5*(-Math.pow(2,-10*($e-1))+2)}},Circular:{In:function($e){return 1-Math.sqrt(1-$e*$e)},Out:function($e){return Math.sqrt(1- --$e*$e)},InOut:function($e){return($e*=2)<1?-.5*(Math.sqrt(1-$e*$e)-1):.5*(Math.sqrt(1-($e-=2)*$e)+1)}},Elastic:{In:function($e){return $e===0?0:$e===1?1:-Math.pow(2,10*($e-1))*Math.sin(($e-1.1)*5*Math.PI)},Out:function($e){return $e===0?0:$e===1?1:Math.pow(2,-10*$e)*Math.sin(($e-.1)*5*Math.PI)+1},InOut:function($e){return $e===0?0:$e===1?1:($e*=2,$e<1?-.5*Math.pow(2,10*($e-1))*Math.sin(($e-1.1)*5*Math.PI):.5*Math.pow(2,-10*($e-1))*Math.sin(($e-1.1)*5*Math.PI)+1)}},Back:{In:function($e){var Se=1.70158;return $e*$e*((Se+1)*$e-Se)},Out:function($e){var Se=1.70158;return--$e*$e*((Se+1)*$e+Se)+1},InOut:function($e){var Se=2.5949095;return($e*=2)<1?.5*($e*$e*((Se+1)*$e-Se)):.5*(($e-=2)*$e*((Se+1)*$e+Se)+2)}},Bounce:{In:function($e){return 1-Easing.Bounce.Out(1-$e)},Out:function($e){return $e<1/2.75?7.5625*$e*$e:$e<2/2.75?7.5625*($e-=1.5/2.75)*$e+.75:$e<2.5/2.75?7.5625*($e-=2.25/2.75)*$e+.9375:7.5625*($e-=2.625/2.75)*$e+.984375},InOut:function($e){return $e<.5?Easing.Bounce.In($e*2)*.5:Easing.Bounce.Out($e*2-1)*.5+.5}}},now;typeof self>"u"&&typeof process<"u"&&process.hrtime?now=function(){var $e=process.hrtime();return $e[0]*1e3+$e[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?now=self.performance.now.bind(self.performance):Date.now!==void 0?now=Date.now:now=function(){return new Date().getTime()};var now$1=now,Group=function(){function $e(){this._tweens={},this._tweensAddedDuringUpdate={}}return $e.prototype.getAll=function(){var Se=this;return Object.keys(this._tweens).map(function(Be){return Se._tweens[Be]})},$e.prototype.removeAll=function(){this._tweens={}},$e.prototype.add=function(Se){this._tweens[Se.getId()]=Se,this._tweensAddedDuringUpdate[Se.getId()]=Se},$e.prototype.remove=function(Se){delete this._tweens[Se.getId()],delete this._tweensAddedDuringUpdate[Se.getId()]},$e.prototype.update=function(Se,Be){Se===void 0&&(Se=now$1()),Be===void 0&&(Be=!1);var De=Object.keys(this._tweens);if(De.length===0)return!1;for(;De.length>0;){this._tweensAddedDuringUpdate={};for(var Ve=0;Ve<De.length;Ve++){var Fe=this._tweens[De[Ve]],Je=!Be;Fe&&Fe.update(Se,Je)===!1&&!Be&&delete this._tweens[De[Ve]]}De=Object.keys(this._tweensAddedDuringUpdate)}return!0},$e}(),Interpolation={Linear:function($e,Se){var Be=$e.length-1,De=Be*Se,Ve=Math.floor(De),Fe=Interpolation.Utils.Linear;return Se<0?Fe($e[0],$e[1],De):Se>1?Fe($e[Be],$e[Be-1],Be-De):Fe($e[Ve],$e[Ve+1>Be?Be:Ve+1],De-Ve)},Bezier:function($e,Se){for(var Be=0,De=$e.length-1,Ve=Math.pow,Fe=Interpolation.Utils.Bernstein,Je=0;Je<=De;Je++)Be+=Ve(1-Se,De-Je)*Ve(Se,Je)*$e[Je]*Fe(De,Je);return Be},CatmullRom:function($e,Se){var Be=$e.length-1,De=Be*Se,Ve=Math.floor(De),Fe=Interpolation.Utils.CatmullRom;return $e[0]===$e[Be]?(Se<0&&(Ve=Math.floor(De=Be*(1+Se))),Fe($e[(Ve-1+Be)%Be],$e[Ve],$e[(Ve+1)%Be],$e[(Ve+2)%Be],De-Ve)):Se<0?$e[0]-(Fe($e[0],$e[0],$e[1],$e[1],-De)-$e[0]):Se>1?$e[Be]-(Fe($e[Be],$e[Be],$e[Be-1],$e[Be-1],De-Be)-$e[Be]):Fe($e[Ve?Ve-1:0],$e[Ve],$e[Be<Ve+1?Be:Ve+1],$e[Be<Ve+2?Be:Ve+2],De-Ve)},Utils:{Linear:function($e,Se,Be){return(Se-$e)*Be+$e},Bernstein:function($e,Se){var Be=Interpolation.Utils.Factorial;return Be($e)/Be(Se)/Be($e-Se)},Factorial:function(){var $e=[1];return function(Se){var Be=1;if($e[Se])return $e[Se];for(var De=Se;De>1;De--)Be*=De;return $e[Se]=Be,Be}}(),CatmullRom:function($e,Se,Be,De,Ve){var Fe=(Be-$e)*.5,Je=(De-Se)*.5,Xe=Ve*Ve,Ke=Ve*Xe;return(2*Se-2*Be+Fe+Je)*Ke+(-3*Se+3*Be-2*Fe-Je)*Xe+Fe*Ve+Se}}},Sequence=function(){function $e(){}return $e.nextId=function(){return $e._nextId++},$e._nextId=0,$e}(),mainGroup=new Group,Tween=function(){function $e(Se,Be){Be===void 0&&(Be=mainGroup),this._object=Se,this._group=Be,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Easing.Linear.None,this._interpolationFunction=Interpolation.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Sequence.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return $e.prototype.getId=function(){return this._id},$e.prototype.isPlaying=function(){return this._isPlaying},$e.prototype.isPaused=function(){return this._isPaused},$e.prototype.to=function(Se,Be){return this._valuesEnd=Object.create(Se),Be!==void 0&&(this._duration=Be),this},$e.prototype.duration=function(Se){return this._duration=Se,this},$e.prototype.start=function(Se){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var Be in this._valuesStartRepeat)this._swapEndStartRepeatValues(Be),this._valuesStart[Be]=this._valuesStartRepeat[Be]}return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=Se!==void 0?typeof Se=="string"?now$1()+parseFloat(Se):Se:now$1(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},$e.prototype._setupProperties=function(Se,Be,De,Ve){for(var Fe in De){var Je=Se[Fe],Xe=Array.isArray(Je),Ke=Xe?"array":typeof Je,Ye=!Xe&&Array.isArray(De[Fe]);if(!(Ke==="undefined"||Ke==="function")){if(Ye){var or=De[Fe];if(or.length===0)continue;or=or.map(this._handleRelativeValue.bind(this,Je)),De[Fe]=[Je].concat(or)}if((Ke==="object"||Xe)&&Je&&!Ye){Be[Fe]=Xe?[]:{};for(var sr in Je)Be[Fe][sr]=Je[sr];Ve[Fe]=Xe?[]:{},this._setupProperties(Je,Be[Fe],De[Fe],Ve[Fe])}else typeof Be[Fe]>"u"&&(Be[Fe]=Je),Xe||(Be[Fe]*=1),Ye?Ve[Fe]=De[Fe].slice().reverse():Ve[Fe]=Be[Fe]||0}}},$e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},$e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},$e.prototype.pause=function(Se){return Se===void 0&&(Se=now$1()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=Se,this._group&&this._group.remove(this),this)},$e.prototype.resume=function(Se){return Se===void 0&&(Se=now$1()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=Se-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},$e.prototype.stopChainedTweens=function(){for(var Se=0,Be=this._chainedTweens.length;Se<Be;Se++)this._chainedTweens[Se].stop();return this},$e.prototype.group=function(Se){return this._group=Se,this},$e.prototype.delay=function(Se){return this._delayTime=Se,this},$e.prototype.repeat=function(Se){return this._initialRepeat=Se,this._repeat=Se,this},$e.prototype.repeatDelay=function(Se){return this._repeatDelayTime=Se,this},$e.prototype.yoyo=function(Se){return this._yoyo=Se,this},$e.prototype.easing=function(Se){return this._easingFunction=Se,this},$e.prototype.interpolation=function(Se){return this._interpolationFunction=Se,this},$e.prototype.chain=function(){for(var Se=[],Be=0;Be<arguments.length;Be++)Se[Be]=arguments[Be];return this._chainedTweens=Se,this},$e.prototype.onStart=function(Se){return this._onStartCallback=Se,this},$e.prototype.onUpdate=function(Se){return this._onUpdateCallback=Se,this},$e.prototype.onRepeat=function(Se){return this._onRepeatCallback=Se,this},$e.prototype.onComplete=function(Se){return this._onCompleteCallback=Se,this},$e.prototype.onStop=function(Se){return this._onStopCallback=Se,this},$e.prototype.update=function(Se,Be){if(Se===void 0&&(Se=now$1()),Be===void 0&&(Be=!0),this._isPaused)return!0;var De,Ve,Fe=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(Se>Fe)return!1;Be&&this.start(Se)}if(this._goToEnd=!1,Se<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),Ve=(Se-this._startTime)/this._duration,Ve=this._duration===0||Ve>1?1:Ve;var Je=this._easingFunction(Ve);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,Je),this._onUpdateCallback&&this._onUpdateCallback(this._object,Ve),Ve===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(De in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[De]=="string"&&(this._valuesStartRepeat[De]=this._valuesStartRepeat[De]+parseFloat(this._valuesEnd[De])),this._yoyo&&this._swapEndStartRepeatValues(De),this._valuesStart[De]=this._valuesStartRepeat[De];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=Se+this._repeatDelayTime:this._startTime=Se+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var Xe=0,Ke=this._chainedTweens.length;Xe<Ke;Xe++)this._chainedTweens[Xe].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},$e.prototype._updateProperties=function(Se,Be,De,Ve){for(var Fe in De)if(Be[Fe]!==void 0){var Je=Be[Fe]||0,Xe=De[Fe],Ke=Array.isArray(Se[Fe]),Ye=Array.isArray(Xe),or=!Ke&&Ye;or?Se[Fe]=this._interpolationFunction(Xe,Ve):typeof Xe=="object"&&Xe?this._updateProperties(Se[Fe],Je,Xe,Ve):(Xe=this._handleRelativeValue(Je,Xe),typeof Xe=="number"&&(Se[Fe]=Je+(Xe-Je)*Ve))}},$e.prototype._handleRelativeValue=function(Se,Be){return typeof Be!="string"?Be:Be.charAt(0)==="+"||Be.charAt(0)==="-"?Se+parseFloat(Be):parseFloat(Be)},$e.prototype._swapEndStartRepeatValues=function(Se){var Be=this._valuesStartRepeat[Se],De=this._valuesEnd[Se];typeof De=="string"?this._valuesStartRepeat[Se]=this._valuesStartRepeat[Se]+parseFloat(De):this._valuesStartRepeat[Se]=this._valuesEnd[Se],this._valuesEnd[Se]=Be},$e}(),VERSION="18.6.4",nextId=Sequence.nextId,TWEEN=mainGroup,getAll=TWEEN.getAll.bind(TWEEN),removeAll=TWEEN.removeAll.bind(TWEEN),add=TWEEN.add.bind(TWEEN),remove=TWEEN.remove.bind(TWEEN),update=TWEEN.update.bind(TWEEN),exports={Easing,Group,Interpolation,now:now$1,Sequence,nextId,Tween,VERSION,getAll,removeAll,add,remove,update};class BetterTween extends exports.Tween{disposeMethods=[];animationFrameDisposer;onDispose=Se=>(this.disposeMethods.push(Se),this);play=()=>(this.start(),this.animationFrameDisposer=requestAnimationFrameInterval(()=>this.update()),this);dispose=()=>{this.stop(),this.animationFrameDisposer?.(),this.disposeMethods.forEach(Se=>Se()),this.disposeMethods=[],exports.remove(this)}}function tweenProgress($e,Se=exports.Easing.Linear.None){const Be=new BetterTween({progress:0}).to({progress:1});return $e!==void 0&&Be.duration($e),Se!==void 0&&Be.easing(Se),Be}function lineAnime($e,Se,Be){const Ve=new TextureLoader$1().load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAIVBMVEUAAAD////////////////////////////////////////PIev5AAAACnRSTlMAG/Py2baba05un7UgfgAAAHJJREFUKM9joBpgLHVSCRdA4metAoJlCJHmVWBgAeNzroKCCVCBLpjACqgJVjCBxRBT2FbBQQJYQAohsBAsUIUQWA4WiEIILAULeCEEloAFtBACizAEMLRgGIphLabDMJ2O6TlM72MGECIIMQIZIxqoBQCPvpJ/e9FaAAAAAABJRU5ErkJggg=="),Fe=new Color(16777215),Je=new Q$e;Je.setMaterial({linewidth:2,color:Fe});const Xe=Je.points.material;return Xe.map=Ve,Xe.color.set(Fe),Je.line.material.depthTest=!1,tweenProgress().onUpdate(({progress:Ke})=>{const Ye=.5-Ke/2,or=.5+Ke/2,sr=Se.clone().lerp(Be,Ye),cr=Se.clone().lerp(Be,or);Je.setPoints(sr,cr)}).onStart(()=>$e.scene.add(Je)).onDispose(()=>{$e.scene.remove(Je),$e.needsRender=!0})}function PanoEffect(){const[$e,Se]=reactExports.useState(null),Be=useFiveInstance(),De=reactExports.useRef(null),[Ve,Fe]=reactExports.useState(null),Je=reactExports.useRef(),Xe=useController(),Ke=useFiveProject2d(),Ye=()=>{De.current&&De.current.dispose()};return reactExports.useEffect(()=>{const or=sr=>{const{start:cr,end:Br,data:tn}=sr,en=tn,[an,rn]=en.twoVertexs,on=new Vector3(an.x,an.y,an.z),sn=new Vector3(rn.x,rn.y,rn.z);De.current=lineAnime(Be,on.clone(),sn.clone()),De.current.play();const ln=on.lerp(sn,.5),cn=on.distanceTo(sn),hn=Ke(ln);if(!hn)return;const{x:mn,y:An}=hn;Se({center:ln,distance:cn}),Fe({left:mn,top:An}),Je.current=setTimeout(()=>{Se(null),Fe(null),Ye()},Br-cr)};return Xe.on(VreoKeyframeEnum.PanoEffect,or),()=>{Xe.off(VreoKeyframeEnum.PanoEffect,or),Je.current&&clearTimeout(Je.current),Ye()}},[Xe]),reactExports.useEffect(()=>{const or=()=>{if(!$e?.center)return;const{x:sr,y:cr,z:Br}=$e.center,tn=Ke(new Vector3(sr,cr,Br));if(!tn)return;const{x:en,y:an}=tn;Fe({left:en,top:an})};return Be.on("currentStateChange",or),()=>{Be.off("currentStateChange",or)}},[$e?.center]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:classNames("PanoEffect",{"PanoEffect--notHidden":$e}),style:{left:(Ve?.left||0)+"px",top:(Ve?.top||0)+"px"},children:$e?.distance.toFixed(4)+"m"})})}function A$z(){console.debug("%c %c@realsee/dnalogel %cv3.67.2",["background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAMCAMAAACHgmeRAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABLFBMVEUAAAAapPoap/oaqvkbrfkbr/gZnfwZoPsaqfnD4v/E4/8Ylv0clPm93/+/4P/B4f8Yj/683/8Wif+33P8Uhv+x2f8ShP+s1v8Pgf+n0/8Nf/+h0f8Lff8Lff8Nf/9dl/+czv8KfP8KfP+Lxf+Uyv+Xy/+Hwv+Jw/+Mxf+Oxv+RyP8aovsapfoap/oZmfwZm/wZnvsYnPsYkf4YlP0NePsDYfgYcfi43f+63v8Xiv8Xjf4EWfwCV/sWZ/qz2v+02/8Vh/8WiP8EUf8CTf4WXv2u1/+v2P8Thf8Thv8ETf8CR/8VV/+o1f+q1f8Qgv8Rg/8DSv8BRf8UVP+j0v+k0v8OgP8Pgf8DR/8DQv9Nhf+dzv+fz/+Kv/+Vyv+Xy/+azf+Oxv+Qx/+SyP////8MUhLdAAAAK3RSTlMACEWQ2bd98uQECPXxqO7c+Pb49vj2+Pb49vj23Oul8fMHA+TwerXXjEIG2P+bHgAAAAFiS0dEY1y+LaoAAAB+SURBVAjXY2BgZGJmYWVgYGBgY9fW0eVg4ORi4NbTNzDk4eXjZxAwMjYxNTO3EGQQsrSytrG1sxdmEHFwdHJ2cXUTZRBz9/D08vbxFWeQ8PMPCAwKDpFkkAoNC4+IjIqWZpCRlZOPiY2LV2BQVGJQTkhMUlEFWaOmrqGpxQAAyg0S9Dq+VPYAAAAASUVORK5CYII=')","background-repeat: no-repeat","background-position: 0 center","padding-left: 8px"].join(";"),"","background-color: #12ce9b;color:black;padding:0 6px;border-radius: 3px")}function c$P(){const $e=typeof OffscreenCanvas<"u",Se=$e&&new OffscreenCanvas(1,1).getContext("webgl")!==null;$e&&!Se&&Object.assign(window,{OffscreenCanvas:function(Be,De){const Ve=document.createElement("canvas");return Ve.width=Be,Ve.height=De,Ve}})}Promise.resolve();var y$x=Object.freeze({Linear:Object.freeze({None:function($e){return $e},In:function($e){return $e},Out:function($e){return $e},InOut:function($e){return $e}}),Quadratic:Object.freeze({In:function($e){return $e*$e},Out:function($e){return $e*(2-$e)},InOut:function($e){return($e*=2)<1?.5*$e*$e:-.5*(--$e*($e-2)-1)}}),Cubic:Object.freeze({In:function($e){return $e*$e*$e},Out:function($e){return--$e*$e*$e+1},InOut:function($e){return($e*=2)<1?.5*$e*$e*$e:.5*(($e-=2)*$e*$e+2)}}),Quartic:Object.freeze({In:function($e){return $e*$e*$e*$e},Out:function($e){return 1- --$e*$e*$e*$e},InOut:function($e){return($e*=2)<1?.5*$e*$e*$e*$e:-.5*(($e-=2)*$e*$e*$e-2)}}),Quintic:Object.freeze({In:function($e){return $e*$e*$e*$e*$e},Out:function($e){return--$e*$e*$e*$e*$e+1},InOut:function($e){return($e*=2)<1?.5*$e*$e*$e*$e*$e:.5*(($e-=2)*$e*$e*$e*$e+2)}}),Sinusoidal:Object.freeze({In:function($e){return 1-Math.sin((1-$e)*Math.PI/2)},Out:function($e){return Math.sin($e*Math.PI/2)},InOut:function($e){return .5*(1-Math.sin(Math.PI*(.5-$e)))}}),Exponential:Object.freeze({In:function($e){return $e===0?0:Math.pow(1024,$e-1)},Out:function($e){return $e===1?1:1-Math.pow(2,-10*$e)},InOut:function($e){return $e===0?0:$e===1?1:($e*=2)<1?.5*Math.pow(1024,$e-1):.5*(-Math.pow(2,-10*($e-1))+2)}}),Circular:Object.freeze({In:function($e){return 1-Math.sqrt(1-$e*$e)},Out:function($e){return Math.sqrt(1- --$e*$e)},InOut:function($e){return($e*=2)<1?-.5*(Math.sqrt(1-$e*$e)-1):.5*(Math.sqrt(1-($e-=2)*$e)+1)}}),Elastic:Object.freeze({In:function($e){return $e===0?0:$e===1?1:-Math.pow(2,10*($e-1))*Math.sin(($e-1.1)*5*Math.PI)},Out:function($e){return $e===0?0:$e===1?1:Math.pow(2,-10*$e)*Math.sin(($e-.1)*5*Math.PI)+1},InOut:function($e){return $e===0?0:$e===1?1:($e*=2,$e<1?-.5*Math.pow(2,10*($e-1))*Math.sin(($e-1.1)*5*Math.PI):.5*Math.pow(2,-10*($e-1))*Math.sin(($e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function($e){var Se=1.70158;return $e===1?1:$e*$e*((Se+1)*$e-Se)},Out:function($e){var Se=1.70158;return $e===0?0:--$e*$e*((Se+1)*$e+Se)+1},InOut:function($e){var Se=2.5949095;return($e*=2)<1?.5*($e*$e*((Se+1)*$e-Se)):.5*(($e-=2)*$e*((Se+1)*$e+Se)+2)}}),Bounce:Object.freeze({In:function($e){return 1-y$x.Bounce.Out(1-$e)},Out:function($e){return $e<.36363636363636365?7.5625*$e*$e:$e<.7272727272727273?7.5625*($e-=.5454545454545454)*$e+.75:$e<.9090909090909091?7.5625*($e-=.8181818181818182)*$e+.9375:7.5625*($e-=.9545454545454546)*$e+.984375},InOut:function($e){return $e<.5?y$x.Bounce.In($e*2)*.5:y$x.Bounce.Out($e*2-1)*.5+.5}}),generatePow:function($e){return $e===void 0&&($e=4),$e=$e<Number.EPSILON?Number.EPSILON:$e,$e=$e>1e4?1e4:$e,{In:function(Se){return Math.pow(Se,$e)},Out:function(Se){return 1-Math.pow(1-Se,$e)},InOut:function(Se){return Se<.5?Math.pow(Se*2,$e)/2:(1-Math.pow(2-Se*2,$e))/2+.5}}}}),v$y=function(){return performance.now()},P$x=function(){function $e(){this._tweens={},this._tweensAddedDuringUpdate={}}return $e.prototype.getAll=function(){var Se=this;return Object.keys(this._tweens).map(function(Be){return Se._tweens[Be]})},$e.prototype.removeAll=function(){this._tweens={}},$e.prototype.add=function(Se){this._tweens[Se.getId()]=Se,this._tweensAddedDuringUpdate[Se.getId()]=Se},$e.prototype.remove=function(Se){delete this._tweens[Se.getId()],delete this._tweensAddedDuringUpdate[Se.getId()]},$e.prototype.update=function(Se,Be){Se===void 0&&(Se=v$y()),Be===void 0&&(Be=!1);var De=Object.keys(this._tweens);if(De.length===0)return!1;for(;De.length>0;){this._tweensAddedDuringUpdate={};for(var Ve=0;Ve<De.length;Ve++){var Fe=this._tweens[De[Ve]],Je=!Be;Fe&&Fe.update(Se,Je)===!1&&!Be&&delete this._tweens[De[Ve]]}De=Object.keys(this._tweensAddedDuringUpdate)}return!0},$e}(),d$G={Linear:function($e,Se){var Be=$e.length-1,De=Be*Se,Ve=Math.floor(De),Fe=d$G.Utils.Linear;return Se<0?Fe($e[0],$e[1],De):Se>1?Fe($e[Be],$e[Be-1],Be-De):Fe($e[Ve],$e[Ve+1>Be?Be:Ve+1],De-Ve)},Utils:{Linear:function($e,Se,Be){return(Se-$e)*Be+$e}}},w$r=function(){function $e(){}return $e.nextId=function(){return $e._nextId++},$e._nextId=0,$e}(),O$l=new P$x,M$v=function(){function $e(Se,Be){Be===void 0&&(Be=O$l),this._object=Se,this._group=Be,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=y$x.Linear.None,this._interpolationFunction=d$G.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=w$r.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return $e.prototype.getId=function(){return this._id},$e.prototype.isPlaying=function(){return this._isPlaying},$e.prototype.isPaused=function(){return this._isPaused},$e.prototype.getDuration=function(){return this._duration},$e.prototype.to=function(Se,Be){if(Be===void 0&&(Be=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=Se,this._propertiesAreSetUp=!1,this._duration=Be<0?0:Be,this},$e.prototype.duration=function(Se){return Se===void 0&&(Se=1e3),this._duration=Se<0?0:Se,this},$e.prototype.dynamic=function(Se){return Se===void 0&&(Se=!1),this._isDynamic=Se,this},$e.prototype.start=function(Se,Be){if(Se===void 0&&(Se=v$y()),Be===void 0&&(Be=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var De in this._valuesStartRepeat)this._swapEndStartRepeatValues(De),this._valuesStart[De]=this._valuesStartRepeat[De]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=Se,this._startTime+=this._delayTime,!this._propertiesAreSetUp||Be){if(this._propertiesAreSetUp=!0,!this._isDynamic){var Ve={};for(var Fe in this._valuesEnd)Ve[Fe]=this._valuesEnd[Fe];this._valuesEnd=Ve}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,Be)}return this},$e.prototype.startFromCurrentValues=function(Se){return this.start(Se,!0)},$e.prototype._setupProperties=function(Se,Be,De,Ve,Fe){for(var Je in De){var Xe=Se[Je],Ke=Array.isArray(Xe),Ye=Ke?"array":typeof Xe,or=!Ke&&Array.isArray(De[Je]);if(!(Ye==="undefined"||Ye==="function")){if(or){var sr=De[Je];if(sr.length===0)continue;for(var cr=[Xe],Br=0,tn=sr.length;Br<tn;Br+=1){var en=this._handleRelativeValue(Xe,sr[Br]);if(isNaN(en)){or=!1,console.warn("Found invalid interpolation list. Skipping.");break}cr.push(en)}or&&(De[Je]=cr)}if((Ye==="object"||Ke)&&Xe&&!or){Be[Je]=Ke?[]:{};var an=Xe;for(var rn in an)Be[Je][rn]=an[rn];Ve[Je]=Ke?[]:{};var sr=De[Je];if(!this._isDynamic){var on={};for(var rn in sr)on[rn]=sr[rn];De[Je]=sr=on}this._setupProperties(an,Be[Je],sr,Ve[Je],Fe)}else(typeof Be[Je]>"u"||Fe)&&(Be[Je]=Xe),Ke||(Be[Je]*=1),or?Ve[Je]=De[Je].slice().reverse():Ve[Je]=Be[Je]||0}}},$e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},$e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},$e.prototype.pause=function(Se){return Se===void 0&&(Se=v$y()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=Se,this._group&&this._group.remove(this),this)},$e.prototype.resume=function(Se){return Se===void 0&&(Se=v$y()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=Se-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},$e.prototype.stopChainedTweens=function(){for(var Se=0,Be=this._chainedTweens.length;Se<Be;Se++)this._chainedTweens[Se].stop();return this},$e.prototype.group=function(Se){return Se===void 0&&(Se=O$l),this._group=Se,this},$e.prototype.delay=function(Se){return Se===void 0&&(Se=0),this._delayTime=Se,this},$e.prototype.repeat=function(Se){return Se===void 0&&(Se=0),this._initialRepeat=Se,this._repeat=Se,this},$e.prototype.repeatDelay=function(Se){return this._repeatDelayTime=Se,this},$e.prototype.yoyo=function(Se){return Se===void 0&&(Se=!1),this._yoyo=Se,this},$e.prototype.easing=function(Se){return Se===void 0&&(Se=y$x.Linear.None),this._easingFunction=Se,this},$e.prototype.interpolation=function(Se){return Se===void 0&&(Se=d$G.Linear),this._interpolationFunction=Se,this},$e.prototype.chain=function(){for(var Se=[],Be=0;Be<arguments.length;Be++)Se[Be]=arguments[Be];return this._chainedTweens=Se,this},$e.prototype.onStart=function(Se){return this._onStartCallback=Se,this},$e.prototype.onEveryStart=function(Se){return this._onEveryStartCallback=Se,this},$e.prototype.onUpdate=function(Se){return this._onUpdateCallback=Se,this},$e.prototype.onRepeat=function(Se){return this._onRepeatCallback=Se,this},$e.prototype.onComplete=function(Se){return this._onCompleteCallback=Se,this},$e.prototype.onStop=function(Se){return this._onStopCallback=Se,this},$e.prototype.update=function(Se,Be){var De=this,Ve;if(Se===void 0&&(Se=v$y()),Be===void 0&&(Be=!0),this._isPaused)return!0;var Fe,Je=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(Se>Je)return!1;Be&&this.start(Se,!0)}if(this._goToEnd=!1,Se<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var Xe=Se-this._startTime,Ke=this._duration+((Ve=this._repeatDelayTime)!==null&&Ve!==void 0?Ve:this._delayTime),Ye=this._duration+this._repeat*Ke,or=function(){if(De._duration===0||Xe>Ye)return 1;var an=Math.trunc(Xe/Ke),rn=Xe-an*Ke,on=Math.min(rn/De._duration,1);return on===0&&Xe===De._duration?1:on},sr=or(),cr=this._easingFunction(sr);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,cr),this._onUpdateCallback&&this._onUpdateCallback(this._object,sr),this._duration===0||Xe>=this._duration)if(this._repeat>0){var Br=Math.min(Math.trunc((Xe-this._duration)/Ke)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=Br);for(Fe in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[Fe]=="string"&&(this._valuesStartRepeat[Fe]=this._valuesStartRepeat[Fe]+parseFloat(this._valuesEnd[Fe])),this._yoyo&&this._swapEndStartRepeatValues(Fe),this._valuesStart[Fe]=this._valuesStartRepeat[Fe];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=Ke*Br,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var tn=0,en=this._chainedTweens.length;tn<en;tn++)this._chainedTweens[tn].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},$e.prototype._updateProperties=function(Se,Be,De,Ve){for(var Fe in De)if(Be[Fe]!==void 0){var Je=Be[Fe]||0,Xe=De[Fe],Ke=Array.isArray(Se[Fe]),Ye=Array.isArray(Xe),or=!Ke&&Ye;or?Se[Fe]=this._interpolationFunction(Xe,Ve):typeof Xe=="object"&&Xe?this._updateProperties(Se[Fe],Je,Xe,Ve):(Xe=this._handleRelativeValue(Je,Xe),typeof Xe=="number"&&(Se[Fe]=Je+(Xe-Je)*Ve))}},$e.prototype._handleRelativeValue=function(Se,Be){return typeof Be!="string"?Be:Be.charAt(0)==="+"||Be.charAt(0)==="-"?Se+parseFloat(Be):parseFloat(Be)},$e.prototype._swapEndStartRepeatValues=function(Se){var Be=this._valuesStartRepeat[Se],De=this._valuesEnd[Se];typeof De=="string"?this._valuesStartRepeat[Se]=this._valuesStartRepeat[Se]+parseFloat(De):this._valuesStartRepeat[Se]=this._valuesEnd[Se],this._valuesEnd[Se]=Be},$e}();w$r.nextId;var o$J=O$l;o$J.getAll.bind(o$J);o$J.removeAll.bind(o$J);o$J.add.bind(o$J);var j$o=o$J.remove.bind(o$J);o$J.update.bind(o$J);function t$k(){return((1+Math.random())*65536|0).toString(16).substring(1)}function r$F(){return(t$k()+t$k()+"-"+t$k()+"-4"+t$k().substr(0,3)+"-"+t$k()+"-"+t$k()+t$k()+t$k()).toLowerCase()}function v$x($e){return typeof Symbol>"u"?`$Symbol<${$e}>$`:Symbol($e)}const i$A=v$x("$$EVENT$$");function r$E($e){return $e[i$A]||($e[i$A]={}),$e[i$A]}function d$F($e){$e[i$A]&&delete $e[i$A]}let E$v=class{hasListener(Se){const Be=r$E(this);return!!(Be!=null&&Be[Se]&&Be[Se].length>0)}on(Se,Be,De){const Ve=r$E(this);return Ve[Se]||(Ve[Se]=[]),Ve[Se].push([Be,De||!1]),()=>this.off(Se,Be)}once(Se,Be){return this.on(Se,Be,!0)}off(Se,Be){if(Se===void 0){d$F(this);return}const De=r$E(this);if(De[Se]||(De[Se]=[]),Be===void 0){De[Se].length=0;return}let Ve=0;for(;Ve<De[Se].length&&De[Se][Ve][0]!==Be;Ve++);Ve<De[Se].length&&De[Se].splice(Ve,1)}emit(Se,...Be){let De=!1;const Ve=r$E(this)[Se]||[];for(let Fe of Ve.slice()){const[Je,Xe=!1]=Fe,Ke=Je(...Be);Xe&&this.off(Se,Je),Ke===!1&&(De=!0)}return De}};const f$J=({x:$e,y:Se,z:Be})=>new Vector3($e,Se,Be),a$D=$e=>new Vector3().fromArray($e),t$j=$e=>{if($e)return $e instanceof Vector3?$e:Array.isArray($e)?a$D($e):f$J($e)};function o$I($e){if($e)return Array.isArray($e)?typeof $e[0]=="number"?t$j($e):$e.map(t$j):t$j($e)}function i$z($e,Se,Be){const{x:De,y:Ve,z:Fe}=Se.clone().project($e);return Fe>1?void 0:{leftPx:(De+1)/2*Be.x,topPx:(-Ve+1)/2*Be.y}}function l$w($e){var Se;return((Se=$e.models)==null?void 0:Se.filter(Be=>Be.name===$e.state.workCode)[0])||$e.model}var i$y=Object.defineProperty,o$H=($e,Se,Be)=>Se in $e?i$y($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,t$i=($e,Se,Be)=>(o$H($e,Se+"",Be),Be);let u$A=class extends E$v{constructor(Se){super(),t$i(this,"five"),this.five=Se}};const c$O=($e,Se)=>{if(!Se)return $e;const Be=new Vector3,De=new Quaternion,Ve=new Vector3;return Se.decompose(Be,De,Ve),$e.clone().multiply(Ve).applyQuaternion(De).add(Be)};var a$C=Object.defineProperty,h$A=($e,Se,Be)=>Se in $e?a$C($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,k$o=($e,Se,Be)=>(h$A($e,Se+"",Be),Be);const n$w=new Map;let c$N=class extends u$A{constructor(Se){super(Se),k$o(this,"_workCode")}get fromType(){var Se,Be;const De=this.workCode;if(n$w.has(De))return n$w.get(De);const Ve=(Be=(Se=JSON.parse(this.work.raw.works[0]))==null?void 0:Se.from_type)!=null?Be:"vr";return n$w.set(De,Ve),Ve}set workCode(Se){this._workCode=Se}get workCode(){var Se;return(Se=this._workCode)!=null?Se:this.five.state.workCode}get work(){var Se,Be;return(Be=(Se=this.five.works)==null?void 0:Se.find(De=>De.workCode===this.workCode))!=null?Be:this.five.work}get observers(){var Se;return(Se=this.work)==null?void 0:Se.observers}get transform(){var Se,Be,De,Ve;const Fe=(Ve=(Se=this.work)==null?void 0:Se.transform)!=null?Ve:(De=(Be=this.work)==null?void 0:Be.options)==null?void 0:De.transform;return Fe?Fe.clone():new Matrix4}getResolvedObserver(Se){return this.five.works.getResolvedObserver({workCode:this.workCode,panoIndex:Se})}getObserverPosition(Se){var Be;const De=(Be=this.getObserver(Se))==null?void 0:Be.position;if(De)return c$O(De,this.transform)}getObserverStandingPosition(Se){var Be;const De=(Be=this.getObserver(Se))==null?void 0:Be.standingPosition;if(De)return c$O(De,this.transform)}getObserver(Se){var Be;return(Be=this.observers)==null?void 0:Be[Se]}};var n$v=Object.defineProperty,m$B=($e,Se,Be)=>Se in $e?n$v($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,t$h=($e,Se,Be)=>(m$B($e,Se+"",Be),Be);let c$M=class extends u$A{constructor(Se){super(Se),t$h(this,"workUtil",new c$N(this.five))}get version(){return this.five.constructor.version}get majorVersion(){return Number(this.version.split(".")[0])}get model(){return l$w(this.five)}moveToPano(Se,Be){const De=this.majorVersion===5?Se:{workCode:this.workUtil.workCode,panoIndex:Se};return this.five.moveToPano(De,Be)}},h$z=class extends Raycaster{intersectObject(Se,Be=!0,De=[]){return f$I(Se,this,De,Be),De.sort(a$B),De}intersectObjects(Se,Be=!0,De=[]){for(let Ve=0,Fe=Se.length;Ve<Fe;Ve++)f$I(Se[Ve],this,De,Be);return De.sort(a$B),De}};function a$B($e,Se){return $e.distance-Se.distance}function f$I($e,Se,Be,De){let Ve=!0;if($e.layers.test(Se.layers)&&$e.raycast(Se,Be)===!1&&(Ve=!1),Ve===!0&&De===!0){const Fe=$e.children;for(let Je=0,Xe=Fe.length;Je<Xe;Je++)f$I(Fe[Je],Se,Be,!0)}}function c$L($e,Se,Be,De){let Ve=!0;if($e.type!=="Line2"&&($e.layers.test(Se.layers)&&$e.raycast(Se,Be)===!1&&(Ve=!1),Ve===!0&&De===!0)){const Fe=$e.children;for(let Je=0,Xe=Fe.length;Je<Xe;Je++)Fe[Je].type!=="Line2"&&c$L(Fe[Je],Se,Be,!0)}}const t$g=new h$z;t$g.params.Points.threshold=.02;function o$G($e,Se){if(!Se||typeof ResizeObserver>"u"||!ResizeObserver)return{observe:()=>window.addEventListener("resize",$e),unobserve:()=>window.removeEventListener("resize",$e)};{const Be=new ResizeObserver($e);return{observe:()=>Be.observe(Se),unobserve:()=>Be.unobserve(Se)}}}function o$F($e,Se=200){let Be;return function(...De){Be||($e(...De),Be=setTimeout(function(){Be=null},Se))}}function i$x($e,Se){let Be=!1;const De=o$F(()=>{Be||(Be=!0,$e.ready().then(()=>{Se(),Be=!1}))},150);return $e.on("camera.update",De),()=>{$e.off("camera.update",De)}}var Qt$2={},He$1={get exports(){return Qt$2},set exports($e){Qt$2=$e}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function($e){(function(Se,Be,De,Ve){var Fe=["","webkit","Moz","MS","ms","o"],Je=Be.createElement("div"),Xe="function",Ke=Math.round,Ye=Math.abs,or=Date.now;function sr(_n,On,Jn){return setTimeout(sn(_n,Jn),On)}function cr(_n,On,Jn){return Array.isArray(_n)?(Br(_n,Jn[On],Jn),!0):!1}function Br(_n,On,Jn){var pi;if(_n)if(_n.forEach)_n.forEach(On,Jn);else if(_n.length!==Ve)for(pi=0;pi<_n.length;)On.call(Jn,_n[pi],pi,_n),pi++;else for(pi in _n)_n.hasOwnProperty(pi)&&On.call(Jn,_n[pi],pi,_n)}function tn(_n,On,Jn){var pi="DEPRECATED METHOD: "+On+`
`+Jn+` AT 
`;return function(){var Si=new Error("get-stack-trace"),zi=Si&&Si.stack?Si.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",no=Se.console&&(Se.console.warn||Se.console.log);return no&&no.call(Se.console,pi,zi),_n.apply(this,arguments)}}var en;typeof Object.assign!="function"?en=function(_n){if(_n===Ve||_n===null)throw new TypeError("Cannot convert undefined or null to object");for(var On=Object(_n),Jn=1;Jn<arguments.length;Jn++){var pi=arguments[Jn];if(pi!==Ve&&pi!==null)for(var Si in pi)pi.hasOwnProperty(Si)&&(On[Si]=pi[Si])}return On}:en=Object.assign;var an=tn(function(_n,On,Jn){for(var pi=Object.keys(On),Si=0;Si<pi.length;)(!Jn||Jn&&_n[pi[Si]]===Ve)&&(_n[pi[Si]]=On[pi[Si]]),Si++;return _n},"extend","Use `assign`."),rn=tn(function(_n,On){return an(_n,On,!0)},"merge","Use `assign`.");function on(_n,On,Jn){var pi=On.prototype,Si;Si=_n.prototype=Object.create(pi),Si.constructor=_n,Si._super=pi,Jn&&en(Si,Jn)}function sn(_n,On){return function(){return _n.apply(On,arguments)}}function ln(_n,On){return typeof _n==Xe?_n.apply(On&&On[0]||Ve,On):_n}function cn(_n,On){return _n===Ve?On:_n}function hn(_n,On,Jn){Br(pn(On),function(pi){_n.addEventListener(pi,Jn,!1)})}function mn(_n,On,Jn){Br(pn(On),function(pi){_n.removeEventListener(pi,Jn,!1)})}function An(_n,On){for(;_n;){if(_n==On)return!0;_n=_n.parentNode}return!1}function xn(_n,On){return _n.indexOf(On)>-1}function pn(_n){return _n.trim().split(/\s+/g)}function dn(_n,On,Jn){if(_n.indexOf&&!Jn)return _n.indexOf(On);for(var pi=0;pi<_n.length;){if(Jn&&_n[pi][Jn]==On||!Jn&&_n[pi]===On)return pi;pi++}return-1}function fn(_n){return Array.prototype.slice.call(_n,0)}function yn(_n,On,Jn){for(var pi=[],Si=[],zi=0;zi<_n.length;){var no=_n[zi][On];dn(Si,no)<0&&pi.push(_n[zi]),Si[zi]=no,zi++}return pi=pi.sort(function(Co,Uo){return Co[On]>Uo[On]}),pi}function Sn(_n,On){for(var Jn,pi,Si=On[0].toUpperCase()+On.slice(1),zi=0;zi<Fe.length;){if(Jn=Fe[zi],pi=Jn?Jn+Si:On,pi in _n)return pi;zi++}return Ve}var gn=1;function Cn(){return gn++}function Mn(_n){var On=_n.ownerDocument||_n;return On.defaultView||On.parentWindow||Se}var Bn=/mobile|tablet|ip(ad|hone|od)|android/i,kn="ontouchstart"in Se,Ln=Sn(Se,"PointerEvent")!==Ve,Pn=kn&&Bn.test(navigator.userAgent),Vn="touch",Yn="pen",ni="mouse",Rn="kinect",In=25,Gn=1,Fn=2,Hn=4,Dn=8,zn=1,Qn=2,Zn=4,si=8,ei=16,hi=Qn|Zn,Un=si|ei,Wn=hi|Un,Ai=["x","y"],oi=["clientX","clientY"];function ci(_n,On){var Jn=this;this.manager=_n,this.callback=On,this.element=_n.element,this.target=_n.options.inputTarget,this.domHandler=function(pi){ln(_n.options.enable,[_n])&&Jn.handler(pi)},this.init()}ci.prototype={handler:function(){},init:function(){this.evEl&&hn(this.element,this.evEl,this.domHandler),this.evTarget&&hn(this.target,this.evTarget,this.domHandler),this.evWin&&hn(Mn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&mn(this.element,this.evEl,this.domHandler),this.evTarget&&mn(this.target,this.evTarget,this.domHandler),this.evWin&&mn(Mn(this.element),this.evWin,this.domHandler)}};function ai(_n){var On,Jn=_n.options.inputClass;return Jn?On=Jn:Ln?On=Eo:Pn?On=ki:kn?On=Wi:On=lo,new On(_n,wi)}function wi(_n,On,Jn){var pi=Jn.pointers.length,Si=Jn.changedPointers.length,zi=On&Gn&&pi-Si===0,no=On&(Hn|Dn)&&pi-Si===0;Jn.isFirst=!!zi,Jn.isFinal=!!no,zi&&(_n.session={}),Jn.eventType=On,Pi(_n,Jn),_n.emit("hammer.input",Jn),_n.recognize(Jn),_n.session.prevInput=Jn}function Pi(_n,On){var Jn=_n.session,pi=On.pointers,Si=pi.length;Jn.firstInput||(Jn.firstInput=_i(On)),Si>1&&!Jn.firstMultiple?Jn.firstMultiple=_i(On):Si===1&&(Jn.firstMultiple=!1);var zi=Jn.firstInput,no=Jn.firstMultiple,Co=no?no.center:zi.center,Uo=On.center=Mi(pi);On.timeStamp=or(),On.deltaTime=On.timeStamp-zi.timeStamp,On.angle=Ti(Co,Uo),On.distance=ri(Co,Uo),Oi(Jn,On),On.offsetDirection=vi(On.deltaX,On.deltaY);var la=$i(On.deltaTime,On.deltaX,On.deltaY);On.overallVelocityX=la.x,On.overallVelocityY=la.y,On.overallVelocity=Ye(la.x)>Ye(la.y)?la.x:la.y,On.scale=no?qi(no.pointers,pi):1,On.rotation=no?Bi(no.pointers,pi):0,On.maxPointers=Jn.prevInput?On.pointers.length>Jn.prevInput.maxPointers?On.pointers.length:Jn.prevInput.maxPointers:On.pointers.length,Ri(Jn,On);var Zo=_n.element;An(On.srcEvent.target,Zo)&&(Zo=On.srcEvent.target),On.target=Zo}function Oi(_n,On){var Jn=On.center,pi=_n.offsetDelta||{},Si=_n.prevDelta||{},zi=_n.prevInput||{};(On.eventType===Gn||zi.eventType===Hn)&&(Si=_n.prevDelta={x:zi.deltaX||0,y:zi.deltaY||0},pi=_n.offsetDelta={x:Jn.x,y:Jn.y}),On.deltaX=Si.x+(Jn.x-pi.x),On.deltaY=Si.y+(Jn.y-pi.y)}function Ri(_n,On){var Jn=_n.lastInterval||On,pi=On.timeStamp-Jn.timeStamp,Si,zi,no,Co;if(On.eventType!=Dn&&(pi>In||Jn.velocity===Ve)){var Uo=On.deltaX-Jn.deltaX,la=On.deltaY-Jn.deltaY,Zo=$i(pi,Uo,la);zi=Zo.x,no=Zo.y,Si=Ye(Zo.x)>Ye(Zo.y)?Zo.x:Zo.y,Co=vi(Uo,la),_n.lastInterval=On}else Si=Jn.velocity,zi=Jn.velocityX,no=Jn.velocityY,Co=Jn.direction;On.velocity=Si,On.velocityX=zi,On.velocityY=no,On.direction=Co}function _i(_n){for(var On=[],Jn=0;Jn<_n.pointers.length;)On[Jn]={clientX:Ke(_n.pointers[Jn].clientX),clientY:Ke(_n.pointers[Jn].clientY)},Jn++;return{timeStamp:or(),pointers:On,center:Mi(On),deltaX:_n.deltaX,deltaY:_n.deltaY}}function Mi(_n){var On=_n.length;if(On===1)return{x:Ke(_n[0].clientX),y:Ke(_n[0].clientY)};for(var Jn=0,pi=0,Si=0;Si<On;)Jn+=_n[Si].clientX,pi+=_n[Si].clientY,Si++;return{x:Ke(Jn/On),y:Ke(pi/On)}}function $i(_n,On,Jn){return{x:On/_n||0,y:Jn/_n||0}}function vi(_n,On){return _n===On?zn:Ye(_n)>=Ye(On)?_n<0?Qn:Zn:On<0?si:ei}function ri(_n,On,Jn){Jn||(Jn=Ai);var pi=On[Jn[0]]-_n[Jn[0]],Si=On[Jn[1]]-_n[Jn[1]];return Math.sqrt(pi*pi+Si*Si)}function Ti(_n,On,Jn){Jn||(Jn=Ai);var pi=On[Jn[0]]-_n[Jn[0]],Si=On[Jn[1]]-_n[Jn[1]];return Math.atan2(Si,pi)*180/Math.PI}function Bi(_n,On){return Ti(On[1],On[0],oi)+Ti(_n[1],_n[0],oi)}function qi(_n,On){return ri(On[0],On[1],oi)/ri(_n[0],_n[1],oi)}var Ii={mousedown:Gn,mousemove:Fn,mouseup:Hn},Ui="mousedown",ho="mousemove mouseup";function lo(){this.evEl=Ui,this.evWin=ho,this.pressed=!1,ci.apply(this,arguments)}on(lo,ci,{handler:function(_n){var On=Ii[_n.type];On&Gn&&_n.button===0&&(this.pressed=!0),On&Fn&&_n.which!==1&&(On=Hn),this.pressed&&(On&Hn&&(this.pressed=!1),this.callback(this.manager,On,{pointers:[_n],changedPointers:[_n],pointerType:ni,srcEvent:_n}))}});var po={pointerdown:Gn,pointermove:Fn,pointerup:Hn,pointercancel:Dn,pointerout:Dn},co={2:Vn,3:Yn,4:ni,5:Rn},go="pointerdown",vo="pointermove pointerup pointercancel";Se.MSPointerEvent&&!Se.PointerEvent&&(go="MSPointerDown",vo="MSPointerMove MSPointerUp MSPointerCancel");function Eo(){this.evEl=go,this.evWin=vo,ci.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}on(Eo,ci,{handler:function(_n){var On=this.store,Jn=!1,pi=_n.type.toLowerCase().replace("ms",""),Si=po[pi],zi=co[_n.pointerType]||_n.pointerType,no=zi==Vn,Co=dn(On,_n.pointerId,"pointerId");Si&Gn&&(_n.button===0||no)?Co<0&&(On.push(_n),Co=On.length-1):Si&(Hn|Dn)&&(Jn=!0),!(Co<0)&&(On[Co]=_n,this.callback(this.manager,Si,{pointers:On,changedPointers:[_n],pointerType:zi,srcEvent:_n}),Jn&&On.splice(Co,1))}});var Oo={touchstart:Gn,touchmove:Fn,touchend:Hn,touchcancel:Dn},Bo="touchstart",Po="touchstart touchmove touchend touchcancel";function Kn(){this.evTarget=Bo,this.evWin=Po,this.started=!1,ci.apply(this,arguments)}on(Kn,ci,{handler:function(_n){var On=Oo[_n.type];if(On===Gn&&(this.started=!0),!!this.started){var Jn=mi.call(this,_n,On);On&(Hn|Dn)&&Jn[0].length-Jn[1].length===0&&(this.started=!1),this.callback(this.manager,On,{pointers:Jn[0],changedPointers:Jn[1],pointerType:Vn,srcEvent:_n})}}});function mi(_n,On){var Jn=fn(_n.touches),pi=fn(_n.changedTouches);return On&(Hn|Dn)&&(Jn=yn(Jn.concat(pi),"identifier")),[Jn,pi]}var gi={touchstart:Gn,touchmove:Fn,touchend:Hn,touchcancel:Dn},xi="touchstart touchmove touchend touchcancel";function ki(){this.evTarget=xi,this.targetIds={},ci.apply(this,arguments)}on(ki,ci,{handler:function(_n){var On=gi[_n.type],Jn=Ki.call(this,_n,On);Jn&&this.callback(this.manager,On,{pointers:Jn[0],changedPointers:Jn[1],pointerType:Vn,srcEvent:_n})}});function Ki(_n,On){var Jn=fn(_n.touches),pi=this.targetIds;if(On&(Gn|Fn)&&Jn.length===1)return pi[Jn[0].identifier]=!0,[Jn,Jn];var Si,zi,no=fn(_n.changedTouches),Co=[],Uo=this.target;if(zi=Jn.filter(function(la){return An(la.target,Uo)}),On===Gn)for(Si=0;Si<zi.length;)pi[zi[Si].identifier]=!0,Si++;for(Si=0;Si<no.length;)pi[no[Si].identifier]&&Co.push(no[Si]),On&(Hn|Dn)&&delete pi[no[Si].identifier],Si++;if(Co.length)return[yn(zi.concat(Co),"identifier"),Co]}var Yi=2500,ji=25;function Wi(){ci.apply(this,arguments);var _n=sn(this.handler,this);this.touch=new ki(this.manager,_n),this.mouse=new lo(this.manager,_n),this.primaryTouch=null,this.lastTouches=[]}on(Wi,ci,{handler:function(_n,On,Jn){var pi=Jn.pointerType==Vn,Si=Jn.pointerType==ni;if(!(Si&&Jn.sourceCapabilities&&Jn.sourceCapabilities.firesTouchEvents)){if(pi)Gi.call(this,On,Jn);else if(Si&&bo.call(this,Jn))return;this.callback(_n,On,Jn)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Gi(_n,On){_n&Gn?(this.primaryTouch=On.changedPointers[0].identifier,Mo.call(this,On)):_n&(Hn|Dn)&&Mo.call(this,On)}function Mo(_n){var On=_n.changedPointers[0];if(On.identifier===this.primaryTouch){var Jn={x:On.clientX,y:On.clientY};this.lastTouches.push(Jn);var pi=this.lastTouches,Si=function(){var zi=pi.indexOf(Jn);zi>-1&&pi.splice(zi,1)};setTimeout(Si,Yi)}}function bo(_n){for(var On=_n.srcEvent.clientX,Jn=_n.srcEvent.clientY,pi=0;pi<this.lastTouches.length;pi++){var Si=this.lastTouches[pi],zi=Math.abs(On-Si.x),no=Math.abs(Jn-Si.y);if(zi<=ji&&no<=ji)return!0}return!1}var fo=Sn(Je.style,"touchAction"),Hi=fo!==Ve,eo="compute",mo="auto",xo="manipulation",ro="none",To="pan-x",_o="pan-y",Ho=Na();function Io(_n,On){this.manager=_n,this.set(On)}Io.prototype={set:function(_n){_n==eo&&(_n=this.compute()),Hi&&this.manager.element.style&&Ho[_n]&&(this.manager.element.style[fo]=_n),this.actions=_n.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var _n=[];return Br(this.manager.recognizers,function(On){ln(On.options.enable,[On])&&(_n=_n.concat(On.getTouchAction()))}),Xa(_n.join(" "))},preventDefaults:function(_n){var On=_n.srcEvent,Jn=_n.offsetDirection;if(this.manager.session.prevented){On.preventDefault();return}var pi=this.actions,Si=xn(pi,ro)&&!Ho[ro],zi=xn(pi,_o)&&!Ho[_o],no=xn(pi,To)&&!Ho[To];if(Si){var Co=_n.pointers.length===1,Uo=_n.distance<2,la=_n.deltaTime<250;if(Co&&Uo&&la)return}if(!(no&&zi)&&(Si||zi&&Jn&hi||no&&Jn&Un))return this.preventSrc(On)},preventSrc:function(_n){this.manager.session.prevented=!0,_n.preventDefault()}};function Xa(_n){if(xn(_n,ro))return ro;var On=xn(_n,To),Jn=xn(_n,_o);return On&&Jn?ro:On||Jn?On?To:_o:xn(_n,xo)?xo:mo}function Na(){if(!Hi)return!1;var _n={},On=Se.CSS&&Se.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Jn){_n[Jn]=On?Se.CSS.supports("touch-action",Jn):!0}),_n}var $o=1,qo=2,na=4,Go=8,Jo=Go,Xo=16,Do=32;function ia(_n){this.options=en({},this.defaults,_n||{}),this.id=Cn(),this.manager=null,this.options.enable=cn(this.options.enable,!0),this.state=$o,this.simultaneous={},this.requireFail=[]}ia.prototype={defaults:{},set:function(_n){return en(this.options,_n),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(_n){if(cr(_n,"recognizeWith",this))return this;var On=this.simultaneous;return _n=Fo(_n,this),On[_n.id]||(On[_n.id]=_n,_n.recognizeWith(this)),this},dropRecognizeWith:function(_n){return cr(_n,"dropRecognizeWith",this)?this:(_n=Fo(_n,this),delete this.simultaneous[_n.id],this)},requireFailure:function(_n){if(cr(_n,"requireFailure",this))return this;var On=this.requireFail;return _n=Fo(_n,this),dn(On,_n)===-1&&(On.push(_n),_n.requireFailure(this)),this},dropRequireFailure:function(_n){if(cr(_n,"dropRequireFailure",this))return this;_n=Fo(_n,this);var On=dn(this.requireFail,_n);return On>-1&&this.requireFail.splice(On,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(_n){return!!this.simultaneous[_n.id]},emit:function(_n){var On=this,Jn=this.state;function pi(Si){On.manager.emit(Si,_n)}Jn<Go&&pi(On.options.event+va(Jn)),pi(On.options.event),_n.additionalEvent&&pi(_n.additionalEvent),Jn>=Go&&pi(On.options.event+va(Jn))},tryEmit:function(_n){if(this.canEmit())return this.emit(_n);this.state=Do},canEmit:function(){for(var _n=0;_n<this.requireFail.length;){if(!(this.requireFail[_n].state&(Do|$o)))return!1;_n++}return!0},recognize:function(_n){var On=en({},_n);if(!ln(this.options.enable,[this,On])){this.reset(),this.state=Do;return}this.state&(Jo|Xo|Do)&&(this.state=$o),this.state=this.process(On),this.state&(qo|na|Go|Xo)&&this.tryEmit(On)},process:function(_n){},getTouchAction:function(){},reset:function(){}};function va(_n){return _n&Xo?"cancel":_n&Go?"end":_n&na?"move":_n&qo?"start":""}function Ka(_n){return _n==ei?"down":_n==si?"up":_n==Qn?"left":_n==Zn?"right":""}function Fo(_n,On){var Jn=On.manager;return Jn?Jn.get(_n):_n}function sa(){ia.apply(this,arguments)}on(sa,ia,{defaults:{pointers:1},attrTest:function(_n){var On=this.options.pointers;return On===0||_n.pointers.length===On},process:function(_n){var On=this.state,Jn=_n.eventType,pi=On&(qo|na),Si=this.attrTest(_n);return pi&&(Jn&Dn||!Si)?On|Xo:pi||Si?Jn&Hn?On|Go:On&qo?On|na:qo:Do}});function za(){sa.apply(this,arguments),this.pX=null,this.pY=null}on(za,sa,{defaults:{event:"pan",threshold:10,pointers:1,direction:Wn},getTouchAction:function(){var _n=this.options.direction,On=[];return _n&hi&&On.push(_o),_n&Un&&On.push(To),On},directionTest:function(_n){var On=this.options,Jn=!0,pi=_n.distance,Si=_n.direction,zi=_n.deltaX,no=_n.deltaY;return Si&On.direction||(On.direction&hi?(Si=zi===0?zn:zi<0?Qn:Zn,Jn=zi!=this.pX,pi=Math.abs(_n.deltaX)):(Si=no===0?zn:no<0?si:ei,Jn=no!=this.pY,pi=Math.abs(_n.deltaY))),_n.direction=Si,Jn&&pi>On.threshold&&Si&On.direction},attrTest:function(_n){return sa.prototype.attrTest.call(this,_n)&&(this.state&qo||!(this.state&qo)&&this.directionTest(_n))},emit:function(_n){this.pX=_n.deltaX,this.pY=_n.deltaY;var On=Ka(_n.direction);On&&(_n.additionalEvent=this.options.event+On),this._super.emit.call(this,_n)}});function Pa(){sa.apply(this,arguments)}on(Pa,sa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ro]},attrTest:function(_n){return this._super.attrTest.call(this,_n)&&(Math.abs(_n.scale-1)>this.options.threshold||this.state&qo)},emit:function(_n){if(_n.scale!==1){var On=_n.scale<1?"in":"out";_n.additionalEvent=this.options.event+On}this._super.emit.call(this,_n)}});function wa(){ia.apply(this,arguments),this._timer=null,this._input=null}on(wa,ia,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[mo]},process:function(_n){var On=this.options,Jn=_n.pointers.length===On.pointers,pi=_n.distance<On.threshold,Si=_n.deltaTime>On.time;if(this._input=_n,!pi||!Jn||_n.eventType&(Hn|Dn)&&!Si)this.reset();else if(_n.eventType&Gn)this.reset(),this._timer=sr(function(){this.state=Jo,this.tryEmit()},On.time,this);else if(_n.eventType&Hn)return Jo;return Do},reset:function(){clearTimeout(this._timer)},emit:function(_n){this.state===Jo&&(_n&&_n.eventType&Hn?this.manager.emit(this.options.event+"up",_n):(this._input.timeStamp=or(),this.manager.emit(this.options.event,this._input)))}});function ma(){sa.apply(this,arguments)}on(ma,sa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ro]},attrTest:function(_n){return this._super.attrTest.call(this,_n)&&(Math.abs(_n.rotation)>this.options.threshold||this.state&qo)}});function Aa(){sa.apply(this,arguments)}on(Aa,sa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:hi|Un,pointers:1},getTouchAction:function(){return za.prototype.getTouchAction.call(this)},attrTest:function(_n){var On=this.options.direction,Jn;return On&(hi|Un)?Jn=_n.overallVelocity:On&hi?Jn=_n.overallVelocityX:On&Un&&(Jn=_n.overallVelocityY),this._super.attrTest.call(this,_n)&&On&_n.offsetDirection&&_n.distance>this.options.threshold&&_n.maxPointers==this.options.pointers&&Ye(Jn)>this.options.velocity&&_n.eventType&Hn},emit:function(_n){var On=Ka(_n.offsetDirection);On&&this.manager.emit(this.options.event+On,_n),this.manager.emit(this.options.event,_n)}});function da(){ia.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}on(da,ia,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xo]},process:function(_n){var On=this.options,Jn=_n.pointers.length===On.pointers,pi=_n.distance<On.threshold,Si=_n.deltaTime<On.time;if(this.reset(),_n.eventType&Gn&&this.count===0)return this.failTimeout();if(pi&&Si&&Jn){if(_n.eventType!=Hn)return this.failTimeout();var zi=this.pTime?_n.timeStamp-this.pTime<On.interval:!0,no=!this.pCenter||ri(this.pCenter,_n.center)<On.posThreshold;this.pTime=_n.timeStamp,this.pCenter=_n.center,!no||!zi?this.count=1:this.count+=1,this._input=_n;var Co=this.count%On.taps;if(Co===0)return this.hasRequireFailures()?(this._timer=sr(function(){this.state=Jo,this.tryEmit()},On.interval,this),qo):Jo}return Do},failTimeout:function(){return this._timer=sr(function(){this.state=Do},this.options.interval,this),Do},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Jo&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ia(_n,On){return On=On||{},On.recognizers=cn(On.recognizers,Ia.defaults.preset),new Ya(_n,On)}Ia.VERSION="2.0.7",Ia.defaults={domEvents:!1,touchAction:eo,enable:!0,inputTarget:null,inputClass:null,preset:[[ma,{enable:!1}],[Pa,{enable:!1},["rotate"]],[Aa,{direction:hi}],[za,{direction:hi},["swipe"]],[da],[da,{event:"doubletap",taps:2},["tap"]],[wa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ys=1,Ua=2;function Ya(_n,On){this.options=en({},Ia.defaults,On||{}),this.options.inputTarget=this.options.inputTarget||_n,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=_n,this.input=ai(this),this.touchAction=new Io(this,this.options.touchAction),ja(this,!0),Br(this.options.recognizers,function(Jn){var pi=this.add(new Jn[0](Jn[1]));Jn[2]&&pi.recognizeWith(Jn[2]),Jn[3]&&pi.requireFailure(Jn[3])},this)}Ya.prototype={set:function(_n){return en(this.options,_n),_n.touchAction&&this.touchAction.update(),_n.inputTarget&&(this.input.destroy(),this.input.target=_n.inputTarget,this.input.init()),this},stop:function(_n){this.session.stopped=_n?Ua:ys},recognize:function(_n){var On=this.session;if(!On.stopped){this.touchAction.preventDefaults(_n);var Jn,pi=this.recognizers,Si=On.curRecognizer;(!Si||Si&&Si.state&Jo)&&(Si=On.curRecognizer=null);for(var zi=0;zi<pi.length;)Jn=pi[zi],On.stopped!==Ua&&(!Si||Jn==Si||Jn.canRecognizeWith(Si))?Jn.recognize(_n):Jn.reset(),!Si&&Jn.state&(qo|na|Go)&&(Si=On.curRecognizer=Jn),zi++}},get:function(_n){if(_n instanceof ia)return _n;for(var On=this.recognizers,Jn=0;Jn<On.length;Jn++)if(On[Jn].options.event==_n)return On[Jn];return null},add:function(_n){if(cr(_n,"add",this))return this;var On=this.get(_n.options.event);return On&&this.remove(On),this.recognizers.push(_n),_n.manager=this,this.touchAction.update(),_n},remove:function(_n){if(cr(_n,"remove",this))return this;if(_n=this.get(_n),_n){var On=this.recognizers,Jn=dn(On,_n);Jn!==-1&&(On.splice(Jn,1),this.touchAction.update())}return this},on:function(_n,On){if(_n!==Ve&&On!==Ve){var Jn=this.handlers;return Br(pn(_n),function(pi){Jn[pi]=Jn[pi]||[],Jn[pi].push(On)}),this}},off:function(_n,On){if(_n!==Ve){var Jn=this.handlers;return Br(pn(_n),function(pi){On?Jn[pi]&&Jn[pi].splice(dn(Jn[pi],On),1):delete Jn[pi]}),this}},emit:function(_n,On){this.options.domEvents&&Nn(_n,On);var Jn=this.handlers[_n]&&this.handlers[_n].slice();if(!(!Jn||!Jn.length)){On.type=_n,On.preventDefault=function(){On.srcEvent.preventDefault()};for(var pi=0;pi<Jn.length;)Jn[pi](On),pi++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ja(_n,On){var Jn=_n.element;if(Jn.style){var pi;Br(_n.options.cssProps,function(Si,zi){pi=Sn(Jn.style,zi),On?(_n.oldCssProps[pi]=Jn.style[pi],Jn.style[pi]=Si):Jn.style[pi]=_n.oldCssProps[pi]||""}),On||(_n.oldCssProps={})}}function Nn(_n,On){var Jn=Be.createEvent("Event");Jn.initEvent(_n,!0,!0),Jn.gesture=On,On.target.dispatchEvent(Jn)}en(Ia,{INPUT_START:Gn,INPUT_MOVE:Fn,INPUT_END:Hn,INPUT_CANCEL:Dn,STATE_POSSIBLE:$o,STATE_BEGAN:qo,STATE_CHANGED:na,STATE_ENDED:Go,STATE_RECOGNIZED:Jo,STATE_CANCELLED:Xo,STATE_FAILED:Do,DIRECTION_NONE:zn,DIRECTION_LEFT:Qn,DIRECTION_RIGHT:Zn,DIRECTION_UP:si,DIRECTION_DOWN:ei,DIRECTION_HORIZONTAL:hi,DIRECTION_VERTICAL:Un,DIRECTION_ALL:Wn,Manager:Ya,Input:ci,TouchAction:Io,TouchInput:ki,MouseInput:lo,PointerEventInput:Eo,TouchMouseInput:Wi,SingleTouchInput:Kn,Recognizer:ia,AttrRecognizer:sa,Tap:da,Pan:za,Swipe:Aa,Pinch:Pa,Rotate:ma,Press:wa,on:hn,off:mn,each:Br,merge:rn,extend:an,assign:en,inherit:on,bindFn:sn,prefixed:Sn});var Xn=typeof Se<"u"?Se:typeof self<"u"?self:{};Xn.Hammer=Ia,$e.exports?$e.exports=Ia:Se[De]=Ia})(window,document,"Hammer")})(He$1);var b$t=Object.defineProperty,C$q=($e,Se,Be)=>Se in $e?b$t($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,n$u=($e,Se,Be)=>(C$q($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let S$u=class{constructor(Se,Be){n$u(this,"width"),n$u(this,"height"),n$u(this,"containerDom"),n$u(this,"hooks",new E$v),n$u(this,"canvas",document.createElement("canvas")),n$u(this,"config"),n$u(this,"state",{enabled:!1}),n$u(this,"five"),n$u(this,"scale"),n$u(this,"offset",{x:0,y:0}),n$u(this,"context"),n$u(this,"renderCenter",new Vector3),n$u(this,"hammer"),n$u(this,"offsetRange"),n$u(this,"isPanning",!1),n$u(this,"imageData",new ImageData(1,1)),n$u(this,"onPanstart",()=>{this.isPanning=!0,this.canvas.style.boxShadow="0 2px 30px 0 rgba(0,0,0,0.20)"}),n$u(this,"onPan",Ke=>{if(!this.isPanning||!this.offsetRange||this.hooks.emit("wantsPanGesture",Ke))return;const{translateX:Ye,translateY:or}=this.getPanOffset(Ke,this.offsetRange);this.canvas.style.transform=`translate3d(${Ye}px, ${or}px, 100px)`}),n$u(this,"onPanend",Ke=>{if(this.isPanning=!1,this.canvas.style.boxShadow="none",!this.offsetRange)return;const{translateX:Ye,translateY:or}=this.getPanOffset(Ke,this.offsetRange);this.canvas.style.transform=`translate3d(${Ye}px, ${or}px, 100px)`,this.offset={x:Ye,y:or}});var De,Ve,Fe,Je;if(!Se.renderer){console.error("Five Render 未初始化");return}this.five=Se,this.scale=(De=Be?.scale)!=null?De:2,this.width=(Ve=Be?.width)!=null?Ve:190,this.height=(Je=(Fe=Be?.height)!=null?Fe:Be?.width)!=null?Je:190,this.config={dragEnabled:Be?.dragEnabled||!1,autoFixPCPosition:Be?.autoFixPCPosition||!1,initialPosition:Be?.initialPosition||{left:"0",top:"0"}};const Xe=this.canvas.getContext("2d");if(!Xe)throw new Error("CANNOT CREATE CONTEXT2D");this.context=Xe,this.config.dragEnabled&&(this.hammer=new Qt$2(this.canvas),this.hammer.on("pan",this.onPan),this.hammer.on("panstart",this.onPanstart),this.hammer.on("panend",this.onPanend)),this.initStyle()}enable(){if(!this.state.enabled)return this.state.enabled=!0,this.containerDom&&this._appendTo(this.containerDom),this}disable(){if(this.state.enabled)return this.state.enabled=!1,this.canvas.style.visibility="hidden",this.canvas.remove(),this}dispose(){var Se;this.clear(),this.disable(),(Se=this.hammer)==null||Se.destroy()}appendTo(Se){var Be;return this.containerDom&&((Be=this.containerDom)==null||Be.removeChild(this.canvas)),this.containerDom=Se,this.state.enabled&&this._appendTo(Se),this}clear(){var Se;return(Se=this.context)==null||Se.clearRect(0,0,this.canvas.width,this.canvas.height),this}renderWithPoint(Se){this.containerDom&&this.state.enabled&&(this.renderCenter=Se,this.render(),this.config.autoFixPCPosition&&this.autoFixPCPosition())}renderWithScreenPoint(Se){this.containerDom&&this.state.enabled&&(this.renderCenter=Se,this.render(),this.config.autoFixPCPosition&&this.autoFixPCPosition())}resetOffset(){this.offset={x:0,y:0},this.canvas.style.transform="translate3d(0px, 0px, 100px)"}render(){if(!this.five.renderer||!this.containerDom)return;const{scale:Se,context:Be,width:De,height:Ve}=this,Fe=this.five.renderer.getSize(new Vector2),[Je,Xe]=(()=>{if(this.renderCenter.isVector3){const an=this.renderCenter.clone().project(this.five.camera);return[(an.x+1)/2*Fe.x,(an.y+1)/2*Fe.y]}else return[this.renderCenter.x,Fe.y-this.renderCenter.y]})(),Ke=1,Ye=De/Se,or=Ve/Se,sr=Ke*Se,cr=new Map;this.five.scene.traverse(an=>{an.disableGetPixel===!0&&(cr.set(an,an.visible),an.visible=!1)});const Br=this.five.getPixels(Je-Ye/2,Xe-Ye/2,Ye,or,sr);cr.forEach((an,rn)=>{rn.visible=an});const tn=Math.floor(De*Ke),en=Math.floor(Ve*Ke);R$o(Br,tn,en),(this.imageData.width!==tn||this.imageData.height!==en)&&(this.imageData=new ImageData(tn,en)),this.imageData.data.set(Br),Be.putImageData(this.imageData,0,0),this.canvas.style.visibility="visible"}getRenderCenter(){return this.renderCenter}_appendTo(Se){if(this.resetOffset(),Se.appendChild(this.canvas),!this.offsetRange){const Be=this.canvas.getBoundingClientRect(),De=Se.getBoundingClientRect(),Ve=De.right-Be.right,Fe=De.bottom-Be.bottom,Je=De.left-Be.left,Xe=De.top-Be.top;this.offsetRange={min:{x:Je,y:Xe},max:{x:Ve,y:Fe}}}}autoFixPCPosition(){if(!this.containerDom)return;const{width:Se,height:Be}=this,{clientWidth:De,clientHeight:Ve}=this.containerDom,[Fe,Je,Xe]=(()=>{if(this.renderCenter.isVector3){const Ke=this.renderCenter.clone().project(this.five.camera);return[(Ke.x+1)/2*De,-(Ke.x-1)/2*De,-(Ke.y-1)/2*Ve]}else return[this.renderCenter.x,De-this.renderCenter.x,this.renderCenter.y]})();Fe<183?(this.canvas.style.top=-Be/2+"px",this.canvas.style.left="90px"):Xe<183?(this.canvas.style.top="90px",this.canvas.style.left=-Se/2+"px"):Je<183?(this.canvas.style.top=-Be/2+"px",this.canvas.style.left=-Se-90+"px"):(this.canvas.style.left=-Se/2+"px",this.canvas.style.top=-Be-90+"px"),this.canvas.style.transform=`translate3d(${Fe}px, ${Xe}px, 10px)`,this.offset={x:Fe,y:Xe}}initStyle(){const Se=this.canvas;Se.classList.add("five-plugin__magnifier"),Se.style.position="absolute",Se.style.pointerEvents=this.config.dragEnabled?"all":"none",Se.style.borderRadius="50%",Se.style.zIndex="99";const Be=1;Se.setAttribute("width",(this.width*Be).toString()),Se.setAttribute("height",(this.height*Be).toString()),Se.style.border="2px solid rgba(255,255,255,0.20)",Se.style.width=this.width+"px",Se.style.height=this.height+"px",Se.style.top=this.config.initialPosition.top,Se.style.left=this.config.initialPosition.left,Se.style.transform="translate(0,0,100px)",Se.style.visibility="hidden",this.config.dragEnabled&&(this.canvas.style.cursor="pointer")}getPanOffset(Se,Be){const{min:{x:De,y:Ve},max:{x:Fe,y:Je}}=Be,Xe=this.offset.x+Se.deltaX,Ke=this.offset.y+Se.deltaY,Ye=Math.min(Math.max(Xe,De),Fe),or=Math.min(Math.max(Ke,Ve),Je);return{translateX:Ye,translateY:or}}};function d$E($e,Se,Be){const De=$e[Se],Ve=$e[Be];De===void 0||Ve===void 0||($e[Se]=Ve,$e[Be]=De)}function R$o($e,Se,Be){const De=Be/2;for(let Ve=1;Ve<=De;Ve++){const Fe=Be-(Ve-1);for(let Je=1;Je<=Se;Je++){const Xe=(Ve-1)*Se+Je-1,Ke=(Fe-1)*Se+Je-1;d$E($e,Xe*4+0,Ke*4+0),d$E($e,Xe*4+1,Ke*4+1),d$E($e,Xe*4+2,Ke*4+2),d$E($e,Xe*4+3,Ke*4+3)}}}const A$y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbYAAAGwCAYAAADFUEBtAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABtqADAAQAAAABAAABsAAAAABTZ8U6AAAtiklEQVR4Ae2dAXJbSbJdp+d7AfYSHOGVeAPek5fkNXgLjviLmRkZl+CRbtc8UBKRRalZpyIesiorMx/eIcjb+QCh//Y3hwQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkMEbgj7FKFpLA4QS+fPnyx23czJc//V498h2Oy8uXwDYCf/oF3HYWC0vgAAI3QfuP22V+uR35vYplrOsX/03w/kWAVgISmCPwX+ZKWUkCErgR+PvtiKjF9uj/iMx+C1/HOZeABJ4koLA9CdB0CRQBxKxFrLa/Tung7Ni+InEigTkCCtscSytJIATo2BC3dGYIWfvs2Hy9SGATAYVtE1jLHkkgohbxQsACgTkWn8IWEg4JbCCgsG2AasljCXArMgB6DpAWs3/i1EpAArMEFLZZnlY7m0C6snwyMuPqFiT+2Cvhi98hAQk8SUBhexKg6RIoAtyKjItbj1jCWGPxayUggSECCtsQSMtI4EYgYhVx624tYOK/8mXPIQEJDBNQ2IaBWu5oAnRh3GZkHSiIG8J3NCgvXgI7CShsO+la+zQCEa0ciBgWDlnji3VIQAIbCChsG6Ba8mgCdGSxjCsRu/IRr5WABJ4goLA9Ac9UCSwE6Nj6Y/0RsBxXviXdpQQkMEFAYZugaA0J3AnQhdG1xYsPccPKTAIS2ERAYdsE1rJHEohocQsy8xwZdGuse+8e4aMEJDBGQGEbQ2khCXz94AgCxkf8gwZf5u3P2iEBCQwSUNgGYVpKAjcC+eYRRKw7NeaBpLCFgkMCmwgobJvAWvZIAhE1bkUGAAK3zq/W8TkkIIEBAgrbAERLSOCVQISsPzgSd3x0a8xjczgkIIENBBS2DVAteSwBBGsVrV4zxx4LywuXwC4CCtsustY9kUDEio4t8/W9tO7cTuTjNUvgQwgobB+C2ZMcQoD317BX4kanhj0EjZcpgY8joLB9HGvP9PkJRKwiai1odm2f/+fuFf5mBBS23+wH4tP5yxPgViRdWy6I7iwihx/fX/6CvQAJ/G4EFLbf7Sfi8/krE+DfsEW0umvrOdensEFCK4FhAgrbMFDLHU0AQUO0sHRq3JaMdUhAApsIKGybwFr2SAIRsr7ViLAFRsSsha33su+QgASGCChsQyAtI4EbgYhabkdmRLi6M1uFbF2/JPkgAQk8T0Bhe56hFSQAgYgVHVt8iBsWX2zHZe2QgASGCChsQyAtI4EbgQhYjh6s23Yn17HOJSCBAQIK2wBES0jglUC6sBy8l9Zg8MUmBqHrGOcSkMAAAYVtAKIlJPBKIGLFsULBT7emsK2EXEtgiIDCNgTSMhK4EUC8EK0WsZ6zLzQJSGADAYVtA1RLHksggtUfCmkB63kAretjoXnhEpgmoLBNE7XeyQQQNrqzlUX22VPYVjquJTBEQGEbAmkZCdwI8KGQt0SLPazgJCCBYQIK2zBQyx1PgE9FAiICli4NG7+iFgoOCWwioLBtAmvZIwnw/hpfhsxtxxUGQrf6XUtAAgMEFLYBiJaQwCuBCBu/UxEvhG4F9NbeGutaAhL4SQL8Ev5kmuESkMAFgdxi5Fbko9uNj/wX5XRJQALvIaCwvYeaORK4JhBRQ7hi37rlSNx1Jb0SkMC7CShs70ZnogT+jUDEiiObLV6ZR+gYvYdPKwEJDBBQ2AYgWkICrwQQNUSsxWt9X633BCgBCQwSUNgGYVrqeAIRKz4wsgrX99bHwxOABKYIKGxTJK0jgfutx/XDI7zPxm1IBA4rNwlIYJiAwjYM1HJHE+DDIy1azLFHA/LiJfARBBS2j6DsOU4hEPFaOzauvTu3xCl0kNFKYJiAwjYM1HJHE0CwEC3W3IZE3AKJmKOBefES2EFAYdtB1ZqnEki3lq/TYiBkLWL4iNFKQALDBBS2YaCWO5oAHRoQ1tuSLWrZc0hAAhsIKGwboFryWAIRKwQLEYvYPZofC8oLl8BOAgrbTrrWPo1Ad2x0a2FwNe/bk6dx8nolsJWAwrYVr8UPIxCxomPj0hGw2O7c2NdKQALDBBS2YaCWO5pAxGsVsgbSe8x737kEJDBAQGEbgGgJCbwSSLdGx5bujPkKiM5t9buWgAQGCChsAxAtIYFXAmvH9gjMI8F7FK9fAhL4CQIK20/AMlQC3yEQYYto0ZHFZvRtR/bad4/yUQISGCGgsI1gtIgEXgjQsSFa2MaDD9t7ziUggQECCtsAREtI4JVAurUIFscVmKsu7ipOnwQk8E4CCts7wZkmgQcE8jvF7cYrEbvyPSilWwISeA8Bhe091MyRwDWBfE9kd2tXtxvxYa8r6ZWABN5NQGF7NzoTJfBvBBC1WDozgvC1ZU8rAQkMElDYBmFa6ngCES0+Fbl+pD9Chy9xORwSkMAGAgrbBqiWPJYAgoW4NQj24lu7uY5zLgEJPElAYXsSoOkSKAIRtO7KEDC6M9aJwVfpTiUggQkCCtsERWtI4E6gu7J4unPLHsKWPYUtFBwS2EBAYdsA1ZLHEohY0bFFxBC6R/NjQXnhEthJQGHbSdfapxFAyHLd3a09mp/Gx+uVwIcQUNg+BLMnOYRABIyOjUtmna6NW5HxeSsSQloJDBNQ2IaBWu54AnRtCFeLGbck/3WjxP7xwAQggWkCCts0UeudTCDfPJKjRwsYc76hpOOcS0ACQwQUtiGQlpHAjUCEK7cZ6cwChTmdG+KGTYxDAhIYJKCwDcK01PEEIlYcwEDAsKuftVYCEhgioLANgbSMBG4EHolad22JYS00CUhgAwGFbQNUSx5LILch+RRkQ6Bba8u845xLQAIDBBS2AYiWkMArgYhVv8fW76vRpeETmgQksImAwrYJrGWPJBBh4wiAtSt7a+9IYF60BHYQUNh2ULXmqQQQrti1M0Pk2GN9KiuvWwLbCChs29Ba+EACvMcWUVvfa+NWZLBE1BS2kHBIYAMBhW0DVEseTQDRamFrUcs8h0MCEthEQGHbBNayRxKImPGtIi1e3Z1l3kJ3JCgvWgI7CShsO+la+zQCb92KbBYKW9NwLoFhAgrbMFDLHU2A25DdoV0ByX7fqryK0ScBCbyTgML2TnCmSeCCAILVHRlzbNIyd0hAApsIKGybwFr2SALpwujaAED3ho1/jSFWKwEJDBBQ2AYgWkICrwRasBCytTvDLzQJSGATAYVtE1jLHkkgorW+d/ZIyNa4I4F50RLYQUBh20HVmqcSQNjo0rJmDpNHQse+VgISeJKAwvYkQNMlUATW99giao86MwWuwDmVwCQBhW2SprUk8OevyqKD+9cNDN1bW3lJQAIbCChsG6Ba8lgC6c440q0hYvk2Egb+7DkkIIENBBS2DVAteSyBiFVEbL0F2SKWPYcEJLCRgMK2Ea6ljyPQ3RoXH1HLgaAhco/eeyNPKwEJvJOAwvZOcKZJ4IIAYhW7Chni1vaihC4JSOBZAgrbswTNl8A3AhEtxI3ODCFLVPu+ZTmTgARGCShsozgtdjiBCBdHUKRruxKz9ifOIQEJDBJQ2AZhWup4AhGxdGyxLV6IG4CyXn3saSUggScJKGxPAjRdAkUgYsX7a9ySbIEjND6HBCSwiYDCtgmsZY8kQLfW3VjPgRLflZ99rQQk8AQBhe0JeKZK4IIAHRvCRceGTUrPL0rokoAEniGgsD1Dz1wJ/JnA2rGtnVm+Witj9d+9PkpAAiMEFLYRjBaRwAsBhC2W0d0Z++0jTisBCQwRUNiGQFpGAq8E8pVa6cgQLyyAWHOrEr9WAhIYIqCwDYG0jARuBNKR5Yh4ddeGiLUf3y3UIQEJTBJQ2CZpWut0AtxqjGjl6O6MOYwUNkhoJTBMQGEbBmq5owkgaIgWlk4NccMeDcuLl8AuAgrbLrLWPZEAtyK59ghbixjC1z5itRKQwBABhW0IpGUk8EqA99jo1uLuuaLmS0UCmwkobJsBW/4oAnRsES9Gd2nxIXJY4rQSkMAQAYVtCKRlJHAjgFjRtQVKfBE6fKyz55CABDYQUNg2QLXksQQiWhGwDESuhax9zO/RPkpAAmMEFLYxlBaSwIuYRbA4rpCke/N9tisy+iQwREBhGwJpGQncCETQeJ8tQHivLf51Hp9DAhLYQEBh2wDVkscSiFjlK7UYLV49Z18rAQlsIKCwbYBqyWMJRNT4kMgVhIhbd25XMfokIIEnCShsTwI0XQJFIMJFZ4Zlm/fV8PMhE/a1EpDAEAGFbQikZSRwIxDRWju2+CJq7Y8PgbtNHRKQwCQBhW2SprVOJ0AXhg0PRA02CBoWv1YCEhgioLANgbSMBG4EIlYRtVhuPcZm4LuvfJSABLYRUNi2obXwoQS45dhdG6IWmyMDe1/5KAEJjBFQ2MZQWkgCLx/1R7xi6dqYNyKFrWk4l8AgAYVtEKaljifQohYY3bVF5BA6bk8eD0wAEthBQGHbQdWaJxNAzBC5sEDQ6NxYn8zJa5fANgIK2za0Fj6QQIQrwhbbo9eZ/+t2tK9jnUtAAk8SUNieBGi6BIpARC3fPtIdGfPYDAQNe/f6KAEJjBFQ2MZQWkgCL6IVwWrRYo4Npv4+SbFJQALDBBS2YaCWO5rA+l2RLWbducXfe0dD8+IlME1AYZsmar2TCSBYV6KFD8uHTE7m5bVLYAsBhW0LVoseSmAVtn5fjXnQIG6HYvKyJbCXgMK2l6/VzyPQnVgLWM9DpePOo+QVS2AjAYVtI1xLH0cgYpWju7OGEHFjbxW6jnMuAQk8QUBhewKeqRJYCETUECwsIRG0+HIgbuxpJSCBQQIK2yBMS0ngRqA7NoQMMPmH2Rmr/+71UQISGCGgsI1gtIgEXghE1DJiW+BenLcH/vE2a60EJLCBgMK2AaoljyWQTqxFDaFrIN21td+5BCQwREBhGwJpGQncCCBsb91qpGtLjEMCEthAQGHbANWSxxJIh4aoxfIhkRaxK9+xwLxwCewgoLDtoGrNkwn090C2oMEkPm5H4tNKQAKDBBS2QZiWOp5Ad2x8vD9Q6NIyj7ARl7VDAhIYJqCwDQO13NEEEK1AoFuLqK0fImnROxqYFy+BHQQUth1UrXkqAYQN4cLGn3kGc4Tv7vVRAhIYI6CwjaG0kARe/p1aBKtFizk2mHouNglIYJiAwjYM1HLHE8htR7qzfi+tPzASYVPcjn+pCGAXAYVtF1nrnkiA99KwLV78+zW49B4+rQQkMEBAYRuAaAkJvBKIoHWXBhhEjK4ta3zEaCUggSECCtsQSMtI4JVAhC23IhE4bksiZr0WmgQksIGAwrYBqiWPJRDxQtgQstiIGevu2o4F5YVLYCcBhW0nXWufRgDxynX3e2qIXfzME+uQgAQ2EFDYNkC15LEEIlqrcCFgsd6GPPal4YV/JAGF7SNpe65TCETEELi+ZsWtaTiXwCYCCtsmsJY9kgCChqhh42f4HhsktBLYREBh2wTWskcSQNhyyzGiltGiljX+zB0SkMAGAscI25cvX/IHhj8y+ePCmj807QvqK3/7EkMNbO8zZ++RTdy6l9rk9/6Vb41lfRW7nidr6pPXMfERs+53feKI7Rr4Oqb3OX/73po/E881XFmeZyz7PA+ulfVqEx/ff3+1mSen31Pjk5F0bP/r9pr8H68x2SM2+6yxN9fX/9UN+T9iiaHO9+zVuR/l/ExsarwVv14fzxvLc2Dddt1jvdrkxIddz5l175PPua7W1GLvkU3tf77WJyY+ancd5uwnnnnb+FMzg5rYl7p//PEH9e9RBz3mF/CIUcLWfxjzyTXWWP4oscYmlr237Fs11zxi8zPIeTjXapPHf4QkJ4P42AxyqMm58K9xWa+xySEPS17Oj6/j2E8t/Fd1E7fmX8URs8ZTf/Wva/K7Nr63bNd/VLPzmV/FZi9HRvb5gxObwR8c/ohhs88c2778IYu/97LffzTZw2b/H7ej6/Temk9s/OQQv1rOu/rJw2afA99b9lHd9TzUbD/ztT6x+L8X92h/zU8cz5e9tsw7rmtnP/kZ8ffRudknjvNhqYcl78tN3DI/buSX7tTRf3xggC82Lwj+OF3tx3e1T+yP2h954fHHkfPFMu98fFfn5nrIJbbzH+Vx/t7vfObZT2zWnC++jPU8iem8xLSv89e4xDK6buJy/hw/Ovqcb51nrbcKZ+dSExZXNvU6Z62/ruGxXh/X/1YtePC8sDkHdcnnua7nz5o8LHWJpQZrLPGssWt8r3lexLYlLpbrz37W7K35+BOXwfpR/j3q22PHrfl93m8Z386Bjzhs/OvzJLZt4juO/B/l37WOmK9gPvtF8wLJdeaFwos1/gzWvIiIaU74Ov6t/MSxj8XH+fCzXm3iGZwfG3/nM8dSa81nPzYHce0nJxY/cdj2r/PEXMVR79Fe7yeGutjsM+Jb/dSNfZTfeeR3Xup3fmLyOiCPvcSR3zEdmzlHxxLfIpl6/Zx5TvFnsE5u1+rnc5Wf82cQh717v/m7bmIyOE/m5GGv4snDJi+j62TNPv5ex5d1DvaxxMXC+Tb9Wi/zq/yOoUbi1rqPfJ2feY/Uy0GtWHyJw48Pm72MrDPIyxxf5gzysPF37ayzhy/r4wYv9k9/4a8tef/A84Pnhx//jwziyMPiTw3q9rmofRXHXudSF9sxV3HU/dGf51r36rlyzr4ezt2245ivNjV4jn1u5uyteVn3Na1xa37WHMntedbkU3PNT8w6Eksce6yx1GUfm33yiY3lIK7zE5+jfcTFdp2sE8ugLjH4Y1MP/2qzT27mGTzv++r+yHMiljr4OzZz9vE/Wnc+tcnBJqbj4qfe6ienY/CRg43/rXzyiOm8dd5r8rDkZ524PvDFZvAzfVRvzb2q3b571YMeAfjpL/n1Pba+zrw4+OH3PDH9guo5+eRhOx9fYpljyWfvkZ+43ud5cK7ssc8eddtSizwsfmpc2fiI73N0/TUvex17lc8+ucRQt9f4YtfR+WvNxLKPJZ81ltzVEo9NfD+3zo8fMcDGx4Gva2VOjbbUwpe4+HqwF9t77WeePGJi8WOzz7xtzxOTQX722Mf3EvAakzn7+B+t33pu1CaGWmt9aseusexd5RLfMZyz49eanJ+/oeSvljxqYhPHQa2265w19ThP/PioHd/fTn1/LdfODyXzTz0e/JB5QeTae86Lpn0dgx+77nV+Yoh7ZJPfo/Px44td6xATyx4+1uRhiWW/4zlX7+HrOOarJfYqfz3/mpucNYY6jyznoxbrjseXmPaT05bYxBGb/cyzhw+bPQYxWWfOQU0sudi38rNHHpa678knB8u5Y+N7dA72yMOSx3rNz34G+6u97357TH5iOo6aiWp/1j2yR2zH4cNmjwMfdXpNjfYRxx7r2PgSu+7hwxIb26PzMl/XV8+j8zN/ibn4j/k17tOujxG2+lQkP8x8goixvlh4MeHHrvHxc/Re56/7iVvrxUdOz78Xl1gG+Vc5xMQmjueExR8bH7WyZsTX/vU87LW/5+THwj77HFf5OTf7mTPwYePPnLHWyh7nJ2a12adG5+MjvuPwJSZHrquvjXUsMV375r48Z/xdJ2tG51Mztv3MyYmND3/i19F7PeccxLPHOpZ6WGLIxU9O+5l3nc7HH9/qp17s1R7njWUfy3mJaT/ztX77yefnxB7noi412Mfix+LvPM7RPuLIi+39rK9i4j9mHCNsrz9RXihZXv3wr3zJwc8LiHUs80c128/51xz8if3e4DkQl1rk9x7naB9x2euDWm2pm1/crtX1Et97VzWJ59ysySW/1+27On+fp2NT42oQc/UcEo+fuK7B3vfisr/m57nnWGskltE5mRPLnDhs9nsQv/qpiz+Wj4uzlzqchzhq95r4+NpPPjnEscbih0XWfaxxrGNzPvI5P+uOy/yqJn5ief5Xsfg6h3jOzZrY2Az899WfnzP71CAmlvz2vVVr3eu8P80f3KX6U8xnXZwmbPk58kLqF8jqYy/+HPmFzFjj7t5/93c+MdjUyD4xsWtd9vAnt+dZM9b8R3Hx9x5/ZDgXlpi1LudjnzV5WfOHE1+fkzwsTK/Oc5XP+ZLPfizz7HfNrDlX5gzyk0c8cdTC4k9ufBzkxZ9BXPyJiSWG9ZVdfc0ve9S9Tb/O8WU/R0b77p5ve71+FNf+zHnu+FMj817Hl5HnjJ/ng8WfOOax7MefwR7+Pv8av66JTS75WOq+nOT1AR/xxGabeWoyf037+hy/l8/+Vd66lxjOg01Mz7vOVX728ZP3Yr0VCbozLD98XgyPrjpxxK4x5LKPTVz2Hu3jX+utecRR961fNGr1eeMjl3mv4+McmWes67v3/sgfj6yos8ZzfvZjmd+r3B/xJT5zbMdk3vmcfz1n4lZf53Eu7NW5spf62buqdXN/vY7OJy+5OThH4vGtlpyOTXwG58fevffHxJPDudbnSt7qT4Xk9CD2ytexnLPPT05qJPbqfPg6n1h8qdPzrMlj72q/fT3v3DU/cVwXOcRjk3M12CcPi5+crNtHHPucn3XHxtfrnmcvtdZ6iemaWZOHvbnOHEcBuP0XTDpUXgBYutZ13X7y2kf8lU3cz8RSI69C8mLxY/FdxcXXcdTBh1391GT/LftWLM+J/D7P1RzfWzUf1cLfdj0/e12fmCvb8ez3c4yPmNWy9z9vk/+WxW2Qmz9Iicfyx+g/b77/9+rnD9dqb9tf/3iRF9txicn60X7HMu9Y8qlBzCOb+OSvz+Mqntiuje+RvapDfnJ6/3vPoc+RzjK5Gev1v1Vnje3zrx127/U85/zR8/dzuXquXZfzr8+R9bHfPMLXNAXgpx+3e878wD/9tXqBH0/g9h9O//d21v96O/LHpwfr2LwGI3T/5/Z6/N8d5FwCEpghcJSwzSCzigQeEmjhajFLAl1b/BwPC7khAQm8n4DC9n52ZkpgJYBgxUbIesSXQcx95aMEJDBOQGEbR2rBwwlwu/vqPbagQfQQusNxefkSmCegsM0zteK5BOjGrsQLISPmXEpeuQQ2E1DYNgO2/FEE0q3RsWEDIPN+jy0+hC5zhwQkMEhAYRuEaanjCXQ31mIWMAjZao+HJgAJTBNQ2KaJWu9kAhEtOrV0aHRpfJCkhQ+BO5mX1y6BLQQUti1YLXoogVW4ELTg6D3Wh2LysiWwl4DCtpev1c8ikG5tvQWZT0ciarF0cZk7JCCBDQQUtg1QLXk0gQgW4hYQfO1Ri9rRgLx4CewmoLDtJmz9kwhExBC12Aw6tPvq/hiRs2NrIs4lMEhAYRuEaanjCSBYLVrrPOsrsTsengAkMEVAYZsiaR0J/Pt7aWGCkPU83VwLXvYcEpDAEAGFbQikZSRwIxCx4hZkC9c677XgJCCBYQIK2zBQyx1NIKKW99lyqzFHRkSMW4/47Nhe0PgggT0EFLY9XK16JoGIGN0YNiSYt2V+JimvWgIbCShsG+Fa+jgCEat0Y2vHFhB0bYlhHr9DAhIYJqCwDQO13NEEIlociFvWDPZ4Hw6/VgISGCSgsA3CtNTxBHjvDDHjW0cicuxlnkHMfeWjBCQwRkBhG0NpIQm8EOhu7B83D0IGHgQNi18rAQkMEVDYhkBaRgI3AhG1FjagRMQicG0VNuhoJTBMQGEbBmq5owlErFbBYr3ao0F58RLYSUBh20nX2qcRQNhi6dDCgDk2vqvOLn6HBCTwJAGF7UmApkugCETQECw6tGwzx1aKUwlIYJqAwjZN1HonE+A9tu7M4IEPiwCyr5WABIYIKGxDIC0jgRuBiFW6sqvODB9WYBKQwCYCCtsmsJY9kkBEK+JGVxYIzGMZCCBrrQQkMEhAYRuEaanjCUTY8iXI/3E76MxWG0jx4c/aIQEJDBJQ2AZhWup4AnRi+YfZ+daRq5GYDIXtzsFHCYwTUNjGkVrwcAII1ipu+GP7tuThuLx8CcwTUNjmmVrxXALpxujIIl65LZnB+2zM6exeNn2QgARmCShsszytdjaBdGPdmdGdtY9uDd/ZxLx6CWwgoLBtgGrJYwlErLpjy3oVsKy7gzsWlhcugV0EFLZdZK17IoEWslXQmgfi1z7nEpDAEAGFbQikZSRwI8B7Z4jaVWfmrUhfKhLYTEBh2wzY8kcRiKB1N5Y5QgYIRA+LXysBCQwRUNiGQFpGAjcCq7ABJX66N2wLIHFaCUhggIDCNgDREhJ4JcCtyAZCZ7bajnEuAQkMElDYBmFa6ngCEbb827V0ZXRmgZI5IwLHgU8rAQkMElDYBmFa6ngCCFYErr9Si24tgJhjj4cmAAlME1DYpola72QCESveO+NbRx7xUNgekdEvgScJKGxPAjRdAkUgYsXRtx8TEv/qi98hAQkME1DYhoFa7mgCES86tsyvBn7sVYw+CUjgCQIK2xPwTJXAQgBhozNDvFgjelmzt5RwKQEJPEtAYXuWoPkS+EYgwhXBQrQQsKyZJ7pjsnZIQAKDBBS2QZiWOp5ACxZiFiiP5scDE4AEdhBQ2HZQteapBCJgfbvxrXliHRKQwAYCCtsGqJY8lkDECsFi3rcgA6b3jwXlhUtgJwGFbSdda59GIP92rbs0xG3lsIrduu9aAhJ4goDC9gQ8UyWwEIiQRdzyrSN0ZkvIyzIxb+1f5eiTgAR+kIDC9oOgDJPADxCgQ+NbR1aBazHr+Q+UNkQCEvhRAgrbj5IyTgLfJ4CwxeZ24z9eU7j1iI1bYXuFo5HANAGFbZqo9U4mELHiPbYWLubYMOr5ycy8dgmME1DYxpFa8GACEasIG51ZbEaLGL77jo8SkMA4AYVtHKkFDyYQUYuIIWTYRoIP23vOJSCBAQIK2wBES0jglUDEahWsrOngEkbHtsZlzyEBCQwQUNgGIFpCAq8EIlZ9KxIwq4hlvfqI1UpAAk8SUNieBGi6BIoAgoW41daLkHXn1nvOJSCBQQIK2yBMSx1PIIKWI+OtjgwBvEf6KAEJjBJQ2EZxWuxwAqtgIW68r4boZc38cGRevgTmCShs80yteC6BfONIDoSMW48RuJ6fS8grl8AHEFDYPgCypziGAB1bd2P5Wi3WiFuA0M0dA8cLlcBHEVDYPoq05zmFACLG9fK9kVm3mPWcWK0EJDBAQGEbgGgJCbwSiKjRtdGdxTIQM/bwayUggUECCtsgTEsdTyDCxXtsiBg2cDJX1ELCIYGNBBS2jXAtfRwBRCy2Ray7Nm5VEnscJC9YArsJKGy7CVv/JAIRK4Qr1414YWFh1wYJrQQ2EFDYNkC15LEEImAcLV7dsWW/946F5YVLYBcBhW0XWeueSCDdGh1bd2k9DxfE70RGXrMEthNQ2LYj9gQHEYhgRdjoyK46tYNweKkS+DUEFLZfw92zfk4C+UQk3VhEje6Nq6Vz686OPa0EJDBEQGEbAmkZCdwI0LHF5htHMjLvDg6xQ+RegnyQgATmCChscyytJIEQ4N+x0b1d3Y5U1HytSGAjAYVtI1xLH0eAbgxLpxYQiFl3cMcB8oIl8BEEFLaPoOw5TiEQ0aJjyzUjZuv1x/9ob411LQEJ/CQBhe0ngRkugTcIrIKFeHXnlvR1/UZJtyQggZ8loLD9LDHjJfCYQG5BruKWaASOzHWNXysBCQwQUNgGIFpCAq8EELVHwtWd2qMYYUpAAk8SUNieBGi6BIpAxIoPjpT767TFrOdfA5xIQALPE1DYnmdoBQlAIGLFQXcWy0DM2MOvlYAEBgkobIMwLXU8gQhXd2yI3ArmkX+Ncy0BCbyDgML2DmimSOABgXzUP0e+dSQCR2e2dm0K2w2OQwK7CChsu8ha90QCCNY/bhePmCFudHL4E+uQgAQ2EFDYNkC15NEEELBAQLwQt/YdDcmLl8BOAgrbTrrWPo1ARK1vQXL97UPkED1itBKQwBABhW0IpGUkcCPArUhECxELHHzMex2fQwISGCKgsA2BtIwEbgTSmSFuiFrWmTPYV9ggopXAMAGFbRio5Y4msIpWi1fPj4bkxUtgNwGFbTdh659EIOKVri0DkaNzu3u/PSp031g4k8AoAYVtFKfFDieAmCFaLWr4gqj9hyPz8iUwT0Bhm2dqxXMJRLzo2EKhxaypxP9or+OcS0AC7yCgsL0DmikSeEAg3zrCR/sTgnitHdq6flBOtwQk8B4CCtt7qJkjgWsCETI+GZmv1WIgcFlnzsG+VgISGCSgsA3CtNTxBBC2gEj35pCABH4BAYXtF0D3lJ+WAN1aBC63GzOYY/H1e3EvgT5IQAIzBBS2GY5WkQAEImAc7cs8fkbP8WklIIEBAgrbAERLSOCVQMSKW5DdsWWbD4ys/tdUjQQkMEVAYZsiaR0JfPvgSFhE5BAz2MRnpwYNrQQ2EVDYNoG17JEE1vfYELIIHO+p2bEd+dLwoj+SgML2kbQ91wkEELBca3dnzLEnsPAaJfBLCChsvwS7J/2kBCJaEbb1FmT72FPgPumLwMv69QQUtl//M/AZfB4CESsEKxYRyxXiZ97r+BwSkMAQAYVtCKRlJHAjkE9ERrAQLea8rxZI+PqWZfwOCUhgiIDCNgTSMhK4EYho8XH/ALkStPgdEpDARgIK20a4lj6OQLqwfj+tAXBbEktX1zHOJSCBAQIK2wBES0igCHCrsVwvU4RstWucawlI4EkCCtuTAE2XQBG46tjo0LwtWaCcSmAnAYVtJ11rn0agu7W1M2N9GhOvVwIfTkBh+3DknvATE0DYeJ/t0aUmLjEOCUhgAwGFbQNUSx5LoAXLDu3Yl4EX/qsJKGy/+ifg+T8TgXRhdG28p5b1+j4bMZ/p2r0WCfw2BBS23+ZH4RP5BAQQLGwuKaLGrcm+/ZgYhwQksIGAwrYBqiWPJRCxyj/QplsLCEQNseu97DskIIFhAgrbMFDLHU0gIpbj77cjQsYtSOY318s+cVk7JCCBYQIK2zBQyx1NIIIVEfvHKwWEraHQsSXOIQEJbCCgsG2AasmjCUTcGJkjZPgUNEhoJbCJgMK2CaxljySw3mKkY+NWZFsF7siXiBf9EQQUto+g7DlOIRCxasG6muPDnsLG65TAhxFQ2D4MtSc6gEDEioNuLZfdtyMRNOwBWLxECXwsAYXtY3l7ts9NIGLFe2wtXD3/3AS8Ogn8BgQUtt/gh+BT+DQEELa1W4sfH1ax+zQ/di/kdyOgsP1uPxGfz1+ZQLq1CNYqWu1jD/tXvl6fuwR+SwIK22/5Y/FJ/UUJRKz6I/5Z06HFMuJX2KChlcAwAYVtGKjljieAYD2yAGKftVYCEhgioLANgbSMBG4E8o0j/E7la7XWwQdL4lfYVjquJTBEgF/CoXKWkcDxBBCsiBy3H+Nb58QdD0wAEpgmoLBNE7XeyQTSkdGV8d4aotZ+5iez8tolsI2AwrYNrYUPJBARoxPDBsPVvH0HovKSJbCPgMK2j62VzyMQsaIbo2O7ovDW3lW8PglI4CcIKGw/ActQCXyHQISNTgx7ldJxV/v6JCCBJwgobE/AM1UCC4F0ay1adGbYhGee8Zbw3SN8lIAE3kVAYXsXNpMkcEkgYsWtyAQgXtj2Ze6QgAQ2EFDYNkC15LEEEDY6tO7O2pe4FrtjgXnhEthBQGHbQdWapxJAsFq0mGPDhrhTOXndEthKQGHbitfihxH45+168zsV4UqHxm1JOreb68WnsIWEQwKbCChsm8Ba9lgCEbceiFxsBiLH+u71UQISGCOgsI2htJAEXrqxdGm8nwaSVcSyXn3EaiUggScJKGxPAjRdAkUAwULcauvr7UkEDdsxziUggQECCtsAREtI4JVAxIr31d4Sruy9tS9QCUjgCQIK2xPwTJXAQmAVLMSL99UQPdZLuksJSGCCgMI2QdEaErgTWG9B8l5bBI55IlcBvGf7KAEJjBBQ2EYwWkQCLwRasBCzbFzN43NIQAIbCChsG6Ba8lgCCBtCxjrdWt+GZH4sKC9cAjsJKGw76Vr7NAIRMkQrc8bVvH3EaSUggQECCtsAREtI4JVAC1u/p7YCemtvjXUtAQn8JAGF7SeBGS6BNwjkW0f+/rof8boaVx3dVZw+CUjgnQQUtneCM00CFwS6Y7vY/uqyY/uKwokE5gkobPNMrXguAd43i23x6u5t3TuXllcugU0EFLZNYC17JIGIVosbEPD1evWxp5WABJ4koLA9CdB0CRQBhI1u7apTq3CnEpDADgIK2w6q1jyVQH8wJKLGunnYqTUN5xLYQEBh2wDVkscSaNF6mf/xxx9fbuNm7vZYMl64BCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQlIQAISkIAEJCABCUhAAhKQgAQkIAEJSEACEpCABCQgAQn8NQn8fyHnyuSABiy2AAAAAElFTkSuQmCC";function t$f($e,Se){const Be=Math.round($e);return Be%2===0?Be:Be+(Se!=null&&Se.floor?-1:1)}var c$K=Object.defineProperty,m$A=($e,Se,Be)=>Se in $e?c$K($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,o$E=($e,Se,Be)=>(m$A($e,Se+"",Be),Be);let p$B=class extends Mesh{constructor(Se,Be){const De=new MeshBasicMaterial({opacity:0,color:0,transparent:!1,side:DoubleSide}),Ve=new PlaneGeometry(Se,Be);super(Ve,De),o$E(this,"name","opacity-mesh")}removeFromParent(){const Se=this.parent;return Se!==null&&Se.remove(this),this}};function c$J(...$e){const Se=new Vector3;return $e.forEach(Be=>Se.add(Be)),Se.divideScalar($e.length),Se}const r$D=$e=>$e?$e.visible===!1?!1:r$D($e.parent):!0;var c$I=function($e){Object3D.call(this),this.element=$e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(Se){Se.element instanceof Element&&Se.element.parentNode!==null&&Se.element.remove()})})};c$I.prototype=Object.create(Object3D.prototype);c$I.prototype.constructor=c$I;var C$p=function($e){c$I.call(this,$e)};C$p.prototype=Object.create(c$I.prototype);C$p.prototype.constructor=C$p;let I$q=function($e){let Se=this,Be,De,Ve,Fe,Je=new Matrix4,Xe={camera:{fov:0,style:""},objects:new Map},Ke=document.createElement("div");Ke.style.overflow="hidden",this.domElement=Ke;let Ye=document.createElement("div");Ye.style.WebkitTransformStyle="preserve-3d",Ye.style.transformStyle="preserve-3d",Ye.style.pointerEvents="none",Ke.appendChild(Ye),this.getSize=function(){return{width:Be,height:De}},this.setSize=function(en,an){Be=en,De=an,Ve=Be/2,Fe=De/2,Ke.style.width=en+"px",Ke.style.height=an+"px",Ye.style.width=en+"px",Ye.style.height=an+"px"};function or(en){return Math.abs(en)<1e-10?0:en}function sr(en){let an=en.elements;return"matrix3d("+or(an[0])+","+or(-an[1])+","+or(an[2])+","+or(an[3])+","+or(an[4])+","+or(-an[5])+","+or(an[6])+","+or(an[7])+","+or(an[8])+","+or(-an[9])+","+or(an[10])+","+or(an[11])+","+or(an[12])+","+or(-an[13])+","+or(an[14])+","+or(an[15])+")"}function cr(en,an){let rn=en.elements;return"translate(-50%,-50%)"+("matrix3d("+or(rn[0])+","+or(rn[1])+","+or(rn[2])+","+or(rn[3])+","+or(-rn[4])+","+or(-rn[5])+","+or(-rn[6])+","+or(-rn[7])+","+or(rn[8])+","+or(rn[9])+","+or(rn[10])+","+or(rn[11])+","+or(rn[12])+","+or(rn[13])+","+or(rn[14])+","+or(rn[15])+")")}function Br(en){var an;if(en.isCSS3DObject){const rn=(an=en.mode)!=null?an:"front";(!$e||rn===$e)&&(en.element.style.display="none")}for(let rn=0,on=en.children.length;rn<on;rn++)Br(en.children[rn])}function tn(en,an,rn,on,sn){var ln;if(en.visible===!1){Br(en);return}if(en.isCSS3DObject){const cn=(ln=en.mode)!=null?ln:"front";if($e&&cn!==$e)return;en.flag=sn;const hn=en.layers.test(rn.layers)===!0,mn=en.element;if(mn.style.display=hn===!0?"":"none",hn){en.onBeforeRender(Se,an,rn);let An;en.isCSS3DSprite?(Je.copy(rn.matrixWorldInverse),Je.transpose(),Je.copyPosition(en.matrixWorld),Je.scale(en.scale),Je.elements[3]=0,Je.elements[7]=0,Je.elements[11]=0,Je.elements[15]=1,An=cr(Je)):An=cr(en.matrixWorld);let xn=Xe.objects.get(en);if(xn===void 0||xn.style!==An){mn.style.WebkitTransform=An,mn.style.transform=An;let pn={style:An};Xe.objects.set(en,pn)}mn.style.display=en.visible?"":"none",mn.parentNode!==Ye&&Ye.appendChild(mn),en.onAfterRender(Se,an,rn)}}for(let cn=0,hn=en.children.length;cn<hn;cn++)tn(en.children[cn],an,rn,on,sn)}this.render=function(en,an){let rn=an.projectionMatrix.elements[5]*Fe;if(Xe.camera.fov!==rn&&(an.isPerspectiveCamera?(Ke.style.WebkitPerspective=rn+"px",Ke.style.perspective=rn+"px"):(Ke.style.WebkitPerspective="",Ke.style.perspective=""),Xe.camera.fov=rn),en.autoUpdate===!0&&en.updateMatrixWorld(),an.parent===null&&an.updateMatrixWorld(),an.isOrthographicCamera)var on=-(an.right+an.left)/2,sn=(an.top+an.bottom)/2;let ln=an.isOrthographicCamera?"scale("+rn+")translate("+or(on)+"px,"+or(sn)+"px)"+sr(an.matrixWorldInverse):"translateZ("+rn+"px)"+sr(an.matrixWorldInverse),cn=ln+"translate("+Ve+"px,"+Fe+"px)";Xe.camera.style!==cn&&(Ye.style.WebkitTransform=cn,Ye.style.transform=cn,Xe.camera.style=cn);const hn=en.uuid+"_"+performance.now().toString();tn(en,en,an,ln,hn),Xe.objects.forEach(function(mn,An){An.flag!==hn&&(An.element.remove(),Xe.objects.delete(An))})}};const e$h=document.createElement("div");e$h.classList.add("behindFiveElement");e$h.style.position="absolute";e$h.style.top="0";e$h.style.left="0";e$h.style.width="100%";e$h.style.height="100%";e$h.style.pointerEvents="none";function d$D($e){var Se,Be,De,Ve,Fe;const Je=(Fe=(Be=c$H($e.getElement()))!=null?Be:c$H((Se=$e.getElement())==null?void 0:Se.parentElement))!=null?Fe:c$H((Ve=(De=$e.getElement())==null?void 0:De.parentElement)==null?void 0:Ve.parentElement),Xe=Je?.parentElement;if(Xe)return Xe.contains(e$h)||Je.parentElement.insertBefore(e$h,Je),e$h;console.error("Can not find a valid element to insert behindFiveElement. How to fix it: https://github.com/realsee-developer/dnalogel/tree/main/plugins/src/CSS3DRenderPlugin/README.md")}function c$H($e){var Se;if(!$e)return;const Be=(Se=$e.style.position)!=null?Se:getComputedStyle($e).position;if(Be!=="fixed"&&Be!=="absolute"&&Be!=="relative")return;const De=getComputedStyle($e),Ve=De.backgroundColor,Fe=De.backgroundImage;if(!(Ve!=="transparent"&&Ve!=="rgba(0, 0, 0, 0)"&&Ve!==""||Fe!=="none"&&Fe!==""))return $e}function t$e($e){return!i$w($e)}function i$w($e){return $e!=null}var o$D=Object.defineProperty,c$G=($e,Se,Be)=>Se in $e?o$D($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,a$A=($e,Se,Be)=>(c$G($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const s$p={uniforms:UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,{linewidth:{value:1},resolution:{value:new Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1},opacity:{value:1}}]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		varying vec2 vUv;

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;

			#endif

			float aspect = resolution.x / resolution.y;

			vUv = uv;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec2 ndcStart = clipStart.xy / clipStart.w;
			vec2 ndcEnd = clipEnd.xy / clipEnd.w;

			// direction
			vec2 dir = ndcEnd - ndcStart;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			// perpendicular to dir
			vec2 offset = vec2( dir.y, - dir.x );

			// undo aspect ratio adjustment
			dir.x /= aspect;
			offset.x /= aspect;

			// sign flip
			if ( position.x < 0.0 ) offset *= - 1.0;

			// endcaps
			if ( position.y < 0.0 ) {

				offset += - dir;

			} else if ( position.y > 1.0 ) {

				offset += dir;

			}

			// adjust for linewidth
			offset *= linewidth;

			// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
			offset /= resolution.y;

			// select end
			vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

			// back to clip space
			offset *= clip.w;

			clip.xy += offset;

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;

		#ifdef USE_DASH

			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		varying vec2 vUv;

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance, dashSize + gapSize ) < dashSize ) discard; // todo - FIX

			#endif

			if ( abs( vUv.y ) > 1.0 ) {

				float a = vUv.x;
				float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
				float len2 = a * a + b * b;

				if ( len2 > 1.0 ) discard;

			}

			vec4 diffuseColor = vec4( diffuse, opacity );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );

			#include <tonemapping_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};let l$v=class extends ShaderMaterial{constructor(Se){super({uniforms:UniformsUtils.clone(s$p.uniforms),vertexShader:s$p.vertexShader,fragmentShader:s$p.fragmentShader,clipping:!0}),a$A(this,"color"),a$A(this,"dashed"),a$A(this,"dashScale"),a$A(this,"dashSize"),a$A(this,"gapSize"),a$A(this,"resolution"),this.type="LineMaterial",this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get(){return this.uniforms.diffuse.value},set(Be){this.uniforms.diffuse.value=Be}},linewidth:{enumerable:!0,get(){return this.uniforms.linewidth.value},set(Be){this.uniforms.linewidth.value=Be}},dashScale:{enumerable:!0,get(){return this.uniforms.dashScale.value},set(Be){this.uniforms.dashScale.value=Be}},dashSize:{enumerable:!0,get(){return this.uniforms.dashSize.value},set(Be){this.uniforms.dashSize.value=Be}},gapSize:{enumerable:!0,get(){return this.uniforms.gapSize.value},set(Be){this.uniforms.gapSize.value=Be}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(Be){this.uniforms.opacity.value=Be}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(Be){this.uniforms.resolution.value.copy(Be)}}}),this.setValues(Se)}};Object.assign(l$v.prototype,{isLineMaterial:!0});const t$d=new Vector3;let c$F=class extends Sphere{expandByPoint(Se){if(this.isEmpty())return this.center.copy(Se),this.radius=0,this;t$d.subVectors(Se,this.center);const Be=t$d.lengthSq();if(Be>this.radius*this.radius){const De=Math.sqrt(Be),Ve=(De-this.radius)*.5;this.center.addScaledVector(t$d,Ve/De),this.radius+=Ve}return this}};var pr={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},Y$f={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},Fr=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],U$g={CSS:{},springs:{}};function D$q($e,Se,Be){return Math.min(Math.max($e,Se),Be)}function R$n($e,Se){return $e.indexOf(Se)>-1}function K$j($e,Se){return $e.apply(null,Se)}var c$E={arr:function($e){return Array.isArray($e)},obj:function($e){return R$n(Object.prototype.toString.call($e),"Object")},pth:function($e){return c$E.obj($e)&&$e.hasOwnProperty("totalLength")},svg:function($e){return $e instanceof SVGElement},inp:function($e){return $e instanceof HTMLInputElement},dom:function($e){return $e.nodeType||c$E.svg($e)},str:function($e){return typeof $e=="string"},fnc:function($e){return typeof $e=="function"},und:function($e){return typeof $e>"u"},nil:function($e){return c$E.und($e)||$e===null},hex:function($e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test($e)},rgb:function($e){return/^rgb/.test($e)},hsl:function($e){return/^hsl/.test($e)},col:function($e){return c$E.hex($e)||c$E.rgb($e)||c$E.hsl($e)},key:function($e){return!pr.hasOwnProperty($e)&&!Y$f.hasOwnProperty($e)&&$e!=="targets"&&$e!=="keyframes"}};function mr($e){var Se=/\(([^)]+)\)/.exec($e);return Se?Se[1].split(",").map(function(Be){return parseFloat(Be)}):[]}function yr($e,Se){var Be=mr($e),De=D$q(c$E.und(Be[0])?1:Be[0],.1,100),Ve=D$q(c$E.und(Be[1])?100:Be[1],.1,100),Fe=D$q(c$E.und(Be[2])?10:Be[2],.1,100),Je=D$q(c$E.und(Be[3])?0:Be[3],.1,100),Xe=Math.sqrt(Ve/De),Ke=Fe/(2*Math.sqrt(Ve*De)),Ye=Ke<1?Xe*Math.sqrt(1-Ke*Ke):0,or=1,sr=Ke<1?(Ke*Xe+-Je)/Ye:-Je+Xe;function cr(tn){var en=Se?Se*tn/1e3:tn;return Ke<1?en=Math.exp(-en*Ke*Xe)*(or*Math.cos(Ye*en)+sr*Math.sin(Ye*en)):en=(or+sr*en)*Math.exp(-en*Xe),tn===0||tn===1?tn:1-en}function Br(){var tn=U$g.springs[$e];if(tn)return tn;for(var en=1/6,an=0,rn=0;;)if(an+=en,cr(an)===1){if(rn++,rn>=16)break}else rn=0;var on=an*en*1e3;return U$g.springs[$e]=on,on}return Se?cr:Br}function Vr($e){return $e===void 0&&($e=10),function(Se){return Math.ceil(D$q(Se,1e-6,1)*$e)*(1/$e)}}var jr=function(){var $e=11,Se=1/($e-1);function Be(or,sr){return 1-3*sr+3*or}function De(or,sr){return 3*sr-6*or}function Ve(or){return 3*or}function Fe(or,sr,cr){return((Be(sr,cr)*or+De(sr,cr))*or+Ve(sr))*or}function Je(or,sr,cr){return 3*Be(sr,cr)*or*or+2*De(sr,cr)*or+Ve(sr)}function Xe(or,sr,cr,Br,tn){var en,an,rn=0;do an=sr+(cr-sr)/2,en=Fe(an,Br,tn)-or,en>0?cr=an:sr=an;while(Math.abs(en)>1e-7&&++rn<10);return an}function Ke(or,sr,cr,Br){for(var tn=0;tn<4;++tn){var en=Je(sr,cr,Br);if(en===0)return sr;var an=Fe(sr,cr,Br)-or;sr-=an/en}return sr}function Ye(or,sr,cr,Br){if(!(0<=or&&or<=1&&0<=cr&&cr<=1))return;var tn=new Float32Array($e);if(or!==sr||cr!==Br)for(var en=0;en<$e;++en)tn[en]=Fe(en*Se,or,cr);function an(rn){for(var on=0,sn=1,ln=$e-1;sn!==ln&&tn[sn]<=rn;++sn)on+=Se;--sn;var cn=(rn-tn[sn])/(tn[sn+1]-tn[sn]),hn=on+cn*Se,mn=Je(hn,or,cr);return mn>=.001?Ke(rn,hn,or,cr):mn===0?hn:Xe(rn,on,on+Se,or,cr)}return function(rn){return or===sr&&cr===Br||rn===0||rn===1?rn:Fe(an(rn),sr,Br)}}return Ye}(),br=function(){var $e={linear:function(){return function(De){return De}}},Se={Sine:function(){return function(De){return 1-Math.cos(De*Math.PI/2)}},Expo:function(){return function(De){return De?Math.pow(2,10*De-10):0}},Circ:function(){return function(De){return 1-Math.sqrt(1-De*De)}},Back:function(){return function(De){return De*De*(3*De-2)}},Bounce:function(){return function(De){for(var Ve,Fe=4;De<((Ve=Math.pow(2,--Fe))-1)/11;);return 1/Math.pow(4,3-Fe)-7.5625*Math.pow((Ve*3-2)/22-De,2)}},Elastic:function(De,Ve){De===void 0&&(De=1),Ve===void 0&&(Ve=.5);var Fe=D$q(De,1,10),Je=D$q(Ve,.1,2);return function(Xe){return Xe===0||Xe===1?Xe:-Fe*Math.pow(2,10*(Xe-1))*Math.sin((Xe-1-Je/(Math.PI*2)*Math.asin(1/Fe))*(Math.PI*2)/Je)}}},Be=["Quad","Cubic","Quart","Quint"];return Be.forEach(function(De,Ve){Se[De]=function(){return function(Fe){return Math.pow(Fe,Ve+2)}}}),Object.keys(Se).forEach(function(De){var Ve=Se[De];$e["easeIn"+De]=Ve,$e["easeOut"+De]=function(Fe,Je){return function(Xe){return 1-Ve(Fe,Je)(1-Xe)}},$e["easeInOut"+De]=function(Fe,Je){return function(Xe){return Xe<.5?Ve(Fe,Je)(Xe*2)/2:1-Ve(Fe,Je)(Xe*-2+2)/2}},$e["easeOutIn"+De]=function(Fe,Je){return function(Xe){return Xe<.5?(1-Ve(Fe,Je)(1-Xe*2))/2:(Ve(Fe,Je)(Xe*2-1)+1)/2}}}),$e}();function G$g($e,Se){if(c$E.fnc($e))return $e;var Be=$e.split("(")[0],De=br[Be],Ve=mr($e);switch(Be){case"spring":return yr($e,Se);case"cubicBezier":return K$j(jr,Ve);case"steps":return K$j(Vr,Ve);default:return K$j(De,Ve)}}function xr($e){try{var Se=document.querySelectorAll($e);return Se}catch{return}}function W$g($e,Se){for(var Be=$e.length,De=arguments.length>=2?arguments[1]:void 0,Ve=[],Fe=0;Fe<Be;Fe++)if(Fe in $e){var Je=$e[Fe];Se.call(De,Je,Fe,$e)&&Ve.push(Je)}return Ve}function q$o($e){return $e.reduce(function(Se,Be){return Se.concat(c$E.arr(Be)?q$o(Be):Be)},[])}function lr($e){return c$E.arr($e)?$e:(c$E.str($e)&&($e=xr($e)||$e),$e instanceof NodeList||$e instanceof HTMLCollection?[].slice.call($e):[$e])}function X$b($e,Se){return $e.some(function(Be){return Be===Se})}function rr$1($e){var Se={};for(var Be in $e)Se[Be]=$e[Be];return Se}function _$j($e,Se){var Be=rr$1($e);for(var De in $e)Be[De]=Se.hasOwnProperty(De)?Se[De]:$e[De];return Be}function N$h($e,Se){var Be=rr$1($e);for(var De in Se)Be[De]=c$E.und($e[De])?Se[De]:$e[De];return Be}function zr($e){var Se=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec($e);return Se?"rgba("+Se[1]+",1)":$e}function Rr($e){var Se=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Be=$e.replace(Se,function(Xe,Ke,Ye,or){return Ke+Ke+Ye+Ye+or+or}),De=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Be),Ve=parseInt(De[1],16),Fe=parseInt(De[2],16),Je=parseInt(De[3],16);return"rgba("+Ve+","+Fe+","+Je+",1)"}function Hr($e){var Se=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec($e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec($e),Be=parseInt(Se[1],10)/360,De=parseInt(Se[2],10)/100,Ve=parseInt(Se[3],10)/100,Fe=Se[4]||1;function Je(cr,Br,tn){return tn<0&&(tn+=1),tn>1&&(tn-=1),tn<1/6?cr+(Br-cr)*6*tn:tn<1/2?Br:tn<2/3?cr+(Br-cr)*(2/3-tn)*6:cr}var Xe,Ke,Ye;if(De==0)Xe=Ke=Ye=Ve;else{var or=Ve<.5?Ve*(1+De):Ve+De-Ve*De,sr=2*Ve-or;Xe=Je(sr,or,Be+1/3),Ke=Je(sr,or,Be),Ye=Je(sr,or,Be-1/3)}return"rgba("+Xe*255+","+Ke*255+","+Ye*255+","+Fe+")"}function Ur($e){if(c$E.rgb($e))return zr($e);if(c$E.hex($e))return Rr($e);if(c$E.hsl($e))return Hr($e)}function O$k($e){var Se=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec($e);if(Se)return Se[1]}function Wr$1($e){if(R$n($e,"translate")||$e==="perspective")return"px";if(R$n($e,"rotate")||R$n($e,"skew"))return"deg"}function J$k($e,Se){return c$E.fnc($e)?$e(Se.target,Se.id,Se.total):$e}function k$n($e,Se){return $e.getAttribute(Se)}function er($e,Se,Be){var De=O$k(Se);if(X$b([Be,"deg","rad","turn"],De))return Se;var Ve=U$g.CSS[Se+Be];if(!c$E.und(Ve))return Ve;var Fe=100,Je=document.createElement($e.tagName),Xe=$e.parentNode&&$e.parentNode!==document?$e.parentNode:document.body;Xe.appendChild(Je),Je.style.position="absolute",Je.style.width=Fe+Be;var Ke=Fe/Je.offsetWidth;Xe.removeChild(Je);var Ye=Ke*parseFloat(Se);return U$g.CSS[Se+Be]=Ye,Ye}function Mr($e,Se,Be){if(Se in $e.style){var De=Se.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Ve=$e.style[Se]||getComputedStyle($e).getPropertyValue(De)||"0";return Be?er($e,Ve,Be):Ve}}function nr($e,Se){if(c$E.dom($e)&&!c$E.inp($e)&&(!c$E.nil(k$n($e,Se))||c$E.svg($e)&&$e[Se]))return"attribute";if(c$E.dom($e)&&X$b(Fr,Se))return"transform";if(c$E.dom($e)&&Se!=="transform"&&Mr($e,Se))return"css";if($e[Se]!=null)return"object"}function Tr$1($e){if(c$E.dom($e)){for(var Se=$e.style.transform||"",Be=/(\w+)\(([^)]*)\)/g,De=new Map,Ve;Ve=Be.exec(Se);)De.set(Ve[1],Ve[2]);return De}}function qr$1($e,Se,Be,De){var Ve=R$n(Se,"scale")?1:0+Wr$1(Se),Fe=Tr$1($e).get(Se)||Ve;return Be&&(Be.transforms.list.set(Se,Fe),Be.transforms.last=Se),De?er($e,Fe,De):Fe}function tr($e,Se,Be,De){switch(nr($e,Se)){case"transform":return qr$1($e,Se,De,Be);case"css":return Mr($e,Se,Be);case"attribute":return k$n($e,Se);default:return $e[Se]||0}}function ar($e,Se){var Be=/^(\*=|\+=|-=)/.exec($e);if(!Be)return $e;var De=O$k($e)||0,Ve=parseFloat(Se),Fe=parseFloat($e.replace(Be[0],""));switch(Be[0][0]){case"+":return Ve+Fe+De;case"-":return Ve-Fe+De;case"*":return Ve*Fe+De}}function wr$1($e,Se){if(c$E.col($e))return Ur($e);if(/\s/g.test($e))return $e;var Be=O$k($e),De=Be?$e.substr(0,$e.length-Be.length):$e;return Se?De+Se:De}function ir($e,Se){return Math.sqrt(Math.pow(Se.x-$e.x,2)+Math.pow(Se.y-$e.y,2))}function Nr($e){return Math.PI*2*k$n($e,"r")}function Zr($e){return k$n($e,"width")*2+k$n($e,"height")*2}function $r$1($e){return ir({x:k$n($e,"x1"),y:k$n($e,"y1")},{x:k$n($e,"x2"),y:k$n($e,"y2")})}function Pr($e){for(var Se=$e.points,Be=0,De,Ve=0;Ve<Se.numberOfItems;Ve++){var Fe=Se.getItem(Ve);Ve>0&&(Be+=ir(De,Fe)),De=Fe}return Be}function Qr($e){var Se=$e.points;return Pr($e)+ir(Se.getItem(Se.numberOfItems-1),Se.getItem(0))}function Ir($e){if($e.getTotalLength)return $e.getTotalLength();switch($e.tagName.toLowerCase()){case"circle":return Nr($e);case"rect":return Zr($e);case"line":return $r$1($e);case"polyline":return Pr($e);case"polygon":return Qr($e)}}function Kr($e){var Se=Ir($e);return $e.setAttribute("stroke-dasharray",Se),Se}function _r($e){for(var Se=$e.parentNode;c$E.svg(Se)&&c$E.svg(Se.parentNode);)Se=Se.parentNode;return Se}function Cr($e,Se){var Be=Se||{},De=Be.el||_r($e),Ve=De.getBoundingClientRect(),Fe=k$n(De,"viewBox"),Je=Ve.width,Xe=Ve.height,Ke=Be.viewBox||(Fe?Fe.split(" "):[0,0,Je,Xe]);return{el:De,viewBox:Ke,x:Ke[0]/1,y:Ke[1]/1,w:Je,h:Xe,vW:Ke[2],vH:Ke[3]}}function Jr$1($e,Se){var Be=c$E.str($e)?xr($e)[0]:$e,De=Se||100;return function(Ve){return{property:Ve,el:Be,svg:Cr(Be),totalLength:Ir(Be)*(De/100)}}}function Yr($e,Se,Be){function De(or){or===void 0&&(or=0);var sr=Se+or>=1?Se+or:0;return $e.el.getPointAtLength(sr)}var Ve=Cr($e.el,$e.svg),Fe=De(),Je=De(-1),Xe=De(1),Ke=Be?1:Ve.w/Ve.vW,Ye=Be?1:Ve.h/Ve.vH;switch($e.property){case"x":return(Fe.x-Ve.x)*Ke;case"y":return(Fe.y-Ve.y)*Ye;case"angle":return Math.atan2(Xe.y-Je.y,Xe.x-Je.x)*180/Math.PI}}function vr($e,Se){var Be=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,De=wr$1(c$E.pth($e)?$e.totalLength:$e,Se)+"";return{original:De,numbers:De.match(Be)?De.match(Be).map(Number):[0],strings:c$E.str($e)||Se?De.split(Be):[]}}function ur($e){var Se=$e?q$o(c$E.arr($e)?$e.map(lr):lr($e)):[];return W$g(Se,function(Be,De,Ve){return Ve.indexOf(Be)===De})}function Dr($e){var Se=ur($e);return Se.map(function(Be,De){return{target:Be,id:De,total:Se.length,transforms:{list:Tr$1(Be)}}})}function Gr($e,Se){var Be=rr$1(Se);if(/^spring/.test(Be.easing)&&(Be.duration=yr(Be.easing)),c$E.arr($e)){var De=$e.length,Ve=De===2&&!c$E.obj($e[0]);Ve?$e={value:$e}:c$E.fnc(Se.duration)||(Be.duration=Se.duration/De)}var Fe=c$E.arr($e)?$e:[$e];return Fe.map(function(Je,Xe){var Ke=c$E.obj(Je)&&!c$E.pth(Je)?Je:{value:Je};return c$E.und(Ke.delay)&&(Ke.delay=Xe?0:Se.delay),c$E.und(Ke.endDelay)&&(Ke.endDelay=Xe===Fe.length-1?Se.endDelay:0),Ke}).map(function(Je){return N$h(Je,Be)})}function Xr($e){for(var Se=W$g(q$o($e.map(function(Fe){return Object.keys(Fe)})),function(Fe){return c$E.key(Fe)}).reduce(function(Fe,Je){return Fe.indexOf(Je)<0&&Fe.push(Je),Fe},[]),Be={},De=function(Fe){var Je=Se[Fe];Be[Je]=$e.map(function(Xe){var Ke={};for(var Ye in Xe)c$E.key(Ye)?Ye==Je&&(Ke.value=Xe[Ye]):Ke[Ye]=Xe[Ye];return Ke})},Ve=0;Ve<Se.length;Ve++)De(Ve);return Be}function re$3($e,Se){var Be=[],De=Se.keyframes;De&&(Se=N$h(Xr(De),Se));for(var Ve in Se)c$E.key(Ve)&&Be.push({name:Ve,tweens:Gr(Se[Ve],$e)});return Be}function ee$6($e,Se){var Be={};for(var De in $e){var Ve=J$k($e[De],Se);c$E.arr(Ve)&&(Ve=Ve.map(function(Fe){return J$k(Fe,Se)}),Ve.length===1&&(Ve=Ve[0])),Be[De]=Ve}return Be.duration=parseFloat(Be.duration),Be.delay=parseFloat(Be.delay),Be}function ne$6($e,Se){var Be;return $e.tweens.map(function(De){var Ve=ee$6(De,Se),Fe=Ve.value,Je=c$E.arr(Fe)?Fe[1]:Fe,Xe=O$k(Je),Ke=tr(Se.target,$e.name,Xe,Se),Ye=Be?Be.to.original:Ke,or=c$E.arr(Fe)?Fe[0]:Ye,sr=O$k(or)||O$k(Ke),cr=Xe||sr;return c$E.und(Je)&&(Je=Ye),Ve.from=vr(or,cr),Ve.to=vr(ar(Je,or),cr),Ve.start=Be?Be.end:0,Ve.end=Ve.start+Ve.delay+Ve.duration+Ve.endDelay,Ve.easing=G$g(Ve.easing,Ve.duration),Ve.isPath=c$E.pth(Fe),Ve.isPathTargetInsideSVG=Ve.isPath&&c$E.svg(Se.target),Ve.isColor=c$E.col(Ve.from.original),Ve.isColor&&(Ve.round=1),Be=Ve,Ve})}var kr={css:function($e,Se,Be){return $e.style[Se]=Be},attribute:function($e,Se,Be){return $e.setAttribute(Se,Be)},object:function($e,Se,Be){return $e[Se]=Be},transform:function($e,Se,Be,De,Ve){if(De.list.set(Se,Be),Se===De.last||Ve){var Fe="";De.list.forEach(function(Je,Xe){Fe+=Xe+"("+Je+") "}),$e.style.transform=Fe}}};function Or($e,Se){var Be=Dr($e);Be.forEach(function(De){for(var Ve in Se){var Fe=J$k(Se[Ve],De),Je=De.target,Xe=O$k(Fe),Ke=tr(Je,Ve,Xe,De),Ye=Xe||O$k(Ke),or=ar(wr$1(Fe,Ye),Ke),sr=nr(Je,Ve);kr[sr](Je,Ve,or,De.transforms,!0)}})}function te$5($e,Se){var Be=nr($e.target,Se.name);if(Be){var De=ne$6(Se,$e),Ve=De[De.length-1];return{type:Be,property:Se.name,animatable:$e,tweens:De,duration:Ve.end,delay:De[0].delay,endDelay:Ve.endDelay}}}function ae$3($e,Se){return W$g(q$o($e.map(function(Be){return Se.map(function(De){return te$5(Be,De)})})),function(Be){return!c$E.und(Be)})}function Er($e,Se){var Be=$e.length,De=function(Fe){return Fe.timelineOffset?Fe.timelineOffset:0},Ve={};return Ve.duration=Be?Math.max.apply(Math,$e.map(function(Fe){return De(Fe)+Fe.duration})):Se.duration,Ve.delay=Be?Math.min.apply(Math,$e.map(function(Fe){return De(Fe)+Fe.delay})):Se.delay,Ve.endDelay=Be?Ve.duration-Math.max.apply(Math,$e.map(function(Fe){return De(Fe)+Fe.duration-Fe.endDelay})):Se.endDelay,Ve}var dr=0;function ie$4($e){var Se=_$j(pr,$e),Be=_$j(Y$f,$e),De=re$3(Be,$e),Ve=Dr($e.targets),Fe=ae$3(Ve,De),Je=Er(Fe,Be),Xe=dr;return dr++,N$h(Se,{id:Xe,children:[],animatables:Ve,animations:Fe,duration:Je.duration,delay:Je.delay,endDelay:Je.endDelay})}var C$o=[],Sr=function(){var $e;function Se(){!$e&&(!gr()||!x$t.suspendWhenDocumentHidden)&&C$o.length>0&&($e=requestAnimationFrame(Be))}function Be(Ve){for(var Fe=C$o.length,Je=0;Je<Fe;){var Xe=C$o[Je];Xe.paused?(C$o.splice(Je,1),Fe--):(Xe.tick(Ve),Je++)}$e=Je>0?requestAnimationFrame(Be):void 0}function De(){x$t.suspendWhenDocumentHidden&&(gr()?$e=cancelAnimationFrame($e):(C$o.forEach(function(Ve){return Ve._onDocumentVisibility()}),Sr()))}return typeof document<"u"&&document.addEventListener("visibilitychange",De),Se}();function gr(){return!!document&&document.hidden}function x$t($e){$e===void 0&&($e={});var Se=0,Be=0,De=0,Ve,Fe=0,Je=null;function Xe(on){var sn=window.Promise&&new Promise(function(ln){return Je=ln});return on.finished=sn,sn}var Ke=ie$4($e);Xe(Ke);function Ye(){var on=Ke.direction;on!=="alternate"&&(Ke.direction=on!=="normal"?"normal":"reverse"),Ke.reversed=!Ke.reversed,Ve.forEach(function(sn){return sn.reversed=Ke.reversed})}function or(on){return Ke.reversed?Ke.duration-on:on}function sr(){Se=0,Be=or(Ke.currentTime)*(1/x$t.speed)}function cr(on,sn){sn&&sn.seek(on-sn.timelineOffset)}function Br(on){if(Ke.reversePlayback)for(var sn=Fe;sn--;)cr(on,Ve[sn]);else for(var ln=0;ln<Fe;ln++)cr(on,Ve[ln])}function tn(on){for(var sn=0,ln=Ke.animations,cn=ln.length;sn<cn;){var hn=ln[sn],mn=hn.animatable,An=hn.tweens,xn=An.length-1,pn=An[xn];xn&&(pn=W$g(An,function(In){return on<In.end})[0]||pn);for(var dn=D$q(on-pn.start-pn.delay,0,pn.duration)/pn.duration,fn=isNaN(dn)?1:pn.easing(dn),yn=pn.to.strings,Sn=pn.round,gn=[],Cn=pn.to.numbers.length,Mn=void 0,Bn=0;Bn<Cn;Bn++){var kn=void 0,Ln=pn.to.numbers[Bn],Pn=pn.from.numbers[Bn]||0;pn.isPath?kn=Yr(pn.value,fn*Ln,pn.isPathTargetInsideSVG):kn=Pn+fn*(Ln-Pn),Sn&&(pn.isColor&&Bn>2||(kn=Math.round(kn*Sn)/Sn)),gn.push(kn)}var Vn=yn.length;if(!Vn)Mn=gn[0];else{Mn=yn[0];for(var Yn=0;Yn<Vn;Yn++){yn[Yn];var ni=yn[Yn+1],Rn=gn[Yn];isNaN(Rn)||(ni?Mn+=Rn+ni:Mn+=Rn+" ")}}kr[hn.type](mn.target,hn.property,Mn,mn.transforms),hn.currentValue=Mn,sn++}}function en(on){Ke[on]&&!Ke.passThrough&&Ke[on](Ke)}function an(){Ke.remaining&&Ke.remaining!==!0&&Ke.remaining--}function rn(on){var sn=Ke.duration,ln=Ke.delay,cn=sn-Ke.endDelay,hn=or(on);Ke.progress=D$q(hn/sn*100,0,100),Ke.reversePlayback=hn<Ke.currentTime,Ve&&Br(hn),!Ke.began&&Ke.currentTime>0&&(Ke.began=!0,en("begin")),!Ke.loopBegan&&Ke.currentTime>0&&(Ke.loopBegan=!0,en("loopBegin")),hn<=ln&&Ke.currentTime!==0&&tn(0),(hn>=cn&&Ke.currentTime!==sn||!sn)&&tn(sn),hn>ln&&hn<cn?(Ke.changeBegan||(Ke.changeBegan=!0,Ke.changeCompleted=!1,en("changeBegin")),en("change"),tn(hn)):Ke.changeBegan&&(Ke.changeCompleted=!0,Ke.changeBegan=!1,en("changeComplete")),Ke.currentTime=D$q(hn,0,sn),Ke.began&&en("update"),on>=sn&&(Be=0,an(),Ke.remaining?(Se=De,en("loopComplete"),Ke.loopBegan=!1,Ke.direction==="alternate"&&Ye()):(Ke.paused=!0,Ke.completed||(Ke.completed=!0,en("loopComplete"),en("complete"),!Ke.passThrough&&"Promise"in window&&(Je(),Xe(Ke)))))}return Ke.reset=function(){var on=Ke.direction;Ke.passThrough=!1,Ke.currentTime=0,Ke.progress=0,Ke.paused=!0,Ke.began=!1,Ke.loopBegan=!1,Ke.changeBegan=!1,Ke.completed=!1,Ke.changeCompleted=!1,Ke.reversePlayback=!1,Ke.reversed=on==="reverse",Ke.remaining=Ke.loop,Ve=Ke.children,Fe=Ve.length;for(var sn=Fe;sn--;)Ke.children[sn].reset();(Ke.reversed&&Ke.loop!==!0||on==="alternate"&&Ke.loop===1)&&Ke.remaining++,tn(Ke.reversed?Ke.duration:0)},Ke._onDocumentVisibility=sr,Ke.set=function(on,sn){return Or(on,sn),Ke},Ke.tick=function(on){De=on,Se||(Se=De),rn((De+(Be-Se))*x$t.speed)},Ke.seek=function(on){rn(or(on))},Ke.pause=function(){Ke.paused=!0,sr()},Ke.play=function(){Ke.paused&&(Ke.completed&&Ke.reset(),Ke.paused=!1,C$o.push(Ke),sr(),Sr())},Ke.reverse=function(){Ye(),Ke.completed=!Ke.reversed,sr()},Ke.restart=function(){Ke.reset(),Ke.play()},Ke.remove=function(on){var sn=ur(on);Lr(sn,Ke)},Ke.reset(),Ke.autoplay&&Ke.play(),Ke}function hr($e,Se){for(var Be=Se.length;Be--;)X$b($e,Se[Be].animatable.target)&&Se.splice(Be,1)}function Lr($e,Se){var Be=Se.animations,De=Se.children;hr($e,Be);for(var Ve=De.length;Ve--;){var Fe=De[Ve],Je=Fe.animations;hr($e,Je),!Je.length&&!Fe.children.length&&De.splice(Ve,1)}!Be.length&&!De.length&&Se.pause()}function ue$4($e){for(var Se=ur($e),Be=C$o.length;Be--;){var De=C$o[Be];Lr(Se,De)}}function oe$2($e,Se){Se===void 0&&(Se={});var Be=Se.direction||"normal",De=Se.easing?G$g(Se.easing):null,Ve=Se.grid,Fe=Se.axis,Je=Se.from||0,Xe=Je==="first",Ke=Je==="center",Ye=Je==="last",or=c$E.arr($e),sr=parseFloat(or?$e[0]:$e),cr=or?parseFloat($e[1]):0,Br=O$k(or?$e[1]:$e)||0,tn=Se.start||0+(or?sr:0),en=[],an=0;return function(rn,on,sn){if(Xe&&(Je=0),Ke&&(Je=(sn-1)/2),Ye&&(Je=sn-1),!en.length){for(var ln=0;ln<sn;ln++){if(!Ve)en.push(Math.abs(Je-ln));else{var cn=Ke?(Ve[0]-1)/2:Je%Ve[0],hn=Ke?(Ve[1]-1)/2:Math.floor(Je/Ve[0]),mn=ln%Ve[0],An=Math.floor(ln/Ve[0]),xn=cn-mn,pn=hn-An,dn=Math.sqrt(xn*xn+pn*pn);Fe==="x"&&(dn=-xn),Fe==="y"&&(dn=-pn),en.push(dn)}an=Math.max.apply(Math,en)}De&&(en=en.map(function(yn){return De(yn/an)*an})),Be==="reverse"&&(en=en.map(function(yn){return Fe?yn<0?yn*-1:-yn:Math.abs(an-yn)}))}var fn=or?(cr-sr)/an:sr;return tn+fn*(Math.round(en[on]*100)/100)+Br}}function fe$5($e){$e===void 0&&($e={});var Se=x$t($e);return Se.duration=0,Se.add=function(Be,De){var Ve=C$o.indexOf(Se),Fe=Se.children;Ve>-1&&C$o.splice(Ve,1);function Je(cr){cr.passThrough=!0}for(var Xe=0;Xe<Fe.length;Xe++)Je(Fe[Xe]);var Ke=N$h(Be,_$j(Y$f,$e));Ke.targets=Ke.targets||$e.targets;var Ye=Se.duration;Ke.autoplay=!1,Ke.direction=Se.direction,Ke.timelineOffset=c$E.und(De)?Ye:ar(De,Ye),Je(Se),Se.seek(Ke.timelineOffset);var or=x$t(Ke);Je(or),Fe.push(or);var sr=Er(Fe,$e);return Se.delay=sr.delay,Se.endDelay=sr.endDelay,Se.duration=sr.duration,Se.seek(0),Se.reset(),Se.autoplay&&Se.play(),Se},Se}x$t.version="3.2.1";x$t.speed=1;x$t.suspendWhenDocumentHidden=!0;x$t.running=C$o;x$t.remove=ue$4;x$t.get=tr;x$t.set=Or;x$t.convertPx=er;x$t.path=Jr$1;x$t.setDashoffset=Kr;x$t.stagger=oe$2;x$t.timeline=fe$5;x$t.easing=G$g;x$t.penner=br;x$t.random=function($e,Se){return Math.floor(Math.random()*(Se-$e+1))+$e};function u$z($e,Se,Be=!0){if(!$e)return console.error("createResizeObserver: element is undefined"),{observe:()=>{},unobserve:()=>{}};const De=()=>{const Fe=t$f($e.clientWidth,{floor:!0}),Je=t$f($e.clientHeight,{floor:!0});Se(Fe,Je)};if(typeof ResizeObserver>"u"||!ResizeObserver)return console.warn("createResizeObserver: ResizeObserver is undefined"),{observe:()=>De(),unobserve:()=>{}};const Ve=new ResizeObserver(De);return Be&&De(),{observe:()=>Ve.observe($e),unobserve:()=>Ve.unobserve($e)}}var l$u=Object.defineProperty,a$z=($e,Se,Be)=>Se in $e?l$u($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,n$t=($e,Se,Be)=>(a$z($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let W$f=class extends I$q{constructor(Se){super(Se),n$t(this,"wrapper"),n$t(this,"domElementWrapper",document.createElement("div")),n$t(this,"requestAnimationFrameId"),n$t(this,"resizeDisoper"),this.domElementWrapper.classList.add("ICSS3DRendererWrapper"),this.domElementWrapper.style.position="absolute",this.domElementWrapper.style.top="0",this.domElementWrapper.style.left="0",this.domElementWrapper.style.width="100%",this.domElementWrapper.style.height="100%",this.domElementWrapper.style.userSelect="none",this.domElementWrapper.style.pointerEvents="none",this.domElement.classList.add("ICSS3DRenderer"),this.domElement.style.position="absolute",this.domElement.style.top="0",this.domElement.style.left="0",this.domElement.style.userSelect="none",this.domElement.style.pointerEvents="none",this.domElementWrapper.appendChild(this.domElement)}setWrapper(Se){if(!Se)throw new Error("CSS3DRenderer: wrapper is required");if((()=>{for(let De=0;De<Se.children.length;De++)if(Se.children.item(De)===this.domElementWrapper)return!0;return!1})())return;const Be=this.wrapper;return Be&&Be.contains(this.domElementWrapper)&&this.domElementWrapper.remove(),this.appendToElement(Se),this.wrapper=Se,this}appendToElement(Se){Se.appendChild(this.domElementWrapper);const Be=(Fe,Je)=>this.setSize(Fe,Je),{observe:De,unobserve:Ve}=u$z(this.domElementWrapper,Be,!0);De(),this.resizeDisoper=Ve,this.wrapper=Se}renderEveryFrame(Se,Be){if(this.wrapper||console.warn("wrapper is not find, creating a html element and call setWrapper(wrapper)",this,Se),this.requestAnimationFrameId)return;const De=()=>{this.requestAnimationFrameId=requestAnimationFrame(De),Se.visible&&this.render(Se,Be)};De()}stopRender(){this.requestAnimationFrameId&&cancelAnimationFrame(this.requestAnimationFrameId)}dispose(){var Se;this.stopRender(),(Se=this.resizeDisoper)==null||Se.call(this),this.domElementWrapper.remove()}};function t$c($e){return arguments.length===0?[]:Array.isArray($e)?$e:[$e]}function o$C($e){const Se=[];return t$c($e).forEach(Be=>{Be.traverse(De=>{(De.isCSS3DObjectPlus||De.isCSS3DObject||De.isCSS3DSprite)&&Se.push(De)})}),Se}var a$y=Object.defineProperty,h$y=($e,Se,Be)=>Se in $e?a$y($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$v=($e,Se,Be)=>(h$y($e,Se+"",Be),Be);let m$z=class extends Scene$1{constructor(){super()}add(...Se){return super.add(...Se),o$C(Se).forEach(Be=>{Be.mode="front"}),this}},u$y=class extends Scene$1{constructor(Se){if(super(),i$v(this,"scene"),!Se)throw new Error("CSS3DBehindScene: scene is required");this.scene=Se}add(...Se){return super.add(...Se),o$C(Se).forEach(Be=>{Be.mode="behind",this.scene.add(Be.getOpacityMesh())}),this}remove(...Se){return o$C(Se).forEach(Be=>{var De;(De=Be.opacityMesh)==null||De.removeFromParent(),Be.opacityMesh=null}),super.remove(...Se),this}};var d$C=Object.defineProperty,n$s=($e,Se,Be)=>Se in $e?d$C($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$u=($e,Se,Be)=>(n$s($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let o$B=class extends Group$1{constructor(Se){super(),i$u(this,"isCSS3DGroup",!0),i$u(this,"mode"),i$u(this,"CSS3DObjectLength",0),this.mode=Se}add(...Se){return o$C(Se).forEach(Be=>{Be.mode=this.mode}),super.add(...Se),this.updateLength(),this}setVisible(Se){this.visible=Se,this.traverse(Be=>{Be.isCSS3DObjectPlus&&Be.updateVisible()})}remove(...Se){return super.remove(...Se),this.updateLength(),this}updateLength(){this.CSS3DObjectLength=o$C(this).length}},c$D=class extends o$B{constructor(){super("front")}},m$y=class extends o$B{constructor(Se){if(super("behind"),i$u(this,"scene"),!Se)throw new Error("CSS3DBehindScene: scene is required");this.scene=Se}add(...Se){return o$C(Se).forEach(Be=>{this.scene.add(Be.getOpacityMesh())}),super.add(...Se),this}};const A$x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAADYCAYAAACJIC3tAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAA2KADAAQAAAABAAAA2AAAAADs6jNqAABAAElEQVR4Aey9C7ClZ1Wu29253yAkJGBCQoAEdBOCbkSgkIMKKgSjIJvLPket2qVyDiLi8VLiPvFSp8ACEUuUAsXN3orgQQoBUVBBvLCFjbg1CiiICSEEwiUESELu6e4znn/OZ/a7Rn//XKuTbO1e7aj65jvGO94xvu///+9bc625Vjo7d/yb/WvegZ3/QpPv/Rea59+maXfgX+oBt2kPi/DO3tsDrb+zh+jO1h8WD/VAL/JAH+KB9j8c9AdyD7eq3aqu39+tHpKt6uh/INq+nsM+vqMP8nC9cVu9X+t0dzR3IPd83aG4oznnX1ev5t9weQfWPex/u0mLO7CVezTS3BnOez/qYS5x3aYf5e4Ml/Pij3p1zWEbb/UBHk43aCv3ZKRJLn3u3YHGeb97bebw123wnjuQuGs3m8t1jerMHXa42cM7XG7IZvdhlE/uzvjc46z3no84cyMcbezOZXxnfOfPHnLiupyabY8H+hC32w1Zd/09Nxcnry9yv/TFOS55/LSsTX5uEye/mT/Kb5VzLamXS9wsn9pt5c89uG11kYOLWXfdPWcs0k7/jmL2WOeTO1DLzbyZb/6OImuz1nX2WH6kzdy29N0g2/LiBhe17nozN/LlRjjimB5+Lmc+ER+zZhFt/TU392a+eTB9ZpvjzK1Dcpg9F9G+1zl+n2IbeUduo2vZ7FLmNm3yI18OvDM+68v6jLs/iuHWWd+4Geuvw8zh95i1y21lHXP6OX5dz0M25wM/ZC9giwufu87k9UcIl/wdiVlq9si4+8SY+kU0/zra+HIi1frgOr/nRvqu6f2JMXWLaN/rHL9PsQ28w+kdrD+u3Lz64DrffCJ9M9ZPfuTLgRh1aT3O3MjvG9ZYpEYf7P4oVpdIH9YmR5wGbx4+/dQdFv7hcMBGGzU5fbD7cgeKbJ6syVg/cZ1PbivGxk7LWD+x+8QHMnIufGq9f/ogBq8/EYfLy+FwwPqzdBPA64PdlxN3LTXGB4p9vlEMh9H7jlhu4pEvB3ZfruOepXbE9zWice364MjQzeVG+kOSOxwPmA/KjQB2X64fqs1i60bIvDnPKE4O/0Ctb1jjESaHnyMPFWvOGB/jXlBjDIfZlzr8jmgOGzvcDpgb3AecMX6OPEwjf8RlffeZU04fxODTepy5db6bW43xCOGSx/cgMX+PzdHbHD73oR8yeDT2IT4sbbsfsLmNmjx+H6PDIwemb62ccUc2GBzWMblJsHxRl9zIZzN3S04/Eb8P5pPj0BD3g1XUxHG9Hqy5dTqffUV6HBa23Q/YuofIw3Zj6Hf00ICb+dSq6X1Yh5z+jl/5lV+57+Me97jzTzvttAedeOKJ5xx55JFn7tq168SdO3cezSjhUTV4RkfUsHe5q0Owe+/evbtLe1vh7cXfsnv37mtuueWWT95www0fu/LKK//pjW984wde9KIXfW5ZY63oYUr0QLFeD5AHhZh1YPogWk2tMbnObSWn5pDGvDGH9IXMLD6vTz8RP4ebOBHfgVY/NfLZa+X/wA/8wKnPe97zHnfmmWc+8rjjjvuqOkT3qj7HLOcuWNncRlwJtugwdxp9b96zZ8/nb7rppn+og/fun/zJn3zXW97yluuLJ8fgoHRfDsyhfsTZY4TVZr/Dhm7bWn8Q2+1C8/r0wfQ9KHD6HiI5446Zx5/ietd48OMf//innXTSSY+sd5evqME7ETksN5Q+aH4SLXWdM9dxs/rso0/NTbfffvsnbrzxxr/9wAc+8MePecxj3recl5yHJ325EapLxHeUu7p2OC19uW2D3uxtc0HtQvL69MHR6IerH6ZRTJ9dz3nOc079qZ/6qWeeeuqpj6tv8x5YHO9OmJsnN9ki86//6j1gJfjYrXXg/vGqq65665Oe9KTXf+hDH7qluNFhGnFco7zXSzy6B3KVXuXxt515Y7fdhS0vKK+vbyhjDxbx6BANue/93u+9x0te8pJnn3zyyRfVOxTf8lHvxhJZhjw+1uMFO//a9T2er1xkur7H1sPnqO8o93zq+uuvf+ery370R3/0k5X3AO0OX87DZOw96Mh8cFr6ctsGuaHb2by+EcId0OF6whOecOLrXve6769D9R/q56izq54ebiA2FuaGMddxodr3Sh6jTi2xfkdyaf8r6umZ96Y+Q9n76Wuvvfb1T3ziE3/lfe97382V9yCNkGuB994kFr26R90n3lbmw9lWFxUX4/Ul4vfhZurvVtOnd5dccskjzz///Ivr27+vqVo0bqA8VM7B9OQxOPxE+M4Zk8MOpnrW433hOuqDyt3v+8M//MMfv+iiiy4lrpGHjLV7uEQ4R7mr6+s+8bay3BTb6sKWF+P1JeLnmDtcu/70T//0wd/wDd/w23xQsezHJuHjcAwfs3fG+MnjyyVarxZMn7wmb+x8Gcsl5nz0yJha+1qTGvKp96CBu9/61rc+6ju+4zsuLz8PmD51/YAVNfVzLmNwW5o3dzteXF6bPtjH7AGrn0E+VIfr9KrhqzQHyz7lrswNuCLCyRy+G7SvIUp27OF3WjXv7YW3VYJxa/n8josPHfbWt6fHVJ7flfHp5FGFR1Z+4irua2RexmizF706QPjd+vrtDR5dnz7+6gknnHBx+R6qxNG89JfHx4i3rR3Ov2je9KHWxr1Hidg0/V0rNx595jaJB8pD7AblF8NfrE/sruaXwvWzzcc+/vGPf/S3fuu3Pvhrv/Zr19CwbK7nIrv/69T7uc997ulPecpTzj3nnHMecI973OPs448//n71re05dShPrpJ83nkY8Ocs16HPt857r7nmmr+eK/o3fnEHfODb8X7ktemDfbj58zBM/m233fam2pyPqRreRTxk6+4Vvdl8DOeps7T3S3WQLqsN+f43vOENf/IjP/Ijl1fezVru5KPHkl8wi9cRnzX6YtZO/stf/vL7X3jhhV9/73vf+6HHHHPM+XXoTqsE10pvRv48VeHQpr8uqS8Of3LUUUf9H6XgcGadB5d++PYGMeNFtIj1tx3OPoxtcqVeXyJ+jn7AOBzYkfUucMRll1327tqI51Xst2tTMl6o91C5Wa+vb5/eX7+8/f2nPvWpf1m/V2IDYmwu5naT6ZsDMTfjItr6K/20kU9f1ojtPffcc49885vf/IQHPOABT6i/MDm/ON7lXBNfUDw45U68h+tP63D978XRT40HDc6DJcI5yt1wffDb1vIhbMeL9PoS8ftg0zHgOSz4E5511llH1Ldvf748ZLcWz8ZTx7dcaHmX+tx11133F695zWte+0M/9EOXLzUF+5kbqmMXmu/8uph1dUsu/a7b8731u72f//mf/+761vLC+vb4PiVAzyHhmrnOI+td/c+OPvpo37k8VJVaHTQOHGsfHS6vSaQufeJtZetu+Ha4UK8vET8HGwdbHaqlTzyN+9znPkdcccUVf7Y8ZGycqR+H6otf/OJbLr744t945Stf+aWlvmAy5yQYbSK5jnN6eHqqJ+6Wc+p3zBp62TP77q1vY+/xMz/zM8+uP/d6Uh22U0q3t/6O8Q/qZ7ofKN9DJHrQ6IHvIO6jqA3XkPOS21bmzd9WFxUXk9eHb6wP8k5l7LsXcR64I84444xdH/nIR36uPjV7dH0Vv+ztb3/7y77zO7/zw0ud9aCWfm4ifVF9xumbB+HpK8Kl5Zzpq0kuffrZk8OBye156EMfelT9HvDI+iX7dUveg5VIHTVy+PYyB4eJ3Z+S2+klb/J2ui6vJa8P31ifQ5S+71pw/bB54FKvD2JoRsaGUuPm6khdcuqTx09TY3+QNRirVScmn3PK94ORBwTfQS2+h0odMWYMYqO55BaKbfaaH9tus0tbezlsNDebvjEPHB/UN2ajeIh6Ho0byl5FrQw9hsZ+clOiXuxJbI+RJnN9PalXl0jemHnSnN8exmj0RbjR9ZKnv4gu56PmsLHD7YDx0HNDuhF44Lkh3ABwHgg5a9S7eeyLTg5NmjV+he+51DsPms67SdFkL3R9Hc5JH/SMrIfP/vpgDmp6bG3ycBo81ueUX2S38evhcsDcWD5sUR5MYwOwofg2ESPum4SYzWyOjQ7n5uk9K7XK6aunxj7WG6NNMw+nr5Z+Hjh8+7tOauA088T2ALMv90EdvIez64jtbb11lVr1WOeT21bmBtpOF+VDFrk2fb+6E7vp8B1qM4YbGRo3Enk3HHxuQnxz6DKG7/FIa52IpvvWieTVgcwzWpu6XmcsUp/a7hsndj/vGb6Wvty2wO36DuYDE/NhwTHYOObxNXkRPvPW5ob14KbWDak++6efvfVH67KmIzXObz2x8+cXknx3o4/6Pp+8GuI+7N95YvqZz7XQz/XgY+ixfp8W7CH+6o09xC9jtXwfEui1iYj0QR807+LJ45svd7V50Y90cmwUe1IH7+Zx062LqemWddkPnXHOr2+fjLu+a3Iucx6SXDe+I/P6ohqR+ckRayM/OXWHLOYDOGQvYrlwrqVfzyhOHT6HAhMz76Gyz0hjTqSXmwROP3l8zBxovdwkuAMvOac9RdsZ51xyaOAzlzH+3CGytufh5dSAWs4Fl/OpOSQxb+oheQG16H4NxiLXpQ/y8DwoHiA1qcM3VtfrrQPpq77zxFrfTPCdy176I6TWOe1hTA4zJs919D5oMOv1s04O9KCI5ozp03uZU5vIPFmTtanDP+TsUP+Qw02QiG/MA8kYPw+LuhEmh++Dd5Mad2RODD43lhyY1uudV03m8XMtaOTU97y8WtF5sn/X5vrRqbUHiMZexOn3tZlXA9oTP3m0mSM+5OxQPmA+HB+M6EMg5jBgmcPnwZkzD3bzMMFTp/ngRwgnTw0bUC5jeqnDx1xb8vqg+dTK9Xxq8LOPcXLr6sllPutG86eWuTS0mj6obw5M3vkyf0j4ows7FBae6x75W+W41n7QspYcsRsGPXFq4DR5N0SPU6cGzv7o812DHJx5a+Qyrw9uZnP11PW5Rhwa10K+r7nn1Yr2BLGul5uSy3znzB3UeKi+g7FBsMT053LJp09t1vPAjdOnBnNDoMHX9HuNsYherbXON0I5tCMfLvne27rR/CMOPdb7qAUz5/yZdz2po6c8vpacvqjmkMRD8SJYc193vgvxIDI/8pNLPTwbwncucpi8daN4odz3qhYmN1ny+9T75pDrc9jDeuI5jT06WgNvP3z7yOcccFjqjZPTF6eiqNsKj4aR81sn9r7GByUeau9g3niRm9r9jDMPb04kn4dTTebRaGrVwePnw7c2OXXmjBP1s7ecuK6e+axNHbWafK4Njth6taBc6tNHY8/057g5nlrnwsdG81jfc4uKg/DVBR+ES1stqa/RuCMFcunLgfkQk0ePpca8/CSIl8xLdy5j/JzfmkQ1cFmrxvqO5JNT33FOA48xp58Kyk2J5Ytc7yOPLP0em0v0muGcnzottes4cwcV+hX5oFpUWww32JvspkvsOcvVGKOT64hGbt09UZOYfvaRh9PkOpJPTt86Ub7jqF6NtV2TcfrWdbwjmrzn6WfvfH5dY465R2afUe6g4A72Bbo+sN/85PDVjnSp9carJ9YXu2aOd66e7/UZWyMn2mMury7z6fc8OY3extaA+urAfAfLOnL26H7GqRnxmU9fbXIjH47B2vqnl/Q4qMyHelAtarmY0drgHN7k1OmLtOp+xpmXF8lpyaVP3hh0TdaJajJObfpo1MN3c57OZ6zGeuPUOKcac503L48O39i8PKipI1bnWozF1KyrV0dd72XdQYMH81/TewO5WdxIRpqcN9m4a4hHteqsV9fnlQfdDNmv16PTRjo4eWszpnazefg2Vs1Ib27UV446/a4nh5nX7zrzyeuD5q33HQc+89bIo0+OGBtxi8xB+po34GBZojfZtYH6rlHOh2ReRDfy7wiXvaxnXje5XOrw01IjD5frz82jP9LCWafOXuTSH2nhtN4n+fTpmd86Zk4fdD1i51ybeTF16ZNnWJc5fXuI8AeNsfCD0VwX6M3VN5frTk4d+fTVqxV9gMai9aM6a8yNtGrop9/18Jhzpk7f+pEOjTry3bcGvlty1q3j5jS9xnnmePLmQP3k53y1ifq9hnhkeT9H+buUO9i+RcyLd9NxwfjG3lDj/NRPzhoQoyZ1E7l8Sd56EQm+cy5LVuuBn9P6Dpc19uk1zpE16dOj18jJe43OMao3Zy2x9QfCodWcx/l9pyNv/0T8tFE9ee9Jake+63eOkaZz1nS+x32tPb9pvNWJNm20FNyV/ehlP9AbmJzrSu2Im6u3JzXZV37EZX/r1I9iOevEXJNcx9TkHPqJvdZ4nYYclhrm7D8rqQGx1BtPieWL9ea8jrm6XIc19hvlNutj7V2NrmXLfbnwO2p3pnYrc/KVTXOuRG8ynDx6fXHEjXKpm/Opc1402FyvnjO2XkweX8u+ciN0TfRLk08O33n7O03qslf61idal7qRLweytjyE9lOTPTtnnbzXSSxnPUh+nY1q1unJbblms8n7RAeq7/WbxfYHuQjQkbF9Ug+n1nxyW6lX3+uN+3ydX1fv/L2m8+ZF55zTwc9Z1nSdueQ713PO03nWCJf1qaHOvD6IpU4/tQvVvgOZc2U9NXmvrLsj6DrW1W5Fs1rQukbmXLzxHG5V1+tdsPVg+t7A5Owx4vIdEF32M15Xb8/UwrmOXpu67qe216uVB+Wcb0mthVE9BfazuMcjPnt1fcYH4qsVc21wDK93TmNNauEwa8R8fgvF+lfrumqOR7cuN/XZ6iI2092R/Ghx9gHJZ6zPwkc+3By/roYctq52Li/vWumhTw6b48jNaa0Dt2L0wZxrEe17dZ6uM96n3Lhpeh1x56jNPvpi5jtHzJr9tm+dNnNzfl6/c8GtM3WpuTNc9tmwqTYkIli3wFFuxEW7WZc6bzii3sd8vjPBdZ2fSsnPYc6hRo51jObJ9akFsexhnHryGaPRrDUPeh2pgV9nWe986olHP3dZg87+cuqTt5/cKO51ag70IDlHx7w2csbpyzE3/pzZ23zG6ZPv8Rxnr7UTKxotrnObxfbaCtpLpIYLMwb1yWH9MMCpEeGwrM9c+uiyJ7E24nstWg/IKJcc16bWOcDUJD/n94dPfXLpk8tDoDY1zJNx+pmD7/UjbXIjX050DmOxz4UODkPDyFif/MjsS+5A/V6zX//NJh/lk5vzmShz+00cBDovrNfkzeo549zwcqLTEDvgsm9u7uyVtfi93rqcK/1RvVyiNbkmOO9J18qrEVOnr9ZY7HyP0cGt43Peruu1mc8cvn3UyI3e7VgXpsYauXwm5NSRX2f2EdHqd8ycPdUYr5CLW2c9n/HIH3H2N9cXAz/irAOzVr9j6nrOeJ0mc+lTy2CN6/pQk6ZWNDeKvX5yfR7rtoq9V9bZWw05/VEu8+mnNutTo+81dZ35RPw8WJmzHg7zPuZanGuhWLzKqTeX/bpvPIf0MNd9+0/YJ92QrCDzI19uDulnrvdmgeb059Ba9KnJdxx7daS2cz3O/plzLnuQ61zW9lzG9kjOueyR6FwjzpyYmu4zX1rG1ieHNuP0Mwff69X2nDH1owPU6/z2Va1550t0TbkX4LScWy7R3onpoyUecfYxZ7xCFjpnmRv5cmD69OvxaA403MD+tj7SwnER9k0NnPxmSF1q6OmDkUeDETNyXjWiOtEbbV4kjxFnv5x/ErS8nHXGI1Rj/8TUw2v61sLLdY28OKc1D476Zn6kMd/nz/nom5axPcknn3p950rsfo+pTa73Mp7wQP8W0QWDW/GZRN00YbywSP5NENBNTlp9vwh50Jxc1sGpQTfSoMfycC+Yxas9ktNf1w/Nulrz9srrlst6rzNz+nltqct6tXBq0vf61YHkNd9BiK0zv25+653TOPvoZy45ah3Omfnkku/3tK8breb6ch59NSCc8+mDm5pFXZi8fmL3iUecfc0Zd/Si1PUY/eiC1JPHZ6CTlzOu1GTGIqS+uBlHvm9QY3uAuZ7smb7XZh25NPvIGYvyoL3we961pKbXkOv5kQYO63prE12HnHXiHG8e1LzHxPS1t746Y3rjj8x5wa0MeqTOGMTst4jqdW7i5PVBBw3051BNIj7GQqhzQembB/MrKDFmDT512Dp0LnT51S1rnB+UR4/JZR95MevhsOwzl7en+V5HrEac4+A1tJp1W+GypvvZp/sjLVyfU07ePiNeDsRSy/3K+zv3XKfCpTbr5eEYmL7I3tMfYdbgY+g22Fa/RewXZLwVZMK8GfgsRHTxxurhvXFqzIHdnEM0bw9jUI3oelKjDo159eZSP8p1LuPegxzzYOmzfuc3l4jfzXow/a7LWB1c97su45FvPYh5Xfhy+FjmFszG+ZPD78/TfmLm4fr9y/n0QYdf1K0zZu40a5lDP/OTn4vZL1mEizZH3Ac9DmRQj17k5zAGsWgO1PAzTh6fiyTvxabWHDpNLahWDo2cfsZwWvL4OdSAqcvYewGHr9mnx/1a1InqsxfcaH5rzBmrN845vb85T9bLy83F8nn9oxo5dHlN8A57uH+IefOQ33XOOecccdttt/3m3r17L9+zZ8973vjGN56zzKNx0C99+yeWZNbQbbD9iMoml41HvhdALv0N2je/+c1nf/M3f/P3XHPNNf/zvve97x+X1oc0Qrjk06/UZPlVhbmwnJOazqsBscyP4q1y9OnzUYs5xyLaGPe61HjNqZnjUkMPdfZzbdwz1yOnVsz6Oc2cNufbisa50I7msoc59Kzfa9AfoVr25I6zzjpr1xVXXPH2nTt3PrTC62ucUAftn3bt2vVN5Ts/yD3aCmaNfpVORryyaQGraGvO6II8XOCG8fa3v/0BT37yk997wgkn/NDZZ5/9m7fccst/KQ1fadTh51ce+xe94YYSY1yAmkRzeYHkRyZvPZqsI1aDryWX+uRTKw86zOd1yCVmLXzW41tvDuzWa7Kn609N1qvdCjfSUjfinVd0fmPnk7eHMbrOmQM37Kv73Oc+R8Th+kzlL6vx+TpsX/l7v/d7Dwy9daK9srd+lW3NKOgml8ikNu++ccdJX2/LrzvyyCO/ser/ucY9a5xy++23v+2oo476/vIxblgOOL6S+C7ljferC3k5fCzX6jrh0bEuLXNwWTeK5dDRa7N69aBmjWt2TvLppx6/653fnLXyifZK5P5ljTnrzBNj4iLa9zzoQc58R/WpgUudfud7rTrn5Fnm88w9R23GO88444xdV1555R/UO9UFlft0jc8iKju6xlfdeuutf3jMMcc8q3zX6h4D+0Ajl/qiV/X64GS5WLlELsyHAq8PejH6xDmOePzjH398Ha5HF39tjS/XuKLGNcU96eabb+adDL3vZvRhYNmTOG+0utTKqVVPf8w8aK7XT8J4sUZKfY+T775xn5Me5tLvnOtXY16UT8THUmOcnH7HqXhZby7r+7WgyYEWjRxxt3W57N+vnz7k7U9ML6zjro985CM/G4eLA2btzeVff/TRR3/Tgx70IA4b8zhcWyK5jPtclR5bXgAKC7u6NzfuizKe8PWvfz1fHY6p8fllQy7wihrX1FeOC7/85S+/tHx7+a2iPeAxcMRNyeULfTF7WbtgFzdWX4160AdmDsyeau0rwqfJi+TwGVwDZqwmsefUd6RX1pHHer2xuUlUL30t5tXbW76jefWjezXi6INZn769zFHP6Gsl748UWYPvfZny9WMJX9xvqcHhwuyJf3WNY9/97nf/p0Lq1o0+T8k3XAOxhnZlLn5FLJ0U6Sfi5xgu7pRTTnla6W6twTuYFwd+vMaX6gb8h2c84xknlU999q9wGFOrTk2uw7yIBlOjP5HxknnoXh/SLc2PPte5rl4t+pw360f3xzpRfce5PLxGDWNufnWg/Tt3R+p7L+bXek4eVIfG4T3icGE768eTywt5h+ITRWpyfKni20477bRnFI72r33nsMo23At0+xmN58zG5C2W67jfAn/4h3/4lPpB8pyq/WKNvDB87KYau/7mb/6GA5j19Cbuc1AH1y1584n6zks9XI7eM3P61onyzm9sXpzjzXfs/ajX7JVIbl1sruuSz/6j+dFiidarz/wkXurVyY1Qzag/evPWGs/pp/30rne961eXBacUsk4HNP4Xao+e+4IXvOCM8kd7cLQP5+am537mAk0YZxMnyQXo89VCHzTeefXVVz/nnve8548V9+Ea/PyF0ZcLwy6oj0o/V98jP7b8/OFRH/SG6FOXPnnmxdL3OuD1vSY4LHljuUmw1MiJqc055UVy+qI9yOmLncv6zNHLONE5rBPh05LXF9Hhsybus9bz8mjQku+a5PDzOtUmpl/yVT/7+5ztQ4zvH0u4/+CmbxHJ1++83l2HiAP2QeIazlPujuNrPPjaa6991cknn/zi8rkex+4t+PRCDzrK3TeHi4Z04fiaHNiHFwiPvyGubw+fWNxtNTxc5a4e2gnlH/OFL3zhrYXW2QOdPfExYixvjuuRU7NQ7r/eOd4+5kG5RPM5T/rmQdZEzmtTl2uFky93NSc+Zh60T+etV0tekxOTxx/Vyrl+4+whlz2yd16j6wYxc4to/zWMeo9qXA99R2ulP7ld9bvX3y88tsaJNTgMmD1vKP/Wk0466RsLJ/0S6U/sPGJRGzhjMA39ZDTpZrIjOidKdCGrBZ5//vnH1DvTA0vP97lcjF8Vyp38Uwt3P+c5z/mvhdkLrWuSL2p1Q+Aw0BtL7A3DV4OP9VzGmbeuY+p7zpg++qADPi2vjb7WoNFPTdamRq2YOjiHvNegHtzq/NakXk5kHn0RznnxMXPigt2nyznMiaMcfdaO5z//+ewx3o3usWzkIRO/WHv1fhdccAGHkHtPv47r5qAteUxcRI0w2ZsxWQ6/DUzUR3fE5Zdf/rT605SfK/+jNfgZLI0b9bB6677siCOO+I7yuVA4bsI69IaIJV9tklw7/Fw8l/Oayfsgk7MfeSxzc/EkDK19RXqkr76jc6sV0eF3G3Fo5MXk7GFOTI2cSC6fhdrM64Ppp9b7kJy+6D1gf2HEfU92btqLaOvDjrfUr4buX/7f1mAd9sPn4D3o0ksv/c/nnXfeG8vnmvz2EHR0ntjh9YmVWlyvC4YYGQtZN6jP/BSfeeaZFxXPwvIDDhZTP3bt5VPDoz772c/+UWHWu5bkSrK6GfhY3pwFs//D67xxrhUue3lzusZa9a4PvdzSXcX2lVdLnPVeszpwbn57imqtlZ+rV+f81ltnfh1vDuSanItY65y6zI98OXG0rryPc32p4xq9tzuXe+2o4vjRBKPWXnzCvaf+hO/CQte+Dku2nw5uaC5ilOwXuG5Scj64nfVXGg+teFp4YV7M3vqB825wL33pS99ciLkGb1jq+5yLivkLHK05a/C9sfjZn9i14KeO2N7yWWtOHGm8P/ZSK8qDmjVo1HVfDTVqrFcLdp05tWDWcw1qRLXGqc/6fv2Z07eHPZPHH81vjWhNzmct3HTNv/RLv8TP+sR3XyK+NbwRXLvcs94j0XlGWGUrIz80Gq2zbIzORslvWEz9fReHi09nvlDDC0k8ud7Frq4Dxi+f6UPOfuVumMObAI85v7x95VOTHPxoHvs4v5pRn9RmXh4Os5doXlyo9l2LOhDr8YJdvKpRZy5r0jcvWu9aQLgNz3Aphle3pPa7//DOl5o+T+bw7SuqVwc6P5o+el4tvLbifuEXfuFz7LlKnFwje03fVRX3xRonvfWtb+VPqqgbjaJXfPpojRMn0gOWIptPgngZadSKux796Ec/dlnDXy1zMZgXxXwn3nTTTXwv7NzkMfunnxw8fZwrdfhazglnD3GOs77nna9j6rOm833zug77qZc3tqe6OUx91uiP7nP28n6h13ct6uwlJm8NOW1Unznr1dlDhE/fWtDa5NDaK/P6O2vPXVIaPknk8wJ7gwwO2I7HPOYxTyhY1Qx8ZObxu5HTJr/ffJOgYhtuCe92t7s9rGpvr3FjDS/AC7o7fetvxN5RqLkBiZ3TnEi9OXsaz63La0td9sPPvsRqu5+x1+K8o/Wbo07L3nJganPN6jtmLb7zZx9467xGY3KYcc6pn/lJHC9ev5TziuSdUw3ofMnJm8v587rQGeP7zoOPUe+cfX3k9/7DP/zDO5e66UeUpV4tf5t424knnvjQpcZrGWFJpvl6Dn4/ywvaL1kETbDEbLzIxoT1vey5RfZ3L3TcFD6xue2iiy7688I0LxSO/sRyoFy5q7WYh0vfOOt6/dproEHZqCc8tSOT73OhzRx+DnupyWcil5i18n2O7KleTY/VipvN70bPPnmvzDvfCJ0rkX4+M3h7ymWcdWp7vZqpvv6TqT8rgt/Lsgex7Mfe/HJ90nhOode1Dku2eqb4s5Y3M0U01/RFeXDDIi688EI+peG35h4wLsJR7o671cfzn7jqqqv4wdILhLd3auFTQ4xxM7BRbsQt1Pte1YhmiJPz2sjru05QrTl0mpx6eTF5tebEEW+diFYd65GXM7anCD+3fvvM1VonOpe94c3Jdcz5zVkzqu+c9dbQw3e11K7y7Dn2Xul8B0s99dfVOHm5h4m9LjBNHi5z6a/0cwfMYosS8YfjxS9+8WMrR08W64WK1BxX3wv/c2HWmwc1eqDBRH1z9pAX5a0zJo8Zi50zBnNNxJh9XUdq7KmGXOfMZa/U4NNbyxyc9fJyxuKo3lpyuf6sSU3vbZyY1y+fPbK3eVGdGtG1dZ33E16N81sroknbu9x7xxWJBqPWwZvCrhe+8IVfX2i+3Mnsmby+ObUbMB+kCQuNRRvN4Y76XcKjlmIPGKEXwLvbzk9/+tN/t+TIjQy9X12Yi1izF9hzqdFHg6nPWH4SDF7Qju5Procye2aLPp+51KZvPpG8mo7oOmdsD+LOmUtU45pHOTm1xPpgjtTC0zfvmb459YmpgTfWJ3bApbF3GGlTfe29vy+SedmL1ovs2R33v//9H1mQ1zPnI++GdoPlBrLRBkEFc/x+uvrPT76qSP5Knr+QZ+FeKL9g5hOcHfVR6P8AZ6zPtapvenT073pkcBqakamxfqSDcw569Br7jnjvq/3n6ns+e4362yf7qzOXPeVEc84jnzjn9xrvDXy/f2rV9J7EGLrN6ifhUoefPc2xT+Bdhz2N0e38gz/4g/fh1F48qcbk8lJGwJ695fjjj38wxBbMtYNp8hNnUlLkAebgo83Nxq76Hvcv6hfJ1H2gBr0WV7GX3y/vfFDF9yjkKwQ8P4dxY8T0/Rmt49SvajB81wtqzG8OrmtSa07dgaK9ep+5+ZMfzZUcvuY8Wd99tHLcS2qI05I3J6LTT9Qnv9V6dWCaMT2zr/4I5eyT95o9Seze1Af9V6XIrfZyHSy+wPOx/EdqpFFzfuWPqL9N5NtE9t5WBteUg/WuBhNvZky8FeMQ8TE872BOkHUn1gH8dBJrfOecQ0rJmbcVMXObE8nDa/IgJi6i/evN9zr1oP03mz97jHx6JZ/PCB4zv4j2xT2vLvms73n7ieSZf109WvP4Xr+8Oe9P8uZE60HNHPW9B5rMEzu/enHKLfcg303ZK/HG2sP8Kd9Wzbln9fnwRiIbgProjFf4rGc965Ti+a9HOWCYp5q3L74SnFD/otTHSZSRS9twE5YJOHTegJxfruOopxrXikYuEb/PAeegDrNGrUjOOZKDx+DyfqsBs6c8NWnwDvTqRLTmQXvC66s1FtFg5kXyjsxbBzqX3Kh2lKOfPKi/WX1q9cVeyxza1H+5B/ln29C6D8nh8/uwIy+++OLTC8n3UdRk8gT4s5ZfnRStK8jG6if8ru/6Ln7+wvwF8yKqG1d2TAW7brzxxk8uSfp4U6D6nNPNCN5YpCat15vr6x3Vq+k9ks/71HU5l77zqBXl1YnmE/Ed/WDKp55exvqpM9c5eWq6mRNdf/agpsed6/V9HmN0ozmsVyeqTdS3hlhuxw033PCpirmf/PEvlnkO2I4nPOEJ/DgzMnrady6f/PTzUhL62WizhlP+fve73wOWxSzSRYscsB31H79ducwRpqkDsUR9vsIwlzE61yYHyonoNLlEa7vGGFSTdfDG+BqcwzpRfUdq4dBlTl/egyYPpl/hZMk7Nwl4Y3sa9z49th7ErEs/uUnUXkbrVzKaz96jvnB5PWoT8TfYF7/4xSuWxDH1hR+XFwdvDnwafj+wjP6MOTM3q/OC5xrI26DjKn/3u9/9/svAd7Bp0cuL4D9m21H/ndjHC+gxXdkS9eExYzHnlENnn8zLkceIMXERLV7ntH2OuXp4tfRyDjnr4LnPatQlZp46zZp8TnLWox1xc7xaerJWY5E6DQ6by3mt5lNvnUhOvZyx9fBY9sHP658Ey5es10/Ez3jHxz72sSuWtcfUjy7+CKJm+vGm/tzvnNK4BuT4jozxu2XdfgvfkKzKHvdmq/jYY489swL+FIWh8fPXnhr8bLbjLW95y2UmGnojvNBMm4NjPW5GeOJeA+e6e65SG3Lq4LVe7/yiOnCzejTWiXCa9eQ05weTz/zIT84ecok5Z/q5vhHvWjKnT/+sdz45Ed4aOH341BBjcJiInzX6+bMUnDz6DVb/jPvHIGpP9ncwerB3b69/UpC9PGe9d4831OVi8N28IMOPP9OX24C7d+9+U328ycLeW0PbyTtYXcyDCs+s/MMrwYU4+PADnz8OlhPJcWOJvfmiF5XrL9l0Y80Rs24suaxJX53azK3zpwmWc1i7Wa+sST/r7ZGoFuReoAcxUb/H8iBmHnR0vsfWjHhz9gL7+rqGPhjPWLM+Y3x5nql92YP4DPcjPhrG8KP6+iTxryvHz2Ifrb1p3wqnPo+q/FX1X9s/pWL24LrBus27b+nnnl1twOKm5uDIWHQ3L2zK8RWhBEyWxrsXk5HjH79hcsyLEuf6q19U7XuF7zWjuNerGfHkcuybbeFZA6ZP1r4L5f4x/FwNtX4hQOca5LL3yFcv0gPL2DpxtBZzHRfdFq/mNqtH5/qpRD+qMWdfYnxja1JnLzTmR3rz6tWCX2a/1mC/Jo9/e/HTjzTl08NR7gZzzg3kMljl8iZ04UrUiuYm5NtA3olYJIODxUeIvIvxlYR/YXXO0Pf50I7m6hy13dAkn771IEbOfPpTsl7UzcVZYx+14FbrU4dPL/7r8J3vfe97v/P6669/TX2X8Jc13oMPR44Jyibtwp1e5QnSD8nKzfVDeg1irydOrtfbOOutAdftud7LeeDx7ekcoFzWzmmtu4U9yd4sYvVus/Q5dNOPNIqXiJYxsjl+eLGz4uo8l4P3HSwXPF10fUXYVRfDn6Jg3pBFtHilHl70ZiWq7/WuqdfLgw56jOpT6zxy1hjfkXp6WG9/kQ1nTiS383u+53vuWf++5K8+6lGP+qn6b5UeUt9iH8/AhyNXvx45bVk/Whd9tA29izSend/CQu8tFH7ORR97gebkitqvHk5LXfrk7aVWLvm5ObNX6vmifyt7cvkO1nvyJsEBy3o0Gvy6XOpWB6wX9NiiWazF8nsFv0XkglajLojvj30HG/X2BoCZ1wfVyBW1wdRkXg7hunpz6KyRA+XMgxg8A+u4YBevo5y1zrNBU+9OO375l3/5hfXp7Ndlo/TJvfzlL38B2jL72Sel+H0eOLTw5uRAzF7qFuz+r9aD1nTOeP/qBWNdzrWO631Sm1/k0Zmbajhg7MkazsXaHLuXe3nSHsDLhjmsW/d2jWZYZHFDnnJ+izgtuBbLz2H8neK6dzBaeYGt7X4hOkxcRPvH8oneULis9zq3sgY06rN39pNX13O5jq6ZtH/xF3/xnesOlxOgQbuM181jiRqR+fsa1CaqgcO3Xk2PU69GHOWsF9WCcNTkvF1nPP1oQtHAJk0drFvYk+zNwSHjTYIfabZqo2tZ1W52wFbCLTgsigOGcSHTqAsg5quFB4w4DYE3T95FT8WSSzQn3TWjXtY4F7Vdl9xIb77fsz4/Os1c9jMnqjGe1vWQhzzkyRKb4VKb15PzJU8rc7bN+c2J5oi7D6cu/d5XjXzG+lmffp+TOGvoqSb7q+m5SbPci9M7WB2y/l3X7spP3xLY8M5g3yx3phcHjMWu3p5robX+6VNELmb6M5TBBNwMbkTeDH1vVJapHeXQ9byxPeytVl5UT3/XRs75Mp+9sl4/a3oPYuuda6Wv/2ziATbZDJdaeym3p+uVV0de35wov1qPiWVN53OOdbW0GWnlxXU9zKEdWfZ3nRt0y714xPJwqRf5FJEfae4SuysPWF/Q9BE9h6xGz41iboY3RFTXG2R+5MNZYz5Rf13/Xq8WtD+YvXpsj6y1XrRXarJn8pv5WcfcDDkxe8Ax+jrVJi9HffrEGJyD2Fq1Irn01WZtz2dN6pLH10b15hJd4+pNIZN3hX9XHjC+PaQfi/b7YA4Z72r84Dj9PWL568wL7uhNlaeHvogGPzF1+Bo66+B8IL2+67Ime9ljlFcHjvLJ6e+tP4y+LAvX+Uut1z03jy3yWtWOOPUd0c5tSNdPTe8Jl/nU4GPkqVMnkkuDNyc637r6Sbvci7fzxT/60J/r4t3LH3Xg7pTdlQeMPzNhcV7whFxEGW+76w6YN6dfTPL2TU59ctykjPWtpwbOQazBobMmNVmvfoQjnf1G+s5N9R/84Aff0hNz8VJL3Whuy9bl1Kxbp/1B74t6kT59HnOdd05QDf5m/bueOG1Ub36aZ7kX+cKPNgc69jB7+S6xzQ4Yk2/V8oC5aL/S7a7f3/jLu7yZ9lbvetQ4vwivVk1y9JNXl7WZQ2tOhNO2Wt979ph+9u85+M5N8WMf+9g31f+36v0uZg7RoF3m7SVmGRwj15Lzd23GWQNvnKjv3MQ5qMscsTXq4LTk1GW9vjjS2EuctB6wQvcntfoHesCc1zk2oBu6i3q8oWgU1DsVB4wPOqh1IK3UXr5aeMDgunHheaOcX06kLrWjPjm3enX2NRazvxzY5xrV9/nUZE99c9k7OfipX/0fQXb84A/+4MXrDhk5NGitC4TTcn59cvjD+S1cojVd22Qb+lGTY6TtnLHzOK8or24OnXeYr4N1NHuyBnlesi8HbO4Tb/Rzlj1WGg/YiihnKFzy63L8Ipl+aNT51/R8i+gBM1eylcFxU0QSxvjJW99RPZiGzqHGvNrei3hdjvrU2G/UB86vjtaBcFqvm/jXvva1V9f/Q/j//Ku/+qv/t/6H8R+s3yXeyMCHq9z/habE1lPnuvHhR/PLo8GsB7PenHlzHdHBbVaPTvP6qbG/OVFezDnkQNfT64w3IHuxhj9nUe9gTf5Kyf4bapfazhlnzeSv+4Vaim0Awu+Xq68G/PkJ/+acOZBPELl4PuQgh/WbIbehrsipviFazZvdv0hYh865ROewh1ryaqzLnPpE9F1jj8zZL2vlej283IS8Oz3ykY/k5zF/Jss8esz58N24yWc+eXpljC8n9jyxpib7y4nkMGIHMbxrTY05tPYV7akm0X2QGvIj4x2Mf3+D76ww58fngPlXR8Rarr3P0WNrVn8qBTErmsk5oXX8nqsf2OlTxLoQ/iNM/qERLwTMkb3UlGS/NVljjtj54bCuWbD7Xu1vXc4tZx8wuTlejZg6/DTXrBZ0pA5fPjH5kd+vP2vxe43xIrPxGcl1tE+/lyMdh8g1kM8affjUEGPOk7l+kMypzevXF+mJfyJ7cvnFnzrXCLKH/Z1t712plTnfighnlXOxkdvPXYn3ywRRX2n5VoX/bRF6FsqY/pq+gAN29Pd93/fxD+Nwgd28Abke+nTtaC1qMoc/V5861tHrrZ3WjyDMXFCTm7w+9fhp5pzTnPxmsf1GmFzO7Vyiuj6XPMiYu/5eR2xNzzFnDvOJ5J27r9G498hYDT3ls3/6O9mDdbj4Sw3/y3vyeb3H1V7+Qhat8V33rCQ39EjUG/R4VVOL+mQFLHx6F+OrQw3yBXu5mB1PecpT7g8OrN8kJH1tOTd+1qAfxVmTmuTTTw395nLyICPn1hfVpA4fE1ObvLXrOHukFj2WnDr5ROeH0+CsF8nZxxpiffKa9cQHUk+d/ZzLHqKH37x7xRidPfBX9vSnP33ag8s9yd70TQANe/fo2sufWBVs7uScqDfELsw2G5KSyyJzoEPJ3vrHRD6+DKZ3sfoq4VdRtPzf3HfU/wP3HLDMi8+bCe8c8OmT6+Yacp6s0acufed0Dfbtcdakbz11vQZOrZgaOXQYMSM3DDE1qU2/UpPJgXP+UroWej3inD/Xb26uoevoNVk3ytnPtYjJ61OfPdR2Hn1yU839ypaN2JNTbexV9u6O5V4mpzlHR/Oz2A+YQhsR50TmxZWu/kGby5ek3ybyTwXw18popgN2yimn3MfCht6IXI+cUnN9PanDd034mjVgP5DqyFlPnTy+lvVw9jXfkbzD3jl/6tGpsW9HarPeGvuM1kyOGgy9PSeiXqyRV5Nr6Tlr4a2HS18NaL2+c3TeOdFlr5wna9CxL9Qm6qNZ2amnnuoevIG9iVXScQLC+h+if2xZIL8M9wPXMqtjcYqs7rE8ONvoTW960z8thSwSXX2iPD1XroEfGncfd9xxZyw1ADfAm5Bz5g1Tjk6NNeZAc/hq5UA586BGPrXwcxy5zea3Hkxzk6+rz3WkTx/rsye+axWT09/s+tG5LpF++h3XzeWcaPSpN16wG1+dS7ROHNXDuS50+qLzqZvi5T/OxJ9J8UkhnIMe0zvY6173OvcyXFpqk9ef5jAo3Ou7QnAbXAt6Y+MVvuxlL+MHQ35B5zvYhtq6oOuPPvroc5bdvQnLcHVziO2J33X5BcH+qcta+JFZJ6ZmxGUeX41onjhH8vqgdanlOjNWo34Uq0eDGYu950I1/w5onah+hPbOHHXYna1fdNn/2Sef+0Lf+VOnD057vf7jVN7B+Pdh+IJlDUjMv/h7y6tf/Wr+7XqvI7HoyeQI8GdtswNG4doG0RkdC5v+LyrU1Z9H+XsGZF+o/4PgmThh3pygJheeQc/UELNm85krej++16sRrZ9D6jV8Y5Fc+sSuLfXwadagndPB57vWnC43Sp+DGq/NemO1WW9OpEaznrjz6snhG6eOnAafuvRTg28v+URy2cs+I5x09a9FnVU1q08JY4+SZ+96uMrd1KhZa3MHjEKHDYzncMftt9/+6RKfXGPaGPUtIhc6PcD6eeya8o//xV/8xbML6UEO6zdjwS5euwbW+fHdHHKgHHnqzRFjxqlNTh9tr3c95DC0mDWJ8FmfOetYa1pq4LOeOPP68Jg9xQW7sUadtaDXlJz3sM+f9ebkQMw++GrkRHKY8ySfPppRDO+6Rbh1trP23lm1D/kOi71IX++/c9yt3sE+s2wiN4dL2Wp96PazPGA26qI5fj9d/QnPh4rkZzD+2ausq3Xvnb5qfNu3fdsjKpfzVrgybtbohvXFo4Eb6bO+1zmRGutHOjjnoA6tHHE3e8mrdS550F5ybjRj0Hp9c/CafuLIR++c5HNNxNagw8zLd7QXqD8VLl+yXl/sus3q1VsP6pPTT17f3KT79m//dvYeH8uzF6drWn5OwP3nv/Y4sfbwPxZuxaj3vqR+Az/a6KMiGlg4h/yzxH+1nIlfKPMt4h4GfhlvvXvOPPPMhyw1HbgZzu0NQpM3qdcQZ80on5zaOc58oj41+K5HPjG/Ino95FNjn87Jd0xd9k8/NdSbs1fPE3dO7Qjh0qwXzdkz5zcnju7fiFPfUS289xjUH+3pqebe9773Q0vHJ9sesGmP0qjsVF4uu+wy9rDXtQ6Rd/P6V/xoMSZtTmyh3BCf//znv6+03NxpsdQtv01Ezyc319UHHQ8qP82bAzfdiEwu/Tk+pbmm5PXJa6nFH/V3XeasF+3V0c3VdcYidfjG+j22v7yxKD+H6lyXccdeP5eH997gU+c9GsVwGDrHRCxfnFeux53vedciP3ede+tTbP6F6WurIZ8NoHcwxz1r7PmJn/iJ9y55OE2dc8Drm1O7AecOmMW9URbbeIXvfOc7+d3C50o0LbbQDzrUfL4+6LjvySfzY9oGy/lMyIneSFAuEb8/aDhH76vWftaDGA/KWjlrjBP1UwPnoCeWMX7Ob15Um5sGzlhUR50mJ3aemBzWNcmpmYRLbd4beGLXQozZU4TLe6OmX39qem3mqNdcI3n2tDry+HvrC/uO+m6Kn8E+T8xYfndV7rR29uxn2cMQZc5t7wW7j1eTvP4K5w6YApvnZPpqQLm99UHHRytmsZjvYFNQF/epco5929ve9uiJWNTh5g1ZpiaAz5zrIZl8j9VZL6LDzK/zsz++10jNOsve6uxFzl7mun40jzVdSw8568RR/9SO8vZT57pHWnLm0+/zW2vvjEd+zm1f5yGnL2YPOOvh1ex8xzvewZ47tt4A+BBDDeg4tf7nfOxd43VYsg09iIe27oAxAeZE6cvth9ddd93flZD/9ov/Fef0DlZfKXhLru8Wp/+F7J4LLrjgWyrGvCE5FzyxaxvlrFOb64DTkrcPuawnHuWyNr86q01MP/vZw6/4mbOnGnLJqSWf9WpEdZvh3BqzLnvKOz9x3jfX5PpFNGlz8yafPrX26mjOvcFczufajNFqex/2sIex5/j5i7+Z5d3MXyFxHXevcXT9B6x/U9jn7HFJNmiMwf3MhdJEs6GxqMb8CPe8//3v/+/LgntZuPw5jJDfnn++/pmxry2k3odU7spyHsi8YemTUwtvTo68Zs5YVJv53GTyInoHPdLvPclZJ3Y9cTe5xKxHnzl9+xiL8iP0Wu0vorUejkEsV+7KrBHViCthc+wJje9ImT17zt7uH3XUmrMP8c4TTjjh4YV8ezj9BcdyT3r9pyN+97vf/Z4C9HMDmTn8NHkQm9ADtqCWpMFSZCF0Fst7kVN84YUXfqC+SnyptPxCD878hJX7VH31OKM+EDmtcpq9iPNmyidaozZjOXpkTfpojPExYkxcRPt0qfdhzmmttZ+1qZfbikZt1lvnXOs0mbMHyPPwPuFjmTf2+dnH658KljXmrCdn764jRuecxvYgdg45ET5zuX/VUK9N3E//9E+fXj+enOG7VyXz5y8096ncdU972tP+gdzMKHqVSx/9rOUCu6gXzk0sv3oQ9XPYX1ezr6hhf3uBvEXvfO5zn3thYZp9RPrlDfXGUqPG+ozxfXhZo08+zdoRnzp8tSNeTk3vt67enOi9zJ7m7J+55PS9B7kOc9YmquuoJu+ffdSONH1+69HiO6y111xvdOasAeljrXOkbueznvWsb1vq2HvmRPboGbfeeit7Vs77bzzCkq+M/NA8AMNkkaPGyfWFTPEVV1zx9qo9sgZ/3Dt9tVh+YlNfKPZeXdxNp59++jcVos8eFa5ulj55/cTRjV0o9732tZrxhog+mLm8PGjPka/OvmrFzMul1ryohjh1+t671KvN+5N9zINZnxr7i1kj5z0zBvXRm7fWHOi8Pls0WtbJieayF/6Ip2aa6173utf/Vj7/BfP0CaJ7cZlnjx5Z/zEIexb9ZqMk+2nghjZ3wJgkzUnh9BO9YXB7nvSkJ/1RId/rnl0DSy3xx+vj+gue+tSn8lcfUw1kmTccTvPmzcXZ23WgtYf1oJy91MmLXQufOevsY07MvPNnj6xLvq/ffh2zv/WJ5LNXzqefaH84fVHOuF+PfNclT06j3h4gOrUjX23W64NZQ5x7aG/99caJtdceUofrE0stn7ahw6g9u8bNF110EXuW2Psm2j+xZPsZ+f1sdMAUdqQ4J9F3IeA0PvrRj95aF/Ghiv05zI/rqeGTnMsKj3rFK17xzEKNHDfTfvD65DDnTMwHMOdbb4+p2fLFGjX2ls8ac6kljza57hvby1iUt0/y5kRy5kVymvnslbq8p8nrz9Xbz3rng9fUGGdPOOKsN28P6+Hl8NWN/KxJXZXt2PvKV77yGYX8l/aXEtdY/XXRMj67zFxizQAAIERJREFUfqT5YP03YLeSU9PQeUdY0g3rI15ZHjAXt0qWIzdq7GLI4W+Ir7nmmncWxx9WTr8Ti49F+bsp/ij4+vpnx76jkI9LrQW9YfianLEon+sk53r11RHjY2rEBbtvfnnQGjWJ5HPd5uAxMf3Oea3wrhXfkbX4mD1GmhHnHIvqfa9qnddrtT9Kc/uq9nno6N37WC9aYX9jUA3Y51KvxliEd9iLmDXtqT+PYo9dv9xz5DH1fNJ93Oc//3nevSb9Es13rPSqlhwmLqLF64rLA5aC9BWDfbgoeeM9r3rVq3639Bye+y3rCqZ6NNil9cnOeWeddRb/0CP18GK5K5OHcJ7uG4Mjyzr7waWp2Yw3r94eXlfnySdnveuwXo0or84682Lq8FOXsb551wuP5TzZW19cqPfpiec2u1rQeTuq6XyP1eU65cTM7f3t3/7t8+oL+7mV/KelYPq97NJHe06N3fUp45sKmc9Bzl6iuUqtzDWuiO6sO2DZ0EZyHV3QCi+++OLP1beJfOzJBWK+NePXF5S9/EHw7V/7tV/rAes9iemH4Ws+TJEcvrE6+xGbU6sGzN4ZZ728WlEeTHM+12/OOhE+fXXymcPPeE7TexhnffZJX604l5PnOvVFar3+5PTNjeboGmO0+BnLcY/hxRX/5Cc/+T8R1P/Xmr/QmPLL33+hZx0PqH34j7/+67/Or5XIO5zLnsYdq2S4LvjJ5g4YjTT9xD6RC9uA9f8QfkM14YMM/x2E6RPFeud6bI371n8a8Jo3v/nNN1bebxO9IJE15LzGOX9y6fsg1ZLDjMnbe0rEi7waYyT6oL68HOvHsl6tSF7fOjCvXc1IZ806Tc/12LnslYg210+MqSHndcJp5o1B86BzJp9+1o/mR4ulTt/+07rq7w/vX7ov1167fqqomvgEkT15wmc+85nfKUQ/Gtm3+7SE09KXW/2eSmIoqmRvbuyiejzxT3ziE19btV+u8e+ixzfUBT/opptu+p2TTjrpZ4PPHvj0ADF8zJgbnybfOXmRPL4PTj1cDnhjNb1GXm3GcvTQF+c4+UXFxvkzp5+o7xyifEfzORd+3ldqrEsdXL8XXYd+xNkn54Hz+ZoHqc8ezimf6F6B0999/fXX85cZJ9V++/fRz55fVdwN3/qt3/r/LWuomxs5l/VilW2wDfzcO5gV2RjOYtAL0e+L233JJZfcUr/Ae0dpz67BL56/scZX3nzzza+vP5f6v8unxncv+xQ18WByxnKg3NJdrS9jdWrzQcmB+dCtSex+xtRjyeE7puRM3hyY9cb2EOG992pADB4T8a3rSA6D17IvnLmslTdnrXxHa73v5JnHuciTMy8WNVw7POb81oP2nPDBD37wS+sTwvfUAXt4jYfFuxcfvp1Te/OP6n/9xK+TXI9Irxz2hcM6LtjB67oDZhPLcsL0nTzRhe554xvf+HPVgG8Dn1zjQXVRr6v/LsfDpY5+HDSx3NXNwoe3P3G3/lDM++CIc83mE80nl755eqbJw6WfGnzWPzJqtKxPnry55PXNqct+3c/1W5919hJ7vbGYPbKPebFffz6brFOX+dGaXR96hjE4cVddddXuc84555n1M9hfcsiKf1gN7ME19tZ/mvKyQuvFVT2aTUalVxr8/SwXbjI5L3IOOaDm0pebsP4PIPeuXz4/rT4O/VD946N/XjUsHEvER8+FYsTpT+SStw6OGsw59e03yqtJTN+aziVPDuO6XU+uYUrWS9bouzY0c5w97aNWnjr7dM4aeWNRvteTz1zXZz59anovudSxZp8pPL7X4bzw1iaHLt8QiHNQZ16c8ve973131u+53lC/cP760lxR48z6cOPv6h3tovJzLtZDvBlmjX6VTUa8MhYwMvlE/NHgYka8HP3xNfwNi1jG3mxQc/EjvZreG340t7qO6kXmsl7tKAeHdc2CnedH+eScX+5Asd8r65N3js6NtHDqErlunxl85qjB5PSNRfmOmSen5b1m36GD80CJcI5yd+ysd7Kd9QcQL6t/tu1xdbiufMMb3vC9z3zmM68kWUYfhgcr/eSSt8b6RPzJcsFyYPIuVC7jrfi9X86DnwvNmN6Zw8dAcyCWaC4fgJrUyYFY5pjDhzUll3l7pzbz+Obkk5ur95p6jdcsb/1cLG+/Xk++cxlblwen16hXC8qpHeXUiGgxYrk5VMf1O+C6D+dzI4d1dA5y+qBjswOlTux9iFfG76BG5qLIdT/jUa0cC8ASXRQXgXkx9jRPLuuI09Az0OiTt89m2LXq4THjRNeTeX11xCMd+REvZ32P6dcNTer11dnDOLHnPEjrNDlf6pjX55h8nyNz3Xf+vAbrRWoybw84NebBXJN5EB7c6thMX60mcw7jDTh3wBDlojPuPrGWk+kn4jusAfNi5NW5DvuQz5z5RH17JWZOP3vDyWedmsyln1p7WENOv9cQmwOtzRp8LfVyc2hf8/aX773kU7/Op16j1np5ubl55K0DrRXt4Tx+Z5Jacl1HjHngjNXdEVx0XLzaT67HE+9FKErMnH7iVnz6qcve+Cwocy4QDt9857OmZFMPteZGKGdNIj7WNcbiSDMVLl9Sl9oR75qzvvu9Lmu632uN53TyIANjvowncsnhqxv563LosZGmz2cMup6peFkP1+8L+eStHenQaugw50xfTsxc943BDbaVdzAKcqHpb2i2DHLRUC6wI326dtlixVuv1rmtUy8vwqeffbqfOnxjEb2WnL440sCZZ834c2s3T82dNXv1uegLZ97YNRKnZb2+iC79rNPPPO8kXr886Nxy1natPDjSymcu373g141en9pRDm5T8+LmhJkf+XJzSF9zfY68Eerg1Js3VtP7yI90cJ3P2F6py7y868pc1roGdZmjZu5aRvyo15xOPmucOzF18MSuK/25mlG9fTK3mW9e7D0673rgGaP7r6bnNtNb55yJ6aMjHnG9h/EK172DIeqLzlhfXDUtx8XA5eJGMfVq9NF1M2dv5xXR64vZI793n9NaBzKcK/VyqSWPWdPrqXF+daC8vvXEaeicL/mRn+vTt97YuuTTzzx+5rKHfNe4VvOiOhDLXsT9+s2LaDS1ORc5tWD61olz+RG/ro/9hujihskiR/nk5nz6ZW6uf/Kp54Iy7r755N3AciBDLXPJ6YtqrIXHjLPPiEvtVLh8USuXsT3nauVdGzji7CMuZRP0mszhmxfNZ4zfe5vvmPW9bt23iL3PKLYfc+irc96+TvnN0D4iev2OmbOvGuMVbvYOhpBFd+vcZnGv77EL7OgNk3cekT76aPAZ6sudTE1i16gVR72sR5PzWZOYWn3QOjFr0rcmufR7PfHIOm8sOo8xPfDl7SnnzzVd1+uzDt9+qUuN/cHUpK8elKevPtgH2nVmLZoD9XvNfvPc0QNmI2+aMTjiMj/yRzXJ4Xvx8iL99EEHPDaK5SfBUtM5c513ruThWJ85YzUZw3WzrvPGWT/y5+rznunbU8x1yzlH5qyfm8vaRGvg0h9pnHOU6/W5Btdof3PGYvZNv+czTr+vIXvM+ls5YBS76LlGdySfi8fPeK6fvOjaMrYPHMNYLZiWtfJyYueJey7nUb8Oqaem97FG3r5qjXu9vPWivCgPds4YpL9zoNXUjGJz1qNJrteYm9Pl/K4ntfaTU5994dZZatXdGc4eE271gCHebKE23qpOvTi6KHuJaPF7bA9+DsscPDG9sy41c3nX0/Pw/ee9oiazb9b0XNabE603nkP7k9f3Gq1x/caiusynry6x512nvJg1+PJicqnNvLycc1krb5x6coysMb8ZZt/UzvGpmfUP5IDR5I4sfHbymYRziMp6DC8nenNFa9V23jrzIjoPERyWWmI0Wubw+zzq5K1dp7UGtL/1cN2H6+Y88PTwgwbizBFj9kxcZBav1oAjzRxnj6zvHHHPz8Ujrf28p8Z3BJ13Xe1WNDsO9IDlhD705O4qn97ZP302viYvwnPhxHIiOa1zHqbOo+9cxvjO1zF1zjvql1w+tLn67NX9rdTP9bVWTJ0cKC+6htTAzeV7zp693r5zqN48sUMO7OvIHH7v0/OjeMs1d+aAjSbe7GJGNSMu++iD+tToi3McPGa9N4cYX0SDZb8Fs+81c/q93h7OY7X6jJ0fLn01idbb13nFUb3a7IOffNanLjXJW0+d74hoGXCa9WLyctaAcnO6zve5er36uxIPeI67+oDd2YvxYdPHG9jRXPJcOLGcmkR8DE3eqM1qMm+9mH1GXK9VA44s16Y/6tFrXYc15Ed13qe5enh7rdP0nHHOn5x+7z3Sdw21XkvmRrXOc1dhzneHeh5sBywvwps64ry56zRZp9/rsl4/MW+wvL069nyP0cP1nsaplxvNkTn7wY3qU2svtYnpqwOzXk2+a6lVJ67j1djPOOczJ7cVjVrnHuHoHo10dxl3MB8wLtIbIuaFw3nj8VPT/c3y9O01cFjyGcPnRui61OKnqbXeGI3XhN/ngEtTO1efWnz18s5PbA+5rrUmcZ1mlINj5FzZb85Xn3m4/KU3uZEua/7F/YP1gM3dKPmOeeO2klOv1hiEk++bxFzfKL0+4/Ttm1z6ufnkR2uYm7/X91p7gpnTF9URy4mZ6z4arlEt2Dnzauixzjcnpj7vZ+bRHBR2sB4wb443UITHZ3BDk69wFY/yqdUXqcWM82HJLRQbX82pN0bl+sSsRJe89alJXz1c1iWf+q4zl/NkH/PWiV6PaL3ziqlHow4e6/ULdh9vLPZ6eHukRm6kV/evigf7AePmcBMZ3ERvaLkrTh/E1Iibcevy/cH1nuZHfHLMgcFZMxHxMtKnFt/69Ed10XY/N3tm0p7J4asXk+vaHo9qRtxcT7QMr1tdctmP/EFlh8oB86a5mRK9wXJo5/xRLuvT73P2WmNr1IvyrAV/tCY11ozQenPZR26EOefcPJ03dk5Qf24Oa0R1GeMz7KcG7Dpz8s5vbL7XJn/Q+IfKAfPhcOO44VjH5NL3AfnLZHLYXL0P0vxCvU/fY/tnz+67fnvbo6O9nFt91suNtJ2zf9bLgfLp9/6jXNa5VnSY9emrB3ve+tRQi6kV57hJfDC+HAoHjPuWG8cH0u+nvFrrRmitNXMae4F9bFbjHOrcQPLZu+fU3Bm0Z+JcPzXkXdecNnnq0ozFzOnTv1vq+/yZ0wdHfXrff/X4UDlg3ihvqg8BlFMjbpZLXfrZb64HvA879fTJGnOJbg7RuUdInfOQNxaTw9+K2c/5XVuvTT59dMaiPXsPYnOiGn+fZtzz8qJ5Uf6gxvy7voN6ocvFeXNF6PR94F4LD9E8mL4auF5HLrn0uWfEoPePeDSK3tBnFI/WhA7L3/OsW/9CvfFVfe+f67QCDuuY3CRYauyZnLVyYOq6rz6vsdf2GmLrUnvQ+ofaO1jeSG+0mDl9cvmQurbHHJh8iB4m+qH1QBmL9lFv3BG9Ri7ngpfTzxgubS4nDzKw9BfMPi415qzpsdpcd3Lovd8d7QlvfR4u9dmj+8SHlB15SK1232J5qD6kfexGLx8YmV7jxsgqavIQWQfC55zWJzpnctRi9mVT9bx94Rn2KXelxe9mn6zvGueVR+u1yIGjueWpcU0gX5jzOsz1tVOPmQcZqcPf7KD1mio5NOxQfgfrd5gHhYmLaOOrDzo3GHqGG9H6RDWJdM5YvX3y3qrLmpEvJ9rTGOxmb7WgGzK5kc61imqYA84+xqDmvTQGU2/c88Zz9dZ5HeoPSTxU38G82T4EEMuHJieaM0avD7o5RDdYbj5qjPGznhiznpx9p8TyxRrXAzoXEuuX8tUc8llvfzlr6NdzvV6ttSK8tdmHekydaF9yatRljN+1zoNes0YcadQe9OhNOugXumaB+QDcqHld+qA+7dBiIrn01cJZK1JnXkwO3w2ir67z5kE0mYdL2yyPts9jLHaNPPPqoyH220B883DGIAanNrHr0Mrha3LMb09RzSGJh/o7GDc9H4QPCj43S+rgzflA5ajPHH4/dMTo+BbQue1jrlKrutSw+dC4Cc2J1NnLdcBp6Jyj6zKHnrw9xK6hl0bOnnDWW8Oa1ZDX5NTDw2k5t9dNDp44jbqszdwh6Xvxh+TiZxbNNfGQcvMoletIjYMcviifHP3k9ROdv28gNG4yNPRIjRw6jHgrRh8s6+F6PInqpefkRedlbfqgA505uPTVyKOV009c55M7pG07vIP1B8DDxEA3HrG+m4sDpAaO4cHLWD8xdVU21ZJPUy/nulIHlx+GELsm0HnokTwxfeAw5yJW5zziJFy+yHWth9181vD/0Ib3MOHn/GqTUyOicU5967YlbscDxoPigWI+7EW0ePVhk2MDqyUrl7wcOoY5Y+rskRx8zo9PXm6E2Sfz1pm3dx5ANeTwja2hn3pzaNO8NjgOErHrsA+cB1FfDagOP3n9oie+x/DbzrbrAePh+aB9aG4qcmwMbKSB9+GjQ8OY87OH2qyv0snkQHRsUpDYYS83t/nkS77a+PLW+27oHHmdctY7PzG5NOeHwydPb3yMviPf9aJ3PntbI0+fbW/b9YCNHhwPlocM+pBzI7E5GGgS5ZMryaQTyWGi/Rfs4lXOjdkPg3zORyV1GJg1rBPLOYm9RnmR+szZixrM9SVmDd8iWp/fLlJLLziMGg3fIcd6usbctsPD5YDlJvMBd86Hy8N388LhM3aecsopO0888cSjPvGJT3gw6WGfjpUamjo3mcgmxbenvk3UkR/lXLP9qdvMt6dzeF3wc8P51YKux35qnD97OddhgT6Uw+Ji4yJ98FD4xiN/yt3jHvc44rOf/ex/u+KKK/725ptv/oV3vvOdX72s4x5yOEC+YIFy8ObkO6YmtelnP/3so1YcaVKvj94Bl+tXs+t3f/d3z7vyyiv/4/K68hAVtd/9g9PUGh926Mbajhee16YP9sFGgmOjdZw2Wb1zTYfryCOPfPzevXs/vnPnzvuU9sg9e/Zcce21177tpS996e+88IUv/HxxGD1G1jebsUjNnD/q17mcd+Qn12uJnRvc84IXvOD0Zz/72U87+eSTL9y1a9e5CG688cbfOOGEE36qXL4dRAfyDua7GGguObTZX7/oFY+/7Wyzm34oX3Bemz7YhwfMr9getOmr+T3vec+dn/70p1+zPFx/VAfsj+tgnXjEEUd8dR20h1e/s2vsvv322y+pbx1//8UvfvGfvupVr/pSzFPuhk3k5uqITjNnvBX0GrtWXjTPHMnt/e7v/u4TX/SiFz353ve+N4fq/Mrvquv9VOElNe7F9da793877rjjLq64HyYPloeO/gwPmtckX6mVmVsR28XJG7xdrsnryGvTB3Pk4YIn5oBNh+2000474qqrrvqt5eH6w9ps76jcjt27d9tvR2260+uwPbzwYZU6uUadvz2fuOGGGy659NJL3/PjP/7j733Xu951I3XN3FQi6Tm/lQ7D1ZqWWWOR3lyXtvexj33sCfXu+3XnnXfeI+pny6+pazi3Bl9Yrq5rvaSu828Kr6agrnFv5f5jja9bHrL/p2gPmcgcHrQ8WPgYecdELF/gtqV587fjxeW14Rvrg3nA9KcDdq973euIT33qU6+tjfXNtck4XH88ukkettJxsu5XeF5twvNKe04NNuvtxV923XXX/c+PfOQj73/Tm9700Ze85CWfKR7LjYXvGtmQ+uiwzOuL5j1AyU/F9bLz6U9/+t2e//znP/zcc899RH2r99X1LnX/4rnePXV9nyz858K/L/xEXBe9tJ1V88wKHlGH7NX1Tvafy/dA+c7lwRKp74N+2Td9ctvG+kPcNhdWF5LXhm+sD3qowNU488wzd9WHGb9dh+Vbiudgva0OifUVTr322xRuSgRVe2Rt1vvXhvTAnV00c2A3Vb9P33bbbZ/48pe//Imrr776sksuueSff/Znf/bSj370o7ctJNPrfnNELt3V2h7xiEcc+2M/9mMPuOCCCx5w6qmn3q8O0tn1DnyfGveugrsti26vtV1Z/qUc/vqC8LHyb3H9tfZ183LI+MDjEbfccst/OfbYY59fPofJQW36xH0U9W8HjJtwKNtq09VF4Bvrg/2AwR3x4Q9/+OFf+ZVf+ary71vj+hr/vcZ7alznQatNtle/eIxaNpIINxkbtzbtsbWp71t1pxd5rxqn18bG59tKajDqb61xc2lvLryp8Kaqv7Hmwr+hOL4tPa76HL/E4wqPZVSKcRySGtq1Vce3edMo/xPV6+NVf2s7UK5btF7kYFXpHvCMIp9T46T6IvHrRx999E+Un4cq/X64iDGx+1Nyu7zkg9gu1+R15LXpgznygMGv3sXKP+Lyyy//trPOOuvZdTi+tmI2zQdr/FVtsg/XJuNbP/RsFPvnpoHbL1ebmhre4fbg18E4qsLTqx8H7p7lH1+Dg3LMcnB4Vn5x2C2OOjC3VH6K8Yvni8DVxV0NFje9IzIfhcxZPutybSJpfG3D+mt9rJP78Kga59S4rXr9j3r3/Y2v+IqveEvFHiqQPiJ+H0VtmCvnJbdtzI2xbS4oLiSvTR/sIw9ZHrCV/yd/8ifnP+Yxj/n++kr9rVV/9xq8q72/xl/XJv5Ubb5p8y4PXNGT9U2zszYk72STthSsA404bf6psl7ULWv2cjCWub0cEGI0IrnQrOqXNcDa+esaeEd2jh1eU9Xdr8aja/z7GsfUgb2yPq5/46tf/er/+rznPe+zxXE9fXBdcKB+uasYLq3HmTukfR7udrW8Nn1wNDxM5PTF6UMP+Ac+8IFH1y+YL6qf0Z5Rm5uP6PkQ4ws1+GDg72uDXlYbkx/2+cBjtVmJl8ZGci1yojk320inZvokk4NmcaE5ubX1UcdhomY6YOWTOrfGBTUeUuO0GjfXryH+rD6k+c2HPOQhf1lxHqjRhxv9cE39qw5Lf8EsOP1thaOHsF0uMK9NH5wbHigQjfHqgAW3qz6Nu2d9Bb+ofk/2LfUBwtdU7uga/Iz0T8vxz4X5aeHOOnT0ZYOBaZ1bF/ccfTq3Lt67PER8EeDnKbT8LPjAGg+q8e9q8HPcjfWO+Pdf+MIX3vXc5z73d8quKy4P1jqfnnnIiBlY+sZTYju+9Ae9na4xr00/EZ/hgdL3YPVYfj984hOfeOIrXvGKb6mfRR53zDHHfHX15Ks+dm2NS2tcUYMPFz5ZG5pD6OZmE3rwoA/I/v92zZ+3jiqI4kaKG0MTpUCisEXSgYRER0PpypU/hBt/Bxdu/CVc+oNEokqBRGVRIAGFU2AJhcgIpEDBnPfeLz6MZ++760eQvJuR9p0zZ+bevf/Ga69f9BVdlk/KxVNJBUSHKiT5gSoefRNF17O49LTS20W9qv8hfv17cXl5+fzw8PBF/A9Qf79RLK2C8hj5FFLG6PJtsWUuf1L2dgMmNavlZPLc5KPBHSk0xzvFFH1UcfpZxM7Pz58eHBx8HU+3r+Lp9nm8cKDgNDJ9peoqLr3Vu17513H4f4vD779e6kmjw/kvWxXJQm/wR9FWbyd1X7040aXX9CqqJ3Fh12/evPn26urqm7Ozs+fxd5V+IPDkcfQCcq5xVD5FRR+6HxpcKFvMZUmn98mBm97MbouJuTFXikE6nKKRDxdmXmneJnP5W0dHR4+Pj4+/3Nvb+yK+MfHZ9vb2bsh6Va+3g5gOmr7xoRcov6/wz8C/7Vq8EQxfb/T0qyv4YfCP7NKbSI0V+yueTr/E31E/xv/dvo+vdF1eXFx8F9/i+DUSOPhCCsJ5VUBDmrfzfsVlGV1bJEztY3EApjYpm4/PD+4oni8vKsXWFVXOz/3ha1jisg/ijeTWycnJJ/v7+093d3c/3dnZ+Ti0J1F8j/X0iaeeLr2uVxHperTCgC0VGoWn4vkjrtfxN9PreKq9in8Av7q5uXkZT6af42taP52enr6MJ5Xa+QHPBeA+hebYw72PivsYxGXKm6yx4VOdYJ4fvjBzNApGPrwX6aNCrTE6XCiT7pZ9j7V4Pqz4FbomTgGJu4/ei7R31Jjly8Cld9dHnwTqp+JcTRvtB5mNB7UuOlQqLiG5jspVnL4Ua10RvtOPa5nLd+PePkaPi3us4tK4yMcXUkho+BmrXNqA6l8mf5Y21wLThuuw+sYPHV6KywtN7Xiq0VersOibHB02tBZXTOa5S2X56eNHdy1zfGHmaCAFVfmtGOMQcg+0dT55k8G5FZg2mMOaed5U4iokGYVGkXgczVFthnxiQpnyMOdowqzr/pW5Dq/QNfHWlQuKXNcZCzGhDFx6M/uceoFpc6uD6Ro5fhDQdBxyYamtX+S6Rv+uqS/XK1+ajLyl1//pc1Ar/ApdE9/04n70K99tSPecyfH7buRDWoihOaK3UDGP42fUemQttyOnQtcyl99rfogrjibMvPLJc9RY3Iejt1AxTO0mb1N/gmkDtZEcdt9Q9HUbTZ735cUkfcj3GLxC18Rl1ZiXkfozz8N9eIWuiVf+Ok0j8rb4juKzs7Gb+JAXaGiurldcGrrjWK618zbuZ1750lpGEZDjPryFHss8+7qHa5XvmrgbbV2bJGfDJzm5YlKt+Xqs4mgV9moaUs51jSGTg9+L+eDig+oH7uicnEoj1kLFZLRferefQ/ptxoTYfTfyIS/Bujl7fB0nPha1frkNa4qOD2Z96KBmHR9Uf/BN0ftinPSJ79iKed5keN60yUyscyKt+efYkO86PKOG09IYLjn43s41+NCBzTo+qPZw8D7aunH0xsmbHFYbOrlJdkxo3TpUcdc24Rqet6/8jiksUrxYJLR8j43lVd+LAdiH92nyvGje2HnNvp5tz5pUOa45113G+owst0PPOHSYsz7Gz7m6Z6X1jiXnzcLv3cBZLMbAJHvWqMrp0aochtGKkePYOvw5ln3106v5PYfa5ZzZ+mM3cbYLtZp473q18oZiQ/p917wqGPU1pK+LMY5We3Le42oF/utNnePCjlnD3tzevLzevYe/N0/9j8nN45m9f9+NnP3CdSzApms7tv2mhbBp+44lmV/K2E2c3wq92xn/X+v/vnje7T4O9v4PRqxOxnwQYu4AAAAASUVORK5CYII=";var r$C=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});function M$u($e){return r$C(this,null,function*(){return new Promise(Se=>{if(s$o($e))Se();else{const Be=De=>{const Ve=l$w($e);De===Ve&&($e.off("modelLoaded",Be),Se())};$e.on("modelLoaded",Be)}})})}function s$o($e){var Se;return(Se=l$w($e))==null?void 0:Se.loaded}let r$B=[null,null,()=>null];function E$u($e){var Se;if(r$B){if(r$B[0]===$e)return r$B[2];(Se=r$B[1])==null||Se.dispose()}const Be=new W$f("front");Be.domElementWrapper.style.zIndex="1";const De=new W$f("behind");M$u($e).then(()=>{var Fe;const Je=(Fe=$e.getElement())==null?void 0:Fe.parentElement,Xe=d$D($e);if(!Je)return console.error("initialCSS3DRender: five element is not exist"),()=>null;if(Be.appendToElement(Je),Be.renderEveryFrame($e.scene,$e.camera),!Xe)return console.error("initialCSS3DRender: behindWrapper is not exist"),()=>null;De.appendToElement(Xe),De.renderEveryFrame($e.scene,$e.camera)});const Ve=()=>{Be.dispose(),De.dispose()};return r$B=[$e,Be,Ve],Ve}const L$n=16777215,T$m=16777215,_$i=1,A$w=.5,E$t=.6;var s$n=Object.defineProperty,h$x=($e,Se,Be)=>Se in $e?s$n($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$t=($e,Se,Be)=>(h$x($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let c$C=class extends Object3D{constructor(){super(),i$t(this,"name","IObject3D"),i$t(this,"needsRender")}removeChildren(){for(;this.children.length>0;)this.remove(this.children[0]);return this}add(...Se){const Be=Se.filter(Boolean);return Be.length===0?this:super.add(...Be)}addIfNotExists(...Se){return Se.forEach(Be=>{this.children.includes(Be)||this.add(Be)}),this}remove(...Se){if(Se.length===0)return this;const Be=Se.filter(Boolean);return super.remove(...Be)}removeFromParent(){const Se=this.parent;return Se!==null&&Se.remove(this),this}};function c$B($e,Se){if(!document.getElementById("LineLengthTagStyle")){const De=document.createElement("style");De.id="LineLengthTagStyle",document.head.appendChild(De),De.innerHTML=`
    .LineLengthTag {
      cursor: default;
      position: absolute;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: Arial-BoldMT;
      font-weight: BoldMT;
      color: #041066;
      letter-spacing: 0;
      line-height: 20px;
      background-color: #FFFFFF;
      border-radius: 12px;
      padding: 2px 8px;
      left: 50%;
      transform: translate(-50%, -50%);
      word-break: keep-all;
      --distance-scale: 1; /* Default scale if not provided */
      transition: font-size 0.5s ease; /* Smooth transition for font size */
    }
    
    /* sm screen */
    @media screen and (max-width: 499px) {
      .LineLengthTag {
        font-size: calc(12px + (14px - 12px) * var(--distance-scale));
      }
    }
    
    /* md screen */
    @media screen and (min-width: 500px) and (max-width: 929px) {
      .LineLengthTag {
        font-size: calc(12px + (14px - 12px) * var(--distance-scale));
      }
    }
    
    /* lg screen */
    @media screen and (min-width: 930px) and (max-width: 1365px) {
      .LineLengthTag {
        font-size: calc(14px + (16px - 14px) * var(--distance-scale));
      }
    }
    
    /* xl screen */
    @media screen and (min-width: 1366px) and (max-width: 2549px) {
      .LineLengthTag {
        font-size: calc(14px + (16px - 14px) * var(--distance-scale));
      }
    }
    
    /* xxl screen */
    @media screen and (min-width: 2550px) {
      .LineLengthTag {
        font-size: calc(0.875rem + (1rem - 0.875rem) * var(--distance-scale));
      }
    }
    `}const Be=Se!=null&&Se.offsetY?`translateY(${Se.offsetY}px)`:"";return`
    <div class="LineLengthTag" style="${Be?`transform: translate(-50%, -50%) ${Be};`:""}${Se!=null&&Se.style?" "+Se.style:""}">
      ${$e}
    </div>
  `}function a$x($e,Se){const Be=t$c(Se).map(De=>$e.localToWorld(De.clone()));return Array.isArray(Se)?Be:Be[0]}function e$g($e,Se){const Be=t$c(Se).map(De=>$e.worldToLocal(De.clone()));return Array.isArray(Se)?Be:Be[0]}let a$w=class extends O$m{constructor(...Se){super(...Se),this.setAttribute("instanceStart",new BufferAttribute(new Float32Array,3)),this.setAttribute("instanceEnd",new BufferAttribute(new Float32Array,3))}fromEdgesGeometry(Se){if(Se.attributes.position.array.length<6)return this.setAttribute("position",new BufferAttribute(new Float32Array,3)),this.setAttribute("instanceStart",new BufferAttribute(new Float32Array,3)),this.setAttribute("instanceEnd",new BufferAttribute(new Float32Array,3)),this;if(Se instanceof EdgesGeometry){const Be=new InstancedInterleavedBuffer(Se.attributes.position.array,6,1);this.setPositions(Se.attributes.position.array),this.setAttribute("instanceStart",new InterleavedBufferAttribute(Be,3,0)),this.setAttribute("instanceEnd",new InterleavedBufferAttribute(Be,3,3))}else super.fromEdgesGeometry(Se);return this}toJSON(){return{type:"FiveLineGeometry",attributes:this.attributes}}};var s$m=Object.defineProperty,l$t=($e,Se,Be)=>Se in $e?s$m($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$A=($e,Se,Be)=>(l$t($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let S$t=class extends L$o{constructor(Se){var Be;super(Se),r$A(this,"_three_color"),r$A(this,"_dashed"),i$w(Se?.color)&&(this.three_color=(Be=Se?.color)!=null?Be:16777215),Object.keys(Se).forEach(De=>{["color","dashed","dashScale","dashSize","gapSize","resolution"].includes(De)||De in this&&(this[De]=Se[De])}),Object.defineProperties(this,{dashed:{get(){return this._dashed},set(De){this._dashed=De,De?this.defines.USE_DASH="":delete this.defines.USE_DASH,this.needsUpdate=!0}}})}get three_color(){return this._three_color}set three_color(Se){this._three_color=Se,this.color=Se}toJSON(){return{type:"FiveLineMaterial",color:this.color}}},o$A=class extends I$r{constructor(Se,Be){super(Se,Be)}toJSON(){return{type:"Five_THREE_Line2",geometryAttributes:this.geometry.attributes}}};var s$l=Object.defineProperty,c$A=($e,Se,Be)=>Se in $e?s$l($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$z=($e,Se,Be)=>(c$A($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let S$s=class extends l$v{constructor(Se){var Be;super(Se),r$z(this,"_three_color"),r$z(this,"_dashed"),i$w(Se?.color)&&(this.three_color=(Be=Se?.color)!=null?Be:16777215),Object.keys(Se).forEach(De=>{["color","dashed","dashScale","dashSize","gapSize","resolution"].includes(De)||De in this&&(this[De]=Se[De])}),Object.defineProperties(this,{dashed:{get(){return this._dashed},set(De){this._dashed=De,De?this.defines.USE_DASH="":delete this.defines.USE_DASH,this.needsUpdate=!0}}})}get three_color(){return this._three_color}set three_color(Se){this._three_color=Se,this.color=Se}toJSON(){return{type:"FiveLineMaterial",color:this.color}}};function i$s($e,Se="m"){let Be;if(Se==="m")return Be=$e.toFixed(2),Be==="0.00"?void 0:Be+"m";if(Se==="mm")return Be=($e*1e3).toFixed(0),Be==="0"?void 0:Be+"mm";if(Se==="ft"){const De=Math.floor($e/.3048),Ve=Math.floor($e%.3048/.0254);return De===0&&Ve===0?void 0:`${De}′${Ve}″`}}function o$z($e,Se="m"){let Be;if(Se==="m")return Be=$e.toFixed(2),Be==="0.00"?void 0:Be+"m²";if(Se==="mm")return Be=($e*1e3*1e3).toFixed(0),Be==="0"?void 0:Be+"mm²";if(Se==="ft"){const De=($e*10.76).toFixed(1);return De==="0.0"?void 0:De+"ft²"}}var s$k=Object.defineProperty,m$x=($e,Se,Be)=>Se in $e?s$k($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,n$r=($e,Se,Be)=>(m$x($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const t$b=class{static checkDom(Se){let Be=Se,De=!0;for(;Be.parent;)De===!0&&Be.visible===!1&&(De=!1),Be=Be.parent;Be.type==="Scene"?(Se._onAdded(),De?Se._onShowed():Se._onHidden()):Se._onRemoved()}static checkDomEveryFrame(){t$b.checkDomEveryFrameIsRunning||(t$b.checkDomEveryFrameIsRunning=!0,t$b._checkDomEveryFrame())}static _checkDomEveryFrame(){t$b.cacheObject.forEach(Se=>t$b.checkDom(Se)),requestAnimationFrame(t$b._checkDomEveryFrame)}};let r$y=t$b;n$r(r$y,"cacheObject",new Set),n$r(r$y,"checkDomEveryFrameIsRunning",!1);var $$c=Object.defineProperty,Y$e=Object.defineProperties,q$n=Object.getOwnPropertyDescriptors,B$q=Object.getOwnPropertySymbols,J$j=Object.prototype.hasOwnProperty,K$i=Object.prototype.propertyIsEnumerable,L$m=($e,Se,Be)=>Se in $e?$$c($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,p$A=($e,Se)=>{for(var Be in Se||(Se={}))J$j.call(Se,Be)&&L$m($e,Be,Se[Be]);if(B$q)for(var Be of B$q(Se))K$i.call(Se,Be)&&L$m($e,Be,Se[Be]);return $e},E$s=($e,Se)=>Y$e($e,q$n(Se)),o$y=($e,Se,Be)=>(L$m($e,typeof Se!="symbol"?Se+"":Se,Be),Be);class Oe extends c$C{constructor(Se){var Be,De,Ve,Fe;super(),o$y(this,"name","LineMesh"),o$y(this,"type","Line2"),o$y(this,"object"),o$y(this,"points",[]),o$y(this,"doms",[]),o$y(this,"highlighted",!1),o$y(this,"_geometry"),o$y(this,"line1"),o$y(this,"line2"),o$y(this,"opacityBeforeHighlight"),o$y(this,"colorBeforeHighlight"),o$y(this,"paramsStyle",{}),o$y(this,"lastRenderDomItem"),o$y(this,"lastFOV"),o$y(this,"_onAdded",()=>{this.doms.length===0&&this.paramsStyle.lengthEnable&&this.updateDomItems()}),o$y(this,"_onRemoved",()=>{this.doms.forEach(Ye=>Ye.destroy()),this.doms=[]}),o$y(this,"_onShowed",()=>{this.doms.forEach(Ye=>Ye.container.style.display="block")}),o$y(this,"_onHidden",()=>{this.doms.forEach(Ye=>Ye.container.style.display="none")}),o$y(this,"onCameraUpdate",()=>{var Ye;(Ye=this.five)!=null&&Ye.camera&&this.lastFOV!==this.five.camera.fov&&(this.lastFOV=this.five.camera.fov,this.updateDomItems({force:!0}))}),o$y(this,"onPanoArrived",()=>{setTimeout(()=>this.updateDomItems({force:!0}),100)}),this.paramsStyle=p$A({dashed:!1,lineOpacity:1},Se),this.geometry=new a$w;const Je={color:new Color((Be=Se?.lineColor)!=null?Be:T$m),linewidth:(De=Se?.lineWidth)!=null?De:_$i,dashScale:1,dashSize:.02,gapSize:.02,opacity:(Ve=Se?.lineOpacity)!=null?Ve:1,depthWrite:!1,transparent:!0},Xe=new S$t(E$s(p$A({},Je),{dashed:!1,depthTest:!0})),Ke=new S$s(E$s(p$A({},Je),{dashed:!0,depthTest:!1}));if(this.line1=new o$A(this.geometry,Xe),this.line2=new o$A(this.geometry,Ke),this.line1.renderOrder=2,this.line2.renderOrder=2,this.line1.name="line1",this.line2.name="line2",this.add(this.line1),this.five){const Ye=(Fe=this.five.renderer)==null?void 0:Fe.getSize(new Vector2);Ye&&this.setResolution(Ye.width,Ye.height),this.five.on("cameraUpdate",this.onCameraUpdate),this.five.on("cameraFovUpdate",this.onCameraUpdate),this.five.on("panoArrived",this.onPanoArrived)}Se&&this.setStyle(Se),Se!=null&&Se.points&&this.setPoints(Se.points),this.addEventListener("removed",()=>{this.five&&(this.five.off("cameraUpdate",this.onCameraUpdate),this.five.off("cameraFovUpdate",this.onCameraUpdate),this.five.off("panoArrived",this.onPanoArrived)),r$y.cacheObject.delete(this),r$y.checkDom(this)}),this.addEventListener("added",()=>{r$y.cacheObject.add(this)}),r$y.checkDomEveryFrame()}get style(){return{lineColor:this.color,lineWidth:this.lineWidth,lineOpacity:this.lineOpacity,dashed:this.dashed,occlusionVisibility:this.occlusionVisibility,occlusionMode:this.occlusionMode,lengthEnable:this.paramsStyle.lengthEnable,tip:this.paramsStyle.tip}}get lineOpacity(){var Se;return(Se=this.line1.material.opacity)!=null?Se:this.paramsStyle.lineOpacity}get lineWidth(){var Se;return(Se=this.line1.material.linewidth)!=null?Se:this.paramsStyle.lineWidth}get color(){var Se;return new Color((Se=this.line1.material.three_color)!=null?Se:this.paramsStyle.lineColor)}get dashed(){return this.paramsStyle.dashed}get occlusionVisibility(){return this.paramsStyle.occlusionVisibility}get occlusionMode(){return this.paramsStyle.occlusionMode}get five(){var Se,Be;const De=(Be=(Se=window.globalModules)==null?void 0:Se.five)!=null?Be:window.$five;return De||console.error("请先调用 Sculpt.modules.init(five) "),De}set geometry(Se){var Be;this._geometry=Se,this.line1&&(this.line1.geometry=Se),this.line2&&(this.line2.geometry=Se),(Be=this.line1)==null||Be.computeLineDistances()}get geometry(){return this._geometry}updateMatrixWorld(Se){var Be;if(super.updateMatrixWorld(Se),this.points){const De=(Be=a$x(this,this.points))==null?void 0:Be.map(Ve=>Ve.toArray().join(",")).join(",");De!==this.lastRenderDomItem&&(this.updateDomItems(),this.lastRenderDomItem=De)}}setPoints(Se){if(this.points.length===0&&Se.length===0)return;const Be=Se.map(t$j).filter(i$w);if(this.points=Be,Be.length<2){const Ve=new a$w;this.line1.geometry=Ve,this.line2.geometry=Ve,this.updateDomItems();return}const De=Be.flatMap(Ve=>[Ve.x,Ve.y,Ve.z]);if(De.length>2){this.line1.geometry.dispose();const Ve=new a$w;this.line1.geometry=Ve,this.line2.geometry=Ve}this.line1.geometry.setPositions(De),this.line1.computeLineDistances(),this.updateDomItems(),this.needsRender=!0}setResolution(Se,Be){const De=this.line1.material.resolution;(De.x!==Se||De.y!==Be)&&(De.set(Se,Be),this.needsRender=!0);const Ve=this.line2.material.resolution;(Ve.x!==Se||Ve.y!==Be)&&(Ve.set(Se,Be),this.needsRender=!0)}setStyle(Se){var Be,De,Ve,Fe;if(this.paramsStyle=p$A(p$A({},this.paramsStyle),Se),i$w(Se.lineColor)){const Ke=new Color(Se.lineColor);this.line1.material.three_color=Ke,this.line2.material.three_color=Ke}i$w(Se.lineWidth)&&(this.line1.material.linewidth=Se.lineWidth,this.line2.material.linewidth=Se.lineWidth),i$w(Se.dashed)&&(this.line1.material.dashed=Se.dashed),i$w(Se.lineOpacity)&&(this.line1.material.opacity=Se.lineOpacity,this.line2.material.opacity=Se.lineOpacity),this.updateDomItems({force:!0});const Je=(De=(Be=Se.occlusionVisibility)!=null?Be:this.paramsStyle.occlusionVisibility)!=null?De:!0,Xe=(Fe=(Ve=Se.occlusionMode)!=null?Ve:this.paramsStyle.occlusionMode)!=null?Fe:"translucence";Je?this.dashed?(this.remove(this.line2),this.line1.material.dashed=!0,this.line1.material.depthTest=!1):Xe==="depthTest"?(this.remove(this.line2),this.line1.material.dashed=!1,this.line1.material.depthTest=!1):Xe==="translucence"&&(this.line1.material.depthTest=!0,this.line2.material.depthTest=!1,this.line1.material.dashed=!0,this.line2.material.dashed=!0,this.addIfNotExists(this.line2)):(this.remove(this.line2),this.line1.material.depthTest=!0,this.line1.material.dashed=this.paramsStyle.dashed),this.doms.forEach(Ke=>Ke.intersectCheck=!Je),this.needsRender=!0}highlight(Se){var Be,De;if(this.highlighted=!0,Se!=null&&Se.color){const Ve=new Color(Se.color);this.colorBeforeHighlight=(Be=this.colorBeforeHighlight)!=null?Be:this.line1.material.three_color,this.line1.material.three_color=Ve,this.line2.material.three_color=Ve}else{this.opacityBeforeHighlight=(De=this.opacityBeforeHighlight)!=null?De:this.line1.material.opacity;const Ve=this.opacityBeforeHighlight*E$t;this.line1.material.opacity=Ve,this.line2.material.opacity=Ve}this.needsRender=!0}unhighlight(){this.highlighted&&(this.highlighted=!1,i$w(this.opacityBeforeHighlight)&&(this.line1.material.opacity=this.opacityBeforeHighlight,this.line2.material.opacity=this.line1.material.opacity,this.opacityBeforeHighlight=void 0),i$w(this.colorBeforeHighlight)&&(this.line1.material.three_color=this.colorBeforeHighlight,this.line2.material.three_color=this.colorBeforeHighlight,this.colorBeforeHighlight=void 0),this.needsRender=!0)}updateDomItems(Se){const Be=()=>{this.doms.forEach(Ve=>Ve.destroy()),this.doms=[]};if(!this.points||this.points.length<2||!this.paramsStyle.lengthEnable&&!this.paramsStyle.tip)return Be();if(!this.five)return console.error("Five not found");const De=this.points.map((Ve,Fe)=>Fe!==0?[this.points[Fe-1],Ve]:null).filter(i$w).map(Ve=>a$x(this,Ve));De.forEach(([Ve,Fe],Je)=>{var Xe;const Ke=c$J(Ve,Fe);this.doms[Je]=(Xe=this.doms[Je])!=null?Xe:(()=>{var or;const sr=new R$k(this.five),cr=(or=this.paramsStyle.occlusionVisibility)!=null?or:!0;return sr.intersectCheck=!cr,sr.simulate3D=!0,sr})(),this.doms[Je].setPosition(Ke,[Ve,Fe]);const Ye=(or,sr)=>{var cr,Br,tn;const en=(cr=sr?.force)!=null?cr:!1;if(!(this.doms[Je].__text===or&&!en))if(this.doms[Je].__text=or,or instanceof HTMLElement)this.doms[Je].container.innerHTML="",this.doms[Je].container.appendChild(or);else if(or){const an=(()=>{if(!this.five||!this.five.camera)return 0;const An=this.five.getElement();if(!An)return 0;const xn=An.clientWidth,pn=An.clientHeight,dn=xn/2,fn=pn/2,yn=Ve.clone().project(this.five.camera),Sn=Fe.clone().project(this.five.camera),gn={x:yn.x*dn,y:yn.y*fn},Cn={x:Sn.x*dn,y:Sn.y*fn};return Math.sqrt(Math.pow(Cn.x-gn.x,2)+Math.pow(Cn.y-gn.y,2))})(),rn=!this.five||!this.five.camera?20:c$J(Ve,Fe).distanceTo(this.five.camera.position),on=((tn=(Br=this.five)==null?void 0:Br.camera)==null?void 0:tn.fov)||60,sn=2*Math.tan(.5*on/180*Math.PI),ln=`--distance-scale: ${Math.max(Math.min(1-sn*rn/40,1),0)};`,cn=An=>{const xn=document.createElement("div");xn.classList.add("LineLengthTag"),xn.style.visibility="hidden",xn.style.position="absolute",xn.style.padding="2px 8px",xn.style.fontFamily="Arial-BoldMT",xn.style.fontSize="14px",xn.innerText=An,document.body.appendChild(xn);const pn=xn.offsetWidth;return document.body.removeChild(xn),pn};let hn=0;const mn=cn(or);an>0&&mn>an&&(hn=-20),this.doms[Je].container.innerHTML=c$B(or,{style:`${ln} ${this.paramsStyle.cssStyle||""}`,offsetY:hn})}else this.doms[Je].container.innerHTML=""};if(this.paramsStyle.tip)Ye(this.paramsStyle.tip,Se);else{const or=i$s(Ve.distanceTo(Fe),this.paramsStyle.lengthUnit);Ye(or||null,Se)}}),this.doms.length>De.length&&(this.doms.slice(De.length).forEach(Ve=>Ve.destroy()),this.doms.length=De.length)}}var i$r=Object.defineProperty,p$z=($e,Se,Be)=>Se in $e?i$r($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$x=($e,Se,Be)=>(p$z($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let m$w=class extends C$p{constructor(){super(...arguments),r$x(this,"isCSS3DSprite",!0),r$x(this,"isCSS3DObject",!0)}};var M$t=Object.defineProperty,v$w=Object.defineProperties,p$y=Object.getOwnPropertyDescriptors,d$B=Object.getOwnPropertySymbols,f$H=Object.prototype.hasOwnProperty,m$v=Object.prototype.propertyIsEnumerable,l$s=($e,Se,Be)=>Se in $e?M$t($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,c$z=($e,Se)=>{for(var Be in Se||(Se={}))f$H.call(Se,Be)&&l$s($e,Be,Se[Be]);if(d$B)for(var Be of d$B(Se))m$v.call(Se,Be)&&l$s($e,Be,Se[Be]);return $e},h$w=($e,Se)=>v$w($e,p$y(Se)),o$x=($e,Se,Be)=>(l$s($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const w$q=`
varying vec2 vUv;
varying float vRadius;
varying float vDistanceToCamera;
varying float vCenterDistanceToCamera;
void main() {
  vUv = uv;
  // 计算顶点到圆心的距离
  vRadius = length(position.xy);
  // 计算顶点到摄像机的距离
  vec3 worldPosition = vec3(modelViewMatrix * vec4(position, 1.0));
  vDistanceToCamera = distance(cameraPosition, worldPosition);
  vCenterDistanceToCamera = distance(cameraPosition, vec3(0.0));

  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);
}
`,y$w=`
varying vec2 vUv;
varying float vRadius;

uniform float borderWidth;
uniform float radius;

void main() {
  vec2 uv = vUv;

  if (vRadius > radius - borderWidth && vRadius < radius) {
    // 如果顶点在边框区域，则使用边框颜色
    gl_FragColor = vec4(1.0, 1.0, 1.0, 0.3);
  } else {
    // 如果顶点在填充区域，则使用填充颜色
    gl_FragColor = vec4(1.0, 1.0, 1.0, 0.2);
  }
}
`;function P$w(){const $e=new CircleGeometry(.2,64),Se=new ShaderMaterial({side:DoubleSide,uniforms:{borderWidth:{value:.01},radius:{value:.2}},vertexShader:w$q,fragmentShader:y$w,depthTest:!1,transparent:!0,blending:CustomBlending,blendEquation:AddEquation,blendSrc:DstColorFactor,blendDst:SrcAlphaFactor,blendDstAlpha:DstAlphaFactor});return new Mesh($e,Se)}function b$s(){const $e=new Group$1,Se={lineWidth:1,lineColor:3407837,lineOpacity:.7,occlusionVisibility:!0},Be=new Oe(h$w(c$z({points:[{x:-.5},{x:.5}]},Se),{lineColor:3407837})),De=new Oe(h$w(c$z({points:[{y:-.5},{y:.5}]},Se),{lineColor:3407837}));return $e.add(Be,De),$e}function V$c($e){const Se=new CurvePath;Se.add(new LineCurve3(new Vector3(0,0,0),new Vector3(0,0,$e)));const Be=new TubeGeometry(Se,32,.003),De=new MeshBasicMaterial({color:10994687,depthTest:!1,transparent:!0});return new Mesh(Be,De)}function C$n(){const $e=new RingGeometry(.03,.035,64),Se=new MeshBasicMaterial({color:16777215,depthTest:!1,transparent:!0,side:DoubleSide});return new Mesh($e,Se)}function x$s(){const $e=new SphereGeometry(.018,32,32),Se=new MeshBasicMaterial({color:5085183,depthTest:!1,transparent:!0});return new Mesh($e,Se)}function S$r(){const $e=document.createElement("img");$e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAVCAMAAAB8FU7dAAAAw1BMVEUAAACDuuiAsu11q/x8r/+HxtKHxtKIx9J4ut6Hx9Jcn/uNwNlmmf+RuP9ppf9orel3ud2HxtJrpf9oremev/9ppP9orelQmP9ZoPWSuP92q/9cnv9prel4ut53qv9orelYoPWIxdJPmP+HxtGRuP9oo/+Suf9Qmf92q/+RuP+DsP9Pmv+FxdFtre2SyMiRuP9PmP+evv9ppf9cnv+rxf9orepZofV4ut52q/+Dsf+Esv+5y/93q/9aofbF0f93rP9qpf8IzZ1iAAAAL3RSTlMAEg4s3dK5nodgVQoF/Pf39vbt7evr39rV1NTOzs6srJ+fiIZ9fWlpW09ERCwcHMH8LhIAAADRSURBVBjTjdDHkoMwEIThBrzOm3POOQwSYCRhe/f9n2p75FD2zX/VXL5qOAjzkixLsFL6fOFF5PwpXUj/eEwx7Oh9Jq+FdV5MqZkXlU9K4KZsmqY02x/A8LSwv14o0ylJWkP087WVhDfcjmjj5b/E3+CEpDPdGY58C7tKfzSiiA9uB4dV/NIF7yVQ7AGuq0lOIzrvnLP2Et2aMzUqryge8FVX0Zjl5XkG3KsR593pM2zVEScjvbMU7IdGjF19IzZ43Ceyve4Ai5Jep93u9BJs3j/gXjHbRgy31AAAAABJRU5ErkJggg==";const Se=new m$w($e);return $e.style.pointerEvents="none",Se.scale.set(.003,.003,.003),Se}let E$r=class extends Object3D{constructor(Se){super(),o$x(this,"disableGetPixel",!0),o$x(this,"planeMesh"),o$x(this,"ringMesh"),o$x(this,"crossline"),o$x(this,"lineMesh"),o$x(this,"ballMesh"),o$x(this,"cssBallMesh");const Be=.18;this.planeMesh=P$w(),this.ringMesh=C$n(),this.crossline=b$s(),this.lineMesh=V$c(Be),this.ballMesh=x$s(),this.cssBallMesh=S$r(),this.ballMesh.position.setZ(Be),this.cssBallMesh.position.setZ(Be),this.planeMesh.renderOrder=0,this.ringMesh.renderOrder=1,this.crossline.renderOrder=2,this.lineMesh.renderOrder=3,this.ballMesh.renderOrder=4,this.add(this.planeMesh,this.lineMesh,this.ballMesh,this.ringMesh,this.cssBallMesh),E$u(Se)}updateWithIntersect(Se){if(!Se.face)return;const Be=(()=>{const Ve=Se.face.normal.clone().normalize();return Ve.y>.99?new Vector3(0,1,0):Ve.y<-.99?new Vector3(0,-1,0):Ve.x>.99?new Vector3(1,0,0):Ve.x<-.99?new Vector3(-1,0,0):Ve.z>.99?new Vector3(0,0,1):Ve.z<-.99?new Vector3(0,0,-1):Ve.y<.01&&Ve.y>-.01?new Vector3(Ve.x,0,Ve.z):Ve})(),De=new Vector3().addVectors(Se.point,Be);this.position.copy(Se.point),this.lookAt(De)}show(){this.visible=!0,this.add(this.cssBallMesh)}hide(){this.visible=!1,this.remove(this.cssBallMesh)}dispose(){}};const o$w="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;var u$x=Object.defineProperty,m$u=Object.defineProperties,d$A=Object.getOwnPropertyDescriptors,c$y=Object.getOwnPropertySymbols,p$x=Object.prototype.hasOwnProperty,y$v=Object.prototype.propertyIsEnumerable,s$j=($e,Se,Be)=>Se in $e?u$x($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,l$r=($e,Se)=>{for(var Be in Se||(Se={}))p$x.call(Se,Be)&&s$j($e,Be,Se[Be]);if(c$y)for(var Be of c$y(Se))y$v.call(Se,Be)&&s$j($e,Be,Se[Be]);return $e},a$v=($e,Se)=>m$u($e,d$A(Se));function w$p($e,Se,Be){return V$b($e,Se)}function f$G($e,Se=3){const Be=new Vector3().addVectors($e.ray.origin,$e.ray.direction.clone().normalize().multiplyScalar(Se)),De=$e.ray.direction.clone().negate();return{distance:Se,point:Be,object:new Object3D,face:new Face3(0,0,0,De),raycaster:$e,isVirtual:!0}}function V$b($e,Se){const Be=l$w($e).intersectRaycaster(Se)[0];if(Be)return a$v(l$r({},Be),{raycaster:Se,isVirtual:!1})}function m$t($e,Se){const{x:Be,y:De}=Se,Ve=Be*2-1,Fe=De*2-1,Je=new Raycaster;return Je.setFromCamera({x:Ve,y:Fe},$e.camera),Je.params.Points.threshold=.02,Je}const e$f=`url("data:image/svg+xml,%3Csvg width='12px' height='12px' viewBox='0 0 12 12' xmlns='http://www.w3.org/2000/svg'%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cpath d='M6,12 C9.3137085,12 12,9.3137085 12,6 C12,2.6862915 9.3137085,0 6,0 C2.6862915,0 0,2.6862915 0,6 C0,9.3137085 2.6862915,12 6,12 Z' fill='%23FF5959'%3E%3C/path%3E%3Cg transform='translate(2, 2)' stroke='%23FFFFFF'%3E%3Ccircle cx='4' cy='4' r='4'%3E%3C/circle%3E%3Cline x1='1.07141075' y1='1.23997894' x2='6.64700843' y2='6.81557662'%3E%3C/line%3E%3C/g%3E%3C/g%3E%3C/svg%3E") 6 6, auto`,u$w=new Vector3;function w$o($e){const{raycaster:Se,line:Be,clampToLine:De=!0}=$e,Ve=new Plane().setFromNormalAndCoplanarPoint(Se.ray.direction.clone().normalize(),new Vector3),Fe=Ve.projectPoint(Be.start,new Vector3),Je=Ve.projectPoint(Be.end,new Vector3),Xe=new Line3(Fe,Je),Ke=Xe.closestPointToPoint(Se.ray.origin,De,u$w),Ye=Ke.distanceTo(Je),or=Ke.distanceTo(Fe),sr=Xe.distance();if(Ye>or&&Ye>sr){const cr=-Ke.distanceTo(Fe)/sr,Br=Be.start.clone().sub(Be.end).normalize();return Be.start.clone().sub(Br.clone().multiplyScalar(cr*Be.distance()))}else{const cr=Ke.distanceTo(Fe)/sr;return new Vector3().lerpVectors(Be.start,Be.end,cr)}}var $$b=Object.defineProperty,_$h=Object.defineProperties,k$m=Object.getOwnPropertyDescriptors,R$m=Object.getOwnPropertySymbols,P$v=Object.prototype.hasOwnProperty,L$l=Object.prototype.propertyIsEnumerable,C$m=($e,Se,Be)=>Se in $e?$$b($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,g$B=($e,Se)=>{for(var Be in Se||(Se={}))P$v.call(Se,Be)&&C$m($e,Be,Se[Be]);if(R$m)for(var Be of R$m(Se))L$l.call(Se,Be)&&C$m($e,Be,Se[Be]);return $e},v$v=($e,Se)=>_$h($e,k$m(Se)),n$q=($e,Se,Be)=>(C$m($e,typeof Se!="symbol"?Se+"":Se,Be),Be),l$q=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const J$i=3,G$f="CSS3DRenderer",f$F=`${G$f}@${J$i}`,S$q=()=>{console.error(`${f$F} is disposed`)},i$q={css3DObjects:[],frontModeStore:{css3DRenderer:new W$f},behindModeStore:{css3DRenderer:new W$f}};function w$n($e){return i$q.css3DObjects.find(Se=>Se.id===$e)}function K$h($e){i$q.frontModeStore.css3DRenderer.setWrapper($e)}function Q$d($e){i$q.behindModeStore.css3DRenderer.setWrapper($e)}let y$u=class{constructor(Se){n$q(this,"hooks",new E$v),n$q(this,"state",{enabled:!0,visible:!0,disposed:!1}),n$q(this,"_scene"),n$q(this,"store",{frontModeGroup:new c$D}),n$q(this,"create3DElement",(Be,De,Ve)=>{if(this.state.disposed)return S$q();const Fe=(()=>{const hn={ratio:.00216,devicePixelRatio:1,mode:"front",autoRender:!0,container:document.createElement("div"),pointerEvents:"none",wrapperStyle:{}};return Object.assign(hn,Ve)})(),Je=De.map(t$j);if(Je?.length<4)return console.error(`${f$F}: requires 4 point but params may have fewer`);const{ratio:Xe,devicePixelRatio:Ke,mode:Ye,autoRender:or,container:sr,pointerEvents:cr,wrapperStyle:Br}=Fe;let tn=!1;const en=this.createObject(Je,{ratio:Xe,dpr:Ke,container:sr,mode:Ye,pointerEvents:cr,wrapperStyle:Br});i$q.css3DObjects.push(en),Fe.scene&&this.setScene(Fe.scene);const an=()=>{if(tn)return;const hn=en.mode==="front"?this.getFrontCSS3DObjectGroup():this.getBehindCSS3DObjectGroup();hn&&hn.add(en)},rn=()=>{tn||(an(),this.render(Be),this.hooks.emit("render"))},on=hn=>this.setVisibleById(en.id,hn),sn=hn=>this.setEnabledById(en.id,hn),ln=()=>(tn=!0,en.removeFromParent(),!0),cn=Ye==="front"?i$q.frontModeStore.css3DRenderer:i$q.behindModeStore.css3DRenderer;return or&&rn(),{id:en.uuid,container:sr,css3DObject:en,render:or?void 0:rn,show:()=>on(!0),hide:()=>on(!1),setVisible:on,enable:()=>sn(!0),disable:()=>sn(!1),setEnabled:sn,dispose:ln,appendToElement:hn=>cn.setWrapper(hn)}}),n$q(this,"setVisibleById",(Be,De)=>{var Ve;(Ve=w$n(Be))==null||Ve.setVisible(De)}),n$q(this,"setEnabledById",(Be,De)=>{const Ve=w$n(Be);if(!Ve)return;const Fe=Ve.mode==="front"?this.getFrontCSS3DObjectGroup({addGroupIfNotExists:!1}):this.getBehindCSS3DObjectGroup({addGroupIfNotExists:!1});Fe&&(De?Fe.add(Ve):Fe.remove(Ve))}),n$q(this,"createObject",(Be,De)=>{const Ve=new ti(v$v(g$B({cornerPoints:Be},De),{style:De.wrapperStyle}));return Ve.element.classList.add(`${G$f}__container`),Ve.element.id=`${G$f}__container--${Ve.uuid}`,Ve}),Se&&this.setScene(Se)}get scene(){return this._scene||console.error("scene doesn't exist!, please call setScene(scene) first"),this._scene}static get frontModeCSS3DRenderer(){return i$q.frontModeStore.css3DRenderer}static get behindModeCSS3DRenderer(){return i$q.behindModeStore.css3DRenderer}get frontModeCSS3DRenderer(){return i$q.frontModeStore.css3DRenderer}get behindModeCSS3DRenderer(){return i$q.behindModeStore.css3DRenderer}setScene(Se){this._scene=Se}getCurrentState(){return this.state}setState(Se,Be={userAction:!0}){if(this.state.disposed)return S$q();const De=g$B({},this.state);this.state=Object.assign(this.state,Se),De.visible!==this.state.visible&&(Se.visible?this.handleShow():this.handleHide()),De.enabled!==this.state.enabled&&(Se.enabled?this.handleEnable():this.handleDisable()),De.disposed!==this.state.disposed&&this.handleDispose(),this.hooks.emit("stateChange",{state:this.state,prevState:De,userAction:Be.userAction})}dispose(){this.setState({disposed:!0}),this.hooks.emit("dispose")}show(){return l$q(this,arguments,function*({userAction:Se}={userAction:!0}){if(this.state.disposed)return S$q();this.setState({visible:!0},{userAction:Se}),this.hooks.emit("show",{userAction:Se})})}hide(){return l$q(this,arguments,function*({userAction:Se}={userAction:!0}){if(this.state.disposed)return S$q();this.setState({visible:!1},{userAction:Se}),this.hooks.emit("hide",{userAction:Se})})}enable({userAction:Se}={userAction:!0}){if(this.state.disposed)return S$q();this.setState({enabled:!0},{userAction:Se}),this.hooks.emit("enable",{userAction:Se})}disable({userAction:Se}={userAction:!0}){if(this.state.disposed)return S$q();this.setState({enabled:!1},{userAction:Se}),this.hooks.emit("disable",{userAction:Se})}getFrontCSS3DScene({createSceneIfNotExists:Se=!1}={}){var Be;const De=(Be=i$q.frontModeStore)==null?void 0:Be.css3DScene;if(De)return De;if(Se){const Ve=new m$z;i$q.frontModeStore.css3DScene=Ve}return i$q.frontModeStore.css3DScene}getBehindCSS3DScene({createSceneIfNotExists:Se=!1}={}){var Be,De;const Ve=(Be=i$q.behindModeStore)==null?void 0:Be.css3DScene;if(Ve)return Ve;if(Se){const Fe=(De=i$q.behindModeStore.scene)!=null?De:this.scene;if(!Fe){console.error(`${f$F}: scene is required when mode is behind`);return}const Je=new u$y(Fe);i$q.behindModeStore.css3DScene=Je,i$q.behindModeStore.scene=Fe}return i$q.behindModeStore.css3DScene}getFrontCSS3DObjectGroup({addGroupIfNotExists:Se=!0}={}){const Be=this.getFrontCSS3DScene({createSceneIfNotExists:Se});return Se&&Be&&(Be.getObjectById(this.store.frontModeGroup.id)||Be.add(this.store.frontModeGroup)),this.store.frontModeGroup}getBehindCSS3DObjectGroup({addGroupIfNotExists:Se=!0}={}){var Be;const De=this.getBehindCSS3DScene({createSceneIfNotExists:Se});if(Se&&De&&this.scene){const Ve=(Be=this.store.behindModeGroup)!=null?Be:new m$y(this.scene);this.store.behindModeGroup=Ve,De.getObjectById(Ve.id)||De.add(Ve)}return this.store.behindModeGroup}render(Se){var Be,De;if(this.getFrontCSS3DObjectGroup({addGroupIfNotExists:!1}).CSS3DObjectLength>0){const Ve=this.getFrontCSS3DScene({createSceneIfNotExists:!0});if(!Ve)return console.error(`${f$F}: css3DScene is required when mode is front`);i$q.frontModeStore.css3DRenderer.renderEveryFrame(Ve,Se)}if(((De=(Be=this.getBehindCSS3DObjectGroup({addGroupIfNotExists:!1}))==null?void 0:Be.CSS3DObjectLength)!=null?De:0)>0){const Ve=this.getBehindCSS3DScene({createSceneIfNotExists:!0});if(!Ve)return console.error(`${f$F}: css3DScene is required when mode is behind`);i$q.behindModeStore.css3DRenderer.renderEveryFrame(Ve,Se)}}handleShow(){return l$q(this,null,function*(){var Se;this.store.frontModeGroup.setVisible(!0),(Se=this.store.behindModeGroup)==null||Se.setVisible(!0)})}handleHide(){return l$q(this,null,function*(){var Se;this.store.frontModeGroup.setVisible(!1),(Se=this.store.behindModeGroup)==null||Se.setVisible(!1)})}handleEnable(){var Se,Be;(Se=this.getFrontCSS3DScene())==null||Se.add(this.store.frontModeGroup),this.store.behindModeGroup&&((Be=this.getBehindCSS3DScene())==null||Be.add(this.store.behindModeGroup))}handleDisable(){var Se,Be,De;this.store.frontModeGroup.children.forEach(Ve=>{Ve instanceof c$I&&Ve.element instanceof Element&&Ve.element.parentNode!==null&&Ve.element.remove()}),(Se=this.store.behindModeGroup)==null||Se.children.forEach(Ve=>{Ve instanceof c$I&&Ve.element instanceof Element&&Ve.element.parentNode!==null&&Ve.element.remove()}),(Be=this.getFrontCSS3DScene())==null||Be.remove(this.store.frontModeGroup),this.store.behindModeGroup&&((De=this.getBehindCSS3DScene())==null||De.remove(this.store.behindModeGroup))}handleDispose(){this.handleDisable()}};n$q(y$u,"setFrontModeContainer",K$h),n$q(y$u,"setBehindModeContainer",Q$d);var A$v=Object.defineProperty,D$p=($e,Se,Be)=>Se in $e?A$v($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,o$v=($e,Se,Be)=>(D$p($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const $$a=1,W$e=`CSS3DObjectPlus@${$$a}`,k$l=.00216,z$k=.003;class ti extends c$I{constructor(Se){var Be,De,Ve,Fe,Je;if(t$e(Se.cornerPoints)&&t$e(Se.width))throw new Error("cornerPoints and width cannot be both empty");const Xe=(Be=Se.container)!=null?Be:document.createElement("div"),Ke=(De=Se.cornerPoints)!=null?De:(()=>{const xn=Se.width/2;return[new Vector3(-xn,xn,0),new Vector3(-xn,-xn,0),new Vector3(xn,-xn,0),new Vector3(xn,xn,0)]})(),Ye=(Ve=Se.ratio)!=null?Ve:z$k,or=(Fe=Se.dpr)!=null?Fe:1,sr=(Je=Se.pointerEvents)!=null?Je:"auto",cr=Math.max(k$l,Ye),Br=Ke[0].distanceTo(Ke[1]),tn=Ke[1].distanceTo(Ke[2]),en=t$f(Br/Ye*or),an=t$f(tn/Ye*or),rn=c$J(...Ke);let on;if(cr===Ye)Xe.style.width=`${en}px`,Xe.style.height=`${an}px`,on=Xe;else{const xn=document.createElement("div");xn.style.width=`${en}px`,xn.style.height=`${an}px`,xn.style.pointerEvents="none";const pn=Ye/cr;Xe.style.position="absolute",Xe.style.left="0",Xe.style.top="0",Xe.style.width=`${pn*en}px`,Xe.style.height=`${pn*an}px`,xn.appendChild(Xe),on=xn}if(super(on),o$v(this,"version",$$a),o$v(this,"isCSS3DObjectPlus",!0),o$v(this,"isCSS3DObject",!0),o$v(this,"name",W$e),o$v(this,"container"),o$v(this,"width"),o$v(this,"height"),o$v(this,"domWidthPx"),o$v(this,"domHeightPx"),o$v(this,"cornerPoints"),o$v(this,"centerPosition"),o$v(this,"ratio"),o$v(this,"mode","front"),o$v(this,"hooks",new E$v),o$v(this,"opacityMesh"),o$v(this,"selfVisible",!0),o$v(this,"setVisible",xn=>{this.selfVisible=xn,this.visible=r$D(this.parent)&&this.selfVisible,this.opacityMesh&&(this.opacityMesh.visible=this.visible)}),o$v(this,"updateVisible",()=>{this.setVisible(this.selfVisible)}),o$v(this,"createOpacityMesh",xn=>{const{domWidthPx:pn,domHeightPx:dn}=xn,fn=new p$B(pn,dn);return fn.position.copy(xn.position),fn.rotation.copy(xn.rotation),fn.scale.copy(xn.scale),fn}),Xe.style.pointerEvents=sr,Object.assign(Xe.style,Se.style),this.scale.set(cr,cr,cr),this.cornerPoints=Ke,this.ratio=Ye,this.container=Xe,Se.mode&&(this.mode=Se.mode),cr===Ye)this.width=Br,this.height=tn,this.domWidthPx=en,this.domHeightPx=an,this.centerPosition=rn;else{const xn=Ye/cr;this.width=xn*Br,this.height=xn*tn,this.domWidthPx=xn*en,this.domHeightPx=xn*an,this.centerPosition=new Vector3().subVectors(rn,Ke[0]).multiplyScalar(xn).add(Ke[0])}Xe.classList.add(`${W$e}__container`);const sn=new Vector3().subVectors(Ke[1],Ke[0]),ln=new Vector3().subVectors(Ke[3],Ke[0]),cn=new Vector3().crossVectors(sn,ln).normalize();this.lookAt(cn);const hn=this.up.clone().applyQuaternion(this.quaternion),mn=ln.clone(),An=new Vector3().crossVectors(hn,mn).normalize();this.rotateOnWorldAxis(An,hn.angleTo(mn)),this.position.copy(rn),this.addEventListener("added",()=>{var xn;this.mode==="front"&&((xn=this.opacityMesh)==null||xn.removeFromParent())}),this.addEventListener("removed",()=>{var xn;(xn=this.opacityMesh)==null||xn.removeFromParent()})}removeFromParent(){var Se;const Be=this.parent;return Be!==null&&Be.remove(this),(Se=this.opacityMesh)==null||Se.removeFromParent(),this}removeOpacityMesh(){var Se;return(Se=this.opacityMesh)==null||Se.removeFromParent(),this.opacityMesh=void 0,this}dispose(){var Se;this.container.remove(),this.removeFromParent(),(Se=this.opacityMesh)==null||Se.removeFromParent()}getOpacityMesh(){if(this.opacityMesh)return this.opacityMesh;{const Se=this.createOpacityMesh(this);return this.opacityMesh=Se,Se}}applyMatrix4(Se){var Be;super.applyMatrix4(Se),(Be=this.opacityMesh)==null||Be.applyMatrix4(Se)}applyQuaternion(Se){var Be;return super.applyQuaternion(Se),(Be=this.opacityMesh)==null||Be.applyQuaternion(Se),this}applyScaleMatrix4(Se){var Be;this.scale.applyMatrix4(Se),(Be=this.opacityMesh)==null||Be.scale.applyMatrix4(Se)}}var a$u=Object.defineProperty,h$v=($e,Se,Be)=>Se in $e?a$u($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,n$p=($e,Se,Be)=>(h$v($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const M$s=`
varying vec2 vUv;
void main() {
  vUv = uv;
  vec4 mvPosition = modelViewMatrix * vec4(position, 1);
  gl_Position = projectionMatrix * mvPosition;
}
`,u$v=`
varying vec2 vUv;
void main() {
  vec2 uv = vec2(vUv.x, vUv.y);
  float a = 1.0;
  float match = 1.0 - uv.x;
  gl_FragColor = vec4(1.0,1.0,1.0,match);
}
`;function v$u(){const $e=new PlaneGeometry(.4,.4),Se=A$y,Be=new TextureLoader$1().load(Se);Be.encoding=sRGBEncoding,Be.minFilter=LinearFilter;const De=new MeshBasicMaterial({map:Be,transparent:!0,depthTest:!1});return new Mesh($e,De)}function m$s(){const $e=new CurvePath;$e.add(new LineCurve3(new Vector3(0,0,0),new Vector3(0,0,.1)));const Se=new TubeGeometry($e,8,.003),Be=new ShaderMaterial({vertexShader:M$s,fragmentShader:u$v,depthTest:!1,transparent:!0});return new Mesh(Se,Be)}function b$r(){const $e=new SphereGeometry(.01,20,20),Se=new MeshBasicMaterial({color:10349931,depthTest:!1,transparent:!0,side:DoubleSide}),Be=new Mesh($e,Se);return Be.position.set(0,0,.1),Be}function w$m(){const $e=new ti({pointerEvents:"none",cornerPoints:[new Vector3(-.2,.2,0),new Vector3(-.2,-.2,0),new Vector3(.2,-.2,0),new Vector3(.2,.2,0)]}),Se=document.createElement("div");return Se.style.width="100%",Se.style.height="100%",Se.style.backgroundImage=`url(${A$x})`,Se.style.backgroundSize="100%",Se.style.backgroundRepeat="no-repeat",$e.container.appendChild(Se),$e}let T$l=class extends Object3D{constructor(Se){super(),n$p(this,"planeMesh"),n$p(this,"lineMesh"),n$p(this,"ballMesh"),n$p(this,"borderMesh"),n$p(this,"five"),this.planeMesh=v$u(),this.lineMesh=m$s(),this.ballMesh=b$r(),this.borderMesh=w$m(),this.addEventListener("added",()=>{this.add(this.planeMesh,this.lineMesh,this.ballMesh,this.borderMesh)}),this.addEventListener("removed",()=>{this.remove(this.planeMesh,this.lineMesh,this.ballMesh,this.borderMesh)}),E$u(Se),this.five=Se}updateWithIntersect(Se){var Be;const De=(Be=Se?.face)!=null&&Be.normal?new Vector3().addVectors(Se.point,Se.face.normal):this.five.camera.position;this.position.copy(Se.point),this.lookAt(De)}show(){this.visible=!0,this.borderMesh.parent||this.add(this.borderMesh)}hide(){this.visible=!1,this.remove(this.borderMesh)}dispose(){var Se;(Se=this.planeMesh.material.map)==null||Se.dispose()}};var d$z=Object.defineProperty,m$r=($e,Se,Be)=>Se in $e?d$z($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,t$a=($e,Se,Be)=>(m$r($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let T$k=class{constructor(Se,Be){t$a(this,"five"),t$a(this,"hooks",new E$v),t$a(this,"position",null),t$a(this,"magnifier",null),t$a(this,"pointHelper",null),t$a(this,"state",{enabled:!1,visible:!0}),t$a(this,"group",new Group$1),t$a(this,"show",()=>{var Ye,or;this.state.visible||(this.state.visible=!0,(Ye=this.pointHelper)==null||Ye.show(),(or=this.magnifier)==null||or.enable(),this.five.needsRender=!0)}),t$a(this,"hide",()=>{var Ye,or;this.state.visible&&(this.state.visible=!1,(Ye=this.pointHelper)==null||Ye.hide(),(or=this.magnifier)==null||or.disable(),this.five.needsRender=!0)}),t$a(this,"updateWithIntersect",(Ye,or={emitEvent:!0})=>{var sr;if(!Ye)return;this.abortUpdateMagnifier(),this.position=Ye,or.emitEvent&&this.hooks.emit("intersectionUpdate",Ye),(sr=this.pointHelper)==null||sr.updateWithIntersect(Ye);const cr=()=>{var Br;return(Br=this.magnifier)==null?void 0:Br.renderWithPoint(Ye.point)};this.abortUpdateMagnifier=()=>this.five.off("renderFrame",cr),this.five.once("renderFrame",cr),this.five.needsRender=!0}),t$a(this,"abortUpdateMagnifier",()=>{});var De,Ve,Fe,Je,Xe;this.five=Se,this.magnifier=Be?.magnifier!==void 0?Be.magnifier:new S$u(Se,(De=Be?.magnifierParams)!=null?De:{dragEnabled:!0});let Ke;Be?.pointHelper==="default"||Be?.pointHelper===void 0?Ke=new T$l(Se):Be?.pointHelper==="highlight"?Ke=new E$r(Se):Ke=Be.pointHelper,this.pointHelper=Ke,this.group.name="five-point-selector",this.five.scene.add(this.group),(Xe=this.magnifier)==null||Xe.appendTo((Je=(Fe=Be.container)!=null?Fe:(Ve=Se.getElement())==null?void 0:Ve.parentElement)!=null?Je:document.body)}enable(){var Se;this.state.enabled||(this.state.enabled=!0,this.pointHelper&&this.group.add(this.pointHelper),(Se=this.magnifier)==null||Se.enable(),this.five.needsRender=!0,this.hooks.emit("enabled"))}disable(){var Se;this.state.enabled&&(this.state.enabled=!1,this.pointHelper&&this.group.remove(this.pointHelper),(Se=this.magnifier)==null||Se.disable(),this.hooks.emit("disabled"))}dispose(){this.hooks.off(),this.disable(),this.magnifier=null,this.pointHelper=null}};var R$l=Object.defineProperty,O$j=Object.defineProperties,X$a=Object.getOwnPropertyDescriptors,N$g=Object.getOwnPropertySymbols,Y$d=Object.prototype.hasOwnProperty,B$p=Object.prototype.propertyIsEnumerable,E$q=($e,Se,Be)=>Se in $e?R$l($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,P$u=($e,Se)=>{for(var Be in Se||(Se={}))Y$d.call(Se,Be)&&E$q($e,Be,Se[Be]);if(N$g)for(var Be of N$g(Se))B$p.call(Se,Be)&&E$q($e,Be,Se[Be]);return $e},M$r=($e,Se)=>O$j($e,X$a(Se)),i$p=($e,Se,Be)=>(E$q($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const _$g=new Vector3,w$l=()=>!1;let se$3=class extends E$v{constructor(Se,Be){var De,Ve,Fe,Je;super(),i$p(this,"_cursorError",!1),i$p(this,"actionIfNoIntersection","virtualPoint"),i$p(this,"plane"),i$p(this,"planeMode","onlyVirtual"),i$p(this,"pointSelectorHelper"),i$p(this,"five"),i$p(this,"hook",this),i$p(this,"adhereEnabled",!0),i$p(this,"adhereRadius",.1),i$p(this,"adherePlane",[]),i$p(this,"adhereLine",[]),i$p(this,"_outOfFive",!1),i$p(this,"_enabled",!1),i$p(this,"mode"),i$p(this,"pressDown",!1),i$p(this,"adherePoints"),i$p(this,"setPressDown"),i$p(this,"lastFiveHelperVisible"),i$p(this,"lastIntersection"),i$p(this,"mousePosition"),i$p(this,"_mouseDownInfo"),i$p(this,"_touchStartInfo"),i$p(this,"config",{}),i$p(this,"select",Ye=>{Ye&&this.updatePointSelectorHelperIntersect(Ye);const or=this.emit("wantsSelect",this.position);return or||(this.pointSelectorHelper.hide(),this.emit("select",this.position),console.debug(this.position)),!or}),i$p(this,"onKeyDown",Ye=>{Ye.key==="Shift"&&(this.adhereEnabled=!1)}),i$p(this,"onKeyUp",Ye=>{Ye.key==="Shift"&&(this.adhereEnabled=!0)}),i$p(this,"onMouseWheel",Ye=>{this.updateByMousePosition(Ye);const or=()=>this.updateByMousePosition();this.five.off("render.prepare",or),this.five.on("render.prepare",or),setTimeout(()=>{this.five.off("render.prepare",or)},200)}),i$p(this,"onEnter",()=>{this.cursorError||this.pointSelectorHelper.show(),this.outOfFive=!1}),i$p(this,"onMouseEnter",()=>{this.onEnter(),this.emit("intersectionUpdate",this.position)}),i$p(this,"onMouseLeave",()=>{this.pointSelectorHelper.hide(),this.outOfFive=!0,this.emit("intersectionUpdate",void 0)}),i$p(this,"onMouseDown",Ye=>{this._mouseDownInfo={clientX:Ye.clientX,clientY:Ye.clientY,timestamp:performance.now()}}),i$p(this,"onMouseUp",Ye=>{if(!this._mouseDownInfo)return;const{clientX:or,clientY:sr,timestamp:cr}=this._mouseDownInfo;Math.abs(Ye.clientX-or)<2&&Math.abs(Ye.clientY-sr)<2&&performance.now()-cr<500?this.select():this._mouseDownInfo=null}),i$p(this,"onTouchStart",Ye=>{this._touchStartInfo={clientX:Ye.touches[0].clientX,clientY:Ye.touches[0].clientY,timestamp:performance.now()},this.setPressDown=setTimeout(()=>{if(this.setPressDown=void 0,this.mousePosition={clientX:Ye.touches[0].clientX,clientY:Ye.touches[0].clientY},!this.mouseNdcPosition)return;const or=this.updateByNdcPosition(this.mouseNdcPosition);this.pressDown=or},200)}),i$p(this,"onTouchMove",Ye=>{if(this.setPressDown){let or=!1;if(this._touchStartInfo){const{clientX:sr,clientY:cr}=this._touchStartInfo;(Math.abs(Ye.touches[0].clientX-sr)>2||Math.abs(Ye.touches[0].clientY-cr)>2)&&(or=!0)}or&&(clearTimeout(this.setPressDown),this.setPressDown=void 0);return}if(this.pressDown){if(this.mousePosition={clientX:Ye.touches[0].clientX,clientY:Ye.touches[0].clientY},!this.mouseNdcPosition)return;this.updateByNdcPosition(this.mouseNdcPosition)}}),i$p(this,"onTouchEnd",Ye=>{if(this.setPressDown){clearTimeout(this.setPressDown),this.setPressDown=void 0;return}this.pressDown&&(setTimeout(()=>{this.pressDown=!1},100),this.select())}),i$p(this,"updateByMousePosition",Ye=>{if(this.five.getElement()){if(!Ye||Ye?.buttons!==0){this.pointSelectorHelper.hide();return}else this.pointSelectorHelper.show();Ye&&(this.mousePosition={clientX:Ye.clientX,clientY:Ye.clientY}),this.updateByNdcPosition(this.mouseNdcPosition)}}),i$p(this,"updateByNdcPosition",Ye=>{var or,sr,cr;const Br=m$t(this.five,Ye);let tn=w$p(this.five,Br);if(tn){if(this.plane&&this.planeMode==="vertical"&&(tn=M$r(P$u({},tn),{point:this.plane.projectPoint(tn.point,new Vector3),face:new Face3(0,0,0,this.plane.normal.clone()),originalPoint:tn.point.clone()})),this.plane&&this.planeMode==="onlyPlane"){const en=Br.ray.intersectPlane(this.plane,_$g);if(!en)return!1;tn={distance:this.five.camera.position.distanceTo(en),point:en.clone(),originalPoint:tn.point.clone(),face:new Face3(0,0,0,this.plane.normal.clone()),raycaster:Br}}return this.updatePointSelectorHelperIntersect(tn),this.lastIntersection=tn,!0}if(this.plane){const en=Br.ray.intersectPlane(this.plane,_$g);if(en){const an={distance:this.five.camera.position.distanceTo(en),point:en.clone(),object:new Object3D,face:new Face3(0,0,0,this.plane.normal.clone()),raycaster:Br,isVirtual:!0};return this.updatePointSelectorHelperIntersect(an),!0}}if(this.actionIfNoIntersection==="lastPoint")return this.updatePointSelectorHelperIntersect(this.lastIntersection),!0;if(this.actionIfNoIntersection==="virtualPoint"){const en=f$G(Br,(or=this.lastIntersection)==null?void 0:or.distance);return en.face=new Face3(0,0,0,(cr=(sr=this.lastIntersection)==null?void 0:sr.face)==null?void 0:cr.normal),en.isVirtual=!0,this.lastIntersection=en,this.updatePointSelectorHelperIntersect(en),!0}else if(this.actionIfNoIntersection==="disable")return this.updatePointSelectorHelperIntersect(null),!1}),i$p(this,"updatePointSelectorHelperIntersect",Ye=>{var or,sr,cr,Br,tn,en,an,rn;if(!Ye){this.pointSelectorHelper.hide(),this.pointSelectorHelper.position=Ye,this.emit("intersectionUpdate",Ye),this.five.getElement().style.cursor=e$f;return}this.onEnter(),this.cursorError||(this.five.getElement().style.cursor="");const on=P$u({},Ye);if(this.adhereEnabled&&this.mouseNdcPosition&&this.five.renderer){const sn={x:this.mouseNdcPosition.x,y:1-this.mouseNdcPosition.y},ln=this.five.renderer.getSize(new Vector2);if(this.adhereEnabled&&typeof this.adherePoints=="function"&&typeof this.adhereRadius=="number"){for(const cn of this.adherePlane){const hn=cn.distanceToPoint(Ye.point);let mn=cn.projectPoint(Ye.point,new Vector3);(!this.plane||this.plane.distanceToPoint(mn)<.01)&&(mn=(sr=(or=this.plane)==null?void 0:or.projectPoint(mn,new Vector3))!=null?sr:mn,hn<this.adhereRadius&&(on.point=mn.clone(),on.adherePoint=mn.clone(),this.plane||(on.face=new Face3(0,0,0,cn.normal.clone())),on.isAdsorbed=!0))}for(const cn of this.adhereLine){let hn=cn.closestPointToPoint(Ye.point,!1,new Vector3);if(hn.distanceTo(Ye.point)<this.adhereRadius)(!this.plane||this.plane.distanceToPoint(hn)<.01)&&(hn=(Br=(cr=this.plane)==null?void 0:cr.projectPoint(hn,new Vector3))!=null?Br:hn,on.point=hn.clone(),on.adhereLine=cn.clone(),on.isAdsorbed=!0);else{const mn=w$o({raycaster:new h$z(this.five.camera.position,Ye.point.clone().sub(this.five.camera.position).normalize()),line:cn,clampToLine:!1}),An=mn.clone().project(this.five.camera);if(An.z<=1){const xn={x:(An.x+1)/2,y:(1-An.y)/2},pn={x:Math.abs(xn.x-sn.x)*ln.width,y:Math.abs(xn.y-sn.y)*ln.height};let dn=mn.clone();pn.x<10&&pn.y<10&&(!this.plane||this.plane.distanceToPoint(dn)<.01)&&(dn=(en=(tn=this.plane)==null?void 0:tn.projectPoint(dn,new Vector3))!=null?en:dn,on.point=dn.clone(),on.adhereLine=cn.clone(),on.isAdsorbed=!0)}}}for(const cn of this.adherePoints({intersection:Ye,pointSelectorInstance:this})){const hn=cn instanceof Face3?new Vector3(cn.a,cn.b,cn.c):cn;if(hn.IsAlwaysVisible=cn.IsAlwaysVisible,!(this.plane&&this.plane.distanceToPoint(hn)>.01))if(hn.distanceTo(Ye.point)<this.adhereRadius){on.point=(rn=(an=this.plane)==null?void 0:an.projectPoint(hn,new Vector3))!=null?rn:hn.clone(),!this.plane&&cn instanceof Face3&&(on.face=cn),on.isAdsorbed=!0;break}else{const mn=hn.clone().project(this.five.camera);if(mn.z>1)continue;const An=this.five.renderer.getSize(new Vector2),xn={x:(mn.x+1)/2,y:(1-mn.y)/2},pn={x:Math.abs(xn.x-sn.x)*An.width,y:Math.abs(xn.y-sn.y)*An.height};if(pn.x<10&&pn.y<10){let dn=!1;if(hn.IsAlwaysVisible)dn=!0;else{const fn=new Raycaster;fn.setFromCamera(hn.clone(),this.five.camera);const yn=this.five.model.intersectRaycaster(fn,void 0,!0)[0],Sn=.1,gn=this.five.camera.position.distanceTo(hn);yn&&yn.distance<gn+Sn&&(dn=!0)}if(dn){on.point=hn.clone(),!this.plane&&cn instanceof Face3&&(on.face=cn),on.isAdsorbed=!0;break}}}}}}this.pointSelectorHelper.updateWithIntersect(on,{emitEvent:!1}),this.emit("intersectionUpdate",on)}),i$p(this,"mousePositionToNdcPosition",Ye=>{const or=this.five.getElement();if(!or)return null;const{top:sr,left:cr,width:Br,height:tn}=or.getBoundingClientRect(),{clientX:en,clientY:an}=Ye;return{x:(en-cr)/Br,y:1-(an-sr)/tn}}),i$p(this,"onFiveWantsPanGesture",()=>{if(this.pressDown)return!1}),i$p(this,"renderScreenCenter",()=>{this.updateByNdcPosition({x:.5,y:.5})}),i$p(this,"emitIntersectionUpdate",Ye=>{this.emit("intersectionUpdate",Ye)}),this.five=Se,this.config=P$u(P$u({},this.config),Be),this.actionIfNoIntersection=(Ve=(De=Be?.actionIfNoIntersection)!=null?De:Be?.actionIfNoModelUnderMouse)!=null?Ve:"virtualPoint";const Xe=(Fe=Be?.mode)!=null?Fe:"auto";Xe==="auto"?this.mode=o$w?"fixed":"cursor":this.mode=Xe;const Ke={autoFixPCPosition:this.mode==="cursor",initialPosition:this.mode==="fixed"?{left:"35%",top:"20%"}:void 0};this.pointSelectorHelper=new T$k(this.five,M$r(P$u({},Be?.helper),{magnifierParams:P$u(P$u({},Ke),(Je=Be?.helper)==null?void 0:Je.magnifierParams)})),this.pointSelectorHelper.hide()}get position(){if(!this.outOfFive)return this.pointSelectorHelper.position}get outOfFive(){return this._outOfFive}get enabled(){return this._enabled}get cursorError(){return this._cursorError}set cursorError(Se){this._cursorError=Se,this.five.getElement().style.cursor=Se?e$f:"",Se?this.pointSelectorHelper.hide():this.pointSelectorHelper.show()}set outOfFive(Se){this._outOfFive=Se}set enabled(Se){this._enabled=Se}get mouseNdcPosition(){return this.mousePosition?this.mousePositionToNdcPosition(this.mousePosition):null}enable(){if(this.enabled)return;this.enabled=!0,this.outOfFive=!1,this.pointSelectorHelper.enable(),this.pointSelectorHelper.hide();const Se=this.five.getElement();if(!Se)throw new Error("five element not found");this.mode==="cursor"?(this.five.on("wantsMoveToPano",w$l),this.five.on("wantsChangeMode",w$l),this.five.on("wantsTapGesture",w$l),Se.addEventListener("touchstart",this.onTouchStart,{passive:!0}),Se.addEventListener("touchmove",this.onTouchMove),Se.addEventListener("touchend",this.onTouchEnd),Se.addEventListener("mousedown",this.onMouseDown),Se.addEventListener("mouseup",this.onMouseUp),Se.addEventListener("mousemove",this.updateByMousePosition),Se.addEventListener("wheel",this.onMouseWheel),Se.addEventListener("mouseenter",this.onMouseEnter),Se.addEventListener("mouseout",this.onMouseLeave),this.five.on("wantsPanGesture",this.onFiveWantsPanGesture)):this.mode==="fixed"&&(this.five.on("panoArrived",this.renderScreenCenter),this.five.on("panGesture",this.renderScreenCenter),this.five.on("interiaPan",this.renderScreenCenter),this.renderScreenCenter(),this.pointSelectorHelper.show()),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),this.pointSelectorHelper.hooks.on("intersectionUpdate",this.emitIntersectionUpdate),this.lastFiveHelperVisible=this.five.helperVisible,this.five.helperVisible=!1,this.emit("enable")}disable(){if(!this.enabled)return;this.enabled=!1,this.adherePoints=null,this.adhereLine=[],this.adherePlane=[],this.plane=void 0,this.pointSelectorHelper.disable(),this.five.getElement().style.cursor="";const Se=this.five.getElement();this.five.off("wantsPanGesture",this.onFiveWantsPanGesture),this.five.off("wantsMoveToPano",w$l),this.five.off("wantsChangeMode",w$l),this.five.off("wantsTapGesture",w$l),this.five.helperVisible=this.lastFiveHelperVisible,Se?.removeEventListener("touchstart",this.onTouchStart),Se?.removeEventListener("touchmove",this.onTouchMove),Se?.removeEventListener("touchend",this.onTouchEnd),Se?.removeEventListener("mousedown",this.onMouseDown),Se?.removeEventListener("mouseup",this.onMouseUp),Se?.removeEventListener("mousemove",this.updateByMousePosition),Se?.removeEventListener("wheel",this.onMouseWheel),Se?.removeEventListener("mouseenter",this.onMouseEnter),Se?.removeEventListener("mouseout",this.onMouseLeave),this.five.off("panoArrived",this.renderScreenCenter),this.five.off("panGesture",this.renderScreenCenter),this.five.off("interiaPan",this.renderScreenCenter),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),this.pointSelectorHelper.hooks.off("intersectionUpdate",this.emitIntersectionUpdate),this.emit("disable")}dispose(){this.disable(),this.pointSelectorHelper.dispose()}setAdherePoints(Se,Be){Se?typeof Se=="function"?this.adherePoints=Se:this.adherePoints=()=>Se:this.adherePoints=null}};var P$t=Object.defineProperty,C$l=($e,Se,Be)=>Se in $e?P$t($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$w=($e,Se,Be)=>(C$l($e,typeof Se!="symbol"?Se+"":Se,Be),Be),u$u=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const M$q=new Vector2;let R$k=class{constructor(Se,Be,De){r$w(this,"container"),r$w(this,"visible",!1),r$w(this,"enabled",!1),r$w(this,"visibles",[]),r$w(this,"wrapper"),r$w(this,"positionsForRotate"),r$w(this,"intersectCheck",!0),r$w(this,"extraObjectsForIntersectCheck",[]),r$w(this,"simulate3D",!1),r$w(this,"tagWrapper"),r$w(this,"five"),r$w(this,"originPosition"),r$w(this,"transformedPosition"),r$w(this,"disposer"),r$w(this,"config"),r$w(this,"fiveUtil"),r$w(this,"disposers",[]),r$w(this,"onModeChange",()=>{this.visibles[3]=void 0,this.updateVisible()}),r$w(this,"onPanoArrived",()=>{this.visibles[3]=void 0,this.updateVisible()}),r$w(this,"onCameraUpdate",()=>{this.visible!==!1&&this.updateScreenPosition()}),r$w(this,"onCameraFovUpdate",()=>{this.onCameraUpdate(),this.five.off("render.prepare",this.onCameraUpdate),this.five.on("render.prepare",this.onCameraUpdate),setTimeout(()=>{this.five.off("render.prepare",this.onCameraUpdate)},1e3)}),r$w(this,"onFiveEveryReady",()=>{this.five.state.mode!=="Panorama"&&this.updateVisible()}),r$w(this,"updateVisible",()=>{this.visible&&(this.updateIntersectCheckVisible(),this.needsRender=!0)}),r$w(this,"applyVisible",()=>{this.visibles[3]===!0||this.visibles.every(Xe=>Xe!==!1)?(this.container.style.opacity="1",this.container.style.pointerEvents="auto"):(this.container.style.opacity="0",this.container.style.pointerEvents="none")}),r$w(this,"updateIntersectCheckVisible",()=>{var Xe,Ke;if(!this.position)return;if(!this.intersectCheck){this.visibles[1]=!0;return}let Ye=!1,or=.01;this.fiveUtil.workUtil.fromType==="poincare"&&(or=.05);const sr=this.transformedPosition.clone().sub(this.five.camera.position).normalize();t$g.set(this.five.camera.position,sr);const cr=(Xe=l$w(this.five).intersectRaycaster(t$g))!=null?Xe:[],Br=(Ke=t$g.intersectObjects(this.extraObjectsForIntersectCheck,!0))!=null?Ke:[],tn=[...cr,...Br].sort((en,an)=>en.distance-an.distance)[0];tn?Ye=tn?.distance+or>this.transformedPosition.distanceTo(this.five.camera.position):Ye=!0,this.visibles[1]=Ye});var Ve,Fe,Je;this.five=Se,this.fiveUtil=(Ve=Se.__fiveUtil__)!=null?Ve:Se.__fiveUtil__=new c$M(Se),this.originPosition=Be?t$j(Be).clone():void 0,this.transformedPosition=(Fe=this.originPosition)==null?void 0:Fe.clone(),this.positionsForRotate=(Je=De?.positionsForRotate)==null?void 0:Je.map(Xe=>t$j(Xe).clone()),this.config=De??{},this.container=(()=>{const Xe=document.createElement("div");return Xe.classList.add("light-tag"),Xe.style.width="0",Xe.style.height="0",Xe.style.position="absolute",De!=null&&De.disableOpacityTransition||(Xe.style.transition="opacity 0.2s linear"),Xe})(),this.addResizeListener(),this.show(),this.enable(),setTimeout(()=>{this.updateVisible(),this.needsRender=!0},0)}get position(){return this.transformedPosition}set needsRender(Se){this.applyVisible()}show(Se){this.visible=!0,this.visibles[0]=!0,Se!=null&&Se.force&&(this.visibles[3]=!0),this.container.style.opacity="1",this.container.style.pointerEvents="auto",this.updateVisible(),this.onCameraUpdate()}hide(){this.visible=!1,this.visibles[0]=!1,this.container.style.opacity="0",this.container.style.pointerEvents="none"}enable(){return u$u(this,null,function*(){var Se,Be,De,Ve;if(this.enabled||(this.enabled=!0,yield M$u(this.five),!this.enabled))return;if(this.wrapper=(Be=this.config.wrapper)!=null?Be:(Se=this.five.getElement())==null?void 0:Se.parentElement,!this.wrapper){console.error("lighttag: wrapper is required");return}const Fe=`light-tag-wrapper-${(Ve=(De=this.config)==null?void 0:De.namespace)!=null?Ve:"default"}`;if(!this.tagWrapper){let Xe=Array.from(this.wrapper.children).find(Ke=>Ke.id===Fe);if(!Xe){const Ke=document.createElement("div");Xe=Ke,Ke.id=Fe,Ke.style.position="absolute",Ke.style.overflow="hidden",Ke.style.top="0",Ke.style.left="0",Ke.style.width="100%",Ke.style.height="100%",Ke.style.pointerEvents="none",Ke.style.zIndex="1",this.wrapper.appendChild(Xe)}this.tagWrapper=Xe}this.tagWrapper.appendChild(this.container),this.updateVisible();const Je=i$x(this.five,this.onFiveEveryReady);this.five.on("cameraUpdate",this.onCameraUpdate),this.five.on("cameraFovUpdate",this.onCameraFovUpdate),this.five.on("panoArrived",this.onPanoArrived),this.five.on("modeChange",this.onModeChange),this.disposer=()=>{Je(),this.five.off("cameraUpdate",this.onCameraUpdate),this.five.off("cameraFovUpdate",this.onCameraFovUpdate),this.five.off("panoArrived",this.onPanoArrived),this.five.off("modeChange",this.onModeChange)}})}disable(){var Se,Be;this.enabled&&(this.enabled=!1,(Se=this.tagWrapper)==null||Se.removeChild(this.container),(Be=this.disposer)==null||Be.call(this))}destroy(){this.disable(),this.container.remove(),this.disposers.forEach(Se=>Se())}setPosition(Se,Be){this.transformedPosition=t$j(Se).clone(),this.positionsForRotate=Be?.map(De=>t$j(De).clone()),this.onCameraUpdate(),setTimeout(()=>this.onCameraUpdate(),0)}setTransformMatrix(Se){var Be;this.transformedPosition=(Be=this.originPosition)==null?void 0:Be.clone().applyMatrix4(Se),this.onCameraUpdate()}updateScreenPosition(){var Se;if(!this.transformedPosition){this.container.style.left="-100%",this.container.style.top="-100%";return}const Be=(Se=this.five.renderer)==null?void 0:Se.getSize(M$q);if(!Be){this.container.style.left="-100%",this.container.style.top="-100%";return}const De=i$z(this.five.camera,this.transformedPosition,Be);if(!De){this.container.style.left="-100%",this.container.style.top="-100%";return}const Ve=(()=>{if(!this.simulate3D)return 1;const Je=3*Math.tan(.5*this.five.camera.fov/180*Math.PI),Xe=this.transformedPosition.distanceTo(this.five.camera.position);return Math.max(Math.min(1-Je*Xe/40,1),.75)})(),Fe=(()=>{if(this.positionsForRotate===void 0||this.positionsForRotate.length!==2)return 0;const[Je,Xe]=this.positionsForRotate,Ke=i$z(this.five.camera,Je,Be),Ye=i$z(this.five.camera,Xe,Be);if(!Ke||!Ye)return 0;const or=Ke.leftPx>Ye.leftPx?Ye:Ke,sr=Ke.leftPx>Ye.leftPx?Ke:Ye,cr=sr.leftPx-or.leftPx,Br=sr.topPx-or.topPx;return Math.atan2(Br,cr)*(180/Math.PI)})();this.container.style.left=De.leftPx+"px",this.container.style.top=De.topPx+"px",this.container.style.transformOrigin="center",this.container.style.transform=`scale(${Ve})`,Fe&&(this.container.style.transform+=` rotate(${Fe}deg)`)}addResizeListener(){const Se=this.five.getElement();if(Se){const{observe:Be,unobserve:De}=o$G(this.onCameraUpdate,Se);Be(),this.disposers.push(De)}}};function R$j($e){return M$p($e,"box3")}function T$j($e){return M$p($e,"sphere")}function h$u($e,Se){const Be=Se==="box3"?new Box3:new c$F,De=new Vector3;if($e.updateWorldMatrix(!1,!1),$e.traverse(Ve=>{var Fe;if(Ve.name==="shadow"||Ve.type==="Line2")return;const Je=Ve.geometry;if(Ve.updateWorldMatrix(!1,!1),Je!==void 0){const Xe=(Fe=Je?.attributes)==null?void 0:Fe.position;if(Xe)for(let Ke=0,Ye=Xe.count;Ke<Ye;Ke++)De.fromBufferAttribute(Xe,Ke).applyMatrix4(Ve.matrixWorld),Be.expandByPoint(De);else Je.vertices&&Je.vertices.forEach(Ke=>{const Ye=Ke.clone().applyMatrix4(Ve.matrixWorld);Be.expandByPoint(Ye)})}}),!Be.isEmpty())return Be}function M$p($e,Se){const Be=h$u($e,Se);return Be&&Be.applyMatrix4(W$d($e.matrixWorld.clone())),Be}const W$d=$e=>{const Se=$e.elements,Be=Se[0],De=Se[1],Ve=Se[2],Fe=Se[3],Je=Se[4],Xe=Se[5],Ke=Se[6],Ye=Se[7],or=Se[8],sr=Se[9],cr=Se[10],Br=Se[11],tn=Se[12],en=Se[13],an=Se[14],rn=Se[15],on=sr*an*Ye-en*cr*Ye+en*Ke*Br-Xe*an*Br-sr*Ke*rn+Xe*cr*rn,sn=tn*cr*Ye-or*an*Ye-tn*Ke*Br+Je*an*Br+or*Ke*rn-Je*cr*rn,ln=or*en*Ye-tn*sr*Ye+tn*Xe*Br-Je*en*Br-or*Xe*rn+Je*sr*rn,cn=tn*sr*Ke-or*en*Ke-tn*Xe*cr+Je*en*cr+or*Xe*an-Je*sr*an,hn=Be*on+De*sn+Ve*ln+Fe*cn;if(hn===0)return $e.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const mn=1/hn;return Se[0]=on*mn,Se[1]=(en*cr*Fe-sr*an*Fe-en*Ve*Br+De*an*Br+sr*Ve*rn-De*cr*rn)*mn,Se[2]=(Xe*an*Fe-en*Ke*Fe+en*Ve*Ye-De*an*Ye-Xe*Ve*rn+De*Ke*rn)*mn,Se[3]=(sr*Ke*Fe-Xe*cr*Fe-sr*Ve*Ye+De*cr*Ye+Xe*Ve*Br-De*Ke*Br)*mn,Se[4]=sn*mn,Se[5]=(or*an*Fe-tn*cr*Fe+tn*Ve*Br-Be*an*Br-or*Ve*rn+Be*cr*rn)*mn,Se[6]=(tn*Ke*Fe-Je*an*Fe-tn*Ve*Ye+Be*an*Ye+Je*Ve*rn-Be*Ke*rn)*mn,Se[7]=(Je*cr*Fe-or*Ke*Fe+or*Ve*Ye-Be*cr*Ye-Je*Ve*Br+Be*Ke*Br)*mn,Se[8]=ln*mn,Se[9]=(tn*sr*Fe-or*en*Fe-tn*De*Br+Be*en*Br+or*De*rn-Be*sr*rn)*mn,Se[10]=(Je*en*Fe-tn*Xe*Fe+tn*De*Ye-Be*en*Ye-Je*De*rn+Be*Xe*rn)*mn,Se[11]=(or*Xe*Fe-Je*sr*Fe-or*De*Ye+Be*sr*Ye+Je*De*Br-Be*Xe*Br)*mn,Se[12]=cn*mn,Se[13]=(or*en*Ve-tn*sr*Ve+tn*De*cr-Be*en*cr-or*De*an+Be*sr*an)*mn,Se[14]=(tn*Xe*Ve-Je*en*Ve-tn*De*Ke+Be*en*Ke+Je*De*an-Be*Xe*an)*mn,Se[15]=(Je*sr*Ve-or*Xe*Ve+or*De*Ke-Be*sr*Ke-Je*De*cr+Be*Xe*cr)*mn,$e};function n$o($e){return/^https?:\/\/|^\/\//.test($e)||/^data:/.test($e)}function s$i($e,Se){return n$o(Se)?Se:`${$e}${Se}`}function N$f(){}const Z$a=$e=>$e;function kt$1($e,Se){for(const Be in Se)$e[Be]=Se[Be];return $e}function xt$1($e){return!!$e&&(typeof $e=="object"||typeof $e=="function")&&typeof $e.then=="function"}function at$3($e){return $e()}function ut$3(){return Object.create(null)}function M$o($e){$e.forEach(at$3)}function L$k($e){return typeof $e=="function"}function Ft$1($e,Se){return $e!=$e?Se==Se:$e!==Se||$e&&typeof $e=="object"||typeof $e=="function"}let F$k;function Wt$2($e,Se){return F$k||(F$k=document.createElement("a")),F$k.href=Se,$e===F$k.href}function Et$1($e){return Object.keys($e).length===0}function Bt$1($e,Se,Be,De){if($e){const Ve=dt$1($e,Se,Be,De);return $e[0](Ve)}}function dt$1($e,Se,Be,De){return $e[1]&&De?kt$1(Be.ctx.slice(),$e[1](De(Se))):Be.ctx}function Ht$2($e,Se,Be,De){if($e[2]&&De){const Ve=$e[2](De(Be));if(Se.dirty===void 0)return Ve;if(typeof Ve=="object"){const Fe=[],Je=Math.max(Se.dirty.length,Ve.length);for(let Xe=0;Xe<Je;Xe+=1)Fe[Xe]=Se.dirty[Xe]|Ve[Xe];return Fe}return Se.dirty|Ve}return Se.dirty}function It($e,Se,Be,De,Ve,Fe){if(Ve){const Je=dt$1(Se,Be,De,Fe);$e.p(Je,Ve)}}function Ut($e){if($e.ctx.length>32){const Se=[],Be=$e.ctx.length/32;for(let De=0;De<Be;De++)Se[De]=-1;return Se}return-1}function Gt$1($e){return $e??""}function Jt$2($e){return $e&&L$k($e.destroy)?$e.destroy:N$f}function Kt$1($e){const Se=typeof $e=="string"&&$e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return Se?[parseFloat(Se[1]),Se[2]||"px"]:[$e,"px"]}const ht$2=typeof window<"u";let tt$3=ht$2?()=>window.performance.now():()=>Date.now(),et$2=ht$2?$e=>requestAnimationFrame($e):N$f;const j$n=new Set;function _t$1($e){j$n.forEach(Se=>{Se.c($e)||(j$n.delete(Se),Se.f())}),j$n.size!==0&&et$2(_t$1)}function nt$5($e){let Se;return j$n.size===0&&et$2(_t$1),{promise:new Promise(Be=>{j$n.add(Se={c:$e,f:Be})}),abort(){j$n.delete(Se)}}}function pt$1($e,Se){$e.appendChild(Se)}function Qt$1($e,Se,Be){const De=it$5($e);if(!De.getElementById(Se)){const Ve=K$g("style");Ve.id=Se,Ve.textContent=Be,mt$1(De,Ve)}}function it$5($e){if(!$e)return document;const Se=$e.getRootNode?$e.getRootNode():$e.ownerDocument;return Se&&Se.host?Se:$e.ownerDocument}function vt$1($e){const Se=K$g("style");return mt$1(it$5($e),Se),Se.sheet}function mt$1($e,Se){return pt$1($e.head||$e,Se),Se.sheet}function Nt$1($e,Se,Be){$e.insertBefore(Se,Be||null)}function J$h($e){$e.parentNode&&$e.parentNode.removeChild($e)}function Vt($e,Se){for(let Be=0;Be<$e.length;Be+=1)$e[Be]&&$e[Be].d(Se)}function K$g($e){return document.createElement($e)}function Mt($e){return document.createElementNS("http://www.w3.org/2000/svg",$e)}function gt$2($e){return document.createTextNode($e)}function Xt$2(){return gt$2(" ")}function Yt$1(){return gt$2("")}function lt$2($e,Se,Be,De){return $e.addEventListener(Se,Be,De),()=>$e.removeEventListener(Se,Be,De)}function Zt$1($e){return function(Se){return Se.stopPropagation(),$e.call(this,Se)}}function te$4($e,Se,Be){Be==null?$e.removeAttribute(Se):$e.getAttribute(Se)!==Be&&$e.setAttribute(Se,Be)}function At($e){return Array.from($e.childNodes)}function ee$5($e,Se){Se=""+Se,$e.data!==Se&&($e.data=Se)}function ne$5($e,Se,Be,De){Be===null?$e.style.removeProperty(Se):$e.style.setProperty(Se,Be,"")}function re$2($e,Se,Be){$e.classList[Be?"add":"remove"](Se)}function yt$1($e,Se,{bubbles:Be=!1,cancelable:De=!1}={}){const Ve=document.createEvent("CustomEvent");return Ve.initCustomEvent($e,Be,De,Se),Ve}let se$2=class{constructor(Se=!1){this.is_svg=!1,this.is_svg=Se,this.e=this.n=null}c(Se){this.h(Se)}m(Se,Be,De=null){this.e||(this.is_svg?this.e=Mt(Be.nodeName):this.e=K$g(Be.nodeType===11?"TEMPLATE":Be.nodeName),this.t=Be.tagName!=="TEMPLATE"?Be:Be.content,this.c(Se)),this.i(De)}h(Se){this.e.innerHTML=Se,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(Se){for(let Be=0;Be<this.n.length;Be+=1)Nt$1(this.t,this.n[Be],Se)}p(Se){this.d(),this.h(Se),this.i(this.a)}d(){this.n.forEach(J$h)}};const H$q=new Map;let I$p=0;function Ct$1($e){let Se=5381,Be=$e.length;for(;Be--;)Se=(Se<<5)-Se^$e.charCodeAt(Be);return Se>>>0}function Pt($e,Se){const Be={stylesheet:vt$1(Se),rules:{}};return H$q.set($e,Be),Be}function U$f($e,Se,Be,De,Ve,Fe,Je,Xe=0){const Ke=16.666/De;let Ye=`{
`;for(let an=0;an<=1;an+=Ke){const rn=Se+(Be-Se)*Fe(an);Ye+=an*100+`%{${Je(rn,1-rn)}}
`}const or=Ye+`100% {${Je(Be,1-Be)}}
}`,sr=`__svelte_${Ct$1(or)}_${Xe}`,cr=it$5($e),{stylesheet:Br,rules:tn}=H$q.get(cr)||Pt(cr,$e);tn[sr]||(tn[sr]=!0,Br.insertRule(`@keyframes ${sr} ${or}`,Br.cssRules.length));const en=$e.style.animation||"";return $e.style.animation=`${en?`${en}, `:""}${sr} ${De}ms linear ${Ve}ms 1 both`,I$p+=1,sr}function G$e($e,Se){const Be=($e.style.animation||"").split(", "),De=Be.filter(Se?Fe=>Fe.indexOf(Se)<0:Fe=>Fe.indexOf("__svelte")===-1),Ve=Be.length-De.length;Ve&&($e.style.animation=De.join(", "),I$p-=Ve,I$p||jt$1())}function jt$1(){et$2(()=>{I$p||(H$q.forEach($e=>{const{ownerNode:Se}=$e.stylesheet;Se&&J$h(Se)}),H$q.clear())})}let D$o;function v$t($e){D$o=$e}function A$u(){if(!D$o)throw new Error("Function called outside component initialization");return D$o}function ce$2($e){A$u().$$.on_mount.push($e)}function ue$3($e){A$u().$$.after_update.push($e)}function le$1($e){A$u().$$.on_destroy.push($e)}function fe$4(){const $e=A$u();return(Se,Be,{cancelable:De=!1}={})=>{const Ve=$e.$$.callbacks[Se];if(Ve){const Fe=yt$1(Se,Be,{cancelable:De});return Ve.slice().forEach(Je=>{Je.call($e,Fe)}),!Fe.defaultPrevented}return!0}}function ae$2($e,Se){return A$u().$$.context.set($e,Se),Se}function de$4($e){return A$u().$$.context.get($e)}function he$2($e,Se){const Be=$e.$$.callbacks[Se.type];Be&&Be.slice().forEach(De=>De.call(this,Se))}const P$s=[],ft$1=[];let S$p=[];const X$9=[],bt$1=Promise.resolve();let Y$c=!1;function wt$1(){Y$c||(Y$c=!0,bt$1.then(rt$4))}function _e$3(){return wt$1(),bt$1}function z$j($e){S$p.push($e)}function pe$3($e){X$9.push($e)}const V$a=new Set;let C$k=0;function rt$4(){if(C$k!==0)return;const $e=D$o;do{try{for(;C$k<P$s.length;){const Se=P$s[C$k];C$k++,v$t(Se),St$1(Se.$$)}}catch(Se){throw P$s.length=0,C$k=0,Se}for(v$t(null),P$s.length=0,C$k=0;ft$1.length;)ft$1.pop()();for(let Se=0;Se<S$p.length;Se+=1){const Be=S$p[Se];V$a.has(Be)||(V$a.add(Be),Be())}S$p.length=0}while(P$s.length);for(;X$9.length;)X$9.pop()();Y$c=!1,V$a.clear(),v$t($e)}function St$1($e){if($e.fragment!==null){$e.update(),M$o($e.before_update);const Se=$e.dirty;$e.dirty=[-1],$e.fragment&&$e.fragment.p($e.ctx,Se),$e.after_update.forEach(z$j)}}function zt$1($e){const Se=[],Be=[];S$p.forEach(De=>$e.indexOf(De)===-1?Se.push(De):Be.push(De)),Be.forEach(De=>De()),S$p=Se}let O$i;function st$3(){return O$i||(O$i=Promise.resolve(),O$i.then(()=>{O$i=null})),O$i}function T$i($e,Se,Be){$e.dispatchEvent(yt$1(`${Se?"intro":"outro"}${Be}`))}const B$o=new Set;let x$r;function Lt$1(){x$r={r:0,c:[],p:x$r}}function Ot$2(){x$r.r||M$o(x$r.c),x$r=x$r.p}function ot$4($e,Se){$e&&$e.i&&(B$o.delete($e),$e.i(Se))}function $t($e,Se,Be,De){if($e&&$e.o){if(B$o.has($e))return;B$o.add($e),x$r.c.push(()=>{B$o.delete($e),De&&(Be&&$e.d(1),De())}),$e.o(Se)}else De&&De()}const ct$2={duration:0};function me$2($e,Se,Be){const De={direction:"in"};let Ve=Se($e,Be,De),Fe=!1,Je,Xe,Ke=0;function Ye(){Je&&G$e($e,Je)}function or(){const{delay:cr=0,duration:Br=300,easing:tn=Z$a,tick:en=N$f,css:an}=Ve||ct$2;an&&(Je=U$f($e,0,1,Br,cr,tn,an,Ke++)),en(0,1);const rn=tt$3()+cr,on=rn+Br;Xe&&Xe.abort(),Fe=!0,z$j(()=>T$i($e,!0,"start")),Xe=nt$5(sn=>{if(Fe){if(sn>=on)return en(1,0),T$i($e,!0,"end"),Ye(),Fe=!1;if(sn>=rn){const ln=tn((sn-rn)/Br);en(ln,1-ln)}}return Fe})}let sr=!1;return{start(){sr||(sr=!0,G$e($e),L$k(Ve)?(Ve=Ve(De),st$3().then(or)):or())},invalidate(){sr=!1},end(){Fe&&(Ye(),Fe=!1)}}}function ge$6($e,Se,Be){const De={direction:"out"};let Ve=Se($e,Be,De),Fe=!0,Je;const Xe=x$r;Xe.r+=1;function Ke(){const{delay:Ye=0,duration:or=300,easing:sr=Z$a,tick:cr=N$f,css:Br}=Ve||ct$2;Br&&(Je=U$f($e,1,0,or,Ye,sr,Br));const tn=tt$3()+Ye,en=tn+or;z$j(()=>T$i($e,!1,"start")),nt$5(an=>{if(Fe){if(an>=en)return cr(0,1),T$i($e,!1,"end"),--Xe.r||M$o(Xe.c),!1;if(an>=tn){const rn=sr((an-tn)/or);cr(1-rn,rn)}}return Fe})}return L$k(Ve)?st$3().then(()=>{Ve=Ve(De),Ke()}):Ke(),{end(Ye){Ye&&Ve.tick&&Ve.tick(1,0),Fe&&(Je&&G$e($e,Je),Fe=!1)}}}function ye$3($e,Se,Be,De){const Ve={direction:"both"};let Fe=Se($e,Be,Ve),Je=De?0:1,Xe=null,Ke=null,Ye=null;function or(){Ye&&G$e($e,Ye)}function sr(Br,tn){const en=Br.b-Je;return tn*=Math.abs(en),{a:Je,b:Br.b,d:en,duration:tn,start:Br.start,end:Br.start+tn,group:Br.group}}function cr(Br){const{delay:tn=0,duration:en=300,easing:an=Z$a,tick:rn=N$f,css:on}=Fe||ct$2,sn={start:tt$3()+tn,b:Br};Br||(sn.group=x$r,x$r.r+=1),Xe||Ke?Ke=sn:(on&&(or(),Ye=U$f($e,Je,Br,en,tn,an,on)),Br&&rn(0,1),Xe=sr(sn,en),z$j(()=>T$i($e,Br,"start")),nt$5(ln=>{if(Ke&&ln>Ke.start&&(Xe=sr(Ke,en),Ke=null,T$i($e,Xe.b,"start"),on&&(or(),Ye=U$f($e,Je,Xe.b,Xe.duration,0,an,Fe.css))),Xe){if(ln>=Xe.end)rn(Je=Xe.b,1-Je),T$i($e,Xe.b,"end"),Ke||(Xe.b?or():--Xe.group.r||M$o(Xe.group.c)),Xe=null;else if(ln>=Xe.start){const cn=ln-Xe.start;Je=Xe.a+Xe.d*an(cn/Xe.duration),rn(Je,1-Je)}}return!!(Xe||Ke)}))}return{run(Br){L$k(Fe)?st$3().then(()=>{Fe=Fe(Ve),cr(Br)}):cr(Br)},end(){or(),Xe=Ke=null}}}function be$3($e,Se){const Be=Se.token={};function De(Ve,Fe,Je,Xe){if(Se.token!==Be)return;Se.resolved=Xe;let Ke=Se.ctx;Je!==void 0&&(Ke=Ke.slice(),Ke[Je]=Xe);const Ye=Ve&&(Se.current=Ve)(Ke);let or=!1;Se.block&&(Se.blocks?Se.blocks.forEach((sr,cr)=>{cr!==Fe&&sr&&(Lt$1(),$t(sr,1,1,()=>{Se.blocks[cr]===sr&&(Se.blocks[cr]=null)}),Ot$2())}):Se.block.d(1),Ye.c(),ot$4(Ye,1),Ye.m(Se.mount(),Se.anchor),or=!0),Se.block=Ye,Se.blocks&&(Se.blocks[Fe]=Ye),or&&rt$4()}if(xt$1($e)){const Ve=A$u();if($e.then(Fe=>{v$t(Ve),De(Se.then,1,Se.value,Fe),v$t(null)},Fe=>{if(v$t(Ve),De(Se.catch,2,Se.error,Fe),v$t(null),!Se.hasCatch)throw Fe}),Se.current!==Se.pending)return De(Se.pending,0),!0}else{if(Se.current!==Se.then)return De(Se.then,1,Se.value,$e),!0;Se.resolved=$e}}function we$2($e,Se,Be){const De=Se.slice(),{resolved:Ve}=$e;$e.current===$e.then&&(De[$e.value]=Ve),$e.current===$e.catch&&(De[$e.error]=Ve),$e.block.p(De,Be)}function ke$3($e,Se){$e.d(1),Se.delete($e.key)}function xe($e,Se){$t($e,1,1,()=>{Se.delete($e.key)})}function Ee$2($e,Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr){let cr=$e.length,Br=Fe.length,tn=cr;const en={};for(;tn--;)en[$e[tn].key]=tn;const an=[],rn=new Map,on=new Map,sn=[];for(tn=Br;tn--;){const mn=sr(Ve,Fe,tn),An=Be(mn);let xn=Je.get(An);xn?sn.push(()=>xn.p(mn,Se)):(xn=Ye(An,mn),xn.c()),rn.set(An,an[tn]=xn),An in en&&on.set(An,Math.abs(tn-en[An]))}const ln=new Set,cn=new Set;function hn(mn){ot$4(mn,1),mn.m(Xe,or),Je.set(mn.key,mn),or=mn.first,Br--}for(;cr&&Br;){const mn=an[Br-1],An=$e[cr-1],xn=mn.key,pn=An.key;mn===An?(or=mn.first,cr--,Br--):rn.has(pn)?!Je.has(xn)||ln.has(xn)?hn(mn):cn.has(pn)?cr--:on.get(xn)>on.get(pn)?(cn.add(xn),hn(mn)):(ln.add(pn),cr--):(Ke(An,Je),cr--)}for(;cr--;){const mn=$e[cr];rn.has(mn.key)||Ke(mn,Je)}for(;Br;)hn(an[Br-1]);return M$o(sn),an}function ve$2($e,Se){const Be={},De={},Ve={$$scope:1};let Fe=$e.length;for(;Fe--;){const Je=$e[Fe],Xe=Se[Fe];if(Xe){for(const Ke in Je)Ke in Xe||(De[Ke]=1);for(const Ke in Xe)Ve[Ke]||(Be[Ke]=Xe[Ke],Ve[Ke]=1);$e[Fe]=Xe}else for(const Ke in Je)Ve[Ke]=1}for(const Je in De)Je in Be||(Be[Je]=void 0);return Be}function Ne$2($e){return typeof $e=="object"&&$e!==null?$e:{}}function Me$1($e,Se,Be){const De=$e.$$.props[Se];De!==void 0&&($e.$$.bound[De]=Be,Be($e.$$.ctx[De]))}function Ae$2($e){$e&&$e.c()}function Dt$1($e,Se,Be,De){const{fragment:Ve,after_update:Fe}=$e.$$;Ve&&Ve.m(Se,Be),De||z$j(()=>{const Je=$e.$$.on_mount.map(at$3).filter(L$k);$e.$$.on_destroy?$e.$$.on_destroy.push(...Je):M$o(Je),$e.$$.on_mount=[]}),Fe.forEach(z$j)}function Rt($e,Se){const Be=$e.$$;Be.fragment!==null&&(zt$1(Be.after_update),M$o(Be.on_destroy),Be.fragment&&Be.fragment.d(Se),Be.on_destroy=Be.fragment=null,Be.ctx=[])}function qt$1($e,Se){$e.$$.dirty[0]===-1&&(P$s.push($e),wt$1(),$e.$$.dirty.fill(0)),$e.$$.dirty[Se/31|0]|=1<<Se%31}function Te$1($e,Se,Be,De,Ve,Fe,Je,Xe=[-1]){const Ke=D$o;v$t($e);const Ye=$e.$$={fragment:null,ctx:[],props:Fe,update:N$f,not_equal:Ve,bound:ut$3(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(Se.context||(Ke?Ke.$$.context:[])),callbacks:ut$3(),dirty:Xe,skip_bound:!1,root:Se.target||Ke.$$.root};Je&&Je(Ye.root);let or=!1;if(Ye.ctx=Be?Be($e,Se.props||{},(sr,cr,...Br)=>{const tn=Br.length?Br[0]:cr;return Ye.ctx&&Ve(Ye.ctx[sr],Ye.ctx[sr]=tn)&&(!Ye.skip_bound&&Ye.bound[sr]&&Ye.bound[sr](tn),or&&qt$1($e,sr)),cr}):[],Ye.update(),or=!0,M$o(Ye.before_update),Ye.fragment=De?De(Ye.ctx):!1,Se.target){if(Se.hydrate){const sr=At(Se.target);Ye.fragment&&Ye.fragment.l(sr),sr.forEach(J$h)}else Ye.fragment&&Ye.fragment.c();Se.intro&&ot$4($e.$$.fragment),Dt$1($e,Se.target,Se.anchor,Se.customElement),rt$4()}v$t(Ke)}let Ce$1=class{$destroy(){Rt(this,1),this.$destroy=N$f}$on(Se,Be){if(!L$k(Be))return N$f;const De=this.$$.callbacks[Se]||(this.$$.callbacks[Se]=[]);return De.push(Be),()=>{const Ve=De.indexOf(Be);Ve!==-1&&De.splice(Ve,1)}}$set(Se){this.$$set&&!Et$1(Se)&&(this.$$.skip_bound=!0,this.$$set(Se),this.$$.skip_bound=!1)}};var _$f=function(){if(typeof Map<"u")return Map;function $e(Se,Be){var De=-1;return Se.some(function(Ve,Fe){return Ve[0]===Be?(De=Fe,!0):!1}),De}return function(){function Se(){this.__entries__=[]}return Object.defineProperty(Se.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),Se.prototype.get=function(Be){var De=$e(this.__entries__,Be),Ve=this.__entries__[De];return Ve&&Ve[1]},Se.prototype.set=function(Be,De){var Ve=$e(this.__entries__,Be);~Ve?this.__entries__[Ve][1]=De:this.__entries__.push([Be,De])},Se.prototype.delete=function(Be){var De=this.__entries__,Ve=$e(De,Be);~Ve&&De.splice(Ve,1)},Se.prototype.has=function(Be){return!!~$e(this.__entries__,Be)},Se.prototype.clear=function(){this.__entries__.splice(0)},Se.prototype.forEach=function(Be,De){De===void 0&&(De=null);for(var Ve=0,Fe=this.__entries__;Ve<Fe.length;Ve++){var Je=Fe[Ve];Be.call(De,Je[1],Je[0])}},Se}()}(),v$s=typeof window<"u"&&typeof document<"u"&&window.document===document,f$E=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),O$h=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(f$E):function($e){return setTimeout(function(){return $e(Date.now())},1e3/60)}}(),E$p=2;function R$i($e,Se){var Be=!1,De=!1,Ve=0;function Fe(){Be&&(Be=!1,$e()),De&&Xe()}function Je(){O$h(Fe)}function Xe(){var Ke=Date.now();if(Be){if(Ke-Ve<E$p)return;De=!0}else Be=!0,De=!1,setTimeout(Je,Se);Ve=Ke}return Xe}var M$n=20,x$q=["top","right","bottom","left","width","height","size","weight"],A$t=typeof MutationObserver<"u",z$i=function(){function $e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=R$i(this.refresh.bind(this),M$n)}return $e.prototype.addObserver=function(Se){~this.observers_.indexOf(Se)||this.observers_.push(Se),this.connected_||this.connect_()},$e.prototype.removeObserver=function(Se){var Be=this.observers_,De=Be.indexOf(Se);~De&&Be.splice(De,1),!Be.length&&this.connected_&&this.disconnect_()},$e.prototype.refresh=function(){var Se=this.updateObservers_();Se&&this.refresh()},$e.prototype.updateObservers_=function(){var Se=this.observers_.filter(function(Be){return Be.gatherActive(),Be.hasActive()});return Se.forEach(function(Be){return Be.broadcastActive()}),Se.length>0},$e.prototype.connect_=function(){!v$s||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),A$t?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},$e.prototype.disconnect_=function(){!v$s||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},$e.prototype.onTransitionEnd_=function(Se){var Be=Se.propertyName,De=Be===void 0?"":Be,Ve=x$q.some(function(Fe){return!!~De.indexOf(Fe)});Ve&&this.refresh()},$e.getInstance=function(){return this.instance_||(this.instance_=new $e),this.instance_},$e.instance_=null,$e}(),m$q=function($e,Se){for(var Be=0,De=Object.keys(Se);Be<De.length;Be++){var Ve=De[Be];Object.defineProperty($e,Ve,{value:Se[Ve],enumerable:!1,writable:!1,configurable:!0})}return $e},c$x=function($e){var Se=$e&&$e.ownerDocument&&$e.ownerDocument.defaultView;return Se||f$E},y$t=d$y(0,0,0,0);function h$t($e){return parseFloat($e)||0}function b$q($e){for(var Se=[],Be=1;Be<arguments.length;Be++)Se[Be-1]=arguments[Be];return Se.reduce(function(De,Ve){var Fe=$e["border-"+Ve+"-width"];return De+h$t(Fe)},0)}function T$h($e){for(var Se=["top","right","bottom","left"],Be={},De=0,Ve=Se;De<Ve.length;De++){var Fe=Ve[De],Je=$e["padding-"+Fe];Be[Fe]=h$t(Je)}return Be}function C$j($e){var Se=$e.getBBox();return d$y(0,0,Se.width,Se.height)}function S$o($e){var Se=$e.clientWidth,Be=$e.clientHeight;if(!Se&&!Be)return y$t;var De=c$x($e).getComputedStyle($e),Ve=T$h(De),Fe=Ve.left+Ve.right,Je=Ve.top+Ve.bottom,Xe=h$t(De.width),Ke=h$t(De.height);if(De.boxSizing==="border-box"&&(Math.round(Xe+Fe)!==Se&&(Xe-=b$q(De,"left","right")+Fe),Math.round(Ke+Je)!==Be&&(Ke-=b$q(De,"top","bottom")+Je)),!G$d($e)){var Ye=Math.round(Xe+Fe)-Se,or=Math.round(Ke+Je)-Be;Math.abs(Ye)!==1&&(Xe-=Ye),Math.abs(or)!==1&&(Ke-=or)}return d$y(Ve.left,Ve.top,Xe,Ke)}var D$n=function(){return typeof SVGGraphicsElement<"u"?function($e){return $e instanceof c$x($e).SVGGraphicsElement}:function($e){return $e instanceof c$x($e).SVGElement&&typeof $e.getBBox=="function"}}();function G$d($e){return $e===c$x($e).document.documentElement}function L$j($e){return v$s?D$n($e)?C$j($e):S$o($e):y$t}function P$r($e){var Se=$e.x,Be=$e.y,De=$e.width,Ve=$e.height,Fe=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,Je=Object.create(Fe.prototype);return m$q(Je,{x:Se,y:Be,width:De,height:Ve,top:Be,right:Se+De,bottom:Ve+Be,left:Se}),Je}function d$y($e,Se,Be,De){return{x:$e,y:Se,width:Be,height:De}}var W$c=function(){function $e(Se){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=d$y(0,0,0,0),this.target=Se}return $e.prototype.isActive=function(){var Se=L$j(this.target);return this.contentRect_=Se,Se.width!==this.broadcastWidth||Se.height!==this.broadcastHeight},$e.prototype.broadcastRect=function(){var Se=this.contentRect_;return this.broadcastWidth=Se.width,this.broadcastHeight=Se.height,Se},$e}(),j$m=function(){function $e(Se,Be){var De=P$r(Be);m$q(this,{target:Se,contentRect:De})}return $e}(),F$j=function(){function $e(Se,Be,De){if(this.activeObservations_=[],this.observations_=new _$f,typeof Se!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=Se,this.controller_=Be,this.callbackCtx_=De}return $e.prototype.observe=function(Se){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(Se instanceof c$x(Se).Element))throw new TypeError('parameter 1 is not of type "Element".');var Be=this.observations_;Be.has(Se)||(Be.set(Se,new W$c(Se)),this.controller_.addObserver(this),this.controller_.refresh())}},$e.prototype.unobserve=function(Se){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(Se instanceof c$x(Se).Element))throw new TypeError('parameter 1 is not of type "Element".');var Be=this.observations_;Be.has(Se)&&(Be.delete(Se),Be.size||this.controller_.removeObserver(this))}},$e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},$e.prototype.gatherActive=function(){var Se=this;this.clearActive(),this.observations_.forEach(function(Be){Be.isActive()&&Se.activeObservations_.push(Be)})},$e.prototype.broadcastActive=function(){if(this.hasActive()){var Se=this.callbackCtx_,Be=this.activeObservations_.map(function(De){return new j$m(De.target,De.broadcastRect())});this.callback_.call(Se,Be,Se),this.clearActive()}},$e.prototype.clearActive=function(){this.activeObservations_.splice(0)},$e.prototype.hasActive=function(){return this.activeObservations_.length>0},$e}(),g$A=typeof WeakMap<"u"?new WeakMap:new _$f,w$k=function(){function $e(Se){if(!(this instanceof $e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var Be=z$i.getInstance(),De=new F$j(Se,Be,this);g$A.set(this,De)}return $e}();["observe","unobserve","disconnect"].forEach(function($e){w$k.prototype[$e]=function(){var Se;return(Se=g$A.get(this))[$e].apply(Se,arguments)}});var H$p=function(){return typeof f$E.ResizeObserver<"u"?f$E.ResizeObserver:w$k}();function E$o($e){new H$p((Se,Be)=>{var De,Ve,Fe,Je,Xe,Ke;for(const Ye of Se){const{borderBoxSize:or,contentRect:sr}=Ye,cr=(Fe=(Ve=(De=or?.[0])==null?void 0:De.inlineSize)!=null?Ve:sr.width)!=null?Fe:$e.clientWidth,Br=(Ke=(Xe=(Je=or?.[0])==null?void 0:Je.blockSize)!=null?Xe:sr.height)!=null?Ke:$e.clientHeight;$e.dispatchEvent(new CustomEvent("clientWidth",{detail:cr})),$e.dispatchEvent(new CustomEvent("clientHeight",{detail:Br}))}}).observe($e)}function c$w($e){return $e<.5?4*$e*$e*$e:.5*Math.pow(2*$e-2,3)+1}function o$u($e){const Se=$e-1;return Se*Se*Se+1}function C$i($e,{delay:Se=0,duration:Be=400,easing:De=Z$a}={}){const Ve=+getComputedStyle($e).opacity;return{delay:Se,duration:Be,easing:De,css:Fe=>`opacity: ${Fe*Ve}`}}function S$n($e,{delay:Se=0,duration:Be=400,easing:De=o$u,x:Ve=0,y:Fe=0,opacity:Je=0}={}){const Xe=getComputedStyle($e),Ke=+Xe.opacity,Ye=Xe.transform==="none"?"":Xe.transform,or=Ke*(1-Je),[sr,cr]=Kt$1(Ve),[Br,tn]=Kt$1(Fe);return{delay:Se,duration:Be,easing:De,css:(en,an)=>`
			transform: ${Ye} translate(${(1-en)*sr}${cr}, ${(1-en)*Br}${tn});
			opacity: ${Ke-or*an}`}}function I$o($e,{delay:Se=0,speed:Be,duration:De,easing:Ve=c$w}={}){let Fe=$e.getTotalLength();const Je=getComputedStyle($e);return Je.strokeLinecap!=="butt"&&(Fe+=parseInt(Je.strokeWidth)),De===void 0?Be===void 0?De=800:De=Fe/Be:typeof De=="function"&&(De=De(Fe)),{delay:Se,duration:De,easing:Ve,css:(Xe,Ke)=>`
			stroke-dasharray: ${Fe};
			stroke-dashoffset: ${Ke*Fe};
		`}}const s$h=[];function h$s($e,Se=N$f){let Be;const De=new Set;function Ve(Xe){if(Ft$1($e,Xe)&&($e=Xe,Be)){const Ke=!s$h.length;for(const Ye of De)Ye[1](),s$h.push(Ye,$e);if(Ke){for(let Ye=0;Ye<s$h.length;Ye+=2)s$h[Ye][0](s$h[Ye+1]);s$h.length=0}}}function Fe(Xe){Ve(Xe($e))}function Je(Xe,Ke=N$f){const Ye=[Xe,Ke];return De.add(Ye),De.size===1&&(Be=Se(Ve)||N$f),Xe($e),()=>{De.delete(Ye),De.size===0&&Be&&(Be(),Be=null)}}return{set:Ve,update:Fe,subscribe:Je}}function t$9($e){return $e*180/Math.PI}var e$e=Object.defineProperty,s$g=($e,Se,Be)=>Se in $e?e$e($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$o=($e,Se,Be)=>(s$g($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let F$i=class{constructor(Se,Be){i$o(this,"VERSION","3.67.2"),i$o(this,"NAME"),i$o(this,"five"),i$o(this,"workUtil"),i$o(this,"fiveUtil"),i$o(this,"hooks",new E$v),i$o(this,"staticPrefix","//vr-image-4.realsee-cdn.cn"),this.five=Se,this.fiveUtil=new c$M(Se),this.workUtil=this.fiveUtil.workUtil,Be!=null&&Be.staticPrefix&&(this.staticPrefix=Be.staticPrefix)}set workCode(Se){this.workUtil.workCode=Se,this.onWorkCodeChange()}get workCode(){return this.workUtil.workCode}updateFive(Se){this.five=Se,this.fiveUtil.five=Se,this.workUtil.five=Se}getCurrentState(){return this.state}absoluteUrl(Se){return s$i(this.staticPrefix,Se)}onWorkCodeChange(){}};function r$v($e,Se,Be=4){return Math.abs($e-Se)<Math.pow(10,-Be)}function h$r($e,Se,Be=4){const De=Math.PI*2,Ve=$e%De,Fe=Se%De,Je=Math.min(Ve,Fe),Xe=Math.max(Ve,Fe);return r$v(Je,Xe,Be)||r$v(Je+De,Xe,Be)}Object.assign(window,{nearlyEqual:r$v,nearlyEqualRad:h$r});/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */var tt$2={},b$p=void 0,et$1=tt$2;function C$h($e,Se){var Be=$e.split("."),De=et$1;!(Be[0]in De)&&De.execScript&&De.execScript("var "+Be[0]);for(var Ve;Be.length&&(Ve=Be.shift());)!Be.length&&Se!==b$p?De[Ve]=Se:De=De[Ve]?De[Ve]:De[Ve]={}}var o$t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u"&&typeof DataView<"u";function k$k($e){var Se=$e.length,Be=0,De=Number.POSITIVE_INFINITY,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br;for(sr=0;sr<Se;++sr)$e[sr]>Be&&(Be=$e[sr]),$e[sr]<De&&(De=$e[sr]);for(Ve=1<<Be,Fe=new(o$t?Uint32Array:Array)(Ve),Je=1,Xe=0,Ke=2;Je<=Be;){for(sr=0;sr<Se;++sr)if($e[sr]===Je){for(Ye=0,or=Xe,cr=0;cr<Je;++cr)Ye=Ye<<1|or&1,or>>=1;for(Br=Je<<16|sr,cr=Ye;cr<Ve;cr+=Ke)Fe[cr]=Br;++Xe}++Je,Xe<<=1,Ke<<=1}return[Fe,Be,De]}function A$s($e,Se){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=o$t?new Uint8Array($e):$e,this.m=!1,this.i=x$p,this.r=!1,(Se||!(Se={}))&&(Se.index&&(this.a=Se.index),Se.bufferSize&&(this.h=Se.bufferSize),Se.bufferType&&(this.i=Se.bufferType),Se.resize&&(this.r=Se.resize)),this.i){case D$m:this.b=32768,this.c=new(o$t?Uint8Array:Array)(32768+this.h+258);break;case x$p:this.b=0,this.c=new(o$t?Uint8Array:Array)(this.h),this.e=this.z,this.n=this.v,this.j=this.w;break;default:throw Error("invalid inflate mode")}}var D$m=0,x$p=1,J$g={t:D$m,s:x$p};A$s.prototype.k=function(){for(;!this.m;){var $e=v$r(this,3);switch($e&1&&(this.m=!0),$e>>>=1,$e){case 0:var Se=this.input,Be=this.a,De=this.c,Ve=this.b,Fe=Se.length,Je=b$p,Xe=b$p,Ke=De.length,Ye=b$p;if(this.d=this.f=0,Be+1>=Fe)throw Error("invalid uncompressed block header: LEN");if(Je=Se[Be++]|Se[Be++]<<8,Be+1>=Fe)throw Error("invalid uncompressed block header: NLEN");if(Xe=Se[Be++]|Se[Be++]<<8,Je===~Xe)throw Error("invalid uncompressed block header: length verify");if(Be+Je>Se.length)throw Error("input buffer is broken");switch(this.i){case D$m:for(;Ve+Je>De.length;){if(Ye=Ke-Ve,Je-=Ye,o$t)De.set(Se.subarray(Be,Be+Ye),Ve),Ve+=Ye,Be+=Ye;else for(;Ye--;)De[Ve++]=Se[Be++];this.b=Ve,De=this.e(),Ve=this.b}break;case x$p:for(;Ve+Je>De.length;)De=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(o$t)De.set(Se.subarray(Be,Be+Je),Ve),Ve+=Je,Be+=Je;else for(;Je--;)De[Ve++]=Se[Be++];this.a=Be,this.b=Ve,this.c=De;break;case 1:this.j(st$2,ht$1);break;case 2:for(var or=v$r(this,5)+257,sr=v$r(this,5)+1,cr=v$r(this,4)+4,Br=new(o$t?Uint8Array:Array)(O$g.length),tn=b$p,en=b$p,an=b$p,rn=b$p,on=b$p,sn=b$p,ln=b$p,hn=b$p,cn=b$p,hn=0;hn<cr;++hn)Br[O$g[hn]]=v$r(this,3);if(!o$t)for(hn=cr,cr=Br.length;hn<cr;++hn)Br[O$g[hn]]=0;for(tn=k$k(Br),rn=new(o$t?Uint8Array:Array)(or+sr),hn=0,cn=or+sr;hn<cn;)switch(on=T$g(this,tn),on){case 16:for(ln=3+v$r(this,2);ln--;)rn[hn++]=sn;break;case 17:for(ln=3+v$r(this,3);ln--;)rn[hn++]=0;sn=0;break;case 18:for(ln=11+v$r(this,7);ln--;)rn[hn++]=0;sn=0;break;default:sn=rn[hn++]=on}en=k$k(o$t?rn.subarray(0,or):rn.slice(0,or)),an=k$k(o$t?rn.subarray(or):rn.slice(or)),this.j(en,an);break;default:throw Error("unknown BTYPE: "+$e)}}return this.n()};var Q$c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O$g=o$t?new Uint16Array(Q$c):Q$c,R$h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],rt$3=o$t?new Uint16Array(R$h):R$h,W$b=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],S$m=o$t?new Uint8Array(W$b):W$b,X$8=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],it$4=o$t?new Uint16Array(X$8):X$8,_$e=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z$9=o$t?new Uint8Array(_$e):_$e,B$n=new(o$t?Uint8Array:Array)(288),g$z,$$9;g$z=0;for($$9=B$n.length;g$z<$$9;++g$z)B$n[g$z]=143>=g$z?8:255>=g$z?9:279>=g$z?7:8;var st$2=k$k(B$n),L$i=new(o$t?Uint8Array:Array)(30),j$l,F$h;j$l=0;for(F$h=L$i.length;j$l<F$h;++j$l)L$i[j$l]=5;var ht$1=k$k(L$i);function v$r($e,Se){for(var Be=$e.f,De=$e.d,Ve=$e.input,Fe=$e.a,Je=Ve.length,Xe;De<Se;){if(Fe>=Je)throw Error("input buffer is broken");Be|=Ve[Fe++]<<De,De+=8}return Xe=Be&(1<<Se)-1,$e.f=Be>>>Se,$e.d=De-Se,$e.a=Fe,Xe}function T$g($e,Se){for(var Be=$e.f,De=$e.d,Ve=$e.input,Fe=$e.a,Je=Ve.length,Xe=Se[0],Ke=Se[1],Ye,or;De<Ke&&!(Fe>=Je);)Be|=Ve[Fe++]<<De,De+=8;if(Ye=Xe[Be&(1<<Ke)-1],or=Ye>>>16,or>De)throw Error("invalid code length: "+or);return $e.f=Be>>or,$e.d=De-or,$e.a=Fe,Ye&65535}A$s.prototype.j=function($e,Se){var Be=this.c,De=this.b;this.o=$e;for(var Ve=Be.length-258,Fe,Je,Xe,Ke;(Fe=T$g(this,$e))!==256;)if(256>Fe)De>=Ve&&(this.b=De,Be=this.e(),De=this.b),Be[De++]=Fe;else for(Je=Fe-257,Ke=rt$3[Je],0<S$m[Je]&&(Ke+=v$r(this,S$m[Je])),Fe=T$g(this,Se),Xe=it$4[Fe],0<Z$9[Fe]&&(Xe+=v$r(this,Z$9[Fe])),De>=Ve&&(this.b=De,Be=this.e(),De=this.b);Ke--;)Be[De]=Be[De++-Xe];for(;8<=this.d;)this.d-=8,this.a--;this.b=De};A$s.prototype.w=function($e,Se){var Be=this.c,De=this.b;this.o=$e;for(var Ve=Be.length,Fe,Je,Xe,Ke;(Fe=T$g(this,$e))!==256;)if(256>Fe)De>=Ve&&(Be=this.e(),Ve=Be.length),Be[De++]=Fe;else for(Je=Fe-257,Ke=rt$3[Je],0<S$m[Je]&&(Ke+=v$r(this,S$m[Je])),Fe=T$g(this,Se),Xe=it$4[Fe],0<Z$9[Fe]&&(Xe+=v$r(this,Z$9[Fe])),De+Ke>Ve&&(Be=this.e(),Ve=Be.length);Ke--;)Be[De]=Be[De++-Xe];for(;8<=this.d;)this.d-=8,this.a--;this.b=De};A$s.prototype.e=function(){var $e=new(o$t?Uint8Array:Array)(this.b-32768),Se=this.b-32768,Be,De,Ve=this.c;if(o$t)$e.set(Ve.subarray(32768,$e.length));else for(Be=0,De=$e.length;Be<De;++Be)$e[Be]=Ve[Be+32768];if(this.g.push($e),this.l+=$e.length,o$t)Ve.set(Ve.subarray(Se,Se+32768));else for(Be=0;32768>Be;++Be)Ve[Be]=Ve[Se+Be];return this.b=32768,Ve};A$s.prototype.z=function($e){var Se,Be=this.input.length/this.a+1|0,De,Ve,Fe,Je=this.input,Xe=this.c;return $e&&(typeof $e.p=="number"&&(Be=$e.p),typeof $e.u=="number"&&(Be+=$e.u)),2>Be?(De=(Je.length-this.a)/this.o[2],Fe=258*(De/2)|0,Ve=Fe<Xe.length?Xe.length+Fe:Xe.length<<1):Ve=Xe.length*Be,o$t?(Se=new Uint8Array(Ve),Se.set(Xe)):Se=Xe,this.c=Se};A$s.prototype.n=function(){var $e=0,Se=this.c,Be=this.g,De,Ve=new(o$t?Uint8Array:Array)(this.l+(this.b-32768)),Fe,Je,Xe,Ke;if(Be.length===0)return o$t?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(Fe=0,Je=Be.length;Fe<Je;++Fe)for(De=Be[Fe],Xe=0,Ke=De.length;Xe<Ke;++Xe)Ve[$e++]=De[Xe];for(Fe=32768,Je=this.b;Fe<Je;++Fe)Ve[$e++]=Se[Fe];return this.g=[],this.buffer=Ve};A$s.prototype.v=function(){var $e,Se=this.b;return o$t?this.r?($e=new Uint8Array(Se),$e.set(this.c.subarray(0,Se))):$e=this.c.subarray(0,Se):(this.c.length>Se&&(this.c.length=Se),$e=this.c),this.buffer=$e};function Y$b($e,Se){var Be,De;switch(this.input=$e,this.a=0,(Se||!(Se={}))&&(Se.index&&(this.a=Se.index),Se.verify&&(this.A=Se.verify)),Be=$e[this.a++],De=$e[this.a++],Be&15){case M$m:this.method=M$m;break;default:throw Error("unsupported compression method")}if(((Be<<8)+De)%31!==0)throw Error("invalid fcheck flag:"+((Be<<8)+De)%31);if(De&32)throw Error("fdict flag is not supported");this.q=new A$s($e,{index:this.a,bufferSize:Se.bufferSize,bufferType:Se.bufferType,resize:Se.resize})}Y$b.prototype.k=function(){var $e=this.input,Se,Be;if(Se=this.q.k(),this.a=this.q.a,this.A){Be=($e[this.a++]<<24|$e[this.a++]<<16|$e[this.a++]<<8|$e[this.a++])>>>0;var De=Se;if(typeof De=="string"){var Ve=De.split(""),Fe,Je;for(Fe=0,Je=Ve.length;Fe<Je;Fe++)Ve[Fe]=(Ve[Fe].charCodeAt(0)&255)>>>0;De=Ve}for(var Xe=1,Ke=0,Ye=De.length,or,sr=0;0<Ye;){or=1024<Ye?1024:Ye,Ye-=or;do Xe+=De[sr++],Ke+=Xe;while(--or);Xe%=65521,Ke%=65521}if(Be!==(Ke<<16|Xe)>>>0)throw Error("invalid adler-32 checksum")}return Se};var M$m=8;C$h("Zlib.Inflate",Y$b);C$h("Zlib.Inflate.prototype.decompress",Y$b.prototype.k);var P$q={ADAPTIVE:J$g.s,BLOCK:J$g.t},I$n,m$p,U$e,q$m;if(Object.keys)I$n=Object.keys(P$q);else for(m$p in I$n=[],U$e=0,P$q)I$n[U$e++]=m$p;U$e=0;for(q$m=I$n.length;U$e<q$m;++U$e)m$p=I$n[U$e],C$h("Zlib.Inflate.BufferType."+m$p,P$q[m$p]);var nt$4=tt$2.Zlib,A$r={findSpan:function($e,Se,Be){var De=Be.length-$e-1;if(Se>=Be[De])return De-1;if(Se<=Be[$e])return $e;for(var Ve=$e,Fe=De,Je=Math.floor((Ve+Fe)/2);Se<Be[Je]||Se>=Be[Je+1];)Se<Be[Je]?Fe=Je:Ve=Je,Je=Math.floor((Ve+Fe)/2);return Je},calcBasisFunctions:function($e,Se,Be,De){var Ve=[],Fe=[],Je=[];Ve[0]=1;for(var Xe=1;Xe<=Be;++Xe){Fe[Xe]=Se-De[$e+1-Xe],Je[Xe]=De[$e+Xe]-Se;for(var Ke=0,Ye=0;Ye<Xe;++Ye){var or=Je[Ye+1],sr=Fe[Xe-Ye],cr=Ve[Ye]/(or+sr);Ve[Ye]=Ke+or*cr,Ke=sr*cr}Ve[Xe]=Ke}return Ve},calcBSplinePoint:function($e,Se,Be,De){for(var Ve=this.findSpan($e,De,Se),Fe=this.calcBasisFunctions(Ve,De,$e,Se),Je=new Vector4(0,0,0,0),Xe=0;Xe<=$e;++Xe){var Ke=Be[Ve-$e+Xe],Ye=Fe[Xe],or=Ke.w*Ye;Je.x+=Ke.x*or,Je.y+=Ke.y*or,Je.z+=Ke.z*or,Je.w+=Ke.w*Ye}return Je},calcBasisFunctionDerivatives:function($e,Se,Be,De,Ve){for(var Fe=[],Je=0;Je<=Be;++Je)Fe[Je]=0;for(var Xe=[],Je=0;Je<=De;++Je)Xe[Je]=Fe.slice(0);for(var Ke=[],Je=0;Je<=Be;++Je)Ke[Je]=Fe.slice(0);Ke[0][0]=1;for(var Ye=Fe.slice(0),or=Fe.slice(0),sr=1;sr<=Be;++sr){Ye[sr]=Se-Ve[$e+1-sr],or[sr]=Ve[$e+sr]-Se;for(var cr=0,Br=0;Br<sr;++Br){var tn=or[Br+1],en=Ye[sr-Br];Ke[sr][Br]=tn+en;var an=Ke[Br][sr-1]/Ke[sr][Br];Ke[Br][sr]=cr+tn*an,cr=en*an}Ke[sr][sr]=cr}for(var sr=0;sr<=Be;++sr)Xe[0][sr]=Ke[sr][Be];for(var Br=0;Br<=Be;++Br){for(var rn=0,on=1,sn=[],Je=0;Je<=Be;++Je)sn[Je]=Fe.slice(0);sn[0][0]=1;for(var ln=1;ln<=De;++ln){var cn=0,hn=Br-ln,mn=Be-ln;Br>=ln&&(sn[on][0]=sn[rn][0]/Ke[mn+1][hn],cn=sn[on][0]*Ke[hn][mn]);for(var An=hn>=-1?1:-hn,xn=Br-1<=mn?ln-1:Be-Br,sr=An;sr<=xn;++sr)sn[on][sr]=(sn[rn][sr]-sn[rn][sr-1])/Ke[mn+1][hn+sr],cn+=sn[on][sr]*Ke[hn+sr][mn];Br<=mn&&(sn[on][ln]=-sn[rn][ln-1]/Ke[mn+1][Br],cn+=sn[on][ln]*Ke[Br][mn]),Xe[ln][Br]=cn;var sr=rn;rn=on,on=sr}}for(var Br=Be,ln=1;ln<=De;++ln){for(var sr=0;sr<=Be;++sr)Xe[ln][sr]*=Br;Br*=Be-ln}return Xe},calcBSplineDerivatives:function($e,Se,Be,De,Ve){for(var Fe=Ve<$e?Ve:$e,Je=[],Xe=this.findSpan($e,De,Se),Ke=this.calcBasisFunctionDerivatives(Xe,De,$e,Fe,Se),Ye=[],or=0;or<Be.length;++or){var sr=Be[or].clone(),cr=sr.w;sr.x*=cr,sr.y*=cr,sr.z*=cr,Ye[or]=sr}for(var Br=0;Br<=Fe;++Br){for(var sr=Ye[Xe-$e].clone().multiplyScalar(Ke[Br][0]),tn=1;tn<=$e;++tn)sr.add(Ye[Xe-$e+tn].clone().multiplyScalar(Ke[Br][tn]));Je[Br]=sr}for(var Br=Fe+1;Br<=Ve+1;++Br)Je[Br]=new Vector4(0,0,0);return Je},calcKoverI:function($e,Se){for(var Be=1,De=2;De<=$e;++De)Be*=De;for(var Ve=1,De=2;De<=Se;++De)Ve*=De;for(var De=2;De<=$e-Se;++De)Ve*=De;return Be/Ve},calcRationalCurveDerivatives:function($e){for(var Se=$e.length,Be=[],De=[],Ve=0;Ve<Se;++Ve){var Fe=$e[Ve];Be[Ve]=new Vector3(Fe.x,Fe.y,Fe.z),De[Ve]=Fe.w}for(var Je=[],Xe=0;Xe<Se;++Xe){for(var Ke=Be[Xe].clone(),Ve=1;Ve<=Xe;++Ve)Ke.sub(Je[Xe-Ve].clone().multiplyScalar(this.calcKoverI(Xe,Ve)*De[Ve]));Je[Xe]=Ke.divideScalar(De[0])}return Je},calcNURBSDerivatives:function($e,Se,Be,De,Ve){var Fe=this.calcBSplineDerivatives($e,Se,Be,De,Ve);return this.calcRationalCurveDerivatives(Fe)},calcSurfacePoint:function($e,Se,Be,De,Ve,Fe,Je,Xe){for(var Ke=this.findSpan($e,Fe,Be),Ye=this.findSpan(Se,Je,De),or=this.calcBasisFunctions(Ke,Fe,$e,Be),sr=this.calcBasisFunctions(Ye,Je,Se,De),cr=[],Br=0;Br<=Se;++Br){cr[Br]=new Vector4(0,0,0,0);for(var tn=0;tn<=$e;++tn){var en=Ve[Ke-$e+tn][Ye-Se+Br].clone(),an=en.w;en.x*=an,en.y*=an,en.z*=an,cr[Br].add(en.multiplyScalar(or[tn]))}}for(var rn=new Vector4(0,0,0,0),Br=0;Br<=Se;++Br)rn.add(cr[Br].multiplyScalar(sr[Br]));rn.divideScalar(rn.w),Xe.set(rn.x,rn.y,rn.z)}},e$d=function($e,Se,Be,De,Ve){Curve.call(this),this.degree=$e,this.knots=Se,this.controlPoints=[],this.startKnot=De||0,this.endKnot=Ve||this.knots.length-1;for(var Fe=0;Fe<Be.length;++Fe){var Je=Be[Fe];this.controlPoints[Fe]=new Vector4(Je.x,Je.y,Je.z,Je.w)}};e$d.prototype=Object.create(Curve.prototype);e$d.prototype.constructor=e$d;e$d.prototype.getPoint=function($e,Se){var Be=Se||new Vector3,De=this.knots[this.startKnot]+$e*(this.knots[this.endKnot]-this.knots[this.startKnot]),Ve=A$r.calcBSplinePoint(this.degree,this.knots,this.controlPoints,De);return Ve.w!=1&&Ve.divideScalar(Ve.w),Be.set(Ve.x,Ve.y,Ve.z)};e$d.prototype.getTangent=function($e,Se){var Be=Se||new Vector3,De=this.knots[0]+$e*(this.knots[this.knots.length-1]-this.knots[0]),Ve=A$r.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,De,1);return Be.copy(Ve[1]).normalize(),Be};(function(){var $e,Se,Be;function De(pn){Loader.call(this,pn)}De.prototype=Object.assign(Object.create(Loader.prototype),{constructor:De,load:function(pn,dn,fn,yn){var Sn=this,gn=Sn.path===""?LoaderUtils.extractUrlBase(pn):Sn.path,Cn=new FileLoader(this.manager);Cn.setPath(Sn.path),Cn.setResponseType("arraybuffer"),Cn.load(pn,function(Mn){try{dn(Sn.parse(Mn,gn))}catch(Bn){yn?yn(Bn):console.error(Bn),Sn.manager.itemError(pn)}},fn,yn)},parse:function(pn,dn){if(sr(pn))$e=new Ke().parse(pn);else{var fn=hn(pn);if(!cr(fn))throw new Error("THREE.FBXLoader: Unknown format.");if(Br(fn)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Br(fn));$e=new Xe().parse(fn)}var yn=new TextureLoader$1(this.manager).setPath(this.resourcePath||dn).setCrossOrigin(this.crossOrigin);return new Ve(yn,this.manager).parse($e)}});function Ve(pn,dn){this.textureLoader=pn,this.manager=dn}Ve.prototype={constructor:Ve,parse:function(){Se=this.parseConnections();var pn=this.parseImages(),dn=this.parseTextures(pn),fn=this.parseMaterials(dn),yn=this.parseDeformers(),Sn=new Fe().parse(yn);return this.parseScene(yn,Sn,fn),Be},parseConnections:function(){var pn=new Map;if("Connections"in $e){var dn=$e.Connections.connections;dn.forEach(function(fn){var yn=fn[0],Sn=fn[1],gn=fn[2];pn.has(yn)||pn.set(yn,{parents:[],children:[]});var Cn={ID:Sn,relationship:gn};pn.get(yn).parents.push(Cn),pn.has(Sn)||pn.set(Sn,{parents:[],children:[]});var Mn={ID:yn,relationship:gn};pn.get(Sn).children.push(Mn)})}return pn},parseImages:function(){var pn={},dn={};if("Video"in $e.Objects){var fn=$e.Objects.Video;for(var yn in fn){var Sn=fn[yn],gn=parseInt(yn);if(pn[gn]=Sn.RelativeFilename||Sn.Filename,"Content"in Sn){var Cn=Sn.Content instanceof ArrayBuffer&&Sn.Content.byteLength>0,Mn=typeof Sn.Content=="string"&&Sn.Content!=="";if(Cn||Mn){var Bn=this.parseImage(fn[yn]);dn[Sn.RelativeFilename||Sn.Filename]=Bn}}}}for(var gn in pn){var kn=pn[gn];dn[kn]!==void 0?pn[gn]=dn[kn]:pn[gn]=pn[gn].split("\\").pop()}return pn},parseImage:function(pn){var dn=pn.Content,fn=pn.RelativeFilename||pn.Filename,yn=fn.slice(fn.lastIndexOf(".")+1).toLowerCase(),Sn;switch(yn){case"bmp":Sn="image/bmp";break;case"jpg":case"jpeg":Sn="image/jpeg";break;case"png":Sn="image/png";break;case"tif":Sn="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",fn),Sn="image/tga";break;default:console.warn('FBXLoader: Image type "'+yn+'" is not supported.');return}if(typeof dn=="string")return"data:"+Sn+";base64,"+dn;var gn=new Uint8Array(dn);return window.URL.createObjectURL(new Blob([gn],{type:Sn}))},parseTextures:function(pn){var dn=new Map;if("Texture"in $e.Objects){var fn=$e.Objects.Texture;for(var yn in fn){var Sn=this.parseTexture(fn[yn],pn);dn.set(parseInt(yn),Sn)}}return dn},parseTexture:function(pn,dn){var fn=this.loadTexture(pn,dn);fn.ID=pn.id,fn.name=pn.attrName;var yn=pn.WrapModeU,Sn=pn.WrapModeV,gn=yn!==void 0?yn.value:0,Cn=Sn!==void 0?Sn.value:0;if(fn.wrapS=gn===0?RepeatWrapping:ClampToEdgeWrapping,fn.wrapT=Cn===0?RepeatWrapping:ClampToEdgeWrapping,"Scaling"in pn){var Mn=pn.Scaling.value;fn.repeat.x=Mn[0],fn.repeat.y=Mn[1]}return fn},loadTexture:function(pn,dn){var fn,yn=this.textureLoader.path,Sn=Se.get(pn.id).children;Sn!==void 0&&Sn.length>0&&dn[Sn[0].ID]!==void 0&&(fn=dn[Sn[0].ID],(fn.indexOf("blob:")===0||fn.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));var gn,Cn=pn.FileName.slice(-3).toLowerCase();if(Cn==="tga"){var Mn=this.manager.getHandler(".tga");Mn===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",pn.RelativeFilename),gn=new Texture):gn=Mn.load(fn)}else Cn==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",pn.RelativeFilename),gn=new Texture):gn=this.textureLoader.load(fn);return this.textureLoader.setPath(yn),gn},parseMaterials:function(pn){var dn=new Map;if("Material"in $e.Objects){var fn=$e.Objects.Material;for(var yn in fn){var Sn=this.parseMaterial(fn[yn],pn);Sn!==null&&dn.set(parseInt(yn),Sn)}}return dn},parseMaterial:function(pn,dn){var fn=pn.id,yn=pn.attrName,Sn=pn.ShadingModel;if(typeof Sn=="object"&&(Sn=Sn.value),!Se.has(fn))return null;var gn=this.parseParameters(pn,dn,fn),Cn;switch(Sn.toLowerCase()){case"phong":Cn=new MeshPhongMaterial;break;case"lambert":Cn=new MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',Sn),Cn=new MeshPhongMaterial;break}return Cn.setValues(gn),Cn.name=yn,Cn},parseParameters:function(pn,dn,fn){var yn={};pn.BumpFactor&&(yn.bumpScale=pn.BumpFactor.value),pn.Diffuse?yn.color=new Color().fromArray(pn.Diffuse.value):pn.DiffuseColor&&pn.DiffuseColor.type==="Color"&&(yn.color=new Color().fromArray(pn.DiffuseColor.value)),pn.DisplacementFactor&&(yn.displacementScale=pn.DisplacementFactor.value),pn.Emissive?yn.emissive=new Color().fromArray(pn.Emissive.value):pn.EmissiveColor&&pn.EmissiveColor.type==="Color"&&(yn.emissive=new Color().fromArray(pn.EmissiveColor.value)),pn.EmissiveFactor&&(yn.emissiveIntensity=parseFloat(pn.EmissiveFactor.value)),pn.Opacity&&(yn.opacity=parseFloat(pn.Opacity.value)),yn.opacity<1&&(yn.transparent=!0),pn.ReflectionFactor&&(yn.reflectivity=pn.ReflectionFactor.value),pn.Shininess&&(yn.shininess=pn.Shininess.value),pn.Specular?yn.specular=new Color().fromArray(pn.Specular.value):pn.SpecularColor&&pn.SpecularColor.type==="Color"&&(yn.specular=new Color().fromArray(pn.SpecularColor.value));var Sn=this;return Se.get(fn).children.forEach(function(gn){var Cn=gn.relationship;switch(Cn){case"Bump":yn.bumpMap=Sn.getTexture(dn,gn.ID);break;case"Maya|TEX_ao_map":yn.aoMap=Sn.getTexture(dn,gn.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":yn.map=Sn.getTexture(dn,gn.ID),yn.map.encoding=sRGBEncoding;break;case"DisplacementColor":yn.displacementMap=Sn.getTexture(dn,gn.ID);break;case"EmissiveColor":yn.emissiveMap=Sn.getTexture(dn,gn.ID),yn.emissiveMap.encoding=sRGBEncoding;break;case"NormalMap":case"Maya|TEX_normal_map":yn.normalMap=Sn.getTexture(dn,gn.ID);break;case"ReflectionColor":yn.envMap=Sn.getTexture(dn,gn.ID),yn.envMap.mapping=EquirectangularReflectionMapping,yn.envMap.encoding=sRGBEncoding;break;case"SpecularColor":yn.specularMap=Sn.getTexture(dn,gn.ID),yn.specularMap.encoding=sRGBEncoding;break;case"TransparentColor":case"TransparencyFactor":yn.alphaMap=Sn.getTexture(dn,gn.ID),yn.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",Cn);break}}),yn},getTexture:function(pn,dn){return"LayeredTexture"in $e.Objects&&dn in $e.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),dn=Se.get(dn).children[0].ID),pn.get(dn)},parseDeformers:function(){var pn={},dn={};if("Deformer"in $e.Objects){var fn=$e.Objects.Deformer;for(var yn in fn){var Sn=fn[yn],gn=Se.get(parseInt(yn));if(Sn.attrType==="Skin"){var Cn=this.parseSkeleton(gn,fn);Cn.ID=yn,gn.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),Cn.geometryID=gn.parents[0].ID,pn[yn]=Cn}else if(Sn.attrType==="BlendShape"){var Mn={id:yn};Mn.rawTargets=this.parseMorphTargets(gn,fn),Mn.id=yn,gn.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),dn[yn]=Mn}}}return{skeletons:pn,morphTargets:dn}},parseSkeleton:function(pn,dn){var fn=[];return pn.children.forEach(function(yn){var Sn=dn[yn.ID];if(Sn.attrType==="Cluster"){var gn={ID:yn.ID,indices:[],weights:[],transformLink:new Matrix4().fromArray(Sn.TransformLink.a)};"Indexes"in Sn&&(gn.indices=Sn.Indexes.a,gn.weights=Sn.Weights.a),fn.push(gn)}}),{rawBones:fn,bones:[]}},parseMorphTargets:function(pn,dn){for(var fn=[],yn=0;yn<pn.children.length;yn++){var Sn=pn.children[yn],gn=dn[Sn.ID],Cn={name:gn.attrName,initialWeight:gn.DeformPercent,id:gn.id,fullWeights:gn.FullWeights.a};if(gn.attrType!=="BlendShapeChannel")return;Cn.geoID=Se.get(parseInt(Sn.ID)).children.filter(function(Mn){return Mn.relationship===void 0})[0].ID,fn.push(Cn)}return fn},parseScene:function(pn,dn,fn){Be=new Group$1;var yn=this.parseModels(pn.skeletons,dn,fn),Sn=$e.Objects.Model,gn=this;yn.forEach(function(Mn){var Bn=Sn[Mn.ID];gn.setLookAtProperties(Mn,Bn);var kn=Se.get(Mn.ID).parents;kn.forEach(function(Ln){var Pn=yn.get(Ln.ID);Pn!==void 0&&Pn.add(Mn)}),Mn.parent===null&&Be.add(Mn)}),this.bindSkeleton(pn.skeletons,dn,yn),this.createAmbientLight(),this.setupMorphMaterials(),Be.traverse(function(Mn){if(Mn.userData.transformData){Mn.parent&&(Mn.userData.transformData.parentMatrixWorld=Mn.parent.matrix);var Bn=sn(Mn.userData.transformData);Mn.applyMatrix4(Bn)}});var Cn=new Je().parse();Be.children.length===1&&Be.children[0].isGroup&&(Be.children[0].animations=Cn,Be=Be.children[0]),Be.animations=Cn},parseModels:function(pn,dn,fn){var yn=new Map,Sn=$e.Objects.Model;for(var gn in Sn){var Cn=parseInt(gn),Mn=Sn[gn],Bn=Se.get(Cn),kn=this.buildSkeleton(Bn,pn,Cn,Mn.attrName);if(!kn){switch(Mn.attrType){case"Camera":kn=this.createCamera(Bn);break;case"Light":kn=this.createLight(Bn);break;case"Mesh":kn=this.createMesh(Bn,dn,fn);break;case"NurbsCurve":kn=this.createCurve(Bn,dn);break;case"LimbNode":case"Root":kn=new Bone;break;case"Null":default:kn=new Group$1;break}kn.name=Mn.attrName?PropertyBinding.sanitizeNodeName(Mn.attrName):"",kn.ID=Cn}this.getTransformData(kn,Mn),yn.set(Cn,kn)}return yn},buildSkeleton:function(pn,dn,fn,yn){var Sn=null;return pn.parents.forEach(function(gn){for(var Cn in dn){var Mn=dn[Cn];Mn.rawBones.forEach(function(Bn,kn){if(Bn.ID===gn.ID){var Ln=Sn;Sn=new Bone,Sn.matrixWorld.copy(Bn.transformLink),Sn.name=yn?PropertyBinding.sanitizeNodeName(yn):"",Sn.ID=fn,Mn.bones[kn]=Sn,Ln!==null&&Sn.add(Ln)}})}}),Sn},createCamera:function(pn){var dn,fn;if(pn.children.forEach(function(Pn){var Vn=$e.Objects.NodeAttribute[Pn.ID];Vn!==void 0&&(fn=Vn)}),fn===void 0)dn=new Object3D;else{var yn=0;fn.CameraProjectionType!==void 0&&fn.CameraProjectionType.value===1&&(yn=1);var Sn=1;fn.NearPlane!==void 0&&(Sn=fn.NearPlane.value/1e3);var gn=1e3;fn.FarPlane!==void 0&&(gn=fn.FarPlane.value/1e3);var Cn=window.innerWidth,Mn=window.innerHeight;fn.AspectWidth!==void 0&&fn.AspectHeight!==void 0&&(Cn=fn.AspectWidth.value,Mn=fn.AspectHeight.value);var Bn=Cn/Mn,kn=45;fn.FieldOfView!==void 0&&(kn=fn.FieldOfView.value);var Ln=fn.FocalLength?fn.FocalLength.value:null;switch(yn){case 0:dn=new PerspectiveCamera(kn,Bn,Sn,gn),Ln!==null&&dn.setFocalLength(Ln);break;case 1:dn=new OrthographicCamera(-Cn/2,Cn/2,Mn/2,-Mn/2,Sn,gn);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+yn+"."),dn=new Object3D;break}}return dn},createLight:function(pn){var dn,fn;if(pn.children.forEach(function(Ln){var Pn=$e.Objects.NodeAttribute[Ln.ID];Pn!==void 0&&(fn=Pn)}),fn===void 0)dn=new Object3D;else{var yn;fn.LightType===void 0?yn=0:yn=fn.LightType.value;var Sn=16777215;fn.Color!==void 0&&(Sn=new Color().fromArray(fn.Color.value));var gn=fn.Intensity===void 0?1:fn.Intensity.value/100;fn.CastLightOnObject!==void 0&&fn.CastLightOnObject.value===0&&(gn=0);var Cn=0;fn.FarAttenuationEnd!==void 0&&(fn.EnableFarAttenuation!==void 0&&fn.EnableFarAttenuation.value===0?Cn=0:Cn=fn.FarAttenuationEnd.value);var Mn=1;switch(yn){case 0:dn=new PointLight(Sn,gn,Cn,Mn);break;case 1:dn=new DirectionalLight(Sn,gn);break;case 2:var Bn=Math.PI/3;fn.InnerAngle!==void 0&&(Bn=MathUtils.degToRad(fn.InnerAngle.value));var kn=0;fn.OuterAngle!==void 0&&(kn=MathUtils.degToRad(fn.OuterAngle.value),kn=Math.max(kn,1)),dn=new SpotLight(Sn,gn,Cn,Bn,kn,Mn);break;default:console.warn("THREE.FBXLoader: Unknown light type "+fn.LightType.value+", defaulting to a PointLight."),dn=new PointLight(Sn,gn);break}fn.CastShadows!==void 0&&fn.CastShadows.value===1&&(dn.castShadow=!0)}return dn},createMesh:function(pn,dn,fn){var yn,Sn=null,gn=null,Cn=[];return pn.children.forEach(function(Mn){dn.has(Mn.ID)&&(Sn=dn.get(Mn.ID)),fn.has(Mn.ID)&&Cn.push(fn.get(Mn.ID))}),Cn.length>1?gn=Cn:Cn.length>0?gn=Cn[0]:(gn=new MeshPhongMaterial({color:13421772}),Cn.push(gn)),"color"in Sn.attributes&&Cn.forEach(function(Mn){Mn.vertexColors=!0}),Sn.FBX_Deformer?(Cn.forEach(function(Mn){Mn.skinning=!0}),yn=new SkinnedMesh(Sn,gn),yn.normalizeSkinWeights()):yn=new Mesh(Sn,gn),yn},createCurve:function(pn,dn){var fn=pn.children.reduce(function(Sn,gn){return dn.has(gn.ID)&&(Sn=dn.get(gn.ID)),Sn},null),yn=new LineBasicMaterial({color:3342591,linewidth:1});return new Line(fn,yn)},getTransformData:function(pn,dn){var fn={};"InheritType"in dn&&(fn.inheritType=parseInt(dn.InheritType.value)),"RotationOrder"in dn?fn.eulerOrder=ln(dn.RotationOrder.value):fn.eulerOrder="ZYX","Lcl_Translation"in dn&&(fn.translation=dn.Lcl_Translation.value),"PreRotation"in dn&&(fn.preRotation=dn.PreRotation.value),"Lcl_Rotation"in dn&&(fn.rotation=dn.Lcl_Rotation.value),"PostRotation"in dn&&(fn.postRotation=dn.PostRotation.value),"Lcl_Scaling"in dn&&(fn.scale=dn.Lcl_Scaling.value),"ScalingOffset"in dn&&(fn.scalingOffset=dn.ScalingOffset.value),"ScalingPivot"in dn&&(fn.scalingPivot=dn.ScalingPivot.value),"RotationOffset"in dn&&(fn.rotationOffset=dn.RotationOffset.value),"RotationPivot"in dn&&(fn.rotationPivot=dn.RotationPivot.value),pn.userData.transformData=fn},setLookAtProperties:function(pn,dn){if("LookAtProperty"in dn){var fn=Se.get(pn.ID).children;fn.forEach(function(yn){if(yn.relationship==="LookAtProperty"){var Sn=$e.Objects.Model[yn.ID];if("Lcl_Translation"in Sn){var gn=Sn.Lcl_Translation.value;pn.target!==void 0?(pn.target.position.fromArray(gn),Be.add(pn.target)):pn.lookAt(new Vector3().fromArray(gn))}}})}},bindSkeleton:function(pn,dn,fn){var yn=this.parsePoseNodes();for(var Sn in pn){var gn=pn[Sn],Cn=Se.get(parseInt(gn.ID)).parents;Cn.forEach(function(Mn){if(dn.has(Mn.ID)){var Bn=Mn.ID,kn=Se.get(Bn);kn.parents.forEach(function(Ln){if(fn.has(Ln.ID)){var Pn=fn.get(Ln.ID);Pn.bind(new Skeleton(gn.bones),yn[Ln.ID])}})}})}},parsePoseNodes:function(){var pn={};if("Pose"in $e.Objects){var dn=$e.Objects.Pose;for(var fn in dn)if(dn[fn].attrType==="BindPose"){var yn=dn[fn].PoseNode;Array.isArray(yn)?yn.forEach(function(Sn){pn[Sn.Node]=new Matrix4().fromArray(Sn.Matrix.a)}):pn[yn.Node]=new Matrix4().fromArray(yn.Matrix.a)}}return pn},createAmbientLight:function(){if("GlobalSettings"in $e&&"AmbientColor"in $e.GlobalSettings){var pn=$e.GlobalSettings.AmbientColor.value,dn=pn[0],fn=pn[1],yn=pn[2];if(dn!==0||fn!==0||yn!==0){var Sn=new Color(dn,fn,yn);Be.add(new AmbientLight(Sn,1))}}},setupMorphMaterials:function(){var pn=this;Be.traverse(function(dn){dn.isMesh&&dn.geometry.morphAttributes.position&&dn.geometry.morphAttributes.position.length&&(Array.isArray(dn.material)?dn.material.forEach(function(fn,yn){pn.setupMorphMaterial(dn,fn,yn)}):pn.setupMorphMaterial(dn,dn.material))})},setupMorphMaterial:function(pn,dn,fn){var yn=pn.uuid,Sn=dn.uuid,gn=!1;if(Be.traverse(function(Mn){Mn.isMesh&&(Array.isArray(Mn.material)?Mn.material.forEach(function(Bn){Bn.uuid===Sn&&Mn.uuid!==yn&&(gn=!0)}):Mn.material.uuid===Sn&&Mn.uuid!==yn&&(gn=!0))}),gn===!0){var Cn=dn.clone();Cn.morphTargets=!0,fn===void 0?pn.material=Cn:pn.material[fn]=Cn}else dn.morphTargets=!0}};function Fe(){}Fe.prototype={constructor:Fe,parse:function(pn){var dn=new Map;if("Geometry"in $e.Objects){var fn=$e.Objects.Geometry;for(var yn in fn){var Sn=Se.get(parseInt(yn)),gn=this.parseGeometry(Sn,fn[yn],pn);dn.set(parseInt(yn),gn)}}return dn},parseGeometry:function(pn,dn,fn){switch(dn.attrType){case"Mesh":return this.parseMeshGeometry(pn,dn,fn);case"NurbsCurve":return this.parseNurbsGeometry(dn)}},parseMeshGeometry:function(pn,dn,fn){var yn=fn.skeletons,Sn=[],gn=pn.parents.map(function(Ln){return $e.Objects.Model[Ln.ID]});if(gn.length!==0){var Cn=pn.children.reduce(function(Ln,Pn){return yn[Pn.ID]!==void 0&&(Ln=yn[Pn.ID]),Ln},null);pn.children.forEach(function(Ln){fn.morphTargets[Ln.ID]!==void 0&&Sn.push(fn.morphTargets[Ln.ID])});var Mn=gn[0],Bn={};"RotationOrder"in Mn&&(Bn.eulerOrder=ln(Mn.RotationOrder.value)),"InheritType"in Mn&&(Bn.inheritType=parseInt(Mn.InheritType.value)),"GeometricTranslation"in Mn&&(Bn.translation=Mn.GeometricTranslation.value),"GeometricRotation"in Mn&&(Bn.rotation=Mn.GeometricRotation.value),"GeometricScaling"in Mn&&(Bn.scale=Mn.GeometricScaling.value);var kn=sn(Bn);return this.genGeometry(dn,Cn,Sn,kn)}},genGeometry:function(pn,dn,fn,yn){var Sn=new BufferGeometry;pn.attrName&&(Sn.name=pn.attrName);var gn=this.parseGeoNode(pn,dn),Cn=this.genBuffers(gn),Mn=new Float32BufferAttribute(Cn.vertex,3);if(Mn.applyMatrix4(yn),Sn.setAttribute("position",Mn),Cn.colors.length>0&&Sn.setAttribute("color",new Float32BufferAttribute(Cn.colors,3)),dn&&(Sn.setAttribute("skinIndex",new Uint16BufferAttribute(Cn.weightsIndices,4)),Sn.setAttribute("skinWeight",new Float32BufferAttribute(Cn.vertexWeights,4)),Sn.FBX_Deformer=dn),Cn.normal.length>0){var Bn=new Matrix3().getNormalMatrix(yn),kn=new Float32BufferAttribute(Cn.normal,3);kn.applyNormalMatrix(Bn),Sn.setAttribute("normal",kn)}if(Cn.uvs.forEach(function(ni,Rn){var In="uv"+(Rn+1).toString();Rn===0&&(In="uv"),Sn.setAttribute(In,new Float32BufferAttribute(Cn.uvs[Rn],2))}),gn.material&&gn.material.mappingType!=="AllSame"){var Ln=Cn.materialIndex[0],Pn=0;if(Cn.materialIndex.forEach(function(ni,Rn){ni!==Ln&&(Sn.addGroup(Pn,Rn-Pn,Ln),Ln=ni,Pn=Rn)}),Sn.groups.length>0){var Vn=Sn.groups[Sn.groups.length-1],Yn=Vn.start+Vn.count;Yn!==Cn.materialIndex.length&&Sn.addGroup(Yn,Cn.materialIndex.length-Yn,Ln)}Sn.groups.length===0&&Sn.addGroup(0,Cn.materialIndex.length,Cn.materialIndex[0])}return this.addMorphTargets(Sn,pn,fn,yn),Sn},parseGeoNode:function(pn,dn){var fn={};if(fn.vertexPositions=pn.Vertices!==void 0?pn.Vertices.a:[],fn.vertexIndices=pn.PolygonVertexIndex!==void 0?pn.PolygonVertexIndex.a:[],pn.LayerElementColor&&(fn.color=this.parseVertexColors(pn.LayerElementColor[0])),pn.LayerElementMaterial&&(fn.material=this.parseMaterialIndices(pn.LayerElementMaterial[0])),pn.LayerElementNormal&&(fn.normal=this.parseNormals(pn.LayerElementNormal[0])),pn.LayerElementUV){fn.uv=[];for(var yn=0;pn.LayerElementUV[yn];)fn.uv.push(this.parseUVs(pn.LayerElementUV[yn])),yn++}return fn.weightTable={},dn!==null&&(fn.skeleton=dn,dn.rawBones.forEach(function(Sn,gn){Sn.indices.forEach(function(Cn,Mn){fn.weightTable[Cn]===void 0&&(fn.weightTable[Cn]=[]),fn.weightTable[Cn].push({id:gn,weight:Sn.weights[Mn]})})})),fn},genBuffers:function(pn){var dn={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},fn=0,yn=0,Sn=!1,gn=[],Cn=[],Mn=[],Bn=[],kn=[],Ln=[],Pn=this;return pn.vertexIndices.forEach(function(Vn,Yn){var ni=!1;Vn<0&&(Vn=Vn^-1,ni=!0);var Rn=[],In=[];if(gn.push(Vn*3,Vn*3+1,Vn*3+2),pn.color){var Gn=an(Yn,fn,Vn,pn.color);Mn.push(Gn[0],Gn[1],Gn[2])}if(pn.skeleton){if(pn.weightTable[Vn]!==void 0&&pn.weightTable[Vn].forEach(function(Qn){In.push(Qn.weight),Rn.push(Qn.id)}),In.length>4){Sn||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),Sn=!0);var Fn=[0,0,0,0],Hn=[0,0,0,0];In.forEach(function(Qn,Zn){var si=Qn,ei=Rn[Zn];Hn.forEach(function(hi,Un,Wn){if(si>hi){Wn[Un]=si,si=hi;var Ai=Fn[Un];Fn[Un]=ei,ei=Ai}})}),Rn=Fn,In=Hn}for(;In.length<4;)In.push(0),Rn.push(0);for(var Dn=0;Dn<4;++Dn)kn.push(In[Dn]),Ln.push(Rn[Dn])}if(pn.normal){var Gn=an(Yn,fn,Vn,pn.normal);Cn.push(Gn[0],Gn[1],Gn[2])}if(pn.material&&pn.material.mappingType!=="AllSame")var zn=an(Yn,fn,Vn,pn.material)[0];pn.uv&&pn.uv.forEach(function(Qn,Zn){var si=an(Yn,fn,Vn,Qn);Bn[Zn]===void 0&&(Bn[Zn]=[]),Bn[Zn].push(si[0]),Bn[Zn].push(si[1])}),yn++,ni&&(Pn.genFace(dn,pn,gn,zn,Cn,Mn,Bn,kn,Ln,yn),fn++,yn=0,gn=[],Cn=[],Mn=[],Bn=[],kn=[],Ln=[])}),dn},genFace:function(pn,dn,fn,yn,Sn,gn,Cn,Mn,Bn,kn){for(var Ln=2;Ln<kn;Ln++)pn.vertex.push(dn.vertexPositions[fn[0]]),pn.vertex.push(dn.vertexPositions[fn[1]]),pn.vertex.push(dn.vertexPositions[fn[2]]),pn.vertex.push(dn.vertexPositions[fn[(Ln-1)*3]]),pn.vertex.push(dn.vertexPositions[fn[(Ln-1)*3+1]]),pn.vertex.push(dn.vertexPositions[fn[(Ln-1)*3+2]]),pn.vertex.push(dn.vertexPositions[fn[Ln*3]]),pn.vertex.push(dn.vertexPositions[fn[Ln*3+1]]),pn.vertex.push(dn.vertexPositions[fn[Ln*3+2]]),dn.skeleton&&(pn.vertexWeights.push(Mn[0]),pn.vertexWeights.push(Mn[1]),pn.vertexWeights.push(Mn[2]),pn.vertexWeights.push(Mn[3]),pn.vertexWeights.push(Mn[(Ln-1)*4]),pn.vertexWeights.push(Mn[(Ln-1)*4+1]),pn.vertexWeights.push(Mn[(Ln-1)*4+2]),pn.vertexWeights.push(Mn[(Ln-1)*4+3]),pn.vertexWeights.push(Mn[Ln*4]),pn.vertexWeights.push(Mn[Ln*4+1]),pn.vertexWeights.push(Mn[Ln*4+2]),pn.vertexWeights.push(Mn[Ln*4+3]),pn.weightsIndices.push(Bn[0]),pn.weightsIndices.push(Bn[1]),pn.weightsIndices.push(Bn[2]),pn.weightsIndices.push(Bn[3]),pn.weightsIndices.push(Bn[(Ln-1)*4]),pn.weightsIndices.push(Bn[(Ln-1)*4+1]),pn.weightsIndices.push(Bn[(Ln-1)*4+2]),pn.weightsIndices.push(Bn[(Ln-1)*4+3]),pn.weightsIndices.push(Bn[Ln*4]),pn.weightsIndices.push(Bn[Ln*4+1]),pn.weightsIndices.push(Bn[Ln*4+2]),pn.weightsIndices.push(Bn[Ln*4+3])),dn.color&&(pn.colors.push(gn[0]),pn.colors.push(gn[1]),pn.colors.push(gn[2]),pn.colors.push(gn[(Ln-1)*3]),pn.colors.push(gn[(Ln-1)*3+1]),pn.colors.push(gn[(Ln-1)*3+2]),pn.colors.push(gn[Ln*3]),pn.colors.push(gn[Ln*3+1]),pn.colors.push(gn[Ln*3+2])),dn.material&&dn.material.mappingType!=="AllSame"&&(pn.materialIndex.push(yn),pn.materialIndex.push(yn),pn.materialIndex.push(yn)),dn.normal&&(pn.normal.push(Sn[0]),pn.normal.push(Sn[1]),pn.normal.push(Sn[2]),pn.normal.push(Sn[(Ln-1)*3]),pn.normal.push(Sn[(Ln-1)*3+1]),pn.normal.push(Sn[(Ln-1)*3+2]),pn.normal.push(Sn[Ln*3]),pn.normal.push(Sn[Ln*3+1]),pn.normal.push(Sn[Ln*3+2])),dn.uv&&dn.uv.forEach(function(Pn,Vn){pn.uvs[Vn]===void 0&&(pn.uvs[Vn]=[]),pn.uvs[Vn].push(Cn[Vn][0]),pn.uvs[Vn].push(Cn[Vn][1]),pn.uvs[Vn].push(Cn[Vn][(Ln-1)*2]),pn.uvs[Vn].push(Cn[Vn][(Ln-1)*2+1]),pn.uvs[Vn].push(Cn[Vn][Ln*2]),pn.uvs[Vn].push(Cn[Vn][Ln*2+1])})},addMorphTargets:function(pn,dn,fn,yn){if(fn.length!==0){pn.morphTargetsRelative=!0,pn.morphAttributes.position=[];var Sn=this;fn.forEach(function(gn){gn.rawTargets.forEach(function(Cn){var Mn=$e.Objects.Geometry[Cn.geoID];Mn!==void 0&&Sn.genMorphGeometry(pn,dn,Mn,yn,Cn.name)})})}},genMorphGeometry:function(pn,dn,fn,yn,Sn){for(var gn=dn.PolygonVertexIndex!==void 0?dn.PolygonVertexIndex.a:[],Cn=fn.Vertices!==void 0?fn.Vertices.a:[],Mn=fn.Indexes!==void 0?fn.Indexes.a:[],Bn=pn.attributes.position.count*3,kn=new Float32Array(Bn),Ln=0;Ln<Mn.length;Ln++){var Pn=Mn[Ln]*3;kn[Pn]=Cn[Ln*3],kn[Pn+1]=Cn[Ln*3+1],kn[Pn+2]=Cn[Ln*3+2]}var Vn={vertexIndices:gn,vertexPositions:kn},Yn=this.genBuffers(Vn),ni=new Float32BufferAttribute(Yn.vertex,3);ni.name=Sn||fn.attrName,ni.applyMatrix4(yn),pn.morphAttributes.position.push(ni)},parseNormals:function(pn){var dn=pn.MappingInformationType,fn=pn.ReferenceInformationType,yn=pn.Normals.a,Sn=[];return fn==="IndexToDirect"&&("NormalIndex"in pn?Sn=pn.NormalIndex.a:"NormalsIndex"in pn&&(Sn=pn.NormalsIndex.a)),{dataSize:3,buffer:yn,indices:Sn,mappingType:dn,referenceType:fn}},parseUVs:function(pn){var dn=pn.MappingInformationType,fn=pn.ReferenceInformationType,yn=pn.UV.a,Sn=[];return fn==="IndexToDirect"&&(Sn=pn.UVIndex.a),{dataSize:2,buffer:yn,indices:Sn,mappingType:dn,referenceType:fn}},parseVertexColors:function(pn){var dn=pn.MappingInformationType,fn=pn.ReferenceInformationType,yn=pn.Colors.a,Sn=[];return fn==="IndexToDirect"&&(Sn=pn.ColorIndex.a),{dataSize:4,buffer:yn,indices:Sn,mappingType:dn,referenceType:fn}},parseMaterialIndices:function(pn){var dn=pn.MappingInformationType,fn=pn.ReferenceInformationType;if(dn==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:fn};for(var yn=pn.Materials.a,Sn=[],gn=0;gn<yn.length;++gn)Sn.push(gn);return{dataSize:1,buffer:yn,indices:Sn,mappingType:dn,referenceType:fn}},parseNurbsGeometry:function(pn){if(e$d===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new BufferGeometry;var dn=parseInt(pn.Order);if(isNaN(dn))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",pn.Order,pn.id),new BufferGeometry;for(var fn=dn-1,yn=pn.KnotVector.a,Sn=[],gn=pn.Points.a,Cn=0,Mn=gn.length;Cn<Mn;Cn+=4)Sn.push(new Vector4().fromArray(gn,Cn));var Bn,kn;if(pn.Form==="Closed")Sn.push(Sn[0]);else if(pn.Form==="Periodic"){Bn=fn,kn=yn.length-1-Bn;for(var Cn=0;Cn<fn;++Cn)Sn.push(Sn[Cn])}var Ln=new e$d(fn,yn,Sn,Bn,kn),Pn=Ln.getPoints(Sn.length*7),Vn=new Float32Array(Pn.length*3);Pn.forEach(function(ni,Rn){ni.toArray(Vn,Rn*3)});var Yn=new BufferGeometry;return Yn.setAttribute("position",new BufferAttribute(Vn,3)),Yn}};function Je(){}Je.prototype={constructor:Je,parse:function(){var pn=[],dn=this.parseClips();if(dn!==void 0)for(var fn in dn){var yn=dn[fn],Sn=this.addClip(yn);pn.push(Sn)}return pn},parseClips:function(){if($e.Objects.AnimationCurve!==void 0){var pn=this.parseAnimationCurveNodes();this.parseAnimationCurves(pn);var dn=this.parseAnimationLayers(pn),fn=this.parseAnimStacks(dn);return fn}},parseAnimationCurveNodes:function(){var pn=$e.Objects.AnimationCurveNode,dn=new Map;for(var fn in pn){var yn=pn[fn];if(yn.attrName.match(/S|R|T|DeformPercent/)!==null){var Sn={id:yn.id,attr:yn.attrName,curves:{}};dn.set(Sn.id,Sn)}}return dn},parseAnimationCurves:function(pn){var dn=$e.Objects.AnimationCurve;for(var fn in dn){var yn={id:dn[fn].id,times:dn[fn].KeyTime.a.map(tn),values:dn[fn].KeyValueFloat.a},Sn=Se.get(yn.id);if(Sn!==void 0){var gn=Sn.parents[0].ID,Cn=Sn.parents[0].relationship;Cn.match(/X/)?pn.get(gn).curves.x=yn:Cn.match(/Y/)?pn.get(gn).curves.y=yn:Cn.match(/Z/)?pn.get(gn).curves.z=yn:Cn.match(/d|DeformPercent/)&&pn.has(gn)&&(pn.get(gn).curves.morph=yn)}}},parseAnimationLayers:function(pn){var dn=$e.Objects.AnimationLayer,fn=new Map;for(var yn in dn){var Sn=[],gn=Se.get(parseInt(yn));if(gn!==void 0){var Cn=gn.children;Cn.forEach(function(Mn,Bn){if(pn.has(Mn.ID)){var kn=pn.get(Mn.ID);if(kn.curves.x!==void 0||kn.curves.y!==void 0||kn.curves.z!==void 0){if(Sn[Bn]===void 0){var Ln=Se.get(Mn.ID).parents.filter(function(In){return In.relationship!==void 0})[0].ID;if(Ln!==void 0){var Pn=$e.Objects.Model[Ln.toString()];if(Pn===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",Mn);return}var Vn={modelName:Pn.attrName?PropertyBinding.sanitizeNodeName(Pn.attrName):"",ID:Pn.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Be.traverse(function(In){In.ID===Pn.id&&(Vn.transform=In.matrix,In.userData.transformData&&(Vn.eulerOrder=In.userData.transformData.eulerOrder))}),Vn.transform||(Vn.transform=new Matrix4),"PreRotation"in Pn&&(Vn.preRotation=Pn.PreRotation.value),"PostRotation"in Pn&&(Vn.postRotation=Pn.PostRotation.value),Sn[Bn]=Vn}}Sn[Bn]&&(Sn[Bn][kn.attr]=kn)}else if(kn.curves.morph!==void 0){if(Sn[Bn]===void 0){var Yn=Se.get(Mn.ID).parents.filter(function(Hn){return Hn.relationship!==void 0})[0].ID,ni=Se.get(Yn).parents[0].ID,Rn=Se.get(ni).parents[0].ID,Ln=Se.get(Rn).parents[0].ID,Pn=$e.Objects.Model[Ln],Vn={modelName:Pn.attrName?PropertyBinding.sanitizeNodeName(Pn.attrName):"",morphName:$e.Objects.Deformer[Yn].attrName};Sn[Bn]=Vn}Sn[Bn][kn.attr]=kn}}}),fn.set(parseInt(yn),Sn)}}return fn},parseAnimStacks:function(pn){var dn=$e.Objects.AnimationStack,fn={};for(var yn in dn){var Sn=Se.get(parseInt(yn)).children;Sn.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var gn=pn.get(Sn[0].ID);fn[yn]={name:dn[yn].attrName,layer:gn}}return fn},addClip:function(pn){var dn=[],fn=this;return pn.layer.forEach(function(yn){dn=dn.concat(fn.generateTracks(yn))}),new AnimationClip(pn.name,-1,dn)},generateTracks:function(pn){var dn=[],fn=new Vector3,yn=new Quaternion,Sn=new Vector3;if(pn.transform&&pn.transform.decompose(fn,yn,Sn),fn=fn.toArray(),yn=new Euler().setFromQuaternion(yn,pn.eulerOrder).toArray(),Sn=Sn.toArray(),pn.T!==void 0&&Object.keys(pn.T.curves).length>0){var gn=this.generateVectorTrack(pn.modelName,pn.T.curves,fn,"position");gn!==void 0&&dn.push(gn)}if(pn.R!==void 0&&Object.keys(pn.R.curves).length>0){var Cn=this.generateRotationTrack(pn.modelName,pn.R.curves,yn,pn.preRotation,pn.postRotation,pn.eulerOrder);Cn!==void 0&&dn.push(Cn)}if(pn.S!==void 0&&Object.keys(pn.S.curves).length>0){var Mn=this.generateVectorTrack(pn.modelName,pn.S.curves,Sn,"scale");Mn!==void 0&&dn.push(Mn)}if(pn.DeformPercent!==void 0){var Bn=this.generateMorphTrack(pn);Bn!==void 0&&dn.push(Bn)}return dn},generateVectorTrack:function(pn,dn,fn,yn){var Sn=this.getTimesForAllAxes(dn),gn=this.getKeyframeTrackValues(Sn,dn,fn);return new VectorKeyframeTrack(pn+"."+yn,Sn,gn)},generateRotationTrack:function(pn,dn,fn,yn,Sn,gn){dn.x!==void 0&&(this.interpolateRotations(dn.x),dn.x.values=dn.x.values.map(MathUtils.degToRad)),dn.y!==void 0&&(this.interpolateRotations(dn.y),dn.y.values=dn.y.values.map(MathUtils.degToRad)),dn.z!==void 0&&(this.interpolateRotations(dn.z),dn.z.values=dn.z.values.map(MathUtils.degToRad));var Cn=this.getTimesForAllAxes(dn),Mn=this.getKeyframeTrackValues(Cn,dn,fn);yn!==void 0&&(yn=yn.map(MathUtils.degToRad),yn.push(gn),yn=new Euler().fromArray(yn),yn=new Quaternion().setFromEuler(yn)),Sn!==void 0&&(Sn=Sn.map(MathUtils.degToRad),Sn.push(gn),Sn=new Euler().fromArray(Sn),Sn=new Quaternion().setFromEuler(Sn).inverse());for(var Bn=new Quaternion,kn=new Euler,Ln=[],Pn=0;Pn<Mn.length;Pn+=3)kn.set(Mn[Pn],Mn[Pn+1],Mn[Pn+2],gn),Bn.setFromEuler(kn),yn!==void 0&&Bn.premultiply(yn),Sn!==void 0&&Bn.multiply(Sn),Bn.toArray(Ln,Pn/3*4);return new QuaternionKeyframeTrack(pn+".quaternion",Cn,Ln)},generateMorphTrack:function(pn){var dn=pn.DeformPercent.curves.morph,fn=dn.values.map(function(Sn){return Sn/100}),yn=Be.getObjectByName(pn.modelName).morphTargetDictionary[pn.morphName];return new NumberKeyframeTrack(pn.modelName+".morphTargetInfluences["+yn+"]",dn.times,fn)},getTimesForAllAxes:function(pn){var dn=[];return pn.x!==void 0&&(dn=dn.concat(pn.x.times)),pn.y!==void 0&&(dn=dn.concat(pn.y.times)),pn.z!==void 0&&(dn=dn.concat(pn.z.times)),dn=dn.sort(function(fn,yn){return fn-yn}).filter(function(fn,yn,Sn){return Sn.indexOf(fn)==yn}),dn},getKeyframeTrackValues:function(pn,dn,fn){var yn=fn,Sn=[],gn=-1,Cn=-1,Mn=-1;return pn.forEach(function(Bn){if(dn.x&&(gn=dn.x.times.indexOf(Bn)),dn.y&&(Cn=dn.y.times.indexOf(Bn)),dn.z&&(Mn=dn.z.times.indexOf(Bn)),gn!==-1){var kn=dn.x.values[gn];Sn.push(kn),yn[0]=kn}else Sn.push(yn[0]);if(Cn!==-1){var Ln=dn.y.values[Cn];Sn.push(Ln),yn[1]=Ln}else Sn.push(yn[1]);if(Mn!==-1){var Pn=dn.z.values[Mn];Sn.push(Pn),yn[2]=Pn}else Sn.push(yn[2])}),Sn},interpolateRotations:function(pn){for(var dn=1;dn<pn.values.length;dn++){var fn=pn.values[dn-1],yn=pn.values[dn]-fn,Sn=Math.abs(yn);if(Sn>=180){for(var gn=Sn/180,Cn=yn/gn,Mn=fn+Cn,Bn=pn.times[dn-1],kn=pn.times[dn]-Bn,Ln=kn/gn,Pn=Bn+Ln,Vn=[],Yn=[];Pn<pn.times[dn];)Vn.push(Pn),Pn+=Ln,Yn.push(Mn),Mn+=Cn;pn.times=xn(pn.times,dn,Vn),pn.values=xn(pn.values,dn,Yn)}}}};function Xe(){}Xe.prototype={constructor:Xe,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(pn){this.nodeStack.push(pn),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(pn,dn){this.currentProp=pn,this.currentPropName=dn},parse:function(pn){this.currentIndent=0,this.allNodes=new or,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var dn=this,fn=pn.split(/[\r\n]+/);return fn.forEach(function(yn,Sn){var gn=yn.match(/^[\s\t]*;/),Cn=yn.match(/^[\s\t]*$/);if(!(gn||Cn)){var Mn=yn.match("^\\t{"+dn.currentIndent+"}(\\w+):(.*){",""),Bn=yn.match("^\\t{"+dn.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),kn=yn.match("^\\t{"+(dn.currentIndent-1)+"}}");Mn?dn.parseNodeBegin(yn,Mn):Bn?dn.parseNodeProperty(yn,Bn,fn[++Sn]):kn?dn.popStack():yn.match(/^[^\s\t}]/)&&dn.parseNodePropertyContinued(yn)}}),this.allNodes},parseNodeBegin:function(pn,dn){var fn=dn[1].trim().replace(/^"/,"").replace(/"$/,""),yn=dn[2].split(",").map(function(Mn){return Mn.trim().replace(/^"/,"").replace(/"$/,"")}),Sn={name:fn},gn=this.parseNodeAttr(yn),Cn=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(fn,Sn):fn in Cn?(fn==="PoseNode"?Cn.PoseNode.push(Sn):Cn[fn].id!==void 0&&(Cn[fn]={},Cn[fn][Cn[fn].id]=Cn[fn]),gn.id!==""&&(Cn[fn][gn.id]=Sn)):typeof gn.id=="number"?(Cn[fn]={},Cn[fn][gn.id]=Sn):fn!=="Properties70"&&(fn==="PoseNode"?Cn[fn]=[Sn]:Cn[fn]=Sn),typeof gn.id=="number"&&(Sn.id=gn.id),gn.name!==""&&(Sn.attrName=gn.name),gn.type!==""&&(Sn.attrType=gn.type),this.pushStack(Sn)},parseNodeAttr:function(pn){var dn=pn[0];pn[0]!==""&&(dn=parseInt(pn[0]),isNaN(dn)&&(dn=pn[0]));var fn="",yn="";return pn.length>1&&(fn=pn[1].replace(/^(\w+)::/,""),yn=pn[2]),{id:dn,name:fn,type:yn}},parseNodeProperty:function(pn,dn,fn){var yn=dn[1].replace(/^"/,"").replace(/"$/,"").trim(),Sn=dn[2].replace(/^"/,"").replace(/"$/,"").trim();yn==="Content"&&Sn===","&&(Sn=fn.replace(/"/g,"").replace(/,$/,"").trim());var gn=this.getCurrentNode(),Cn=gn.name;if(Cn==="Properties70"){this.parseNodeSpecialProperty(pn,yn,Sn);return}if(yn==="C"){var Mn=Sn.split(",").slice(1),Bn=parseInt(Mn[0]),kn=parseInt(Mn[1]),Ln=Sn.split(",").slice(3);Ln=Ln.map(function(Pn){return Pn.trim().replace(/^"/,"")}),yn="connections",Sn=[Bn,kn],mn(Sn,Ln),gn[yn]===void 0&&(gn[yn]=[])}yn==="Node"&&(gn.id=Sn),yn in gn&&Array.isArray(gn[yn])?gn[yn].push(Sn):yn!=="a"?gn[yn]=Sn:gn.a=Sn,this.setCurrentProp(gn,yn),yn==="a"&&Sn.slice(-1)!==","&&(gn.a=cn(Sn))},parseNodePropertyContinued:function(pn){var dn=this.getCurrentNode();dn.a+=pn,pn.slice(-1)!==","&&(dn.a=cn(dn.a))},parseNodeSpecialProperty:function(pn,dn,fn){var yn=fn.split('",').map(function(kn){return kn.trim().replace(/^\"/,"").replace(/\s/,"_")}),Sn=yn[0],gn=yn[1],Cn=yn[2],Mn=yn[3],Bn=yn[4];switch(gn){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":Bn=parseFloat(Bn);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":Bn=cn(Bn);break}this.getPrevNode()[Sn]={type:gn,type2:Cn,flag:Mn,value:Bn},this.setCurrentProp(this.getPrevNode(),Sn)}};function Ke(){}Ke.prototype={constructor:Ke,parse:function(pn){var dn=new Ye(pn);dn.skip(23);var fn=dn.getUint32();console.info("THREE.FBXLoader: FBX binary version: "+fn);for(var yn=new or;!this.endOfContent(dn);){var Sn=this.parseNode(dn,fn);Sn!==null&&yn.add(Sn.name,Sn)}return yn},endOfContent:function(pn){return pn.size()%16===0?(pn.getOffset()+160+16&-16)>=pn.size():pn.getOffset()+160+16>=pn.size()},parseNode:function(pn,dn){var fn={},yn=dn>=7500?pn.getUint64():pn.getUint32(),Sn=dn>=7500?pn.getUint64():pn.getUint32();dn>=7500?pn.getUint64():pn.getUint32();var gn=pn.getUint8(),Cn=pn.getString(gn);if(yn===0)return null;for(var Mn=[],Bn=0;Bn<Sn;Bn++)Mn.push(this.parseProperty(pn));var kn=Mn.length>0?Mn[0]:"",Ln=Mn.length>1?Mn[1]:"",Pn=Mn.length>2?Mn[2]:"";for(fn.singleProperty=Sn===1&&pn.getOffset()===yn;yn>pn.getOffset();){var Vn=this.parseNode(pn,dn);Vn!==null&&this.parseSubNode(Cn,fn,Vn)}return fn.propertyList=Mn,typeof kn=="number"&&(fn.id=kn),Ln!==""&&(fn.attrName=Ln),Pn!==""&&(fn.attrType=Pn),Cn!==""&&(fn.name=Cn),fn},parseSubNode:function(pn,dn,fn){if(fn.singleProperty===!0){var yn=fn.propertyList[0];Array.isArray(yn)?(dn[fn.name]=fn,fn.a=yn):dn[fn.name]=yn}else if(pn==="Connections"&&fn.name==="C"){var Sn=[];fn.propertyList.forEach(function(Pn,Vn){Vn!==0&&Sn.push(Pn)}),dn.connections===void 0&&(dn.connections=[]),dn.connections.push(Sn)}else if(fn.name==="Properties70"){var gn=Object.keys(fn);gn.forEach(function(Pn){dn[Pn]=fn[Pn]})}else if(pn==="Properties70"&&fn.name==="P"){var Cn=fn.propertyList[0],Mn=fn.propertyList[1],Bn=fn.propertyList[2],kn=fn.propertyList[3],Ln;Cn.indexOf("Lcl ")===0&&(Cn=Cn.replace("Lcl ","Lcl_")),Mn.indexOf("Lcl ")===0&&(Mn=Mn.replace("Lcl ","Lcl_")),Mn==="Color"||Mn==="ColorRGB"||Mn==="Vector"||Mn==="Vector3D"||Mn.indexOf("Lcl_")===0?Ln=[fn.propertyList[4],fn.propertyList[5],fn.propertyList[6]]:Ln=fn.propertyList[4],dn[Cn]={type:Mn,type2:Bn,flag:kn,value:Ln}}else dn[fn.name]===void 0?typeof fn.id=="number"?(dn[fn.name]={},dn[fn.name][fn.id]=fn):dn[fn.name]=fn:fn.name==="PoseNode"?(Array.isArray(dn[fn.name])||(dn[fn.name]=[dn[fn.name]]),dn[fn.name].push(fn)):dn[fn.name][fn.id]===void 0&&(dn[fn.name][fn.id]=fn)},parseProperty:function(pn){var dn=pn.getString(1);switch(dn){case"C":return pn.getBoolean();case"D":return pn.getFloat64();case"F":return pn.getFloat32();case"I":return pn.getInt32();case"L":return pn.getInt64();case"R":var fn=pn.getUint32();return pn.getArrayBuffer(fn);case"S":var fn=pn.getUint32();return pn.getString(fn);case"Y":return pn.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var yn=pn.getUint32(),Sn=pn.getUint32(),gn=pn.getUint32();if(Sn===0)switch(dn){case"b":case"c":return pn.getBooleanArray(yn);case"d":return pn.getFloat64Array(yn);case"f":return pn.getFloat32Array(yn);case"i":return pn.getInt32Array(yn);case"l":return pn.getInt64Array(yn)}typeof nt$4>"u"&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var Cn=new nt$4.Inflate(new Uint8Array(pn.getArrayBuffer(gn))),Mn=new Ye(Cn.decompress().buffer);switch(dn){case"b":case"c":return Mn.getBooleanArray(yn);case"d":return Mn.getFloat64Array(yn);case"f":return Mn.getFloat32Array(yn);case"i":return Mn.getInt32Array(yn);case"l":return Mn.getInt64Array(yn)}default:throw new Error("THREE.FBXLoader: Unknown property type "+dn)}}};function Ye(pn,dn){this.dv=new DataView(pn),this.offset=0,this.littleEndian=dn!==void 0?dn:!0}Ye.prototype={constructor:Ye,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(pn){this.offset+=pn},getBoolean:function(){return(this.getUint8()&1)===1},getBooleanArray:function(pn){for(var dn=[],fn=0;fn<pn;fn++)dn.push(this.getBoolean());return dn},getUint8:function(){var pn=this.dv.getUint8(this.offset);return this.offset+=1,pn},getInt16:function(){var pn=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,pn},getInt32:function(){var pn=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,pn},getInt32Array:function(pn){for(var dn=[],fn=0;fn<pn;fn++)dn.push(this.getInt32());return dn},getUint32:function(){var pn=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,pn},getInt64:function(){var pn,dn;return this.littleEndian?(pn=this.getUint32(),dn=this.getUint32()):(dn=this.getUint32(),pn=this.getUint32()),dn&2147483648?(dn=~dn&4294967295,pn=~pn&4294967295,pn===4294967295&&(dn=dn+1&4294967295),pn=pn+1&4294967295,-(dn*4294967296+pn)):dn*4294967296+pn},getInt64Array:function(pn){for(var dn=[],fn=0;fn<pn;fn++)dn.push(this.getInt64());return dn},getUint64:function(){var pn,dn;return this.littleEndian?(pn=this.getUint32(),dn=this.getUint32()):(dn=this.getUint32(),pn=this.getUint32()),dn*4294967296+pn},getFloat32:function(){var pn=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,pn},getFloat32Array:function(pn){for(var dn=[],fn=0;fn<pn;fn++)dn.push(this.getFloat32());return dn},getFloat64:function(){var pn=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,pn},getFloat64Array:function(pn){for(var dn=[],fn=0;fn<pn;fn++)dn.push(this.getFloat64());return dn},getArrayBuffer:function(pn){var dn=this.dv.buffer.slice(this.offset,this.offset+pn);return this.offset+=pn,dn},getString:function(pn){for(var dn=[],fn=0;fn<pn;fn++)dn[fn]=this.getUint8();var yn=dn.indexOf(0);return yn>=0&&(dn=dn.slice(0,yn)),LoaderUtils.decodeText(new Uint8Array(dn))}};function or(){}or.prototype={constructor:or,add:function(pn,dn){this[pn]=dn}};function sr(pn){var dn="Kaydara FBX Binary  \0";return pn.byteLength>=dn.length&&dn===hn(pn,0,dn.length)}function cr(pn){var dn=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],fn=0;function yn(Cn){var Mn=pn[Cn-1];return pn=pn.slice(fn+Cn),fn++,Mn}for(var Sn=0;Sn<dn.length;++Sn){var gn=yn(1);if(gn===dn[Sn])return!1}return!0}function Br(pn){var dn=/FBXVersion: (\d+)/,fn=pn.match(dn);if(fn){var yn=parseInt(fn[1]);return yn}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function tn(pn){return pn/46186158e3}var en=[];function an(pn,dn,fn,yn){var Sn;switch(yn.mappingType){case"ByPolygonVertex":Sn=pn;break;case"ByPolygon":Sn=dn;break;case"ByVertice":Sn=fn;break;case"AllSame":Sn=yn.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+yn.mappingType)}yn.referenceType==="IndexToDirect"&&(Sn=yn.indices[Sn]);var gn=Sn*yn.dataSize,Cn=gn+yn.dataSize;return An(en,yn.buffer,gn,Cn)}var rn=new Euler,on=new Vector3;function sn(pn){var dn=new Matrix4,fn=new Matrix4,yn=new Matrix4,Sn=new Matrix4,gn=new Matrix4,Cn=new Matrix4,Mn=new Matrix4,Bn=new Matrix4,kn=new Matrix4,Ln=new Matrix4,Pn=new Matrix4,Vn=pn.inheritType?pn.inheritType:0;if(pn.translation&&dn.setPosition(on.fromArray(pn.translation)),pn.preRotation){var Yn=pn.preRotation.map(MathUtils.degToRad);Yn.push(pn.eulerOrder),fn.makeRotationFromEuler(rn.fromArray(Yn))}if(pn.rotation){var Yn=pn.rotation.map(MathUtils.degToRad);Yn.push(pn.eulerOrder),yn.makeRotationFromEuler(rn.fromArray(Yn))}if(pn.postRotation){var Yn=pn.postRotation.map(MathUtils.degToRad);Yn.push(pn.eulerOrder),Sn.makeRotationFromEuler(rn.fromArray(Yn))}pn.scale&&gn.scale(on.fromArray(pn.scale)),pn.scalingOffset&&Mn.setPosition(on.fromArray(pn.scalingOffset)),pn.scalingPivot&&Cn.setPosition(on.fromArray(pn.scalingPivot)),pn.rotationOffset&&Bn.setPosition(on.fromArray(pn.rotationOffset)),pn.rotationPivot&&kn.setPosition(on.fromArray(pn.rotationPivot)),pn.parentMatrixWorld&&(Ln=pn.parentMatrixWorld);var ni=fn.multiply(yn).multiply(Sn),Rn=new Matrix4;Ln.extractRotation(Rn);var In=new Matrix4;In.copyPosition(Ln);var Gn=new Matrix4;Gn.getInverse(Rn).multiply(Ln);var Fn=new Matrix4;if(Vn===0)Fn.copy(Rn).multiply(ni).multiply(Gn).multiply(gn);else if(Vn===1)Fn.copy(Rn).multiply(Gn).multiply(ni).multiply(gn);else{var Hn=new Matrix4().getInverse(gn),Dn=new Matrix4().multiply(Gn).multiply(Hn);Fn.copy(Rn).multiply(ni).multiply(Dn).multiply(gn)}var zn=new Matrix4().getInverse(kn),Qn=new Matrix4().getInverse(Cn),Zn=new Matrix4;Zn.copy(dn).multiply(Bn).multiply(kn).multiply(fn).multiply(yn).multiply(Sn).multiply(zn).multiply(Mn).multiply(Cn).multiply(gn).multiply(Qn);var si=new Matrix4().copyPosition(Zn),ei=new Matrix4().copy(Ln).multiply(si);return Pn.copyPosition(ei),Zn=new Matrix4().multiply(Pn).multiply(Fn),Zn}function ln(pn){pn=pn||0;var dn=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return pn===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),dn[0]):dn[pn]}function cn(pn){var dn=pn.split(",").map(function(fn){return parseFloat(fn)});return dn}function hn(pn,dn,fn){return dn===void 0&&(dn=0),fn===void 0&&(fn=pn.byteLength),LoaderUtils.decodeText(new Uint8Array(pn,dn,fn))}function mn(pn,dn){for(var fn=0,yn=pn.length,Sn=dn.length;fn<Sn;fn++,yn++)pn[yn]=dn[fn]}function An(pn,dn,fn,yn){for(var Sn=fn,gn=0;Sn<yn;Sn++,gn++)pn[gn]=dn[Sn];return pn}function xn(pn,dn,fn){return pn.slice(0,dn).concat(fn).concat(pn.slice(dn))}return De})();const m$o=window.requestAnimationFrame||($e=>setTimeout($e,16)),F$g=window.cancelAnimationFrame||clearTimeout;function T$f($e,Se=0){Se<=0?m$o($e):m$o(()=>T$f($e,Se-1))}function l$p($e,Se=60){let Be=-1,De=0,Ve=-1;const Fe=1e3/Se;function Je(Xe){Ve===-1&&(Ve=Xe),Be=m$o(Je),!(Xe-De<Fe)&&(De=Xe,$e?.(Xe-Ve))}return Be=m$o(Je),function(){F$g(Be)}}var i$n=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const m$n=new TextureLoader$1;function p$w($e){return i$n(this,null,function*(){return new Promise((Se,Be)=>{m$n.load($e,Se,void 0,Be)}).then(Se=>(Se.encoding=sRGBEncoding,Se.minFilter=NearestFilter,Se.magFilter=NearestFilter,Se))})}function u$t($e){return i$n(this,null,function*(){return p$w($e).then(Se=>{const Be=$e.startsWith("data:")?$e.includes("png"):new URL($e,location.href).pathname.toLowerCase().endsWith(".png");return{texture:Se,transparent:Be}})})}var r$u=Object.defineProperty,n$n=($e,Se,Be)=>Se in $e?r$u($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$m=($e,Se,Be)=>(n$n($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let d$x=class extends M$v{constructor(){super(...arguments),i$m(this,"disposeMethods",[]),i$m(this,"animationFrameDisposer"),i$m(this,"onDispose",Se=>(this.disposeMethods.push(Se),this)),i$m(this,"play",()=>{var Se;return this.start(0),(Se=this.animationFrameDisposer)==null||Se.call(this),this.animationFrameDisposer=l$p(Be=>this.update(Be)),this}),i$m(this,"stop",()=>{var Se;return super.stop(),(Se=this.animationFrameDisposer)==null||Se.call(this),this}),i$m(this,"dispose",()=>{var Se;this.stop(),(Se=this.animationFrameDisposer)==null||Se.call(this),this.disposeMethods.forEach(Be=>Be()),this.disposeMethods=[],j$o(this)})}};function F$f($e,Se=y$x.Linear.None){const Be=new d$x({progress:0}).to({progress:1});return $e!==void 0&&Be.duration($e),Se!==void 0&&Be.easing(Se),Be}var C$g=Object.defineProperty,g$y=Object.defineProperties,d$w=Object.getOwnPropertyDescriptors,t$8=Object.getOwnPropertySymbols,p$v=Object.prototype.hasOwnProperty,a$t=Object.prototype.propertyIsEnumerable,i$l=($e,Se,Be)=>Se in $e?C$g($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$t=($e,Se)=>{for(var Be in Se||(Se={}))p$v.call(Se,Be)&&i$l($e,Be,Se[Be]);if(t$8)for(var Be of t$8(Se))a$t.call(Se,Be)&&i$l($e,Be,Se[Be]);return $e},l$o=($e,Se)=>g$y($e,d$w(Se));const c$v=1,L$h=new Color(16777215);new Color(6522623);const R$g=new Color(16777215);new Color(6522623);const E$n=6,O$f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAIVBMVEUAAAD////////////////////////////////////////PIev5AAAACnRSTlMAG/Py2baba05un7UgfgAAAHJJREFUKM9joBpgLHVSCRdA4metAoJlCJHmVWBgAeNzroKCCVCBLpjACqgJVjCBxRBT2FbBQQJYQAohsBAsUIUQWA4WiEIILAULeCEEloAFtBACizAEMLRgGIphLabDMJ2O6TlM72MGECIIMQIZIxqoBQCPvpJ/e9FaAAAAAABJRU5ErkJggg==",s$f=new TextureLoader$1().load(O$f),U$d={pointTexture:s$f,pointSize:E$n,lineWidth:c$v,lineColor:L$h,pointColor:R$g,lineRenderOrder:20,pointsRenderOrder:20};l$o(r$t({},U$d),{dashed:!0});var B$m={},N$e={get exports(){return B$m},set exports($e){B$m=$e}};N$e.exports=P$p;B$m.default=P$p;function P$p($e,Se,Be){Be=Be||2;var De=Se&&Se.length,Ve=De?Se[0]*Be:$e.length,Fe=G$c($e,0,Ve,Be,!0),Je=[];if(!Fe||Fe.next===Fe.prev)return Je;var Xe,Ke,Ye,or,sr,cr,Br;if(De&&(Fe=I$m($e,Se,Fe,Be)),$e.length>80*Be){Xe=Ye=$e[0],Ke=or=$e[1];for(var tn=Be;tn<Ve;tn+=Be)sr=$e[tn],cr=$e[tn+1],sr<Xe&&(Xe=sr),cr<Ke&&(Ke=cr),sr>Ye&&(Ye=sr),cr>or&&(or=cr);Br=Math.max(Ye-Xe,or-Ke),Br=Br!==0?32767/Br:0}return k$j(Fe,Je,Be,Xe,Ke,Br,0),Je}function G$c($e,Se,Be,De,Ve){var Fe,Je;if(Ve===R$f($e,Se,Be,De)>0)for(Fe=Se;Fe<Be;Fe+=De)Je=$$8(Fe,$e[Fe],$e[Fe+1],Je);else for(Fe=Be-De;Fe>=Se;Fe-=De)Je=$$8(Fe,$e[Fe],$e[Fe+1],Je);return Je&&C$f(Je,Je.next)&&(z$h(Je),Je=Je.next),Je}function g$x($e,Se){if(!$e)return $e;Se||(Se=$e);var Be=$e,De;do if(De=!1,!Be.steiner&&(C$f(Be,Be.next)||Z$8(Be.prev,Be,Be.next)===0)){if(z$h(Be),Be=Se=Be.prev,Be===Be.next)break;De=!0}else Be=Be.next;while(De||Be!==Se);return Se}function k$j($e,Se,Be,De,Ve,Fe,Je){if($e){!Je&&Fe&&q$l($e,De,Ve,Fe);for(var Xe=$e,Ke,Ye;$e.prev!==$e.next;){if(Ke=$e.prev,Ye=$e.next,Fe?U$c($e,De,Ve,Fe):Q$b($e)){Se.push(Ke.i/Be|0),Se.push($e.i/Be|0),Se.push(Ye.i/Be|0),z$h($e),$e=Ye.next,Xe=Ye.next;continue}if($e=Ye,$e===Xe){Je?Je===1?($e=W$a(g$x($e),Se,Be),k$j($e,Se,Be,De,Ve,Fe,2)):Je===2&&_$d($e,Se,Be,De,Ve,Fe):k$j(g$x($e),Se,Be,De,Ve,Fe,1);break}}}}function Q$b($e){var Se=$e.prev,Be=$e,De=$e.next;if(Z$8(Se,Be,De)>=0)return!1;for(var Ve=Se.x,Fe=Be.x,Je=De.x,Xe=Se.y,Ke=Be.y,Ye=De.y,or=Ve<Fe?Ve<Je?Ve:Je:Fe<Je?Fe:Je,sr=Xe<Ke?Xe<Ye?Xe:Ye:Ke<Ye?Ke:Ye,cr=Ve>Fe?Ve>Je?Ve:Je:Fe>Je?Fe:Je,Br=Xe>Ke?Xe>Ye?Xe:Ye:Ke>Ye?Ke:Ye,tn=De.next;tn!==Se;){if(tn.x>=or&&tn.x<=cr&&tn.y>=sr&&tn.y<=Br&&F$e(Ve,Xe,Fe,Ke,Je,Ye,tn.x,tn.y)&&Z$8(tn.prev,tn,tn.next)>=0)return!1;tn=tn.next}return!0}function U$c($e,Se,Be,De){var Ve=$e.prev,Fe=$e,Je=$e.next;if(Z$8(Ve,Fe,Je)>=0)return!1;for(var Xe=Ve.x,Ke=Fe.x,Ye=Je.x,or=Ve.y,sr=Fe.y,cr=Je.y,Br=Xe<Ke?Xe<Ye?Xe:Ye:Ke<Ye?Ke:Ye,tn=or<sr?or<cr?or:cr:sr<cr?sr:cr,en=Xe>Ke?Xe>Ye?Xe:Ye:Ke>Ye?Ke:Ye,an=or>sr?or>cr?or:cr:sr>cr?sr:cr,rn=D$l(Br,tn,Se,Be,De),on=D$l(en,an,Se,Be,De),sn=$e.prevZ,ln=$e.nextZ;sn&&sn.z>=rn&&ln&&ln.z<=on;){if(sn.x>=Br&&sn.x<=en&&sn.y>=tn&&sn.y<=an&&sn!==Ve&&sn!==Je&&F$e(Xe,or,Ke,sr,Ye,cr,sn.x,sn.y)&&Z$8(sn.prev,sn,sn.next)>=0||(sn=sn.prevZ,ln.x>=Br&&ln.x<=en&&ln.y>=tn&&ln.y<=an&&ln!==Ve&&ln!==Je&&F$e(Xe,or,Ke,sr,Ye,cr,ln.x,ln.y)&&Z$8(ln.prev,ln,ln.next)>=0))return!1;ln=ln.nextZ}for(;sn&&sn.z>=rn;){if(sn.x>=Br&&sn.x<=en&&sn.y>=tn&&sn.y<=an&&sn!==Ve&&sn!==Je&&F$e(Xe,or,Ke,sr,Ye,cr,sn.x,sn.y)&&Z$8(sn.prev,sn,sn.next)>=0)return!1;sn=sn.prevZ}for(;ln&&ln.z<=on;){if(ln.x>=Br&&ln.x<=en&&ln.y>=tn&&ln.y<=an&&ln!==Ve&&ln!==Je&&F$e(Xe,or,Ke,sr,Ye,cr,ln.x,ln.y)&&Z$8(ln.prev,ln,ln.next)>=0)return!1;ln=ln.nextZ}return!0}function W$a($e,Se,Be){var De=$e;do{var Ve=De.prev,Fe=De.next.next;!C$f(Ve,Fe)&&J$f(Ve,De,De.next,Fe)&&H$o(Ve,Fe)&&H$o(Fe,Ve)&&(Se.push(Ve.i/Be|0),Se.push(De.i/Be|0),Se.push(Fe.i/Be|0),z$h(De),z$h(De.next),De=$e=Fe),De=De.next}while(De!==$e);return g$x(De)}function _$d($e,Se,Be,De,Ve,Fe){var Je=$e;do{for(var Xe=Je.next.next;Xe!==Je.prev;){if(Je.i!==Xe.i&&m$m(Je,Xe)){var Ke=K$f(Je,Xe);Je=g$x(Je,Je.next),Ke=g$x(Ke,Ke.next),k$j(Je,Se,Be,De,Ve,Fe,0),k$j(Ke,Se,Be,De,Ve,Fe,0);return}Xe=Xe.next}Je=Je.next}while(Je!==$e)}function I$m($e,Se,Be,De){var Ve=[],Fe,Je,Xe,Ke,Ye;for(Fe=0,Je=Se.length;Fe<Je;Fe++)Xe=Se[Fe]*De,Ke=Fe<Je-1?Se[Fe+1]*De:$e.length,Ye=G$c($e,Xe,Ke,De,!1),Ye===Ye.next&&(Ye.steiner=!0),Ve.push(b$o(Ye));for(Ve.sort(S$l),Fe=0;Fe<Ve.length;Fe++)Be=X$7(Ve[Fe],Be);return Be}function S$l($e,Se){return $e.x-Se.x}function X$7($e,Se){var Be=j$k($e,Se);if(!Be)return Se;var De=K$f(Be,$e);return g$x(De,De.next),g$x(Be,Be.next)}function j$k($e,Se){var Be=Se,De=$e.x,Ve=$e.y,Fe=-1/0,Je;do{if(Ve<=Be.y&&Ve>=Be.next.y&&Be.next.y!==Be.y){var Xe=Be.x+(Ve-Be.y)*(Be.next.x-Be.x)/(Be.next.y-Be.y);if(Xe<=De&&Xe>Fe&&(Fe=Xe,Je=Be.x<Be.next.x?Be:Be.next,Xe===De))return Je}Be=Be.next}while(Be!==Se);if(!Je)return null;var Ke=Je,Ye=Je.x,or=Je.y,sr=1/0,cr;Be=Je;do De>=Be.x&&Be.x>=Ye&&De!==Be.x&&F$e(Ve<or?De:Fe,Ve,Ye,or,Ve<or?Fe:De,Ve,Be.x,Be.y)&&(cr=Math.abs(Ve-Be.y)/(De-Be.x),H$o(Be,$e)&&(cr<sr||cr===sr&&(Be.x>Je.x||Be.x===Je.x&&Y$a(Je,Be)))&&(Je=Be,sr=cr)),Be=Be.next;while(Be!==Ke);return Je}function Y$a($e,Se){return Z$8($e.prev,$e,Se.prev)<0&&Z$8(Se.next,$e,$e.next)<0}function q$l($e,Se,Be,De){var Ve=$e;do Ve.z===0&&(Ve.z=D$l(Ve.x,Ve.y,Se,Be,De)),Ve.prevZ=Ve.prev,Ve.nextZ=Ve.next,Ve=Ve.next;while(Ve!==$e);Ve.prevZ.nextZ=null,Ve.prevZ=null,a$s(Ve)}function a$s($e){var Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye=1;do{for(Be=$e,$e=null,Fe=null,Je=0;Be;){for(Je++,De=Be,Xe=0,Se=0;Se<Ye&&(Xe++,De=De.nextZ,!!De);Se++);for(Ke=Ye;Xe>0||Ke>0&&De;)Xe!==0&&(Ke===0||!De||Be.z<=De.z)?(Ve=Be,Be=Be.nextZ,Xe--):(Ve=De,De=De.nextZ,Ke--),Fe?Fe.nextZ=Ve:$e=Ve,Ve.prevZ=Fe,Fe=Ve;Be=De}Fe.nextZ=null,Ye*=2}while(Je>1);return $e}function D$l($e,Se,Be,De,Ve){return $e=($e-Be)*Ve|0,Se=(Se-De)*Ve|0,$e=($e|$e<<8)&16711935,$e=($e|$e<<4)&252645135,$e=($e|$e<<2)&858993459,$e=($e|$e<<1)&1431655765,Se=(Se|Se<<8)&16711935,Se=(Se|Se<<4)&252645135,Se=(Se|Se<<2)&858993459,Se=(Se|Se<<1)&1431655765,$e|Se<<1}function b$o($e){var Se=$e,Be=$e;do(Se.x<Be.x||Se.x===Be.x&&Se.y<Be.y)&&(Be=Se),Se=Se.next;while(Se!==$e);return Be}function F$e($e,Se,Be,De,Ve,Fe,Je,Xe){return(Ve-Je)*(Se-Xe)>=($e-Je)*(Fe-Xe)&&($e-Je)*(De-Xe)>=(Be-Je)*(Se-Xe)&&(Be-Je)*(Fe-Xe)>=(Ve-Je)*(De-Xe)}function m$m($e,Se){return $e.next.i!==Se.i&&$e.prev.i!==Se.i&&!d$v($e,Se)&&(H$o($e,Se)&&H$o(Se,$e)&&ee$4($e,Se)&&(Z$8($e.prev,$e,Se.prev)||Z$8($e,Se.prev,Se))||C$f($e,Se)&&Z$8($e.prev,$e,$e.next)>0&&Z$8(Se.prev,Se,Se.next)>0)}function Z$8($e,Se,Be){return(Se.y-$e.y)*(Be.x-Se.x)-(Se.x-$e.x)*(Be.y-Se.y)}function C$f($e,Se){return $e.x===Se.x&&$e.y===Se.y}function J$f($e,Se,Be,De){var Ve=A$q(Z$8($e,Se,Be)),Fe=A$q(Z$8($e,Se,De)),Je=A$q(Z$8(Be,De,$e)),Xe=A$q(Z$8(Be,De,Se));return!!(Ve!==Fe&&Je!==Xe||Ve===0&&E$m($e,Be,Se)||Fe===0&&E$m($e,De,Se)||Je===0&&E$m(Be,$e,De)||Xe===0&&E$m(Be,Se,De))}function E$m($e,Se,Be){return Se.x<=Math.max($e.x,Be.x)&&Se.x>=Math.min($e.x,Be.x)&&Se.y<=Math.max($e.y,Be.y)&&Se.y>=Math.min($e.y,Be.y)}function A$q($e){return $e>0?1:$e<0?-1:0}function d$v($e,Se){var Be=$e;do{if(Be.i!==$e.i&&Be.next.i!==$e.i&&Be.i!==Se.i&&Be.next.i!==Se.i&&J$f(Be,Be.next,$e,Se))return!0;Be=Be.next}while(Be!==$e);return!1}function H$o($e,Se){return Z$8($e.prev,$e,$e.next)<0?Z$8($e,Se,$e.next)>=0&&Z$8($e,$e.prev,Se)>=0:Z$8($e,Se,$e.prev)<0||Z$8($e,$e.next,Se)<0}function ee$4($e,Se){var Be=$e,De=!1,Ve=($e.x+Se.x)/2,Fe=($e.y+Se.y)/2;do Be.y>Fe!=Be.next.y>Fe&&Be.next.y!==Be.y&&Ve<(Be.next.x-Be.x)*(Fe-Be.y)/(Be.next.y-Be.y)+Be.x&&(De=!De),Be=Be.next;while(Be!==$e);return De}function K$f($e,Se){var Be=new O$e($e.i,$e.x,$e.y),De=new O$e(Se.i,Se.x,Se.y),Ve=$e.next,Fe=Se.prev;return $e.next=Se,Se.prev=$e,Be.next=Ve,Ve.prev=Be,De.next=Be,Be.prev=De,Fe.next=De,De.prev=Fe,De}function $$8($e,Se,Be,De){var Ve=new O$e($e,Se,Be);return De?(Ve.next=De.next,Ve.prev=De,De.next.prev=Ve,De.next=Ve):(Ve.prev=Ve,Ve.next=Ve),Ve}function z$h($e){$e.next.prev=$e.prev,$e.prev.next=$e.next,$e.prevZ&&($e.prevZ.nextZ=$e.nextZ),$e.nextZ&&($e.nextZ.prevZ=$e.prevZ)}function O$e($e,Se,Be){this.i=$e,this.x=Se,this.y=Be,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}P$p.deviation=function($e,Se,Be,De){var Ve=Se&&Se.length,Fe=Ve?Se[0]*Be:$e.length,Je=Math.abs(R$f($e,0,Fe,Be));if(Ve)for(var Xe=0,Ke=Se.length;Xe<Ke;Xe++){var Ye=Se[Xe]*Be,or=Xe<Ke-1?Se[Xe+1]*Be:$e.length;Je-=Math.abs(R$f($e,Ye,or,Be))}var sr=0;for(Xe=0;Xe<De.length;Xe+=3){var cr=De[Xe]*Be,Br=De[Xe+1]*Be,tn=De[Xe+2]*Be;sr+=Math.abs(($e[cr]-$e[tn])*($e[Br+1]-$e[cr+1])-($e[cr]-$e[Br])*($e[tn+1]-$e[cr+1]))}return Je===0&&sr===0?0:Math.abs((sr-Je)/Je)};function R$f($e,Se,Be,De){for(var Ve=0,Fe=Se,Je=Be-De;Fe<Be;Fe+=De)Ve+=($e[Je]-$e[Fe])*($e[Fe+1]+$e[Je+1]),Je=Fe;return Ve}P$p.flatten=function($e){for(var Se=$e[0][0].length,Be={vertices:[],holes:[],dimensions:Se},De=0,Ve=0;Ve<$e.length;Ve++){for(var Fe=0;Fe<$e[Ve].length;Fe++)for(var Je=0;Je<Se;Je++)Be.vertices.push($e[Ve][Fe][Je]);Ve>0&&(De+=$e[Ve-1].length,Be.holes.push(De))}return Be};function l$n($e){if($e.length<3){console.error("points.length < 3");return}const[Se,Be,De]=$e;return new Vector3().subVectors(De,Be).cross(new Vector3().subVectors(Se,Be)).normalize()}function p$u($e){if($e.length<3)return[];const Se=l$n($e),Be=new Quaternion().setFromUnitVectors(Se,new Vector3(0,1,0)),De=$e.map(Ve=>Ve.clone().applyQuaternion(Be)).flatMap(Ve=>[Ve.x,Ve.z]);return B$m(De)}function a$r($e,Se){const Be=Array.isArray(Se)?Se:[Se];for(let De=0;De<Be.length;De++){const Ve=$e.start,Fe=$e.end,Je=Be[De].start,Xe=Be[De].end;if(!(f$D(Ve,Je)||f$D(Ve,Xe)||f$D(Fe,Je)||f$D(Fe,Xe)||f$D(Ve,Fe))&&d$u([Ve.x,Ve.y,Ve.z],[Fe.x,Fe.y,Fe.z],[Je.x,Je.y,Je.z],[Xe.x,Xe.y,Xe.z]))return!0}return!1}function d$u($e,Se,Be,De){const Ve=[Se[0]-$e[0],Se[1]-$e[1],Se[2]-$e[2]],Fe=[De[0]-Be[0],De[1]-Be[1],De[2]-Be[2]],Je=[[Ve[0],-Fe[0]],[Ve[1],-Fe[1]],[Ve[2],-Fe[2]]],Xe=[Be[0]-$e[0],Be[1]-$e[1],Be[2]-$e[2]],Ke=g$w(Je,Xe);if(Ke===null)return!1;const[Ye,or]=Ke;return!!(y$s(Ye)&&y$s(or))}function g$w($e,Se){if(q$k($e)===0)return null;const Be=I$l($e);return V$9(Be,Se)}function q$k($e){return $e[0][0]*$e[1][1]-$e[0][1]*$e[1][0]}function I$l($e){const Se=$e[0][0]*$e[1][1]-$e[0][1]*$e[1][0];return[[$e[1][1]/Se,-$e[0][1]/Se],[-$e[1][0]/Se,$e[0][0]/Se]]}function V$9($e,Se){return[$e[0][0]*Se[0]+$e[0][1]*Se[1],$e[1][0]*Se[0]+$e[1][1]*Se[1]]}function y$s($e){return $e>=0&&$e<=1}function f$D($e,Se){return $e.x===Se.x&&$e.y===Se.y&&$e.z===Se.z}function h$q($e,Se){const Be=[...new Set($e)];if(Be.length<3)return;if(Be.at(-1).equals(Be[0])||Be.push(Be[0]),Se!=null&&Se.checkLinesIntersect&&Be.length>=5){const Xe=Be.map((Ke,Ye)=>Ye===0?null:{start:Be[Ye-1],end:Be[Ye]}).filter(Boolean);for(let Ke=0;Ke<Xe.length;Ke++)if(a$r(Xe[Ke],Xe.slice(Ke)))return}const De=Be.flatMap(Xe=>[Xe.x,Xe.y,Xe.z]),Ve=new Float32BufferAttribute(De,3),Fe=p$u(Be),Je=new BufferGeometry;return Je.setAttribute("position",Ve),Je.setIndex(Fe),Je.name="PolygonGeometry",Je}new BufferGeometry;function b$n($e){const Se=A$p($e);if(Se.length===0){console.warn("No geometry triangles found"),console.debug({geometry:$e,triangles:Se});return}let Be=0,De=new Vector3;for(const[Ve,Fe,Je]of Se){const Xe=u$s(Ve,Fe,Je),Ke=d$t(Ve,Fe,Je,Xe);Be+=Xe,De.add(Ke)}return De=De.divideScalar(Be),{center:De,area:Be}}function u$s($e,Se,Be){return Se.clone().sub($e).cross(Be.clone().sub($e)).length()/2}function d$t($e,Se,Be,De){const Ve=De??u$s($e,Se,Be);return c$J($e,Se,Be).multiplyScalar(Ve)}function A$p($e){var Se;const Be=$e.getAttribute("position"),De=(Se=$e.getIndex())==null?void 0:Se.array;if(!Be||!De)return[];let Ve=[];for(let Fe=0;Fe<De.length;Fe+=3){const Je=De[Fe],Xe=De[Fe+1],Ke=De[Fe+2],Ye=new Vector3().fromArray([Be.getX(Je),Be.getY(Je),Be.getZ(Je)]),or=new Vector3().fromArray([Be.getX(Xe),Be.getY(Xe),Be.getZ(Xe)]),sr=new Vector3().fromArray([Be.getX(Ke),Be.getY(Ke),Be.getZ(Ke)]);Ve.push([Ye,or,sr])}return Ve}function h$p($e,Se){const{top:Be,left:De,width:Ve,height:Fe}=Se.getBoundingClientRect();return new Vector2(($e.x-De)/Ve*2-1,-($e.y-Be)/Fe*2+1)}var a$q={},k$i={get exports(){return a$q},set exports($e){a$q=$e}};function f$C($e){return $e===null?"null":typeof $e>"u"?"undefined":typeof $e=="object"?Array.isArray($e)?"array":"object":typeof $e}function h$o($e){return f$C($e)==="object"?j$j($e):f$C($e)==="array"?b$m($e):$e}function b$m($e){return $e.map(h$o)}function j$j($e){const Se={};for(const Be in $e)$e.hasOwnProperty(Be)&&(Se[Be]=h$o($e[Be]));return Se}function y$r($e,Se=[],Be={}){const De={arrayBehaviour:Be.arrayBehaviour||"replace"},Ve=Se.map(Je=>Je||{}),Fe=$e||{};for(let Je=0;Je<Ve.length;Je++){const Xe=Ve[Je],Ke=Object.keys(Xe);for(let Ye=0;Ye<Ke.length;Ye++){const or=Ke[Ye],sr=Xe[or],cr=f$C(sr),Br=f$C(Fe[or]);if(cr==="object")if(Br!=="undefined"){const tn=Br==="object"?Fe[or]:{};Fe[or]=y$r({},[tn,j$j(sr)],De)}else Fe[or]=j$j(sr);else if(cr==="array")if(Br==="array"){const tn=b$m(sr);Fe[or]=De.arrayBehaviour==="merge"?Fe[or].concat(tn):tn}else Fe[or]=b$m(sr);else Fe[or]=sr}}return Fe}k$i.exports=function($e,...Se){return y$r($e,Se)};a$q.noMutate=function(...$e){return y$r({},$e)};a$q.withOptions=function($e,Se,Be){return y$r($e,Se,Be)};function r$s($e){return typeof $e=="object"?$e===null?{}:$e:{}}var R$e=Object.defineProperty,P$o=Object.defineProperties,V$8=Object.getOwnPropertyDescriptors,N$d=Object.getOwnPropertySymbols,T$e=Object.prototype.hasOwnProperty,B$l=Object.prototype.propertyIsEnumerable,D$k=($e,Se,Be)=>Se in $e?R$e($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,L$g=($e,Se)=>{for(var Be in Se||(Se={}))T$e.call(Se,Be)&&D$k($e,Be,Se[Be]);if(N$d)for(var Be of N$d(Se))B$l.call(Se,Be)&&D$k($e,Be,Se[Be]);return $e},S$k=($e,Se)=>P$o($e,V$8(Se)),a$p=($e,Se,Be)=>(D$k($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let Q$a=class{constructor(Se,Be){a$p(this,"_five"),a$p(this,"dragging",!1),a$p(this,"boundObject",{}),a$p(this,"config"),a$p(this,"handleWantsGesture",(Ve,Fe)=>{if(Fe.length!==1)return;const Je=Fe[0];if(Je.raycaster){const Xe=new h$z;Xe.ray=Je.raycaster.ray,Xe.near=Je.raycaster.near,Xe.far=Je.raycaster.far,Xe.camera=Je.raycaster.camera,Xe.layers=Je.raycaster.layers,Xe.params=Je.raycaster.params,Je.raycaster=Xe}if(Je){if(Ve==="mouseMove"&&this.onDomEvent("hover",Je),Ve==="tap"){const Xe=new MouseEvent("click",{clientX:Je.x,clientY:Je.y}),Ke=this.onDomEvent("click",Je,Xe),Ye=this.onDomEvent("wantDblclick",Je,Xe,this.boundObject.dblclick);if(Ke===!1||Ye===!1)return!1}if(this.dragging)return!1}}),a$p(this,"handleDomEvent",(Ve,Fe,Je)=>{const Xe={x:Fe.clientX,y:Fe.clientY};this.onDomEvent(Ve,Xe,Fe,Je)}),a$p(this,"handleMouseEvent",Ve=>{this.handleDomEvent(Ve.type,Ve)}),a$p(this,"handleMousedown",Ve=>{this.handleDomEvent("mousedown",Ve),this.handleDomEvent("dragstart",Ve,this.haveDragEventObject)}),a$p(this,"handleMouseup",Ve=>{var Fe;this.dragging=!1,(Fe=this.haveDragEventObject)==null||Fe.forEach(Je=>{Je._dragging&&(Je._dragging=!1,this.notify({eventName:"dragend",object:Je,originEvent:Ve,raycaster:this.getRaycaster({x:Ve.clientX,y:Ve.clientY})}))}),this.handleDomEvent("mouseup",Ve)}),a$p(this,"handleMousemove",Ve=>{var Fe;this.dragging&&((Fe=this.boundObject.drag)==null||Fe.forEach(Je=>{Je._dragging&&this.notify({eventName:"drag",object:Je,originEvent:Ve,raycaster:this.getRaycaster({x:Ve.clientX,y:Ve.clientY})})}))}),a$p(this,"onDomEvent",(Ve,Fe,Je,Xe=this.boundObject[Ve])=>{var Ke,Ye,or,sr,cr;if(!Fe||!Xe||Xe?.length===0)return;const Br=[];((Ke=this.config)==null?void 0:Ke.fiveModels)!==null&&((Ye=this.config)!=null&&Ye.fiveModels?Br.push(...this.config.fiveModels):Br.push(this.model));const tn=Br.filter(ln=>ln.loaded),en=(or=Fe.raycaster)!=null?or:this.getRaycaster(Fe);en.params.Points.threshold=.04;const an=en.intersectObjects(Xe,!0),rn=[];if(tn.forEach(ln=>{const cn=ln.intersectRaycaster(en);rn.push(...cn)}),rn.length>0&&an.length>0&&rn[0].distance+.01<an[0].distance)return;const sn=(sr=an?.[0])==null?void 0:sr.object;if(Ve==="wantDblclick")return!1;if((!sn||!this.objectIsBound(sn))&&Ve==="hover")for(const ln of(cr=this.boundObject.hover)!=null?cr:[])ln._hovered&&this.notify({eventName:"unHover",object:ln});if(sn&&sn&&this.notify({eventName:Ve,object:sn,originEvent:Je,raycaster:en,intersects:an,fiveModelIntersects:rn}))return!1}),a$p(this,"objectIsBound",Ve=>{let Fe=Ve._domEvent,Je=Ve.parent;for(;typeof Fe>"u"&&Je;)Fe=Je._domEvent,Je=Je.parent;return!!Fe}),a$p(this,"notify",Ve=>{var Fe,Je,Xe,Ke,Ye,or,sr;const{eventName:cr,object:Br,originEvent:tn,raycaster:en,intersects:an,fiveModelIntersects:rn}=Ve;if(!Br)return!1;let on=!1,sn=[];const ln=[],cn=()=>{if(!an)return!1;const xn=an.slice(1);return xn[0]?this.notify(S$k(L$g({},Ve),{object:xn[0].object,intersects:xn})):!1};let hn=Br;for(ln.push(hn);hn.parent;)hn=hn.parent,ln.push(hn);const mn=ln[ln.length-1];if((Fe=this.config)!=null&&Fe.noEmitWhenNotInScene&&mn.type!=="Scene")return cn();let An=!1;for(const xn of ln){if(on)break;xn.draggable&&(cr==="dragstart"&&(xn._dragging=!0,this.dragging=!0),cr==="dragend"&&(xn._dragging=!1,this.dragging=!1));const pn=xn._domEvent;if(!pn)continue;const dn=pn[`${cr}Handler`];if(dn)for(const[fn,yn]of dn){if(yn!=null&&yn.noEmitWhenNotInScene&&mn.type!=="Scene")continue;if(yn.skipPano&&rn){const gn=(Je=rn[0])==null?void 0:Je.point;if(gn&&(Ye=(Ke=(Xe=this.five.observers)==null?void 0:Xe[this.five.panoIndex])==null?void 0:Ke.accessibleNodes)!=null&&Ye.some(Cn=>{var Mn;const Bn=(Mn=this.five.works.getResolvedObserver({workCode:this.five.state.workCode,panoIndex:Cn}))==null?void 0:Mn.standingPosition;return Bn?.distanceTo(gn)<.3}))continue}if(((or=this.config)!=null&&or.noEmitWhenHide||yn!=null&&yn.noEmitWhenHide)&&!r$D(xn))continue;if(An=!0,cr==="hover"){if(xn._hovered)continue;xn._hovered=!0;for(const gn of(sr=this.boundObject.hover)!=null?sr:[])gn!==xn&&gn._hovered&&this.notify({eventName:"unHover",object:gn})}if(cr==="unHover"){if(!xn._hovered)continue;xn._hovered=!1}const Sn=fn({type:cr,target:xn,origDomEvent:tn,raycaster:en,intersects:an,stopPropagation:()=>{on=!0}});sn.push(Sn??!0)}}if(An===!1)return cn();if(cr==="click"||cr==="wantDblclick")return sn.some(xn=>xn===!0)});var De;this.five=Se,this.config=Be,Se.off("wantsGesture",this.handleWantsGesture),Se.on("wantsGesture",this.handleWantsGesture),document.addEventListener("mousedown",this.handleMousedown),document.addEventListener("dblclick",this.handleMouseEvent),document.addEventListener("mouseup",this.handleMouseup),document.addEventListener("mousemove",this.handleMousemove),window.__FIVE_DOM_EVENTS__=(De=window.__FIVE_DOM_EVENTS__)!=null?De:[],window.__FIVE_DOM_EVENTS__.push(this)}get five(){return this._five}set five(Se){var Be;(Be=this._five)==null||Be.off("wantsGesture",this.handleWantsGesture),this._five=Se,this._five.on("wantsGesture",this.handleWantsGesture)}get haveDragEventObject(){return[...new Set([this.boundObject.dragend,this.boundObject.drag,this.boundObject.dragstart].flat())].filter(Boolean)}get model(){return l$w(this.five)}addAutoBindEventListener(Se,Be,De,Ve){const Fe=()=>this.addEventListener(Se,Be,De,Ve),Je=()=>this.removeEventListener(Se,Be,De,Ve);return Se.addEventListener("added",Fe),Se.addEventListener("removed",Je),Se.addEventListener("dispose",Je),()=>{Se.removeEventListener("added",Fe),Se.removeEventListener("removed",Je),Se.removeEventListener("dispose",Je)}}addEventListener(Se,Be,De,Ve){Se._domEvent||(Se._domEvent={}),Se._domEvent[`${Be}Handler`]||(Se._domEvent[`${Be}Handler`]=[]),this.boundObject[Be]||(this.boundObject[Be]=[]),this.boundObject[Be].includes(Se)||this.boundObject[Be].push(Se),Se._domEvent[`${Be}Handler`].push([De,L$g({noEmitWhenHide:!1,noEmitWhenNotInScene:!1},Ve)])}removeEventListener(Se,Be,De,...Ve){var Fe,Je;if(!Se._domEvent||(Be===void 0&&(Object.keys(this.boundObject).forEach(Ke=>{var Ye,or;const sr=(Ye=this.boundObject[Ke])==null?void 0:Ye.findIndex(cr=>cr===Se);sr!==-1&&((or=this.boundObject[Ke])==null||or.splice(sr,1))}),Se._domEvent={}),!Se._domEvent[`${Be}Handler`]))return;if(De===void 0){delete Se._domEvent[`${Be}Handler`];return}const Xe=Se._domEvent[`${Be}Handler`].findIndex(Ke=>Ke[0]===De);if(Xe!==-1&&(Se._domEvent[`${Be}Handler`].splice(Xe,1),Se._domEvent[`${Be}Handler`].length===0&&delete Se._domEvent[`${Be}Handler`],Se._domEvent&&Object.keys(Se._domEvent).length===0&&delete Se._domEvent,!Se._domEvent)){const Ke=(Fe=this.boundObject[Be])==null?void 0:Fe.findIndex(Ye=>Ye===Se);Ke!==-1&&((Je=this.boundObject[Be])==null||Je.splice(Ke,1))}}clear(){this.boundObject={}}dispose(){var Se;(Se=this.five)==null||Se.off("wantsGesture",this.handleWantsGesture),document.removeEventListener("mousedown",this.handleMousedown),document.removeEventListener("mouseup",this.handleMouseup),document.removeEventListener("mousemove",this.handleMousemove),this.boundObject={}}toJSON(){return{boundObject:this.boundObject}}getRaycaster(Se){const Be=this.five.getElement();if(!Be)return;const De=h$p(Se,Be),Ve=new h$z;return Ve.setFromCamera(De,this.five.camera),Ve}};var E$l=Object.defineProperty,N$c=Object.defineProperties,P$n=Object.getOwnPropertyDescriptors,A$o=Object.getOwnPropertySymbols,b$l=Object.prototype.hasOwnProperty,v$q=Object.prototype.propertyIsEnumerable,f$B=($e,Se,Be)=>Se in $e?E$l($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,a$o=($e,Se)=>{for(var Be in Se||(Se={}))b$l.call(Se,Be)&&f$B($e,Be,Se[Be]);if(A$o)for(var Be of A$o(Se))v$q.call(Se,Be)&&f$B($e,Be,Se[Be]);return $e},m$l=($e,Se)=>N$c($e,P$n(Se)),k$h=($e,Se)=>{var Be={};for(var De in $e)b$l.call($e,De)&&Se.indexOf(De)<0&&(Be[De]=$e[De]);if($e!=null&&A$o)for(var De of A$o($e))Se.indexOf(De)<0&&v$q.call($e,De)&&(Be[De]=$e[De]);return Be},s$e=($e,Se,Be)=>(f$B($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const x$o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sHDgwCEMBJZu0AAAAdaVRYdENvbW1lbnQAAAAAAENyZWF0ZWQgd2l0aCBHSU1QZC5lBwAABM5JREFUWMO1V0tPG2cUPZ4Hxh6DazIOrjFNqJs0FIMqWFgWQkatsmvVbtggKlSVRVf5AWz4AWz4AUSKEChll19QJYSXkECuhFxsHjEhxCYm+DWGMZ5HF72DJq4bAzFXurI0M/I5997v3u9cC65vTJVn2lX/xHINQOYSBLTLEuIuCWw4Z3IGAEvf6ASmVHjNzHCXBG4A0AjACsAOwEbO0nsFQBnAGYASAIl+ZRMR7SolMEdsByD09fV5R0ZGgg8ePPjW5/N1iqLYpuu6RZblciKR2I9Go69evnwZnZ+fjwI4IS8AKBIRzeQfJWCANwKwh0KhtrGxsYehUOin1tbW+zzP23ietzY2NnIAoGmaLsuyUiqVyvl8XtrY2NiamZn589mzZxsAUgCOAeQAnFI2tI+VxIjaAeDzoaGh7xYWFuZOTk6OZVk+12uYqqq6JEnn0Wg0OT4+/geAXwGEAdwDIFJQXC1wO4DWR48e/RCPxxclSSroVzRFUbSDg4P848ePFwH8DuAhkWih83TRQWxFOXgAwvDwcOfo6OhvXV1d39tsNtuVBwTDWBwOh1UUxVsMw1hXVlbSdCgNV43uYSvrHg6H24aHh38eHBz85TrgF9FYLHA4HLzH43FvbW2d7u/vG+dANp8FpqIlbd3d3V8Fg8EfBUFw4BONZVmL3+9vHhkZCQL4AoAHgJPK8G+yzC0XDofdoVAo5PP5vkadTBAEtr+/39ff3x8gAp/RPOEqx2qjx+NpvXv3bk9DQ0NDvQgwDIOWlhZrMBj8kgi0UJdxRgYMArzL5XJ7vd57qLPZ7Xamp6fnNgBXtQxcjFuHw+Hyer3t9SYgCAITCAScAJoBNNEY/08GOFVVrfVMv7kMNDntFD1vjIAPrlRN0xjckOm6biFQ3jwNPwDMZrOnqVTqfb3Bi8Wivru7W/VCYkwPlKOjo0IikXh7EwQikYgE4Nw0CfXKDCipVCoTj8df3QABbW1tLUc6oUgkFPMkVACUNjc337148eKvw8PDbJ2jP1taWkoCyNDVXDSECmNSK4qiKNLq6urW8+fPI/UicHx8rD59+jSVy+WOAKSJhKENwFItLtoxk8mwsixzHR0dHe3t7c5PAU+n09rs7OzJkydPYqVSaQfANoDXALIk31S2smU1TWMPDg7K5XKZ7+3t9TudTut1U7+wsFCcmJiIpdPpbQBxADsAknQWymYCOukBHYCuKApisdhpMpnURFEU79y503TVyKenpzOTk5M7e3t7MQKPV0Zv1gNm+awB0MvlshqLxfLb29uyJElWURSbXC4XXyvqxcXFs6mpqeTc3Nzu3t7e3wQcA7BPZ8Cov1pNlJplmQtAG8MwHV6v95tAINA5MDBwPxAIuLu6upr8fr/VAN3c3JQjkcjZ+vp6fnl5+d2bN29SuVzuNYAEpf01CdRChUL+X1VskHACuA3Ay3Fcu9vt7nA6nZ7m5uYWQRCaNE3jVVW15PP580KhIGUymWw2m00DOAJwSP4WwPtq4LX2Ao6USxNlQyS/RcQcdLGwlNIz6vEMAaZpNzCk2Pll94LK/cDYimxERiBwG10sxjgvEZBE0UpE6vxj+0Ct5bTaXthgEhRmja8QWNkkPGsuIpfdjpkK+cZUWTC0KredVmtD/gdlSl6EG4AMvQAAAABJRU5ErkJggg==";let C$e=null,ot$3=class extends c$C{constructor(Se){var Be,De,Ve;super(),s$e(this,"name","PointMesh"),s$e(this,"dom"),s$e(this,"opacityBeforeHighlight"),s$e(this,"highlighted",!1),s$e(this,"fontMesh"),s$e(this,"backgroundMesh"),s$e(this,"lastRenderDomItem"),s$e(this,"paramsStyle"),s$e(this,"_visible",!0),s$e(this,"_onAdded",()=>{this.dom||this.updateDom()}),s$e(this,"_onRemoved",()=>{var tn;(tn=this.dom)==null||tn.destroy(),this.dom=void 0}),s$e(this,"_onShowed",()=>{this.dom&&(this.dom.container.style.display="block")}),s$e(this,"_onHidden",()=>{this.dom&&(this.dom.container.style.display="none")});const Fe=Se??{},{point:Je}=Fe,Xe=k$h(Fe,["point"]);this.paramsStyle=Xe??{};const Ke=new BufferGeometry;Ke.setAttribute("position",new Float32BufferAttribute([0,0,0],3));const Ye={transparent:!0,side:DoubleSide,size:(Be=Se?.size)!=null?Be:8,map:C$e||(C$e=new TextureLoader$1().load(x$o)),sizeAttenuation:!1},or=new PointsMaterial(m$l(a$o({},Ye),{color:(De=Se?.color)!=null?De:16777215,depthTest:!0,opacity:(Ve=Se?.opacity)!=null?Ve:1})),sr=new PointsMaterial(m$l(a$o({},Ye),{size:or.size,color:or.color,depthWrite:!1,depthTest:!1,opacity:or.opacity*.5})),cr=new Points(Ke,or),Br=new Points(Ke,sr);this.fontMesh=cr,this.backgroundMesh=Br,cr.name="FontMesh",Br.name="BackgroundMesh",cr.renderOrder=10,Br.renderOrder=0,this.add(cr,Br),Se!=null&&Se.point&&this.position.copy(t$j(Se.point)),Se&&this.setStyle(Se),this.addEventListener("removed",()=>{r$y.cacheObject.delete(this),r$y.checkDom(this)}),this.addEventListener("added",()=>{r$y.cacheObject.add(this)}),r$y.checkDomEveryFrame()}get color(){return this.fontMesh.material.color}get size(){return this.fontMesh.material.size}get style(){return{color:this.color,size:this.size,opacity:this.fontMesh.material.opacity,occlusionVisibility:this.fontMesh.material.depthTest,occlusionMode:this.backgroundMesh.visible?"depthWrite":"depthTest"}}get five(){var Se,Be;return(Be=(Se=window.globalModules)==null?void 0:Se.five)!=null?Be:window.$five}setStyle(Se){i$w(Se.color)&&(this.fontMesh.material.setValues({color:Se.color}),this.backgroundMesh.material.setValues({color:Se.color})),i$w(Se.size)&&(this.fontMesh.material.setValues({side:Se.size}),this.backgroundMesh.material.setValues({side:Se.size})),i$w(Se.occlusionVisibility)&&(Se.occlusionVisibility?Se.occlusionMode==="depthTest"?(this.fontMesh.material.depthTest=!1,this.backgroundMesh.visible=!1):(this.fontMesh.material.depthTest=!0,this.backgroundMesh.visible=!0):(this.fontMesh.material.depthTest=!0,this.backgroundMesh.visible=!1))}highlight(){this.highlighted||(this.highlighted=!0,this.opacityBeforeHighlight=this.fontMesh.material.opacity,this.fontMesh.material.setValues({opacity:this.opacityBeforeHighlight*E$t}))}unhighlight(){this.highlighted&&(this.highlighted=!1,this.fontMesh.material.setValues({opacity:this.opacityBeforeHighlight}))}updateMatrixWorld(Se){super.updateMatrixWorld(Se);const Be=a$x(this,this.position).toArray().join(",");Be!==this.lastRenderDomItem&&(this.updateDom(),this.lastRenderDomItem=Be)}updateDom(){const Se=this.paramsStyle.tip;Se&&!this.dom&&(this.dom=new R$k(this.five),this.dom.intersectCheck=!1,this.dom.simulate3D=!0,this.dom.container.style.display=this.visible?"block":"none");const Be=De=>{this.dom&&this.dom.__text!==De&&(this.dom.__text=De,De instanceof HTMLElement?(this.dom.container.innerHTML="",this.dom.container.appendChild(De)):De?this.dom.container.innerHTML=c$B(De,{style:""}):this.dom.container.innerHTML="")};Se?(Be(Se),this.dom.setPosition(this.position.clone())):Be(null)}};var g$v=Object.defineProperty,f$A=Object.defineProperties,S$j=Object.getOwnPropertyDescriptors,u$r=Object.getOwnPropertySymbols,c$u=Object.prototype.hasOwnProperty,b$k=Object.prototype.propertyIsEnumerable,l$m=($e,Se,Be)=>Se in $e?g$v($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$r=($e,Se)=>{for(var Be in Se||(Se={}))c$u.call(Se,Be)&&l$m($e,Be,Se[Be]);if(u$r)for(var Be of u$r(Se))b$k.call(Se,Be)&&l$m($e,Be,Se[Be]);return $e},a$n=($e,Se)=>f$A($e,S$j(Se)),e$c=($e,Se,Be)=>(l$m($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let z$g=class extends Oe{constructor(Se){super(),e$c(this,"name","LineWithDotsMesh"),e$c(this,"pointGroup",new c$C),e$c(this,"_paramsStyle"),e$c(this,"setStyle",Be=>{super.setStyle(Be),this._paramsStyle=r$r(r$r({},this._paramsStyle),Be),this.pointMeshes.forEach(De=>{var Ve,Fe,Je;return De.setStyle(a$n(r$r({},this._paramsStyle),{color:(Je=(Ve=this._paramsStyle)==null?void 0:Ve.pointColor)!=null?Je:(Fe=this._paramsStyle)==null?void 0:Fe.lineColor,tip:void 0}))}),this.updateEdgePointsVisibility(),this.needsRender=!0}),e$c(this,"highlight",Be=>{super.highlight(Be),this.pointMeshes.forEach(De=>De.highlight())}),e$c(this,"unhighlight",()=>{super.unhighlight(),this.pointMeshes.forEach(Be=>Be.unhighlight())}),e$c(this,"updateEdgePointsVisibility",()=>{var Be;i$w((Be=this._paramsStyle)==null?void 0:Be.pointVisibility)&&(this.startPoint&&(this.startPoint.visible=typeof this._paramsStyle.pointVisibility=="object"?this._paramsStyle.pointVisibility.startPoint:this._paramsStyle.pointVisibility),this.endPoint&&(this.endPoint.visible=typeof this._paramsStyle.pointVisibility=="object"?this._paramsStyle.pointVisibility.endPoint:this._paramsStyle.pointVisibility))}),this.add(this.pointGroup),Se&&this.setStyle(Se),Se!=null&&Se.points&&this.setPoints(Se.points)}get startPoint(){return this.pointMeshes[0]}get endPoint(){return this.pointMeshes.length<2?null:this.pointMeshes[this.pointMeshes.length-1]}get visiblePointMeshes(){return this.pointMeshes.filter(Se=>Se.visible)}get pointMeshes(){return this.pointGroup.children}setPoints(Se){super.setPoints(Se);const Be=Se.map(t$j).filter(i$w);this.pointGroup.removeChildren(),this.addIfNotExists(this.pointGroup),Be.forEach(De=>{var Ve,Fe,Je;const Xe=new ot$3(a$n(r$r({},this.style),{color:(Je=(Ve=this._paramsStyle)==null?void 0:Ve.pointColor)!=null?Je:(Fe=this._paramsStyle)==null?void 0:Fe.lineColor,tip:void 0}));Xe.position.copy(De),this.pointGroup.add(Xe)}),this.updateEdgePointsVisibility(),this.needsRender=!0}};var y$q=Object.defineProperty,u$q=Object.getOwnPropertySymbols,f$z=Object.prototype.hasOwnProperty,B$k=Object.prototype.propertyIsEnumerable,g$u=($e,Se,Be)=>Se in $e?y$q($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,a$m=($e,Se)=>{for(var Be in Se||(Se={}))f$z.call(Se,Be)&&g$u($e,Be,Se[Be]);if(u$q)for(var Be of u$q(Se))B$k.call(Se,Be)&&g$u($e,Be,Se[Be]);return $e},s$d=($e,Se,Be)=>(g$u($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let A$n=class extends c$C{constructor(Se){var Be,De;super(),s$d(this,"name","ColoredMesh"),s$d(this,"meshFont"),s$d(this,"meshBackground"),s$d(this,"paramsStyle",{}),s$d(this,"_geometry",new BufferGeometry),s$d(this,"highlighted",!1),s$d(this,"opacityBeforeHighlight"),s$d(this,"colorBeforeHighlight"),this.paramsStyle=Se??{};const Ve=new MeshBasicMaterial({color:new Color((Be=Se?.color)!=null?Be:L$n).convertSRGBToLinear(),transparent:!0,side:DoubleSide,depthTest:!0,depthWrite:!1,opacity:(De=Se?.opacity)!=null?De:A$w}),Fe=new MeshBasicMaterial({color:16777215,transparent:!0,side:DoubleSide,depthTest:!1,depthWrite:!1,opacity:.3/.5*Ve.opacity}),Je=new Mesh(this.geometry,Ve),Xe=new Mesh(this.geometry,Fe);Je.name="MeshFront",Xe.name="MeshBackground",Je.renderOrder=1,Xe.renderOrder=0,this.meshFont=Je,this.meshBackground=Xe,this.add(Je),this.setOcclusionVisibility({occlusionVisibility:Se?.occlusionVisibility,occlusionMode:Se?.occlusionMode})}get style(){return{color:this.color,opacity:this.opacity,occlusionVisibility:this.occlusionVisibility,occlusionMode:this.occlusionMode}}get color(){return this.meshFont.material.color}get opacity(){return this.meshFont.material.opacity}get occlusionVisibility(){return!!this.meshBackground.parent||this.meshFont.material.depthTest===!1}get occlusionMode(){return this.meshFont.material.depthTest===!1?"depthTest":"translucence"}set geometry(Se){this._geometry=Se,this.meshFont.geometry=Se,this.meshBackground.geometry=Se}get geometry(){return this._geometry}setStyle(Se){this.paramsStyle=a$m(a$m({},this.paramsStyle),Se),i$w(Se.color)&&(this.meshFont.material.color.set(new Color(Se.color).convertSRGBToLinear()),this.needsRender=!0),i$w(Se.opacity)&&(this.meshFont.material.opacity=Se.opacity,this.meshBackground.material.opacity=.3/.5*this.meshFont.material.opacity,this.needsRender=!0),this.setOcclusionVisibility(Se)}highlight(Se){var Be,De;this.highlighted=!0,i$w(Se?.color)?(this.colorBeforeHighlight=(Be=this.colorBeforeHighlight)!=null?Be:this.meshFont.material.color.clone(),this.meshFont.material.color.set(new Color(Se.color).convertSRGBToLinear())):(this.opacityBeforeHighlight=(De=this.opacityBeforeHighlight)!=null?De:this.opacity,this.meshFont.material.opacity=this.opacity*E$t,this.meshBackground.material.opacity=.3/.5*this.meshFont.material.opacity),this.needsRender=!0}unhighlight(){this.highlighted=!1,i$w(this.opacityBeforeHighlight)&&(this.meshFont.material.opacity=this.opacityBeforeHighlight,this.meshBackground.material.opacity=.3/.5*this.meshFont.material.opacity,this.opacityBeforeHighlight=void 0),i$w(this.colorBeforeHighlight)&&(this.meshFont.material.color=new Color(this.colorBeforeHighlight),this.colorBeforeHighlight=void 0),this.needsRender=!0}setOcclusionVisibility(Se){var Be,De,Ve;const Fe=(De=(Be=Se.occlusionMode)!=null?Be:this.paramsStyle.occlusionMode)!=null?De:"translucence",Je=(Ve=Se.occlusionVisibility)!=null?Ve:this.paramsStyle.occlusionVisibility;i$w(Je)&&(Je?Fe==="depthTest"?(this.meshFont.material.depthTest=!1,this.remove(this.meshBackground)):Fe==="translucence"&&(this.meshFont.material.depthTest=!0,this.addIfNotExists(this.meshBackground)):(this.meshFont.material.depthTest=!0,this.remove(this.meshBackground)))}};var f$y=Object.defineProperty,g$t=Object.defineProperties,I$k=Object.getOwnPropertyDescriptors,u$p=Object.getOwnPropertySymbols,D$j=Object.prototype.hasOwnProperty,_$c=Object.prototype.propertyIsEnumerable,p$t=($e,Se,Be)=>Se in $e?f$y($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,h$n=($e,Se)=>{for(var Be in Se||(Se={}))D$j.call(Se,Be)&&p$t($e,Be,Se[Be]);if(u$p)for(var Be of u$p(Se))_$c.call(Se,Be)&&p$t($e,Be,Se[Be]);return $e},y$p=($e,Se)=>g$t($e,I$k(Se)),i$k=($e,Se,Be)=>(p$t($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const d$s=new BufferGeometry;d$s.name="blankGeometry";d$s.isBlank=!0;let j$i=class extends A$n{constructor(Se){super(Se),i$k(this,"name","PolygonMesh"),i$k(this,"points",[]),i$k(this,"planeHelperNeedUpdate",!0),i$k(this,"geometryInfoNeedUpdate",!0),i$k(this,"_paramsStyle"),i$k(this,"areaDom"),i$k(this,"planeHelper",null),i$k(this,"_geometryInfo",null),i$k(this,"lastRenderAreaItem"),i$k(this,"_onAdded",()=>{this.areaDom||this.updateAreaItems()}),i$k(this,"_onRemoved",()=>{var Be;(Be=this.areaDom)==null||Be.destroy(),this.areaDom=void 0}),i$k(this,"_onShowed",()=>{this.areaDom&&(this.areaDom.container.style.display="block")}),i$k(this,"_onHidden",()=>{this.areaDom&&(this.areaDom.container.style.display="none")}),Se!=null&&Se.points&&this.setPoints(Se.points),this._paramsStyle=Se??{},this.updateAreaItems(),this.addEventListener("removed",()=>{r$y.cacheObject.delete(this),r$y.checkDom(this)}),this.addEventListener("added",()=>{r$y.cacheObject.add(this)}),r$y.checkDomEveryFrame()}get normal(){return this.points.length>=3?new Vector3().crossVectors(this.points[1].clone().sub(this.points[0]),this.points[2].clone().sub(this.points[0])).normalize():new Vector3(0,0,1)}get style(){return y$p(h$n({},super.style),{lengthEnable:this._paramsStyle.lengthEnable})}get isBlank(){return!!this.geometry.isBlank}get center(){var Se;return(Se=this.geometryInfo)==null?void 0:Se.center.clone()}get geometryInfo(){return this.geometryInfoNeedUpdate&&(this.isBlank?this._geometryInfo=null:this._geometryInfo=b$n(this.geometry),this.geometryInfoNeedUpdate=!1),this._geometryInfo}get five(){var Se,Be;return(Be=(Se=window.globalModules)==null?void 0:Se.five)!=null?Be:window.$five}updateMatrixWorld(Se){if(super.updateMatrixWorld(Se),this.center){const Be=a$x(this,this.center).toArray().join(",");Be!==this.lastRenderAreaItem&&(this.updateAreaItems(),this.lastRenderAreaItem=Be)}}setStyle(Se){var Be;this._paramsStyle=h$n(h$n({},this._paramsStyle),Se),super.setStyle(this._paramsStyle);const De=(Be=this._paramsStyle.occlusionVisibility)!=null?Be:!0;this.areaDom&&(this.areaDom.intersectCheck=!De),this.updateAreaItems()}setPoints(Se,Be){var De,Ve;const Fe=Se.map(t$j);this.points=Fe,this.geometry=(Ve=h$q(this.points,{checkLinesIntersect:(De=Be?.checkLinesIntersect)!=null?De:!0}))!=null?Ve:d$s,this.planeHelperNeedUpdate=!0,this.geometryInfoNeedUpdate=!0,this.updateAreaItems()}projectPoint(Se){return Se&&(this.planeHelperNeedUpdate&&this.updatePlaneHelper(),this.planeHelper?this.planeHelper.projectPoint(Se,new Vector3):Se)}updatePlaneHelper(){this.points.length>=3?this.planeHelper=new Plane().setFromCoplanarPoints(this.points[0],this.points[1],this.points[2]):this.planeHelper=null,this.planeHelperNeedUpdate=!1}updateAreaItems(){var Se;const Be=()=>{var Ve;(Ve=this.areaDom)==null||Ve.destroy(),this.areaDom=void 0};if(!this._paramsStyle.lengthEnable||!this.geometryInfo)return Be();if(!this.five)return console.error("Five not found");this.areaDom=(Se=this.areaDom)!=null?Se:(()=>{var Ve;const Fe=new R$k(this.five),Je=(Ve=this._paramsStyle.occlusionVisibility)!=null?Ve:!0;return Fe.intersectCheck=!Je,Fe.simulate3D=!0,Fe})(),this.areaDom.setPosition(this.center);const De=o$z(this.geometryInfo.area,this._paramsStyle.lengthUnit);De?this.areaDom.container.innerHTML=c$B(De,{style:"color: #FFFFFF; background: #3366FF"}):this.areaDom.container.innerHTML=""}};function u$o($e,Se){return!(Math.abs($e.x-Se.x)>1e-5||Math.abs($e.y-Se.y)>1e-5||Math.abs($e.z-Se.z)>1e-5)}const j$h=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function A$m($e,Se,Be,De){$e.addEventListener?$e.addEventListener(Se,Be,De):$e.attachEvent&&$e.attachEvent("on".concat(Se),Be)}function O$d($e,Se,Be,De){$e.removeEventListener?$e.removeEventListener(Se,Be,De):$e.detachEvent&&$e.detachEvent("on".concat(Se),Be)}function B$j($e,Se){const Be=Se.slice(0,Se.length-1);for(let De=0;De<Be.length;De++)Be[De]=$e[Be[De].toLowerCase()];return Be}function D$i($e){typeof $e!="string"&&($e=""),$e=$e.replace(/\s/g,"");const Se=$e.split(",");let Be=Se.lastIndexOf("");for(;Be>=0;)Se[Be-1]+=",",Se.splice(Be,1),Be=Se.lastIndexOf("");return Se}function H$n($e,Se){const Be=$e.length>=Se.length?$e:Se,De=$e.length>=Se.length?Se:$e;let Ve=!0;for(let Fe=0;Fe<Be.length;Fe++)De.indexOf(Be[Fe])===-1&&(Ve=!1);return Ve}const b$j={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":j$h?173:189,"=":j$h?61:187,";":j$h?59:186,"'":222,"[":219,"]":221,"\\":220},g$s={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},C$d={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},u$n={16:!1,18:!1,17:!1,91:!1},c$t={};for(let $e=1;$e<20;$e++)b$j["f".concat($e)]=111+$e;let f$x=[],E$k=null,z$f="all";const w$j=new Map,L$f=$e=>b$j[$e.toLowerCase()]||g$s[$e.toLowerCase()]||$e.toUpperCase().charCodeAt(0),I$j=$e=>Object.keys(b$j).find(Se=>b$j[Se]===$e),R$d=$e=>Object.keys(g$s).find(Se=>g$s[Se]===$e);function F$d($e){z$f=$e||"all"}function x$n(){return z$f||"all"}function V$7(){return f$x.slice(0)}function X$6(){return f$x.map($e=>I$j($e)||R$d($e)||String.fromCharCode($e))}function q$j(){const $e=[];return Object.keys(c$t).forEach(Se=>{c$t[Se].forEach(Be=>{let{key:De,scope:Ve,mods:Fe,shortcut:Je}=Be;$e.push({scope:Ve,shortcut:Je,mods:Fe,keys:De.split("+").map(Xe=>L$f(Xe))})})}),$e}function v$p($e){const Se=$e.target||$e.srcElement,{tagName:Be}=Se;let De=!0;const Ve=Be==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(Se.type);return(Se.isContentEditable||(Ve||Be==="TEXTAREA"||Be==="SELECT")&&!Se.readOnly)&&(De=!1),De}function J$e($e){return typeof $e=="string"&&($e=L$f($e)),f$x.indexOf($e)!==-1}function Q$9($e,Se){let Be,De;$e||($e=x$n());for(const Ve in c$t)if(Object.prototype.hasOwnProperty.call(c$t,Ve))for(Be=c$t[Ve],De=0;De<Be.length;)Be[De].scope===$e?Be.splice(De,1).forEach(Fe=>{let{element:Je}=Fe;return S$i(Je)}):De++;x$n()===$e&&F$d(Se||"all")}function W$9($e){let Se=$e.keyCode||$e.which||$e.charCode;const Be=f$x.indexOf(Se);if(Be>=0&&f$x.splice(Be,1),$e.key&&$e.key.toLowerCase()==="meta"&&f$x.splice(0,f$x.length),(Se===93||Se===224)&&(Se=91),Se in u$n){u$n[Se]=!1;for(const De in g$s)g$s[De]===Se&&(K$e[De]=!1)}}function G$b($e){if(typeof $e>"u")Object.keys(c$t).forEach(Ve=>{Array.isArray(c$t[Ve])&&c$t[Ve].forEach(Fe=>_$b(Fe)),delete c$t[Ve]}),S$i(null);else if(Array.isArray($e))$e.forEach(Ve=>{Ve.key&&_$b(Ve)});else if(typeof $e=="object")$e.key&&_$b($e);else if(typeof $e=="string"){for(var Se=arguments.length,Be=new Array(Se>1?Se-1:0),De=1;De<Se;De++)Be[De-1]=arguments[De];let[Ve,Fe]=Be;typeof Ve=="function"&&(Fe=Ve,Ve=""),_$b({key:$e,scope:Ve,method:Fe,splitKey:"+"})}}const _$b=$e=>{let{key:Se,scope:Be,method:De,splitKey:Ve="+"}=$e;D$i(Se).forEach(Fe=>{const Je=Fe.split(Ve),Xe=Je.length,Ke=Je[Xe-1],Ye=Ke==="*"?"*":L$f(Ke);if(!c$t[Ye])return;Be||(Be=x$n());const or=Xe>1?B$j(g$s,Je):[],sr=[];c$t[Ye]=c$t[Ye].filter(cr=>{const Br=(De?cr.method===De:!0)&&cr.scope===Be&&H$n(cr.mods,or);return Br&&sr.push(cr.element),!Br}),sr.forEach(cr=>S$i(cr))})};function T$d($e,Se,Be,De){if(Se.element!==De)return;let Ve;if(Se.scope===Be||Se.scope==="all"){Ve=Se.mods.length>0;for(const Fe in u$n)Object.prototype.hasOwnProperty.call(u$n,Fe)&&(!u$n[Fe]&&Se.mods.indexOf(+Fe)>-1||u$n[Fe]&&Se.mods.indexOf(+Fe)===-1)&&(Ve=!1);(Se.mods.length===0&&!u$n[16]&&!u$n[18]&&!u$n[17]&&!u$n[91]||Ve||Se.shortcut==="*")&&(Se.keys=[],Se.keys=Se.keys.concat(f$x),Se.method($e,Se)===!1&&($e.preventDefault?$e.preventDefault():$e.returnValue=!1,$e.stopPropagation&&$e.stopPropagation(),$e.cancelBubble&&($e.cancelBubble=!0)))}}function U$b($e,Se){const Be=c$t["*"];let De=$e.keyCode||$e.which||$e.charCode;if(!K$e.filter.call(this,$e))return;if((De===93||De===224)&&(De=91),f$x.indexOf(De)===-1&&De!==229&&f$x.push(De),["metaKey","ctrlKey","altKey","shiftKey"].forEach(Xe=>{const Ke=C$d[Xe];$e[Xe]&&f$x.indexOf(Ke)===-1?f$x.push(Ke):!$e[Xe]&&f$x.indexOf(Ke)>-1?f$x.splice(f$x.indexOf(Ke),1):Xe==="metaKey"&&$e[Xe]&&(f$x=f$x.filter(Ye=>Ye in C$d||Ye===De))}),De in u$n){u$n[De]=!0;for(const Xe in g$s)g$s[Xe]===De&&(K$e[Xe]=!0);if(!Be)return}for(const Xe in u$n)Object.prototype.hasOwnProperty.call(u$n,Xe)&&(u$n[Xe]=$e[C$d[Xe]]);$e.getModifierState&&!($e.altKey&&!$e.ctrlKey)&&$e.getModifierState("AltGraph")&&(f$x.indexOf(17)===-1&&f$x.push(17),f$x.indexOf(18)===-1&&f$x.push(18),u$n[17]=!0,u$n[18]=!0);const Ve=x$n();if(Be)for(let Xe=0;Xe<Be.length;Xe++)Be[Xe].scope===Ve&&($e.type==="keydown"&&Be[Xe].keydown||$e.type==="keyup"&&Be[Xe].keyup)&&T$d($e,Be[Xe],Ve,Se);if(!(De in c$t))return;const Fe=c$t[De],Je=Fe.length;for(let Xe=0;Xe<Je;Xe++)if(($e.type==="keydown"&&Fe[Xe].keydown||$e.type==="keyup"&&Fe[Xe].keyup)&&Fe[Xe].key){const Ke=Fe[Xe],{splitKey:Ye}=Ke,or=Ke.key.split(Ye),sr=[];for(let cr=0;cr<or.length;cr++)sr.push(L$f(or[cr]));sr.sort().join("")===f$x.sort().join("")&&T$d($e,Ke,Ve,Se)}}function K$e($e,Se,Be){f$x=[];const De=D$i($e);let Ve=[],Fe="all",Je=document,Xe=0,Ke=!1,Ye=!0,or="+",sr=!1,cr=!1;for(Be===void 0&&typeof Se=="function"&&(Be=Se),Object.prototype.toString.call(Se)==="[object Object]"&&(Se.scope&&(Fe=Se.scope),Se.element&&(Je=Se.element),Se.keyup&&(Ke=Se.keyup),Se.keydown!==void 0&&(Ye=Se.keydown),Se.capture!==void 0&&(sr=Se.capture),typeof Se.splitKey=="string"&&(or=Se.splitKey),Se.single===!0&&(cr=!0)),typeof Se=="string"&&(Fe=Se),cr&&G$b($e,Fe);Xe<De.length;Xe++)$e=De[Xe].split(or),Ve=[],$e.length>1&&(Ve=B$j(g$s,$e)),$e=$e[$e.length-1],$e=$e==="*"?"*":L$f($e),$e in c$t||(c$t[$e]=[]),c$t[$e].push({keyup:Ke,keydown:Ye,scope:Fe,mods:Ve,shortcut:De[Xe],method:Be,key:De[Xe],splitKey:or,element:Je});if(typeof Je<"u"&&window){if(!w$j.has(Je)){const Br=function(){let en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return U$b(en,Je)},tn=function(){let en=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;U$b(en,Je),W$9(en)};w$j.set(Je,{keydownListener:Br,keyupListenr:tn,capture:sr}),A$m(Je,"keydown",Br,sr),A$m(Je,"keyup",tn,sr)}if(!E$k){const Br=()=>{f$x=[]};E$k={listener:Br,capture:sr},A$m(window,"focus",Br,sr)}}}function Y$9($e){let Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(c$t).forEach(Be=>{c$t[Be].filter(De=>De.scope===Se&&De.shortcut===$e).forEach(De=>{De&&De.method&&De.method()})})}function S$i($e){const Se=Object.values(c$t).flat();if(Se.findIndex(Be=>{let{element:De}=Be;return De===$e})<0){const{keydownListener:Be,keyupListenr:De,capture:Ve}=w$j.get($e)||{};Be&&De&&(O$d($e,"keyup",De,Ve),O$d($e,"keydown",Be,Ve),w$j.delete($e))}if((Se.length<=0||w$j.size<=0)&&(Object.keys(w$j).forEach(Be=>{const{keydownListener:De,keyupListenr:Ve,capture:Fe}=w$j.get(Be)||{};De&&Ve&&(O$d(Be,"keyup",Ve,Fe),O$d(Be,"keydown",De,Fe),w$j.delete(Be))}),w$j.clear(),Object.keys(c$t).forEach(Be=>delete c$t[Be]),E$k)){const{listener:Be,capture:De}=E$k;O$d(window,"focus",Be,De),E$k=null}}const P$m={getPressedKeyString:X$6,setScope:F$d,getScope:x$n,deleteScope:Q$9,getPressedKeyCodes:V$7,getAllKeyCodes:q$j,isPressed:J$e,filter:v$p,trigger:Y$9,unbind:G$b,keyMap:b$j,modifier:g$s,modifierMap:C$d};for(const $e in P$m)Object.prototype.hasOwnProperty.call(P$m,$e)&&(K$e[$e]=P$m[$e]);if(typeof window<"u"){const $e=window.hotkeys;K$e.noConflict=Se=>(Se&&window.hotkeys===K$e&&(window.hotkeys=$e),K$e),window.hotkeys=K$e}const A$l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAABmCAYAAAA53+RiAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAZqADAAQAAAABAAAAZgAAAACBRx3mAAAKZ0lEQVR4Ae2d65PVRBDFWUF8IAoiLIJICaVAUSgUfvH//2RpgRRUCSgI5QIFAiryfrieX3Y6Jtnk5nGTubn3dlf15j3Tc066e2aSzd2yxWWUCKyM0qoJRq2vr2Pz1qCsv5VRrW5Zz+i/Wn8jfbWyssL+uZFREyMSAP3tjG7TOqQYIVpN1tkuavHYa+14FfS5lk9FFvtGKaMiJniDEbFdiEGE2QiI5gGs4wnmHew3j+D8rBdRBmWh7wQ1cl9q+0nQxyKKckYh1uiZGiNCAM9AM5vsDn/Z952t+t5VfTukHwSFSIh9JH2o+h5rOVMxEKIbEbzDyOAOBhhCzQsBwzKKBDveV2UfS3dJuUmo/4H0nmzBM6NLdGIKhHCn4hkvpDNP0LINez6S7pFCEqHtnvRuzJtF9aXxm/VBJUMIsR4PIb4/n9UdWddY2fuezjkghSS8+Q/pmuzlRhpconiMGklCp6HUR5iAkNEkWtlTKbKdfARBq1JIuSnb8aJBZVBi1ChCA4TgIRDxTI2aScxW3VOJ2kJn4aj0QymdhF/VlqdaDiKDEaOGELK42xA8hNA196J24TlHpESB62rX2hCN6p0YGU6ZEILhuD5eYmMMbc6/qI207Zh0r5Tcc1lt7DX39EqMDCZkQQpLur30thZW1N5DatyXUtp5Ue0lxPUivREjI+n/W+ia21zSFlW1m5zztZQx2QWRc79tGWXn90JMIIVBGomdOaiFCl1lwGX3qf2EtrNSxkCX1P5b2eNd1qcmRkbZHBS9rqUjxUAXDoTvM1LyzhWRc92OdVlORUyGlDcyZLCuY5eGzeIa4QGe30g/k/4sTK51tYO80ElkhOWU107KBoTCgRD+UyDopJZMwP7eBeBOxARSkpzipJTCfkF76QidDuTcLT1rwk5G5q1EFRFLGc0nOaXVxUtysm5WsPlB+pf0rDCjU9BKWhGjCoihkII8Ca67seV/cwgIGwac30t5WnpG2NFzayytiFGpkILHLG3vqzGyOlHkMA11TkpYOyVtLI2JEeN0i2F9tFP1jVsd8USRQzi7LN0rDD9vWnUjYlQg51myX+hplqbAtTlP5NzQ+Twq+EpY8ji7VhoRo1LSvFJbop9QhcAlHeBZFJOftVJLTCaELdwscS06PZ4gr4GUX6S7hOn+uqInEqMC6IV5CKtDseFxkXNbp/4pPSpsJ44hJxKjAghhnPNM6tIPAldVDKQcnlRcJTHBW5jK7v29rkkGLfoxeQ3vrN2RfiqMK8c2lcToQveW4e4Smz87WFVFKTEFb5nLlyeqGjyG/fIaUgOPpPdX5ZpSYnSBPR723DIck3gN+Jf20KqIIYzxZmSvLxgM18b5K1nY8vzqoXRfmfWbiAkJifkwJt9chkWAcLZdmPPeQE42EaOjNspfiPfAcq0d3wZjGgaevIabkxwxmaTPq0dL9UJFDpVIG8KY5zb8VwGzATkuchs6gRlk9nkYEwiRBGLAPPcwrUgMA0oRuRivs0YCdtpqGHDSycrNOheJwWM8t0wLdYvrQ8r4R5fszF6WEqMYR0/MicmiE28dr6F3lk7RpMQEUjDFH4SBQlzBY+gIpOGsSAz5he6bS0QEhDkzLBBjQ5WkN2Am4EZOiqERf0lPuDSUsdMnLOMTYjVCDL3iRJJQFgaWPLzxubEAzAwW5PZtgYs0lEEKJHkomwEjoUqIIc/QM06JoavM830OuMwGAXOK5F0A65WxdGJmQ4jVilOg8JB6jBMDGrMVi1alxPiM8uzIMY9JopiFMnIMYqxtbPnfmAgY9jliMMBIimmM15VHAHKSqGVksEFss+386b4VAwHDPvGc3IYTEwP/yjqsV5wjBo+BJCOq8mo/MBgCYA8POWLYgDHrBGjVJTICSTdZdeaIYY6MA+nsZmSjvLoNp8BjkolkC108ToaYdHbTkYqOAE4BMclEckJMeO7MXE0ygRbdJK8QBJgjS78Lah7DAbwmfYLGDpeoCJDfbSIz1wuDGPusVVSLvLIEAYhJn4dlPYbnzlv1oMa9JvKdknk7Jn11LEsMr9DQAci93xTZxmWtznJ7+oZSSkx4O4YDTkz82wNiSPzJGIbqU2KCLXjNTnvuHPb5YngE6Cqn3kJ1RWJ48YyT0hfPOMllOATkBHgLKSTNL9RWJOZv7cOdPuGgSxQEGNQz2q8mJsQ4/plmj5gskhbFymWqJKQMiOHDSYz6UykD/76OEs52p2f5ylAIWBjL5Rcq20SMmOOjzrjVKie4DIoA3sI3RdMRv9W2iZhwgE847Zar8R0ZlwEQELaM9PGY0v/eqyLmji4g5h2SugyDADMsJP3mxMi1mLOBnH1i1qdoBESfkvGWyn9CrvIY7LglpX99mA2XXhFgsphhSeWXRyqJkdfQAbgt5XsnPuAUEH1IE2+hnkpighE3tCSsnQjbvpgeATpUeEtpbrHiJxITcs01ncwHAg7aRb7shoAwpHtMb6z288gTiaF6kUMngNkAvoDKwNOlAwLCjnxNbmEWedO4pVhkLTHhgstaQsqpYgG+3RgBGxNWJvxsSY2IEcM8DrgiXRXzX2QL8PV6BDIhjC/xps9cJl3ZiBgKUIE3tbgrPaGK+FVVlwYICCtyCrmFqZfcDPKkyxsTEwq5qCW9CX7hgekElwkICCPyCiGMEX6jEGbFtSJGjJO07EcEvlPFyf8LWmG+/B+BDClMbbX+mHgrYqhW5PAjAj9K+Srdt8EArboUEGAqC3x51tIor2Svb00MF6sics15KU86T0tdMgjoZoUUcguekr4rljmldrVzKFKFazKAPHNcS9yV34BkudQSSAFXJig7kQKAnYnhYlV8PZByjLK0fl77SHRLJ2q7DSCNlMY9sDKwKGxqkVEHVMhJKU8/z4mc2pHt1JWOqIBACr0vUkPn8JVtUi/EUKCMI98wM8Cd0uvvDqu80YraTS5hqgUsSfSdw1e2kb0RQ6Eykp4ansOAit+7X9NyYUXtJcdCCmR06n1VgdMrMVQiY4mxx6V4EB98vrpooU1tBDfreRkpvXZ8eidGBici43lMcERKvvlN5NDFnnsJXkJEQOh5TZXkN4rZ/HcwYqhKjSAhHpUS4njLE4KeaDl3oraQS/ASErx5SeuBY9OGD0qMGaFG8Yvdh6U0jvB2WwRNfIKnc0Yhsh0i8BAeexCuyCWD9zqjEKPGWO4hvEES8lB6R41sNbmXXBnhT/CQLCGErMq3Wvo2KRoxZrgazJ23KqVzgAcx9/ZA+kgkDRYaVH6tyDbwwD56W3Ri8BBeX41GiOpKJDoxVnG4I/GePVLAIG5DEo+xa5+J65zeJNws5h2Uyw1CqOX32XrtbVF4E5kZMVnjBAyvR/ESO50EbGJah05CogKn13yk+vAGbgZTrSZk4B2j+LG8URADKogAI9FC0g4pPTqAQ/AmYnxW2cedbWp3Nm2iHJYo4bKo2pV+7IBEnuisvANjijIqYorGhTsbghhdQxJ3usV+rSbgQoyRwtKU4xxD2Af4eCKEGhF2XLvGJaMmpgwqkYXNkIQXsJ71DggwomwJGW/G5A2yx2VeEfgPPUASVA2Hk1IAAAAASUVORK5CYII=",o$s=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="22" height="22" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
        <linearGradient id="grad1" x1="22.39%" y1="67.34%" x2="56.24%" y2="-36.34%">
            <stop stop-color="#FFFFFF" offset="0%"/>
            <stop stop-color="#FFFFFF" stop-opacity="0.5" offset="100%"/>
        </linearGradient>
    </defs>
    <g fill-rule="nonzero" transform="translate(3.39, 2.29)">
        <path d="M14.39,3.17C14.82,3.17,15.17,3.52,15.17,3.96C15.17,4.4,14.82,4.75,14.39,4.75L14.06,4.75L13.16,15.72C13.08,16.68,12.29,17.42,11.34,17.42H3.87C2.92,17.42,2.13,16.68,2.06,15.72L1.15,4.75L0.83,4.75C0.4,4.75,0.05,4.4,0.05,3.96C0.05,3.52,0.4,3.17,0.83,3.17L14.39,3.17ZM12.49,4.75L2.72,4.75L3.61,15.59C3.62,15.71,3.7,15.8,3.81,15.82L3.87,15.83H11.34C11.48,15.83,11.59,15.73,11.6,15.59L12.49,4.75ZM6.04,7.39C6.48,7.39,6.83,7.74,6.83,8.18V12.4C6.83,12.84,6.48,13.19,6.04,13.19C5.61,13.19,5.26,12.84,5.26,12.4V8.18C5.26,7.74,5.61,7.39,6.04,7.39ZM9.17,7.39C9.61,7.39,9.96,7.74,9.96,8.18V12.4C9.96,12.84,9.61,13.19,9.17,13.19C8.74,13.19,8.39,12.84,8.39,12.4V8.18C8.39,7.74,8.74,7.39,9.17,7.39ZM10.22,0C10.65,0,11,0.35,11,0.79C11,1.23,10.65,1.58,10.22,1.58H5C4.57,1.58,4.22,1.23,4.22,0.79C4.22,0.35,4.57,0,5,0H10.22Z" fill="url(#grad1)"/>
    </g>
</svg>`;var l$l=Object.defineProperty,u$m=($e,Se,Be)=>Se in $e?l$l($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$q=($e,Se,Be)=>(u$m($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const d$r={auto:"",pen:"","pen-forbidden":"","pen-crosshair":"","pne-polygon":"","pen-circle":"","crosshair-rectangle":"","crosshair-circle":""},h$m={position:"absolute",width:"34px",height:"34px",transform:"translate(-50%, -40px)",borderRadius:"50%",cursor:"pointer",zIndex:"9999",userSelect:"none",display:"flex",pointerEvents:"auto",alignItems:"center",justifyContent:"center",backgroundSize:"34px 34px",backgroundPosition:"center",backgroundRepeat:"no-repeat"},m$k=`
  <div style="width: 32px; height: 32px; background-color: rgba(0, 0, 0, 0.5); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
    ${o$s}
  </div>
`;let B$i=class{constructor(Se){r$q(this,"container"),r$q(this,"deleteButton"),this.container=Se??document.documentElement}setType(Se){const Be=d$r[Se];Be?this.container.style.cursor=`url(${Be}), auto`:this.container.style.cursor=Se}showDeleteButton(Se){const{clientX:Be,clientY:De,container:Ve=this.container,onClick:Fe}=Se;let Je=this.deleteButton;return Je||(Je=document.createElement("div"),Object.assign(Je.style,h$m),Je.style.backgroundImage=`url(${A$l})`,Je.innerHTML=m$k),this.deleteButton=Je,Ve.appendChild(Je),Je.style.left=`${Be}px`,Je.style.top=`${De}px`,Je.onclick=()=>{Ve.removeChild(Je),Fe()},Je}removeDeleteButton(){this.deleteButton&&this.deleteButton.remove()}tip(Se){return()=>this.closeTip()}closeTip(){}reset(){this.container.style.cursor="auto"}};var o$r={},u$l={get exports(){return o$r},set exports($e){o$r=$e}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function($e){(function(){var Se={}.hasOwnProperty;function Be(){for(var Fe="",Je=0;Je<arguments.length;Je++){var Xe=arguments[Je];Xe&&(Fe=Ve(Fe,De(Xe)))}return Fe}function De(Fe){if(typeof Fe=="string"||typeof Fe=="number")return Fe;if(typeof Fe!="object")return"";if(Array.isArray(Fe))return Be.apply(null,Fe);if(Fe.toString!==Object.prototype.toString&&!Fe.toString.toString().includes("[native code]"))return Fe.toString();var Je="";for(var Xe in Fe)Se.call(Fe,Xe)&&Fe[Xe]&&(Je=Ve(Je,Xe));return Je}function Ve(Fe,Je){return Je?Fe?Fe+" "+Je:Fe+Je:Fe}$e.exports?(Be.default=Be,$e.exports=Be):window.classNames=Be})()})(u$l);const a$l=o$r,A$k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAKqADAAQAAAABAAAAKgAAAADUGqULAAAB0ElEQVRYCe2WSUoEQRBFLVHEiVZU1I03cKW38SSewRt4A5fiTty5cQIFR9pZQWkcUNSe2/Z9yISiSGxRkUAy4BGZSVX168gistraYsQKxArECsQKxApYqkDyU5lmsznMM+ZgAGpQhaUkSRbINgLJCXiCBtSgAkVYtGGIBTKj8AgKSVahDNvQa0IUkUG4Bx91BpLdBTOS/cgUIB3a+gMwI9mFzE3a0I3z5B4r292JzGVA8tSSZILMcUDyzIykthOZvYDk+V9Ktmz4yGzhOhV4/+5YU4N/hzqo0StX3Fg5TcnNlYvgs8bPsM4hkScHoyO46haRnGEYktQVI+4ypUYKyXtxyUu27JCceAMJvjo0HoM5CEZ7cPX7i013q3IWVV5r2aw/2TK+svWbPGU68KQCa6pYeus1V0X99quSfvtVSc39lmfz2mdbz32tg1dAJ0421AVs9E7/FxBSezrMmjI/gm5/nYmMkBq+TqBs7LNgTlZH6EnWlPmORdk+pHQipUNfTxtg7p3NIXWRMvXfoqusmXsNhpC6crIS1Zf9C6yAOdlxpK5BW18CiT7A/G93gE+P0FY/RoO+RWqS62YhB2r4YhlixArECsQKxArECvzjCnwAOr0wF44ggHAAAAAASUVORK5CYII=",a$k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAACoCAMAAAD6pITnAAABQVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACvr68AAAAAAAAAAAB5eXkAAAA8PDzr6+sLCwuenp4UFBT////8/PyLi4umpqZycnKxsbHMzMykpKTy8vKoqKhcXFwpKSmwsLD+/v7k5OSCgoLw8PDo6Oi0tLRkZGSrq6syMjL6+vrn5+eYmJj29vbd3d3Q0NCwsLDDw8Pz8/PT09P09PSwsLB/f39OTk739/fh4eHY2NiFhYX4+PjGxsZkZGSkpKS3t7eRkZG/v78eHh6CgoKKiorr6+uysrL+/v77+/vb29v9/f2wsLCysrKxsbFdXV39/f3u7u7t7e3j4+OoqKj5+fmrq6vp6elqamqVlZWtra0+Pj7w8PDW1tbJycnNzc27u7v29vba2tqXl5cjIyNsbGzf399ubm7d3d3///8pT4ZyAAAAanRSTlMzAAYIDA8KFRIccB8XIlIZPr80ZDb88FppT2iLaNJrRzpW+LNWzrp0Sm086rdg26WST4LVltltU0Pfq51X44UoJHdcfjcuHMFF++6i82RiWxX2x8SvSOc7vEs1LiHKmYiOe92gLCMfqE2kqsY2dQAAEBhJREFUeNrs2MFqq0AUxvHT28xdnEWQGNBKMHGnARdutIsspARxU+NOiu//HrdUZFozYTxMbltn5v8IPw7fxMCD7Vuy0OIs9FKz0OIs9FKz0OIs9FKz0OKWCf3nl/fw37sz9O8n/Tl+dWj9hO/nrQ5tCLICtiq0HPlRi1Sw7w+tIfA0ZWt1aLHxX2165NGt6dByZqHwasEJvRWoVaAnyjrwivqKTaVWh/6iPCFm2sS5OTaBWh16osyRq7Krs+jSBDkuvDxoLlFWd2XFsbm1gJoMTWcezrjqswbf8930xTsV64VXnLyX1PXxvSbrq+G41ag5NJGZK7d9/Yroe+u9swWt2jr7tecjvtZ9y63p1HRoAXOZ5Rh68QG07RB7IeZZOaHm0lRoOjOr6gD9wgHtcwofg7piCtRAdebMZYaJ9wyG9OwlmJWcmioN5HMemSMMnzQbZclkP4UYjdTkowai8zgaF/TfNmBYmzcfL+OACKTVoSfMbY1+bBzzB3XsY91OqAnQFGe26gMsjBqNz20LDPoVI0sDZTaGc44wPYLBHVOMhqOmzAfMdB7PmZVBEoPhxUlQsuGoZ0sDbTZYh67R5zx0dLFjkvkgQl/NxsnIR3Da5nQ1HwRoiTNjVZPswfbRPmkqxuZLA8U5CA343J6bEwYUaZjvXOY7jf87onfY5aVEmgLNndE9g+1TZxe5NAFa5pwa+5Fyq206XxpmOle5a52vpd28mikNsoEe38Gd3Q1B5934IspmGmY5t01o30Fhh7BpJ9JkaO7MosT+rruRk0SMS0ugZc4d2u+Um+2xmyMNsoeQMVbiP/bMhSdtKIrjJ3sEcrMsFagFpqC4ifIaviY4MAONPHQ6xDgX49vodr7/B9i5lnpb0setddFFfonaXhDw58n/nNvWYIQjNfaNJImG6Fe0COhkdHR9w4VINPnDu6RBJqBH1+tcycnENHh6PmYv/vqzF3Ps2GLav+i3PDiKMMKDIg+Pt+6iPQo63Gaj4PAkx9phc0nLi6YGqnveYqswwpNVtqWbJnGSoq3BEd6Ljy5xSBCL74XN4SEpWgTHt1EnlO2H30R4SIm2FvR0fDRCSxGJT7uXNHgU9C8YIcUvj5IGl4IOhxdSo4KWJJJaCIddShrcCnqLJWCEJAm25VbS4FbQ7fkY+GF9vzUPL5XYfNutpMGloMNJDfxQRuLgxe5vtGTYpaTBpaCvWQX8cIicahNeJhV2bSlpGdF6QS/EwReooy5HgvdwTdMUuSaUIBzfMJ3NZjVwYKr52/LcjULUErrrRQX8EF/QS1pOtCjoH19WfYo2+BR4KCwgIgMZFCQchWQRccam+LTs+UxJxSUQnCLiEZg4p4Vt8MHqlx+ipF1FWwv6mCkPFI07F89MdCQ+zxoXG+vlq4Ojk1IPDRbhnvcqopoGwSwiboAPFHZsKWkv0UYrbKfAH2iioDwr0VBCWy5NY9UYnZ8OtZwE+CHVNtqht2iRHKHvWgDReBgNKrqwbOV9ENHLOIR6eHLVsGR0kVbzQnyaTrvgC+17yDE7wDE5bthcENGofo0FEz0MCyI6gZ3eeL5eXVnKkM7Fid82H+4EERtgcEFnY36vLN04Zgc4JscxmwoimlhK/BvRxc8m1pBYM68kHJthDogq4goQMyfrFcPphzsKSA/dHfEWc0RnrUWBRBZOsWPH7ADH5KDhLqBo7C3+E9Fn6ErUXnSMjfUqQnS6gzgJOis4RAkgl0ErCakBT2SHt+g3uuhdLahoYqzycNHlqJWKT9EH/X6fK8z3+wd0GqXDZSGaT3MTLqIb+ADR2q4u+o276FcW0ex9YNFEPvXIU4e86LpYqgPRQjyMGKI3u4h9cBE99hDR75lJNOEm2kiOG5YOIlrwefOxRacnTDAkmHlFcRDNB2VmiN6gVe0+YCiC6dmZRYMsJFS+xS1z+jx+ymUFvEmzGyM7PESLiL5mSiDRglLtKeZoq+hKniB3vbvvaj7f49+JbRgwSQ+CYE3sE//QYVF2y3ItQlpS9E8WCyZakPkAUjABn7S+MhOaf9EKwQu3QD8r6MCBveh0R2RQiw5/gxQx9lNStIjodhz8go7sS8WQis7MBtsZeotesoi+Ne1WqnQsO+nG207dEOyn6FBoIRpctKCbfVrRue07jhC74/TFO6G+0jA1xB0wKKpI1PQq7SCOgyTRhVDIfpIGh14Ymi4GFW3lIPd0og3i46hO8GbY3BF5JhJ9J6UzMVVFzhVwEsi7pyTF6ZBDNwSHiA7tNR9XNFabEqI7H2yYMYs+H7PSR6I/tFi2FV1WEcv61DHRGc6zLt4zvm2aVWBevIQ3zT0h+rWc6F3tkUVjp+wtOgM2NMyiCyjBmFV0hP8ttRYfJIzxrqGS0GUF7smYRPPfWjJmjQ90sA6SaLu+RSdrjyyaWH8a0azUgmYLiVbOEA3ZHaSw2DaqOoKCLpxiq0Lmb4HYp5UmSFJLyokWQ8e7L6uPL3rpSUR3yOy+HroR00WlxAoSna8i6i/PiC4XDX8UmKXSzgHM8U8Vk7/J8m4wdvz3ouc+WikiURxanDP/KpFHInMBFqZmkDgbvKyRxHUu2sjmc/3Wfh/+oejnGh0+po7E+YmKnN5ZgdueHCaDeLg56GJ8hzQQndfDJE9Hm3Dp64ZWLekl2npJKRR691ybobTojUvjfW/TUKnX0YbCacN0mf/MIhqueGnwf0BGAflm+C4UuhdNeIt+mvFO/WRDdVj0Gi1u2oqmB2bETWwdfWEWbViz3ANngzuFh/pSOoNYv+UtFKRp7vkW/Zw3LJN8U2wrmo5LRnEhkbGILnNK9JQycWoRXTBmizzZBZ3PtMY/0zxIU5z2Lfo5b8GlREfGM4VUwyxaBc7RYChRLKL52FwZbFyqIEpatHDJLbhv0X/ZOaPetGEgAEd7K0LLYBAadQXagcogndAQEiorFQsoCs0eKAG1qHSsPKzL//8By9mxEzMy26jNHpp7gCgoEf7sO/vOd/4PQSXtH+JKg1YO/btnoqCnxDRr4RsgQCo1oCGoJA062TApX6RBg7CgPR1k5vc7fJeioHVqiqeRIXwnOaAhTCoNOvnAf20Q17X59ad9QQtOhj9gQ5G44scEG/ImHfT3hQP/0qCT38qyvMVghM+kxPZubdziHuh4k8rLggbPsUxc8Zuge4NHWsT9EdrK2gLNd1jUpDdnzz3s87a7RU8nAXe4KFxC458D9CkILCLRRQR00yZzYTN04F2aNyas228zqrRnqCadblAPtHdDXMg2UedDeFN7f9D8yRCF62gimEEXd97iAT7rVWF/RR509jkSaMTCizS04ACwMlnMNYpAjbTZ/vaCoA0U1wD5Gtyt5JA+Pil9NF6qohnSWQJaOEyaXSaaEvbukuRyVn2dnlDDWUO3HkGBRwzoZh4LBp0PRBZ0mLHrYUts4r9haogzNOAjcmuF1LuaWWal49HZZJMcDTygQVaE7xcS6FFKNjIjIeh4YUFvGBvdAfERavDdDUHDb/WwvweNGfay0CxVWMG1vRZLctwDtJpk2u5PeOSIugn4skG3k5ACn+pyoC/quRsYqhveqqOEI4vW8Wxlo8spbkEtULauqNNV+q4Kgn4TBT1PLhH9zoExlVeo9lp0ox+b5uoCmioH+iG4YfJAX0OHFpQL8oLCZxSLoi1oGuQ9HCnPKWj+LjhdSKvL5EorCv2iN9VJTBdekCfZFb/DUKkxioC2cruEccGDqGGBgu5H5ZqCHvkgh3STYPEE+ZDakFE4B/qe764sATQ33WB72XGfZLHQh9YRpW57jy7q44w3uSXjaKUNd646WImCbjqOo3V/9ZRwMgyFXXX0YW3Xc636zDWhN91tO6F3tIrA9sp93KIDQMcb6T3L3+y9yt964UPviSZV9UhTIw09Gwxi3HX/h2FMXM00Wd0f+TfOKfWt5cPfOlcSWdyFlkMKtGxBZ+vVF3QKg2ZnQzUtUZYrUVYBtFDaLmuk1bls0f3KKiuvVfyie5Ux0b5wSivokL5Kj5EQFz1zBQOaU1qx20gfnKQHo4gfjHJywJpofvlbaDvG6VE/4kf9jMFyCJe/sbbjID28SvjwKjygOQWdcbZDHafHsf1h74xxGISBIJjWdhOFF6RLeAOSm7ikpEH+/zviQ4LTWTbrB+w9YbRaBBI7Y/cpgW40B/rpXiPNgcHRgUENNPjpvt0dkZOZY5OZ0TQHAl13RyG9cQQW3+y3wrnZHAoaRDpz1nhk1jjXgcag60jvfB7iJ+FuAo1Ba3dopB2n5/H0vNNAd+fYYKQzZQpIppBRoAU0jnSiHuReD5JgoAU0jrSj8OZeeONgoAU0jHQhTYVT955HQYNAg6FuLY+8UkrWk5KtWYsDDHWDSAvpSM1eT7MXtTjA9DyOtJCmOLItjhTOONBYD3KRTlShtlSo6eLc0INg0LY8jpp2iXLf6n6TcJaCNsXRB43LQ0iHRF11ratOQTjD4sCgLelIAbsVsEfLGYBGpLWmQ1y/fHM531O+awymoLFmD9f0STq//cLvHuVei39n4QwLelyFakiHzU/8lveYJ78Fw3lAhQojbUn/27Gf1kaBOIzju2kWktH8oQ1oPaTrzSzk4CX2UBAKHiUnKfXu+38Lu78Js08rA89h2sOMfl+B82F4RJvsNPn/08Upa+BsGWgKzaX1fJwnfan/nPVsMGfEoe3SUZ+parIfL4dKZX1kdybQiErHN+mhU2kxyZfifZGqbrg5x9yZQ2M8xtJ6qKP6qtL3yVHfv6fqWkd6nsfOGA4GzaVXRlqom1wdHyc1IIfHo8obYTbOK+rMobl0VOfqlDz/mEjPyUnldUScHaBH0p+pu0yl1QQ+y/dVqrLuE/PY2QGaSGvqoSkv6pgUAf9t+l0kR3Upm0EzU2cOzaWt1Juh71ql0mT7tA9ssg/7p22SKtV2/bCxMFudOTSXXkIa1GK9qfuyVf9KH86vyUu19bzqJXk9P6Ryorbs640ogxnOS4szg+bSmA9QG2vBHurmrSvza5tdlOddsvaal91bUw+CbJTBjNmAM4Xm0pKWxnwYalgLdnBFH5UNM2ZDOy/gTKC5NObDSm2sA/KO0NrCjNkgzgSazIdIG2pYi3ZgrddQBrM409ng0Fwa1P+tDXYY4msJyFAGM3Em0ETaQg1rwRbugNrpYijbmeHsDg3pMbVYA1u0db6q75AYA1mUR8zMmUPzS22oYW200c7T4lswhjKY+XXm0Fwa1LDW2Cj2OpxDkKEMZpszh3aghrXhDqiVCcqE2Rka0iNqWEPbZ3U8O4yhDGbi7A4Naqu1cAfTLwRlwuwAzanFWmsH2VISZcLsAE2pYS3YwXHLaYAMZc7sDg1qWBtszR1Y5lx3UCbMDtCMWqyBHQI5TgFkKBNmB2hGDWvtHUx3aOHA7AgNa2gH2QI5KLtBwzpA8AVyVHaHBnbwOeA4Qk8I2wHla6GD9f4yFA7tnh/8P789gZ6zNUP72gxtb4b2tRna3gztazO0vRna1/4CjIBfFd68JpIAAAAASUVORK5CYII=",g$r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABUCAYAAAAcaxDBAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAVKADAAQAAAABAAAAVAAAAAC3aM1AAAAKo0lEQVR4Ae2cW2wU1xmAxxcutqFxRJ04jWW5NBelIJUKcX1ARaWoAp4QEiAFaFBAPIBElDcQEkg0Sh6IokjNQ1NxKw9IjaUg1X1IXQl4AIGEQh4IFQHkGhsMhnKLL1Bj9//G+4/Pzs7OztpzW9u/9O+5zJlzznz7n/+cMzO7ZVY6ZLp0o1qUsCqjlRJWGCpR64WhAxLvy2i/hL2ihIlKWUKtT5V2a0VfyijpMOS5VPI4o48kJB2rxAkUa5slWicKyDgEuN2iD0Sx7sglDqAM4ddFfypaHvkVeTcwKNn3RTtFcRORSZRAa6TXDaJYZZoEa+0Q7YmiU1EAxR82iWKRaRYstk00VD8bJlDqqhdtFMVfloLgV9tFu0SHwuhwWEBZ7rwlOiOMTiVQx4/S5jXRMS+7wrAkfOQvRYFaqoKbekUUoGOatMYCFOv+uWiTaFKztzQdmnAN+H02FCy3RiWjBUrjb4vyrY43mSkXxArlv6JF+9XRAOUbfEeUnc54FdbOPxEFKmvYwFIsUGDOFS3VyScwGCk4TfRlUZZXgaEWA5RhjmVOBJhymbZMkU9cAFADDf+gQJmA8JnjeZjL5XkKlsqdMHZYBSUoUGbz8TgBFQSUKYBPxd1xB8tXggBlndnkW8vEOMjQ556r7zq10PqRxfobE4NXoKuEhe8Gxg8ofpPtZBArDtSbcVAIFjCBjaf4wXpNznjV86yJnck2lccv7P9zJJ+FchJ3jSbFmwBsYJQj+YA2SUk/682paIJlwKbJ65q9gLKPTfvNYa9riTsPRrDKEi+gPLaIXLZs2fJae3v7oVu3bn129OjRJZE3GE0DOazcsxUL2F9H0/ZIrYsWLao5e/Zsy9SpU6cMDQ1ZZWVlQ/fu3bu2devWD1taWh6OlCyJ2LfSS2dt6gbKOivyHdGZM2c2LVu2bMf9+/etvr4+q7a21poxY4b1QuTSpUt/Xbx48ZclgXK4k/ckuK79NYc8jjYW3ykAeTZvPX/+3MJCHz58aN29e9caHBysEOv9w5MnT77ev38/671SEJg5E7gJlC2mmY71YoALVODW1NTU7du37/CNGzcOzpw5M7E+BQRA/5xH5WZnbasJWEkkxbDWp0+fWnfu3LGePXtWNnv27OXd3d3fNDc3/zaSBsOr1GGnQFmkxvV6TMHLEFdq4V8fPHhgVVZWVq1du/aAgD28evVqbvimUWBnL/QVaOruc8rMb/X391sy+1s9PT1ls2bNevvUqVNfX7x48f00EpU+2QwVaGqsE1jAVCWNG8C3yqRVOX/+/Pdk0mo+cODAmxxLkdgMUwMUgIiCNNPl5eXWwMCA9fjxY6u3t9eqrq6u37t37+GbN2/uS9Gk5QDl/p7nRt++wpg+Mgt8ByjNKlwzLpOVbbHiZ8sbGxt/L7717ydPnlwWUzf9moHhdCyU5yWpEgWpIZ1Ti8VaETYEwK2oqHhp3bp1H8mS6/OVK1cm7bqq6Z3vHWi79xF/KDhCBebOM9MaZzUAVAmZtObLtrX5/PnzGyPurl/1toWyf09UGO4IoBCgKjTSmq+h5mkZ/CsqUrVw4cKdMmkd37NnTxMZMUsVFpoIUIXIBSsYDRWCpglNyGY+ZdWqZRVgb2Vlp/WLgwcPHpWd1gcxT1o20Eq9gBjDQS+g2r4CJE1cQzdIrzT1ZuqeIjutdTJpfXXs2LEFdiXRf1Rioc7GPvr2hluQC0bshGl5xDXNQS9g5Gk5LUOo52lIOWTatGmvbt68+VPZzv5x6dKlUb/1UpEIUBmaDlAvaIBQcPmOU8YNjzxEYQ6n7M/y+vr637S2th5paGjg9ZqoJBmgStO8cBOcguKq3flKwjzXXc59TM+pqqr62ZEjR36n6QjCiiT8Jz7OZqqwAIiYIPSY5usxhU1azzPztJxdofdHoJe+vE8tnMuVxPKDKFdXsoByzA1FgZqh1mFCU6jkaVzLuUPZDLRt27btX+78ENMvEgEqNO33LSV0hjQXpaBMMJrHcYXuFSfPRwY7Ojq+Wb58+fa2trZQf0bjavMFQz4xCwUQa0egKTiFSVoB6vF8IRel57kukC3qrRMnTny8ffv2y+5jEaRtoPYWI4LK/ap0/Fg+SOQjZmiWNSvXMmaefFHPrl69enLBggVfClSnPbNMBPEBhrzzCDSCBjyrZNnEAUCYlqXA3MfUUjVfy5FvHuM4IvdOv9u1a9e7c+fO/XOMMGm6jyEfO1BmJBEbKKFCUUtTYPTQL85xU2Q//0geUX+xYsWKFjM/xrgNdMy/HhtFhx0LNc9VeCZgjVPODVzLyyEmndb169cfOnfu3I9mnTHH+7FQ3sqNVcQq7VleGzXA5FikllGwlCWOEGfSOX78+Mc7duyIY9LR7uQLewGKhbKUiPOuvT3k6ZUbFJAQhWyGmp8J+69cucKk85eY/STNewkM+4e/6jH8FM+r5kJ55qRkAtTzyFMrJE/LKHx5tnR5586dm2TSiXMG1+7lC+2fM2KhCAnnYb2dE+1Hlg9VUApSARKaefJFPDp9+vQX8qgjqUnHj0oW0Ed+JcM+ZloodZsAtS2FKc+MOD54+/btf27YsOHThCcd7Z5XaDNUC2X8QziWh1wCyFloK0zTSskjjcozo3bZ6XySkknHCyR5sLO3tAqUzG7RWIDqLA8wRKESV5CSZ086S5YsScukQ/fyCexs0UmJBD+9y1rO2CUi+NAhb1YNVHmPyQYqD9ku7969e9O8efPSNOmY3TXjMHN+tmhaKDdJ+JFo5C/cdnV1ddIjrJGdkoKUx8HsdP60atWqf3C8RARmzg2m4UXfSM9jeSW8rq6u8vr163+TV8JfyQx3e9LZuHHjoQsXLvSMdKckYt9KL53tu/sBHXeeeJMk0rdJ5P2kQXkvqXXOnDnlEr8pTyUPrVmz5qvOzs7/lQTCkU4y1LtGkjIfmIlMnJ+K/MojfzIrl8B3kpU1osxJSYtTAL8wKf4EYJQFk+JeQMlvE3UcLRmTkkUANm1ZOZmE24dqGU5gOfCyZkyGWQT+IykW8zmSz0IpiLNN8t5iTmdTkgGTrInI7JcfULaH10Qnh/4IMVjAxNk6jxwajuUb8lqOZRT3S/lx06RY1g8C4akfiEJAOZdFKzsq/nNjIssdufjbhQAEAUodOGDWp4m8S0oHEhb+YexGkD4EBUpdVMrfl/E/RhNJnsjF/ls0r980YRQDlAqBylIqylcCzf4lHecB5veigSfmYoBycaxN2SHgT8e7pWKZwCzqzZpigUr9DlRuoIxXn8pIZJgHtkwpa8togHIiw587LeNx9mc2ZwIK5DOlXJaMFqhWwoMp/Ax+1W+ToOXTHGKNrDMLLo38LmKsQKmbdSrWil+N82UJaS40YTuJv/RdtAdpzet+aJDzvMpQV71oo2gYX5RXG2HnYZXtouzNRzXE3R0KE6jWjZU2iaZ9u8pqpU3UfvwrYSgSBVDtGDurBlHn/zj0QMIh7qlDNOfmcBj9ihKo9o+l1euiWGxSE5eun3na6jxQk3joEgdQ7TR+FWutE43lhQpph3sQvISAVRa9ppRzipY4gZqdw8/WigIWDWt1gD8EIsqSLlT/KPUVlKSAujs2XTLYeRHiIlA2DVi1qkRtK8PSULaEDF+Ue7ashwkTlf8DQc/cITdx9+UAAAAASUVORK5CYII=",U$a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAMAAAANIilAAAABcVBMVEUAAAAAAAD////////+/v45OTn////////39/fp6enPz8/7+/vw8PD+/v7x8fHc3NzHx8f////////+/v77+/vr6+v////7+/v5+fn////z8/P////////q6uqgoKD+/v79/f3m5ub+/v7////////////////39/f39/f////z8/P////t7e3s7Oz29vb////5+fn////h4eH////g4ODV1dX////////BwcH///////////+Ojo5zc3MlJSX////////////////////////7+/v////////////v7+/u7u7n5+f////39/f////09PT6+vr09PT+/v76+vr////5+fnv7+/09PTk5OT////////////////Jycn///++vr7///////+0tLT///9TU1P///8SEhL////////+/v76+vr////8/Pz39/ft7e3t7e36+vr////////X19fV1dX///+xsbF9fX1iYmL///////+K8mOEAAAAenRSTlMaAIDy8CD41cWRX9uk7Kl1VVEw6dWT/M/NvKyVkY475eWIgx0Z39rHv7axnZyZmIuKhn56emZjX1FEPTU0Kx4PCAX69fTgxcKkopWL7crJuri2sa6rnIyHhX54bVtZVU9NSUcsJSIcFROno6Hcwp+ekHVxbWhnRC8nDLc9s8oAAAOGSURBVEjHpdd3X9pAGAfwkBBDAoQmBJmWvUWWiIDIHoJb66x7a4d78Op7pBQ1J5DY33987vnyXEIu3CGy/0hvnDthM+l0hj3JScSudDKOdhNPpl1i8Ut624Gi6+trI3zW1tcdqGM7/SIC5/ZRR2SNJEm7JkHt7FAJjR18WIs40P3cAFxIOaIRna6ZOHxGunk+TDR1ukjUkSr0w86bcKShiz1OI4JMP8YAD9+4emM2Gm407IfIhzm0NxrhKNsLH4SvQ+RktyvUfZIMXYcPPsSFCcvY6EYW6ZPsxuiYZaLwAW5bDY70Da5paxjvm8d+UcjAUL/GzPtCnDF/mwFWhJ75Zs68x05gxxFRGQfa+RYXokHVCC4O4yOqYLTwBjNB+ncWEZnsbzrIvOLz4CW9g4jODn0ZPO/iZN0UmhaPp0Omq+Q/nLu6NO0hErJnurjKdTBzEdAhkqILXDAdbFkJ7EnDe4EVy198srpiwhE4X1RKDFOqviBwcNPK6gmPmeWlGDz+VdHqRPEVHo0tLTM8RpcX4G+flLe6kU/Cs1pYRnm8uriQhfoC+0ZDvbMLi6ttfO5fDCDCKFrvooAKAov+c4BZvy8EzaolCHRdIZ+fBThl9G0Ih1RCrBJWbPiMKYAZ409oMSqFWAktzJ9GBuDvRoVGOIQJMSas0CiM39u45v0M9tbaeLc6F5M+7dhcbRfgg+pcU/oNa85VDwDOzBtmpP9UKsN8BuCzeb1P+kPi08+fASyr6fVPUh/PJ72+xj/bZk5PSV0YlJ4z83iC4EipS5LkiAkeHxGcQerLwMARRzyW+QklhUgKpST8nXfYg+fHkjS89MPz0MFnhKdCSWpc8RBnPAZB3RUvLt7i3oob7f5juDzuikY81tjcHlcHg9xabdyUWDvF2ay3slecr1ptimNx9lhhs1bzXQxy5NZa6VMx9pS2Wt1H77cVjFartYvBdlDICDc0cbVa3Twd2NcOyuLwVqo+K1ebjgdcr0k+O1uXwThfl8vlhqm+99kASup5GINsYhhmG8d7UXzcBgo2e21cd9WlUll5/7G958ql8uxu7y0zS5SGSkOGBA51TRiGQAi232Y9v4kVQZGavpt6c6l3tLpNsc38gGOC01IeLg4Xi8NaLz1KkqO0VzvcTrFscYo4oLjiRAsKEXeJPRqxW0bsFWLGLVbiocyZSm5vbW0nU9BsIfyp/AGqAvfOkBaFawAAAABJRU5ErkJggg==";function n$m($e){return $e.toLowerCase().includes("panorama")}function o$q($e){return!n$m($e)}var R$c=Object.defineProperty,T$c=Object.getOwnPropertySymbols,L$e=Object.prototype.hasOwnProperty,m$j=Object.prototype.propertyIsEnumerable,H$m=($e,Se,Be)=>Se in $e?R$c($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,M$l=($e,Se)=>{for(var Be in Se||(Se={}))L$e.call(Se,Be)&&H$m($e,Be,Se[Be]);if(T$c)for(var Be of T$c(Se))m$j.call(Se,Be)&&H$m($e,Be,Se[Be]);return $e};const f$w=new Map,v$o=new Map;function D$h($e){t$c($e).forEach(Se=>{var Be,De,Ve;f$w.has(Se)||(Se instanceof HTMLElement?f$w.set(Se,{opacity:Se.style.opacity===""?void 0:Se.style.opacity,visible:{display:Se.style.display,visibility:Se.style.visibility}}):Se.isObject3D&&(Se.material?Se.material instanceof ShaderMaterial?f$w.set(Se,{opacity:(Be=Se.material.uniforms.opacity)==null?void 0:Be.value,transparent:Se.material.transparent,visible:Se.visible}):f$w.set(Se,{opacity:(De=Se.material)==null?void 0:De.opacity,transparent:(Ve=Se.material)==null?void 0:Ve.transparent,visible:Se.visible}):f$w.set(Se,{visible:Se.visible})))})}function o$p($e){t$c($e).forEach(Se=>{const Be=f$w.get(Se);Be&&(Se instanceof HTMLElement&&(Se.style.opacity=Be.opacity===void 0?"":Be.opacity,Se.style.display=Be.visible.display,Se.style.visibility=Be.visible.visibility),Se.isObject3D&&(Se.visible=Be.visible,Se.material&&(Se.material instanceof ShaderMaterial?(Se.material.uniforms.opacity&&(Se.material.uniforms.opacity.value=Be.opacity),Se.material.transparent=Be.transparent):(Se.material.opacity=Be.opacity,Se.material.transparent=Be.transparent))),f$w.delete(Se))})}function k$g($e,Se){var Be;const De=(Be=Se?.traverseTHREEObject)!=null?Be:!0;let Ve=t$c($e);const Fe=[];Ve.forEach(Ke=>{Ke&&(Ke instanceof HTMLElement?Fe.push(Ke):Ke.isObject3D&&(De?(Fe.push(Ke),Ke.traverse(Ye=>{Ye&&Fe.push(Ye)})):Fe.push(Ke)))}),Ve=[...new Set(Fe.filter(Boolean))],D$h(Ve);const Je=x$t(M$l({targets:Ve,duration:300,easing:"linear",direction:"alternate",loop:4,autoplay:!1,update:Ke=>{var Ye;Ke.animatables.forEach(or=>{var sr;const cr=or.target;if(!f$w.has(cr))return;const Br=Number((sr=f$w.get(cr).opacity)!=null?sr:1)*(100-Ke.progress)/100;cr instanceof HTMLElement?cr.style.opacity=String(Br):cr.material&&(cr.material instanceof ShaderMaterial?(cr.material.uniforms.opacity&&(cr.material.uniforms.opacity.value=Br),cr.material.transparent=!0):(cr.material.opacity=Br,cr.material.transparent=!0))}),(Ye=Se?.updateRender)==null||Ye.call(Se)}},Se));Je.preComplete=()=>{Je!=null&&Je.completed||(Je?.pause(),o$p(Ve),setTimeout(()=>{var Ke;return(Ke=Se?.updateRender)==null?void 0:Ke.call(Se)}))};const Xe=v$o.get($e);return Xe?.pause(),Xe?.seek(0),v$o.set($e,Je),Je.play(),Je.finished.then(()=>{var Ke;o$p(Ve),setTimeout(()=>{v$o.get($e)===Je&&v$o.delete($e)},1e3),(Ke=Se?.updateRender)==null||Ke.call(Se)}),Je}function q$i($e,Se){return k$g($e,M$l({update:Be=>{var De;Be.animatables.forEach(Ve=>{var Fe,Je;const Xe=Ve.target;if(!f$w.has(Xe))return;const Ke=f$w.get(Xe),Ye=Number((Je=(Fe=Ke?.opacity)!=null?Fe:Se?.maxOpacity)!=null?Je:1)*(Be.progress/100);Xe instanceof HTMLElement?(Xe.style.opacity=String(Ye),Xe.style.visibility="visible"):Xe.isObject3D&&(t$c($e).includes(Xe)&&(Xe.visible=!0),Xe.material&&(Xe.material instanceof ShaderMaterial?(Xe.material.uniforms.opacity&&(Xe.material.uniforms.opacity.value=Ye),Xe.material.transparent=!0):(Xe.material.opacity=Ye,Xe.material.transparent=!0)))}),(De=Se?.updateRender)==null||De.call(Se)}},Se))}function n$l($e){return $e.stickType==="Plane"}function i$j($e){return $e.stickType==="3DPoint"}function o$o($e){return $e.stickType==="Model"&&$e.contentType==="MediaModel"}function c$s($e){return $e.stickType==="Model"&&$e.contentType==="Model"}function T$b($e){return $e.stickType==="Plane"&&$e.contentType==="MediaPlane"}const i$i=($e,Se=16.666666666666668)=>{let Be=null;const De=$e;return(...Ve)=>{Be&&clearTimeout(Be),Be=setTimeout(()=>{De?.(...Ve),Be&&clearTimeout(Be),Be=null},Se)}};function i$h($e,Se=200){let Be;return function(...De){Be||($e.apply(this,De),Be=setTimeout(function(){Be=null},Se))}}function o$n($e){return $e.stickType?$e.stickType:$e.pointType==="PointTag"&&$e.dimensionType==="3D"?"3DPoint":$e.pointType==="PlaneTag"?"Plane":"2DPoint"}function p$s($e){var Se,Be,De,Ve;if($e.stickType||($e.stickType=o$n($e)),$e.contentType==="VRLink"||$e.contentType==="PanoLink"||$e.contentType==="Link"){const Fe=$e;!((Be=(Se=Fe.data)==null?void 0:Se.icon)!=null&&Be.url)&&!((Ve=(De=Fe.style)==null?void 0:De.point)!=null&&Ve.url)&&(Fe.data.icon={url:"//vr-static.realsee-cdn.cn/release/web/test.09dee741.png",steps:28})}return $e.extraData&&($e.data?$e.data.extraData=$e.extraData:$e.data={extraData:$e.extraData}),$e}var q$h=Object.defineProperty,c$r=($e,Se,Be)=>Se in $e?q$h($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$g=($e,Se,Be)=>(c$r($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const r$p="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAADAAAGhgBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr///////////////////////////////////////////8AAAA5TEFNRTMuOThyAc0AAAAAAAAAABSAJAiqQgAAgAAABobxtI73AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uQxAACFEII9ACZ/sJZwWEoEb8w/////N//////JcxjHjf+7/v/H2PzCCFAiDtGeyBCIx7bJJ1mmEEMy6g8mm2c8nrGABB4h2Mkmn//4z/73u773R5qHHu/j/w7Kxkzh5lWRWdsifCkNAnY9Zc1HvDAhjhSHdFkHFzLmabt/AQxSg2wwzLhHIJOBnAWwVY4zrhIYhhc2kvhYDfQ4hDi2Gmh5KyFn8EcGIrHAngNgIwVIEMf5bzbAiTRoAD///8z/KVhkkWEle6IX+d/z4fvH3BShK1e5kmjkCMoxVmXhd4ROlTKo3iipasvTilY21q19ta30/v/0/idPX1v8PNxJL6ramnOVsdvMv2akO0iSYIzdJFirtzWXCZicS9vHqvSKyqm5XJBdqBwPxyfJdykhWTZ0G0ZyTZGpLKxsNwwoRhsx3tZfhwmeOBVISm3impAC/IT/8hP/EKEM1KMdVdVKM2rHV4x7HVXZvbVVKN/qq8CiV9VL9jjH/6l6qf7MBCjZmOqsAibjcP+qqqv0oxqpa/NVW286hPo1nz2L/h8+jXt//uSxCmDU2IK/ECN98KKtE5IYzNoCfbw+u9i5r8PoadUMFPKqWL4LK3T/LCraMSHGkW4bpLXR/E6LlHOVQxmslKVJ8IULktMN06N0FKCpHCoYsjC4F+Z0NVqdNFoGSTjSiyjzLdnZ2fNqTi2eHKONONKLMPMKLONKLMPQRJGlFxZRoKcJFAYEeIFiRQkUWUeYfef//Ko04soswso40UJAgMw8wosososy0EalnZyjQUGBRQGIFggOWUacWUeYmuadrZziQKKEgQsQLAhQkUJAgMQDghltLO1onp0cpkNInSFMqlYeSEJ5AHsqFdOwy1DA2sRmRJKxdKRfLhfLw5BzUxBTUUzLjk4LjJVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjk4LjJVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7ksRRA8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",s$c={};var d$q=($e=>($e.Default="default",$e.GetAudioDuration="getAudioDuration",$e.PlayAudio="playAudio",$e))(d$q||{});function L$d($e,Se){const Be=Se?.namespace||"default",De=s$c[Be]||(s$c[Be]=[]);let Ve=De.find(Fe=>!Fe.realSrc||Fe.realSrc===r$p);return Ve||(console.warn("未找到缓存音频，已新建",s$c),Ve=new u$k(r$p),De.push(Ve)),$e&&(Ve.src=$e),Ve}function a$j($e,Se){const Be=Se?.namespace||"default",De=s$c[Be]||(s$c[Be]=[]),Ve=$e-De.length;if(!(Ve<=0))for(let Fe=0;Fe<Ve;Fe++)De.push(new u$k(r$p))}let u$k=class extends(typeof Audio>"u"?class{}:Audio){constructor(Se){super(Se),i$g(this,"preload","auto"),i$g(this,"crossOrigin","anonymous"),i$g(this,"realSrc",""),i$g(this,"inited",!1),i$g(this,"removeDocumentEventListener"),this.realSrc=Se??"",this.muted=!0,super.autoplay=!0,super.addEventListener("ended",()=>{this.src=""});const Be=()=>h$l(this);document.addEventListener("click",Be),document.addEventListener("touchend",Be),this.removeDocumentEventListener=()=>{document.removeEventListener("click",Be),document.removeEventListener("touchend",Be)}}get isBlankAudio(){return this.realSrc===r$p||!this.realSrc}get src(){return super.src}set src(Se){super.src=Se,this.realSrc=Se,this.removeDocumentEventListener()}get muted(){return super.muted}set muted(Se){super.muted=Se}clear(){this.currentTime=0,this.src=r$p}};function h$l($e){$e&&($e.inited||($e.src&&($e.inited=!0,$e.removeDocumentEventListener()),$e.src===r$p&&$e.play()))}const e$b={visibleConfig:{intersectRaycaster:{enabled:!0,distanceAccuracy:.01,checkPoints:"corner",needPassed:1}},clickable:!0,simulate3D:!1,renderType:"Dom"},e$a={globalConfig:{visibleConfig:{followModelVisibility:!0},unfoldedConfig:{autoUnfold:{enable:!0,strategy:"MinimumDistance",distance:{max:5}}},tag3DConfig:{ratio:.0035},popoverConfig:{enabled:!1,trigger:"hover",triggerDelay:500,placement:"auto",autoPlacementBaseSpace:{top:.2,right:.15,bottom:.2},transitionDuration:100,toolbar:{showMore:!0,showShare:!0},viewMoreText:"查看更多"}},contentTypeConfig:{"[Mapview]":{unfoldedConfig:{autoUnfold:{enable:!1,distance:{max:9999}}}},"[Floorplan]":{unfoldedConfig:{autoUnfold:{enable:!1,distance:{max:9999}}}},"Any-Audio-plane":{unfoldedConfig:{keep:"unfolded"}},Link:{unfoldedConfig:{keep:"unfolded"}},Panorama:{unfoldedConfig:{keep:"unfolded"}},VRLink:{unfoldedConfig:{keep:"unfolded"}},PanoLink:{unfoldedConfig:{keep:"unfolded"}},MediaPlane:{unfoldedConfig:{keep:"unfolded"},initialData:{autoplayConfig:{autoplayCarousel:!0,autoplayVideo:!1,autoplayVideoInCarousel:!1}}},"Model-Any":{unfoldedConfig:{keep:"unfolded"},visibleConfig:{visibleFiveMode:"all"}},Marketing:{popoverConfig:{enabled:!1}},Audio:{popoverConfig:{toolbar:{showMore:!1}}}}};function d$p($e,Se,Be){const De=new Plane().setFromNormalAndCoplanarPoint(Be,Se),Ve=Se.clone().sub($e).cross(new Vector3(0,1,0)).setLength(.01),Fe=new Vector3(0,.01,0);return[Se.clone().sub(Ve).sub(Fe),Se.clone().add(Ve).sub(Fe),Se.clone().add(Ve).add(Fe),Se.clone().sub(Ve).add(Fe)].map(Je=>De.projectPoint(Je,new Vector3))}const e$9=navigator.userAgent.toLowerCase().indexOf("iphone")!==-1;navigator.userAgent.toLowerCase().indexOf("android");const o$m=navigator.userAgent.toLowerCase().indexOf("micromessenger")!==-1,n$k=e$9&&o$m;function r$o($e){if($e.length!==4)return!1;const[Se,Be,De,Ve]=$e,Fe=Se.distanceTo(Be),Je=Be.distanceTo(De),Xe=De.distanceTo(Ve),Ke=Ve.distanceTo(Se),Ye=Se.distanceTo(De),or=Be.distanceTo(Ve);return Fe===Xe&&Je===Ke&&Ye===or}var b$i=Object.defineProperty,m$i=($e,Se,Be)=>Se in $e?b$i($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,x$m=($e,Se,Be)=>(m$i($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let M$k=class extends Mesh{constructor(Se,Be,De){if(Se.length!==4)throw new Error("QuadrangleMesh: Invalid number of points, it's not a quadrangle");const[Ve,Fe,Je,Xe]=Se,Ke=c$J(...Se),Ye=[Ve.clone().sub(Ke),Fe.clone().sub(Ke),Je.clone().sub(Ke),Xe.clone().sub(Ke)],or=new z$e(Ye,De);super(or,Be),x$m(this,"name","QuadrangleMesh"),this.position.copy(Ke)}removeFromParent(){const Se=this.parent;return Se!==null&&Se.remove(this),this}},z$e=class extends BufferGeometry{constructor(Se,Be){super(),x$m(this,"name","QuadrangleGeometry"),x$m(this,"points"),this.points=Se;const De=Be??(r$o(Se)?64:1);if(Se.length!==4){console.error("Invalid number of points, it's not a quadrangle");return}const[Ve,Fe,Je,Xe]=Se,[Ke,Ye,or,sr]=[new Vector2(0,0),new Vector2(1,0),new Vector2(1,1),new Vector2(0,1)],cr=[],Br=[];cr.push(...Ve.toArray()),Br.push(...Ke.toArray());for(let en=1;en<De;en++)cr.push(Ve.x+(Fe.x-Ve.x)*en/De,Ve.y+(Fe.y-Ve.y)*en/De,Ve.z+(Fe.z-Ve.z)*en/De),Br.push(Ke.x+(Ye.x-Ke.x)*en/De,Ke.y+(Ye.y-Ke.y)*en/De);cr.push(...Fe.toArray()),Br.push(...Ye.toArray()),cr.push(...Je.toArray()),Br.push(...or.toArray());for(let en=1;en<De;en++)cr.push(Je.x+(Xe.x-Je.x)*en/De,Je.y+(Xe.y-Je.y)*en/De,Je.z+(Xe.z-Je.z)*en/De),Br.push(or.x+(sr.x-or.x)*en/De,or.y+(sr.y-or.y)*en/De);cr.push(...Xe.toArray()),Br.push(...sr.toArray());const tn=[];for(let en=0;en<De;en++)tn.push(en,en+1,De*2-en,en,De*2-en,De*2+1-en);this.setAttribute("position",new BufferAttribute(new Float32Array(cr),3)),this.setAttribute("uv",new BufferAttribute(new Float32Array(Br),2)),this.setIndex(new BufferAttribute(new Uint32Array(tn),1))}};function s$b($e,Se){let Be=!o$m;const De=document.createElement("video");De.preload="metadata",De.crossOrigin="anonymous",De.muted=!0,De.loop=!0,De.playsInline=!0,De.autoplay=!0;const Ve=new VideoTexture(De);Ve.minFilter=LinearFilter,Ve.magFilter=LinearFilter,Ve.encoding=sRGBEncoding,Ve.metadataLoaded=!1,De.src=$e;const Fe=()=>{Ve.metadataLoaded||(Ve.dispatchEvent({type:"videoLoaded"}),Ve.metadataLoaded=!0)};if(o$m||(De.onloadedmetadata=()=>{Fe()}),o$m){const Je=()=>{if(!Be){if(!De.paused){Fe();return}De.muted=!0,De.play().then(()=>{Be=!0,De.pause(),De.currentTime=0,Fe()}).catch(()=>{console.warn("video auto play error")})}};document.addEventListener("click",Je,{once:!0}),document.addEventListener("touchend",Je,{once:!0})}return Ve}function H$l($e,Se,Be){if($e==="fill")return Se;if($e==="contain"){const[De,Ve,Fe,Je]=Se,Xe=De.distanceTo(Ve),Ke=Fe.distanceTo(Je),Ye=De.distanceTo(Je),or=Ve.distanceTo(Fe),sr=Xe,cr=Ye,Br=sr/cr;if(Br>Be){const tn=cr*Be,en=new Vector3().subVectors(Ve,De).multiplyScalar((Xe-tn)/2/Xe),an=new Vector3().subVectors(Fe,Je).multiplyScalar((Ke-tn)/2/Ke);return[De.clone().add(en),Ve.clone().sub(en),Fe.clone().sub(an),Je.clone().add(an)]}else if(Br<Be){const tn=sr/Be,en=new Vector3().subVectors(Je,De).multiplyScalar((Ye-tn)/2/Ye),an=new Vector3().subVectors(Fe,Ve).multiplyScalar((or-tn)/2/or);return[De.clone().add(en),Ve.clone().add(an),Fe.clone().sub(an),Je.clone().sub(en)]}else return Se}else return console.warn(`objectFit: ${$e} is not supported yet`),Se}var i$f=Object.defineProperty,o$l=($e,Se,Be)=>Se in $e?i$f($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$n=($e,Se,Be)=>(o$l($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let s$a=class extends ShaderMaterial{constructor(Se){super(),r$n(this,"transparent",!1),r$n(this,"blending",CustomBlending),r$n(this,"blendSrc",SrcAlphaFactor),r$n(this,"blendDst",OneMinusSrcAlphaFactor),r$n(this,"blendSrcAlpha",OneFactor),r$n(this,"blendDstAlpha",OneMinusSrcAlphaFactor),r$n(this,"vertexShader",`
    varying vec2 vUv;
    void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `),r$n(this,"fragmentShader",`
    uniform sampler2D map;
    // 纹理坐标
    varying vec2 vUv;
    void main() {
      gl_FragColor = texture2D(map, vUv);
    }
  `),this.uniforms={map:{value:Se}}}};const F$c={Z_FIGHTING_OFFSET:.01};var H$k=Object.defineProperty,S$h=($e,Se,Be)=>Se in $e?H$k($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$m=($e,Se,Be)=>(S$h($e,typeof Se!="symbol"?Se+"":Se,Be),Be),v$n=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});let C$c=class extends Mesh{constructor(){super(...arguments),r$m(this,"name","MediaPlane"),r$m(this,"src")}removeFromParent(){const Se=this.parent;return Se!==null&&Se.remove(this),this}dispose(){this.traverse(Se=>{if(Se.isMesh){const Be=Se;Be.geometry.dispose(),(Be.material instanceof Array?Be.material:[Be.material]).forEach(De=>{De.dispose()})}})}},z$d=class extends C$c{constructor(Se,Be,De){var Ve;super(),r$m(this,"name","PanoTagPluginImagePlane"),this.src=Se;const Fe=(Ve=De?.resolveZFighting)!=null?Ve:!0;let Je=Be;if(Fe){const Xe=l$n(Be).multiplyScalar(F$c.Z_FIGHTING_OFFSET);Je=Be.map(Ke=>Ke.clone().add(Xe))}u$t(Se).then(({texture:Xe,transparent:Ke})=>{var Ye;const or=new MeshBasicMaterial({map:Xe,transparent:Ke}),sr=H$l((Ye=De?.objectFit)!=null?Ye:"contain",Je,Xe.image.width/Xe.image.height),cr=c$J(...sr),Br=sr.map(en=>en.clone().sub(cr)),tn=new z$e(Br);this.position.copy(cr),this.geometry=tn,this.material=or}).catch(Xe=>{console.error(`Imageplane error: ${Xe?.message}`)})}},D$g=class extends C$c{constructor(Se,Be,De){const{videoCoverSrc:Ve,objectFit:Fe="contain",playButton:Je="withText",paused:Xe=!0,videoTextureMap:Ke,ImageTextureMap:Ye,domEvents:or}=De??{};super(),r$m(this,"isVideoPlane",!0),r$m(this,"name","PanoTagPluginImagePlane"),r$m(this,"videoInstance"),r$m(this,"onVideoReady"),r$m(this,"objectFit"),r$m(this,"buttonSrc"),r$m(this,"videoCoverSrc"),r$m(this,"domEvents"),r$m(this,"disposers",[]),r$m(this,"cornerPoints"),r$m(this,"videoMesh"),r$m(this,"coverMesh"),r$m(this,"buttonMesh"),r$m(this,"videoTextureMap"),r$m(this,"ImageTextureMap"),this.cornerPoints=Be,this.src=Se,this.buttonSrc=Je==="withText"?a$k:Je==="withoutText"?g$r:typeof Je=="string"?Je:g$r,this.videoCoverSrc=Ve,this.objectFit=Fe,this.videoTextureMap=Ke,this.ImageTextureMap=Ye,this.domEvents=or,this.position.copy(c$J(...Be)),this.videoCoverSrc&&Xe?this.addCoverMesh().then(()=>this.addButtonMesh()):this.addVideoMesh().then(()=>{Xe?this.addButtonMesh():this.play(!0)}),this.addEventListener("removed",()=>{this.remove(...this.children)}),this.addEventListener("dispose",()=>{var sr;(sr=this.disposers)==null||sr.forEach(cr=>cr?.())})}play(Se=!1){return v$n(this,null,function*(){this.videoMesh||(yield this.addVideoMesh()),this.showPlayUI(),this.videoInstance.paused&&this.videoInstance.play().then(()=>this.showPlayUI()).catch(Be=>{this.pause(),console.error("play error",Be)}),this.videoInstance.muted=Se,this.render()})}pause(){this.videoInstance&&(this.videoInstance.pause(),this.showPauseUI().then(()=>this.render()))}initialRenderHooks(Se){const Be=Se(()=>{var De;this.videoMesh&&((De=this.videoInstance)==null?void 0:De.paused)===!1&&(this.videoMesh.needsRender=!0)});this.disposers.push(()=>Be)}showPlayUI(){this.coverMesh&&(this.coverMesh.visible=!1),this.remove(this.buttonMesh),this.videoMesh.visible=!0}showPauseUI(){return v$n(this,null,function*(){this.coverMesh?(this.coverMesh.visible=!0,this.videoMesh&&(this.videoMesh.visible=!1)):(yield this.addCoverMesh(),this.coverMesh&&(this.videoMesh.visible=!1)),this.addButtonMesh().then(()=>this.render())})}render(){var Se;this.videoMesh&&(this.videoMesh.needsRender=!0),this.coverMesh&&(this.coverMesh.needsRender=!0),this.buttonMesh&&(this.buttonMesh.needsRender=!0),this.videoMesh&&((Se=this.videoInstance)==null?void 0:Se.paused)===!1&&(this.videoMesh.needsRender=!0)}addCoverMesh(){return v$n(this,null,function*(){if(this.children.includes(this.coverMesh))return;const Se=yield v$n(this,null,function*(){if(this.coverMesh)return this.coverMesh;if(!this.videoCoverSrc)return;const{texture:Be,transparent:De}=yield this.getImageTexture(this.videoCoverSrc),Ve=new MeshBasicMaterial({transparent:!1,map:Be}),Fe=H$l(this.objectFit,this.cornerPoints,Be.image.width/Be.image.height),Je=new M$k(Fe,Ve);return Je.position.copy(new Vector3(0,0,0)),Je.name="videoCoverMesh",Je});return Se&&(this.children.includes(this.coverMesh)||(this.add(Se),this.coverMesh=Se)),Se})}addVideoMesh(){return v$n(this,null,function*(){var Se;if(this.children.includes(this.videoMesh))return;const Be=yield v$n(this,null,function*(){if(this.videoMesh)return this.videoMesh;if(!this.src)return;const Ve=this.getVideoTexture(this.src),Fe=new MeshBasicMaterial({transparent:!1,map:Ve}),Je=yield new Promise(Ke=>{Ve.metadataLoaded?Ke(H$l(this.objectFit,this.cornerPoints,Ve.image.videoWidth/Ve.image.videoHeight)):Ve.addEventListener("videoLoaded",()=>Ke(H$l(this.objectFit,this.cornerPoints,Ve.image.videoWidth/Ve.image.videoHeight)))}),Xe=new M$k(Je,Fe);return Xe.name="videoMesh",Xe.position.copy(new Vector3(0,0,0)),Xe});if(!Be)return;this.domEvents.addAutoBindEventListener(Be,"click",()=>{!this.videoInstance.paused&&this.videoInstance.muted?this.videoInstance.muted=!1:this.pause()},{noEmitWhenHide:!0});const De=Be.material.map.image;return(Se=this.onVideoReady)==null||Se.call(this,De),De.addEventListener("playing",()=>{this.coverMesh||this.remove(this.buttonMesh),this.render()}),De.addEventListener("pause",()=>{this.videoInstance.paused&&(this.showPauseUI(),this.render())}),this.children.includes(this.videoMesh)||(this.add(Be),this.videoMesh=Be,this.videoInstance=De),Be})}addButtonMesh(){return v$n(this,null,function*(){if(this.children.includes(this.buttonMesh))return;const Se=yield v$n(this,null,function*(){var Be,De,Ve,Fe;if(this.buttonMesh)return this.buttonMesh;const Je=(De=(Be=this.videoMesh)==null?void 0:Be.geometry.points[0].distanceTo(this.videoMesh.geometry.points[3]))!=null?De:1/0,Xe=(Fe=(Ve=this.coverMesh)==null?void 0:Ve.geometry.points[0].distanceTo(this.coverMesh.geometry.points[3]))!=null?Fe:1/0,Ke=this.cornerPoints[0].distanceTo(this.cornerPoints[3]),Ye=Math.min(Je,Xe,Ke)/Ke*.3,{texture:or,transparent:sr}=yield this.getImageTexture(this.buttonSrc),cr=H$l("contain",this.cornerPoints,or.image.width/or.image.height),Br=new M$k(cr,new s$a(or));Br.position.copy(new Vector3(0,0,0)),Br.name="buttonMesh",Br.scale.set(Ye,Ye,Ye),this.domEvents.addAutoBindEventListener(Br,"click",()=>{this.play()},{noEmitWhenHide:!0});const tn=l$n(cr).multiplyScalar(F$c.Z_FIGHTING_OFFSET);return Br.position.add(tn),Br});return this.children.includes(this.buttonMesh)||(this.add(Se),this.buttonMesh=Se),Se})}getImageTexture(Se){return v$n(this,null,function*(){var Be,De;if((Be=this.ImageTextureMap)!=null&&Be.has(Se))return this.ImageTextureMap.get(Se);const Ve=yield u$t(Se);return(De=this.ImageTextureMap)==null||De.set(Se,Ve),Ve})}getVideoTexture(Se){var Be,De;if((Be=this.videoTextureMap)!=null&&Be.has(Se))return this.videoTextureMap.get(Se);const Ve=s$b(Se);return(De=this.videoTextureMap)==null||De.set(Se,Ve),Ve}};var h$k=Object.defineProperty,y$o=Object.getOwnPropertySymbols,b$h=Object.prototype.hasOwnProperty,g$q=Object.prototype.propertyIsEnumerable,c$q=($e,Se,Be)=>Se in $e?h$k($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,n$j=($e,Se)=>{for(var Be in Se||(Se={}))b$h.call(Se,Be)&&c$q($e,Be,Se[Be]);if(y$o)for(var Be of y$o(Se))g$q.call(Se,Be)&&c$q($e,Be,Se[Be]);return $e},o$k=($e,Se,Be)=>(c$q($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let l$k=class $d{constructor(){o$k(this,"cache_raycasterDistance",new Map),o$k(this,"cache_visible",new Map)}clear(){this.cache_visible.clear(),this.cache_raycasterDistance.clear()}static generateCameraTagKey(Se,Be,De=3){const Ve=n$j(n$j({},Be.five.getCurrentState()),Se),Fe=Ve.mode==="Panorama"?Be.workUtil.getObserverPosition(Ve.panoIndex):Be.five.camera.position;return Fe?[Fe.x.toFixed(De),Fe.y.toFixed(De),Fe.z.toFixed(De),Be.id].join(","):void 0}getVisible(Se,Be,De=1){const Ve=$d.generateCameraTagKey(Be,Se,De);if(Ve)return this.cache_visible.get(Ve)}setVisible(Se,Be,De,Ve=1){const Fe=$d.generateCameraTagKey(Be,Se,Ve);Fe&&this.cache_visible.set(Fe,De)}};function t$7($e){return Object.entries($e)}function f$v($e){var Se,Be;typeof $e.visibleConfig=="object"&&$e.visibleConfig.keep&&($e.visibleConfig.keep==="visible"?$e.visibleConfig={keep:$e.visibleConfig.keep,visibleFiveMode:(Se=$e.visibleConfig)==null?void 0:Se.visibleFiveMode}:$e.visibleConfig.keep==="hidden"&&($e.visibleConfig={keep:$e.visibleConfig.keep})),typeof $e.unfoldedConfig=="object"&&($e.unfoldedConfig.disableFold&&($e.unfoldedConfig={keep:"unfolded"}),$e.unfoldedConfig.disableUnfold&&($e.unfoldedConfig={keep:"folded"}),$e.unfoldedConfig.keep&&($e.unfoldedConfig={keep:$e.unfoldedConfig.keep}));const De=(Be=$e.initialState)!=null?Be:{};return typeof $e.unfoldedConfig=="object"&&($e.unfoldedConfig.keep==="unfolded"?De.unfolded=!0:$e.unfoldedConfig.keep==="folded"&&(De.unfolded=!1)),typeof $e.visibleConfig=="object"&&($e.visibleConfig.keep==="visible"?De.visible=!0:$e.visibleConfig.keep==="hidden"&&(De.visible=!1)),$e.initialState=De,$e}var $$7=Object.defineProperty,q$g=Object.defineProperties,z$c=Object.getOwnPropertyDescriptors,S$g=Object.getOwnPropertySymbols,G$a=Object.prototype.hasOwnProperty,X$5=Object.prototype.propertyIsEnumerable,D$f=($e,Se,Be)=>Se in $e?$$7($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,W$8=($e,Se)=>{for(var Be in Se||(Se={}))G$a.call(Se,Be)&&D$f($e,Be,Se[Be]);if(S$g)for(var Be of S$g(Se))X$5.call(Se,Be)&&D$f($e,Be,Se[Be]);return $e},Q$8=($e,Se)=>q$g($e,z$c(Se)),s$9=($e,Se,Be)=>(D$f($e,typeof Se!="symbol"?Se+"":Se,Be),Be);class zt extends F$i{constructor(Se){super(Se),s$9(this,"tags",[]),s$9(this,"cache",new l$k),s$9(this,"config",e$a),s$9(this,"renderQueue",new Map),s$9(this,"params"),s$9(this,"mediaStore",h$s({currentMediaElement:null})),s$9(this,"store",{disposers:[],disposed:!1,resizeObserverDisposerAdding:!1,css3DRenderDisposer:new Map}),s$9(this,"domEvents",new Q$a(this.five)),s$9(this,"_cache_pointTag"),s$9(this,"_cache_2DPointTag"),s$9(this,"_cache_css3DTag"),s$9(this,"_container",null),s$9(this,"timeoutIds",[]),s$9(this,"whyHide",Be=>{const De=this.getTagById(Be);return De?De.whyHide():{reason:`tag ${Be} not found`}}),s$9(this,"loadVideoFirstFrame",()=>{n$k&&this.hooks.emit("loadVideoFirstFrame")}),s$9(this,"tagsDo",(Be,De,Ve=!0)=>{let Fe=[...Be??this.tags].sort((Ye,or)=>Ye.getSquaredDistance()-or.getSquaredDistance());this.timeoutIds.forEach(Ye=>clearTimeout(Ye)),this.timeoutIds.length=0;for(let Ye=0;Ye<20;Ye++){const or=Fe[Ye];or&&(De(or),Ve&&(or._updating=!1))}Fe=Fe.slice(20);const Je=Fe.length>1e3,Xe=Je?30:17,Ke=Je?1:3;for(let Ye=0;Ye<Fe.length;Ye+=Ke){const or=[];for(let cr=0;cr<Ke;cr++)Fe[Ye+cr]&&or.push(Fe[Ye+cr]);or.forEach(cr=>{Ve&&(cr._updating=!0)});const sr=setTimeout(()=>{or.forEach(cr=>{De(cr),Ve&&(cr._updating=!1)})},Ye*Xe);this.timeoutIds.push(sr)}}),this.mediaStore.subscribe(({currentMediaElement:Be})=>{this.tags.forEach(De=>{var Ve;if(De.mediaPlane instanceof D$g&&Be!==De.mediaPlane.videoInstance){if(!((Ve=De.mediaPlane.videoInstance)!=null&&Ve.src)||Be===De.mediaPlane.videoInstance)return;De.mediaPlane.pause()}})})}get container(){var Se;return this._container||((Se=this.five.getElement())==null?void 0:Se.parentElement)}set container(Se){this._container=Se}set tagsLengthWillUpdate(Se){Se&&(this._cache_pointTag=this.tags.filter(Be=>Be.stickType==="2DPoint"||Be.stickType==="3DPoint").filter(Be=>Be.position),this._cache_2DPointTag=this.tags.filter(Be=>Be.stickType==="2DPoint").filter(Be=>Be.position),this._cache_css3DTag=this.tags.filter(Be=>Be.stickType==="3DPoint"||Be.stickType==="Plane"||Be.stickType==="Model"&&Be.contentType==="MediaModel").filter(Be=>{const De=Be.computeRenderType();return De==="BehindDom"||De==="Dom"}))}get filterPointTag(){var Se;return(Se=this._cache_pointTag)!=null?Se:[]}get filter2DPointTag(){var Se;return(Se=this._cache_2DPointTag)!=null?Se:[]}get filterCSS3DTag(){var Se;return(Se=this._cache_css3DTag)!=null?Se:[]}updateFive(Se){super.updateFive(Se),this.domEvents.dispose(),this.domEvents=new Q$a(Se)}addRenderQueue(Se){var Be,De;const{type:Ve,keys:Fe=[],tags:Je=[]}=Se;this.renderQueue.has(Ve)?this.renderQueue.set(Ve,{keys:Array.from(new Set([...(Be=this.renderQueue.get(Ve).keys)!=null?Be:[],...Fe])),tags:Array.from(new Set([...(De=this.renderQueue.get(Ve).tags)!=null?De:[],...Je]))}):this.renderQueue.set(Ve,{keys:Fe,tags:Je})}getTagById(Se){const Be=this.tags.find(De=>De.id===Se);if(!Be){console.warn(`getTagById Error: can't find tag id: ${Se}`);return}return Be}pauseCurrentMedia(){this.mediaStore.set({currentMediaElement:null})}getTagConfig(Se,Be){var De,Ve,Fe;const Je=this.calculateTagConfig(Se,{useCache:Be?.useCache}),Xe=(De=Be?.fiveMode)!=null?De:this.five.getCurrentState().mode,Ke=(Ve=Je.configWithFiveMode)==null?void 0:Ve[Xe];return(Fe=Ke??Je)!=null?Fe:{}}getPositions(Se){if(n$l(Se))return Se.position;if(o$o(Se))return Se.data.mediaPosition;if(i$j(Se))return d$p(this.five.camera.position,t$j(Se.position),t$j(Se.normal))}addObjectClickHandler(Se,Be,De){if(!Be||!this.domEvents)return()=>{};const Ve=()=>!(!Se.currentVisible||Se.loading),Fe=Je=>{if(!Ve())return!1;De(Je.origDomEvent)};return this.domEvents.addEventListener(Be,"click",Fe),()=>{var Je;(Je=this.domEvents)==null||Je.removeEventListener(Be,"click",Fe)}}checkDisposed(){return this.store.disposed?(console.error("PanoTagPluginController has been disposed"),!0):!1}calculateTagConfig(Se,Be){var De,Ve,Fe,Je,Xe;const Ke=(De=Be?.useCache)!=null?De:!0;if(!Se)return(Ve=this.config.globalConfig)!=null?Ve:{};if(Ke){if((Fe=Se?.computedConfig)!=null&&Fe._isMerged)return Se.computedConfig;if((Je=Se?.config)!=null&&Je._isMerged)return Se.config}const Ye={},or={},sr={};this.config.contentTypeConfig&&Object.entries(this.config.contentTypeConfig).forEach(([on,sn])=>{var ln,cn;const hn=on,mn=hn.split("-"),An=on.startsWith("["),xn=An?mn[0].slice(1,-1):void 0,pn=An?mn.slice(1):mn,dn=xn?["PanoramaLike","ModelLike"].includes(xn)?(ln=or[xn])!=null?ln:or[xn]={}:(cn=sr[xn])!=null?cn:sr[xn]={}:Ye;if(!dn[hn]){if(pn.length===0&&(dn[hn]=sn),pn.length===1){const[fn]=pn;(Se.contentType===fn||fn==="Any")&&(dn[hn]=sn)}if(pn.length===2){const[fn="Any",yn="Any"]=pn;fn==="Mixin"&&Se.contentType===yn&&(dn[hn]=sn),(Se.stickType===fn||fn==="Any")&&(Se.contentType===yn||yn==="Any")&&(dn[hn]=sn)}if(pn.length===3){const[fn="Any",yn,Sn]=pn;if(yn==="Audio"&&Se.contentType==="Audio"){const gn=Se;(gn.stickType===fn||fn==="Any")&&gn.data.appearance===Sn&&(dn[hn]=sn)}}}});const cr=(Xe=Se.initialConfig)!=null?Xe:{},Br=a$q({},e$b,this.config.globalConfig,...Object.values(Ye)),tn=a$q({},Br,cr),en={},an=Object.values(Five.Mode);t$7(or).forEach(([on,sn])=>{an.forEach(ln=>{(on==="PanoramaLike"&&n$m(ln)||on==="ModelLike"&&o$q(ln))&&(en[ln]=a$q({},Br,...Object.values(sn),cr,{_isMerged:!0}))})}),t$7(sr).forEach(([on,sn])=>{const ln=en[on];en[on]=a$q({},Br,ln,...Object.values(sn),cr,{_isMerged:!0})});const rn=Q$8(W$8({},tn),{configWithFiveMode:en});return f$v(rn),Object.values(en).forEach(on=>f$v(on)),rn._isMerged=!0,rn}}var n$i=Object.defineProperty,a$i=($e,Se,Be)=>Se in $e?n$i($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,o$j=($e,Se,Be)=>(a$i($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let Xt$1=class extends zt{constructor(Se){super(Se),o$j(this,"rendererMap",new Map),o$j(this,"contentTypeMap",new Map),o$j(this,"group",new Group$1),o$j(this,"imagePlaneGroup",new Group$1),o$j(this,"gltfObjectGroup",new Group$1),o$j(this,"enabledModelTagSet",new Set),o$j(this,"temporaryState",{visible:!0}),o$j(this,"TagContainerSvelte"),this.group.name="PanoTagPluginModelGroup",this.gltfObjectGroup.name="PanoTagPluginGLTFObjectGroup",this.imagePlaneGroup.name="ImagePlaneGroup",this.group.add(this.gltfObjectGroup),this.group.add(this.imagePlaneGroup)}registerRenderer(Se,Be,De){var Ve;this.rendererMap.set(Se,{renderer:Be,usePoint:(Ve=De?.usePoint)!=null?Ve:!1})}bindRenderer(Se,Be){this.contentTypeMap.set(Se,Be)}disposeAllCSS3DContainer(){for(const[,Se]of this.store.css3DRenderDisposer)Se?.forEach(Be=>Be?.());this.store.css3DRenderDisposer=new Map}clearUnusedPanelTag(){this.filter2DPointTag.forEach(Se=>{var Be;(Be=Se.tag3DContentSvelte)==null||Be.dispose(),Se.tag3DContentSvelte=void 0});for(const[Se,Be]of this.store.css3DRenderDisposer){const De=this.getTagById(Se);(!De||De.stickType==="2DPoint")&&(Be?.forEach(Ve=>Ve?.()),this.store.css3DRenderDisposer.delete(Se))}}};function M$j($e,Se){Se.forEach(Be=>{const De=new SphereGeometry(.02,16,16),Ve=[],Fe=[new MeshBasicMaterial({color:16776960}),new MeshBasicMaterial({color:16711935}),new MeshBasicMaterial({color:16711680}),new MeshBasicMaterial({color:65535})];if(Be.position.length===4)Be.position.forEach((Je,Xe)=>{const Ke=Fe[Xe],Ye=new Mesh(De,Ke);Ye.position.copy(a$D(Je)),Ve.push(Ye)});else{const Je=Fe[0],Xe=new Mesh(De,Je);Xe.position.copy(a$D(Be.position)),Ve.push(Xe)}Ve.forEach(Je=>{Je.material.depthTest=!1,$e.scene.add(Je)})})}var l$j=Object.defineProperty,c$p=($e,Se,Be)=>Se in $e?l$j($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,o$i=($e,Se,Be)=>(c$p($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let h$j=class{constructor(Se){o$i(this,"plugin"),o$i(this,"logBound",!1),o$i(this,"bindLogByObject",Be=>{Object.getOwnPropertyNames(Be).forEach(De=>{try{typeof Be[De]=="function"&&(Be[De]=new Proxy(Be[De],{apply:(Ve,Fe,Je)=>(["render"].includes(De)||this.log(De,{obj:Be},...Je),Ve.apply(Fe,Je))}))}catch{}})}),this.plugin=Se}get debug(){return this.plugin.debug}addDebugPoints(){try{M$j(this.plugin.five,this.plugin.tags)}catch(Se){console.error(Se)}}bindLog(){this.logBound||(this.logBound=!0,this.bindLogByObject(this.plugin),this.bindLogByObject(this.plugin.constructor.prototype))}log(Se,...Be){let De=new Error().stack;console.debug(`%cPanoTagPlugin%c${Se}`,"background-color: #35e0ed; color: black; padding:0 6px; border-radius: 3px","padding: 0 3px; color: #f3f47c",...Be,{stack:De})}closeIntersectRaycaster(){this.plugin.tags.forEach(Se=>{var Be;r$s((Be=Se?.initialConfig)==null?void 0:Be.visibleConfig).intersectRaycaster&&(Se.initialConfig.visibleConfig.intersectRaycaster.enabled=!1)}),this.plugin.changeGlobalConfig({visibleConfig:{intersectRaycaster:{enabled:!1}}})}};var z$b=Object.defineProperty,B$h=Object.defineProperties,H$j=Object.getOwnPropertyDescriptors,E$j=Object.getOwnPropertySymbols,J$d=Object.prototype.hasOwnProperty,K$d=Object.prototype.propertyIsEnumerable,x$l=($e,Se,Be)=>Se in $e?z$b($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,F$b=($e,Se)=>{for(var Be in Se||(Se={}))J$d.call(Se,Be)&&x$l($e,Be,Se[Be]);if(E$j)for(var Be of E$j(Se))K$d.call(Se,Be)&&x$l($e,Be,Se[Be]);return $e},_$a=($e,Se)=>B$h($e,H$j(Se));function ui($e,Se,Be){var De,Ve,Fe,Je,Xe;const Ke=(De=Be?.useCache)!=null?De:!0;if(!$e)return(Ve=Se.globalConfig)!=null?Ve:{};if(Ke){if((Fe=$e?.computedConfig)!=null&&Fe._isMerged)return $e.computedConfig;if((Je=$e?.config)!=null&&Je._isMerged)return $e.config}const Ye={},or={},sr={};Se.contentTypeConfig&&Object.entries(Se.contentTypeConfig).forEach(([on,sn])=>{var ln,cn;const hn=on,mn=hn.split("-"),An=on.startsWith("["),xn=An?mn[0].slice(1,-1):void 0,pn=An?mn.slice(1):mn,dn=xn?["PanoramaLike","ModelLike"].includes(xn)?(ln=or[xn])!=null?ln:or[xn]={}:(cn=sr[xn])!=null?cn:sr[xn]={}:Ye;if(!dn[hn]){if(pn.length===0&&(dn[hn]=sn),pn.length===1){const[fn]=pn;($e.contentType===fn||fn==="Any")&&(dn[hn]=sn)}if(pn.length===2){const[fn="Any",yn="Any"]=pn;fn==="Mixin"&&$e.contentType===yn&&(dn[hn]=sn),($e.stickType===fn||fn==="Any")&&($e.contentType===yn||yn==="Any")&&(dn[hn]=sn)}if(pn.length===3){const[fn="Any",yn,Sn]=pn;if(yn==="Audio"&&$e.contentType==="Audio"){const gn=$e;(gn.stickType===fn||fn==="Any")&&gn.data.appearance===Sn&&(dn[hn]=sn)}}}});const cr=(Xe=$e.initialConfig)!=null?Xe:{},Br=a$q({},e$b,Se.globalConfig,...Object.values(Ye)),tn=a$q({},Br,cr),en={},an=Object.values(Five.Mode);t$7(or).forEach(([on,sn])=>{an.forEach(ln=>{(on==="PanoramaLike"&&n$m(ln)||on==="ModelLike"&&o$q(ln))&&(en[ln]=a$q({},Br,...Object.values(sn),cr,{_isMerged:!0}))})}),t$7(sr).forEach(([on,sn])=>{const ln=en[on];en[on]=a$q({},Br,ln,...Object.values(sn),cr,{_isMerged:!0})});const rn=_$a(F$b({},tn),{configWithFiveMode:en});return f$v(rn),Object.values(en).forEach(on=>f$v(on)),rn._isMerged=!0,rn}const t$6=Math.PI*2;function o$h($e){return($e%t$6+t$6)%t$6}function n$h($e){return{longitude:o$h(-Math.atan2($e.x,-$e.z)),latitude:-Math.asin($e.y/1)}}var g$p=Object.defineProperty,b$g=Object.getOwnPropertySymbols,x$k=Object.prototype.hasOwnProperty,E$i=Object.prototype.propertyIsEnumerable,U$9=($e,Se,Be)=>Se in $e?g$p($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,y$n=($e,Se)=>{for(var Be in Se||(Se={}))x$k.call(Se,Be)&&U$9($e,Be,Se[Be]);if(b$g)for(var Be of b$g(Se))E$i.call(Se,Be)&&U$9($e,Be,Se[Be]);return $e},P$l=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});function j$g($e,Se,Be){return P$l(this,null,function*(){var De,Ve;if(!Se)return;const Fe=(De=Be?.distance)!=null?De:3,Je=new c$M($e),Xe=$e.camera.position.clone().sub(Se).setY(0).normalize(),Ke=$e.state.mode==="Mapview"?$e.state.fov:60,Ye=Fe,or=Ye*Math.cos(MathUtils.degToRad(Ke/2)),sr=Ye*Math.sin(MathUtils.degToRad(Ke/2));let cr=0;const Br=[],tn=rn=>{const on=MathUtils.degToRad(rn);return Xe.clone().applyAxisAngle(new Vector3(0,1,0),on).clone().multiplyScalar(or).add(new Vector3(0,sr,0)).add(Se)};for(;cr!==360;){let rn=0;const on=tn(cr);if((sn=>{const ln=sn.distanceTo(on),cn=new Raycaster(sn,on.clone().sub(sn).normalize()),hn=Je.model.intersectRaycaster(cn,void 0,!0)[0],mn=hn?.distance;i$w(mn)?mn>ln&&(rn+=1):rn+=1})(Se),Br[rn]=cr,rn===1)break;cr+=30}const en=tn((Ve=Br[1])!=null?Ve:0),an=n$h(Se.clone().sub(en).normalize());if($e.state.mode==="Mapview")return $e.updateCamera(y$n({offset:Se,distance:Fe},an),800);$e.setState(y$n({mode:"Mapview",offset:Se,distance:Fe},an)),yield $e.ready()})}function p$r($e){const Se=(()=>{if(o$o($e)&&$e.matrix){const Be=new Matrix4().fromArray($e.matrix);return $e.data.mediaPosition.map(De=>t$j(De).clone().applyMatrix4(Be))}else return $e.position})();return o$I(Se)}function x$j($e){const Se=p$r($e);return c$J(...Array.isArray(Se)?Se:[Se])}function i$e($e,Se){if($e===void 0)return;const{min:Be,max:De}=Se??{};if(!(Be===void 0&&De===void 0))return!(typeof De=="number"&&De<$e||typeof Be=="number"&&Be>$e)}function o$g($e){const Se=$e.split("?")[0].split(".").pop();return Se?Se.toLowerCase():""}function d$o($e,Se){if(!$e)return 0;const Be=$e.observers;if(!Se||!Be)return console.error("getFloorIndex: invalid arguments: ",{point:Se,observer:Be}),0;const De=[];Be.forEach(Fe=>{var Je,Xe,Ke;const Ye=(Xe=(Je=Fe.floorIndex)!=null?Je:Fe.floor_index)!=null?Xe:0;De[Ye]||(De[Ye]=[]),De[Ye].push(c$O(Fe.position,(Ke=$e.options)==null?void 0:Ke.transform).y)});const Ve=De.map(Fe=>Fe.reduce((Je,Xe)=>Je+Xe,0)/Fe.length);for(let Fe=Ve.length-1;Fe>0;Fe--)if(Se.y>=Ve[Fe])return Fe;return 0}function i$d(){let $e,Se;return{promise:new Promise((Be,De)=>{$e=Be,Se=De}),resolve:$e,reject:Se}}var G$9=Object.defineProperty,K$c=Object.defineProperties,Q$7=Object.getOwnPropertyDescriptors,P$k=Object.getOwnPropertySymbols,j$f=Object.prototype.hasOwnProperty,A$j=Object.prototype.propertyIsEnumerable,k$f=Math.pow,w$i=($e,Se,Be)=>Se in $e?G$9($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,g$o=($e,Se)=>{for(var Be in Se||(Se={}))j$f.call(Se,Be)&&w$i($e,Be,Se[Be]);if(P$k)for(var Be of P$k(Se))A$j.call(Se,Be)&&w$i($e,Be,Se[Be]);return $e},U$8=($e,Se)=>K$c($e,Q$7(Se)),E$h=($e,Se)=>{var Be={};for(var De in $e)j$f.call($e,De)&&Se.indexOf(De)<0&&(Be[De]=$e[De]);if($e!=null&&P$k)for(var De of P$k($e))Se.indexOf(De)<0&&A$j.call($e,De)&&(Be[De]=$e[De]);return Be},a$h=($e,Se,Be)=>(w$i($e,typeof Se!="symbol"?Se+"":Se,Be),Be),C$b=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class Ji{constructor(Se,Be){a$h(this,"plugin"),a$h(this,"id"),a$h(this,"contentType"),a$h(this,"stickType"),a$h(this,"enabled"),a$h(this,"config"),a$h(this,"data"),a$h(this,"state"),a$h(this,"temporaryState",{visible:!0}),a$h(this,"originPosition"),a$h(this,"position"),a$h(this,"fiveState"),a$h(this,"model"),a$h(this,"matrix"),a$h(this,"screenPosition"),a$h(this,"normal"),a$h(this,"mediaPlane"),a$h(this,"hooks"),a$h(this,"zIndex"),a$h(this,"play"),a$h(this,"pause"),a$h(this,"tag3DContentSvelte"),a$h(this,"dom"),a$h(this,"contentDom"),a$h(this,"initialConfig"),a$h(this,"computedConfig"),a$h(this,"cache"),a$h(this,"entryFromModel"),a$h(this,"_updating",!1),a$h(this,"hoverEnabled"),a$h(this,"ready",()=>{const{promise:en,resolve:an}=i$d();if(!this._updating)an();else{const rn=setInterval(()=>{this._updating||(clearInterval(rn),an())},17);setTimeout(()=>{clearInterval(rn),an()},300)}return en});var De,Ve,Fe,Je,Xe,Ke;this.plugin=Se;const Ye=o$n(Be);Be.stickType=Ye;const or=JSON.parse(JSON.stringify(Be.data)),sr=(De=Be.initialConfig)!=null?De:Be.config?JSON.parse(JSON.stringify(Be.config)):{};Be.initialConfig=sr;const cr=ui(Be,Se.config),Br=this.getConfig(Be);Be.config=Br,this.id=(Ve=Be.id)!=null?Ve:r$F(),this.enabled=(Fe=Be.enabled)!=null?Fe:!0,this.contentType=Be.contentType,this.hoverEnabled=(Xe=(Je=Br.popoverConfig)==null?void 0:Je.enabled)!=null?Xe:!0,this.data=(Ke=Br.initialData)!=null&&Ke.important?a$q(Be.data,or,Br.initialData):a$q(Be.data,Br.initialData,or);let tn;typeof Br.unfoldedConfig=="object"?Br.unfoldedConfig.keep==="unfolded"?tn=!0:Br.unfoldedConfig.keep==="folded"?tn=!1:tn=!this.can("fold"):tn=!this.can("fold"),this.state=g$o({visible:void 0,unfolded:tn},Br.initialState),this.isPopoverConfigEnabled()&&(this.state.unfolded=!1),this.originPosition=Be.position,Be.originPosition=this.originPosition,this.position=(()=>{const en=Be.originPosition;if(!en)return;const an=Se.workUtil.transform;return Array.isArray(en)&&en.length===4?en.map(t$j).map(rn=>c$O(rn,an).toArray()):c$O(t$j(en),an).toArray()})(),this.matrix=Be.matrix?(()=>{const en=new Matrix4().fromArray(Be.matrix);return en.premultiply(Se.workUtil.transform),en.elements})():Be.matrix,this.initialConfig=sr,this.computedConfig=cr,this.stickType=Ye,this.config=Be.config,this.fiveState=Be.fiveState,this.normal=Be.normal,this.cache=new l$k,this.hooks=new E$v,Object.keys(Be).forEach(en=>{this[en]===void 0&&Be[en]!==void 0&&(this[en]=Be[en])})}get visible(){var Se;return((Se=this.temporaryState)==null?void 0:Se.visible)!==!1&&this.state.visible!==!1&&this.enabled!==!1}get five(){return this.plugin.five}get fiveUtil(){return this.plugin.fiveUtil}get workUtil(){return this.plugin.workUtil}get centerPosition(){const Se=p$r(this);return c$J(...Array.isArray(Se)?Se:[Se])}get currentConfig(){var Se,Be;const De=ui(this,this.plugin.config,{useCache:!0}),Ve=this.five.getCurrentState().mode,Fe=(Se=De.configWithFiveMode)==null?void 0:Se[Ve];return(Be=Fe??De)!=null?Be:{}}get currentVisible(){return!(!this.plugin.state.enabled||!this.plugin.state.visible||!this.enabled||!this.state.visible)}get sharedCache(){return this.plugin.cache}applyVisible(){throw new Error("Method not implemented.")}find(Se){return C$b(this,null,function*(){var Be;const De=this.fiveState;if(!this.fiveState)return this;const Ve=(Be=Se?.targetMode)!=null?Be:this.five.state.mode;if(Ve==="Panorama"){const Fe=De?.panoIndex;if(t$e(Fe))return this;const Je=this.workUtil.getObserverPosition(Fe),Xe=this.centerPosition.clone().sub(Je).normalize();this.five.setState(g$o({mode:"Panorama",workCode:this.workUtil.workCode,panoIndex:Fe},n$h(Xe))),yield this.five.ready()}else Ve==="Mapview"&&(yield j$g(this.five,this.centerPosition,Se?.pointConfig));return this})}blink(Se){return C$b(this,null,function*(){var Be,De,Ve,Fe;yield this.ready();const Je=(Be=this.enabled)!=null?Be:!0,Xe=(De=this.state)==null?void 0:De.visible,Ke=Je&&Xe;Ke===!1&&(this.state.visible=!0,this.enabled=!0,this.applyVisible(),this.plugin.render(),this.computeRenderType()!=="Mesh"?yield new Promise(or=>C$b(this,null,function*(){if(this.dom||this.contentDom){or();return}const sr=setInterval(()=>{(this.dom||this.contentDom)&&(or(),clearInterval(sr))},16.7)})):this.stickType==="Model"&&!((Ve=this.model)!=null&&Ve.object)?yield(Fe=this.model)==null?void 0:Fe.promise:this.stickType==="Plane"&&(yield new Promise(or=>C$b(this,null,function*(){if(this.mediaPlane){or();return}const sr=setInterval(()=>{this.mediaPlane&&(or(),clearInterval(sr))},16.7)}))),this.dom&&(this.dom.style.visibility="hidden"),this.contentDom&&(this.contentDom.style.visibility="hidden"));const Ye=(()=>{var or,sr,cr;const Br=[];return Br.push(this.dom),Br.push((sr=(or=this.tag3DContentSvelte)==null?void 0:or.css3DInstance)==null?void 0:sr.container),Br.push((cr=this.model)==null?void 0:cr.object),Br.push(this.mediaPlane),Br.filter(Boolean)})();if(!Ye.length){console.warn("tagDom is empty");return}yield(Ke?k$g:q$i)(Ye,g$o({begin:()=>{Ke===!1&&(this.dom&&(this.dom.style.visibility=""),this.contentDom&&(this.contentDom.style.visibility=""))},updateRender:()=>{this.five.needsRender=!0}},Se)).finished,Je===!1&&(this.enabled=!1,this.updateVisible()),Xe===!1&&this.updateVisible(),Ke===!1&&(this.dom&&(this.dom.style.visibility=""),this.contentDom&&(this.contentDom.style.visibility=""))})}unfold(){}unfoldAndFoldOthers(){}fold(){}enable(){this.enabled=!0,this.hooks.emit("enable"),this.applyVisible()}disable(){this.enabled=!1,this.hooks.emit("disable"),this.applyVisible()}changeData(Se,Be=!0){return this.setData(Se,Be)}changePosition(Se){return this.setPosition(Se)}setData(Se,Be=!0){Be?this.data=a$q(this.data,Se):this.data=g$o(g$o({},this.data),Se),this.hooks.emit("dataChanged",this.data)}setPosition(Se){throw new Error("Method not implemented.")}set(Se,Be=!0){this.plugin.tagsLengthWillUpdate=!0,Be?a$q(this,Se):Object.assign(this,Se),this.cache.clear()}updateConfig(){var Se;const Be=this.getConfig(void 0,{useCache:!1});this.computedConfig=Be;const De=this.getConfig();if(this.config=De,this.config.initialData){const Ve=JSON.parse(JSON.stringify(this.data));this.data=(Se=De.initialData)!=null&&Se.important?a$q(this.data,Ve,De.initialData):a$q(this.data,De.initialData,Ve)}this.cache.clear()}updateVisible(){this.enabled?(this.state.visible=this.getVisible(),this.applyVisible()):this.applyVisible(),this._updating=!1}updateZIndex(){const Se=this.getSquaredDistance();this.zIndex=Math.round((1e4-(Se??0))*100)}getConfig(Se,Be){var De,Ve,Fe;const Je=ui(Se??this,this.plugin.config,{useCache:Be?.useCache}),Xe=(De=Be?.fiveMode)!=null?De:this.five.getCurrentState().mode,Ke=(Ve=Je.configWithFiveMode)==null?void 0:Ve[Xe];return(Fe=Ke??Je)!=null?Fe:{}}getDistance(Se,Be=3){const De=g$o(g$o({},this.five.getCurrentState()),Se),{panoIndex:Ve,mode:Fe}=De,Je=Fe==="Panorama"?this.workUtil.getObserverPosition(Ve):this.five.camera.position,Xe=this.centerPosition;return!Je||!Xe?-1:Je.distanceTo(Xe)}getSquaredDistance(){const Se=this.five.camera.position;let Be;return Array.isArray(this.position[0])?Be=this.position[0]:Be=this.position,k$f(Be[0]-Se.x,2)+k$f(Be[1]-Se.y,2)+k$f(Be[2]-Se.z,2)}getVisible(Se){if(!this.enabled||!this.plugin.state.enabled||!this.fiveUtil.model)return!1;const Be=g$o(g$o({},this.five.getCurrentState()),Se);let De=this.cache.getVisible(this,Be);return t$e(De)&&(De=this.computeVisible(Be).value,this.cache.setVisible(this,Be,De)),De}getUnfoldedByPanoIndex(Se){return this.currentVisible?this.computeUnfoldedByPanoIndex(Se)&&this.getUnfoldedByCamera():void 0}getUnfoldedByCamera(){return this.currentVisible?this.computeUnfoldedByCamera():void 0}can(Se){var Be,De;if((Se==="fold"||Se==="unfold")&&((De=(Be=this.currentConfig)==null?void 0:Be.popoverConfig)==null?void 0:De.enabled)===!0)return!1;const Ve=this.currentConfig;if(!Ve||typeof Ve!="object")return!0;if(Se==="show"||Se==="hide"){if(!Ve.visibleConfig||typeof Ve.visibleConfig!="object")return!0;if(Se==="show"&&Ve.visibleConfig.keep==="hidden"||Se==="hide"&&Ve.visibleConfig.keep==="visible")return!1}if(Se==="fold"||Se==="unfold"){if(!Ve.unfoldedConfig||typeof Ve.unfoldedConfig!="object")return!0;if(Se==="fold"&&Ve.unfoldedConfig.keep==="unfolded"||Se==="unfold"&&Ve.unfoldedConfig.keep==="folded")return!1}return!0}onClick(Se){}computeRenderType(){const Se=(()=>{if(this.stickType==="3DPoint")return"Dom";const Be=this.getConfig();if(!Be||typeof Be!="object"||!Be.renderType)return;const De=this.data.mediaData;if(!(!De||De.length===0)&&Be.renderType==="Mesh"){if(T$b(this)){if(De.length===1){if(De[0].type==="Video")return navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1?"Dom":"Mesh";if(De[0].type==="Image")return o$g(De[0].url)==="gif"?"Dom":"Mesh"}}else if(o$o(this))return De.length===1&&De[0].type==="Image"?o$g(De[0].url)==="gif"?"Dom":"Mesh":"BehindDom"}})();return Se??"Dom"}computeVisible(Se){const Be=g$o(g$o({},this.five.getCurrentState()),Se),{panoIndex:De,mode:Ve}=Be,Fe=[];return(()=>{var Je,Xe,Ke,Ye;const or=(Je=this.getConfig().visibleConfig)!=null?Je:{};if(typeof or=="function")return{value:or(this.five,{tag:this,distance:this.getDistance(Be,void 0)}),checkedList:Fe,reason:"config function result"};{if(or.keep==="hidden")return{value:!1,checkedList:Fe,reason:"config.keep is hidden"};if(or.keep==="visible")return{value:!0,checkedList:Fe,reason:"config.keep is visible"};const sr=this.computeVisibleByFiveMode(or,Ve);if(sr?.value===!1)return sr;if(or.followModelVisibility===!0&&["poincare","aerophoto","sand"].includes(this.workUtil.fromType)&&(Ve==="Floorplan"||Ve==="Mapview")){const cr=this.computeVisibleByFloorIndex(),{value:Br}=cr,tn=E$h(cr,["value"]);if(Br===!1)return g$o({value:!1,checkedList:Fe,reason:"followModelVisibility check failed"},tn)}if(n$m(Ve)&&or.visiblePanoIndex!==void 0&&or.visiblePanoIndex!=="all"&&De!==void 0){if(Fe.push("visiblePanoIndex"),Array.isArray(or.visiblePanoIndex)&&!or.visiblePanoIndex.includes(De))return{value:!1,checkedList:Fe,reason:`current panoIndex is not included in visiblePano. currentPanoIndex: ${De}, visiblePanoIndex: ${or.visiblePanoIndex}`};if(or.visiblePanoIndex==="current"&&De!==((Xe=this.fiveState)==null?void 0:Xe.panoIndex))return{value:!1,checkedList:Fe,reason:`current panoIndex is not equal to tag.panoIndex. currentPanoIndex: ${De}, tag.panoIndex: ${(Ke=this.fiveState)==null?void 0:Ke.panoIndex}`}}if(or.visibleDistance!==void 0&&(Fe.push("visibleDistance"),or.visibleDistance!=="unLimited")){const cr=this.getDistance(Be,1);if(i$e(cr,or.visibleDistance)===!1)return{value:!1,checkedList:Fe,panoIndex:De,visibleDistance:or.visibleDistance,reason:`distance is not in visibleDistance. distance: ${cr}, visibleDistance: ${or.visibleDistance.min} - ${or.visibleDistance.max}`}}if(or.intersectRaycaster!==!1&&(typeof or.intersectRaycaster!="object"||or.intersectRaycaster.enabled!==!1)){if(Fe.push("intersectRaycaster"),De===void 0)return{value:!1,checkedList:Fe,reason:`intersectRaycaster check failed: panoIndex is ${De}`};if(De===((Ye=this.fiveState)==null?void 0:Ye.panoIndex))Fe.push("intersectCheckSkiped");else{const cr=this.computeVisibleByIntersect(De);if(cr.value===!1)return Object.assign(cr,{checkedList:Fe})}}return{value:!0,checkedList:Fe,reason:"all check passed"}}})()}computeVisibleByFiveMode(Se,Be){const De=()=>{var Ve,Fe;let Je=typeof Se.visibleFiveMode=="function"?Se.visibleFiveMode(this):Se.visibleFiveMode;if(Je||(Je=(Fe=(Ve=this.fiveState)==null?void 0:Ve.mode)!=null?Fe:this.workUtil.observers.length?"Panorama":"ModelLike"),Array.isArray(Je))return Je.includes(Be);if(Je==="ModelLike")return o$q(Be);if(Je==="PanoramaLike")return!n$m(Be);if(Je==="all")return!0;if(typeof Je=="string")return Je===Be};if((()=>{var Ve;const Fe=De();if(i$w((Ve=this.fiveState)==null?void 0:Ve.panoIndex)&&Se.entryFromModel){if(o$q(Be)&&Fe?this.entryFromModel=!1:this.entryFromModel=!0,o$q(Be))return!0}else this.entryFromModel=!1;return Fe})()===!1)return{value:!1,reason:"current mode is not included in visibleFiveMode",visibleFiveMode:Se.visibleFiveMode,mode:Be}}computeVisibleByIntersect(Se){var Be,De,Ve,Fe;const Je=r$s(r$s((Be=this.getConfig().visibleConfig)!=null?Be:{}).intersectRaycaster),Xe=Se??this.five.getCurrentState().panoIndex,Ke=n$m(this.five.getCurrentState().mode)?this.workUtil.getObserverPosition(Xe):this.five.camera.position;if(Ke===void 0)return{value:!1,reason:{type:"startPosition is undefined",fivePanoIndex:Xe}};const Ye=t$c((()=>{var cr;const Br=(cr=Je.checkPoints)!=null?cr:"center";return Br==="center"?x$j(this):Br==="corner"?p$r(this):Array.isArray(Br)?Br:[]})());let or=0,sr=0;for(const cr of Ye){const Br=new Vector3().subVectors(cr,Ke).normalize();let tn;t$g.set(Ke,Br);const[en]=this.fiveUtil.model.intersectRaycaster(t$g);tn=en?.distance;const an=(()=>{if(!o$o(this))return;const ln=this.plugin.tags.filter(o$o).map(hn=>{var mn;return(mn=hn.model)==null?void 0:mn.object}).filter(i$w),[cn]=t$g.intersectObjects(ln,!0);return cn})(),rn=Ke.distanceTo(cr),on=(De=Je.distanceAccuracy)!=null?De:.01;tn=Math.min(tn??1/0,(Ve=an?.distance)!=null?Ve:1/0),tn+on>=rn?or++:sr++;const sn=(Fe=Je.needPassed)!=null?Fe:1;if(or>=sn)return{value:!0}}return sr===0?{value:!0}:{value:!1,reason:{type:"intersectRaycaster check failed",passedCount:or,needPassed:Je.needPassed,model:this.fiveUtil.model.name}}}computeVisibleByFloorIndex(){var Se,Be,De,Ve,Fe,Je,Xe;let Ke=0;const Ye=(Se=this.fiveState)==null?void 0:Se.panoIndex;Ye!==void 0?Ke=(Be=this.workUtil.getObserver(Ye))==null?void 0:Be.floorIndex:Ke=d$o(this.workUtil.work,(Xe=(Je=(Ve=(De=this.model)==null?void 0:De.object)==null?void 0:Ve.position)!=null?Je:(Fe=this.mediaPlane)==null?void 0:Fe.position)!=null?Xe:x$j(this));const or=this.fiveUtil.model.shownFloor;return{value:or===null||or===Ke,currentFiveFloorIndex:or,tagFloorIndex:Ke}}computeUnfoldedByPanoIndex(Se){const Be=this.getConfig().unfoldedConfig;if(Be){if(typeof Be=="function")return Be(this.five,{tag:this,distance:this.getDistance({panoIndex:Se})});if(Be.keep==="folded")return!1;if(Be.keep==="unfolded")return!0;if(Be.unfoldDistance&&i$e(this.getDistance({panoIndex:Se}),Be.unfoldDistance)===!1)return!1}}computeUnfoldedByCamera(){var Se;if(this.entryFromModel&&o$q(this.five.state.mode))return!1;const Be=this.getConfig().unfoldedConfig;if(Be){if(typeof Be=="function")return Be(this.five,{tag:this,distance:this.getDistance()});if(Be.keep==="folded")return!1;if(Be.keep==="unfolded")return!0;if(Be.autoUnfold===void 0||Be.autoUnfold===!1||Be.autoUnfold.enable===!1||!Be.autoUnfold.strategy)return;if(Be.autoUnfold.strategy==="ScreenPostion"){const De=this.computeTagProject();if(De&&i$e(De.x,Be.autoUnfold.autoUnfoldProjectX)===!1)return!1}if(Be.autoUnfold.strategy==="MinimumDistance"){const De=this.plugin.filterPointTag.filter(Ve=>Ve.currentVisible).filter(Ve=>{const Fe=this.computeTagProject();if(!Fe)return!1;const{x:Je,y:Xe,z:Ke}=Fe;return!(Math.abs(Ke)>1||Math.abs(Je)>1||Math.abs(Xe)>1)}).map(Ve=>({tag:Ve,id:Ve.id,tagConfig:Ve.getConfig().unfoldedConfig})).filter(({tagConfig:Ve})=>{var Fe,Je;return!(typeof Ve=="function"||Ve.keep||Ve.autoUnfold===!1||((Fe=Ve.autoUnfold)==null?void 0:Fe.enable)===!1||((Je=Ve.autoUnfold)==null?void 0:Je.strategy)!=="MinimumDistance")}).map(Ve=>U$8(g$o({},Ve),{distance:Ve.tag.getDistance()})).filter(({distance:Ve,tagConfig:Fe})=>{const Je=Fe.autoUnfold.distance;return!(Je&&i$e(Ve,Je)===!1)}).sort((Ve,Fe)=>Ve.distance-Fe.distance).findIndex(Ve=>Ve.id===this.id);if(De===-1||!(De<=((Se=Be.autoUnfold.maxNumber)!=null?Se:1)-1))return!1}return Be.autoUnfold.strategy!=="FoldWhenMove"}}computeTagProject(){const Se=this.centerPosition;if(!Se)return;const{x:Be,y:De,z:Ve}=Se.project(this.five.camera);if(!(Ve>1))return{x:Be,y:De,z:Ve}}addObjectClickHandler(Se,Be,De){if(!Be||!this.plugin.domEvents)return()=>{};const Ve=()=>!(!Se.currentVisible||Se.loading),Fe=Je=>{if(!Ve())return!1;De(Je.origDomEvent)};return this.plugin.domEvents.addEventListener(Be,"click",Fe),()=>{var Je;(Je=this.plugin.domEvents)==null||Je.removeEventListener(Be,"click",Fe)}}whyHide(){var Se;if(!this.plugin.state.enabled)return{reason:`plugin.state.enabled is ${this.plugin.state.enabled}`};if(!this.plugin.state.visible)return{reason:`plugin.state.visible is ${this.plugin.state.visible}`};if(!this.enabled)return{reason:`tag ${this.id} enabled is: ${this.enabled}`};const Be=U$8(g$o({},this.computeVisible()),{tagInstance:this});return Be.value!==this.state.visible?{reason:"插件故障，请联系维护人员, err: 0",info:Be}:this.state.visible?{reason:"应该是能看见才对",info:Be}:Be.value===!0?{reason:"插件故障，请联系维护人员, err: 1",info:Be}:{reason:(Se=Be.reason.type)!=null?Se:Be.reason,info:Be}}destroy(){var Se,Be;const De=this.plugin.tags.findIndex(Ve=>Ve.id===this.id);if(De===-1){console.warn(`Destroy failed: tag ${this.id} not found`);return}this.disable(),(Be=(Se=this.tag3DContentSvelte)==null?void 0:Se.dispose)==null||Be.call(Se),this.hooks.off(),this.cache.clear(),this.plugin.tags.splice(De,1),this.plugin.tagsLengthWillUpdate=!0,this.plugin.hooks.emit("tagsLengthChange")}isPopoverConfigEnabled(){var Se,Be;return((Be=(Se=this.currentConfig)==null?void 0:Se.popoverConfig)==null?void 0:Be.enabled)===!0}isHoverEnabled(){var Se;return!(((Se=this.plugin)==null?void 0:Se.globalHoverEnabled)===!1||this.hoverEnabled===!1)}}var h$i=Object.defineProperty,c$o=($e,Se,Be)=>Se in $e?h$i($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,p$q=($e,Se,Be)=>(c$o($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const v$m=new Vector2;let Jt$1=class extends Ji{constructor(Se,Be){super(Se,Be),p$q(this,"__Object__"),p$q(this,"requestIdleCallbackId")}unfoldAndFoldOthers(){if(this.isPopoverConfigEnabled())return;const Se=this.can("fold"),Be=this.can("unfold");Se&&Be&&(this.state.unfolded=!this.state.unfolded,this.plugin.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]}),this.state.unfolded&&this.plugin.tags.forEach(De=>{De.id!==this.id&&De.fold()}))}onClick(Se){Se.target==="TagPoint"&&this.unfoldAndFoldOthers()}applyVisible(){var Se,Be;this.currentVisible&&this.updateScreenPosition(),(Se=this.tag3DContentSvelte)!=null&&Se.css3DInstance&&(this.tag3DContentSvelte.css3DInstance.visible=this.visible),(Be=this.tag3DContentSvelte)==null||Be.svelteApp.$set({state:this.plugin.state,temporaryState:this.temporaryState}),this.plugin.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]})}unfold(){this.isPopoverConfigEnabled()||this.setUnfold(!0)}fold(){this.isPopoverConfigEnabled()||this.setUnfold(!1)}setUnfold(Se){if(this.isPopoverConfigEnabled())return;const Be=this.can("fold"),De=this.can("unfold");Be&&De&&(this.state.unfolded=Se,this.hooks.emit(Se?"unfolded":"folded"),this.plugin.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]}))}setPosition(Se){this.originPosition=Se,this.position=Se,this.cache.clear(),this.updateVisible(),this.updateScreenPosition(),this.updateZIndex(),this.plugin.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]})}updateScreenPosition(Se){var Be;if(this.stickType!=="2DPoint"&&this.stickType!=="3DPoint")return;const{force:De=!1}=Se??{},Ve=De?this.state.visible:this.currentVisible,Fe=(Be=this.__Object__)!=null?Be:{timeoutId:void 0,inAnimation:!1};if(this.__Object__=Fe,!Ve&&this.screenPosition?(Fe.inAnimation=!0,Fe.timeoutId=setTimeout(()=>{requestAnimationFrame(()=>{this.currentVisible||(Fe.inAnimation=!1,this.screenPosition=null,this.plugin.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]}))})},1e3)):Fe.timeoutId&&(clearTimeout(Fe.timeoutId),Fe.inAnimation=!1,Fe.timeoutId=void 0),!Ve&&!Fe.inAnimation)return;const Je=this.computeTagProject();if(Je&&this.five.renderer){const Xe=(()=>{if(!this.currentConfig.simulate3D)return 1;const Ye=2*Math.tan(.5*this.five.camera.fov/180*Math.PI),or=this.getDistance(void 0,1);return Math.max(Math.min(1-Ye*or/40,1),.7)})(),Ke=this.five.renderer.getSize(v$m);this.screenPosition={leftPx:(Je.x+1)/2*Ke.x,topPx:(-Je.y+1)/2*Ke.y,scale:Xe}}else this.screenPosition=null;this.plugin.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]})}set(Se,Be=!0){super.set(Se,Be),this.plugin.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]}),Se.position&&this.setPosition(this.position)}setData(...Se){super.setData(...Se),this.plugin.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]})}updateUnfoldedByPanoIndex(){if(this.isPopoverConfigEnabled())return;const Se=this.getUnfoldedByPanoIndex();if(this.state&&(Se!==void 0&&(this.state.unfolded=Se),Se&&!this.state.visible)){const Be=this.getConfig();typeof Be.unfoldedConfig=="object"&&Be.unfoldedConfig.autoFoldWhenHide!==!1&&(this.state.unfolded=!1)}}computeNormal(){return new Vector3().fromArray(this.normal)}};var A$i=Object.defineProperty,H$i=($e,Se,Be)=>Se in $e?A$i($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,o$f=($e,Se,Be)=>(H$i($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const $$6=1,V$6=`CSS3DObject@${$$6}`,z$a=.00216,F$a=.003;let nt$3=class extends c$I{constructor(Se){var Be,De,Ve,Fe,Je;if(t$e(Se.cornerPoints)&&t$e(Se.width))throw new Error("cornerPoints and width cannot be both empty");const Xe=(Be=Se.container)!=null?Be:document.createElement("div"),Ke=(De=Se.cornerPoints)!=null?De:(()=>{const xn=Se.width/2;return[new Vector3(-xn,xn,0),new Vector3(-xn,-xn,0),new Vector3(xn,-xn,0),new Vector3(xn,xn,0)]})(),Ye=(Ve=Se.ratio)!=null?Ve:F$a,or=(Fe=Se.dpr)!=null?Fe:1,sr=(Je=Se.pointerEvents)!=null?Je:"auto",cr=Math.max(z$a,Ye),Br=Ke[0].distanceTo(Ke[1]),tn=Ke[1].distanceTo(Ke[2]);let en=t$f(Br/Ye*or),an=t$f(tn/Ye*or);const rn=c$J(...Ke);let on;if(cr===Ye)Xe.style.width=`${en}px`,Xe.style.height=`${an}px`,on=Xe;else{const xn=document.createElement("div");xn.style.width=`${en}px`,xn.style.height=`${an}px`,xn.style.pointerEvents="none";const pn=Ye/cr;Xe.style.position="absolute",Xe.style.left="0",Xe.style.top="0",Xe.style.width=`${pn*en}px`,Xe.style.height=`${pn*an}px`,xn.appendChild(Xe),on=xn}if(super(on),o$f(this,"version",$$6),o$f(this,"isCSS3DObject",!0),o$f(this,"name",V$6),o$f(this,"container"),o$f(this,"width"),o$f(this,"height"),o$f(this,"domWidthPx"),o$f(this,"domHeightPx"),o$f(this,"cornerPoints"),o$f(this,"centerPosition"),o$f(this,"ratio"),o$f(this,"_mode","front"),o$f(this,"_opacityMesh"),on.id=this.id.toString(),Xe.style.pointerEvents=sr,Object.assign(Xe.style,Se.style),this.scale.set(cr,cr,cr),this.cornerPoints=Ke,this.ratio=Ye,this.container=Xe,Se.mode&&(this.mode=Se.mode),cr===Ye)this.width=Br,this.height=tn,this.centerPosition=rn;else{const xn=Ye/cr;this.width=xn*Br,this.height=xn*tn,en=xn*en,an=xn*an,this.centerPosition=new Vector3().subVectors(rn,Ke[0]).multiplyScalar(xn).add(Ke[0])}this.domWidthPx=en,this.domHeightPx=an,Xe.classList.add(`${V$6}__container`);const sn=new Vector3().subVectors(Ke[1],Ke[0]),ln=new Vector3().subVectors(Ke[3],Ke[0]),cn=new Vector3().crossVectors(sn,ln).normalize();this.lookAt(cn);const hn=this.up.clone().applyQuaternion(this.quaternion),mn=ln.clone(),An=new Vector3().crossVectors(hn,mn).normalize();this.rotateOnWorldAxis(An,hn.angleTo(mn)),this.position.copy(rn),this._opacityMesh=new p$B(en,an),this._opacityMesh.visible=Se.mode==="behind",this.add(this._opacityMesh)}get mode(){return this._mode}set mode(Se){this._mode=Se,this._opacityMesh&&(this._opacityMesh.visible=Se==="behind")}removeFromParent(){const Se=this.parent;return Se!==null&&Se.remove(this),this}dispose(){this.container.remove(),this.removeFromParent()}};var Ge=function($e,Se){return Ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Be,De){Be.__proto__=De}||function(Be,De){for(var Ve in De)Object.prototype.hasOwnProperty.call(De,Ve)&&(Be[Ve]=De[Ve])},Ge($e,Se)};function rr($e,Se){if(typeof Se!="function"&&Se!==null)throw new TypeError("Class extends value "+String(Se)+" is not a constructor or null");Ge($e,Se);function Be(){this.constructor=$e}$e.prototype=Se===null?Object.create(Se):(Be.prototype=Se.prototype,new Be)}var qr=function(){function $e(Rn){Loader.call(this,Rn),this.dracoLoader=null,this.ddsLoader=null}$e.prototype=Object.assign(Object.create(Loader.prototype),{constructor:$e,load:function(Rn,In,Gn,Fn){var Hn=this,Dn;this.resourcePath!==""?Dn=this.resourcePath:this.path!==""?Dn=this.path:Dn=LoaderUtils.extractUrlBase(Rn),Hn.manager.itemStart(Rn);var zn=function(Zn){Fn?Fn(Zn):console.error(Zn),Hn.manager.itemError(Rn),Hn.manager.itemEnd(Rn)},Qn=new FileLoader(Hn.manager);Qn.setPath(this.path),Qn.setResponseType("arraybuffer"),Qn.setRequestHeader(this.requestHeader),Hn.crossOrigin==="use-credentials"&&Qn.setWithCredentials(!0),Qn.load(Rn,function(Zn){try{Hn.parse(Zn,Dn,function(si){In(si),Hn.manager.itemEnd(Rn)},zn)}catch(si){zn(si)}},Gn,zn)},setDRACOLoader:function(Rn){return this.dracoLoader=Rn,this},setDDSLoader:function(Rn){return this.ddsLoader=Rn,this},parse:function(Rn,In,Gn,Fn){var Hn,Dn={};if(typeof Rn=="string")Hn=Rn;else{var zn=LoaderUtils.decodeText(new Uint8Array(Rn,0,4));if(zn===Ke){try{Dn[Be.KHR_BINARY_GLTF]=new sr(Rn)}catch(Un){Fn&&Fn(Un);return}Hn=Dn[Be.KHR_BINARY_GLTF].content}else Hn=LoaderUtils.decodeText(new Uint8Array(Rn))}var Qn=JSON.parse(Hn);if(Qn.asset===void 0||Qn.asset.version[0]<2){Fn&&Fn(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}if(Qn.extensionsUsed)for(var Zn=0;Zn<Qn.extensionsUsed.length;++Zn){var si=Qn.extensionsUsed[Zn],ei=Qn.extensionsRequired||[];switch(si){case Be.KHR_LIGHTS_PUNCTUAL:Dn[si]=new Ve(Qn);break;case Be.KHR_MATERIALS_CLEARCOAT:Dn[si]=new Je;break;case Be.KHR_MATERIALS_TRANSMISSION:Dn[si]=new Xe;break;case Be.KHR_MATERIALS_UNLIT:Dn[si]=new Fe;break;case Be.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:Dn[si]=new en;break;case Be.KHR_DRACO_MESH_COMPRESSION:Dn[si]=new cr(Qn,this.dracoLoader);break;case Be.MSFT_TEXTURE_DDS:Dn[si]=new De(this.ddsLoader);break;case Be.KHR_TEXTURE_TRANSFORM:Dn[si]=new Br;break;case Be.KHR_MESH_QUANTIZATION:Dn[si]=new an;break;case Be.REALSEE_MATERIALS_LIGHTMAP:Dn[si]=new on;break;default:ei.indexOf(si)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+si+'".')}}var hi=new Pn(Qn,Dn,{path:In||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});hi.fileLoader.setRequestHeader(this.requestHeader),hi.parse(Gn,Fn)}});function Se(){var Rn={};return{get:function(In){return Rn[In]},add:function(In,Gn){Rn[In]=Gn},remove:function(In){delete Rn[In]},removeAll:function(){Rn={}}}}var Be={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds",REALSEE_MATERIALS_LIGHTMAP:"REALSEE_materials_lightmap"};function De(Rn){if(!Rn)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=Be.MSFT_TEXTURE_DDS,this.ddsLoader=Rn}function Ve(Rn){this.name=Be.KHR_LIGHTS_PUNCTUAL;var In=Rn.extensions&&Rn.extensions[Be.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=In.lights||[]}Ve.prototype.loadLight=function(Rn){var In=this.lightDefs[Rn],Gn,Fn=new Color(16777215);In.color!==void 0&&Fn.fromArray(In.color);var Hn=In.range!==void 0?In.range:0;switch(In.type){case"directional":Gn=new DirectionalLight(Fn),Gn.target.position.set(0,0,-1),Gn.add(Gn.target);break;case"point":Gn=new PointLight(Fn),Gn.distance=Hn;break;case"spot":Gn=new SpotLight(Fn),Gn.distance=Hn,In.spot=In.spot||{},In.spot.innerConeAngle=In.spot.innerConeAngle!==void 0?In.spot.innerConeAngle:0,In.spot.outerConeAngle=In.spot.outerConeAngle!==void 0?In.spot.outerConeAngle:Math.PI/4,Gn.angle=In.spot.outerConeAngle,Gn.penumbra=1-In.spot.innerConeAngle/In.spot.outerConeAngle,Gn.target.position.set(0,0,-1),Gn.add(Gn.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+In.type+'".')}return Gn.position.set(0,0,0),Gn.decay=2,In.intensity!==void 0&&(Gn.intensity=In.intensity),Gn.name=In.name||"light_"+Rn,Promise.resolve(Gn)};function Fe(){this.name=Be.KHR_MATERIALS_UNLIT}Fe.prototype.getMaterialType=function(){return MeshBasicMaterial},Fe.prototype.extendParams=function(Rn,In,Gn){var Fn=[];Rn.color=new Color(1,1,1),Rn.opacity=1;var Hn=In.pbrMetallicRoughness;if(Hn){if(Array.isArray(Hn.baseColorFactor)){var Dn=Hn.baseColorFactor;Rn.color.fromArray(Dn),Rn.opacity=Dn[3]}Hn.baseColorTexture!==void 0&&Fn.push(Gn.assignTexture(Rn,"map",Hn.baseColorTexture))}return Promise.all(Fn)};function Je(){this.name=Be.KHR_MATERIALS_CLEARCOAT}Je.prototype.getMaterialType=function(){return MeshPhysicalMaterial},Je.prototype.extendParams=function(Rn,In,Gn){var Fn=[],Hn=In.extensions[this.name];if(Hn.clearcoatFactor!==void 0&&(Rn.clearcoat=Hn.clearcoatFactor),Hn.clearcoatTexture!==void 0&&Fn.push(Gn.assignTexture(Rn,"clearcoatMap",Hn.clearcoatTexture)),Hn.clearcoatRoughnessFactor!==void 0&&(Rn.clearcoatRoughness=Hn.clearcoatRoughnessFactor),Hn.clearcoatRoughnessTexture!==void 0&&Fn.push(Gn.assignTexture(Rn,"clearcoatRoughnessMap",Hn.clearcoatRoughnessTexture)),Hn.clearcoatNormalTexture!==void 0&&(Fn.push(Gn.assignTexture(Rn,"clearcoatNormalMap",Hn.clearcoatNormalTexture)),Hn.clearcoatNormalTexture.scale!==void 0)){var Dn=Hn.clearcoatNormalTexture.scale;Rn.clearcoatNormalScale=new Vector2(Dn,Dn)}return Promise.all(Fn)};function Xe(){this.name=Be.KHR_MATERIALS_TRANSMISSION}Xe.prototype.getMaterialType=function(){return MeshPhysicalMaterial},Xe.prototype.extendParams=function(Rn,In,Gn){var Fn=[],Hn=In.extensions[this.name];return Hn.transmissionFactor!==void 0&&(Rn.premultipliedAlpha=!0,Rn.transparent=!0,Rn.opacity=Rn.opacity!==void 0?Rn.opacity:.5),Promise.all(Fn)};var Ke="glTF",Ye=12,or={JSON:1313821514,BIN:5130562};function sr(Rn){this.name=Be.KHR_BINARY_GLTF,this.content=null,this.body=null;var In=new DataView(Rn,0,Ye);if(this.header={magic:LoaderUtils.decodeText(new Uint8Array(Rn.slice(0,4))),version:In.getUint32(4,!0),length:In.getUint32(8,!0)},this.header.magic!==Ke)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var Gn=new DataView(Rn,Ye),Fn=0;Fn<Gn.byteLength;){var Hn=Gn.getUint32(Fn,!0);Fn+=4;var Dn=Gn.getUint32(Fn,!0);if(Fn+=4,Dn===or.JSON){var zn=new Uint8Array(Rn,Ye+Fn,Hn);this.content=LoaderUtils.decodeText(zn)}else if(Dn===or.BIN){var Qn=Ye+Fn;this.body=Rn.slice(Qn,Qn+Hn)}Fn+=Hn}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function cr(Rn,In){if(!In)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Be.KHR_DRACO_MESH_COMPRESSION,this.json=Rn,this.dracoLoader=In,this.dracoLoader.preload()}cr.prototype.decodePrimitive=function(Rn,In){var Gn=this.json,Fn=this.dracoLoader,Hn=Rn.extensions[this.name].bufferView,Dn=Rn.extensions[this.name].attributes,zn={},Qn={},Zn={};for(var si in Dn){var ei=An[si]||si.toLowerCase();zn[ei]=Dn[si]}for(si in Rn.attributes){var ei=An[si]||si.toLowerCase();if(Dn[si]!==void 0){var hi=Gn.accessors[Rn.attributes[si]],Un=ln[hi.componentType];Zn[ei]=Un,Qn[ei]=hi.normalized===!0}}return In.getDependency("bufferView",Hn).then(function(Wn){return new Promise(function(Ai){Fn.decodeDracoFile(Wn,function(oi){for(var ci in oi.attributes){var ai=oi.attributes[ci],wi=Qn[ci];wi!==void 0&&(ai.normalized=wi)}Ai(oi)},zn,Zn)})})};function Br(){this.name=Be.KHR_TEXTURE_TRANSFORM}Br.prototype.extendTexture=function(Rn,In){return Rn=Rn.clone(),In.offset!==void 0&&Rn.offset.fromArray(In.offset),In.rotation!==void 0&&(Rn.rotation=In.rotation),In.scale!==void 0&&Rn.repeat.fromArray(In.scale),In.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),Rn.needsUpdate=!0,Rn};function tn(Rn){MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var In=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),Gn=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),Fn=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),Hn=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),Dn=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join(`
`),zn={specular:{value:new Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=zn,this.onBeforeCompile=function(Qn){for(var Zn in zn)Qn.uniforms[Zn]=zn[Zn];Qn.fragmentShader=Qn.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),Qn.fragmentShader=Qn.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),Qn.fragmentShader=Qn.fragmentShader.replace("#include <roughnessmap_pars_fragment>",In),Qn.fragmentShader=Qn.fragmentShader.replace("#include <metalnessmap_pars_fragment>",Gn),Qn.fragmentShader=Qn.fragmentShader.replace("#include <roughnessmap_fragment>",Fn),Qn.fragmentShader=Qn.fragmentShader.replace("#include <metalnessmap_fragment>",Hn),Qn.fragmentShader=Qn.fragmentShader.replace("#include <lights_physical_fragment>",Dn)},Object.defineProperties(this,{specular:{get:function(){return zn.specular.value},set:function(Qn){zn.specular.value=Qn}},specularMap:{get:function(){return zn.specularMap.value},set:function(Qn){zn.specularMap.value=Qn}},glossiness:{get:function(){return zn.glossiness.value},set:function(Qn){zn.glossiness.value=Qn}},glossinessMap:{get:function(){return zn.glossinessMap.value},set:function(Qn){zn.glossinessMap.value=Qn,Qn?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(Rn)}tn.prototype=Object.create(MeshStandardMaterial.prototype),tn.prototype.constructor=tn,tn.prototype.copy=function(Rn){return MeshStandardMaterial.prototype.copy.call(this,Rn),this.specularMap=Rn.specularMap,this.specular.copy(Rn.specular),this.glossinessMap=Rn.glossinessMap,this.glossiness=Rn.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function en(){return{name:Be.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return tn},extendParams:function(Rn,In,Gn){var Fn=In.extensions[this.name];Rn.color=new Color(1,1,1),Rn.opacity=1;var Hn=[];if(Array.isArray(Fn.diffuseFactor)){var Dn=Fn.diffuseFactor;Rn.color.fromArray(Dn),Rn.opacity=Dn[3]}if(Fn.diffuseTexture!==void 0&&Hn.push(Gn.assignTexture(Rn,"map",Fn.diffuseTexture)),Rn.emissive=new Color(0,0,0),Rn.glossiness=Fn.glossinessFactor!==void 0?Fn.glossinessFactor:1,Rn.specular=new Color(1,1,1),Array.isArray(Fn.specularFactor)&&Rn.specular.fromArray(Fn.specularFactor),Fn.specularGlossinessTexture!==void 0){var zn=Fn.specularGlossinessTexture;Hn.push(Gn.assignTexture(Rn,"glossinessMap",zn)),Hn.push(Gn.assignTexture(Rn,"specularMap",zn))}return Promise.all(Hn)},createMaterial:function(Rn){var In=new tn(Rn);return In.fog=!0,In.color=Rn.color,In.map=Rn.map===void 0?null:Rn.map,In.lightMap=null,In.lightMapIntensity=1,In.aoMap=Rn.aoMap===void 0?null:Rn.aoMap,In.aoMapIntensity=1,In.emissive=Rn.emissive,In.emissiveIntensity=1,In.emissiveMap=Rn.emissiveMap===void 0?null:Rn.emissiveMap,In.bumpMap=Rn.bumpMap===void 0?null:Rn.bumpMap,In.bumpScale=1,In.normalMap=Rn.normalMap===void 0?null:Rn.normalMap,In.normalMapType=TangentSpaceNormalMap,Rn.normalScale&&(In.normalScale=Rn.normalScale),In.displacementMap=null,In.displacementScale=1,In.displacementBias=0,In.specularMap=Rn.specularMap===void 0?null:Rn.specularMap,In.specular=Rn.specular,In.glossinessMap=Rn.glossinessMap===void 0?null:Rn.glossinessMap,In.glossiness=Rn.glossiness,In.alphaMap=null,In.envMap=Rn.envMap===void 0?null:Rn.envMap,In.envMapIntensity=1,In.refractionRatio=.98,In}}}function an(){this.name=Be.KHR_MESH_QUANTIZATION}function rn(Rn,In,Gn,Fn){Interpolant.call(this,Rn,In,Gn,Fn)}rn.prototype=Object.create(Interpolant.prototype),rn.prototype.constructor=rn,rn.prototype.copySampleValue_=function(Rn){for(var In=this.resultBuffer,Gn=this.sampleValues,Fn=this.valueSize,Hn=Rn*Fn*3+Fn,Dn=0;Dn!==Fn;Dn++)In[Dn]=Gn[Hn+Dn];return In},rn.prototype.beforeStart_=rn.prototype.copySampleValue_,rn.prototype.afterEnd_=rn.prototype.copySampleValue_,rn.prototype.interpolate_=function(Rn,In,Gn,Fn){for(var Hn=this.resultBuffer,Dn=this.sampleValues,zn=this.valueSize,Qn=zn*2,Zn=zn*3,si=Fn-In,ei=(Gn-In)/si,hi=ei*ei,Un=hi*ei,Wn=Rn*Zn,Ai=Wn-Zn,oi=-2*Un+3*hi,ci=Un-hi,ai=1-oi,wi=ci-hi+ei,Pi=0;Pi!==zn;Pi++){var Oi=Dn[Ai+Pi+zn],Ri=Dn[Ai+Pi+Qn]*si,_i=Dn[Wn+Pi+zn],Mi=Dn[Wn+Pi]*si;Hn[Pi]=ai*Oi+wi*Ri+oi*_i+ci*Mi}return Hn};function on(Rn){this.parser=Rn,this.name=Be.REALSEE_MATERIALS_LIGHTMAP}on.prototype.getMaterialType=function(Rn){return MeshPhongMaterial},on.prototype.extendParams=function(Rn,In,Gn){if(!In.extensions||!In.extensions[this.name])return Promise.resolve();var Fn=[],Hn=In.extensions[this.name];return Hn.lightMapTexture!==void 0&&Fn.push(Gn.assignTexture(Rn,"lightMap",Hn.lightMapTexture)),Hn.lightMapIntensity!==void 0&&(Rn.lightMapIntensity=Hn.lightMapIntensity),Promise.all(Fn)};var sn={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ln={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},cn={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},hn={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},mn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},An={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},xn={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},pn={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},dn={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},fn={"image/png":RGBAFormat,"image/jpeg":RGBFormat};function yn(Rn,In){return typeof Rn!="string"||Rn===""?"":(/^https?:\/\//i.test(In)&&/^\//.test(Rn)&&(In=In.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(Rn)||/^data:.*,.*$/i.test(Rn)||/^blob:.*$/i.test(Rn)?Rn:In+Rn)}function Sn(Rn){return Rn.DefaultMaterial===void 0&&(Rn.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),Rn.DefaultMaterial}function gn(Rn,In,Gn){for(var Fn in Gn.extensions)Rn[Fn]===void 0&&(In.userData.gltfExtensions=In.userData.gltfExtensions||{},In.userData.gltfExtensions[Fn]=Gn.extensions[Fn])}function Cn(Rn,In){In.extras!==void 0&&(typeof In.extras=="object"?Object.assign(Rn.userData,In.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+In.extras))}function Mn(Rn,In,Gn){for(var Fn=!1,Hn=!1,Dn=0,zn=In.length;Dn<zn;Dn++){var Qn=In[Dn];if(Qn.POSITION!==void 0&&(Fn=!0),Qn.NORMAL!==void 0&&(Hn=!0),Fn&&Hn)break}if(!Fn&&!Hn)return Promise.resolve(Rn);for(var Zn=[],si=[],Dn=0,zn=In.length;Dn<zn;Dn++){var Qn=In[Dn];if(Fn){var ei=Qn.POSITION!==void 0?Gn.getDependency("accessor",Qn.POSITION):Rn.attributes.position;Zn.push(ei)}if(Hn){var ei=Qn.NORMAL!==void 0?Gn.getDependency("accessor",Qn.NORMAL):Rn.attributes.normal;si.push(ei)}}return Promise.all([Promise.all(Zn),Promise.all(si)]).then(function(hi){var Un=hi[0],Wn=hi[1];return Fn&&(Rn.morphAttributes.position=Un),Hn&&(Rn.morphAttributes.normal=Wn),Rn.morphTargetsRelative=!0,Rn})}function Bn(Rn,In){if(Rn.updateMorphTargets(),In.weights!==void 0)for(var Gn=0,Fn=In.weights.length;Gn<Fn;Gn++)Rn.morphTargetInfluences[Gn]=In.weights[Gn];if(In.extras&&Array.isArray(In.extras.targetNames)){var Hn=In.extras.targetNames;if(Rn.morphTargetInfluences.length===Hn.length){Rn.morphTargetDictionary={};for(var Gn=0,Fn=Hn.length;Gn<Fn;Gn++)Rn.morphTargetDictionary[Hn[Gn]]=Gn}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function kn(Rn){var In=Rn.extensions&&Rn.extensions[Be.KHR_DRACO_MESH_COMPRESSION],Gn;return In?Gn="draco:"+In.bufferView+":"+In.indices+":"+Ln(In.attributes):Gn=Rn.indices+":"+Ln(Rn.attributes)+":"+Rn.mode,Gn}function Ln(Rn){for(var In="",Gn=Object.keys(Rn).sort(),Fn=0,Hn=Gn.length;Fn<Hn;Fn++)In+=Gn[Fn]+":"+Rn[Gn[Fn]]+";";return In}function Pn(Rn,In,Gn){this.json=Rn||{},this.extensions=In||{},this.options=Gn||{},this.cache=new Se,this.associations=new Map,this.primitiveCache={},this.textureLoader=new TextureLoader$1(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}Pn.prototype.parse=function(Rn,In){var Gn=this,Fn=this.json,Hn=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(Dn){var zn={scene:Dn[0][Fn.scene||0],scenes:Dn[0],animations:Dn[1],cameras:Dn[2],asset:Fn.asset,parser:Gn,userData:{}};gn(Hn,zn,Fn),Cn(zn,Fn),Rn(zn)}).catch(In)},Pn.prototype.markDefs=function(){for(var Rn=this.json.nodes||[],In=this.json.skins||[],Gn=this.json.meshes||[],Fn={},Hn={},Dn=0,zn=In.length;Dn<zn;Dn++)for(var Qn=In[Dn].joints,Zn=0,si=Qn.length;Zn<si;Zn++)Rn[Qn[Zn]].isBone=!0;for(var ei=0,hi=Rn.length;ei<hi;ei++){var Un=Rn[ei];Un.mesh!==void 0&&(Fn[Un.mesh]===void 0&&(Fn[Un.mesh]=Hn[Un.mesh]=0),Fn[Un.mesh]++,Un.skin!==void 0&&(Gn[Un.mesh].isSkinnedMesh=!0))}this.json.meshReferences=Fn,this.json.meshUses=Hn},Pn.prototype.getDependency=function(Rn,In){var Gn=Rn+":"+In,Fn=this.cache.get(Gn);if(!Fn){switch(Rn){case"scene":Fn=this.loadScene(In);break;case"node":Fn=this.loadNode(In);break;case"mesh":Fn=this.loadMesh(In);break;case"accessor":Fn=this.loadAccessor(In);break;case"bufferView":Fn=this.loadBufferView(In);break;case"buffer":Fn=this.loadBuffer(In);break;case"material":Fn=this.loadMaterial(In);break;case"texture":Fn=this.loadTexture(In);break;case"skin":Fn=this.loadSkin(In);break;case"animation":Fn=this.loadAnimation(In);break;case"camera":Fn=this.loadCamera(In);break;case"light":Fn=this.extensions[Be.KHR_LIGHTS_PUNCTUAL].loadLight(In);break;default:throw new Error("Unknown type: "+Rn)}this.cache.add(Gn,Fn)}return Fn},Pn.prototype.getDependencies=function(Rn){var In=this.cache.get(Rn);if(!In){var Gn=this,Fn=this.json[Rn+(Rn==="mesh"?"es":"s")]||[];In=Promise.all(Fn.map(function(Hn,Dn){return Gn.getDependency(Rn,Dn)})),this.cache.add(Rn,In)}return In},Pn.prototype.loadBuffer=function(Rn){var In=this.json.buffers[Rn],Gn=this.fileLoader;if(In.type&&In.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+In.type+" buffer type is not supported.");if(In.uri===void 0&&Rn===0)return Promise.resolve(this.extensions[Be.KHR_BINARY_GLTF].body);var Fn=this.options;return new Promise(function(Hn,Dn){Gn.load(yn(In.uri,Fn.path),Hn,void 0,function(){Dn(new Error('THREE.GLTFLoader: Failed to load buffer "'+In.uri+'".'))})})},Pn.prototype.loadBufferView=function(Rn){var In=this.json.bufferViews[Rn];return this.getDependency("buffer",In.buffer).then(function(Gn){var Fn=In.byteLength||0,Hn=In.byteOffset||0;return Gn.slice(Hn,Hn+Fn)})},Pn.prototype.loadAccessor=function(Rn){var In=this,Gn=this.json,Fn=this.json.accessors[Rn];if(Fn.bufferView===void 0&&Fn.sparse===void 0)return Promise.resolve(null);var Hn=[];return Fn.bufferView!==void 0?Hn.push(this.getDependency("bufferView",Fn.bufferView)):Hn.push(null),Fn.sparse!==void 0&&(Hn.push(this.getDependency("bufferView",Fn.sparse.indices.bufferView)),Hn.push(this.getDependency("bufferView",Fn.sparse.values.bufferView))),Promise.all(Hn).then(function(Dn){var zn=Dn[0],Qn=mn[Fn.type],Zn=ln[Fn.componentType],si=Zn.BYTES_PER_ELEMENT,ei=si*Qn,hi=Fn.byteOffset||0,Un=Fn.bufferView!==void 0?Gn.bufferViews[Fn.bufferView].byteStride:void 0,Wn=Fn.normalized===!0,Ai,oi;if(Un&&Un!==ei){var ci=Math.floor(hi/Un),ai="InterleavedBuffer:"+Fn.bufferView+":"+Fn.componentType+":"+ci+":"+Fn.count,wi=In.cache.get(ai);wi||(Ai=new Zn(zn,ci*Un,Fn.count*Un/si),wi=new InterleavedBuffer(Ai,Un/si),In.cache.add(ai,wi)),oi=new InterleavedBufferAttribute(wi,Qn,hi%Un/si,Wn)}else zn===null?Ai=new Zn(Fn.count*Qn):Ai=new Zn(zn,hi,Fn.count*Qn),oi=new BufferAttribute(Ai,Qn,Wn);if(Fn.sparse!==void 0){var Pi=mn.SCALAR,Oi=ln[Fn.sparse.indices.componentType],Ri=Fn.sparse.indices.byteOffset||0,_i=Fn.sparse.values.byteOffset||0,Mi=new Oi(Dn[1],Ri,Fn.sparse.count*Pi),$i=new Zn(Dn[2],_i,Fn.sparse.count*Qn);zn!==null&&(oi=new BufferAttribute(oi.array.slice(),oi.itemSize,oi.normalized));for(var vi=0,ri=Mi.length;vi<ri;vi++){var Ti=Mi[vi];if(oi.setX(Ti,$i[vi*Qn]),Qn>=2&&oi.setY(Ti,$i[vi*Qn+1]),Qn>=3&&oi.setZ(Ti,$i[vi*Qn+2]),Qn>=4&&oi.setW(Ti,$i[vi*Qn+3]),Qn>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return oi})},Pn.prototype.loadTexture=function(Rn){var In=this,Gn=this.json,Fn=this.options,Hn=this.textureLoader,Dn=self.URL||self.webkitURL,zn=Gn.textures[Rn],Qn=zn.extensions||{},Zn;Qn[Be.MSFT_TEXTURE_DDS]?Zn=Gn.images[Qn[Be.MSFT_TEXTURE_DDS].source]:Zn=Gn.images[zn.source];var si=Zn.uri,ei=!1;return Zn.bufferView!==void 0&&(si=In.getDependency("bufferView",Zn.bufferView).then(function(hi){ei=!0;var Un=new Blob([hi],{type:Zn.mimeType});return si=Dn.createObjectURL(Un),si})),Promise.resolve(si).then(function(hi){var Un=Fn.manager.getHandler(hi);return Un||(Un=Qn[Be.MSFT_TEXTURE_DDS]?In.extensions[Be.MSFT_TEXTURE_DDS].ddsLoader:Hn),new Promise(function(Wn,Ai){Un.load(yn(hi,Fn.path),Wn,void 0,Ai)})}).then(function(hi){ei===!0&&Dn.revokeObjectURL(si),hi.flipY=!1,zn.name&&(hi.name=zn.name),Zn.mimeType in fn&&(hi.format=fn[Zn.mimeType]);var Un=Gn.samplers||{},Wn=Un[zn.sampler]||{};return hi.magFilter=cn[Wn.magFilter]||LinearFilter,hi.minFilter=cn[Wn.minFilter]||LinearMipmapLinearFilter,hi.wrapS=hn[Wn.wrapS]||RepeatWrapping,hi.wrapT=hn[Wn.wrapT]||RepeatWrapping,In.associations.set(hi,{type:"textures",index:Rn}),hi})},Pn.prototype.assignTexture=function(Rn,In,Gn){var Fn=this;return this.getDependency("texture",Gn.index).then(function(Hn){if(!Hn.isCompressedTexture)switch(In){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":Hn.format=RGBFormat;break}if(Gn.texCoord!==void 0&&Gn.texCoord!=0&&!(In==="aoMap"&&Gn.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+Gn.texCoord+" for texture "+In+" not yet supported."),Fn.extensions[Be.KHR_TEXTURE_TRANSFORM]){var Dn=Gn.extensions!==void 0?Gn.extensions[Be.KHR_TEXTURE_TRANSFORM]:void 0;if(Dn){var zn=Fn.associations.get(Hn);Hn=Fn.extensions[Be.KHR_TEXTURE_TRANSFORM].extendTexture(Hn,Dn),Fn.associations.set(Hn,zn)}}Rn[In]=Hn})},Pn.prototype.assignFinalMaterial=function(Rn){var In=Rn.geometry,Gn=Rn.material,Fn=In.attributes.tangent!==void 0,Hn=In.attributes.color!==void 0,Dn=In.attributes.normal===void 0,zn=Rn.isSkinnedMesh===!0,Qn=Object.keys(In.morphAttributes).length>0,Zn=Qn&&In.morphAttributes.normal!==void 0;if(Rn.isPoints){var si="PointsMaterial:"+Gn.uuid,ei=this.cache.get(si);ei||(ei=new PointsMaterial,Material.prototype.copy.call(ei,Gn),ei.color.copy(Gn.color),ei.map=Gn.map,ei.sizeAttenuation=!1,this.cache.add(si,ei)),Gn=ei}else if(Rn.isLine){var si="LineBasicMaterial:"+Gn.uuid,hi=this.cache.get(si);hi||(hi=new LineBasicMaterial,Material.prototype.copy.call(hi,Gn),hi.color.copy(Gn.color),this.cache.add(si,hi)),Gn=hi}if(Fn||Hn||Dn||zn||Qn){var si="ClonedMaterial:"+Gn.uuid+":";Gn.isGLTFSpecularGlossinessMaterial&&(si+="specular-glossiness:"),zn&&(si+="skinning:"),Fn&&(si+="vertex-tangents:"),Hn&&(si+="vertex-colors:"),Dn&&(si+="flat-shading:"),Qn&&(si+="morph-targets:"),Zn&&(si+="morph-normals:");var Un=this.cache.get(si);Un||(Un=Gn.clone(),zn&&(Un.skinning=!0),Fn&&(Un.vertexTangents=!0),Hn&&(Un.vertexColors=!0),Dn&&(Un.flatShading=!0),Qn&&(Un.morphTargets=!0),Zn&&(Un.morphNormals=!0),this.cache.add(si,Un),this.associations.set(Un,this.associations.get(Gn))),Gn=Un}Gn.aoMap&&In.attributes.uv2===void 0&&In.attributes.uv!==void 0&&In.setAttribute("uv2",In.attributes.uv),Gn.normalScale&&!Fn&&(Gn.normalScale.y=-Gn.normalScale.y),Gn.clearcoatNormalScale&&!Fn&&(Gn.clearcoatNormalScale.y=-Gn.clearcoatNormalScale.y),Rn.material=Gn},Pn.prototype.loadMaterial=function(Rn){var In=this,Gn=this.json,Fn=this.extensions,Hn=Gn.materials[Rn],Dn,zn={},Qn=Hn.extensions||{},Zn=[];if(Qn[Be.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var si=Fn[Be.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];Dn=si.getMaterialType(),Zn.push(si.extendParams(zn,Hn,In))}else if(Qn[Be.KHR_MATERIALS_UNLIT]){var ei=Fn[Be.KHR_MATERIALS_UNLIT];Dn=ei.getMaterialType(),Zn.push(ei.extendParams(zn,Hn,In))}else{Dn=MeshStandardMaterial;var hi=Hn.pbrMetallicRoughness||{};if(zn.color=new Color(1,1,1),zn.opacity=1,Array.isArray(hi.baseColorFactor)){var Un=hi.baseColorFactor;zn.color.fromArray(Un),zn.opacity=Un[3]}hi.baseColorTexture!==void 0&&Zn.push(In.assignTexture(zn,"map",hi.baseColorTexture)),zn.metalness=hi.metallicFactor!==void 0?hi.metallicFactor:1,zn.roughness=hi.roughnessFactor!==void 0?hi.roughnessFactor:1,hi.metallicRoughnessTexture!==void 0&&(Zn.push(In.assignTexture(zn,"metalnessMap",hi.metallicRoughnessTexture)),Zn.push(In.assignTexture(zn,"roughnessMap",hi.metallicRoughnessTexture)))}Hn.doubleSided===!0&&(zn.side=DoubleSide);var Wn=Hn.alphaMode||dn.OPAQUE;if(Wn===dn.BLEND?(zn.transparent=!0,zn.depthWrite=!1):(zn.transparent=!1,Wn===dn.MASK&&(zn.alphaTest=Hn.alphaCutoff!==void 0?Hn.alphaCutoff:.5)),Hn.normalTexture!==void 0&&Dn!==MeshBasicMaterial&&(Zn.push(In.assignTexture(zn,"normalMap",Hn.normalTexture)),zn.normalScale=new Vector2(1,1),Hn.normalTexture.scale!==void 0&&zn.normalScale.set(Hn.normalTexture.scale,Hn.normalTexture.scale)),Hn.occlusionTexture!==void 0&&Dn!==MeshBasicMaterial&&(Zn.push(In.assignTexture(zn,"aoMap",Hn.occlusionTexture)),Hn.occlusionTexture.strength!==void 0&&(zn.aoMapIntensity=Hn.occlusionTexture.strength)),Hn.emissiveFactor!==void 0&&Dn!==MeshBasicMaterial&&(zn.emissive=new Color().fromArray(Hn.emissiveFactor)),Hn.emissiveTexture!==void 0&&Dn!==MeshBasicMaterial&&Zn.push(In.assignTexture(zn,"emissiveMap",Hn.emissiveTexture)),Qn[Be.KHR_MATERIALS_CLEARCOAT]){var Ai=Fn[Be.KHR_MATERIALS_CLEARCOAT];Dn=Ai.getMaterialType(),Zn.push(Ai.extendParams(zn,{extensions:Qn},In))}if(Qn[Be.KHR_MATERIALS_TRANSMISSION]){var Ai=Fn[Be.KHR_MATERIALS_TRANSMISSION];Dn=Ai.getMaterialType(),Zn.push(Ai.extendParams(zn,{extensions:Qn},In))}if(Qn[Be.REALSEE_MATERIALS_LIGHTMAP]){var oi=Fn[Be.REALSEE_MATERIALS_LIGHTMAP];Dn=oi.getMaterialType(),Zn.push(oi.extendParams(zn,{extensions:Qn},In))}return Promise.all(Zn).then(function(){var ci;return Dn===tn?ci=Fn[Be.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(zn):ci=new Dn(zn),Hn.name&&(ci.name=Hn.name),ci.map&&(ci.map.encoding=sRGBEncoding),ci.emissiveMap&&(ci.emissiveMap.encoding=sRGBEncoding),Cn(ci,Hn),In.associations.set(ci,{type:"materials",index:Rn}),Hn.extensions&&gn(Fn,ci,Hn),ci})};function Vn(Rn,In,Gn){var Fn=In.attributes,Hn=new Box3;if(Fn.POSITION!==void 0){var Dn=Gn.json.accessors[Fn.POSITION],zn=Dn.min,Qn=Dn.max;if(zn!==void 0&&Qn!==void 0)Hn.set(new Vector3(zn[0],zn[1],zn[2]),new Vector3(Qn[0],Qn[1],Qn[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var Zn=In.targets;if(Zn!==void 0){for(var si=new Vector3,ei=new Vector3,hi=0,Un=Zn.length;hi<Un;hi++){var Wn=Zn[hi];if(Wn.POSITION!==void 0){var Dn=Gn.json.accessors[Wn.POSITION],zn=Dn.min,Qn=Dn.max;zn!==void 0&&Qn!==void 0?(ei.setX(Math.max(Math.abs(zn[0]),Math.abs(Qn[0]))),ei.setY(Math.max(Math.abs(zn[1]),Math.abs(Qn[1]))),ei.setZ(Math.max(Math.abs(zn[2]),Math.abs(Qn[2]))),si.max(ei)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Hn.expandByVector(si)}Rn.boundingBox=Hn;var Ai=new Sphere;Hn.getCenter(Ai.center),Ai.radius=Hn.min.distanceTo(Hn.max)/2,Rn.boundingSphere=Ai}function Yn(Rn,In,Gn){var Fn=In.attributes,Hn=[];function Dn(si,ei){return Gn.getDependency("accessor",si).then(function(hi){Rn.setAttribute(ei,hi)})}for(var zn in Fn){var Qn=An[zn]||zn.toLowerCase();Qn in Rn.attributes||Hn.push(Dn(Fn[zn],Qn))}if(In.indices!==void 0&&!Rn.index){var Zn=Gn.getDependency("accessor",In.indices).then(function(si){Rn.setIndex(si)});Hn.push(Zn)}return Cn(Rn,In),Vn(Rn,In,Gn),Promise.all(Hn).then(function(){return In.targets!==void 0?Mn(Rn,In.targets,Gn):Rn})}function ni(Rn,In){var Gn=Rn.getIndex();if(Gn===null){var Fn=[],Hn=Rn.getAttribute("position");if(Hn!==void 0){for(var Dn=0;Dn<Hn.count;Dn++)Fn.push(Dn);Rn.setIndex(Fn),Gn=Rn.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),Rn}var zn=Gn.count-2,Qn=[];if(In===TriangleFanDrawMode)for(var Dn=1;Dn<=zn;Dn++)Qn.push(Gn.getX(0)),Qn.push(Gn.getX(Dn)),Qn.push(Gn.getX(Dn+1));else for(var Dn=0;Dn<zn;Dn++)Dn%2===0?(Qn.push(Gn.getX(Dn)),Qn.push(Gn.getX(Dn+1)),Qn.push(Gn.getX(Dn+2))):(Qn.push(Gn.getX(Dn+2)),Qn.push(Gn.getX(Dn+1)),Qn.push(Gn.getX(Dn)));Qn.length/3!==zn&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var Zn=Rn.clone();return Zn.setIndex(Qn),Zn}return Pn.prototype.loadGeometries=function(Rn){var In=this,Gn=this.extensions,Fn=this.primitiveCache;function Hn(Un){return Gn[Be.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Un,In).then(function(Wn){return Yn(Wn,Un,In)})}for(var Dn=[],zn=0,Qn=Rn.length;zn<Qn;zn++){var Zn=Rn[zn],si=kn(Zn),ei=Fn[si];if(ei)Dn.push(ei.promise);else{var hi;Zn.extensions&&Zn.extensions[Be.KHR_DRACO_MESH_COMPRESSION]?hi=Hn(Zn):hi=Yn(new BufferGeometry,Zn,In),Fn[si]={primitive:Zn,promise:hi},Dn.push(hi)}}return Promise.all(Dn)},Pn.prototype.loadMesh=function(Rn){for(var In=this,Gn=this.json,Fn=Gn.meshes[Rn],Hn=Fn.primitives,Dn=[],zn=0,Qn=Hn.length;zn<Qn;zn++){var Zn=Hn[zn].material===void 0?Sn(this.cache):this.getDependency("material",Hn[zn].material);Dn.push(Zn)}return Dn.push(In.loadGeometries(Hn)),Promise.all(Dn).then(function(si){for(var ei=si.slice(0,si.length-1),hi=si[si.length-1],Un=[],Wn=0,Ai=hi.length;Wn<Ai;Wn++){var oi=hi[Wn],ci=Hn[Wn],ai,wi=ei[Wn];if(ci.mode===sn.TRIANGLES||ci.mode===sn.TRIANGLE_STRIP||ci.mode===sn.TRIANGLE_FAN||ci.mode===void 0)ai=Fn.isSkinnedMesh===!0?new SkinnedMesh(oi,wi):new Mesh(oi,wi),ai.isSkinnedMesh===!0&&!ai.geometry.attributes.skinWeight.normalized&&ai.normalizeSkinWeights(),ci.mode===sn.TRIANGLE_STRIP?ai.geometry=ni(ai.geometry,TriangleStripDrawMode):ci.mode===sn.TRIANGLE_FAN&&(ai.geometry=ni(ai.geometry,TriangleFanDrawMode));else if(ci.mode===sn.LINES)ai=new LineSegments(oi,wi);else if(ci.mode===sn.LINE_STRIP)ai=new Line(oi,wi);else if(ci.mode===sn.LINE_LOOP)ai=new LineLoop(oi,wi);else if(ci.mode===sn.POINTS)ai=new Points(oi,wi);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+ci.mode);Object.keys(ai.geometry.morphAttributes).length>0&&Bn(ai,Fn),ai.name=Fn.name||"mesh_"+Rn,hi.length>1&&(ai.name+="_"+Wn),Cn(ai,Fn),In.assignFinalMaterial(ai),Un.push(ai)}if(Un.length===1)return Un[0];for(var Pi=new Group$1,Wn=0,Ai=Un.length;Wn<Ai;Wn++)Pi.add(Un[Wn]);return Pi})},Pn.prototype.loadCamera=function(Rn){var In,Gn=this.json.cameras[Rn],Fn=Gn[Gn.type];if(!Fn){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Gn.type==="perspective"?In=new PerspectiveCamera(MathUtils.radToDeg(Fn.yfov),Fn.aspectRatio||1,Fn.znear||1,Fn.zfar||2e6):Gn.type==="orthographic"&&(In=new OrthographicCamera(-Fn.xmag,Fn.xmag,Fn.ymag,-Fn.ymag,Fn.znear,Fn.zfar)),Gn.name&&(In.name=Gn.name),Cn(In,Gn),Promise.resolve(In)},Pn.prototype.loadSkin=function(Rn){var In=this.json.skins[Rn],Gn={joints:In.joints};return In.inverseBindMatrices===void 0?Promise.resolve(Gn):this.getDependency("accessor",In.inverseBindMatrices).then(function(Fn){return Gn.inverseBindMatrices=Fn,Gn})},Pn.prototype.loadAnimation=function(Rn){for(var In=this.json,Gn=In.animations[Rn],Fn=[],Hn=[],Dn=[],zn=[],Qn=[],Zn=0,si=Gn.channels.length;Zn<si;Zn++){var ei=Gn.channels[Zn],hi=Gn.samplers[ei.sampler],Un=ei.target,Wn=Un.node!==void 0?Un.node:Un.id,Ai=Gn.parameters!==void 0?Gn.parameters[hi.input]:hi.input,oi=Gn.parameters!==void 0?Gn.parameters[hi.output]:hi.output;Fn.push(this.getDependency("node",Wn)),Hn.push(this.getDependency("accessor",Ai)),Dn.push(this.getDependency("accessor",oi)),zn.push(hi),Qn.push(Un)}return Promise.all([Promise.all(Fn),Promise.all(Hn),Promise.all(Dn),Promise.all(zn),Promise.all(Qn)]).then(function(ci){for(var ai=ci[0],wi=ci[1],Pi=ci[2],Oi=ci[3],Ri=ci[4],_i=[],Mi=0,$i=ai.length;Mi<$i;Mi++){var vi=ai[Mi],ri=wi[Mi],Ti=Pi[Mi],Bi=Oi[Mi],qi=Ri[Mi];if(vi!==void 0){vi.updateMatrix(),vi.matrixAutoUpdate=!0;var Ii;switch(xn[qi.path]){case xn.weights:Ii=NumberKeyframeTrack;break;case xn.rotation:Ii=QuaternionKeyframeTrack;break;case xn.position:case xn.scale:default:Ii=VectorKeyframeTrack;break}var Ui=vi.name?vi.name:vi.uuid,ho=Bi.interpolation!==void 0?pn[Bi.interpolation]:InterpolateLinear,lo=[];xn[qi.path]===xn.weights?vi.traverse(function(Po){Po.isMesh===!0&&Po.morphTargetInfluences&&lo.push(Po.name?Po.name:Po.uuid)}):lo.push(Ui);var po=Ti.array;if(Ti.normalized){var co;if(po.constructor===Int8Array)co=1/127;else if(po.constructor===Uint8Array)co=1/255;else if(po.constructor==Int16Array)co=1/32767;else if(po.constructor===Uint16Array)co=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var go=new Float32Array(po.length),vo=0,Eo=po.length;vo<Eo;vo++)go[vo]=po[vo]*co;po=go}for(var vo=0,Eo=lo.length;vo<Eo;vo++){var Oo=new Ii(lo[vo]+"."+xn[qi.path],ri.array,po,ho);Bi.interpolation==="CUBICSPLINE"&&(Oo.createInterpolant=function(mi){return new rn(this.times,this.values,this.getValueSize()/3,mi)},Oo.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_i.push(Oo)}}}var Bo=Gn.name?Gn.name:"animation_"+Rn;return new AnimationClip(Bo,void 0,_i)})},Pn.prototype.loadNode=function(Rn){var In=this.json,Gn=this.extensions,Fn=this,Hn=In.meshReferences,Dn=In.meshUses,zn=In.nodes[Rn];return function(){var Qn=[];return zn.mesh!==void 0&&Qn.push(Fn.getDependency("mesh",zn.mesh).then(function(Zn){var si;if(Hn[zn.mesh]>1){var ei=Dn[zn.mesh]++;si=Zn.clone(),si.name+="_instance_"+ei}else si=Zn;return zn.weights!==void 0&&si.traverse(function(hi){if(hi.isMesh)for(var Un=0,Wn=zn.weights.length;Un<Wn;Un++)hi.morphTargetInfluences[Un]=zn.weights[Un]}),si})),zn.camera!==void 0&&Qn.push(Fn.getDependency("camera",zn.camera)),zn.extensions&&zn.extensions[Be.KHR_LIGHTS_PUNCTUAL]&&zn.extensions[Be.KHR_LIGHTS_PUNCTUAL].light!==void 0&&Qn.push(Fn.getDependency("light",zn.extensions[Be.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(Qn)}().then(function(Qn){var Zn;if(zn.isBone===!0?Zn=new Bone:Qn.length>1?Zn=new Group$1:Qn.length===1?Zn=Qn[0]:Zn=new Object3D,Zn!==Qn[0])for(var si=0,ei=Qn.length;si<ei;si++)Zn.add(Qn[si]);if(zn.name&&(Zn.userData.name=zn.name,Zn.name=PropertyBinding.sanitizeNodeName(zn.name)),Cn(Zn,zn),zn.extensions&&gn(Gn,Zn,zn),zn.matrix!==void 0){var hi=new Matrix4;hi.fromArray(zn.matrix),Zn.applyMatrix4(hi)}else zn.translation!==void 0&&Zn.position.fromArray(zn.translation),zn.rotation!==void 0&&Zn.quaternion.fromArray(zn.rotation),zn.scale!==void 0&&Zn.scale.fromArray(zn.scale);return Fn.associations.set(Zn,{type:"nodes",index:Rn}),Zn})},Pn.prototype.loadScene=function(){function Rn(In,Gn,Fn,Hn){var Dn=Fn.nodes[In];return Hn.getDependency("node",In).then(function(zn){if(Dn.skin===void 0)return zn;var Qn;return Hn.getDependency("skin",Dn.skin).then(function(Zn){Qn=Zn;for(var si=[],ei=0,hi=Qn.joints.length;ei<hi;ei++)si.push(Hn.getDependency("node",Qn.joints[ei]));return Promise.all(si)}).then(function(Zn){return zn.traverse(function(si){if(si.isMesh){for(var ei=[],hi=[],Un=0,Wn=Zn.length;Un<Wn;Un++){var Ai=Zn[Un];if(Ai){ei.push(Ai);var oi=new Matrix4;Qn.inverseBindMatrices!==void 0&&oi.fromArray(Qn.inverseBindMatrices.array,Un*16),hi.push(oi)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Qn.joints[Un])}si.bind(new Skeleton(ei,hi),si.matrixWorld)}}),zn})}).then(function(zn){Gn.add(zn);var Qn=[];if(Dn.children)for(var Zn=Dn.children,si=0,ei=Zn.length;si<ei;si++){var hi=Zn[si];Qn.push(Rn(hi,zn,Fn,Hn))}return Promise.all(Qn)})}return function(In){var Gn=this.json,Fn=this.extensions,Hn=this.json.scenes[In],Dn=this,zn=new Group$1;Hn.name&&(zn.name=Hn.name),Cn(zn,Hn),Hn.extensions&&gn(Fn,zn,Hn);for(var Qn=Hn.nodes||[],Zn=[],si=0,ei=Qn.length;si<ei;si++)Zn.push(Rn(Qn[si],zn,Gn,Dn));return Promise.all(Zn).then(function(){return zn})}}(),$e}(),k$e=function($e){Loader.call(this,$e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};k$e.prototype=Object.assign(Object.create(Loader.prototype),{constructor:k$e,setDecoderPath:function($e){return this.decoderPath=$e,this},setDecoderConfig:function($e){return this.decoderConfig=$e,this},setWorkerLimit:function($e){return this.workerLimit=$e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function($e,Se,Be,De){var Ve=new FileLoader(this.manager);Ve.setPath(this.path),Ve.setResponseType("arraybuffer"),this.crossOrigin==="use-credentials"&&Ve.setWithCredentials(!0),Ve.load($e,Fe=>{var Je={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(Fe,Je).then(Se).catch(De)},Be,De)},decodeDracoFile:function($e,Se,Be,De){var Ve={attributeIDs:Be||this.defaultAttributeIDs,attributeTypes:De||this.defaultAttributeTypes,useUniqueIDs:!!Be};this.decodeGeometry($e,Ve).then(Se)},decodeGeometry:function($e,Se){for(var Be in Se.attributeTypes){var De=Se.attributeTypes[Be];De.BYTES_PER_ELEMENT!==void 0&&(Se.attributeTypes[Be]=De.name)}var Ve=JSON.stringify(Se);if(k$e.taskCache.has($e)){var Fe=k$e.taskCache.get($e);if(Fe.key===Ve)return Fe.promise;if($e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var Je,Xe=this.workerNextTaskID++,Ke=$e.byteLength,Ye=this._getWorker(Xe,Ke).then(or=>(Je=or,new Promise((sr,cr)=>{Je._callbacks[Xe]={resolve:sr,reject:cr},Je.postMessage({type:"decode",id:Xe,taskConfig:Se,buffer:$e},[$e])}))).then(or=>this._createGeometry(or.geometry));return Ye.catch(()=>!0).then(()=>{Je&&Xe&&this._releaseTask(Je,Xe)}),k$e.taskCache.set($e,{key:Ve,promise:Ye}),Ye},_createGeometry:function($e){var Se=new BufferGeometry;$e.index&&Se.setIndex(new BufferAttribute($e.index.array,1));for(var Be=0;Be<$e.attributes.length;Be++){var De=$e.attributes[Be],Ve=De.name,Fe=De.array,Je=De.itemSize;Se.setAttribute(Ve,new BufferAttribute(Fe,Je))}return Se},_loadLibrary:function($e,Se){var Be=new FileLoader(this.manager);return Be.setPath(this.decoderPath),Be.setResponseType(Se),new Promise((De,Ve)=>{Be.load($e,De,void 0,Ve)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var $e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",Se=[];return $e?Se.push(this._loadLibrary("draco_decoder.js","text")):(Se.push(this._loadLibrary("draco_wasm_wrapper.js","text")),Se.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(Se).then(Be=>{var De=Be[0];$e||(this.decoderConfig.wasmBinary=Be[1]);var Ve=k$e.DRACOWorker.toString(),Fe=["/* draco decoder */",De,"","/* worker */",Ve.substring(Ve.indexOf("{")+1,Ve.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([Fe]))}),this.decoderPending},_getWorker:function($e,Se){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){var Be=new Worker(this.workerSourceURL);Be._callbacks={},Be._taskCosts={},Be._taskLoad=0,Be.postMessage({type:"init",decoderConfig:this.decoderConfig}),Be.onmessage=function(Ve){var Fe=Ve.data;switch(Fe.type){case"decode":Be._callbacks[Fe.id].resolve(Fe);break;case"error":Be._callbacks[Fe.id].reject(Fe);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+Fe.type+'"')}},this.workerPool.push(Be)}else this.workerPool.sort(function(De,Ve){return De._taskLoad>Ve._taskLoad?-1:1});var Be=this.workerPool[this.workerPool.length-1];return Be._taskCosts[$e]=Se,Be._taskLoad+=Se,Be})},_releaseTask:function($e,Se){$e._taskLoad-=$e._taskCosts[Se],delete $e._callbacks[Se],delete $e._taskCosts[Se]},debug:function(){console.log("Task load: ",this.workerPool.map($e=>$e._taskLoad))},dispose:function(){for(var $e=0;$e<this.workerPool.length;++$e)this.workerPool[$e].terminate();return this.workerPool.length=0,this}});k$e.DRACOWorker=function(){var $e,Se;onmessage=function(Ve){var Fe=Ve.data;switch(Fe.type){case"init":$e=Fe.decoderConfig,Se=new Promise(function(Ke){$e.onModuleLoaded=function(Ye){Ke({draco:Ye})},DracoDecoderModule($e)});break;case"decode":var Je=Fe.buffer,Xe=Fe.taskConfig;Se.then(Ke=>{var Ye=Ke.draco,or=new Ye.Decoder,sr=new Ye.DecoderBuffer;sr.Init(new Int8Array(Je),Je.byteLength);try{var cr=Be(Ye,or,sr,Xe),Br=cr.attributes.map(tn=>tn.array.buffer);cr.index&&Br.push(cr.index.array.buffer),self.postMessage({type:"decode",id:Fe.id,geometry:cr},Br)}catch(tn){console.error(tn),self.postMessage({type:"error",id:Fe.id,error:tn.message})}finally{Ye.destroy(sr),Ye.destroy(or)}});break}};function Be(Ve,Fe,Je,Xe){var Ke=Xe.attributeIDs,Ye=Xe.attributeTypes,or,sr,cr=Fe.GetEncodedGeometryType(Je);if(cr===Ve.TRIANGULAR_MESH)or=new Ve.Mesh,sr=Fe.DecodeBufferToMesh(Je,or);else if(cr===Ve.POINT_CLOUD)or=new Ve.PointCloud,sr=Fe.DecodeBufferToPointCloud(Je,or);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!sr.ok()||or.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+sr.error_msg());var Br={index:null,attributes:[]};for(var tn in Ke){var en=self[Ye[tn]],an,rn;if(Xe.useUniqueIDs)rn=Ke[tn],an=Fe.GetAttributeByUniqueId(or,rn);else{if(rn=Fe.GetAttributeId(or,Ve[Ke[tn]]),rn===-1)continue;an=Fe.GetAttribute(or,rn)}Br.attributes.push(De(Ve,Fe,or,tn,en,an))}if(cr===Ve.TRIANGULAR_MESH){for(var on=or.num_faces(),sn=on*3,ln=new Uint32Array(sn),cn=new Ve.DracoInt32Array,hn=0;hn<on;++hn){Fe.GetFaceFromMesh(or,hn,cn);for(var mn=0;mn<3;++mn)ln[hn*3+mn]=cn.GetValue(mn)}Br.index={array:ln,itemSize:1},Ve.destroy(cn)}return Ve.destroy(or),Br}function De(Ve,Fe,Je,Xe,Ke,Ye){var or=Ye.num_components(),sr=Je.num_points(),cr=sr*or,Br,tn;switch(Ke){case Float32Array:Br=new Ve.DracoFloat32Array,Fe.GetAttributeFloatForAllPoints(Je,Ye,Br),tn=new Float32Array(cr);break;case Int8Array:Br=new Ve.DracoInt8Array,Fe.GetAttributeInt8ForAllPoints(Je,Ye,Br),tn=new Int8Array(cr);break;case Int16Array:Br=new Ve.DracoInt16Array,Fe.GetAttributeInt16ForAllPoints(Je,Ye,Br),tn=new Int16Array(cr);break;case Int32Array:Br=new Ve.DracoInt32Array,Fe.GetAttributeInt32ForAllPoints(Je,Ye,Br),tn=new Int32Array(cr);break;case Uint8Array:Br=new Ve.DracoUInt8Array,Fe.GetAttributeUInt8ForAllPoints(Je,Ye,Br),tn=new Uint8Array(cr);break;case Uint16Array:Br=new Ve.DracoUInt16Array,Fe.GetAttributeUInt16ForAllPoints(Je,Ye,Br),tn=new Uint16Array(cr);break;case Uint32Array:Br=new Ve.DracoUInt32Array,Fe.GetAttributeUInt32ForAllPoints(Je,Ye,Br),tn=new Uint32Array(cr);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var en=0;en<cr;en++)tn[en]=Br.GetValue(en);return Ve.destroy(Br),{name:Xe,array:tn,itemSize:or}}};k$e.taskCache=new WeakMap;k$e.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")};k$e.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")};k$e.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")};k$e.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")};var Ne$1=function($e){CompressedTextureLoader.call(this,$e)};Ne$1.prototype=Object.assign(Object.create(CompressedTextureLoader.prototype),{constructor:Ne$1,parse:function($e,Se){var Be={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},De=542327876,Ve=131072,Fe=512,Je=1024,Xe=2048,Ke=4096,Ye=8192,or=16384,sr=32768,cr=4;function Br(Zn){return Zn.charCodeAt(0)+(Zn.charCodeAt(1)<<8)+(Zn.charCodeAt(2)<<16)+(Zn.charCodeAt(3)<<24)}function tn(Zn){return String.fromCharCode(Zn&255,Zn>>8&255,Zn>>16&255,Zn>>24&255)}function en(Zn,si,ei,hi){for(var Un=ei*hi*4,Wn=new Uint8Array(Zn,si,Un),Ai=new Uint8Array(Un),oi=0,ci=0,ai=0;ai<hi;ai++)for(var wi=0;wi<ei;wi++){var Pi=Wn[ci];ci++;var Oi=Wn[ci];ci++;var Ri=Wn[ci];ci++;var _i=Wn[ci];ci++,Ai[oi]=Ri,oi++,Ai[oi]=Oi,oi++,Ai[oi]=Pi,oi++,Ai[oi]=_i,oi++}return Ai}var an=Br("DXT1"),rn=Br("DXT3"),on=Br("DXT5"),sn=Br("ETC1"),ln=31,cn=0,hn=1,mn=2,An=3,xn=4,pn=7,dn=20,fn=21,yn=22,Sn=23,gn=24,Cn=25,Mn=26,Bn=28,kn=new Int32Array($e,0,ln);if(kn[cn]!==De)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),Be;if(!kn[dn]&cr)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),Be;var Ln,Pn=kn[fn],Vn=!1;switch(Pn){case an:Ln=8,Be.format=RGB_S3TC_DXT1_Format;break;case rn:Ln=16,Be.format=RGBA_S3TC_DXT3_Format;break;case on:Ln=16,Be.format=RGBA_S3TC_DXT5_Format;break;case sn:Ln=8,Be.format=RGB_ETC1_Format;break;default:if(kn[yn]===32&&kn[Sn]&16711680&&kn[gn]&65280&&kn[Cn]&255&&kn[Mn]&4278190080)Vn=!0,Ln=64,Be.format=RGBAFormat;else return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",tn(Pn)),Be}Be.mipmapCount=1,kn[mn]&Ve&&Se!==!1&&(Be.mipmapCount=Math.max(1,kn[pn]));var Yn=kn[Bn];if(Be.isCubemap=!!(Yn&Fe),Be.isCubemap&&(!(Yn&Je)||!(Yn&Xe)||!(Yn&Ke)||!(Yn&Ye)||!(Yn&or)||!(Yn&sr)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),Be;Be.width=kn[xn],Be.height=kn[An];for(var ni=kn[hn]+4,Rn=Be.isCubemap?6:1,In=0;In<Rn;In++)for(var Gn=Be.width,Fn=Be.height,Hn=0;Hn<Be.mipmapCount;Hn++){if(Vn)var zn=en($e,ni,Gn,Fn),Dn=zn.length;else var Dn=Math.max(4,Gn)/4*Math.max(4,Fn)/4*Ln,zn=new Uint8Array($e,ni,Dn);var Qn={data:zn,width:Gn,height:Fn};Be.mipmaps.push(Qn),ni+=Dn,Gn=Math.max(Gn>>1,1),Fn=Math.max(Fn>>1,1)}return Be}});var Qe=function($e){rr(Se,$e);function Se(Be){var De=$e.call(this)||this;return De.needsRender=!0,Be&&Be.children.length&&De.add.apply(De,Be.children),De.mixer=new AnimationMixer(De),De}return Se.prototype.clone=function(){var Be=$e.prototype.clone.call(this,!0),De=new AnimationMixer(Be);return Be.mixer=De,Be.needsRender=!0,Be},Se}(Group$1),Jr="https://vr-public.realsee-cdn.cn/release/static/image/release/five/resource/draco/1.5.6/",$r=function($e){rr(Se,$e);function Se(Be){var De=$e.call(this,Be)||this;return De.ddsLoader=new Ne$1(Be),De.dracoLoader=new k$e(Be),De.dracoLoader.setDecoderPath(Jr),De}return Object.defineProperty(Se,"version",{get:function(){return"6.4.0-alpha.38"},enumerable:!1,configurable:!0}),Se.prototype.load=function(Be,De,Ve,Fe){return $e.prototype.load.call(this,Be,De,Ve,Fe)},Se.prototype.parse=function(Be,De,Ve,Fe){return $e.prototype.parse.call(this,Be,De,function(Je){var Xe=new Qe(Je.scene),Ke=Je.scenes.map(function(Ye){return Ye===Je.scene?Xe:new Qe(Ye)});Ve(Object.assign(Je,{scene:Xe,scenes:Ke}))},Fe)},Se}(qr);const a$g=new $r;function f$u($e){return new Promise((Se,Be)=>{function De(Fe){Se(Fe)}function Ve(Fe){Be(Fe)}a$g.load($e,De,void 0,Ve)})}function i$c($e){if(!$e||$e.length<3)return;const Se=$e.map(t$j),Be=Se[1].clone().sub(Se[0]),De=Se[2].clone().sub(Se[1]);return Be.cross(De)}function J$c($e){Qt$1($e,"svelte-xuejcm",".line.svelte-xuejcm{position:absolute;pointer-events:none}.line.vertical.svelte-xuejcm{transform:rotate(-90deg) translate3d(0.03125rem, 0, 0.625rem);transform-origin:0 0}.line.horizontal.svelte-xuejcm{transform:translate3d(0, -0.03125rem, 0.625rem)}.straight-line.svelte-xuejcm{display:block;width:100%;height:100%;overflow:visible}")}function L$c($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke=$e[3]&&B$g($e);return{c(){Se=K$g("div"),Be=Mt("svg"),De=Mt("defs"),Ve=Mt("linearGradient"),Fe=Mt("stop"),Je=Mt("stop"),Ke&&Ke.c(),te$4(Fe,"offset","25%"),te$4(Fe,"stop-color",$e[5]),te$4(Fe,"stop-opacity","1"),te$4(Je,"offset","100%"),te$4(Je,"stop-color",$e[5]),te$4(Je,"stop-opacity","0.5"),te$4(Ve,"x1",.5),te$4(Ve,"y1",.5),te$4(Ve,"x2",$e[8]),te$4(Ve,"y2",.5),te$4(Ve,"id",$e[10]),te$4(Ve,"gradientUnits","userSpaceOnUse"),te$4(Be,"class","straight-line svelte-xuejcm"),te$4(Be,"viewBox",Xe="0 0 "+$e[8]+" "+$e[7]),te$4(Be,"preserveAspectRatio","none"),te$4(Se,"class","line svelte-xuejcm"),re$2(Se,"vertical",$e[9]),re$2(Se,"horizontal",!$e[9]),ne$5(Se,"width",$e[8]+"px"),ne$5(Se,"height",$e[7]+"px")},m(Ye,or){Nt$1(Ye,Se,or),pt$1(Se,Be),pt$1(Be,De),pt$1(De,Ve),pt$1(Ve,Fe),pt$1(Ve,Je),Ke&&Ke.m(Be,null)},p(Ye,or){or&32&&te$4(Fe,"stop-color",Ye[5]),or&32&&te$4(Je,"stop-color",Ye[5]),or&256&&te$4(Ve,"x2",Ye[8]),Ye[3]?Ke?(Ke.p(Ye,or),or&8&&ot$4(Ke,1)):(Ke=B$g(Ye),Ke.c(),ot$4(Ke,1),Ke.m(Be,null)):Ke&&(Lt$1(),$t(Ke,1,1,()=>{Ke=null}),Ot$2()),or&384&&Xe!==(Xe="0 0 "+Ye[8]+" "+Ye[7])&&te$4(Be,"viewBox",Xe),or&512&&re$2(Se,"vertical",Ye[9]),or&512&&re$2(Se,"horizontal",!Ye[9]),or&256&&ne$5(Se,"width",Ye[8]+"px"),or&128&&ne$5(Se,"height",Ye[7]+"px")},d(Ye){Ye&&J$h(Se),Ke&&Ke.d()}}}function B$g($e){let Se,Be,De,Ve,Fe;return{c(){Se=Mt("path"),te$4(Se,"fill","none"),te$4(Se,"stroke",Be=$e[4]?`url(#${$e[10]})`:$e[5]),te$4(Se,"stroke-width",1),te$4(Se,"d",$e[6])},m(Je,Xe){Nt$1(Je,Se,Xe),Fe=!0},p(Je,Xe){$e=Je,(!Fe||Xe&48&&Be!==(Be=$e[4]?`url(#${$e[10]})`:$e[5]))&&te$4(Se,"stroke",Be),(!Fe||Xe&64)&&te$4(Se,"d",$e[6])},i(Je){Fe||(Je&&z$j(()=>{Fe&&(Ve&&Ve.end(1),De=me$2(Se,I$o,{duration:$e[2],delay:$e[0],easing:Z$a}),De.start())}),Fe=!0)},o(Je){De&&De.invalidate(),Je&&(Ve=ge$6(Se,I$o,{duration:$e[2],delay:$e[1],easing:Z$a})),Fe=!1},d(Je){Je&&J$h(Se),Je&&Ve&&Ve.end()}}}function K$b($e){let Se,Be=$e[8]&&L$c($e);return{c(){Be&&Be.c(),Se=Yt$1()},m(De,Ve){Be&&Be.m(De,Ve),Nt$1(De,Se,Ve)},p(De,[Ve]){De[8]?Be?Be.p(De,Ve):(Be=L$c(De),Be.c(),Be.m(Se.parentNode,Se)):Be&&(Be.d(1),Be=null)},i:N$f,o:N$f,d(De){Be&&Be.d(De),De&&J$h(Se)}}}function P$j($e,Se,Be){let De,Ve,Fe,Je,{inDelay:Xe=0}=Se,{outDelay:Ke=0}=Se,{duration:Ye=1e3}=Se,{unfolded:or}=Se,{length:sr}=Se,{direction:cr="horizontal"}=Se,{useLinearColor:Br=!1}=Se,{color:tn="white"}=Se;const en=r$F();return $e.$$set=an=>{"inDelay"in an&&Be(0,Xe=an.inDelay),"outDelay"in an&&Be(1,Ke=an.outDelay),"duration"in an&&Be(2,Ye=an.duration),"unfolded"in an&&Be(3,or=an.unfolded),"length"in an&&Be(11,sr=an.length),"direction"in an&&Be(12,cr=an.direction),"useLinearColor"in an&&Be(4,Br=an.useLinearColor),"color"in an&&Be(5,tn=an.color)},$e.$$.update=()=>{$e.$$.dirty&4096&&Be(9,De=cr==="vertical"),$e.$$.dirty&2048&&Be(8,Ve=sr),$e.$$.dirty&2048&&Be(6,Je=`M0.5 0.5 H ${sr}`)},Be(7,Fe=1),[Xe,Ke,Ye,or,Br,tn,Je,Fe,Ve,De,en,sr,cr]}let Y$8=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,P$j,K$b,Ft$1,{inDelay:0,outDelay:1,duration:2,unfolded:3,length:11,direction:12,useLinearColor:4,color:5},J$c)}};function K$a($e){Qt$1($e,"svelte-faoauy",".shadow.svelte-faoauy{position:absolute}")}function I$i($e){let Se,Be,De,Ve,Fe;return{c(){Se=K$g("div"),te$4(Se,"class","shadow svelte-faoauy"),te$4(Se,"style",Be=`
      left: ${r$l($e[5])};
      bottom: ${r$l($e[6])};
      border-radius: ${$e[10]?"9999px":"0"};
      box-shadow: 0 0 ${r$l($e[11])} ${r$l($e[12])} rgba(0, 0, 0, ${$e[13]});
      ${$e[8]?"transform: translateX(-50%); left: 50%":""}
      ${$e[9]?"transform: translateX(-50%); top: 50%":""}
      ${$e[7]?"transform: translate(-50%, -50%); left: 50%; top: 50%;":""}
    `),ne$5(Se,"width",r$l($e[3])),ne$5(Se,"height",r$l($e[4])),ne$5(Se,"z-index",$e[14])},m(Je,Xe){Nt$1(Je,Se,Xe),Fe=!0},p(Je,Xe){$e=Je,(!Fe||Xe&16352&&Be!==(Be=`
      left: ${r$l($e[5])};
      bottom: ${r$l($e[6])};
      border-radius: ${$e[10]?"9999px":"0"};
      box-shadow: 0 0 ${r$l($e[11])} ${r$l($e[12])} rgba(0, 0, 0, ${$e[13]});
      ${$e[8]?"transform: translateX(-50%); left: 50%":""}
      ${$e[9]?"transform: translateX(-50%); top: 50%":""}
      ${$e[7]?"transform: translate(-50%, -50%); left: 50%; top: 50%;":""}
    `))&&te$4(Se,"style",Be);const Ke=Xe&16352;(Ke||Xe&16360)&&ne$5(Se,"width",r$l($e[3])),(Ke||Xe&16368)&&ne$5(Se,"height",r$l($e[4])),(Ke||Xe&32736)&&ne$5(Se,"z-index",$e[14])},i(Je){Fe||(Je&&z$j(()=>{Fe&&(Ve&&Ve.end(1),De=me$2(Se,C$i,{duration:$e[0]}),De.start())}),Fe=!0)},o(Je){De&&De.invalidate(),Je&&(Ve=ge$6(Se,C$i,{duration:$e[1]})),Fe=!1},d(Je){Je&&J$h(Se),Je&&Ve&&Ve.end()}}}function L$b($e){let Se,Be=$e[2]&&I$i($e);return{c(){Be&&Be.c(),Se=Yt$1()},m(De,Ve){Be&&Be.m(De,Ve),Nt$1(De,Se,Ve)},p(De,[Ve]){De[2]?Be?(Be.p(De,Ve),Ve&4&&ot$4(Be,1)):(Be=I$i(De),Be.c(),ot$4(Be,1),Be.m(Se.parentNode,Se)):Be&&(Lt$1(),$t(Be,1,1,()=>{Be=null}),Ot$2())},i(De){ot$4(Be)},o(De){$t(Be)},d(De){Be&&Be.d(De),De&&J$h(Se)}}}function r$l($e){return typeof $e=="number"?$e/16+"rem":$e}function M$i($e,Se,Be){let{inDelay:De=1e3}=Se,{outDelay:Ve=1e3}=Se,{visible:Fe=!0}=Se,{width:Je=0}=Se,{height:Xe=0}=Se,{left:Ke=0}=Se,{bottom:Ye=0}=Se,{center:or=!1}=Se,{horizontalCenter:sr=!1}=Se,{verticalCenter:cr=!1}=Se,{round:Br=!1}=Se,{blurRadius:tn}=Se,{spreadRadius:en}=Se,{opacity:an=.15}=Se,{zIndex:rn=-1}=Se;return $e.$$set=on=>{"inDelay"in on&&Be(0,De=on.inDelay),"outDelay"in on&&Be(1,Ve=on.outDelay),"visible"in on&&Be(2,Fe=on.visible),"width"in on&&Be(3,Je=on.width),"height"in on&&Be(4,Xe=on.height),"left"in on&&Be(5,Ke=on.left),"bottom"in on&&Be(6,Ye=on.bottom),"center"in on&&Be(7,or=on.center),"horizontalCenter"in on&&Be(8,sr=on.horizontalCenter),"verticalCenter"in on&&Be(9,cr=on.verticalCenter),"round"in on&&Be(10,Br=on.round),"blurRadius"in on&&Be(11,tn=on.blurRadius),"spreadRadius"in on&&Be(12,en=on.spreadRadius),"opacity"in on&&Be(13,an=on.opacity),"zIndex"in on&&Be(14,rn=on.zIndex)},[De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an,rn]}let T$a=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,M$i,L$b,Ft$1,{inDelay:0,outDelay:1,visible:2,width:3,height:4,left:5,bottom:6,center:7,horizontalCenter:8,verticalCenter:9,round:10,blurRadius:11,spreadRadius:12,opacity:13,zIndex:14},K$a)}};function f$t($e,Se){const[Be,De]=Se;if(Be>=De||De<=1||Be<=1)return-1;const Ve={},Fe=Je=>(Ve[Je]||(Ve[Je]=$e(Je)),Ve[Je]);for(let Je=Be;Je<De;Je++){const Xe=Fe(Je),Ke=Fe(Je-1);if(Xe<Ke)return Je}return-1}function n$g(){return Math.random().toString(36).slice(-6)}const t$5=n$g();function Q$6($e){Qt$1($e,"svelte-1b2n9wi",".text-char.svelte-1b2n9wi{display:inline-block;text-shadow:0.125rem 0rem 0.5rem rgba(0, 0, 0, 0.15)}")}function R$b($e,Se,Be){const De=$e.slice();return De[19]=Se[Be].id,De[0]=Se[Be].content,De[20]=Se,De[21]=Be,De}function Z$7($e){let Se,Be=$e[0]+"",De,Ve=$e[21];const Fe=()=>$e[10](Se,Ve),Je=()=>$e[10](null,Ve);return{c(){Se=K$g("span"),De=gt$2(Be),te$4(Se,"class","text-char svelte-1b2n9wi")},m(Xe,Ke){Nt$1(Xe,Se,Ke),pt$1(Se,De),Fe()},p(Xe,Ke){$e=Xe,Ke&4&&Be!==(Be=$e[0]+"")&&ee$5(De,Be),Ve!==$e[21]&&(Je(),Ve=$e[21],Fe())},d(Xe){Xe&&J$h(Se),Je()}}}function x$i($e){let Se;return{c(){Se=K$g("br")},m(Be,De){Nt$1(Be,Se,De)},p:N$f,d(Be){Be&&J$h(Se)}}}function $$5($e){let Se,Be=$e[21];const De=()=>$e[9](Se,Be),Ve=()=>$e[9](null,Be);return{c(){Se=K$g("span"),Se.textContent=" ",te$4(Se,"class","text-char svelte-1b2n9wi")},m(Fe,Je){Nt$1(Fe,Se,Je),De()},p(Fe,Je){$e=Fe,Be!==$e[21]&&(Ve(),Be=$e[21],De())},d(Fe){Fe&&J$h(Se),Ve()}}}function S$f($e,Se){let Be,De;function Ve(Xe,Ke){return Xe[0]===Xe[3]?$$5:Xe[0]===Xe[4]?x$i:Z$7}let Fe=Ve(Se),Je=Fe(Se);return{key:$e,first:null,c(){Be=Yt$1(),Je.c(),De=Yt$1(),this.first=Be},m(Xe,Ke){Nt$1(Xe,Be,Ke),Je.m(Xe,Ke),Nt$1(Xe,De,Ke)},p(Xe,Ke){Se=Xe,Fe===(Fe=Ve(Se))&&Je?Je.p(Se,Ke):(Je.d(1),Je=Fe(Se),Je&&(Je.c(),Je.m(De.parentNode,De)))},d(Xe){Xe&&J$h(Be),Je.d(Xe),Xe&&J$h(De)}}}function ee$3($e){let Se=[],Be=new Map,De,Ve=$e[2];const Fe=Je=>Je[19];for(let Je=0;Je<Ve.length;Je+=1){let Xe=R$b($e,Ve,Je),Ke=Fe(Xe);Be.set(Ke,Se[Je]=S$f(Ke,Xe))}return{c(){for(let Je=0;Je<Se.length;Je+=1)Se[Je].c();De=Yt$1()},m(Je,Xe){for(let Ke=0;Ke<Se.length;Ke+=1)Se[Ke]&&Se[Ke].m(Je,Xe);Nt$1(Je,De,Xe)},p(Je,[Xe]){Xe&30&&(Ve=Je[2],Se=Ee$2(Se,Xe,Fe,1,Je,Ve,Be,De.parentNode,ke$3,S$f,De,R$b))},i:N$f,o:N$f,d(Je){for(let Xe=0;Xe<Se.length;Xe+=1)Se[Xe].d(Je);Je&&J$h(De)}}}function te$3($e,Se,Be){let De,{inDelay:Ve=0}=Se,{outDelay:Fe=0}=Se,{content:Je}=Se,{unfolded:Xe}=Se,{isFistUnfoldedUpdate:Ke=!0}=Se;const Ye=`__EMOJI_SPLIT_${t$5}__`,or=`__EMOJI_${t$5}__`,sr=`__SPACE_${t$5}__`,cr=`__NEW_LINE_${t$5}__`;let Br,tn,en=[];function an(hn){const mn=[],An=new RegExp(new RegExp("\\p{Regional_Indicator}\\p{Regional_Indicator}|\\p{Emoji}(\\p{Emoji_Modifier}+|\\uFE0F\\u20E3?)?(\\u200D\\p{Emoji}(\\p{Emoji_Modifier}+|\\uFE0F\\u20E3?)?)+|\\p{Emoji_Presentation}(\\p{Emoji_Modifier}+|\\uFE0F\\u20E3?)?|\\p{Emoji}(\\p{Emoji_Modifier}+|\\uFE0F\\u20E3?)","gu"));return hn.slice().replace(An,xn=>`${Ye}${or}${xn}${Ye}`).split(Ye).forEach(xn=>xn.startsWith(or)?mn.push({id:r$F(),content:xn.slice(or.length)}):mn.push(...xn.split("").map(pn=>pn===" "?sr:pn===`
`?cr:pn).map(pn=>({id:r$F(),content:pn})))),mn}function rn(){if(!tn)return;const hn=!Xe;tn.reversed!==hn&&tn.reverse(),tn.play()}function on(hn){if(Ke){Be(5,Ke=!1);return}clearTimeout(Br),Br=setTimeout(rn,hn?Ve:Fe)}function sn(hn){const mn=function(){const An=f$t(xn=>hn[xn].getBoundingClientRect().x,[Math.min(hn.length-1,10),Math.min(hn.length-1,30)]);if(An>0)return An}();tn=x$t({targets:hn.slice(0,mn).filter(i$w),autoplay:!1,duration:400,scale:[.7,1],rotate:[20,0],opacity:[0,1],translateX:[4,0],translateY:[10,0],delay:x$t.stagger(50),easing:"easeInOutCubic"}),Xe&&tn.seek(tn.duration)}function ln(hn,mn){ft$1[hn?"unshift":"push"](()=>{en[mn]=hn,Be(1,en)})}function cn(hn,mn){ft$1[hn?"unshift":"push"](()=>{en[mn]=hn,Be(1,en)})}return $e.$$set=hn=>{"inDelay"in hn&&Be(6,Ve=hn.inDelay),"outDelay"in hn&&Be(7,Fe=hn.outDelay),"content"in hn&&Be(0,Je=hn.content),"unfolded"in hn&&Be(8,Xe=hn.unfolded),"isFistUnfoldedUpdate"in hn&&Be(5,Ke=hn.isFistUnfoldedUpdate)},$e.$$.update=()=>{$e.$$.dirty&1&&Be(2,De=an(Je)),$e.$$.dirty&256&&on(Xe),$e.$$.dirty&2&&sn(en.filter(hn=>!!hn))},[Je,en,De,sr,cr,Ke,Ve,Fe,Xe,ln,cn]}let ae$1=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,te$3,ee$3,Ft$1,{inDelay:6,outDelay:7,content:0,unfolded:8,isFistUnfoldedUpdate:5},Q$6)}};function M$h($e){Qt$1($e,"svelte-1ogmlqq",".arrow.svelte-1ogmlqq{width:100%;height:100%;background-size:100%;transition:transform 400ms ease-in-out;cursor:pointer;pointer-events:auto}.arrow-wrapper.svelte-1ogmlqq{position:relative;width:100%;height:100%}.arrow.left.svelte-1ogmlqq{transform:rotate(0deg)}.arrow.right.svelte-1ogmlqq{transform:rotate(-180deg)}.arrow.top.svelte-1ogmlqq{transform:rotate(90deg)}.arrow.bottom.svelte-1ogmlqq{transform:rotate(-90deg)}")}function h$h($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or;return Be=new T$a({props:{center:!0,blurRadius:9,spreadRadius:3}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),De=Xt$2(),Ve=K$g("div"),te$4(Ve,"class",Fe="arrow "+$e[0]+" svelte-1ogmlqq"),ne$5(Ve,"background-image","url("+A$k+")"),te$4(Se,"class","arrow-wrapper svelte-1ogmlqq")},m(sr,cr){Nt$1(sr,Se,cr),Dt$1(Be,Se,null),pt$1(Se,De),pt$1(Se,Ve),Ke=!0,Ye||(or=lt$2(Ve,"click",$e[5]),Ye=!0)},p(sr,cr){$e=sr,(!Ke||cr&1&&Fe!==(Fe="arrow "+$e[0]+" svelte-1ogmlqq"))&&te$4(Ve,"class",Fe)},i(sr){Ke||(ot$4(Be.$$.fragment,sr),sr&&z$j(()=>{Ke&&(Xe&&Xe.end(1),Je=me$2(Ve,C$i,{duration:$e[2],delay:$e[3],easing:c$w}),Je.start())}),Ke=!0)},o(sr){$t(Be.$$.fragment,sr),Je&&Je.invalidate(),sr&&(Xe=ge$6(Ve,C$i,{duration:$e[2],delay:$e[4],easing:c$w})),Ke=!1},d(sr){sr&&J$h(Se),Rt(Be),sr&&Xe&&Xe.end(),Ye=!1,or()}}}function P$i($e){let Se,Be,De=$e[1]&&h$h($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[1]?De?(De.p(Ve,Fe),Fe&2&&ot$4(De,1)):(De=h$h(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function Q$5($e,Se,Be){let{direction:De="right"}=Se,{visible:Ve=!0}=Se,{duration:Fe=0}=Se,{inDelay:Je=0}=Se,{outDelay:Xe=0}=Se;function Ke(Ye){he$2.call(this,$e,Ye)}return $e.$$set=Ye=>{"direction"in Ye&&Be(0,De=Ye.direction),"visible"in Ye&&Be(1,Ve=Ye.visible),"duration"in Ye&&Be(2,Fe=Ye.duration),"inDelay"in Ye&&Be(3,Je=Ye.inDelay),"outDelay"in Ye&&Be(4,Xe=Ye.outDelay)},[De,Ve,Fe,Je,Xe,Ke]}let Y$7=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,Q$5,P$i,Ft$1,{direction:0,visible:1,duration:2,inDelay:3,outDelay:4},M$h)}};function s$8($e,Se,Be=20,De=5){return new Promise((Ve,Fe)=>{let Je=0;const Xe=setInterval(()=>{const Ke=$e();Se(Ke)?(clearInterval(Xe),Ve(Ke)):Je>=De&&(clearInterval(Xe),Fe(Ke)),Je++},Be)})}function I$h($e){Qt$1($e,"svelte-1fuzm7v",".text.svelte-1fuzm7v{pointer-events:auto;box-sizing:border-box;display:inline-block;max-width:7.5rem;transition:transform 400ms ease-in-out;font-size:0.75rem;line-height:1.125rem;white-space:initial;cursor:pointer}.arrow.svelte-1fuzm7v{pointer-events:auto;display:inline-block;vertical-align:top;width:0.875rem;height:0.875rem;margin-left:0.125rem;margin-top:0.125rem}")}function w$h($e){let Se,Be,De;return Be=new ae$1({props:{unfolded:$e[0],content:$e[1],inDelay:500,outDelay:$e[5]}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","text svelte-1fuzm7v"),ne$5(Se,"transform",$e[7])},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),$e[10](Se),De=!0},p(Ve,Fe){const Je={};Fe&1&&(Je.unfolded=Ve[0]),Fe&2&&(Je.content=Ve[1]),Fe&32&&(Je.outDelay=Ve[5]),Be.$set(Je),Fe&128&&ne$5(Se,"transform",Ve[7])},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be),$e[10](null)}}}function k$d($e){let Se,Be,De;return Be=new Y$7({props:{direction:$e[6],visible:$e[0],inDelay:600,duration:1e3}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","arrow svelte-1fuzm7v")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,Fe){const Je={};Fe&64&&(Je.direction=Ve[6]),Fe&1&&(Je.visible=Ve[0]),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function J$b($e){let Se,Be,De,Ve=$e[1]&&w$h($e),Fe=$e[3]<$e[4]&&k$d($e);return{c(){Ve&&Ve.c(),Se=Xt$2(),Fe&&Fe.c(),Be=Yt$1()},m(Je,Xe){Ve&&Ve.m(Je,Xe),Nt$1(Je,Se,Xe),Fe&&Fe.m(Je,Xe),Nt$1(Je,Be,Xe),De=!0},p(Je,[Xe]){Je[1]?Ve?(Ve.p(Je,Xe),Xe&2&&ot$4(Ve,1)):(Ve=w$h(Je),Ve.c(),ot$4(Ve,1),Ve.m(Se.parentNode,Se)):Ve&&(Lt$1(),$t(Ve,1,1,()=>{Ve=null}),Ot$2()),Je[3]<Je[4]?Fe?(Fe.p(Je,Xe),Xe&24&&ot$4(Fe,1)):(Fe=k$d(Je),Fe.c(),ot$4(Fe,1),Fe.m(Be.parentNode,Be)):Fe&&(Lt$1(),$t(Fe,1,1,()=>{Fe=null}),Ot$2())},i(Je){De||(ot$4(Ve),ot$4(Fe),De=!0)},o(Je){$t(Ve),$t(Fe),De=!1},d(Je){Ve&&Ve.d(Je),Je&&J$h(Se),Fe&&Fe.d(Je),Je&&J$h(Be)}}}function K$9($e,Se,Be){let De,Ve,Fe,{visible:Je=!1}=Se,{textUnfolded:Xe=!1}=Se,{content:Ke}=Se,Ye,or=0,sr=0,cr=0;function Br(tn){ft$1[tn?"unshift":"push"](()=>{Ye=tn,Be(2,Ye)})}return $e.$$set=tn=>{"visible"in tn&&Be(0,Je=tn.visible),"textUnfolded"in tn&&Be(8,Xe=tn.textUnfolded),"content"in tn&&Be(1,Ke=tn.content)},$e.$$.update=()=>{if($e.$$.dirty&7&&Ye&&Je&&Ke){const{lineHeight:tn}=getComputedStyle(Ye);Be(4,cr=Ye.offsetHeight),s$8(()=>Ye?.offsetHeight,Boolean).then(()=>{Be(4,cr=Ye.offsetHeight)}),Be(3,sr=Number(tn.replace("px","")))}$e.$$.dirty&280&&Be(9,or=Xe?sr-cr:0),$e.$$.dirty&512&&Be(7,De=`translateY(${or}px)`),$e.$$.dirty&256&&Be(6,Ve=Xe?"left":"right"),$e.$$.dirty&256&&Be(5,Fe=Xe?450:0)},[Je,Ke,Ye,sr,cr,Fe,Ve,De,Xe,or,Br]}let ie$3=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,K$9,J$b,Ft$1,{visible:0,textUnfolded:8,content:1},I$h)}};function H$h($e){Qt$1($e,"svelte-5hip41",".content.svelte-5hip41{--height:62.4375rem;width:-moz-max-content;width:max-content;height:var(--height);padding:calc(var(--height) - 1.125rem) 0.25rem 0 1rem;position:absolute;left:0;bottom:0;overflow:hidden;box-sizing:border-box;font-size:0;pointer-events:none;white-space:nowrap;font-weight:600}")}function M$g($e){var Se,Be;let De,Ve,Fe,Je,Xe,Ke,Ye,or,sr;return De=new T$a({props:{visible:$e[2],left:$e[3]/2+"px",bottom:12,width:2,blurRadius:120,spreadRadius:60}}),Fe=new Y$8({props:{unfolded:$e[2],length:$e[3],outDelay:$e[4]+40*Math.min((Be=(Se=$e[6][0])==null?void 0:Se.content.length)!=null?Be:10,15),useLinearColor:!0}}),Ke=new ie$3({props:{visible:$e[2],textUnfolded:$e[1],content:$e[5]}}),{c(){Ae$2(De.$$.fragment),Ve=Xt$2(),Ae$2(Fe.$$.fragment),Je=Xt$2(),Xe=K$g("div"),Ae$2(Ke.$$.fragment),te$4(Xe,"class","content svelte-5hip41")},m(cr,Br){Dt$1(De,cr,Br),Nt$1(cr,Ve,Br),Dt$1(Fe,cr,Br),Nt$1(cr,Je,Br),Nt$1(cr,Xe,Br),Dt$1(Ke,Xe,null),Ye=!0,or||(sr=[Jt$2(E$o.call(null,Xe)),lt$2(Xe,"clientWidth",$e[10]),lt$2(Xe,"click",$e[7])],or=!0)},p(cr,Br){var tn,en;const an={};Br&4&&(an.visible=cr[2]),Br&8&&(an.left=cr[3]/2+"px"),De.$set(an);const rn={};Br&4&&(rn.unfolded=cr[2]),Br&8&&(rn.length=cr[3]),Br&16&&(rn.outDelay=cr[4]+40*Math.min((en=(tn=cr[6][0])==null?void 0:tn.content.length)!=null?en:10,15)),Fe.$set(rn);const on={};Br&4&&(on.visible=cr[2]),Br&2&&(on.textUnfolded=cr[1]),Br&32&&(on.content=cr[5]),Ke.$set(on)},i(cr){Ye||(ot$4(De.$$.fragment,cr),ot$4(Fe.$$.fragment,cr),ot$4(Ke.$$.fragment,cr),Ye=!0)},o(cr){$t(De.$$.fragment,cr),$t(Fe.$$.fragment,cr),$t(Ke.$$.fragment,cr),Ye=!1},d(cr){Rt(De,cr),cr&&J$h(Ve),Rt(Fe,cr),cr&&J$h(Je),cr&&J$h(Xe),Rt(Ke),or=!1,M$o(sr)}}}function J$a($e){let Se,Be,De=$e[0].state&&M$g($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[0].state?De?(De.p(Ve,Fe),Fe&1&&ot$4(De,1)):(De=M$g(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function K$8($e,Se,Be){let De,Ve,Fe,Je,Xe,{tag:Ke}=Se,Ye,or=!1,sr=[];function cr(){Be(1,or=!or)}const Br=tn=>{Be(3,Ye=tn.detail)};return $e.$$set=tn=>{"tag"in tn&&Be(0,Ke=tn.tag)},$e.$$.update=()=>{var tn,en,an,rn;$e.$$.dirty&1&&Be(2,De=!!((tn=Ke.state)!=null&&tn.unfolded)),$e.$$.dirty&1&&Be(9,Ve=(an=(en=Ke.data.title)!=null?en:Ke.data.text)!=null?an:""),$e.$$.dirty&1&&Be(8,Fe=(rn=Ke.data.description)!=null?rn:""),$e.$$.dirty&768&&Be(5,Je=(()=>{if(Ve&&Fe)return Ve+`
`+Fe;if(Ve)return Ve;if(Fe)return Fe})()),$e.$$.dirty&4&&(De||setTimeout(()=>{Be(1,or=!1)},20)),$e.$$.dirty&2&&Be(4,Xe=or?450:0)},[Ke,or,De,Ye,Xe,Je,sr,cr,Fe,Ve,Br]}let ut$2=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,K$8,J$a,Ft$1,{tag:0},H$h)}};function e$8($e){return typeof $e=="number"?$e/16+"rem":$e}function D$e($e){Qt$1($e,"svelte-1j0cz4o",'.text.svelte-1j0cz4o{display:-webkit-box;display:-ms-box;display:-moz-box;position:relative;width:-moz-max-content;width:max-content;max-width:100%;-webkit-box-orient:vertical;-ms-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}@keyframes svelte-1j0cz4o-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.caret.svelte-1j0cz4o{position:absolute;width:0.0625rem;height:100%;background-color:#fff;animation:svelte-1j0cz4o-blink 1.2s infinite}.placeholder.svelte-1j0cz4o{opacity:0.5}.placeholder.svelte-1j0cz4o:empty::after{content:" "}')}function F$9($e){let Se;const Be=$e[6].default,De=Bt$1(Be,$e,$e[5],null);return{c(){De&&De.c()},m(Ve,Fe){De&&De.m(Ve,Fe),Se=!0},p(Ve,Fe){De&&De.p&&(!Se||Fe&32)&&It(De,Be,Ve,Ve[5],Se?Ht$2(Be,Ve[5],Fe,null):Ut(Ve[5]),null)},i(Ve){Se||(ot$4(De,Ve),Se=!0)},o(Ve){$t(De,Ve),Se=!1},d(Ve){De&&De.d(Ve)}}}function G$8($e){var Se,Be;let De,Ve,Fe=((Se=$e[3])==null?void 0:Se.inputting)&&v$l(),Je=typeof((Be=$e[3])==null?void 0:Be.placeholder)=="string"&&w$g($e);return{c(){Fe&&Fe.c(),De=Xt$2(),Je&&Je.c(),Ve=Yt$1()},m(Xe,Ke){Fe&&Fe.m(Xe,Ke),Nt$1(Xe,De,Ke),Je&&Je.m(Xe,Ke),Nt$1(Xe,Ve,Ke)},p(Xe,Ke){var Ye,or;(Ye=Xe[3])!=null&&Ye.inputting?Fe||(Fe=v$l(),Fe.c(),Fe.m(De.parentNode,De)):Fe&&(Fe.d(1),Fe=null),typeof((or=Xe[3])==null?void 0:or.placeholder)=="string"?Je?Je.p(Xe,Ke):(Je=w$g(Xe),Je.c(),Je.m(Ve.parentNode,Ve)):Je&&(Je.d(1),Je=null)},i:N$f,o:N$f,d(Xe){Fe&&Fe.d(Xe),Xe&&J$h(De),Je&&Je.d(Xe),Xe&&J$h(Ve)}}}function H$g($e){let Se;return{c(){Se=gt$2($e[2])},m(Be,De){Nt$1(Be,Se,De)},p(Be,De){De&4&&ee$5(Se,Be[2])},i:N$f,o:N$f,d(Be){Be&&J$h(Se)}}}function v$l($e){let Se;return{c(){Se=K$g("div"),te$4(Se,"class","caret svelte-1j0cz4o")},m(Be,De){Nt$1(Be,Se,De)},d(Be){Be&&J$h(Se)}}}function w$g($e){let Se,Be=$e[3].placeholder+"",De;return{c(){Se=K$g("span"),De=gt$2(Be),te$4(Se,"class","placeholder svelte-1j0cz4o")},m(Ve,Fe){Nt$1(Ve,Se,Fe),pt$1(Se,De)},p(Ve,Fe){Fe&8&&Be!==(Be=Ve[3].placeholder+"")&&ee$5(De,Be)},d(Ve){Ve&&J$h(Se)}}}function I$g($e){let Se,Be,De,Ve;const Fe=[H$g,G$8,F$9],Je=[];function Xe(Ke,Ye){return Ke[2]?0:Ke[4]?1:2}return Be=Xe($e),De=Je[Be]=Fe[Be]($e),{c(){Se=K$g("div"),De.c(),te$4(Se,"class","text svelte-1j0cz4o"),ne$5(Se,"max-width",typeof $e[1]=="number"?e$8($e[1]):$e[1]),ne$5(Se,"-webkit-line-clamp",$e[0])},m(Ke,Ye){Nt$1(Ke,Se,Ye),Je[Be].m(Se,null),Ve=!0},p(Ke,[Ye]){let or=Be;Be=Xe(Ke),Be===or?Je[Be].p(Ke,Ye):(Lt$1(),$t(Je[or],1,1,()=>{Je[or]=null}),Ot$2(),De=Je[Be],De?De.p(Ke,Ye):(De=Je[Be]=Fe[Be](Ke),De.c()),ot$4(De,1),De.m(Se,null)),Ye&2&&ne$5(Se,"max-width",typeof Ke[1]=="number"?e$8(Ke[1]):Ke[1]),Ye&1&&ne$5(Se,"-webkit-line-clamp",Ke[0])},i(Ke){Ve||(ot$4(De),Ve=!0)},o(Ke){$t(De),Ve=!1},d(Ke){Ke&&J$h(Se),Je[Be].d()}}}function J$9($e,Se,Be){let De,{$$slots:Ve={},$$scope:Fe}=Se,{maxLine:Je=null}=Se,{maxWidth:Xe=null}=Se,{text:Ke=null}=Se,{edit:Ye=null}=Se;return $e.$$set=or=>{"maxLine"in or&&Be(0,Je=or.maxLine),"maxWidth"in or&&Be(1,Xe=or.maxWidth),"text"in or&&Be(2,Ke=or.text),"edit"in or&&Be(3,Ye=or.edit),"$$scope"in or&&Be(5,Fe=or.$$scope)},$e.$$.update=()=>{$e.$$.dirty&8&&Be(4,De=typeof Ye?.placeholder=="string"||Ye?.inputting)},[Je,Xe,Ke,Ye,De,Fe,Ve]}let P$h=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,J$9,I$g,Ft$1,{maxLine:0,maxWidth:1,text:2,edit:3},D$e)}};function H$f($e){Qt$1($e,"svelte-1oxrkr1",".plane__container.svelte-1oxrkr1.svelte-1oxrkr1{position:absolute;left:50%;transform:translate(-50%, -100%);width:-moz-max-content;width:max-content}.plane__wrapper.svelte-1oxrkr1.svelte-1oxrkr1{transition:transform 500ms linear, opacity 200ms linear;padding:0.625rem;background-color:rgba(0, 0, 0, 0.5);border:0.03125rem solid rgba(255, 255, 255, 0.3);border-radius:0.25rem}.unfolded.svelte-1oxrkr1 .plane__wrapper.svelte-1oxrkr1{transition-delay:200ms, 500ms;opacity:1}.folded.svelte-1oxrkr1 .plane__wrapper.svelte-1oxrkr1{opacity:0}.plane.svelte-1oxrkr1.svelte-1oxrkr1{max-width:11.75rem}.title.svelte-1oxrkr1.svelte-1oxrkr1{white-space:pre-wrap;font-weight:bold;font-size:0.75rem;line-height:1.125rem}.description.svelte-1oxrkr1.svelte-1oxrkr1{margin-top:0.25rem;white-space:pre-wrap;font-size:0.6875rem;line-height:1rem}")}function S$e($e){var Se,Be;let De,Ve,Fe,Je,Xe,Ke,Ye,or,sr;De=new Y$8({props:{unfolded:$e[1],direction:"vertical",length:15,duration:500,inDelay:200,useLinearColor:!0}}),Ye=new P$h({props:{text:$e[4],edit:(Se=$e[0].data.edit)==null?void 0:Se.title,maxLine:$e[2]}});let cr=($e[0].data.description||((Be=$e[0].data.edit)==null?void 0:Be.description))&&q$f($e);return{c(){Ae$2(De.$$.fragment),Ve=Xt$2(),Fe=K$g("div"),Je=K$g("div"),Xe=K$g("div"),Ke=K$g("div"),Ae$2(Ye.$$.fragment),or=Xt$2(),cr&&cr.c(),te$4(Ke,"class","title svelte-1oxrkr1"),te$4(Xe,"class","plane svelte-1oxrkr1"),te$4(Je,"class","plane__wrapper svelte-1oxrkr1"),ne$5(Je,"transform",$e[1]?"translateY(-15px)":"translateY(0)"),te$4(Fe,"class","plane__container svelte-1oxrkr1"),re$2(Fe,"unfolded",$e[1]),re$2(Fe,"folded",$e[5])},m(Br,tn){Dt$1(De,Br,tn),Nt$1(Br,Ve,tn),Nt$1(Br,Fe,tn),pt$1(Fe,Je),pt$1(Je,Xe),pt$1(Xe,Ke),Dt$1(Ye,Ke,null),pt$1(Xe,or),cr&&cr.m(Xe,null),sr=!0},p(Br,tn){var en,an;const rn={};tn&2&&(rn.unfolded=Br[1]),De.$set(rn);const on={};tn&16&&(on.text=Br[4]),tn&1&&(on.edit=(en=Br[0].data.edit)==null?void 0:en.title),tn&4&&(on.maxLine=Br[2]),Ye.$set(on),Br[0].data.description||(an=Br[0].data.edit)!=null&&an.description?cr?(cr.p(Br,tn),tn&1&&ot$4(cr,1)):(cr=q$f(Br),cr.c(),ot$4(cr,1),cr.m(Xe,null)):cr&&(Lt$1(),$t(cr,1,1,()=>{cr=null}),Ot$2()),tn&2&&ne$5(Je,"transform",Br[1]?"translateY(-15px)":"translateY(0)"),(!sr||tn&2)&&re$2(Fe,"unfolded",Br[1]),(!sr||tn&32)&&re$2(Fe,"folded",Br[5])},i(Br){sr||(ot$4(De.$$.fragment,Br),ot$4(Ye.$$.fragment,Br),ot$4(cr),sr=!0)},o(Br){$t(De.$$.fragment,Br),$t(Ye.$$.fragment,Br),$t(cr),sr=!1},d(Br){Rt(De,Br),Br&&J$h(Ve),Br&&J$h(Fe),Rt(Ye),cr&&cr.d()}}}function q$f($e){var Se;let Be,De,Ve;return De=new P$h({props:{text:$e[0].data.description,edit:(Se=$e[0].data.edit)==null?void 0:Se.description,maxLine:$e[3]}}),{c(){Be=K$g("div"),Ae$2(De.$$.fragment),te$4(Be,"class","description svelte-1oxrkr1")},m(Fe,Je){Nt$1(Fe,Be,Je),Dt$1(De,Be,null),Ve=!0},p(Fe,Je){var Xe;const Ke={};Je&1&&(Ke.text=Fe[0].data.description),Je&1&&(Ke.edit=(Xe=Fe[0].data.edit)==null?void 0:Xe.description),Je&8&&(Ke.maxLine=Fe[3]),De.$set(Ke)},i(Fe){Ve||(ot$4(De.$$.fragment,Fe),Ve=!0)},o(Fe){$t(De.$$.fragment,Fe),Ve=!1},d(Fe){Fe&&J$h(Be),Rt(De)}}}function I$f($e){let Se,Be,De=$e[0].state&&S$e($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[0].state?De?(De.p(Ve,Fe),Fe&1&&ot$4(De,1)):(De=S$e(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function J$8($e,Se,Be){let De,Ve,Fe,Je,Xe,{tag:Ke}=Se;return $e.$$set=Ye=>{"tag"in Ye&&Be(0,Ke=Ye.tag)},$e.$$.update=()=>{var Ye,or,sr,cr,Br;$e.$$.dirty&1&&Be(1,De=!!((Ye=Ke.state)!=null&&Ye.unfolded)),$e.$$.dirty&2&&Be(5,Ve=!De),$e.$$.dirty&1&&Be(4,Fe=(sr=(or=Ke.data.title)!=null?or:Ke.data.text)!=null?sr:""),$e.$$.dirty&1&&Be(3,Je=(cr=Ke.data.descriptionMaxRows)!=null?cr:null),$e.$$.dirty&1&&Be(2,Xe=(Br=Ke.data.titleMaxRows)!=null?Br:null)},[Ke,De,Xe,Je,Fe,Ve]}let Z$6=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,J$8,I$f,Ft$1,{tag:0},H$f)}};function v$k($e){let Se,Be;return Se=new Z$6({props:{tag:$e[0]}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=De[0]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function C$a($e){let Se,Be;return Se=new ut$2({props:{tag:$e[0]}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=De[0]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function N$b($e){let Se,Be,De,Ve;const Fe=[C$a,v$k],Je=[];function Xe(Ke,Ye){return Ke[1]==="line"?0:Ke[1]==="plane"?1:-1}return~(Se=Xe($e))&&(Be=Je[Se]=Fe[Se]($e)),{c(){Be&&Be.c(),De=Yt$1()},m(Ke,Ye){~Se&&Je[Se].m(Ke,Ye),Nt$1(Ke,De,Ye),Ve=!0},p(Ke,[Ye]){let or=Se;Se=Xe(Ke),Se===or?~Se&&Je[Se].p(Ke,Ye):(Be&&(Lt$1(),$t(Je[or],1,1,()=>{Je[or]=null}),Ot$2()),~Se?(Be=Je[Se],Be?Be.p(Ke,Ye):(Be=Je[Se]=Fe[Se](Ke),Be.c()),ot$4(Be,1),Be.m(De.parentNode,De)):Be=null)},i(Ke){Ve||(ot$4(Be),Ve=!0)},o(Ke){$t(Be),Ve=!1},d(Ke){~Se&&Je[Se].d(Ke),Ke&&J$h(De)}}}function P$g($e,Se,Be){let De,{tag:Ve}=Se;return $e.$$set=Fe=>{"tag"in Fe&&Be(0,Ve=Fe.tag)},$e.$$.update=()=>{var Fe;$e.$$.dirty&1&&Be(1,De=(Fe=Ve.data.appearance)!=null?Fe:"line")},[Ve,De]}let Y$6=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,P$g,N$b,Ft$1,{tag:0})}};function q$e($e){Qt$1($e,"svelte-blgtit",".line.svelte-blgtit{width:100%;height:100%;overflow:visible;pointer-events:none}")}function y$m($e){let Se,Be,De,Ve;return{c(){Se=Mt("path"),te$4(Se,"fill","none"),te$4(Se,"stroke","url(#"+$e[4]+")"),te$4(Se,"stroke-width","1"),te$4(Se,"d","M0 21 L14 0.5 L105 0.5")},m(Fe,Je){Nt$1(Fe,Se,Je),Ve=!0},p(Fe,Je){$e=Fe},i(Fe){Ve||(Fe&&z$j(()=>{Ve&&(De&&De.end(1),Be=me$2(Se,I$o,{duration:$e[1],delay:$e[0],easing:o$u}),Be.start())}),Ve=!0)},o(Fe){Be&&Be.invalidate(),Fe&&(De=ge$6(Se,I$o,{duration:$e[1],delay:$e[2],easing:c$w})),Ve=!1},d(Fe){Fe&&J$h(Se),Fe&&De&&De.end()}}}function B$f($e){let Se,Be,De,Ve,Fe,Je=$e[3]&&y$m($e);return{c(){Se=Mt("svg"),Be=Mt("defs"),De=Mt("linearGradient"),Ve=Mt("stop"),Fe=Mt("stop"),Je&&Je.c(),te$4(Ve,"offset","25%"),te$4(Ve,"stop-color","white"),te$4(Ve,"stop-opacity","1"),te$4(Fe,"offset","100%"),te$4(Fe,"stop-color","white"),te$4(Fe,"stop-opacity","0.5"),te$4(De,"id",$e[4]),te$4(De,"gradientUnits","userSpaceOnUse"),te$4(Se,"class","line svelte-blgtit"),te$4(Se,"viewBox","0 0 105 21")},m(Xe,Ke){Nt$1(Xe,Se,Ke),pt$1(Se,Be),pt$1(Be,De),pt$1(De,Ve),pt$1(De,Fe),Je&&Je.m(Se,null)},p(Xe,[Ke]){Xe[3]?Je?(Je.p(Xe,Ke),Ke&8&&ot$4(Je,1)):(Je=y$m(Xe),Je.c(),ot$4(Je,1),Je.m(Se,null)):Je&&(Lt$1(),$t(Je,1,1,()=>{Je=null}),Ot$2())},i(Xe){ot$4(Je)},o(Xe){$t(Je)},d(Xe){Xe&&J$h(Se),Je&&Je.d()}}}function C$9($e,Se,Be){let{inDelay:De=0}=Se,{duration:Ve=1e3}=Se,{outDelay:Fe=0}=Se,{unfolded:Je}=Se;const Xe=r$F();return $e.$$set=Ke=>{"inDelay"in Ke&&Be(0,De=Ke.inDelay),"duration"in Ke&&Be(1,Ve=Ke.duration),"outDelay"in Ke&&Be(2,Fe=Ke.outDelay),"unfolded"in Ke&&Be(3,Je=Ke.unfolded)},[De,Ve,Fe,Je,Xe]}let A$h=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,C$9,B$f,Ft$1,{inDelay:0,duration:1,outDelay:2,unfolded:3},q$e)}};function f$s($e){Qt$1($e,"svelte-1mgyhhn",`:root{--sc-dot-size:6px;--sc-active-dot-size:8px;--sc-dot-size-animation-time:250ms}.sc-carousel-dot__dot.svelte-1mgyhhn{background-color:var(--sc-color-rgb-light);border-radius:50%;display:inline-block;opacity:0.5;transition:opacity 100ms ease,\r
      height var(--sc-dot-size-animation-time) ease,\r
      width var(--sc-dot-size-animation-time) ease;cursor:pointer;-webkit-tap-highlight-color:transparent;height:var(--sc-dot-size);width:var(--sc-dot-size)}.sc-carousel-dot__dot.svelte-1mgyhhn:hover{opacity:0.9}.sc-carousel-dot__dot_active.svelte-1mgyhhn{opacity:0.7;height:var(--sc-active-dot-size);width:var(--sc-active-dot-size)}`)}function b$f($e){let Se,Be,De;return{c(){Se=K$g("button"),te$4(Se,"class","sc-carousel-button sc-carousel-dot__dot svelte-1mgyhhn"),re$2(Se,"sc-carousel-dot__dot_active",$e[0])},m(Ve,Fe){Nt$1(Ve,Se,Fe),Be||(De=lt$2(Se,"click",$e[1]),Be=!0)},p(Ve,[Fe]){Fe&1&&re$2(Se,"sc-carousel-dot__dot_active",Ve[0])},i:N$f,o:N$f,d(Ve){Ve&&J$h(Se),Be=!1,De()}}}function y$l($e,Se,Be){let{active:De=!1}=Se;function Ve(Fe){he$2.call(this,$e,Fe)}return $e.$$set=Fe=>{"active"in Fe&&Be(0,De=Fe.active)},[De,Ve]}let k$c=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,y$l,b$f,Ft$1,{active:0},f$s)}};function M$f($e){Qt$1($e,"svelte-670fde",".sc-carousel-dots__container.svelte-670fde{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;padding:0 30px}.sc-carousel-dots__dot-container.svelte-670fde{height:calc(var(--sc-dot-size) + 14px);width:calc(var(--sc-dot-size) + 10px);display:flex;align-items:center;justify-content:center}")}function u$j($e,Se,Be){const De=$e.slice();return De[5]=Se[Be],De[7]=Be,De}function d$n($e,Se){let Be,De,Ve,Fe;function Je(){return Se[3](Se[7])}return De=new k$c({props:{active:Se[1]===Se[7]}}),De.$on("click",Je),{key:$e,first:null,c(){Be=K$g("div"),Ae$2(De.$$.fragment),Ve=Xt$2(),te$4(Be,"class","sc-carousel-dots__dot-container svelte-670fde"),this.first=Be},m(Xe,Ke){Nt$1(Xe,Be,Ke),Dt$1(De,Be,null),pt$1(Be,Ve),Fe=!0},p(Xe,Ke){Se=Xe;const Ye={};Ke&3&&(Ye.active=Se[1]===Se[7]),De.$set(Ye)},i(Xe){Fe||(ot$4(De.$$.fragment,Xe),Fe=!0)},o(Xe){$t(De.$$.fragment,Xe),Fe=!1},d(Xe){Xe&&J$h(Be),Rt(De)}}}function S$d($e){let Se,Be=[],De=new Map,Ve,Fe=Array($e[0]);const Je=Xe=>Xe[7];for(let Xe=0;Xe<Fe.length;Xe+=1){let Ke=u$j($e,Fe,Xe),Ye=Je(Ke);De.set(Ye,Be[Xe]=d$n(Ye,Ke))}return{c(){Se=K$g("div");for(let Xe=0;Xe<Be.length;Xe+=1)Be[Xe].c();te$4(Se,"class","sc-carousel-dots__container svelte-670fde")},m(Xe,Ke){Nt$1(Xe,Se,Ke);for(let Ye=0;Ye<Be.length;Ye+=1)Be[Ye]&&Be[Ye].m(Se,null);Ve=!0},p(Xe,[Ke]){Ke&7&&(Fe=Array(Xe[0]),Lt$1(),Be=Ee$2(Be,Ke,Je,1,Xe,Fe,De,Se,xe,d$n,null,u$j),Ot$2())},i(Xe){if(!Ve){for(let Ke=0;Ke<Fe.length;Ke+=1)ot$4(Be[Ke]);Ve=!0}},o(Xe){for(let Ke=0;Ke<Be.length;Ke+=1)$t(Be[Ke]);Ve=!1},d(Xe){Xe&&J$h(Se);for(let Ke=0;Ke<Be.length;Ke+=1)Be[Ke].d()}}}function B$e($e,Se,Be){const De=fe$4();let{pagesCount:Ve=1}=Se,{currentPageIndex:Fe=0}=Se;function Je(Ke){De("pageChange",Ke)}const Xe=Ke=>Je(Ke);return $e.$$set=Ke=>{"pagesCount"in Ke&&Be(0,Ve=Ke.pagesCount),"currentPageIndex"in Ke&&Be(1,Fe=Ke.currentPageIndex)},[Ve,Fe,Je,Xe]}let H$e=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,B$e,S$d,Ft$1,{pagesCount:0,currentPageIndex:1},M$f)}};const t$4="prev",e$7="next";function z$9($e){Qt$1($e,"svelte-1bftafx",":root{--sc-arrow-size:2px}.sc-carousel-arrow__circle.svelte-1bftafx{width:20px;height:20px;border-radius:50%;background-color:var(--sc-color-rgb-light-50p);display:flex;align-items:center;justify-content:center;transition:opacity 100ms ease;cursor:pointer;-webkit-tap-highlight-color:transparent}.sc-carousel-arrow__circle.svelte-1bftafx:hover{opacity:0.9}.sc-carousel-arrow__arrow.svelte-1bftafx{border:solid var(--sc-color-hex-dark);border-width:0 var(--sc-arrow-size) var(--sc-arrow-size) 0;padding:var(--sc-arrow-size);position:relative}.sc-carousel-arrow__arrow-next.svelte-1bftafx{transform:rotate(-45deg);left:calc(var(--sc-arrow-size) / -2)}.sc-carousel-arrow__arrow-prev.svelte-1bftafx{transform:rotate(135deg);right:calc(var(--sc-arrow-size) / -2)}.sc-carousel-arrow__circle_disabled.svelte-1bftafx,.sc-carousel-arrow__circle_disabled.svelte-1bftafx:hover{opacity:0.5}")}function k$b($e){let Se,Be,De,Ve;return{c(){Se=K$g("button"),Be=K$g("i"),te$4(Be,"class","sc-carousel-arrow__arrow svelte-1bftafx"),re$2(Be,"sc-carousel-arrow__arrow-next",$e[0]===e$7),re$2(Be,"sc-carousel-arrow__arrow-prev",$e[0]===t$4),te$4(Se,"class","sc-carousel-button sc-carousel-arrow__circle svelte-1bftafx"),re$2(Se,"sc-carousel-arrow__circle_disabled",$e[1])},m(Fe,Je){Nt$1(Fe,Se,Je),pt$1(Se,Be),De||(Ve=lt$2(Se,"click",$e[2]),De=!0)},p(Fe,[Je]){Je&1&&re$2(Be,"sc-carousel-arrow__arrow-next",Fe[0]===e$7),Je&1&&re$2(Be,"sc-carousel-arrow__arrow-prev",Fe[0]===t$4),Je&2&&re$2(Se,"sc-carousel-arrow__circle_disabled",Fe[1])},i:N$f,o:N$f,d(Fe){Fe&&J$h(Se),De=!1,Ve()}}}function y$k($e,Se,Be){let{direction:De=e$7}=Se,{disabled:Ve=!1}=Se;function Fe(Je){he$2.call(this,$e,Je)}return $e.$$set=Je=>{"direction"in Je&&Be(0,De=Je.direction),"disabled"in Je&&Be(1,Ve=Je.disabled)},[De,Ve,Fe]}let q$d=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,y$k,k$b,Ft$1,{direction:0,disabled:1},z$9)}};function m$h($e){Qt$1($e,"svelte-i7yfid",".sc-carousel-progress__indicator.svelte-i7yfid{height:100%;background-color:var(--sc-color-hex-dark-50p)}")}function g$n($e){let Se;return{c(){Se=K$g("div"),te$4(Se,"class","sc-carousel-progress__indicator svelte-i7yfid"),ne$5(Se,"width",$e[0]+"%")},m(Be,De){Nt$1(Be,Se,De)},p(Be,[De]){De&1&&ne$5(Se,"width",Be[0]+"%")},i:N$f,o:N$f,d(Be){Be&&J$h(Se)}}}const c$n=100;function y$j($e,Se,Be){let De,{value:Ve=0}=Se;return $e.$$set=Fe=>{"value"in Fe&&Be(1,Ve=Fe.value)},$e.$$.update=()=>{$e.$$.dirty&2&&Be(0,De=Math.min(Math.max(Ve*c$n,0),c$n))},[De,Ve]}let w$f=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,y$j,g$n,Ft$1,{value:1},m$h)}};function n$f($e,Se){$e.addEventListener("mousedown",Se),$e.addEventListener("touchstart",Se,{passive:!0})}function v$j($e,Se){$e.removeEventListener("mousedown",Se),$e.removeEventListener("touchstart",Se)}function o$e($e,Se){$e.addEventListener("mouseup",Se),$e.addEventListener("touchend",Se)}function r$k($e,Se){$e.removeEventListener("mouseup",Se),$e.removeEventListener("touchend",Se)}function i$b($e,Se){$e.addEventListener("mousemove",Se),$e.addEventListener("touchmove",Se)}function d$m($e,Se){$e.removeEventListener("mousemove",Se),$e.removeEventListener("touchmove",Se)}function c$m($e){return function(Se,Be){$e.dispatchEvent(new CustomEvent(Se,{detail:Be}))}}const _$9=110,I$e=9,M$e=111,N$a=20;function f$r($e){if("TouchEvent"in window&&$e instanceof TouchEvent){const Se=$e.touches[0];return{x:Se?Se.clientX:0,y:Se?Se.clientY:0}}return{x:$e.clientX,y:$e.clientY}}function b$e($e,{thresholdProvider:Se}){const Be=c$m($e);let De,Ve,Fe=0,Je,Xe=!1;function Ke(){return Date.now()-Je>=M$e&&Math.abs(Fe)>=N$a}function Ye(cr){Je=Date.now(),Fe=0,Xe=!0;const Br=f$r(cr);De=Br.x,Ve=Br.y,Be("swipeStart",{x:De,y:Ve}),i$b(window,or),o$e(window,sr)}function or(cr){if(!Xe)return;const Br=f$r(cr),tn=Br.x-De,en=Br.y-Ve;De=Br.x,Ve=Br.y,Be("swipeMove",{x:De,y:Ve,dx:tn,dy:en}),tn!==0&&Math.sign(tn)!==Math.sign(Fe)&&(Fe=0),Fe+=tn,Math.abs(Fe)>Se()&&(Be("swipeThresholdReached",{direction:Fe>0?t$4:e$7}),r$k(window,sr),d$m(window,or))}function sr(cr){if(r$k(window,sr),d$m(window,or),Xe=!1,!Ke()){Be("swipeFailed");return}const Br=f$r(cr);Be("swipeEnd",{x:Br.x,y:Br.y})}return n$f($e,Ye),{destroy(){v$j($e,Ye)}}}function t$3($e,Se){$e.addEventListener("mouseenter",Se)}function r$j($e,Se){$e.removeEventListener("mouseenter",Se)}function v$i($e,Se){$e.addEventListener("mouseleave",Se)}function o$d($e,Se){$e.removeEventListener("mouseleave",Se)}function h$g($e){const Se=c$m($e);function Be(){v$i($e,De),Se("hovered",{value:!0})}function De(){Se("hovered",{value:!1}),o$d($e,De)}return t$3($e,Be),{destroy(){r$j($e,Be),o$d($e,De)}}}const s$7=($e,Se)=>{const Be=Se.x-$e.x,De=Se.y-$e.y;return Math.sqrt(Be*Be+De*De)};function r$i($e,Se,Be){return Math.max($e,Math.min(Se,Be))}function n$e($e,Se){$e.addEventListener("touchstart",Se,{passive:!0})}function o$c($e,Se){$e.removeEventListener("touchstart",Se)}function r$h($e,Se){$e.addEventListener("touchend",Se)}function s$6($e,Se){$e.removeEventListener("touchend",Se)}function y$i($e){const Se=c$m($e);let Be=0,De={x:0,y:0};function Ve({tapEndedAt:Xe,tapEndedPos:Ke}){const Ye=Xe-Be,or=s$7(De,Ke);return Ye<=_$9&&or<=I$e}function Fe(Xe){Be=Date.now();const Ke=Xe.touches[0];De={x:Ke.clientX,y:Ke.clientY},r$h($e,Je)}function Je(Xe){s$6($e,Je);const Ke=Xe.changedTouches[0];Ve({tapEndedAt:Date.now(),tapEndedPos:{x:Ke.clientX,y:Ke.clientY}})&&Se("tapped")}return n$e($e,Fe),{destroy(){o$c($e,Fe),s$6($e,Je)}}}function a$f({currentParticleIndex:$e,particlesCount:Se,clonesCountHead:Be,clonesCountTotal:De,particlesToScroll:Ve}){return $e===Se-Be?0:$e===0?g$m({particlesCountWithoutClones:Se-De,particlesToScroll:Ve})-1:Math.floor(($e-Be)/Ve)}function x$h({currentParticleIndex:$e,particlesToScroll:Se}){return Math.ceil($e/Se)}function M$d({currentParticleIndex:$e,particlesCount:Se,clonesCountHead:Be,clonesCountTotal:De,infinite:Ve,particlesToScroll:Fe}){return Ve?a$f({currentParticleIndex:$e,particlesCount:Se,clonesCountHead:Be,clonesCountTotal:De,particlesToScroll:Fe}):x$h({currentParticleIndex:$e,particlesToScroll:Fe})}function g$m({particlesCountWithoutClones:$e,particlesToScroll:Se}){return Math.ceil($e/Se)}function d$l({particlesCountWithoutClones:$e,particlesToScroll:Se,particlesToShow:Be}){const De=m$g({particlesCountWithoutClones:$e,particlesToScroll:Se,particlesToShow:Be});return Math.ceil($e/Se)-De}function h$f({infinite:$e,particlesCountWithoutClones:Se,particlesToScroll:Be,particlesToShow:De}){return $e?g$m({particlesCountWithoutClones:Se,particlesToScroll:Be}):d$l({particlesCountWithoutClones:Se,particlesToScroll:Be,particlesToShow:De})}function I$d({pageIndex:$e,clonesCountHead:Se,clonesCountTail:Be,particlesToScroll:De,particlesCount:Ve}){return r$i(0,Math.min(Se+$e*De,Ve-Be),Ve-1)}function y$h({pageIndex:$e,particlesToScroll:Se,particlesCount:Be,particlesToShow:De}){return r$i(0,Math.min($e*Se,Be-De),Be-1)}function _$8({infinite:$e,pageIndex:Se,clonesCountHead:Be,clonesCountTail:De,particlesToScroll:Ve,particlesCount:Fe,particlesToShow:Je}){return $e?I$d({pageIndex:Se,clonesCountHead:Be,clonesCountTail:De,particlesToScroll:Ve,particlesCount:Fe}):y$h({pageIndex:Se,particlesToScroll:Ve,particlesCount:Fe,particlesToShow:Je})}function c$l({particlesContainerChildren:$e,particleWidth:Se}){for(let Be=0;Be<$e.length;Be++)$e[Be].style.minWidth=`${Se}px`,$e[Be].style.maxWidth=`${Se}px`}function m$g({particlesToScroll:$e,particlesToShow:Se,particlesCountWithoutClones:Be}){const De=$e-Se;let Ve=Se;for(;;){const Fe=Be-Ve-De;if(Fe<Se)return Math.max(Fe,0);Ve+=Se+De}}function z$8($e){return new ResizeObserver(Se=>{$e({width:Se[0].contentRect.width})})}var g$l=Object.defineProperty,p$p=Object.defineProperties,a$e=Object.getOwnPropertyDescriptors,f$q=Object.getOwnPropertySymbols,i$a=Object.prototype.hasOwnProperty,r$g=Object.prototype.propertyIsEnumerable,h$e=($e,Se,Be)=>Se in $e?g$l($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,s$5=($e,Se)=>{for(var Be in Se||(Se={}))i$a.call(Se,Be)&&h$e($e,Be,Se[Be]);if(f$q)for(var Be of f$q(Se))r$g.call(Se,Be)&&h$e($e,Be,Se[Be]);return $e},d$k=($e,Se)=>p$p($e,a$e(Se));function N$9({clonesCountHead:$e,clonesCountTail:Se,particlesContainerChildren:Be}){const De=[];for(let Je=0;Je<Se;Je++)De.push(Be[Je].cloneNode(!0));const Ve=[],Fe=Be.length;for(let Je=Fe-1;Je>Fe-1-$e;Je--)Ve.push(Be[Je].cloneNode(!0));return{clonesToAppend:De,clonesToPrepend:Ve}}function x$g({particlesContainer:$e,clonesToAppend:Se,clonesToPrepend:Be}){for(let De=0;De<Se.length;De++)$e.append(Se[De]);for(let De=0;De<Be.length;De++)$e.prepend(Be[De])}function y$g({infinite:$e,particlesToShow:Se,partialPageSize:Be}){const De=$e?{head:Math.ceil(Be||Se),tail:Math.ceil(Se)}:{head:0,tail:0};return d$k(s$5({},De),{total:De.head+De.tail})}const o$b=($e,Se,Be)=>$e&&$e.hasOwnProperty(Se)?$e[Se]:Be,w$e=$e=>Se=>{$e[Se]&&$e[Se]()};var e$6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$$4="Expected a function",O$c="__lodash_hash_undefined__",D$d="[object Function]",N$8="[object GeneratorFunction]",F$8="[object Symbol]",H$d=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,G$7=/^\w*$/,R$a=/^\./,A$g=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,M$c=/[\\^$.*+?()[\]{}|]/g,K$7=/\\(\\)?/g,L$a=/^\[object .+?Constructor\]$/,z$7=typeof e$6=="object"&&e$6&&e$6.Object===Object&&e$6,U$7=typeof self=="object"&&self&&self.Object===Object&&self,d$j=z$7||U$7||Function("return this")();function q$c($e,Se){return $e?.[Se]}function J$7($e){var Se=!1;if($e!=null&&typeof $e.toString!="function")try{Se=!!($e+"")}catch{}return Se}var V$5=Array.prototype,X$4=Function.prototype,w$d=Object.prototype,l$i=d$j["__core-js_shared__"],m$f=function(){var $e=/[^.]+$/.exec(l$i&&l$i.keys&&l$i.keys.IE_PROTO||"");return $e?"Symbol(src)_1."+$e:""}(),x$f=X$4.toString,_$7=w$d.hasOwnProperty,P$f=w$d.toString,Y$5=RegExp("^"+x$f.call(_$7).replace(M$c,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),v$h=d$j.Symbol,B$d=V$5.splice,Q$4=T$9(d$j,"Map"),u$i=T$9(Object,"create"),C$8=v$h?v$h.prototype:void 0,S$c=C$8?C$8.toString:void 0;function a$d($e){var Se=-1,Be=$e?$e.length:0;for(this.clear();++Se<Be;){var De=$e[Se];this.set(De[0],De[1])}}function W$7(){this.__data__=u$i?u$i(null):{}}function Z$5($e){return this.has($e)&&delete this.__data__[$e]}function k$a($e){var Se=this.__data__;if(u$i){var Be=Se[$e];return Be===O$c?void 0:Be}return _$7.call(Se,$e)?Se[$e]:void 0}function tt$1($e){var Se=this.__data__;return u$i?Se[$e]!==void 0:_$7.call(Se,$e)}function et($e,Se){var Be=this.__data__;return Be[$e]=u$i&&Se===void 0?O$c:Se,this}a$d.prototype.clear=W$7;a$d.prototype.delete=Z$5;a$d.prototype.get=k$a;a$d.prototype.has=tt$1;a$d.prototype.set=et;function i$9($e){var Se=-1,Be=$e?$e.length:0;for(this.clear();++Se<Be;){var De=$e[Se];this.set(De[0],De[1])}}function rt$2(){this.__data__=[]}function nt$2($e){var Se=this.__data__,Be=h$d(Se,$e);if(Be<0)return!1;var De=Se.length-1;return Be==De?Se.pop():B$d.call(Se,Be,1),!0}function at$2($e){var Se=this.__data__,Be=h$d(Se,$e);return Be<0?void 0:Se[Be][1]}function ot$2($e){return h$d(this.__data__,$e)>-1}function it$3($e,Se){var Be=this.__data__,De=h$d(Be,$e);return De<0?Be.push([$e,Se]):Be[De][1]=Se,this}i$9.prototype.clear=rt$2;i$9.prototype.delete=nt$2;i$9.prototype.get=at$2;i$9.prototype.has=ot$2;i$9.prototype.set=it$3;function o$a($e){var Se=-1,Be=$e?$e.length:0;for(this.clear();++Se<Be;){var De=$e[Se];this.set(De[0],De[1])}}function ct$1(){this.__data__={hash:new a$d,map:new(Q$4||i$9),string:new a$d}}function st$1($e){return p$o(this,$e).delete($e)}function ut$1($e){return p$o(this,$e).get($e)}function ft($e){return p$o(this,$e).has($e)}function ht($e,Se){return p$o(this,$e).set($e,Se),this}o$a.prototype.clear=ct$1;o$a.prototype.delete=st$1;o$a.prototype.get=ut$1;o$a.prototype.has=ft;o$a.prototype.set=ht;function h$d($e,Se){for(var Be=$e.length;Be--;)if(St($e[Be][0],Se))return Be;return-1}function pt($e,Se){Se=yt(Se,$e)?[Se]:_t(Se);for(var Be=0,De=Se.length;$e!=null&&Be<De;)$e=$e[vt(Se[Be++])];return Be&&Be==De?$e:void 0}function lt$1($e){if(!E$g($e)||bt($e))return!1;var Se=Ot$1($e)||J$7($e)?Y$5:L$a;return Se.test(Ct($e))}function dt($e){if(typeof $e=="string")return $e;if(g$k($e))return S$c?S$c.call($e):"";var Se=$e+"";return Se=="0"&&1/$e==-1/0?"-0":Se}function _t($e){return I$c($e)?$e:mt($e)}function p$o($e,Se){var Be=$e.__data__;return gt$1(Se)?Be[typeof Se=="string"?"string":"hash"]:Be.map}function T$9($e,Se){var Be=q$c($e,Se);return lt$1(Be)?Be:void 0}function yt($e,Se){if(I$c($e))return!1;var Be=typeof $e;return Be=="number"||Be=="symbol"||Be=="boolean"||$e==null||g$k($e)?!0:G$7.test($e)||!H$d.test($e)||Se!=null&&$e in Object(Se)}function gt$1($e){var Se=typeof $e;return Se=="string"||Se=="number"||Se=="symbol"||Se=="boolean"?$e!=="__proto__":$e===null}function bt($e){return!!m$f&&m$f in $e}var mt=y$f(function($e){$e=wt($e);var Se=[];return R$a.test($e)&&Se.push(""),$e.replace(A$g,function(Be,De,Ve,Fe){Se.push(Ve?Fe.replace(K$7,"$1"):De||Be)}),Se});function vt($e){if(typeof $e=="string"||g$k($e))return $e;var Se=$e+"";return Se=="0"&&1/$e==-1/0?"-0":Se}function Ct($e){if($e!=null){try{return x$f.call($e)}catch{}try{return $e+""}catch{}}return""}function y$f($e,Se){if(typeof $e!="function"||Se&&typeof Se!="function")throw new TypeError($$4);var Be=function(){var De=arguments,Ve=Se?Se.apply(this,De):De[0],Fe=Be.cache;if(Fe.has(Ve))return Fe.get(Ve);var Je=$e.apply(this,De);return Be.cache=Fe.set(Ve,Je),Je};return Be.cache=new(y$f.Cache||o$a),Be}y$f.Cache=o$a;function St($e,Se){return $e===Se||$e!==$e&&Se!==Se}var I$c=Array.isArray;function Ot$1($e){var Se=E$g($e)?P$f.call($e):"";return Se==D$d||Se==N$8}function E$g($e){var Se=typeof $e;return!!$e&&(Se=="object"||Se=="function")}function jt($e){return!!$e&&typeof $e=="object"}function g$k($e){return typeof $e=="symbol"||jt($e)&&P$f.call($e)==F$8}function wt($e){return $e==null?"":dt($e)}function xt($e,Se,Be){var De=$e==null?void 0:pt($e,Se);return De===void 0?Be:De}var Tt=xt,M$b={},pe$2={get exports(){return M$b},set exports($e){M$b=$e}};(function($e,Se){var Be=200,De="__lodash_hash_undefined__",Ve=9007199254740991,Fe="[object Arguments]",Je="[object Array]",Xe="[object Boolean]",Ke="[object Date]",Ye="[object Error]",or="[object Function]",sr="[object GeneratorFunction]",cr="[object Map]",Br="[object Number]",tn="[object Object]",en="[object Promise]",an="[object RegExp]",rn="[object Set]",on="[object String]",sn="[object Symbol]",ln="[object WeakMap]",cn="[object ArrayBuffer]",hn="[object DataView]",mn="[object Float32Array]",An="[object Float64Array]",xn="[object Int8Array]",pn="[object Int16Array]",dn="[object Int32Array]",fn="[object Uint8Array]",yn="[object Uint8ClampedArray]",Sn="[object Uint16Array]",gn="[object Uint32Array]",Cn=/[\\^$.*+?()[\]{}|]/g,Mn=/\w*$/,Bn=/^\[object .+?Constructor\]$/,kn=/^(?:0|[1-9]\d*)$/,Ln={};Ln[Fe]=Ln[Je]=Ln[cn]=Ln[hn]=Ln[Xe]=Ln[Ke]=Ln[mn]=Ln[An]=Ln[xn]=Ln[pn]=Ln[dn]=Ln[cr]=Ln[Br]=Ln[tn]=Ln[an]=Ln[rn]=Ln[on]=Ln[sn]=Ln[fn]=Ln[yn]=Ln[Sn]=Ln[gn]=!0,Ln[Ye]=Ln[or]=Ln[ln]=!1;var Pn=typeof e$6=="object"&&e$6&&e$6.Object===Object&&e$6,Vn=typeof self=="object"&&self&&self.Object===Object&&self,Yn=Pn||Vn||Function("return this")(),ni=Se&&!Se.nodeType&&Se,Rn=ni&&!0&&$e&&!$e.nodeType&&$e,In=Rn&&Rn.exports===ni;function Gn(Tn,qn){return Tn.set(qn[0],qn[1]),Tn}function Fn(Tn,qn){return Tn.add(qn),Tn}function Hn(Tn,qn){for(var li=-1,Ci=Tn?Tn.length:0;++li<Ci&&qn(Tn[li],li,Tn)!==!1;);return Tn}function Dn(Tn,qn){for(var li=-1,Ci=qn.length,wo=Tn.length;++li<Ci;)Tn[wo+li]=qn[li];return Tn}function zn(Tn,qn,li,Ci){var wo=-1,ao=Tn?Tn.length:0;for(Ci;++wo<ao;)li=qn(li,Tn[wo],wo,Tn);return li}function Qn(Tn,qn){for(var li=-1,Ci=Array(Tn);++li<Tn;)Ci[li]=qn(li);return Ci}function Zn(Tn,qn){return Tn?.[qn]}function si(Tn){var qn=!1;if(Tn!=null&&typeof Tn.toString!="function")try{qn=!!(Tn+"")}catch{}return qn}function ei(Tn){var qn=-1,li=Array(Tn.size);return Tn.forEach(function(Ci,wo){li[++qn]=[wo,Ci]}),li}function hi(Tn,qn){return function(li){return Tn(qn(li))}}function Un(Tn){var qn=-1,li=Array(Tn.size);return Tn.forEach(function(Ci){li[++qn]=Ci}),li}var Wn=Array.prototype,Ai=Function.prototype,oi=Object.prototype,ci=Yn["__core-js_shared__"],ai=function(){var Tn=/[^.]+$/.exec(ci&&ci.keys&&ci.keys.IE_PROTO||"");return Tn?"Symbol(src)_1."+Tn:""}(),wi=Ai.toString,Pi=oi.hasOwnProperty,Oi=oi.toString,Ri=RegExp("^"+wi.call(Pi).replace(Cn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_i=In?Yn.Buffer:void 0,Mi=Yn.Symbol,$i=Yn.Uint8Array,vi=hi(Object.getPrototypeOf,Object),ri=Object.create,Ti=oi.propertyIsEnumerable,Bi=Wn.splice,qi=Object.getOwnPropertySymbols,Ii=_i?_i.isBuffer:void 0,Ui=hi(Object.keys,Object),ho=On(Yn,"DataView"),lo=On(Yn,"Map"),po=On(Yn,"Promise"),co=On(Yn,"Set"),go=On(Yn,"WeakMap"),vo=On(Object,"create"),Eo=ea(ho),Oo=ea(lo),Bo=ea(po),Po=ea(co),Kn=ea(go),mi=Mi?Mi.prototype:void 0,gi=mi?mi.valueOf:void 0;function xi(Tn){var qn=-1,li=Tn?Tn.length:0;for(this.clear();++qn<li;){var Ci=Tn[qn];this.set(Ci[0],Ci[1])}}function ki(){this.__data__=vo?vo(null):{}}function Ki(Tn){return this.has(Tn)&&delete this.__data__[Tn]}function Yi(Tn){var qn=this.__data__;if(vo){var li=qn[Tn];return li===De?void 0:li}return Pi.call(qn,Tn)?qn[Tn]:void 0}function ji(Tn){var qn=this.__data__;return vo?qn[Tn]!==void 0:Pi.call(qn,Tn)}function Wi(Tn,qn){var li=this.__data__;return li[Tn]=vo&&qn===void 0?De:qn,this}xi.prototype.clear=ki,xi.prototype.delete=Ki,xi.prototype.get=Yi,xi.prototype.has=ji,xi.prototype.set=Wi;function Gi(Tn){var qn=-1,li=Tn?Tn.length:0;for(this.clear();++qn<li;){var Ci=Tn[qn];this.set(Ci[0],Ci[1])}}function Mo(){this.__data__=[]}function bo(Tn){var qn=this.__data__,li=Xo(qn,Tn);if(li<0)return!1;var Ci=qn.length-1;return li==Ci?qn.pop():Bi.call(qn,li,1),!0}function fo(Tn){var qn=this.__data__,li=Xo(qn,Tn);return li<0?void 0:qn[li][1]}function Hi(Tn){return Xo(this.__data__,Tn)>-1}function eo(Tn,qn){var li=this.__data__,Ci=Xo(li,Tn);return Ci<0?li.push([Tn,qn]):li[Ci][1]=qn,this}Gi.prototype.clear=Mo,Gi.prototype.delete=bo,Gi.prototype.get=fo,Gi.prototype.has=Hi,Gi.prototype.set=eo;function mo(Tn){var qn=-1,li=Tn?Tn.length:0;for(this.clear();++qn<li;){var Ci=Tn[qn];this.set(Ci[0],Ci[1])}}function xo(){this.__data__={hash:new xi,map:new(lo||Gi),string:new xi}}function ro(Tn){return _n(this,Tn).delete(Tn)}function To(Tn){return _n(this,Tn).get(Tn)}function _o(Tn){return _n(this,Tn).has(Tn)}function Ho(Tn,qn){return _n(this,Tn).set(Tn,qn),this}mo.prototype.clear=xo,mo.prototype.delete=ro,mo.prototype.get=To,mo.prototype.has=_o,mo.prototype.set=Ho;function Io(Tn){this.__data__=new Gi(Tn)}function Xa(){this.__data__=new Gi}function Na(Tn){return this.__data__.delete(Tn)}function $o(Tn){return this.__data__.get(Tn)}function qo(Tn){return this.__data__.has(Tn)}function na(Tn,qn){var li=this.__data__;if(li instanceof Gi){var Ci=li.__data__;if(!lo||Ci.length<Be-1)return Ci.push([Tn,qn]),this;li=this.__data__=new mo(Ci)}return li.set(Tn,qn),this}Io.prototype.clear=Xa,Io.prototype.delete=Na,Io.prototype.get=$o,Io.prototype.has=qo,Io.prototype.set=na;function Go(Tn,qn){var li=Ga(Tn)||ns(Tn)?Qn(Tn.length,String):[],Ci=li.length,wo=!!Ci;for(var ao in Tn)Pi.call(Tn,ao)&&!(wo&&(ao=="length"||Co(ao,Ci)))&&li.push(ao);return li}function Jo(Tn,qn,li){var Ci=Tn[qn];(!(Pi.call(Tn,qn)&&As(Ci,li))||li===void 0&&!(qn in Tn))&&(Tn[qn]=li)}function Xo(Tn,qn){for(var li=Tn.length;li--;)if(As(Tn[li][0],qn))return li;return-1}function Do(Tn,qn){return Tn&&ja(qn,tl(qn),Tn)}function ia(Tn,qn,li,Ci,wo,ao,Ro){var Lo;if(Ci&&(Lo=ao?Ci(Tn,wo,ao,Ro):Ci(Tn)),Lo!==void 0)return Lo;if(!ka(Tn))return Tn;var jo=Ga(Tn);if(jo){if(Lo=Si(Tn),!qn)return Ya(Tn,Lo)}else{var ko=pi(Tn),ha=ko==or||ko==sr;if(bs(Tn))return Pa(Tn,qn);if(ko==tn||ko==Fe||ha&&!ao){if(si(Tn))return ao?Tn:{};if(Lo=zi(ha?{}:Tn),!qn)return Nn(Tn,Do(Lo,Tn))}else{if(!Ln[ko])return ao?Tn:{};Lo=no(Tn,ko,ia,qn)}}Ro||(Ro=new Io);var Ca=Ro.get(Tn);if(Ca)return Ca;if(Ro.set(Tn,Lo),!jo)var ta=li?Xn(Tn):tl(Tn);return Hn(ta||Tn,function(pa,ga){ta&&(ga=pa,pa=Tn[ga]),Jo(Lo,ga,ia(pa,qn,li,Ci,ga,Tn,Ro))}),Lo}function va(Tn){return ka(Tn)?ri(Tn):{}}function Ka(Tn,qn,li){var Ci=qn(Tn);return Ga(Tn)?Ci:Dn(Ci,li(Tn))}function Fo(Tn){return Oi.call(Tn)}function sa(Tn){if(!ka(Tn)||la(Tn))return!1;var qn=Ys(Tn)||si(Tn)?Ri:Bn;return qn.test(ea(Tn))}function za(Tn){if(!Zo(Tn))return Ui(Tn);var qn=[];for(var li in Object(Tn))Pi.call(Tn,li)&&li!="constructor"&&qn.push(li);return qn}function Pa(Tn,qn){if(qn)return Tn.slice();var li=new Tn.constructor(Tn.length);return Tn.copy(li),li}function wa(Tn){var qn=new Tn.constructor(Tn.byteLength);return new $i(qn).set(new $i(Tn)),qn}function ma(Tn,qn){var li=qn?wa(Tn.buffer):Tn.buffer;return new Tn.constructor(li,Tn.byteOffset,Tn.byteLength)}function Aa(Tn,qn,li){var Ci=qn?li(ei(Tn),!0):ei(Tn);return zn(Ci,Gn,new Tn.constructor)}function da(Tn){var qn=new Tn.constructor(Tn.source,Mn.exec(Tn));return qn.lastIndex=Tn.lastIndex,qn}function Ia(Tn,qn,li){var Ci=qn?li(Un(Tn),!0):Un(Tn);return zn(Ci,Fn,new Tn.constructor)}function ys(Tn){return gi?Object(gi.call(Tn)):{}}function Ua(Tn,qn){var li=qn?wa(Tn.buffer):Tn.buffer;return new Tn.constructor(li,Tn.byteOffset,Tn.length)}function Ya(Tn,qn){var li=-1,Ci=Tn.length;for(qn||(qn=Array(Ci));++li<Ci;)qn[li]=Tn[li];return qn}function ja(Tn,qn,li,Ci){li||(li={});for(var wo=-1,ao=qn.length;++wo<ao;){var Ro=qn[wo],Lo=void 0;Jo(li,Ro,Lo===void 0?Tn[Ro]:Lo)}return li}function Nn(Tn,qn){return ja(Tn,Jn(Tn),qn)}function Xn(Tn){return Ka(Tn,tl,Jn)}function _n(Tn,qn){var li=Tn.__data__;return Uo(qn)?li[typeof qn=="string"?"string":"hash"]:li.map}function On(Tn,qn){var li=Zn(Tn,qn);return sa(li)?li:void 0}var Jn=qi?hi(qi,Object):Ms,pi=Fo;(ho&&pi(new ho(new ArrayBuffer(1)))!=hn||lo&&pi(new lo)!=cr||po&&pi(po.resolve())!=en||co&&pi(new co)!=rn||go&&pi(new go)!=ln)&&(pi=function(Tn){var qn=Oi.call(Tn),li=qn==tn?Tn.constructor:void 0,Ci=li?ea(li):void 0;if(Ci)switch(Ci){case Eo:return hn;case Oo:return cr;case Bo:return en;case Po:return rn;case Kn:return ln}return qn});function Si(Tn){var qn=Tn.length,li=Tn.constructor(qn);return qn&&typeof Tn[0]=="string"&&Pi.call(Tn,"index")&&(li.index=Tn.index,li.input=Tn.input),li}function zi(Tn){return typeof Tn.constructor=="function"&&!Zo(Tn)?va(vi(Tn)):{}}function no(Tn,qn,li,Ci){var wo=Tn.constructor;switch(qn){case cn:return wa(Tn);case Xe:case Ke:return new wo(+Tn);case hn:return ma(Tn,Ci);case mn:case An:case xn:case pn:case dn:case fn:case yn:case Sn:case gn:return Ua(Tn,Ci);case cr:return Aa(Tn,Ci,li);case Br:case on:return new wo(Tn);case an:return da(Tn);case rn:return Ia(Tn,Ci,li);case sn:return ys(Tn)}}function Co(Tn,qn){return qn=qn??Ve,!!qn&&(typeof Tn=="number"||kn.test(Tn))&&Tn>-1&&Tn%1==0&&Tn<qn}function Uo(Tn){var qn=typeof Tn;return qn=="string"||qn=="number"||qn=="symbol"||qn=="boolean"?Tn!=="__proto__":Tn===null}function la(Tn){return!!ai&&ai in Tn}function Zo(Tn){var qn=Tn&&Tn.constructor,li=typeof qn=="function"&&qn.prototype||oi;return Tn===li}function ea(Tn){if(Tn!=null){try{return wi.call(Tn)}catch{}try{return Tn+""}catch{}}return""}function Za(Tn){return ia(Tn,!0,!0)}function As(Tn,qn){return Tn===qn||Tn!==Tn&&qn!==qn}function ns(Tn){return vl(Tn)&&Pi.call(Tn,"callee")&&(!Ti.call(Tn,"callee")||Oi.call(Tn)==Fe)}var Ga=Array.isArray;function Bs(Tn){return Tn!=null&&Zs(Tn.length)&&!Ys(Tn)}function vl(Tn){return el(Tn)&&Bs(Tn)}var bs=Ii||_s;function Ys(Tn){var qn=ka(Tn)?Oi.call(Tn):"";return qn==or||qn==sr}function Zs(Tn){return typeof Tn=="number"&&Tn>-1&&Tn%1==0&&Tn<=Ve}function ka(Tn){var qn=typeof Tn;return!!Tn&&(qn=="object"||qn=="function")}function el(Tn){return!!Tn&&typeof Tn=="object"}function tl(Tn){return Bs(Tn)?Go(Tn):za(Tn)}function Ms(){return[]}function _s(){return!1}$e.exports=Za})(pe$2,M$b);const ge$5=M$b;var Y$4={},bn={get exports(){return Y$4},set exports($e){Y$4=$e}};(function($e,Se){var Be=200,De="__lodash_hash_undefined__",Ve=1,Fe=2,Je=9007199254740991,Xe="[object Arguments]",Ke="[object Array]",Ye="[object AsyncFunction]",or="[object Boolean]",sr="[object Date]",cr="[object Error]",Br="[object Function]",tn="[object GeneratorFunction]",en="[object Map]",an="[object Number]",rn="[object Null]",on="[object Object]",sn="[object Promise]",ln="[object Proxy]",cn="[object RegExp]",hn="[object Set]",mn="[object String]",An="[object Symbol]",xn="[object Undefined]",pn="[object WeakMap]",dn="[object ArrayBuffer]",fn="[object DataView]",yn="[object Float32Array]",Sn="[object Float64Array]",gn="[object Int8Array]",Cn="[object Int16Array]",Mn="[object Int32Array]",Bn="[object Uint8Array]",kn="[object Uint8ClampedArray]",Ln="[object Uint16Array]",Pn="[object Uint32Array]",Vn=/[\\^$.*+?()[\]{}|]/g,Yn=/^\[object .+?Constructor\]$/,ni=/^(?:0|[1-9]\d*)$/,Rn={};Rn[yn]=Rn[Sn]=Rn[gn]=Rn[Cn]=Rn[Mn]=Rn[Bn]=Rn[kn]=Rn[Ln]=Rn[Pn]=!0,Rn[Xe]=Rn[Ke]=Rn[dn]=Rn[or]=Rn[fn]=Rn[sr]=Rn[cr]=Rn[Br]=Rn[en]=Rn[an]=Rn[on]=Rn[cn]=Rn[hn]=Rn[mn]=Rn[pn]=!1;var In=typeof e$6=="object"&&e$6&&e$6.Object===Object&&e$6,Gn=typeof self=="object"&&self&&self.Object===Object&&self,Fn=In||Gn||Function("return this")(),Hn=Se&&!Se.nodeType&&Se,Dn=Hn&&!0&&$e&&!$e.nodeType&&$e,zn=Dn&&Dn.exports===Hn,Qn=zn&&In.process,Zn=function(){try{return Qn&&Qn.binding&&Qn.binding("util")}catch{}}(),si=Zn&&Zn.isTypedArray;function ei(Tn,qn){for(var li=-1,Ci=Tn==null?0:Tn.length,wo=0,ao=[];++li<Ci;){var Ro=Tn[li];qn(Ro,li,Tn)&&(ao[wo++]=Ro)}return ao}function hi(Tn,qn){for(var li=-1,Ci=qn.length,wo=Tn.length;++li<Ci;)Tn[wo+li]=qn[li];return Tn}function Un(Tn,qn){for(var li=-1,Ci=Tn==null?0:Tn.length;++li<Ci;)if(qn(Tn[li],li,Tn))return!0;return!1}function Wn(Tn,qn){for(var li=-1,Ci=Array(Tn);++li<Tn;)Ci[li]=qn(li);return Ci}function Ai(Tn){return function(qn){return Tn(qn)}}function oi(Tn,qn){return Tn.has(qn)}function ci(Tn,qn){return Tn?.[qn]}function ai(Tn){var qn=-1,li=Array(Tn.size);return Tn.forEach(function(Ci,wo){li[++qn]=[wo,Ci]}),li}function wi(Tn,qn){return function(li){return Tn(qn(li))}}function Pi(Tn){var qn=-1,li=Array(Tn.size);return Tn.forEach(function(Ci){li[++qn]=Ci}),li}var Oi=Array.prototype,Ri=Function.prototype,_i=Object.prototype,Mi=Fn["__core-js_shared__"],$i=Ri.toString,vi=_i.hasOwnProperty,ri=function(){var Tn=/[^.]+$/.exec(Mi&&Mi.keys&&Mi.keys.IE_PROTO||"");return Tn?"Symbol(src)_1."+Tn:""}(),Ti=_i.toString,Bi=RegExp("^"+$i.call(vi).replace(Vn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qi=zn?Fn.Buffer:void 0,Ii=Fn.Symbol,Ui=Fn.Uint8Array,ho=_i.propertyIsEnumerable,lo=Oi.splice,po=Ii?Ii.toStringTag:void 0,co=Object.getOwnPropertySymbols,go=qi?qi.isBuffer:void 0,vo=wi(Object.keys,Object),Eo=Jn(Fn,"DataView"),Oo=Jn(Fn,"Map"),Bo=Jn(Fn,"Promise"),Po=Jn(Fn,"Set"),Kn=Jn(Fn,"WeakMap"),mi=Jn(Object,"create"),gi=ea(Eo),xi=ea(Oo),ki=ea(Bo),Ki=ea(Po),Yi=ea(Kn),ji=Ii?Ii.prototype:void 0,Wi=ji?ji.valueOf:void 0;function Gi(Tn){var qn=-1,li=Tn==null?0:Tn.length;for(this.clear();++qn<li;){var Ci=Tn[qn];this.set(Ci[0],Ci[1])}}function Mo(){this.__data__=mi?mi(null):{},this.size=0}function bo(Tn){var qn=this.has(Tn)&&delete this.__data__[Tn];return this.size-=qn?1:0,qn}function fo(Tn){var qn=this.__data__;if(mi){var li=qn[Tn];return li===De?void 0:li}return vi.call(qn,Tn)?qn[Tn]:void 0}function Hi(Tn){var qn=this.__data__;return mi?qn[Tn]!==void 0:vi.call(qn,Tn)}function eo(Tn,qn){var li=this.__data__;return this.size+=this.has(Tn)?0:1,li[Tn]=mi&&qn===void 0?De:qn,this}Gi.prototype.clear=Mo,Gi.prototype.delete=bo,Gi.prototype.get=fo,Gi.prototype.has=Hi,Gi.prototype.set=eo;function mo(Tn){var qn=-1,li=Tn==null?0:Tn.length;for(this.clear();++qn<li;){var Ci=Tn[qn];this.set(Ci[0],Ci[1])}}function xo(){this.__data__=[],this.size=0}function ro(Tn){var qn=this.__data__,li=Pa(qn,Tn);if(li<0)return!1;var Ci=qn.length-1;return li==Ci?qn.pop():lo.call(qn,li,1),--this.size,!0}function To(Tn){var qn=this.__data__,li=Pa(qn,Tn);return li<0?void 0:qn[li][1]}function _o(Tn){return Pa(this.__data__,Tn)>-1}function Ho(Tn,qn){var li=this.__data__,Ci=Pa(li,Tn);return Ci<0?(++this.size,li.push([Tn,qn])):li[Ci][1]=qn,this}mo.prototype.clear=xo,mo.prototype.delete=ro,mo.prototype.get=To,mo.prototype.has=_o,mo.prototype.set=Ho;function Io(Tn){var qn=-1,li=Tn==null?0:Tn.length;for(this.clear();++qn<li;){var Ci=Tn[qn];this.set(Ci[0],Ci[1])}}function Xa(){this.size=0,this.__data__={hash:new Gi,map:new(Oo||mo),string:new Gi}}function Na(Tn){var qn=On(this,Tn).delete(Tn);return this.size-=qn?1:0,qn}function $o(Tn){return On(this,Tn).get(Tn)}function qo(Tn){return On(this,Tn).has(Tn)}function na(Tn,qn){var li=On(this,Tn),Ci=li.size;return li.set(Tn,qn),this.size+=li.size==Ci?0:1,this}Io.prototype.clear=Xa,Io.prototype.delete=Na,Io.prototype.get=$o,Io.prototype.has=qo,Io.prototype.set=na;function Go(Tn){var qn=-1,li=Tn==null?0:Tn.length;for(this.__data__=new Io;++qn<li;)this.add(Tn[qn])}function Jo(Tn){return this.__data__.set(Tn,De),this}function Xo(Tn){return this.__data__.has(Tn)}Go.prototype.add=Go.prototype.push=Jo,Go.prototype.has=Xo;function Do(Tn){var qn=this.__data__=new mo(Tn);this.size=qn.size}function ia(){this.__data__=new mo,this.size=0}function va(Tn){var qn=this.__data__,li=qn.delete(Tn);return this.size=qn.size,li}function Ka(Tn){return this.__data__.get(Tn)}function Fo(Tn){return this.__data__.has(Tn)}function sa(Tn,qn){var li=this.__data__;if(li instanceof mo){var Ci=li.__data__;if(!Oo||Ci.length<Be-1)return Ci.push([Tn,qn]),this.size=++li.size,this;li=this.__data__=new Io(Ci)}return li.set(Tn,qn),this.size=li.size,this}Do.prototype.clear=ia,Do.prototype.delete=va,Do.prototype.get=Ka,Do.prototype.has=Fo,Do.prototype.set=sa;function za(Tn,qn){var li=ns(Tn),Ci=!li&&As(Tn),wo=!li&&!Ci&&Bs(Tn),ao=!li&&!Ci&&!wo&&el(Tn),Ro=li||Ci||wo||ao,Lo=Ro?Wn(Tn.length,String):[],jo=Lo.length;for(var ko in Tn)vi.call(Tn,ko)&&!(Ro&&(ko=="length"||wo&&(ko=="offset"||ko=="parent")||ao&&(ko=="buffer"||ko=="byteLength"||ko=="byteOffset")||no(ko,jo)))&&Lo.push(ko);return Lo}function Pa(Tn,qn){for(var li=Tn.length;li--;)if(Za(Tn[li][0],qn))return li;return-1}function wa(Tn,qn,li){var Ci=qn(Tn);return ns(Tn)?Ci:hi(Ci,li(Tn))}function ma(Tn){return Tn==null?Tn===void 0?xn:rn:po&&po in Object(Tn)?pi(Tn):Zo(Tn)}function Aa(Tn){return ka(Tn)&&ma(Tn)==Xe}function da(Tn,qn,li,Ci,wo){return Tn===qn?!0:Tn==null||qn==null||!ka(Tn)&&!ka(qn)?Tn!==Tn&&qn!==qn:Ia(Tn,qn,li,Ci,da,wo)}function Ia(Tn,qn,li,Ci,wo,ao){var Ro=ns(Tn),Lo=ns(qn),jo=Ro?Ke:zi(Tn),ko=Lo?Ke:zi(qn);jo=jo==Xe?on:jo,ko=ko==Xe?on:ko;var ha=jo==on,Ca=ko==on,ta=jo==ko;if(ta&&Bs(Tn)){if(!Bs(qn))return!1;Ro=!0,ha=!1}if(ta&&!ha)return ao||(ao=new Do),Ro||el(Tn)?ja(Tn,qn,li,Ci,wo,ao):Nn(Tn,qn,jo,li,Ci,wo,ao);if(!(li&Ve)){var pa=ha&&vi.call(Tn,"__wrapped__"),ga=Ca&&vi.call(qn,"__wrapped__");if(pa||ga){var ua=pa?Tn.value():Tn,Ra=ga?qn.value():qn;return ao||(ao=new Do),wo(ua,Ra,li,Ci,ao)}}return ta?(ao||(ao=new Do),Xn(Tn,qn,li,Ci,wo,ao)):!1}function ys(Tn){if(!Zs(Tn)||Uo(Tn))return!1;var qn=bs(Tn)?Bi:Yn;return qn.test(ea(Tn))}function Ua(Tn){return ka(Tn)&&Ys(Tn.length)&&!!Rn[ma(Tn)]}function Ya(Tn){if(!la(Tn))return vo(Tn);var qn=[];for(var li in Object(Tn))vi.call(Tn,li)&&li!="constructor"&&qn.push(li);return qn}function ja(Tn,qn,li,Ci,wo,ao){var Ro=li&Ve,Lo=Tn.length,jo=qn.length;if(Lo!=jo&&!(Ro&&jo>Lo))return!1;var ko=ao.get(Tn);if(ko&&ao.get(qn))return ko==qn;var ha=-1,Ca=!0,ta=li&Fe?new Go:void 0;for(ao.set(Tn,qn),ao.set(qn,Tn);++ha<Lo;){var pa=Tn[ha],ga=qn[ha];if(Ci)var ua=Ro?Ci(ga,pa,ha,qn,Tn,ao):Ci(pa,ga,ha,Tn,qn,ao);if(ua!==void 0){if(ua)continue;Ca=!1;break}if(ta){if(!Un(qn,function(Ra,ds){if(!oi(ta,ds)&&(pa===Ra||wo(pa,Ra,li,Ci,ao)))return ta.push(ds)})){Ca=!1;break}}else if(!(pa===ga||wo(pa,ga,li,Ci,ao))){Ca=!1;break}}return ao.delete(Tn),ao.delete(qn),Ca}function Nn(Tn,qn,li,Ci,wo,ao,Ro){switch(li){case fn:if(Tn.byteLength!=qn.byteLength||Tn.byteOffset!=qn.byteOffset)return!1;Tn=Tn.buffer,qn=qn.buffer;case dn:return!(Tn.byteLength!=qn.byteLength||!ao(new Ui(Tn),new Ui(qn)));case or:case sr:case an:return Za(+Tn,+qn);case cr:return Tn.name==qn.name&&Tn.message==qn.message;case cn:case mn:return Tn==qn+"";case en:var Lo=ai;case hn:var jo=Ci&Ve;if(Lo||(Lo=Pi),Tn.size!=qn.size&&!jo)return!1;var ko=Ro.get(Tn);if(ko)return ko==qn;Ci|=Fe,Ro.set(Tn,qn);var ha=ja(Lo(Tn),Lo(qn),Ci,wo,ao,Ro);return Ro.delete(Tn),ha;case An:if(Wi)return Wi.call(Tn)==Wi.call(qn)}return!1}function Xn(Tn,qn,li,Ci,wo,ao){var Ro=li&Ve,Lo=_n(Tn),jo=Lo.length,ko=_n(qn),ha=ko.length;if(jo!=ha&&!Ro)return!1;for(var Ca=jo;Ca--;){var ta=Lo[Ca];if(!(Ro?ta in qn:vi.call(qn,ta)))return!1}var pa=ao.get(Tn);if(pa&&ao.get(qn))return pa==qn;var ga=!0;ao.set(Tn,qn),ao.set(qn,Tn);for(var ua=Ro;++Ca<jo;){ta=Lo[Ca];var Ra=Tn[ta],ds=qn[ta];if(Ci)var Ds=Ro?Ci(ds,Ra,ta,qn,Tn,ao):Ci(Ra,ds,ta,Tn,qn,ao);if(!(Ds===void 0?Ra===ds||wo(Ra,ds,li,Ci,ao):Ds)){ga=!1;break}ua||(ua=ta=="constructor")}if(ga&&!ua){var ml=Tn.constructor,ks=qn.constructor;ml!=ks&&"constructor"in Tn&&"constructor"in qn&&!(typeof ml=="function"&&ml instanceof ml&&typeof ks=="function"&&ks instanceof ks)&&(ga=!1)}return ao.delete(Tn),ao.delete(qn),ga}function _n(Tn){return wa(Tn,tl,Si)}function On(Tn,qn){var li=Tn.__data__;return Co(qn)?li[typeof qn=="string"?"string":"hash"]:li.map}function Jn(Tn,qn){var li=ci(Tn,qn);return ys(li)?li:void 0}function pi(Tn){var qn=vi.call(Tn,po),li=Tn[po];try{Tn[po]=void 0;var Ci=!0}catch{}var wo=Ti.call(Tn);return Ci&&(qn?Tn[po]=li:delete Tn[po]),wo}var Si=co?function(Tn){return Tn==null?[]:(Tn=Object(Tn),ei(co(Tn),function(qn){return ho.call(Tn,qn)}))}:Ms,zi=ma;(Eo&&zi(new Eo(new ArrayBuffer(1)))!=fn||Oo&&zi(new Oo)!=en||Bo&&zi(Bo.resolve())!=sn||Po&&zi(new Po)!=hn||Kn&&zi(new Kn)!=pn)&&(zi=function(Tn){var qn=ma(Tn),li=qn==on?Tn.constructor:void 0,Ci=li?ea(li):"";if(Ci)switch(Ci){case gi:return fn;case xi:return en;case ki:return sn;case Ki:return hn;case Yi:return pn}return qn});function no(Tn,qn){return qn=qn??Je,!!qn&&(typeof Tn=="number"||ni.test(Tn))&&Tn>-1&&Tn%1==0&&Tn<qn}function Co(Tn){var qn=typeof Tn;return qn=="string"||qn=="number"||qn=="symbol"||qn=="boolean"?Tn!=="__proto__":Tn===null}function Uo(Tn){return!!ri&&ri in Tn}function la(Tn){var qn=Tn&&Tn.constructor,li=typeof qn=="function"&&qn.prototype||_i;return Tn===li}function Zo(Tn){return Ti.call(Tn)}function ea(Tn){if(Tn!=null){try{return $i.call(Tn)}catch{}try{return Tn+""}catch{}}return""}function Za(Tn,qn){return Tn===qn||Tn!==Tn&&qn!==qn}var As=Aa(function(){return arguments}())?Aa:function(Tn){return ka(Tn)&&vi.call(Tn,"callee")&&!ho.call(Tn,"callee")},ns=Array.isArray;function Ga(Tn){return Tn!=null&&Ys(Tn.length)&&!bs(Tn)}var Bs=go||_s;function vl(Tn,qn){return da(Tn,qn)}function bs(Tn){if(!Zs(Tn))return!1;var qn=ma(Tn);return qn==Br||qn==tn||qn==Ye||qn==ln}function Ys(Tn){return typeof Tn=="number"&&Tn>-1&&Tn%1==0&&Tn<=Je}function Zs(Tn){var qn=typeof Tn;return Tn!=null&&(qn=="object"||qn=="function")}function ka(Tn){return Tn!=null&&typeof Tn=="object"}var el=si?Ai(si):Ua;function tl(Tn){return Ga(Tn)?za(Tn):Ya(Tn)}function Ms(){return[]}function _s(){return!1}$e.exports=vl})(bn,Y$4);const wn=Y$4,p$n=($e,Se)=>wn($e,Se),c$k=$e=>Object.keys($e||{}),u$h=($e,Se)=>{const Be={};return $e.forEach(De=>{Be[De]=Se[De]}),Be},m$e=()=>{const $e={},Se=(Be,De)=>{const{watcherName:Ve,fn:Fe}=Be,{prop:Je,value:Xe}=De;$e[Ve]||($e[Ve]={deps:{},fn:Fe}),$e[Ve].deps[Je]=Xe};return{subscribers:$e,subscribe(Be,De){Be&&Se(Be,De)},notify(Be,De){Object.entries($e).forEach(([Ve,{deps:Fe,fn:Je}])=>{const Xe=c$k(Fe);if(Xe.includes(De)){const Ke=u$h(Xe,Be);p$n(Fe,Ke)||($e[Ve].deps=Ke,Je())}})}}},a$c=()=>{let $e=null;return{targetWatcher(Se,Be){$e={watcherName:Se,fn:Be},$e.fn(),$e=null},getTarget(){return $e}}};function E$f($e,Se){const Be=Tt($e,"data",{}),De=Tt($e,"watch",{}),Ve=Tt($e,"methods",{}),Fe=Tt(Se,"onChange",()=>{}),{subscribe:Je,notify:Xe,subscribers:Ke}=m$e(),{targetWatcher:Ye,getTarget:or}=a$c();let sr;const cr={},Br=()=>({data:sr,methods:cr});let tn=!1;const en=rn=>(...on)=>{tn=!0;const sn=rn(...on);return tn=!1,sn};Object.entries(Ve).forEach(([rn,on])=>{cr[rn]=en((...sn)=>on(Br(),...sn)),Object.defineProperty(cr[rn],"name",{value:rn})}),sr=new Proxy(ge$5(Be),{get(rn,on){return or()&&!tn&&Je(or(),{prop:on,value:rn[on]}),Reflect.get(...arguments)},set(rn,on,sn){return rn[on]===sn||(Reflect.set(...arguments),or()||(Fe&&Fe(on,sn),Xe(sr,on))),!0}}),Object.entries(De).forEach(([rn,on])=>{Ye(rn,()=>{on(Br())})});const an=[sr,cr];return an._internal={_getSubscribers(){return Ke}},an}function l$h({pageIndex:$e,particlesToShow:Se,particlesToScroll:Be,particlesCount:De}){const Ve=$e===0?0:Se-Be,Fe=$e*Se-$e*Ve,Je=Fe+Math.max(Se,Be)-1,Xe=[];for(let Ke=Fe;Ke<=Math.min(De-1,Je);Ke++)Xe.push(Ke);return Xe}function h$c({infinite:$e,pageIndex:Se,pagesCount:Be,particlesCount:De,particlesToShow:Ve,particlesToScroll:Fe}){const Je=r$i(0,Se,Be-1);let Xe=Je-1,Ke=Je+1;Xe=$e?Xe<0?Be-1:Xe:Math.max(0,Xe),Ke=$e?Ke>Be-1?0:Ke:Math.min(Be-1,Ke);const Ye=[...new Set([Xe,Je,Ke,0,Be-1])].sort((sr,cr)=>sr-cr),or=Ye.flatMap(sr=>l$h({pageIndex:sr,particlesToShow:Ve,particlesToScroll:Fe,particlesCount:De}));return{pageIndexes:Ye,particleIndexes:[...new Set(or)].sort((sr,cr)=>sr-cr)}}const r$f=($e,Se)=>($e(),setInterval($e,Se));var h$b=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const g$j=35,l$g=1;let P$e=class{constructor({onProgressValueChange:Se}){this._onProgressValueChange=Se,this._autoplayDuration,this._onProgressValueChange,this._interval,this._paused=!1}setAutoplayDuration(Se){this._autoplayDuration=Se}start(Se){return new Promise(Be=>{this.reset();const De=Math.min(g$j,Math.max(this._autoplayDuration,1));let Ve=-De;this._interval=r$f(()=>h$b(this,null,function*(){if(this._paused)return;Ve+=De;const Fe=Ve/this._autoplayDuration;this._onProgressValueChange(Fe),Fe>l$g&&(this.reset(),yield Se(),Be())}),De)})}pause(){this._paused=!0}resume(){this._paused=!1}reset(){clearInterval(this._interval),this._onProgressValueChange(l$g)}};var i$8=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});function A$f($e){const Se=new P$e({onProgressValueChange:Fe=>{$e("progressValue",1-Fe)}}),Be=E$f({data:{particlesCountWithoutClones:0,particlesToShow:1,particlesToShowInit:1,particlesToScroll:1,particlesToScrollInit:1,particlesCount:1,currentParticleIndex:1,infinite:!1,autoplayDuration:1e3,clonesCountHead:0,clonesCountTail:0,clonesCountTotal:0,partialPageSize:1,currentPageIndex:1,pagesCount:1,pauseOnFocus:!1,focused:!1,autoplay:!1,autoplayDirection:"next",disabled:!1,durationMsInit:1e3,durationMs:1e3,offset:0,particleWidth:0,loaded:[]},watch:{setLoaded({data:Fe}){Fe.loaded=h$c({infinite:Fe.infinite,pageIndex:Fe.currentPageIndex,pagesCount:Fe.pagesCount,particlesCount:Fe.particlesCountWithoutClones,particlesToShow:Fe.particlesToShow,particlesToScroll:Fe.particlesToScroll}).particleIndexes},setCurrentPageIndex({data:Fe}){Fe.currentPageIndex=M$d({currentParticleIndex:Fe.currentParticleIndex,particlesCount:Fe.particlesCount,clonesCountHead:Fe.clonesCountHead,clonesCountTotal:Fe.clonesCountTotal,infinite:Fe.infinite,particlesToScroll:Fe.particlesToScroll})},setPartialPageSize({data:Fe}){Fe.partialPageSize=m$g({particlesToScroll:Fe.particlesToScroll,particlesToShow:Fe.particlesToShow,particlesCountWithoutClones:Fe.particlesCountWithoutClones})},setClonesCount({data:Fe}){const{head:Je,tail:Xe}=y$g({infinite:Fe.infinite,particlesToShow:Fe.particlesToShow,partialPageSize:Fe.partialPageSize});Fe.clonesCountHead=Je,Fe.clonesCountTail=Xe,Fe.clonesCountTotal=Je+Xe},setProgressManagerAutoplayDuration({data:Fe}){Se.setAutoplayDuration(Fe.autoplayDuration)},toggleProgressManager({data:{pauseOnFocus:Fe,focused:Je}}){Fe&&(Je?Se.pause():Se.resume())},initDuration({data:Fe}){Fe.durationMs=Fe.durationMsInit},applyAutoplay({data:Fe,methods:{_applyAutoplayIfNeeded:Je}}){Fe.autoplay&&Je(Fe.autoplay)},setPagesCount({data:Fe}){Fe.pagesCount=h$f({infinite:Fe.infinite,particlesCountWithoutClones:Fe.particlesCountWithoutClones,particlesToScroll:Fe.particlesToScroll,particlesToShow:Fe.particlesToShow})},setParticlesToShow({data:Fe}){Fe.particlesToShow=r$i(1,Fe.particlesToShowInit,Fe.particlesCountWithoutClones)},setParticlesToScroll({data:Fe}){Fe.particlesToScroll=r$i(1,Fe.particlesToScrollInit,Fe.particlesCountWithoutClones)}},methods:{_prev({data:Fe}){Fe.currentParticleIndex=_$8({infinite:Fe.infinite,pageIndex:Fe.currentPageIndex-1,clonesCountHead:Fe.clonesCountHead,clonesCountTail:Fe.clonesCountTail,particlesToScroll:Fe.particlesToScroll,particlesCount:Fe.particlesCount,particlesToShow:Fe.particlesToShow})},_next({data:Fe}){Fe.currentParticleIndex=_$8({infinite:Fe.infinite,pageIndex:Fe.currentPageIndex+1,clonesCountHead:Fe.clonesCountHead,clonesCountTail:Fe.clonesCountTail,particlesToScroll:Fe.particlesToScroll,particlesCount:Fe.particlesCount,particlesToShow:Fe.particlesToShow})},_moveToParticle({data:Fe},Je){Fe.currentParticleIndex=r$i(0,Je,Fe.particlesCount-1)},toggleFocused({data:Fe}){Fe.focused=!Fe.focused},_applyAutoplayIfNeeded(Fe){return i$8(this,arguments,function*({data:Je,methods:Xe}){if(!Je.infinite&&(Je.autoplayDirection===e$7&&Je.currentParticleIndex===Je.particlesCount-1||Je.autoplayDirection===t$4&&Je.currentParticleIndex===0)){Se.reset();return}if(Je.autoplay){const Ke=()=>w$e({[e$7]:()=>i$8(this,null,function*(){return Xe.showNextPage()}),[t$4]:()=>i$8(this,null,function*(){return Xe.showPrevPage()})})(Je.autoplayDirection);yield Se.start(Ke)}})},_jumpIfNeeded(Fe){return i$8(this,arguments,function*({data:Je,methods:Xe}){let Ke=!1;return Je.infinite&&(Je.currentParticleIndex===0?(yield Xe.showParticle(Je.particlesCount-Je.clonesCountTotal,{animated:!1}),Ke=!0):Je.currentParticleIndex===Je.particlesCount-Je.clonesCountTail&&(yield Xe.showParticle(Je.clonesCountHead,{animated:!1}),Ke=!0)),Ke})},changePage(Fe,Je,Xe){return i$8(this,arguments,function*({data:Ke,methods:Ye},or,sr){Se.reset(),!Ke.disabled&&(Ke.disabled=!0,or(),yield Ye.offsetPage({animated:o$b(sr,"animated",!0)}),Ke.disabled=!1,!(yield Ye._jumpIfNeeded())&&Ye._applyAutoplayIfNeeded())})},showNextPage(Fe,Je){return i$8(this,arguments,function*({data:Xe,methods:Ke},Ye){Xe.disabled||(yield Ke.changePage(Ke._next,Ye))})},showPrevPage(Fe,Je){return i$8(this,arguments,function*({data:Xe,methods:Ke},Ye){Xe.disabled||(yield Ke.changePage(Ke._prev,Ye))})},showParticle(Fe,Je,Xe){return i$8(this,arguments,function*({methods:Ke},Ye,or){yield Ke.changePage(()=>Ke._moveToParticle(Ye),or)})},_getParticleIndexByPageIndex({data:Fe},Je){return _$8({infinite:Fe.infinite,pageIndex:Je,clonesCountHead:Fe.clonesCountHead,clonesCountTail:Fe.clonesCountTail,particlesToScroll:Fe.particlesToScroll,particlesCount:Fe.particlesCount,particlesToShow:Fe.particlesToShow})},showPage(Fe,Je,Xe){return i$8(this,arguments,function*({methods:Ke},Ye,or){const sr=Ke._getParticleIndexByPageIndex(Ye);yield Ke.showParticle(sr,or)})},offsetPage({data:Fe},Je){const Xe=o$b(Je,"animated",!0);return new Promise(Ke=>{Fe.durationMs=Xe?Fe.durationMsInit:0,Fe.offset=-Fe.currentParticleIndex*Fe.particleWidth,setTimeout(()=>{Ke()},Fe.durationMs)})}}},{onChange:$e}),[De,Ve]=Be;return[{data:De,progressManager:Se},Ve,Be._internal]}var k$9=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});function tt($e){Qt$1($e,"svelte-sme1z4",":root{--sc-color-rgb-light-50p:rgba(93, 93, 93, 0.5);--sc-color-rgb-light:#5d5d5d;--sc-color-hex-dark-50p:rgba(30, 30, 30, 0.5);--sc-color-hex-dark:#1e1e1e}.sc-carousel__carousel-container.svelte-sme1z4{display:flex;width:100%;flex-direction:column;align-items:center}.sc-carousel__content-container.svelte-sme1z4{position:relative;display:flex;width:100%}.sc-carousel__pages-window.svelte-sme1z4{flex:1;display:flex;overflow:hidden;box-sizing:border-box;position:relative}.sc-carousel__pages-container.svelte-sme1z4{width:100%;display:flex;transition-property:transform}.sc-carousel__arrow-container.svelte-sme1z4{padding:5px;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.sc-carousel-progress__container.svelte-sme1z4{width:100%;height:5px;background-color:var(--sc-color-rgb-light-50p);position:absolute;bottom:0}.sc-carousel-button{all:unset;cursor:pointer}.sc-carousel-button:focus{outline:5px auto}")}const nt$1=$e=>({currentPageIndex:$e[0]&32,pagesCount:$e[0]&1024,loaded:$e[0]&64}),ue$2=$e=>({currentPageIndex:$e[5],pagesCount:$e[10],showPage:$e[15],loaded:$e[6]}),ot$1=$e=>({loaded:$e[0]&64,currentPageIndex:$e[0]&32}),ce$1=$e=>({showNextPage:$e[14].showNextPage,loaded:$e[6],currentPageIndex:$e[5]}),it$2=$e=>({loaded:$e[0]&64,currentPageIndex:$e[0]&32}),fe$3=$e=>({loaded:$e[6],currentPageIndex:$e[5]}),at$1=$e=>({loaded:$e[0]&64,currentPageIndex:$e[0]&32}),de$3=$e=>({showPrevPage:$e[14].showPrevPage,loaded:$e[6],currentPageIndex:$e[5]});function ge$4($e){let Se;const Be=$e[37].prev,De=Bt$1(Be,$e,$e[36],de$3),Ve=De||lt($e);return{c(){Ve&&Ve.c()},m(Fe,Je){Ve&&Ve.m(Fe,Je),Se=!0},p(Fe,Je){De?De.p&&(!Se||Je[0]&96|Je[1]&32)&&It(De,Be,Fe,Fe[36],Se?Ht$2(Be,Fe[36],Je,at$1):Ut(Fe[36]),de$3):Ve&&Ve.p&&(!Se||Je[0]&36)&&Ve.p(Fe,Se?Je:[-1,-1])},i(Fe){Se||(ot$4(Ve,Fe),Se=!0)},o(Fe){$t(Ve,Fe),Se=!1},d(Fe){Ve&&Ve.d(Fe)}}}function lt($e){let Se,Be,De;return Be=new q$d({props:{direction:"prev",disabled:!$e[2]&&$e[5]===0}}),Be.$on("click",$e[23]),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","sc-carousel__arrow-container svelte-sme1z4")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,Fe){const Je={};Fe[0]&36&&(Je.disabled=!Ve[2]&&Ve[5]===0),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function _e$2($e){let Se,Be,De;return Be=new w$f({props:{value:$e[7]}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","sc-carousel-progress__container svelte-sme1z4")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,Fe){const Je={};Fe[0]&128&&(Je.value=Ve[7]),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function me$1($e){let Se;const Be=$e[37].next,De=Bt$1(Be,$e,$e[36],ce$1),Ve=De||st($e);return{c(){Ve&&Ve.c()},m(Fe,Je){Ve&&Ve.m(Fe,Je),Se=!0},p(Fe,Je){De?De.p&&(!Se||Je[0]&96|Je[1]&32)&&It(De,Be,Fe,Fe[36],Se?Ht$2(Be,Fe[36],Je,ot$1):Ut(Fe[36]),ce$1):Ve&&Ve.p&&(!Se||Je[0]&1060)&&Ve.p(Fe,Se?Je:[-1,-1])},i(Fe){Se||(ot$4(Ve,Fe),Se=!0)},o(Fe){$t(Ve,Fe),Se=!1},d(Fe){Ve&&Ve.d(Fe)}}}function st($e){let Se,Be,De;return Be=new q$d({props:{direction:"next",disabled:!$e[2]&&$e[5]===$e[10]-1}}),Be.$on("click",$e[14].showNextPage),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","sc-carousel__arrow-container svelte-sme1z4")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,Fe){const Je={};Fe[0]&1060&&(Je.disabled=!Ve[2]&&Ve[5]===Ve[10]-1),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function pe$1($e){let Se;const Be=$e[37].dots,De=Bt$1(Be,$e,$e[36],ue$2),Ve=De||rt$1($e);return{c(){Ve&&Ve.c()},m(Fe,Je){Ve&&Ve.m(Fe,Je),Se=!0},p(Fe,Je){De?De.p&&(!Se||Je[0]&1120|Je[1]&32)&&It(De,Be,Fe,Fe[36],Se?Ht$2(Be,Fe[36],Je,nt$1):Ut(Fe[36]),ue$2):Ve&&Ve.p&&(!Se||Je[0]&1056)&&Ve.p(Fe,Se?Je:[-1,-1])},i(Fe){Se||(ot$4(Ve,Fe),Se=!0)},o(Fe){$t(Ve,Fe),Se=!1},d(Fe){Ve&&Ve.d(Fe)}}}function rt$1($e){let Se,Be;return Se=new H$e({props:{pagesCount:$e[10],currentPageIndex:$e[5]}}),Se.$on("pageChange",$e[41]),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve[0]&1024&&(Fe.pagesCount=De[10]),Ve[0]&32&&(Fe.currentPageIndex=De[5]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function ut($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br=$e[1]&&ge$4($e);const tn=$e[37].default,en=Bt$1(tn,$e,$e[36],fe$3);let an=$e[3]&&_e$2($e),rn=$e[1]&&me$1($e),on=$e[4]&&pe$1($e);return{c(){Se=K$g("div"),Be=K$g("div"),Br&&Br.c(),De=Xt$2(),Ve=K$g("div"),Fe=K$g("div"),en&&en.c(),Xe=Xt$2(),an&&an.c(),Ke=Xt$2(),rn&&rn.c(),Ye=Xt$2(),on&&on.c(),te$4(Fe,"class","sc-carousel__pages-container svelte-sme1z4"),ne$5(Fe,"transform","translateX("+$e[8]+"px)"),ne$5(Fe,"transition-duration",$e[9]+"ms"),ne$5(Fe,"transition-timing-function",$e[0]),te$4(Ve,"class","sc-carousel__pages-window svelte-sme1z4"),te$4(Be,"class","sc-carousel__content-container svelte-sme1z4"),te$4(Se,"class","sc-carousel__carousel-container svelte-sme1z4")},m(sn,ln){Nt$1(sn,Se,ln),pt$1(Se,Be),Br&&Br.m(Be,null),pt$1(Be,De),pt$1(Be,Ve),pt$1(Ve,Fe),en&&en.m(Fe,null),$e[39](Fe),pt$1(Ve,Xe),an&&an.m(Ve,null),$e[40](Ve),pt$1(Be,Ke),rn&&rn.m(Be,null),pt$1(Se,Ye),on&&on.m(Se,null),or=!0,sr||(cr=[Jt$2(Je=b$e.call(null,Fe,{thresholdProvider:$e[38]})),lt$2(Fe,"swipeStart",$e[16]),lt$2(Fe,"swipeMove",$e[18]),lt$2(Fe,"swipeEnd",$e[19]),lt$2(Fe,"swipeFailed",$e[20]),lt$2(Fe,"swipeThresholdReached",$e[17]),Jt$2(h$g.call(null,Ve)),lt$2(Ve,"hovered",$e[21]),Jt$2(y$i.call(null,Ve)),lt$2(Ve,"tapped",$e[22])],sr=!0)},p(sn,ln){sn[1]?Br?(Br.p(sn,ln),ln[0]&2&&ot$4(Br,1)):(Br=ge$4(sn),Br.c(),ot$4(Br,1),Br.m(Be,De)):Br&&(Lt$1(),$t(Br,1,1,()=>{Br=null}),Ot$2()),en&&en.p&&(!or||ln[0]&96|ln[1]&32)&&It(en,tn,sn,sn[36],or?Ht$2(tn,sn[36],ln,it$2):Ut(sn[36]),fe$3),(!or||ln[0]&256)&&ne$5(Fe,"transform","translateX("+sn[8]+"px)"),(!or||ln[0]&512)&&ne$5(Fe,"transition-duration",sn[9]+"ms"),(!or||ln[0]&1)&&ne$5(Fe,"transition-timing-function",sn[0]),Je&&L$k(Je.update)&&ln[0]&2048&&Je.update.call(null,{thresholdProvider:sn[38]}),sn[3]?an?(an.p(sn,ln),ln[0]&8&&ot$4(an,1)):(an=_e$2(sn),an.c(),ot$4(an,1),an.m(Ve,null)):an&&(Lt$1(),$t(an,1,1,()=>{an=null}),Ot$2()),sn[1]?rn?(rn.p(sn,ln),ln[0]&2&&ot$4(rn,1)):(rn=me$1(sn),rn.c(),ot$4(rn,1),rn.m(Be,null)):rn&&(Lt$1(),$t(rn,1,1,()=>{rn=null}),Ot$2()),sn[4]?on?(on.p(sn,ln),ln[0]&16&&ot$4(on,1)):(on=pe$1(sn),on.c(),ot$4(on,1),on.m(Se,null)):on&&(Lt$1(),$t(on,1,1,()=>{on=null}),Ot$2())},i(sn){or||(ot$4(Br),ot$4(en,sn),ot$4(an),ot$4(rn),ot$4(on),or=!0)},o(sn){$t(Br),$t(en,sn),$t(an),$t(rn),$t(on),or=!1},d(sn){sn&&J$h(Se),Br&&Br.d(),en&&en.d(sn),$e[39](null),an&&an.d(),$e[40](null),rn&&rn.d(),on&&on.d(),sr=!1,M$o(cr)}}}function ct($e,Se,Be){let{$$slots:De={},$$scope:Ve}=Se,Fe=[],Je,Xe,Ke=0,Ye=0,or=1;const[{data:sr,progressManager:cr},Br,tn]=A$f((ei,hi)=>{w$e({currentPageIndex:()=>Be(5,Je=hi),progressValue:()=>Be(7,Xe=hi),offset:()=>Be(8,Ke=hi),durationMs:()=>Be(9,Ye=hi),pagesCount:()=>Be(10,or=hi),loaded:()=>Be(6,Fe=hi)})(ei)}),en=fe$4();let{timingFunction:an="ease-in-out"}=Se,{arrows:rn=!0}=Se,{infinite:on=!0}=Se,{initialPageIndex:sn=0}=Se,{duration:ln=500}=Se,{autoplay:cn=!1}=Se,{autoplayDuration:hn=3e3}=Se,{autoplayDirection:mn=e$7}=Se,{pauseOnFocus:An=!1}=Se,{autoplayProgressVisible:xn=!1}=Se,{dots:pn=!0}=Se,{swiping:dn=!0}=Se,{particlesToShow:fn=1}=Se,{particlesToScroll:yn=1}=Se;function Sn(ei,hi){return k$9(this,null,function*(){const Un=o$b(hi,"animated",!0);if(typeof ei!="number")throw new Error("pageIndex should be a number");yield Br.showPage(ei,{animated:Un})})}function gn(ei){return k$9(this,null,function*(){const hi=o$b(ei,"animated",!0);yield Br.showPrevPage({animated:hi})})}function Cn(ei){return k$9(this,null,function*(){const hi=o$b(ei,"animated",!0);yield Br.showNextPage({animated:hi})})}let Mn=0,Bn,kn;const Ln=z$8(({width:ei})=>{Be(11,Mn=ei),sr.particleWidth=Mn/sr.particlesToShow,c$l({particlesContainerChildren:kn.children,particleWidth:sr.particleWidth}),Br.offsetPage({animated:!1})});function Pn(){const{clonesToAppend:ei,clonesToPrepend:hi}=N$9({clonesCountHead:sr.clonesCountHead,clonesCountTail:sr.clonesCountTail,particlesContainerChildren:kn.children});x$g({particlesContainer:kn,clonesToAppend:ei,clonesToPrepend:hi})}ce$2(()=>{k$9(this,null,function*(){yield _e$3(),kn&&Bn&&(sr.particlesCountWithoutClones=kn.children.length,yield _e$3(),sr.infinite&&Pn(),sr.particlesCount=kn.children.length,Br.showPage(sn,{animated:!1}),Ln.observe(Bn))})}),le$1(()=>{Ln.disconnect(),cr.reset()});function Vn(ei){return k$9(this,null,function*(){yield Br.showPage(ei,{animated:!0})})}function Yn(){dn&&(sr.durationMs=0)}function ni(ei){return k$9(this,null,function*(){dn&&(yield w$e({[e$7]:Br.showNextPage,[t$4]:Br.showPrevPage})(ei.detail.direction))})}function Rn(ei){dn&&(sr.offset+=ei.detail.dx)}function In(){dn&&Br.showParticle(sr.currentParticleIndex)}function Gn(){return k$9(this,null,function*(){dn&&(yield Br.offsetPage({animated:!0}))})}function Fn(ei){sr.focused=ei.detail.value}function Hn(){Br.toggleFocused()}function Dn(){Br.showPrevPage()}const zn=()=>Mn/3;function Qn(ei){ft$1[ei?"unshift":"push"](()=>{kn=ei,Be(13,kn)})}function Zn(ei){ft$1[ei?"unshift":"push"](()=>{Bn=ei,Be(12,Bn)})}const si=ei=>Vn(ei.detail);return $e.$$set=ei=>{"timingFunction"in ei&&Be(0,an=ei.timingFunction),"arrows"in ei&&Be(1,rn=ei.arrows),"infinite"in ei&&Be(2,on=ei.infinite),"initialPageIndex"in ei&&Be(24,sn=ei.initialPageIndex),"duration"in ei&&Be(25,ln=ei.duration),"autoplay"in ei&&Be(26,cn=ei.autoplay),"autoplayDuration"in ei&&Be(27,hn=ei.autoplayDuration),"autoplayDirection"in ei&&Be(28,mn=ei.autoplayDirection),"pauseOnFocus"in ei&&Be(29,An=ei.pauseOnFocus),"autoplayProgressVisible"in ei&&Be(3,xn=ei.autoplayProgressVisible),"dots"in ei&&Be(4,pn=ei.dots),"swiping"in ei&&Be(30,dn=ei.swiping),"particlesToShow"in ei&&Be(31,fn=ei.particlesToShow),"particlesToScroll"in ei&&Be(32,yn=ei.particlesToScroll),"$$scope"in ei&&Be(36,Ve=ei.$$scope)},$e.$$.update=()=>{$e.$$.dirty[0]&32&&en("pageChange",Je),$e.$$.dirty[0]&4&&(sr.infinite=on),$e.$$.dirty[0]&33554432&&(sr.durationMsInit=ln),$e.$$.dirty[0]&67108864&&(sr.autoplay=cn),$e.$$.dirty[0]&134217728&&(sr.autoplayDuration=hn),$e.$$.dirty[0]&268435456&&(sr.autoplayDirection=mn),$e.$$.dirty[0]&536870912&&(sr.pauseOnFocus=An),$e.$$.dirty[1]&1&&(sr.particlesToShowInit=fn),$e.$$.dirty[1]&2&&(sr.particlesToScrollInit=yn)},[an,rn,on,xn,pn,Je,Fe,Xe,Ke,Ye,or,Mn,Bn,kn,Br,Vn,Yn,ni,Rn,In,Gn,Fn,Hn,Dn,sn,ln,cn,hn,mn,An,dn,fn,yn,Sn,gn,Cn,Ve,De,zn,Qn,Zn,si]}class kt extends Ce$1{constructor(Se){super(),Te$1(this,Se,ct,ut,Ft$1,{timingFunction:0,arrows:1,infinite:2,initialPageIndex:24,duration:25,autoplay:26,autoplayDuration:27,autoplayDirection:28,pauseOnFocus:29,autoplayProgressVisible:3,dots:4,swiping:30,particlesToShow:31,particlesToScroll:32,goTo:33,goToPrev:34,goToNext:35},tt,[-1,-1])}get goTo(){return this.$$.ctx[33]}get goToPrev(){return this.$$.ctx[34]}get goToNext(){return this.$$.ctx[35]}}function $$3($e){Qt$1($e,"svelte-159ski6",".media-item.svelte-159ski6.svelte-159ski6{position:relative;height:100%}.media-content.svelte-159ski6.svelte-159ski6{position:relative;pointer-events:auto;width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;user-select:none;-o-object-fit:inherit;object-fit:inherit}.media-content.showPlayButton.svelte-159ski6.svelte-159ski6{pointer-events:none}.video-icon.svelte-159ski6.svelte-159ski6{width:12.5rem;height:6.25rem;max-width:60%;max-height:60%;position:absolute;left:50%;top:50%;transform:translate(-50%, -50%)}.video-play-button-container.svelte-159ski6.svelte-159ski6{display:none;position:absolute;width:100%;height:100%;top:0;left:0;transform:translate3d(0, 0, 0)}.video-play-button-container.showPlayButton.svelte-159ski6.svelte-159ski6{pointer-events:none;display:block}.video-icon.svelte-159ski6.svelte-159ski6{pointer-events:auto}.video-icon.large.svelte-159ski6.svelte-159ski6{width:12.5rem;height:6.25rem}.video-icon.small.svelte-159ski6.svelte-159ski6{width:1.75rem;height:1.75rem}.video-icon.svelte-159ski6 .video-icon-img.svelte-159ski6{width:100%;height:100%;background-position:center center;background-size:contain;background-repeat:no-repeat}.video-icon.svelte-159ski6 .video-icon-img.canPlay.svelte-159ski6{cursor:pointer}")}function L$9($e){let Se;function Be(Fe,Je){if(Fe[2].type==="Image")return te$2;if(Fe[2].type==="Video")return ee$2}let De=Be($e),Ve=De&&De($e);return{c(){Se=K$g("div"),Ve&&Ve.c(),te$4(Se,"class","media-item svelte-159ski6"),te$4(Se,"draggable","false")},m(Fe,Je){Nt$1(Fe,Se,Je),Ve&&Ve.m(Se,null)},p(Fe,Je){De===(De=Be(Fe))&&Ve?Ve.p(Fe,Je):(Ve&&Ve.d(1),Ve=De&&De(Fe),Ve&&(Ve.c(),Ve.m(Se,null)))},d(Fe){Fe&&J$h(Se),Ve&&Ve.d()}}}function ee$2($e){let Se,Be,De,Ve,Fe,Je;function Xe(or,sr){return or[8]&&or[2].videoCoverUrl?oe$1:ie$2}let Ke=Xe($e),Ye=Ke($e);return{c(){Ye.c(),Se=Xt$2(),Be=K$g("div"),De=K$g("div"),Ve=K$g("div"),te$4(Ve,"class","video-icon-img svelte-159ski6"),ne$5(Ve,"background-image","url("+$e[21]()+")"),re$2(Ve,"canPlay",$e[5]),te$4(De,"class","video-icon svelte-159ski6"),re$2(De,"large",$e[4]==="large"),re$2(De,"small",$e[4]==="small"),te$4(Be,"class","video-play-button-container svelte-159ski6"),re$2(Be,"showPlayButton",$e[11])},m(or,sr){Ye.m(or,sr),Nt$1(or,Se,sr),Nt$1(or,Be,sr),pt$1(Be,De),pt$1(De,Ve),Fe||(Je=lt$2(Ve,"click",$e[22]),Fe=!0)},p(or,sr){Ke===(Ke=Xe(or))&&Ye?Ye.p(or,sr):(Ye.d(1),Ye=Ke(or),Ye&&(Ye.c(),Ye.m(Se.parentNode,Se))),sr&8&&ne$5(Ve,"background-image","url("+or[21]()+")"),sr&32&&re$2(Ve,"canPlay",or[5]),sr&16&&re$2(De,"large",or[4]==="large"),sr&16&&re$2(De,"small",or[4]==="small"),sr&2048&&re$2(Be,"showPlayButton",or[11])},d(or){Ye.d(or),or&&J$h(Se),or&&J$h(Be),Fe=!1,Je()}}}function te$2($e){let Se,Be,De;return{c(){Se=K$g("img"),te$4(Se,"class","media-content svelte-159ski6"),Wt$2(Se.src,Be=$e[2].url)||te$4(Se,"src",Be),te$4(Se,"alt",De=$e[2].name),te$4(Se,"draggable",!1),ne$5(Se,"object-fit",$e[7])},m(Ve,Fe){Nt$1(Ve,Se,Fe)},p(Ve,Fe){Fe&4&&!Wt$2(Se.src,Be=Ve[2].url)&&te$4(Se,"src",Be),Fe&4&&De!==(De=Ve[2].name)&&te$4(Se,"alt",De),Fe&128&&ne$5(Se,"object-fit",Ve[7])},d(Ve){Ve&&J$h(Se)}}}function ie$2($e){let Se,Be,De,Ve,Fe,Je;return{c(){Se=K$g("video"),te$4(Se,"class","media-content svelte-159ski6"),Wt$2(Se.src,Be=$e[2].videoCoverUrl?$e[2].url:$e[2].url+"#t=0.1")||te$4(Se,"src",Be),te$4(Se,"poster",De=$e[2].videoCoverUrl),te$4(Se,"preload",Ve=$e[2].videoCoverUrl?"none":"auto"),te$4(Se,"disablepictureinpicture",""),Se.playsInline=!0,te$4(Se,"paused",""),Se.muted=!0,te$4(Se,"draggable",!1),Se.loop=!1,te$4(Se,"crossorigin",""),Se.autoplay=$e[6],Se.controls=!1,re$2(Se,"showPlayButton",$e[11]),ne$5(Se,"object-fit",$e[7])},m(Xe,Ke){Nt$1(Xe,Se,Ke),$e[20](Se),Fe||(Je=[lt$2(Se,"play",$e[15]),lt$2(Se,"pause",$e[16]),lt$2(Se,"error",$e[17]),lt$2(Se,"ended",$e[18]),lt$2(Se,"click",$e[19])],Fe=!0)},p(Xe,Ke){Ke&4&&!Wt$2(Se.src,Be=Xe[2].videoCoverUrl?Xe[2].url:Xe[2].url+"#t=0.1")&&te$4(Se,"src",Be),Ke&4&&De!==(De=Xe[2].videoCoverUrl)&&te$4(Se,"poster",De),Ke&4&&Ve!==(Ve=Xe[2].videoCoverUrl?"none":"auto")&&te$4(Se,"preload",Ve),Ke&64&&(Se.autoplay=Xe[6]),Ke&2048&&re$2(Se,"showPlayButton",Xe[11]),Ke&128&&ne$5(Se,"object-fit",Xe[7])},d(Xe){Xe&&J$h(Se),$e[20](null),Fe=!1,M$o(Je)}}}function oe$1($e){let Se,Be,De;return{c(){Se=K$g("img"),te$4(Se,"class","media-content svelte-159ski6"),Wt$2(Se.src,Be=$e[2].videoCoverUrl)||te$4(Se,"src",Be),te$4(Se,"alt",De=$e[2].name),te$4(Se,"draggable",!1),ne$5(Se,"object-fit",$e[7])},m(Ve,Fe){Nt$1(Ve,Se,Fe)},p(Ve,Fe){Fe&4&&!Wt$2(Se.src,Be=Ve[2].videoCoverUrl)&&te$4(Se,"src",Be),Fe&4&&De!==(De=Ve[2].name)&&te$4(Se,"alt",De),Fe&128&&ne$5(Se,"object-fit",Ve[7])},d(Ve){Ve&&J$h(Se)}}}function ne$4($e){let Se,Be=$e[2]&&L$9($e);return{c(){Be&&Be.c(),Se=Yt$1()},m(De,Ve){Be&&Be.m(De,Ve),Nt$1(De,Se,Ve)},p(De,[Ve]){De[2]?Be?Be.p(De,Ve):(Be=L$9(De),Be.c(),Be.m(Se.parentNode,Se)):Be&&(Be.d(1),Be=null)},i:N$f,o:N$f,d(De){Be&&Be.d(De),De&&J$h(Se)}}}function le($e,Se,Be){let De,Ve,{mediaInstance:Fe={videoInstance:void 0,paused:!0}}=Se,{tag:Je}=Se,{media:Xe}=Se,{playButtonIfNeed:Ke="withoutText"}=Se,{playButtonSizeIfNeed:Ye="small"}=Se,{canPlay:or=!0}=Se,{autoplayVideo:sr=!1}=Se,{objectFit:cr="fill"}=Se,{disableVideoIfHavePoster:Br=!1}=Se,tn=!0,en=!1;function an(){Be(9,en=Xe?.type==="Video"&&!!Xe.videoCoverUrl)}const rn=de$4("mediaStore"),on=de$4("hooks"),sn=()=>{en||De&&(Be(10,De.muted=!0,De),De.play(),De.pause(),Be(10,De.muted=!1,De),Be(9,en=!0))};on.on("loadVideoFirstFrame",sn),ce$2(()=>{rn.subscribe(({currentMediaElement:fn})=>{fn!==De&&De?.pause()})});const ln=fn=>{Be(11,tn=!1),Be(0,Fe.paused=!1,Fe),Be(9,en=!0),De&&rn.set({currentMediaElement:De}),on.emit("playStateChange",{event:fn,state:"playing",tag:Je,mediaInstance:De})},cn=fn=>{Be(11,tn=!0),Be(0,Fe.paused=!0,Fe),on.emit("playStateChange",{event:fn,state:"paused",tag:Je,mediaInstance:De})},hn=fn=>{Be(11,tn=!0),Be(0,Fe.paused=!0,Fe),on.emit("playStateChange",{event:fn,state:"paused",tag:Je,mediaInstance:De})},mn=fn=>{Be(11,tn=!0),Be(0,Fe.paused=!0,Fe),on.emit("playStateChange",{event:fn,state:"paused",tag:Je,mediaInstance:De})},An=fn=>{De&&De.pause()};function xn(fn){ft$1[fn?"unshift":"push"](()=>{Fe.videoInstance=fn,Be(0,Fe)})}const pn=()=>Ke==="withText"?a$k:Ke==="withoutText"?g$r:Ke,dn=fn=>{or&&De&&(Be(10,De.muted=!1,De),De.play())};return $e.$$set=fn=>{"mediaInstance"in fn&&Be(0,Fe=fn.mediaInstance),"tag"in fn&&Be(1,Je=fn.tag),"media"in fn&&Be(2,Xe=fn.media),"playButtonIfNeed"in fn&&Be(3,Ke=fn.playButtonIfNeed),"playButtonSizeIfNeed"in fn&&Be(4,Ye=fn.playButtonSizeIfNeed),"canPlay"in fn&&Be(5,or=fn.canPlay),"autoplayVideo"in fn&&Be(6,sr=fn.autoplayVideo),"objectFit"in fn&&Be(7,cr=fn.objectFit),"disableVideoIfHavePoster"in fn&&Be(8,Br=fn.disableVideoIfHavePoster)},$e.$$.update=()=>{if($e.$$.dirty&1&&Be(10,De=Fe.videoInstance),$e.$$.dirty&4&&Be(14,Ve=Xe?.url),$e.$$.dirty&16384&&Ve&&an(),$e.$$.dirty&1024&&De&&Be(11,tn=De.paused),$e.$$.dirty&1540&&Xe?.type==="Video"&&!en){const fn=navigator.userAgent.toLowerCase().indexOf("micromessenger")!==-1,yn=navigator.userAgent.toLowerCase().indexOf("iphone")!==-1&&fn;De&&yn&&De.paused&&(document.removeEventListener("WeixinJSBridgeReady",sn),document.removeEventListener("touchstart",sn),document.removeEventListener("click",sn),document.addEventListener("WeixinJSBridgeReady",sn),document.addEventListener("touchstart",sn),document.addEventListener("click",sn))}},[Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,en,De,tn,rn,on,Ve,ln,cn,hn,mn,An,xn,pn,dn]}let ue$1=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,le,ne$4,Ft$1,{mediaInstance:0,tag:1,media:2,playButtonIfNeed:3,playButtonSizeIfNeed:4,canPlay:5,autoplayVideo:6,objectFit:7,disableVideoIfHavePoster:8},$$3)}};function pe($e){Qt$1($e,"svelte-1mrbqlg",".media-list-wrapper.svelte-1mrbqlg.svelte-1mrbqlg{width:100%;height:100%;position:relative;overflow:hidden;border-radius:0.125rem}.media-list-wrapper.svelte-1mrbqlg .media-list.svelte-1mrbqlg{position:relative;pointer-events:auto;height:100%;left:50%;top:50%;transform:translate(-50%, -50%)}.media-list-wrapper.svelte-1mrbqlg .media-list.svelte-1mrbqlg .sc-carousel__carousel-container,.media-list-wrapper.svelte-1mrbqlg .media-list.svelte-1mrbqlg .sc-carousel__content-container{height:100%}")}function K$6($e,Se,Be){const De=$e.slice();return De[28]=Se[Be],De[29]=Se,De[30]=Be,De}function O$b($e){let Se,Be,De,Ve,Fe,Je,Xe;const Ke=[he$1,be$2],Ye=[];function or(sr,cr){return sr[13]&&sr[10].length>1?0:1}return De=or($e),Ve=Ye[De]=Ke[De]($e),{c(){Se=K$g("div"),Be=K$g("div"),Ve.c(),te$4(Be,"class","media-list svelte-1mrbqlg"),re$2(Be,"carouselEnabled",$e[13]),te$4(Se,"class","media-list-wrapper svelte-1mrbqlg"),re$2(Se,"unfolded",$e[5])},m(sr,cr){Nt$1(sr,Se,cr),pt$1(Se,Be),Ye[De].m(Be,null),Xe=!0},p(sr,cr){$e=sr;let Br=De;De=or($e),De===Br?Ye[De].p($e,cr):(Lt$1(),$t(Ye[Br],1,1,()=>{Ye[Br]=null}),Ot$2(),Ve=Ye[De],Ve?Ve.p($e,cr):(Ve=Ye[De]=Ke[De]($e),Ve.c()),ot$4(Ve,1),Ve.m(Be,null)),(!Xe||cr[0]&8192)&&re$2(Be,"carouselEnabled",$e[13]),(!Xe||cr[0]&32)&&re$2(Se,"unfolded",$e[5])},i(sr){Xe||(ot$4(Ve),sr&&z$j(()=>{Xe&&(Je&&Je.end(1),Fe=me$2(Se,S$n,$e[6]?{y:4,duration:$e[4],delay:$e[2],easing:Z$a}:void 0),Fe.start())}),Xe=!0)},o(sr){$t(Ve),Fe&&Fe.invalidate(),sr&&(Je=ge$6(Se,S$n,$e[6]?{y:4,duration:$e[4],delay:$e[3],easing:Z$a}:void 0)),Xe=!1},d(sr){sr&&J$h(Se),Ye[De].d(),sr&&Je&&Je.end()}}}function be$2($e){let Se,Be,De;const Ve=[{media:$e[1][0]},{autoplayVideo:$e[14]},$e[7],{tag:$e[0]}];function Fe(Xe){$e[21](Xe)}let Je={};for(let Xe=0;Xe<Ve.length;Xe+=1)Je=kt$1(Je,Ve[Xe]);return $e[8][0]!==void 0&&(Je.mediaInstance=$e[8][0]),Se=new ue$1({props:Je}),ft$1.push(()=>Me$1(Se,"mediaInstance",Fe)),{c(){Ae$2(Se.$$.fragment)},m(Xe,Ke){Dt$1(Se,Xe,Ke),De=!0},p(Xe,Ke){const Ye=Ke[0]&16515?ve$2(Ve,[Ke[0]&2&&{media:Xe[1][0]},Ke[0]&16384&&{autoplayVideo:Xe[14]},Ke[0]&128&&Ne$2(Xe[7]),Ke[0]&1&&{tag:Xe[0]}]):{};!Be&&Ke[0]&256&&(Be=!0,Ye.mediaInstance=Xe[8][0],pe$3(()=>Be=!1)),Se.$set(Ye)},i(Xe){De||(ot$4(Se.$$.fragment,Xe),De=!0)},o(Xe){$t(Se.$$.fragment,Xe),De=!1},d(Xe){Rt(Se,Xe)}}}function he$1($e){let Se,Be,De={dots:!1,arrows:!1,$$slots:{default:[Ie$1]},$$scope:{ctx:$e}};return Se=new kt({props:De}),$e[19](Se),Se.$on("pageChange",$e[20]),{c(){Ae$2(Se.$$.fragment)},m(Ve,Fe){Dt$1(Se,Ve,Fe),Be=!0},p(Ve,Fe){const Je={};Fe[0]&1409|Fe[1]&1&&(Je.$$scope={dirty:Fe,ctx:Ve}),Se.$set(Je)},i(Ve){Be||(ot$4(Se.$$.fragment,Ve),Be=!0)},o(Ve){$t(Se.$$.fragment,Ve),Be=!1},d(Ve){$e[19](null),Rt(Se,Ve)}}}function P$d($e){let Se,Be,De;const Ve=[$e[7],{media:$e[28]},{tag:$e[0]}];function Fe(Xe){$e[18](Xe,$e[30])}let Je={};for(let Xe=0;Xe<Ve.length;Xe+=1)Je=kt$1(Je,Ve[Xe]);return $e[8][$e[30]]!==void 0&&(Je.mediaInstance=$e[8][$e[30]]),Se=new ue$1({props:Je}),ft$1.push(()=>Me$1(Se,"mediaInstance",Fe)),{c(){Ae$2(Se.$$.fragment)},m(Xe,Ke){Dt$1(Se,Xe,Ke),De=!0},p(Xe,Ke){$e=Xe;const Ye=Ke[0]&1153?ve$2(Ve,[Ke[0]&128&&Ne$2($e[7]),Ke[0]&1024&&{media:$e[28]},Ke[0]&1&&{tag:$e[0]}]):{};!Be&&Ke[0]&256&&(Be=!0,Ye.mediaInstance=$e[8][$e[30]],pe$3(()=>Be=!1)),Se.$set(Ye)},i(Xe){De||(ot$4(Se.$$.fragment,Xe),De=!0)},o(Xe){$t(Se.$$.fragment,Xe),De=!1},d(Xe){Rt(Se,Xe)}}}function Ie$1($e){let Se,Be,De=$e[10],Ve=[];for(let Je=0;Je<De.length;Je+=1)Ve[Je]=P$d(K$6($e,De,Je));const Fe=Je=>$t(Ve[Je],1,1,()=>{Ve[Je]=null});return{c(){for(let Je=0;Je<Ve.length;Je+=1)Ve[Je].c();Se=Yt$1()},m(Je,Xe){for(let Ke=0;Ke<Ve.length;Ke+=1)Ve[Ke]&&Ve[Ke].m(Je,Xe);Nt$1(Je,Se,Xe),Be=!0},p(Je,Xe){if(Xe[0]&1409){De=Je[10];let Ke;for(Ke=0;Ke<De.length;Ke+=1){const Ye=K$6(Je,De,Ke);Ve[Ke]?(Ve[Ke].p(Ye,Xe),ot$4(Ve[Ke],1)):(Ve[Ke]=P$d(Ye),Ve[Ke].c(),ot$4(Ve[Ke],1),Ve[Ke].m(Se.parentNode,Se))}for(Lt$1(),Ke=De.length;Ke<Ve.length;Ke+=1)Fe(Ke);Ot$2()}},i(Je){if(!Be){for(let Xe=0;Xe<De.length;Xe+=1)ot$4(Ve[Xe]);Be=!0}},o(Je){Ve=Ve.filter(Boolean);for(let Xe=0;Xe<Ve.length;Xe+=1)$t(Ve[Xe]);Be=!1},d(Je){Vt(Ve,Je),Je&&J$h(Se)}}}function ye$2($e){let Se,Be,De=$e[5]&&O$b($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,Fe){Ve[5]?De?(De.p(Ve,Fe),Fe[0]&32&&ot$4(De,1)):(De=O$b(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function ke$2($e,Se,Be){let De,Ve,Fe,Je,{tag:Xe}=Se,{mediaData:Ke}=Se,{inDelay:Ye=0}=Se,{outDelay:or=0}=Se,{duration:sr=0}=Se,{unfolded:cr=!0}=Se,{animation:Br=!0}=Se,{mediaItemConfig:tn}=Se,{enableCarousel:en=!0}=Se,{autoplayConfig:an={}}=Se;const{autoplayVideo:rn=!1,autoplayCarousel:on=!0,autoplayVideoInCarousel:sn=!1}=an;let ln=[],cn=0,hn,mn=null;const An=de$4("hooks"),xn=de$4("mediaStore");function pn(){const gn=ln[cn],Cn=gn?.videoInstance;Cn&&(Cn.paused?(Cn.muted=!1,Cn.play()):Cn.pause())}ce$2(()=>{An.on("click",gn=>{var Cn;(Cn=Xe.tag3DContentSvelte)!=null&&Cn.css3DInstance&&gn.tag.id===Xe.id&&gn.target==="TagContent"&&pn()}),Be(0,Xe.play=()=>{const gn=ln[cn],Cn=gn?.videoInstance;Cn&&(Cn.muted=!1,Cn.play())},Xe),Be(0,Xe.pause=()=>{const gn=ln[cn],Cn=gn?.videoInstance;Cn&&Cn.pause()},Xe),mn=setInterval(()=>{Je&&hn?.goToNext()},3e3)}),le$1(()=>{clearInterval(mn),An.off("click",pn)});function dn(gn,Cn){$e.$$.not_equal(ln[Cn],gn)&&(ln[Cn]=gn,Be(8,ln))}function fn(gn){ft$1[gn?"unshift":"push"](()=>{hn=gn,Be(12,hn)})}const yn=gn=>{De||xn.set({currentMediaElement:null}),Be(11,cn=gn.detail)};function Sn(gn){$e.$$.not_equal(ln[0],gn)&&(ln[0]=gn,Be(8,ln))}return $e.$$set=gn=>{"tag"in gn&&Be(0,Xe=gn.tag),"mediaData"in gn&&Be(1,Ke=gn.mediaData),"inDelay"in gn&&Be(2,Ye=gn.inDelay),"outDelay"in gn&&Be(3,or=gn.outDelay),"duration"in gn&&Be(4,sr=gn.duration),"unfolded"in gn&&Be(5,cr=gn.unfolded),"animation"in gn&&Be(6,Br=gn.animation),"mediaItemConfig"in gn&&Be(7,tn=gn.mediaItemConfig),"enableCarousel"in gn&&Be(16,en=gn.enableCarousel),"autoplayConfig"in gn&&Be(17,an=gn.autoplayConfig)},$e.$$.update=()=>{$e.$$.dirty[0]&256&&Be(9,De=ln.every(gn=>gn.paused)),$e.$$.dirty[0]&65538&&Be(13,Ve=en&&Ke?.length>1),$e.$$.dirty[0]&2&&Be(10,Fe=Ke),$e.$$.dirty[0]&1536&&(Je=Fe.length>1&&on&&De)},[Xe,Ke,Ye,or,sr,cr,Br,tn,ln,De,Fe,cn,hn,Ve,rn,xn,en,an,dn,fn,yn,Sn]}class at extends Ce$1{constructor(Se){super(),Te$1(this,Se,ke$2,ye$2,Ft$1,{tag:0,mediaData:1,inDelay:2,outDelay:3,duration:4,unfolded:5,animation:6,mediaItemConfig:7,enableCarousel:16,autoplayConfig:17},pe,[-1,-1])}}function V$4($e){Qt$1($e,"svelte-1f7m1lj",".line.svelte-1f7m1lj{position:absolute;width:6.5625rem;height:1.3125rem;transform:translateY(-100%)}.text.svelte-1f7m1lj{position:absolute;width:6.25rem;left:1rem;bottom:0.0625rem;font-weight:600}.media-wrapper.svelte-1f7m1lj{position:absolute;left:0.875rem;top:-5.3125rem;width:5.625rem;height:3.75rem;font-weight:600}")}function I$b($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke;Se=new T$a({props:{visible:$e[3],left:61,bottom:57,width:2,blurRadius:150,spreadRadius:75}}),Ve=new A$h({props:{unfolded:$e[3],outDelay:400}});let Ye=$e[2]&&N$7($e),or=$e[1]&&P$c($e);return{c(){Ae$2(Se.$$.fragment),Be=Xt$2(),De=K$g("div"),Ae$2(Ve.$$.fragment),Fe=Xt$2(),Ye&&Ye.c(),Je=Xt$2(),or&&or.c(),Xe=Yt$1(),te$4(De,"class","line svelte-1f7m1lj")},m(sr,cr){Dt$1(Se,sr,cr),Nt$1(sr,Be,cr),Nt$1(sr,De,cr),Dt$1(Ve,De,null),Nt$1(sr,Fe,cr),Ye&&Ye.m(sr,cr),Nt$1(sr,Je,cr),or&&or.m(sr,cr),Nt$1(sr,Xe,cr),Ke=!0},p(sr,cr){const Br={};cr&8&&(Br.visible=sr[3]),Se.$set(Br);const tn={};cr&8&&(tn.unfolded=sr[3]),Ve.$set(tn),sr[2]?Ye?(Ye.p(sr,cr),cr&4&&ot$4(Ye,1)):(Ye=N$7(sr),Ye.c(),ot$4(Ye,1),Ye.m(Je.parentNode,Je)):Ye&&(Lt$1(),$t(Ye,1,1,()=>{Ye=null}),Ot$2()),sr[1]?or?(or.p(sr,cr),cr&2&&ot$4(or,1)):(or=P$c(sr),or.c(),ot$4(or,1),or.m(Xe.parentNode,Xe)):or&&(Lt$1(),$t(or,1,1,()=>{or=null}),Ot$2())},i(sr){Ke||(ot$4(Se.$$.fragment,sr),ot$4(Ve.$$.fragment,sr),ot$4(Ye),ot$4(or),Ke=!0)},o(sr){$t(Se.$$.fragment,sr),$t(Ve.$$.fragment,sr),$t(Ye),$t(or),Ke=!1},d(sr){Rt(Se,sr),sr&&J$h(Be),sr&&J$h(De),Rt(Ve),sr&&J$h(Fe),Ye&&Ye.d(sr),sr&&J$h(Je),or&&or.d(sr),sr&&J$h(Xe)}}}function N$7($e){let Se,Be,De;return Be=new ae$1({props:{unfolded:$e[3],content:$e[2],inDelay:500}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","text svelte-1f7m1lj")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,Fe){const Je={};Fe&8&&(Je.unfolded=Ve[3]),Fe&4&&(Je.content=Ve[2]),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function P$c($e){let Se,Be,De;return Be=new at({props:{autoplayConfig:{autoplayCarousel:!1},unfolded:$e[3],mediaData:$e[1],tag:$e[0],enableCarousel:!1,mediaItemConfig:{canPlay:!1,playButtonSizeIfNeed:"small",disableVideoIfHavePoster:!0},inDelay:500,duration:500}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","media-wrapper svelte-1f7m1lj")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,Fe){const Je={};Fe&8&&(Je.unfolded=Ve[3]),Fe&2&&(Je.mediaData=Ve[1]),Fe&1&&(Je.tag=Ve[0]),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function Y$3($e){let Se,Be,De=$e[0].state&&I$b($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[0].state?De?(De.p(Ve,Fe),Fe&1&&ot$4(De,1)):(De=I$b(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function A$e($e,Se,Be){let De,Ve,Fe,Je,{tag:Xe}=Se;return $e.$$set=Ke=>{"tag"in Ke&&Be(0,Xe=Ke.tag)},$e.$$.update=()=>{var Ke,Ye,or;$e.$$.dirty&1&&Be(3,De=Xe.state?Xe.state.unfolded:!1),$e.$$.dirty&1&&Be(4,Ve=(Ye=(Ke=Xe.data.title)!=null?Ke:Xe.data.text)!=null?Ye:""),$e.$$.dirty&16&&Be(2,Fe=((or=Ve.length)!=null?or:0)>7?Ve.substring(0,6)+"...":Ve),$e.$$.dirty&1&&Be(1,Je=Xe.data.mediaData)},[Xe,Je,Fe,De,Ve]}let qe$1=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,A$e,Y$3,Ft$1,{tag:0},V$4)}};function de$2($e){Qt$1($e,"svelte-1707m54",'@charset "UTF-8";.svelte-1707m54.svelte-1707m54{box-sizing:border-box}.marketing.svelte-1707m54.svelte-1707m54{transform:translateY(-100%)}.marketing.svelte-1707m54 .line.svelte-1707m54{position:absolute;height:1.875rem;width:0.0625rem;left:50%;transform:translateX(-50%);background-color:white;bottom:0;transform-origin:bottom;transition:all 500ms}.marketing.svelte-1707m54 .content.svelte-1707m54{position:relative;min-width:7.5rem;width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content;border-radius:0.25rem;top:-1.875rem;left:-1rem;padding:0.5rem 0rem 0.5625rem;transition-property:opacity, transform;transition-duration:500ms}.marketing.svelte-1707m54 .content .headerImage.svelte-1707m54{position:absolute;width:100%;top:0.25rem;transform:translateY(-100%);border-top-left-radius:0.25rem;border-top-right-radius:0.25rem}.title-wrapper.svelte-1707m54.svelte-1707m54{position:relative;width:100%;height:1.125rem}.title-wrapper.svelte-1707m54 .title.svelte-1707m54{border-radius:0.25rem;width:100%;padding-left:0.625rem;padding-right:0.625rem}.title-wrapper.svelte-1707m54 .title .text.svelte-1707m54{display:block;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:0.75rem;font-weight:bold;line-height:1.125rem}.footer.svelte-1707m54.svelte-1707m54{box-sizing:border-box;width:100%;padding:0.5rem 0.625rem 0;display:flex;justify-content:space-between;align-items:center}.footer.svelte-1707m54 .price-section.svelte-1707m54{flex-shrink:0;max-width:calc(100% - 1.875rem);overflow:hidden;white-space:nowrap}.footer.svelte-1707m54 .price-section .value.svelte-1707m54{font-size:0.875rem;line-height:1rem;font-weight:normal;font-family:TG-TYPE, PingFangSC, Segoe UI, Rototo, sans-serif;letter-spacing:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.footer.svelte-1707m54 .price-section .unit.svelte-1707m54{font-size:0.625rem;margin-left:0.125rem}.footer.svelte-1707m54 .action-section.svelte-1707m54{display:flex;align-items:center;height:0.875rem}.footer.svelte-1707m54 .action-section .highlight-text.svelte-1707m54{font-size:0.625rem;line-height:0.875rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:8.75rem}.footer.svelte-1707m54 .action-section .arrow.svelte-1707m54{display:flex;align-items:center;margin-left:0.25rem;flex-shrink:0;width:0.625rem}.footer.svelte-1707m54 .action-section .arrow svg.svelte-1707m54{width:0.375rem;height:0.625rem}.tags-wrapper.svelte-1707m54.svelte-1707m54{position:relative;overflow:hidden;height:1rem;margin-top:0.25rem}.tags-wrapper.svelte-1707m54 .tags.svelte-1707m54{position:relative;display:inline-flex;max-width:100%;flex-wrap:wrap;padding-left:0.625rem;padding-right:0.375rem}.tags-wrapper.svelte-1707m54 .tags .tag.svelte-1707m54{display:block;text-align:center;flex-shrink:0;flex-grow:0;font-size:0.625rem;height:1rem;line-height:1rem;margin-right:0.25rem;margin-bottom:0.25rem;padding:0 0.25rem;border-radius:0.125rem;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;box-sizing:border-box}.marketing.light.svelte-1707m54 .content.svelte-1707m54{background-color:white}.marketing.light.svelte-1707m54 .content .title-wrapper .title .text.svelte-1707m54{color:rgba(0, 0, 0, 0.8)}.marketing.light.svelte-1707m54 .content .tags-wrapper .tags .primary-tag.svelte-1707m54{background:rgba(234, 208, 154, 0.5);color:#946700}.marketing.light.svelte-1707m54 .content .tags-wrapper .tags .secondary-tag.svelte-1707m54{background:rgba(0, 0, 0, 0.06);color:rgba(0, 0, 0, 0.5)}.marketing.light.svelte-1707m54 .content .footer.svelte-1707m54{color:#946700;fill:#946700}.marketing.dark.svelte-1707m54 .content.svelte-1707m54{background-color:rgba(0, 0, 0, 0.5)}.marketing.dark.svelte-1707m54 .content .title-wrapper .title .text.svelte-1707m54{color:white}.marketing.dark.svelte-1707m54 .content .tags-wrapper .tags .primary-tag.svelte-1707m54{background:rgba(234, 208, 154, 0.5);color:white}.marketing.dark.svelte-1707m54 .content .tags-wrapper .tags .secondary-tag.svelte-1707m54{background:rgba(255, 255, 255, 0.15);color:rgba(255, 255, 255, 0.85)}.marketing.dark.svelte-1707m54 .content .footer.svelte-1707m54{color:#ead09a;fill:#ead09a}.marketing.unfolded.svelte-1707m54 .line.svelte-1707m54{transform:translateX(-50%) scale(1, 1);transition-timing-function:ease-out}.marketing.folded.svelte-1707m54 .line.svelte-1707m54{transform:translateX(-50%) scale(1, 0);transition-timing-function:ease-in}.marketing.unfolded.svelte-1707m54 .content.svelte-1707m54{opacity:1;transform:translateY(0);transition-timing-function:ease-out}.marketing.folded.svelte-1707m54 .content.svelte-1707m54{opacity:0;transform:translateY(0.425rem);transition-timing-function:ease-in}.tag.svelte-1707m54.svelte-1707m54,.text.svelte-1707m54.svelte-1707m54{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}')}function q$b($e,Se,Be){const De=$e.slice();return De[0]=Se[Be],De}function x$e($e,Se,Be){const De=$e.slice();return De[0]=Se[Be],De}function O$a($e){let Se,Be;return{c(){Se=K$g("img"),te$4(Se,"class","headerImage svelte-1707m54"),Wt$2(Se.src,Be=$e[1].headerPictureUrl)||te$4(Se,"src",Be),te$4(Se,"alt","")},m(De,Ve){Nt$1(De,Se,Ve)},p(De,Ve){Ve&2&&!Wt$2(Se.src,Be=De[1].headerPictureUrl)&&te$4(Se,"src",Be)},d(De){De&&J$h(Se)}}}function j$e($e){let Se,Be,De,Ve,Fe,Je=$e[4]||[],Xe=[];for(let or=0;or<Je.length;or+=1)Xe[or]=E$e(x$e($e,Je,or));let Ke=$e[3]||[],Ye=[];for(let or=0;or<Ke.length;or+=1)Ye[or]=G$6(q$b($e,Ke,or));return{c(){Se=K$g("div"),Be=K$g("div");for(let or=0;or<Xe.length;or+=1)Xe[or].c();De=Xt$2();for(let or=0;or<Ye.length;or+=1)Ye[or].c();te$4(Be,"class","tags svelte-1707m54"),te$4(Se,"class","tags-wrapper svelte-1707m54")},m(or,sr){Nt$1(or,Se,sr),pt$1(Se,Be);for(let cr=0;cr<Xe.length;cr+=1)Xe[cr]&&Xe[cr].m(Be,null);pt$1(Be,De);for(let cr=0;cr<Ye.length;cr+=1)Ye[cr]&&Ye[cr].m(Be,null);Ve||(Fe=[Jt$2(E$o.call(null,Be)),lt$2(Be,"clientHeight",$e[18])],Ve=!0)},p(or,sr){if(sr&16){Je=or[4]||[];let cr;for(cr=0;cr<Je.length;cr+=1){const Br=x$e(or,Je,cr);Xe[cr]?Xe[cr].p(Br,sr):(Xe[cr]=E$e(Br),Xe[cr].c(),Xe[cr].m(Be,De))}for(;cr<Xe.length;cr+=1)Xe[cr].d(1);Xe.length=Je.length}if(sr&8){Ke=or[3]||[];let cr;for(cr=0;cr<Ke.length;cr+=1){const Br=q$b(or,Ke,cr);Ye[cr]?Ye[cr].p(Br,sr):(Ye[cr]=G$6(Br),Ye[cr].c(),Ye[cr].m(Be,null))}for(;cr<Ye.length;cr+=1)Ye[cr].d(1);Ye.length=Ke.length}},d(or){or&&J$h(Se),Vt(Xe,or),Vt(Ye,or),Ve=!1,M$o(Fe)}}}function E$e($e){let Se,Be=$e[0]+"",De;return{c(){Se=K$g("div"),De=gt$2(Be),te$4(Se,"class","tag primary-tag svelte-1707m54"),ne$5(Se,"min-width",R$9)},m(Ve,Fe){Nt$1(Ve,Se,Fe),pt$1(Se,De)},p(Ve,Fe){Fe&16&&Be!==(Be=Ve[0]+"")&&ee$5(De,Be)},d(Ve){Ve&&J$h(Se)}}}function G$6($e){let Se,Be=$e[0]+"",De;return{c(){Se=K$g("div"),De=gt$2(Be),te$4(Se,"class","tag secondary-tag svelte-1707m54"),ne$5(Se,"min-width",R$9)},m(Ve,Fe){Nt$1(Ve,Se,Fe),pt$1(Se,De)},p(Ve,Fe){Fe&8&&Be!==(Be=Ve[0]+"")&&ee$5(De,Be)},d(Ve){Ve&&J$h(Se)}}}function N$6($e){let Se,Be,De,Ve,Fe,Je=$e[2]&&Z$4($e),Xe=!$e[2]&&$e[1].highlightText&&J$6($e);return{c(){Se=K$g("div"),Je&&Je.c(),Be=Xt$2(),De=K$g("div"),Xe&&Xe.c(),Ve=Xt$2(),Fe=K$g("span"),Fe.innerHTML='<svg viewBox="0 0 6 9" class="svelte-1707m54"><g transform="translate(-3, -2)" fill-rule="nonzero" class="svelte-1707m54"><path d="M4.43868724,2.12056563 C4.28121824,1.95989074 4.02582143,1.95979988 3.86824251,2.1203627 C3.72498894,2.26632889 3.71189225,2.49481723 3.82900374,2.65587166 L6.57092402,5.92894326 C6.72651763,6.11470411 6.72651763,6.38529589 6.57092402,6.57105674 L3.86804348,9.79798499 C3.72488984,9.94405307 3.71194952,10.1725507 3.8291712,10.3335217 L3.86824251,10.3796373 C4.01149607,10.5256035 4.23559087,10.5387981 4.39346025,10.4192733 L4.43868724,10.3794344 L8.1144599,6.5985342 C8.30312347,6.40447482 8.30312347,6.09552518 8.1144599,5.9014658 L4.43868724,2.12056563 Z" class="svelte-1707m54"></path></g></svg>',te$4(Fe,"class","arrow svelte-1707m54"),te$4(De,"class","action-section svelte-1707m54"),te$4(Se,"class","footer svelte-1707m54")},m(Ke,Ye){Nt$1(Ke,Se,Ye),Je&&Je.m(Se,null),pt$1(Se,Be),pt$1(Se,De),Xe&&Xe.m(De,null),pt$1(De,Ve),pt$1(De,Fe)},p(Ke,Ye){Ke[2]?Je?Je.p(Ke,Ye):(Je=Z$4(Ke),Je.c(),Je.m(Se,Be)):Je&&(Je.d(1),Je=null),!Ke[2]&&Ke[1].highlightText?Xe?Xe.p(Ke,Ye):(Xe=J$6(Ke),Xe.c(),Xe.m(De,Ve)):Xe&&(Xe.d(1),Xe=null)},d(Ke){Ke&&J$h(Se),Je&&Je.d(),Xe&&Xe.d()}}}function Z$4($e){let Se,Be,De=$e[1].price.value+"",Ve,Fe,Je=$e[1].price.unit&&A$d($e);return{c(){Se=K$g("div"),Be=K$g("span"),Ve=gt$2(De),Fe=Xt$2(),Je&&Je.c(),te$4(Be,"class","value svelte-1707m54"),te$4(Se,"class","price-section svelte-1707m54")},m(Xe,Ke){Nt$1(Xe,Se,Ke),pt$1(Se,Be),pt$1(Be,Ve),pt$1(Se,Fe),Je&&Je.m(Se,null)},p(Xe,Ke){Ke&2&&De!==(De=Xe[1].price.value+"")&&ee$5(Ve,De),Xe[1].price.unit?Je?Je.p(Xe,Ke):(Je=A$d(Xe),Je.c(),Je.m(Se,null)):Je&&(Je.d(1),Je=null)},d(Xe){Xe&&J$h(Se),Je&&Je.d()}}}function A$d($e){let Se,Be=$e[1].price.unit+"",De;return{c(){Se=K$g("span"),De=gt$2(Be),te$4(Se,"class","unit svelte-1707m54")},m(Ve,Fe){Nt$1(Ve,Se,Fe),pt$1(Se,De)},p(Ve,Fe){Fe&2&&Be!==(Be=Ve[1].price.unit+"")&&ee$5(De,Be)},d(Ve){Ve&&J$h(Se)}}}function J$6($e){let Se,Be=$e[1].highlightText+"",De;return{c(){Se=K$g("span"),De=gt$2(Be),te$4(Se,"class","highlight-text svelte-1707m54")},m(Ve,Fe){Nt$1(Ve,Se,Fe),pt$1(Se,De)},p(Ve,Fe){Fe&2&&Be!==(Be=Ve[1].highlightText+"")&&ee$5(De,Be)},d(Ve){Ve&&J$h(Se)}}}function ce($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr=$e[1].title+"",cr,Br,tn,en,an;Be=new T$a({props:{visible:$e[5],outDelay:500,left:61,bottom:87,blurRadius:150,spreadRadius:75}});let rn=$e[1].headerPictureUrl&&O$a($e),on=$e[6]&&j$e($e),sn=($e[2]||$e[1].highlightText)&&N$6($e);return{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),De=Xt$2(),Ve=K$g("div"),Fe=Xt$2(),Je=K$g("div"),rn&&rn.c(),Xe=Xt$2(),Ke=K$g("div"),Ye=K$g("div"),or=K$g("div"),cr=gt$2(sr),Br=Xt$2(),on&&on.c(),tn=Xt$2(),sn&&sn.c(),te$4(Ve,"class","line svelte-1707m54"),ne$5(Ve,"transition-delay",$e[5]?$e[9]+"ms":$e[8]+"ms"),te$4(or,"class","text svelte-1707m54"),te$4(Ye,"class","title svelte-1707m54"),te$4(Ke,"class","title-wrapper svelte-1707m54"),te$4(Je,"class","content svelte-1707m54"),ne$5(Je,"max-width",e$8($e[12])),ne$5(Je,"transition-delay",$e[5]?$e[7]+"ms":"0ms"),te$4(Se,"class",en=Gt$1(`marketing ${$e[10]}`)+" svelte-1707m54"),re$2(Se,"unfolded",$e[5]),re$2(Se,"folded",$e[11])},m(ln,cn){Nt$1(ln,Se,cn),Dt$1(Be,Se,null),pt$1(Se,De),pt$1(Se,Ve),pt$1(Se,Fe),pt$1(Se,Je),rn&&rn.m(Je,null),pt$1(Je,Xe),pt$1(Je,Ke),pt$1(Ke,Ye),pt$1(Ye,or),pt$1(or,cr),pt$1(Je,Br),on&&on.m(Je,null),pt$1(Je,tn),sn&&sn.m(Je,null),an=!0},p(ln,[cn]){const hn={};cn&32&&(hn.visible=ln[5]),Be.$set(hn),cn&800&&ne$5(Ve,"transition-delay",ln[5]?ln[9]+"ms":ln[8]+"ms"),ln[1].headerPictureUrl?rn?rn.p(ln,cn):(rn=O$a(ln),rn.c(),rn.m(Je,Xe)):rn&&(rn.d(1),rn=null),(!an||cn&2)&&sr!==(sr=ln[1].title+"")&&ee$5(cr,sr),ln[6]?on?on.p(ln,cn):(on=j$e(ln),on.c(),on.m(Je,tn)):on&&(on.d(1),on=null),ln[2]||ln[1].highlightText?sn?sn.p(ln,cn):(sn=N$6(ln),sn.c(),sn.m(Je,null)):sn&&(sn.d(1),sn=null),cn&160&&ne$5(Je,"transition-delay",ln[5]?ln[7]+"ms":"0ms"),(!an||cn&1024&&en!==(en=Gt$1(`marketing ${ln[10]}`)+" svelte-1707m54"))&&te$4(Se,"class",en),(!an||cn&1056)&&re$2(Se,"unfolded",ln[5]),(!an||cn&3072)&&re$2(Se,"folded",ln[11])},i(ln){an||(ot$4(Be.$$.fragment,ln),an=!0)},o(ln){$t(Be.$$.fragment,ln),an=!1},d(ln){ln&&J$h(Se),Rt(Be),rn&&rn.d(),on&&on.d(),sn&&sn.d()}}}const R$9=40;function ge$3($e,Se,Be){let De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,{tag:en}=Se,an,rn=(()=>{var hn;const mn=(hn=en.data.limitWidth)!=null?hn:!0;if(typeof mn=="number")return mn;if(mn===!0)return 172})(),on=0,sn=!1;function ln(hn){Math.abs(an-hn)>5&&(Be(14,an=hn),setTimeout(()=>{Be(16,sn=!1)},100))}const cn=hn=>ln(hn.detail);return $e.$$set=hn=>{"tag"in hn&&Be(0,en=hn.tag)},$e.$$.update=()=>{var hn,mn,An,xn;$e.$$.dirty&1&&Be(5,De=(mn=(hn=en.state)==null?void 0:hn.unfolded)!=null?mn:!1),$e.$$.dirty&32&&Be(11,Ve=!De),$e.$$.dirty&1&&Be(1,Fe=en.data),$e.$$.dirty&2&&Be(2,Je=i$w((An=Fe.price)==null?void 0:An.value)&&((xn=Fe.price)==null?void 0:xn.value)!==""),$e.$$.dirty&1&&Be(10,Xe=en.data.theme||"light"),$e.$$.dirty&114688&&(!sn||rn&&rn>0)&&(Be(15,on=Math.max(1,Math.floor(((rn||172)-20)/R$9))),an!==void 0&&an>40&&Be(15,on=Math.max(1,on-1)),Be(16,sn=!0)),$e.$$.dirty&32770&&Be(4,Ke=(Fe.brandTags||[]).filter(Boolean).slice(0,on)),$e.$$.dirty&32784&&Be(17,Ye=Math.max(0,on-Ke.length)),$e.$$.dirty&131074&&Be(3,or=(Fe.tags||[]).filter(Boolean).slice(0,Ye)),$e.$$.dirty&24&&Be(6,tn=Ke.length>0||or.length>0),$e.$$.dirty&6&&(Je||Fe.highlightText)},Be(9,sr=400),Be(8,cr=140),Be(7,Br=580),[en,Fe,Je,or,Ke,De,tn,Br,cr,sr,Xe,Ve,rn,ln,an,on,sn,Ye,cn]}class Dt extends Ce$1{constructor(Se){super(),Te$1(this,Se,ge$3,ce,Ft$1,{tag:0},de$2)}}const e$5=$e=>$e;var d$i=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});let E$d=class{static checkBrowserSupport(){var Se,Be,De,Ve;const Fe=navigator.userAgent,Je=document.createElement("audio");let Xe="Unknown",Ke="Unknown";Fe.includes("Edge/")?(Xe="Microsoft Edge",Ke=((Se=Fe.match(/Edge\/(\d+)/))==null?void 0:Se[1])||"Unknown"):Fe.includes("Chrome/")?(Xe="Chrome",Ke=((Be=Fe.match(/Chrome\/(\d+)/))==null?void 0:Be[1])||"Unknown"):Fe.includes("Firefox/")?(Xe="Firefox",Ke=((De=Fe.match(/Firefox\/(\d+)/))==null?void 0:De[1])||"Unknown"):Fe.includes("Safari/")&&!Fe.includes("Chrome")&&(Xe="Safari",Ke=((Ve=Fe.match(/Version\/(\d+)/))==null?void 0:Ve[1])||"Unknown");const Ye=[{name:"MP3",mime:"audio/mpeg"},{name:"OGG",mime:"audio/ogg"},{name:"WAV",mime:"audio/wav"},{name:"M4A",mime:"audio/mp4"},{name:"AAC",mime:"audio/aac"},{name:"WEBM",mime:"audio/webm"}],or=[],sr=[];return Ye.forEach(cr=>{const Br=Je.canPlayType(cr.mime);Br==="probably"?or.push(`${cr.name} (完全支持)`):Br==="maybe"?(or.push(`${cr.name} (可能支持)`),sr.push(`${cr.name} 格式支持不确定，建议使用其他格式`)):sr.push(`${cr.name} 格式不被支持`)}),{browser:`${Xe} ${Ke}`,version:Ke,supportedFormats:or,warnings:sr}}static testAudioUrl(Se){return d$i(this,null,function*(){try{const Be=yield fetch(Se,{method:"HEAD"});return{accessible:Be.ok,status:Be.status,contentType:Be.headers.get("content-type")||void 0,contentLength:parseInt(Be.headers.get("content-length")||"0")||void 0}}catch(Be){return{accessible:!1,error:Be instanceof Error?Be.message:String(Be)}}})}static testAudioElement(Se){return d$i(this,null,function*(){return new Promise(Be=>{const De=new Audio;let Ve=!1;const Fe=()=>{Ve||(Ve=!0,De.removeEventListener("loadedmetadata",Je),De.removeEventListener("error",Ke),De.removeEventListener("canplay",Xe))},Je=()=>{Fe(),Be({success:!0,duration:De.duration,networkState:De.networkState,readyState:De.readyState})},Xe=()=>{Fe(),Be({success:!0,canPlay:"canplay",duration:De.duration,networkState:De.networkState,readyState:De.readyState})},Ke=()=>{Fe(),Be({success:!1,error:De.error?`${De.error.code}: ${De.error.message}`:"Unknown audio error",networkState:De.networkState,readyState:De.readyState})};De.addEventListener("loadedmetadata",Je),De.addEventListener("canplay",Xe),De.addEventListener("error",Ke),setTimeout(()=>{Ve||(Fe(),Be({success:!1,error:"音频加载超时",networkState:De.networkState,readyState:De.readyState}))},1e4),De.src=Se,De.load()})})}static diagnoseAudio(Se){return d$i(this,null,function*(){var Be;console.group("🎵 音频诊断报告"),console.group("1. 浏览器支持检查");const De=this.checkBrowserSupport();console.log("浏览器:",De.browser),console.log("支持的格式:",De.supportedFormats),De.warnings.length>0&&console.warn("警告:",De.warnings),console.groupEnd(),console.group("2. 音频文件URL检查"),console.log("音频URL:",Se);try{new URL(Se,window.location.href),console.log("✅ URL格式正确")}catch{console.error("❌ URL格式错误"),console.groupEnd(),console.groupEnd();return}const Ve=(Be=Se.split(".").pop())==null?void 0:Be.toLowerCase();Ve&&(console.log("文件扩展名:",Ve.toUpperCase()),["mp3","ogg","wav","m4a","aac","webm"].includes(Ve)?console.log("✅ 文件格式常见"):console.warn("⚠️ 不常见的文件格式，可能存在兼容性问题")),console.groupEnd(),console.group("3. 网络可访问性测试");const Fe=yield this.testAudioUrl(Se);Fe.accessible?(console.log("✅ 文件可访问"),console.log("HTTP状态:",Fe.status),Fe.contentType&&console.log("内容类型:",Fe.contentType),Fe.contentLength&&console.log("文件大小:",(Fe.contentLength/1024).toFixed(2),"KB")):(console.error("❌ 文件无法访问"),Fe.status&&console.error("HTTP状态:",Fe.status),Fe.error&&console.error("错误:",Fe.error)),console.groupEnd(),console.group("4. 音频元素测试");const Je=yield this.testAudioElement(Se);Je.success?(console.log("✅ 音频元素创建成功"),Je.duration&&console.log("音频时长:",Je.duration.toFixed(2),"秒"),console.log("网络状态:",this.getNetworkStateDescription(Je.networkState)),console.log("就绪状态:",this.getReadyStateDescription(Je.readyState))):(console.error("❌ 音频元素创建失败"),console.error("错误:",Je.error),console.log("网络状态:",this.getNetworkStateDescription(Je.networkState)),console.log("就绪状态:",this.getReadyStateDescription(Je.readyState))),console.groupEnd(),console.groupEnd()})}static getNetworkStateDescription(Se){switch(Se){case 0:return"NETWORK_EMPTY - 音频元素尚未初始化";case 1:return"NETWORK_IDLE - 音频元素处于活动状态但未使用网络";case 2:return"NETWORK_LOADING - 浏览器正在下载数据";case 3:return"NETWORK_NO_SOURCE - 未找到合适的音频源";default:return`未知状态 (${Se})`}}static getReadyStateDescription(Se){switch(Se){case 0:return"HAVE_NOTHING - 没有音频数据";case 1:return"HAVE_METADATA - 已获取元数据";case 2:return"HAVE_CURRENT_DATA - 有当前播放位置的数据";case 3:return"HAVE_FUTURE_DATA - 有足够的数据开始播放";case 4:return"HAVE_ENOUGH_DATA - 有足够的数据流畅播放";default:return`未知状态 (${Se})`}}};var f$p=Object.defineProperty,A$c=($e,Se,Be)=>Se in $e?f$p($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,h$a=($e,Se,Be)=>(A$c($e,typeof Se!="symbol"?Se+"":Se,Be),Be),v$g=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});let S$b=class extends Audio{constructor(Se){super(),h$a(this,"sharedAudioSrc"),h$a(this,"sharedAudioPaused",!0),h$a(this,"sharedAudioCurrentTime",0),h$a(this,"tryplaying",!1),h$a(this,"audioInstance"),h$a(this,"eventListenerDisposer"),this.sharedAudioSrc=Se,Se&&this.validateAudioSource(Se)}get paused(){var Se;return(Se=this.sharedAudioPaused)!=null?Se:!0}get currentTime(){return this.sharedAudioCurrentTime}get duration(){var Se;return((Se=this.audioInstance)==null?void 0:Se.duration)||0}play(){return v$g(this,null,function*(){var Se,Be,De;if(this.tryplaying)return;this.tryplaying=!0,(!this.audioInstance||((Se=this.audioInstance)==null?void 0:Se.realSrc)!==this.sharedAudioSrc)&&(this.audioInstance=L$d(this.sharedAudioSrc,{namespace:d$q.PlayAudio})),(Be=this.eventListenerDisposer)==null||Be.call(this),this.eventListenerDisposer=this.addEventListeners(),this.audioInstance.currentTime=(De=this.currentTime)!=null?De:0;const Ve=this.audioInstance.currentTime!==this.currentTime;this.audioInstance.play().then(()=>{var Fe;this.audioInstance.muted=!1,Ve&&(this.audioInstance.currentTime=(Fe=this.currentTime)!=null?Fe:0),this.sharedAudioPaused=!1}).catch(Fe=>{var Je;this.handlePlayError(Fe),this.endedHandler(),(Je=this.onerror)==null||Je.call(this,Fe)}).finally(()=>{this.tryplaying=!1})})}pause(Se){var Be;if(this.audioInstance&&!this.paused){if(this.sharedAudioPaused=!0,(Be=this.eventListenerDisposer)==null||Be.call(this),this.audioInstance.ended){this.endedHandler();return}this.audioInstance.paused||this.audioInstance.pause(),this.onpause(Se??new Event("pause")),this.clear()}}dispose(){var Se;(Se=this.eventListenerDisposer)==null||Se.call(this),this.clear(),this.audioInstance=void 0}clear(){var Se;(Se=this.audioInstance)==null||Se.clear()}handlePlayError(Se){var Be,De,Ve,Fe;const Je=navigator.userAgent,Xe=this.sharedAudioSrc;if(console.group("🎵 音频播放错误详情"),console.error("错误对象:",Se),console.error("错误名称:",Se.name),console.error("错误信息:",Se.message),console.error("音频文件路径:",Xe),console.error("浏览器信息:",Je),console.error("音频实例状态:",{exists:!!this.audioInstance,readyState:(Be=this.audioInstance)==null?void 0:Be.readyState,networkState:(De=this.audioInstance)==null?void 0:De.networkState,error:(Ve=this.audioInstance)==null?void 0:Ve.error}),Se.name==="NotSupportedError"){if(Se.message.includes("no supported source was found")&&(console.error("❌ 错误原因: 无法找到支持的音频源"),console.error("💡 可能的解决方案:"),console.error("   1. 检查音频文件路径是否正确"),console.error("   2. 检查音频文件是否存在"),console.error("   3. 检查音频文件格式是否被浏览器支持 (推荐: MP3, OGG, WAV)"),console.error("   4. 检查CORS设置，确保可以跨域访问音频文件"),Xe)){const Ke=(Fe=Xe.split(".").pop())==null?void 0:Fe.toLowerCase(),Ye=["mp3","ogg","wav","m4a","aac"];Ke&&!Ye.includes(Ke)&&(console.error(`   ⚠️  检测到不常见的音频格式: .${Ke}`),console.error(`   📝 建议使用: ${Ye.join(", ")}`))}}else Se.name==="AbortError"?console.error("❌ 错误原因: 音频播放被中断"):Se.name==="NotAllowedError"?console.error("❌ 错误原因: 浏览器阻止了音频播放 (通常需要用户交互)"):Se.message==="The operation is not supported."?console.error("❌ 错误原因: 音频文件可能损坏或格式有问题"):console.error("❌ 未知的音频播放错误");console.groupEnd(),Se.name==="NotSupportedError"&&Xe&&(console.error("💡 建议运行完整音频诊断来查找问题根源："),console.error(`AudioDiagnostics.diagnoseAudio("${Xe}")`))}validateAudioSource(Se){var Be;try{new URL(Se,window.location.href)}catch{console.warn("🎵 音频URL格式可能有问题:",Se),E$d.diagnoseAudio(Se);return}const De=(Be=Se.split(".").pop())==null?void 0:Be.toLowerCase(),Ve=["mp3","ogg","wav","m4a","aac","webm"];De&&!Ve.includes(De)&&(console.warn("🎵 音频格式可能不被广泛支持:",De),console.warn("💡 建议使用常见格式:",Ve.join(", ")),console.warn('💡 运行音频诊断：AudioDiagnostics.diagnoseAudio("'+Se+'")')),this.checkBrowserSupport(De)}checkBrowserSupport(Se){if(!Se)return;const Be=document.createElement("audio"),De={mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",m4a:"audio/mp4",aac:"audio/aac",webm:"audio/webm"}[Se];if(De){const Ve=Be.canPlayType(De);Ve===""?(console.warn(`🎵 当前浏览器可能不支持 ${Se.toUpperCase()} 格式`),console.warn("💡 建议提供多种格式的音频文件作为备选")):console.info(Ve==="maybe"?`🎵 当前浏览器可能支持 ${Se.toUpperCase()} 格式 (不确定)`:`🎵 当前浏览器支持 ${Se.toUpperCase()} 格式`)}}endedHandler(Se){var Be,De;(Be=this.onended)==null||Be.call(this,Se??new Event("ended")),(De=this.eventListenerDisposer)==null||De.call(this),this.sharedAudioPaused=!0,this.sharedAudioCurrentTime=0,this.clear()}addEventListeners(){const Se=this.audioInstance;if(!Se)return;const Be=sr=>{var cr;this.sharedAudioCurrentTime=Se.currentTime,(cr=this.ontimeupdate)==null||cr.call(this,sr)},De=sr=>{var cr;Se.isBlankAudio||(this.sharedAudioPaused=!1,(cr=this.onplay)==null||cr.call(this,sr))},Ve=sr=>{this.pause(sr)},Fe=sr=>{this.endedHandler(sr)},Je=sr=>{var cr;this.sharedAudioPaused=!0,(cr=this.onerror)==null||cr.call(this,sr)},Xe=sr=>{var cr;return(cr=this.oncanplay)==null?void 0:cr.call(this,sr)},Ke=sr=>{var cr;return(cr=this.oncanplaythrough)==null?void 0:cr.call(this,sr)},Ye=sr=>{var cr;return(cr=this.onloadeddata)==null?void 0:cr.call(this,sr)},or=sr=>{var cr;return(cr=this.onloadedmetadata)==null?void 0:cr.call(this,sr)};return Se.addEventListener("timeupdate",Be),Se.addEventListener("play",De),Se.addEventListener("pause",Ve),Se.addEventListener("ended",Fe),Se.addEventListener("error",Je),Se.addEventListener("canplay",Xe),Se.addEventListener("canplaythrough",Ke),Se.addEventListener("loadeddata",Ye),Se.addEventListener("loadedmetadata",or),()=>{Se.removeEventListener("timeupdate",Be),Se.removeEventListener("play",De),Se.removeEventListener("pause",Ve),Se.removeEventListener("ended",Fe),Se.removeEventListener("error",Je),Se.removeEventListener("canplay",Xe),Se.removeEventListener("canplaythrough",Ke),Se.removeEventListener("loadeddata",Ye),Se.removeEventListener("loadedmetadata",or)}}};var S$a=Object.defineProperty,_$6=Object.getOwnPropertySymbols,C$7=Object.prototype.hasOwnProperty,A$b=Object.prototype.propertyIsEnumerable,g$i=($e,Se,Be)=>Se in $e?S$a($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,d$h=($e,Se)=>{for(var Be in Se||(Se={}))C$7.call(Se,Be)&&g$i($e,Be,Se[Be]);if(_$6)for(var Be of _$6(Se))A$b.call(Se,Be)&&g$i($e,Be,Se[Be]);return $e};function K$5($e){Qt$1($e,"svelte-13e7hxv",".audio.svelte-13e7hxv{pointer-events:auto;cursor:pointer;width:100%;height:100%}")}function O$9($e){let Se,Be,De,Ve;const Fe=$e[8].default,Je=Bt$1(Fe,$e,$e[7],null);return{c(){Se=K$g("div"),Je&&Je.c(),te$4(Se,"class","audio svelte-13e7hxv"),te$4(Se,"style",$e[0])},m(Xe,Ke){Nt$1(Xe,Se,Ke),Je&&Je.m(Se,null),Be=!0,De||(Ve=lt$2(Se,"click",Zt$1($e[1])),De=!0)},p(Xe,[Ke]){Je&&Je.p&&(!Be||Ke&128)&&It(Je,Fe,Xe,Xe[7],Be?Ht$2(Fe,Xe[7],Ke,null):Ut(Xe[7]),null),(!Be||Ke&1)&&te$4(Se,"style",Xe[0])},i(Xe){Be||(ot$4(Je,Xe),Be=!0)},o(Xe){$t(Je,Xe),Be=!1},d(Xe){Xe&&J$h(Se),Je&&Je.d(Xe),De=!1,Ve()}}}function Q$3($e,Se,Be){let{$$slots:De={},$$scope:Ve}=Se,{url:Fe}=Se,{enable:Je=!0}=Se,{style:Xe=""}=Se,{hooksInfo:Ke}=Se;const Ye=fe$4(),or=de$4("hooks"),sr=de$4("mediaStore");let cr,Br=!0;function tn(){Be(5,cr.onplay=an=>{or.emit("playStateChange",d$h({event:an,state:"playing",mediaInstance:cr},Ke)),Ye("play"),Be(6,Br=!1)},cr),Be(5,cr.onpause=an=>{or.emit("playStateChange",d$h({event:an,state:"paused",mediaInstance:cr},Ke)),Ye("pause"),Be(6,Br=!0)},cr),Be(5,cr.onended=an=>{or.emit("playStateChange",d$h({event:an,state:"paused",mediaInstance:cr},Ke)),Ye("pause"),Be(6,Br=!0)},cr),Be(5,cr.onloadedmetadata=an=>{typeof cr.duration=="number"&&!Number.isNaN(cr.duration)&&Ye("duration",cr.duration)},cr),Be(5,cr.onerror=an=>{Ye("pause"),Be(6,Br=!0)},cr),Be(5,cr.ontimeupdate=an=>{Ye("timeupdate",cr.currentTime)},cr)}sr.subscribe(({currentMediaElement:an})=>{an!==cr&&(Br||cr==null||cr.pause())});function en(an){cr&&(or.emit("click",d$h({event:an,target:"AudioTagPlayIcon",audioInstance:cr},Ke)),sr.set({currentMediaElement:cr}),or.emit("playStateChange",d$h({event:an,state:cr.paused?"playing":"paused",mediaInstance:cr},Ke)),cr.paused?cr.play():cr.pause())}return $e.$$set=an=>{"url"in an&&Be(2,Fe=an.url),"enable"in an&&Be(3,Je=an.enable),"style"in an&&Be(0,Xe=an.style),"hooksInfo"in an&&Be(4,Ke=an.hooksInfo),"$$scope"in an&&Be(7,Ve=an.$$scope)},$e.$$.update=()=>{$e.$$.dirty&4&&(Fe||Ye("duration",0)),$e.$$.dirty&36&&(cr?.dispose(),Be(5,cr=new S$b(Fe)),Ye("audioRef",cr),setTimeout(()=>Ye("audioRef",cr),200),tn()),$e.$$.dirty&40&&(Je||cr==null||cr.pause()),$e.$$.dirty&72&&Ye(Je&&!Br?"play":"pause")},[Xe,en,Fe,Je,Ke,cr,Br,Ve,De]}let Z$3=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,Q$3,O$9,Ft$1,{url:2,enable:3,style:0,hooksInfo:4},K$5)}};function L$8($e){Qt$1($e,"svelte-6pnkgc",".audio-icon__wrapper.svelte-6pnkgc.svelte-6pnkgc{display:inline-block}.audio-icon.svelte-6pnkgc.svelte-6pnkgc{display:flex;justify-content:center;align-items:center;position:relative;width:100%;height:100%;border-radius:50%}.audio-icon.svelte-6pnkgc .sound-wave__container.svelte-6pnkgc{position:absolute;pointer-events:none;top:0;left:0;width:100%;height:100%}@keyframes svelte-6pnkgc-sound_wave_1_animation{0%,10%{opacity:0}25%,100%{opacity:1}}@keyframes svelte-6pnkgc-sound_wave_2_animation{0%,35%{opacity:0}50%,100%{opacity:1}}@keyframes svelte-6pnkgc-sound_wave_3_animation{0%,60%{opacity:0}75%,100%{opacity:1}}")}function G$5($e){let Se,Be;return Se=new T$a({props:{center:!0,blurRadius:12,spreadRadius:5}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function N$5($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en=$e[0]&&G$5();return{c(){Se=K$g("div"),en&&en.c(),Be=Xt$2(),De=K$g("div"),Ve=K$g("div"),Fe=Mt("svg"),Je=Mt("defs"),Xe=Mt("linearGradient"),Ke=Mt("stop"),Ye=Mt("stop"),or=Mt("linearGradient"),sr=Mt("stop"),cr=Mt("stop"),Br=Mt("path"),te$4(Ke,"stop-color","rgba(255, 255, 255, 1)"),te$4(Ke,"stop-opacity",".5"),te$4(Ke,"offset","0%"),te$4(Ye,"stop-color","rgba(255, 255, 255, 1)"),te$4(Ye,"offset","100%"),te$4(Xe,"x1","8.653%"),te$4(Xe,"y1","15.676%"),te$4(Xe,"x2","85.159%"),te$4(Xe,"y2","79.274%"),te$4(Xe,"id","dnalogel-audio-icon-linear-gradient-1"),te$4(sr,"stop-color","rgba(255, 255, 255, 1)"),te$4(sr,"offset","0%"),te$4(cr,"stop-color","rgba(255, 255, 255, 1)"),te$4(cr,"stop-opacity","0"),te$4(cr,"offset","100%"),te$4(or,"x1","0%"),te$4(or,"y1","0%"),te$4(or,"x2","64.422%"),te$4(or,"y2","62.326%"),te$4(or,"id","dnalogel-audio-icon-linear-gradient-2"),te$4(Br,"d",$e[3]),te$4(Br,"fill","url(#dnalogel-audio-icon-linear-gradient-1)"),te$4(Br,"fill-rule","nonzero"),te$4(Br,"stroke","url(#dnalogel-audio-icon-linear-gradient-2)"),te$4(Br,"stroke-width",".5"),te$4(Fe,"viewBox","0 0 24 24"),te$4(Fe,"version","1.1"),te$4(Fe,"aria-label","audio-icon"),te$4(Ve,"class","sound-wave__container svelte-6pnkgc"),te$4(De,"class","audio-icon svelte-6pnkgc"),te$4(Se,"class","audio-icon__wrapper svelte-6pnkgc"),te$4(Se,"style",$e[1]),ne$5(Se,"width",$e[4]),ne$5(Se,"height",$e[4])},m(an,rn){Nt$1(an,Se,rn),en&&en.m(Se,null),pt$1(Se,Be),pt$1(Se,De),pt$1(De,Ve),pt$1(Ve,Fe),pt$1(Fe,Je),pt$1(Je,Xe),pt$1(Xe,Ke),pt$1(Xe,Ye),pt$1(Je,or),pt$1(or,sr),pt$1(or,cr),pt$1(Fe,Br),$e[10](Ve),tn=!0},p(an,[rn]){an[0]?en?rn&1&&ot$4(en,1):(en=G$5(),en.c(),ot$4(en,1),en.m(Se,Be)):en&&(Lt$1(),$t(en,1,1,()=>{en=null}),Ot$2()),(!tn||rn&8)&&te$4(Br,"d",an[3]),(!tn||rn&2)&&te$4(Se,"style",an[1]);const on=rn&2;(on||rn&18)&&ne$5(Se,"width",an[4]),(on||rn&18)&&ne$5(Se,"height",an[4])},i(an){tn||(ot$4(en),tn=!0)},o(an){$t(en),tn=!1},d(an){an&&J$h(Se),en&&en.d(),$e[10](null)}}}function O$8($e,Se,Be){let De,Ve,{playing:Fe}=Se,{shadow:Je=!1}=Se,{style:Xe=null}=Se,{width:Ke="100%"}=Se,{animated:Ye=!0}=Se,or,sr=0,cr=null;const Br=["M12 3.25c2.416 0 4.604.98 6.187 2.563A8.723 8.723 0 0 1 20.75 12c0 2.416-.98 4.604-2.563 6.187A8.723 8.723 0 0 1 12 20.75a8.723 8.723 0 0 1-6.187-2.563A8.723 8.723 0 0 1 3.25 12c0-2.416.98-4.604 2.563-6.187A8.723 8.723 0 0 1 12 3.25Zm1.534 3.282-1.29 1.289.186.183a5.86 5.86 0 0 1 1.663 4.095c0 1.555-.605 2.965-1.786 4.236l1.118 1.12.2-.19a7.46 7.46 0 0 0 2.225-5.322 7.46 7.46 0 0 0-2.316-5.411Zm-2.046 2.047-1.245 1.243.14.133a3.04 3.04 0 0 1 .882 2.144c0 .795-.308 1.516-.955 2.24l1.23 1.231.168-.168a4.793 4.793 0 0 0 1.314-3.303c0-1.39-.59-2.643-1.534-3.52Zm-1.752 1.78-1.69 1.689 1.745 1.743.132-.13a2.29 2.29 0 0 0-.187-3.302Z","M12 3.25c2.416 0 4.604.98 6.187 2.563A8.723 8.723 0 0 1 20.75 12c0 2.416-.98 4.604-2.563 6.187A8.723 8.723 0 0 1 12 20.75a8.723 8.723 0 0 1-6.187-2.563A8.723 8.723 0 0 1 3.25 12c0-2.416.98-4.604 2.563-6.187A8.723 8.723 0 0 1 12 3.25Zm-2.264 7.109-1.69 1.689 1.745 1.743.132-.13a2.29 2.29 0 0 0-.187-3.302Z","M12 3.25c2.416 0 4.604.98 6.187 2.563A8.723 8.723 0 0 1 20.75 12c0 2.416-.98 4.604-2.563 6.187A8.723 8.723 0 0 1 12 20.75a8.723 8.723 0 0 1-6.187-2.563A8.723 8.723 0 0 1 3.25 12c0-2.416.98-4.604 2.563-6.187A8.723 8.723 0 0 1 12 3.25Zm-.512 5.329-1.245 1.243.14.133a3.04 3.04 0 0 1 .882 2.144c0 .795-.308 1.516-.955 2.24l1.23 1.231.168-.168a4.793 4.793 0 0 0 1.314-3.303c0-1.39-.59-2.643-1.534-3.52Zm-1.752 1.78-1.69 1.689 1.745 1.743.132-.13a2.29 2.29 0 0 0-.187-3.302Z"];le$1(()=>{cr&&(clearInterval(cr),Be(9,cr=null))});function tn(en){ft$1[en?"unshift":"push"](()=>{or=en,Be(2,or)})}return $e.$$set=en=>{"playing"in en&&Be(5,Fe=en.playing),"shadow"in en&&Be(0,Je=en.shadow),"style"in en&&Be(1,Xe=en.style),"width"in en&&Be(6,Ke=en.width),"animated"in en&&Be(7,Ye=en.animated)},$e.$$.update=()=>{var en;$e.$$.dirty&64&&Be(4,De=typeof Ke=="number"?e$8(Ke):Ke),$e.$$.dirty&800&&(Fe?cr||Be(9,cr=setInterval(()=>{Be(8,sr=(sr+1)%Br.length)},500)):(cr&&(clearInterval(cr),Be(9,cr=null)),Be(8,sr=0))),$e.$$.dirty&384&&Be(3,Ve=(en=Br[Ye?sr:0])!=null?en:Br[0])},[Je,Xe,or,Ve,De,Fe,Ke,Ye,sr,cr,tn]}let X$3=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,O$8,N$5,Ft$1,{playing:5,shadow:0,style:1,width:6,animated:7},L$8)}};function se$1($e){Qt$1($e,"svelte-1s6gk4a",".audio-tag.svelte-1s6gk4a{position:absolute;left:0;top:0;width:0;height:0;overflow:visible}.audio-icon__wrapper.svelte-1s6gk4a{position:relative;vertical-align:top;width:100%;height:100%}.content.svelte-1s6gk4a{width:-moz-max-content;width:max-content;height:3.375rem;padding:2.25rem 0.25rem 0 1rem;position:absolute;left:0;bottom:0.125rem;overflow:hidden;box-sizing:border-box;font-size:0;white-space:nowrap;font-weight:600}.wrapper.svelte-1s6gk4a{position:relative;width:100%;height:100%}.audio-icon.svelte-1s6gk4a{pointer-events:none;vertical-align:top;display:inline-block;width:1rem;height:1rem;margin-right:0.25rem;margin-top:0.0625rem}.audio.svelte-1s6gk4a{position:relative;width:100%;height:100%}")}function j$d($e){var Se,Be;let De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an;Ve=new T$a({props:{visible:$e[6],left:$e[3]/2+"px",bottom:12,width:2,blurRadius:120,spreadRadius:60}});let rn=$e[6]&&B$c($e);return sr=new ie$3({props:{visible:$e[6],textUnfolded:$e[1],content:$e[5]}}),Br=new Y$8({props:{unfolded:$e[6],length:$e[3],outDelay:$e[4]+20*Math.min((Be=(Se=$e[5])==null?void 0:Se.length)!=null?Be:10,15),useLinearColor:!0}}),{c(){De=K$g("div"),Ae$2(Ve.$$.fragment),Fe=Xt$2(),Je=K$g("div"),Xe=K$g("div"),Ke=K$g("div"),rn&&rn.c(),Ye=Xt$2(),or=K$g("div"),Ae$2(sr.$$.fragment),cr=Xt$2(),Ae$2(Br.$$.fragment),te$4(Ke,"class","audio-icon svelte-1s6gk4a"),ne$5(or,"display","inline-block"),te$4(Xe,"class","wrapper svelte-1s6gk4a"),te$4(Je,"class","content svelte-1s6gk4a"),te$4(De,"class","audio-tag svelte-1s6gk4a"),re$2(De,"unfolded",$e[6])},m(on,sn){Nt$1(on,De,sn),Dt$1(Ve,De,null),pt$1(De,Fe),pt$1(De,Je),pt$1(Je,Xe),pt$1(Xe,Ke),rn&&rn.m(Ke,null),pt$1(Xe,Ye),pt$1(Xe,or),Dt$1(sr,or,null),pt$1(De,cr),Dt$1(Br,De,null),tn=!0,en||(an=[lt$2(or,"click",$e[7]),Jt$2(E$o.call(null,or)),lt$2(or,"clientWidth",$e[12])],en=!0)},p(on,sn){var ln,cn;const hn={};sn&64&&(hn.visible=on[6]),sn&8&&(hn.left=on[3]/2+"px"),Ve.$set(hn),on[6]?rn?(rn.p(on,sn),sn&64&&ot$4(rn,1)):(rn=B$c(on),rn.c(),ot$4(rn,1),rn.m(Ke,null)):rn&&(Lt$1(),$t(rn,1,1,()=>{rn=null}),Ot$2());const mn={};sn&64&&(mn.visible=on[6]),sn&2&&(mn.textUnfolded=on[1]),sn&32&&(mn.content=on[5]),sr.$set(mn);const An={};sn&64&&(An.unfolded=on[6]),sn&8&&(An.length=on[3]),sn&48&&(An.outDelay=on[4]+20*Math.min((cn=(ln=on[5])==null?void 0:ln.length)!=null?cn:10,15)),Br.$set(An),(!tn||sn&64)&&re$2(De,"unfolded",on[6])},i(on){tn||(ot$4(Ve.$$.fragment,on),ot$4(rn),ot$4(sr.$$.fragment,on),ot$4(Br.$$.fragment,on),tn=!0)},o(on){$t(Ve.$$.fragment,on),$t(rn),$t(sr.$$.fragment,on),$t(Br.$$.fragment,on),tn=!1},d(on){on&&J$h(De),Rt(Ve),rn&&rn.d(),Rt(sr),Rt(Br),en=!1,M$o(an)}}}function B$c($e){let Se,Be,De,Ve,Fe,Je,Xe;return Be=new T$a({props:{center:!0,blurRadius:15,spreadRadius:6}}),Ve=new Z$3({props:{enable:$e[6],url:$e[0].data.audioUrl,hooksInfo:{tag:$e[0]},$$slots:{default:[fe$2]},$$scope:{ctx:$e}}}),Ve.$on("play",$e[8]),Ve.$on("pause",$e[9]),Ve.$on("error",$e[10]),Ve.$on("audioRef",$e[11]),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),De=Xt$2(),Ae$2(Ve.$$.fragment),te$4(Se,"class","audio svelte-1s6gk4a")},m(Ke,Ye){Nt$1(Ke,Se,Ye),Dt$1(Be,Se,null),pt$1(Se,De),Dt$1(Ve,Se,null),Xe=!0},p(Ke,Ye){$e=Ke;const or={};Ye&64&&(or.enable=$e[6]),Ye&1&&(or.url=$e[0].data.audioUrl),Ye&1&&(or.hooksInfo={tag:$e[0]}),Ye&8196&&(or.$$scope={dirty:Ye,ctx:$e}),Ve.$set(or)},i(Ke){Xe||(ot$4(Be.$$.fragment,Ke),ot$4(Ve.$$.fragment,Ke),Ke&&z$j(()=>{Xe&&(Je&&Je.end(1),Fe=me$2(Se,C$i,{duration:1e3,delay:0,easing:c$w}),Fe.start())}),Xe=!0)},o(Ke){var Ye,or;$t(Be.$$.fragment,Ke),$t(Ve.$$.fragment,Ke),Fe&&Fe.invalidate(),Ke&&(Je=ge$6(Se,C$i,{duration:1e3,delay:20*Math.min((or=(Ye=$e[5])==null?void 0:Ye.length)!=null?or:10,15),easing:c$w})),Xe=!1},d(Ke){Ke&&J$h(Se),Rt(Be),Rt(Ve),Ke&&Je&&Je.end()}}}function fe$2($e){let Se,Be,De;return Be=new X$3({props:{playing:$e[2]}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","audio-icon__wrapper svelte-1s6gk4a")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,Fe){const Je={};Fe&4&&(Je.playing=Ve[2]),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function ue($e){let Se,Be,De=$e[0].state&&j$d($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[0].state?De?(De.p(Ve,Fe),Fe&1&&ot$4(De,1)):(De=j$d(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function de$1($e,Se,Be){let De,Ve,Fe,{tag:Je}=Se,Xe=!1,Ke=!1,Ye;function or(){Be(1,Xe=!Xe)}const sr=()=>{Be(2,Ke=!0)},cr=()=>{Be(2,Ke=!1)},Br=()=>{Be(2,Ke=!1)};function tn(an){he$2.call(this,$e,an)}const en=an=>{Be(3,Ye=an.detail)};return $e.$$set=an=>{"tag"in an&&Be(0,Je=an.tag)},$e.$$.update=()=>{var an,rn,on;$e.$$.dirty&1&&Be(6,De=!!((an=Je.state)!=null&&an.unfolded)),$e.$$.dirty&1&&Be(5,Ve=(on=(rn=Je.data.title)!=null?rn:Je.data.text)!=null?on:""),$e.$$.dirty&2&&Be(4,Fe=Xe?450:0)},[Je,Xe,Ke,Ye,Fe,Ve,De,or,sr,cr,Br,tn,en]}class qe extends Ce$1{constructor(Se){super(),Te$1(this,Se,de$1,ue,Ft$1,{tag:0},se$1)}}function D$c($e){Qt$1($e,"svelte-nclraj",".audio-tag__wrapper.svelte-nclraj{position:absolute;left:50%;top:50%;transform:translate(-50%, -50%)}.audio-tag.svelte-nclraj{position:relative;width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content;padding:0.25rem;padding-right:0.625rem;border-radius:624999.9375rem;border:0.0625rem solid rgba(255, 255, 255, 0.6);background:linear-gradient(to bottom, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2));box-shadow:inset 0 0 0.25rem 0 rgba(255, 255, 255, 0.3)}.audio__inner.svelte-nclraj{display:flex;align-items:center;justify-content:center;width:100%;height:100%}.text.svelte-nclraj{font-weight:bold;font-size:0.75rem;margin-left:0.25rem}.audio-icon__wrapper.svelte-nclraj{position:relative;vertical-align:top;pointer-events:none;width:1.5rem;height:1.5rem}")}function y$e($e){let Se,Be,De,Ve;return De=new Z$3({props:{style:"width: max-content; height: max-content;",enable:$e[0].state.visible,url:$e[0].data.audioUrl,hooksInfo:{tag:$e[0]},$$slots:{default:[F$7]},$$scope:{ctx:$e}}}),De.$on("play",$e[5]),De.$on("pause",$e[6]),De.$on("error",$e[7]),De.$on("timeupdate",$e[8]),De.$on("duration",$e[9]),De.$on("audioRef",$e[10]),{c(){Se=K$g("div"),Be=K$g("div"),Ae$2(De.$$.fragment),te$4(Be,"class","audio-tag svelte-nclraj"),te$4(Se,"class","audio-tag__wrapper svelte-nclraj")},m(Fe,Je){Nt$1(Fe,Se,Je),pt$1(Se,Be),Dt$1(De,Be,null),Ve=!0},p(Fe,Je){const Xe={};Je&1&&(Xe.enable=Fe[0].state.visible),Je&1&&(Xe.url=Fe[0].data.audioUrl),Je&1&&(Xe.hooksInfo={tag:Fe[0]}),Je&2072&&(Xe.$$scope={dirty:Je,ctx:Fe}),De.$set(Xe)},i(Fe){Ve||(ot$4(De.$$.fragment,Fe),Ve=!0)},o(Fe){$t(De.$$.fragment,Fe),Ve=!1},d(Fe){Fe&&J$h(Se),Rt(De)}}}function E$c($e){let Se;return{c(){Se=gt$2($e[4])},m(Be,De){Nt$1(Be,Se,De)},p(Be,De){De&16&&ee$5(Se,Be[4])},d(Be){Be&&J$h(Se)}}}function F$7($e){let Se,Be,De,Ve,Fe,Je,Xe;return De=new X$3({props:{playing:$e[3]}}),Je=new P$h({props:{maxWidth:72,maxLine:1,$$slots:{default:[E$c]},$$scope:{ctx:$e}}}),{c(){Se=K$g("div"),Be=K$g("div"),Ae$2(De.$$.fragment),Ve=Xt$2(),Fe=K$g("div"),Ae$2(Je.$$.fragment),te$4(Be,"class","audio-icon__wrapper svelte-nclraj"),te$4(Fe,"class","text svelte-nclraj"),te$4(Se,"class","audio__inner svelte-nclraj")},m(Ke,Ye){Nt$1(Ke,Se,Ye),pt$1(Se,Be),Dt$1(De,Be,null),pt$1(Se,Ve),pt$1(Se,Fe),Dt$1(Je,Fe,null),Xe=!0},p(Ke,Ye){const or={};Ye&8&&(or.playing=Ke[3]),De.$set(or);const sr={};Ye&2064&&(sr.$$scope={dirty:Ye,ctx:Ke}),Je.$set(sr)},i(Ke){Xe||(ot$4(De.$$.fragment,Ke),ot$4(Je.$$.fragment,Ke),Xe=!0)},o(Ke){$t(De.$$.fragment,Ke),$t(Je.$$.fragment,Ke),Xe=!1},d(Ke){Ke&&J$h(Se),Rt(De),Rt(Je)}}}function G$4($e){let Se,Be,De=$e[0].state&&y$e($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[0].state?De?(De.p(Ve,Fe),Fe&1&&ot$4(De,1)):(De=y$e(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function H$c($e,Se,Be){let De,{tag:Ve}=Se,Fe=0,Je=0,Xe=!1;const Ke=()=>{Be(3,Xe=!0)},Ye=()=>{Be(3,Xe=!1)},or=()=>{Be(3,Xe=!1)},sr=tn=>{Be(1,Fe=tn.detail)},cr=tn=>{Be(2,Je=tn.detail)};function Br(tn){he$2.call(this,$e,tn)}return $e.$$set=tn=>{"tag"in tn&&Be(0,Ve=tn.tag)},$e.$$.update=()=>{var tn,en;$e.$$.dirty&1&&Be(4,De=(en=(tn=Ve.data.title)!=null?tn:Ve.data.text)!=null?en:"")},[Ve,Fe,Je,Xe,De,Ke,Ye,or,sr,cr,Br]}class ae extends Ce$1{constructor(Se){super(),Te$1(this,Se,H$c,G$4,Ft$1,{tag:0},D$c)}}function q$a($e){let Se,Be;return Se=new ae({props:{tag:$e[0]}}),Se.$on("audioRef",$e[2]),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=De[0]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function v$f($e){let Se,Be;return Se=new qe({props:{tag:$e[0]}}),Se.$on("audioRef",$e[2]),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=De[0]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function C$6($e){let Se,Be,De,Ve;const Fe=[v$f,q$a],Je=[];function Xe(Ke,Ye){return Ke[1]==="line"?0:Ke[1]==="plane"?1:-1}return~(Se=Xe($e))&&(Be=Je[Se]=Fe[Se]($e)),{c(){Be&&Be.c(),De=Yt$1()},m(Ke,Ye){~Se&&Je[Se].m(Ke,Ye),Nt$1(Ke,De,Ye),Ve=!0},p(Ke,[Ye]){let or=Se;Se=Xe(Ke),Se===or?~Se&&Je[Se].p(Ke,Ye):(Be&&(Lt$1(),$t(Je[or],1,1,()=>{Je[or]=null}),Ot$2()),~Se?(Be=Je[Se],Be?Be.p(Ke,Ye):(Be=Je[Se]=Fe[Se](Ke),Be.c()),ot$4(Be,1),Be.m(De.parentNode,De)):Be=null)},i(Ke){Ve||(ot$4(Be),Ve=!0)},o(Ke){$t(Be),Ve=!1},d(Ke){~Se&&Je[Se].d(Ke),Ke&&J$h(De)}}}function N$4($e,Se,Be){let De,{tag:Ve}=Se,Fe;function Je(Xe){Fe=Xe.detail}return Ve.play=()=>Fe.play(),Ve.pause=()=>Fe.pause(),$e.$$set=Xe=>{"tag"in Xe&&Be(0,Ve=Xe.tag)},$e.$$.update=()=>{var Xe;$e.$$.dirty&1&&Be(1,De=(Xe=Ve.data.appearance)!=null?Xe:"line")},[Ve,De,Je]}class rt extends Ce$1{constructor(Se){super(),Te$1(this,Se,N$4,C$6,Ft$1,{tag:0})}}function M$a($e){Qt$1($e,"svelte-10cw0el",".media-wrapper.svelte-10cw0el{position:absolute;width:100%;height:100%}")}function c$j($e){var Se;let Be,De,Ve;return De=new at({props:{mediaItemConfig:{canPlay:!0,playButtonSizeIfNeed:"large",playButtonIfNeed:(Se=$e[4])!=null?Se:"withText",disableVideoIfHavePoster:!1,objectFit:$e[2]},unfolded:$e[6],mediaData:$e[5],enableCarousel:$e[1],autoplayConfig:$e[3],tag:$e[0],inDelay:500,duration:500}}),{c(){Be=K$g("div"),Ae$2(De.$$.fragment),te$4(Be,"class","media-wrapper svelte-10cw0el")},m(Fe,Je){Nt$1(Fe,Be,Je),Dt$1(De,Be,null),Ve=!0},p(Fe,Je){var Xe;const Ke={};Je&20&&(Ke.mediaItemConfig={canPlay:!0,playButtonSizeIfNeed:"large",playButtonIfNeed:(Xe=Fe[4])!=null?Xe:"withText",disableVideoIfHavePoster:!1,objectFit:Fe[2]}),Je&64&&(Ke.unfolded=Fe[6]),Je&32&&(Ke.mediaData=Fe[5]),Je&2&&(Ke.enableCarousel=Fe[1]),Je&8&&(Ke.autoplayConfig=Fe[3]),Je&1&&(Ke.tag=Fe[0]),De.$set(Ke)},i(Fe){Ve||(ot$4(De.$$.fragment,Fe),Ve=!0)},o(Fe){$t(De.$$.fragment,Fe),Ve=!1},d(Fe){Fe&&J$h(Be),Rt(De)}}}function S$9($e){let Se,Be,De=$e[0].state&&$e[5]&&c$j($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[0].state&&Ve[5]?De?(De.p(Ve,Fe),Fe&33&&ot$4(De,1)):(De=c$j(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function V$3($e,Se,Be){let De,Ve,Fe,Je,Xe,Ke,{tag:Ye}=Se;return $e.$$set=or=>{"tag"in or&&Be(0,Ye=or.tag)},$e.$$.update=()=>{var or,sr;$e.$$.dirty&1&&Be(6,De=Ye.state?Ye.state.unfolded:!1),$e.$$.dirty&1&&Be(5,Ve=Ye.data.mediaData),$e.$$.dirty&1&&Be(1,Fe=Ye.data.enableCarousel),$e.$$.dirty&1&&Be(4,Je=Ye.data.playIcon),$e.$$.dirty&3&&Be(3,Xe=(or=Ye.data.autoplayConfig)!=null?or:{autoplay:Fe??!0,autoplayVideo:!0}),$e.$$.dirty&1&&Be(2,Ke=(sr=Ye.data.objectFit)!=null?sr:Ye.data.adaptationMode==="stretch"?"fill":Ye.data.adaptationMode==="proportional"?"contain":void 0)},[Ye,Fe,Ke,Xe,Je,Ve,De]}class gt extends Ce$1{constructor(Se){super(),Te$1(this,Se,V$3,S$9,Ft$1,{tag:0},M$a)}}var I$a=Object.defineProperty,k$8=Object.defineProperties,H$b=Object.getOwnPropertyDescriptors,w$c=Object.getOwnPropertySymbols,W$6=Object.prototype.hasOwnProperty,z$6=Object.prototype.propertyIsEnumerable,d$g=($e,Se,Be)=>Se in $e?I$a($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,f$o=($e,Se)=>{for(var Be in Se||(Se={}))W$6.call(Se,Be)&&d$g($e,Be,Se[Be]);if(w$c)for(var Be of w$c(Se))z$6.call(Se,Be)&&d$g($e,Be,Se[Be]);return $e},m$d=($e,Se)=>k$8($e,H$b(Se)),g$h=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const u$g=new Map;function y$d($e){return g$h(this,null,function*(){return new Promise((Se,Be)=>{if(!$e){Be(Error("url is empty"));return}const De=new Image;De.src=$e,De.onload=()=>Se({width:De.width,height:De.height}),De.onerror=Be})})}function K$4($e){return g$h(this,null,function*(){const{url:Se,ratio:Be=3}=$e,De=(()=>{if(u$g.has(Se))return u$g.get(Se);const Je=y$d(Se);return u$g.set(Se,Je),Je})(),{width:Ve,height:Fe}=yield De;return m$d(f$o({},$e),{width:Ve/Be,height:Fe/Be})})}function P$b($e){return g$h(this,null,function*(){const{steps:Se,url:Be,ratio:De=3,fps:Ve=24}=$e;if(!Se)throw new Error("KeyframeIcon requires steps");const{width:Fe,height:Je}=yield y$d(Be),Xe=Fe/De,Ke=Je/De,Ye=Xe/Se,or=Ke,sr=1/Ve*Se+"s";return m$d(f$o({},$e),{width:Ye,height:or,duration:sr})})}var x$d=Object.defineProperty,ee$1=Object.defineProperties,ie$1=Object.getOwnPropertyDescriptors,U$6=Object.getOwnPropertySymbols,te$1=Object.prototype.hasOwnProperty,ne$3=Object.prototype.propertyIsEnumerable,A$a=($e,Se,Be)=>Se in $e?x$d($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,N$3=($e,Se)=>{for(var Be in Se||(Se={}))te$1.call(Se,Be)&&A$a($e,Be,Se[Be]);if(U$6)for(var Be of U$6(Se))ne$3.call(Se,Be)&&A$a($e,Be,Se[Be]);return $e},K$3=($e,Se)=>ee$1($e,ie$1(Se)),R$8=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});function _e$1($e){Qt$1($e,"svelte-1j3azjf",'@keyframes svelte-1j3azjf-sprites-animation{0%{background-position:0 0}100%{background-position:100% 0}}.icon-bg.svelte-1j3azjf{position:absolute;width:141%;height:141%;top:50%;left:50%;transform:translate(-50%, -50%);border-radius:50%;overflow:hidden}.icon-bg-circle.svelte-1j3azjf{border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%}.icon-bg-circle-inner.svelte-1j3azjf{border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%}.icon-bg-circle-inner-shadow.svelte-1j3azjf{border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at center, transparent 20%, rgba(255,255,255,0.3))}.icon-bg-circle.svelte-1j3azjf::before{content:"";position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;border-radius:50%;z-index:1;border:0.0625rem solid rgba(255,255,255,0.6)}.icon-image.svelte-1j3azjf{position:relative;display:block;width:auto}.icon-keyframe.svelte-1j3azjf{background-repeat:no-repeat;background-size:auto 100%;animation-direction:normal;animation-iteration-count:infinite;animation-name:svelte-1j3azjf-sprites-animation;animation-delay:0}')}function G$3($e){$e[1]=$e[21].width}function J$5($e){$e[1]=$e[21].width,$e[18]=$e[21].height,$e[19]=$e[21].steps,$e[20]=$e[21].duration}function O$7($e){let Se,Be,De,Ve=$e[0]&&P$a();function Fe(Ke,Ye){return Ke[8]?be$1:ge$2}let Je=Fe($e),Xe=Je($e);return{c(){Se=K$g("div"),Ve&&Ve.c(),Be=Xt$2(),Xe.c(),te$4(Se,"class","icon"),ne$5(Se,"width",$e[1])},m(Ke,Ye){Nt$1(Ke,Se,Ye),Ve&&Ve.m(Se,null),pt$1(Se,Be),Xe.m(Se,null),De=!0},p(Ke,Ye){Ke[0]?Ve?Ye&1&&ot$4(Ve,1):(Ve=P$a(),Ve.c(),ot$4(Ve,1),Ve.m(Se,Be)):Ve&&(Lt$1(),$t(Ve,1,1,()=>{Ve=null}),Ot$2()),Je===(Je=Fe(Ke))&&Xe?Xe.p(Ke,Ye):(Xe.d(1),Xe=Je(Ke),Xe&&(Xe.c(),Xe.m(Se,null))),Ye&2&&ne$5(Se,"width",Ke[1])},i(Ke){De||(ot$4(Ve),De=!0)},o(Ke){$t(Ve),De=!1},d(Ke){Ke&&J$h(Se),Ve&&Ve.d(),Xe.d()}}}function P$a($e){let Se,Be;return Se=new T$a({props:{center:!0,blurRadius:24,spreadRadius:16}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function ge$2($e){let Se,Be,De={ctx:$e,current:null,token:null,hasCatch:!1,pending:je,then:we$1,catch:ke$1,value:21};return be$3(Be=$e[13](e$5({url:$e[7],ratio:$e[5]})),De),{c(){Se=Yt$1(),De.block.c()},m(Ve,Fe){Nt$1(Ve,Se,Fe),De.block.m(Ve,De.anchor=Fe),De.mount=()=>Se.parentNode,De.anchor=Se},p(Ve,Fe){$e=Ve,De.ctx=$e,Fe&160&&Be!==(Be=$e[13](e$5({url:$e[7],ratio:$e[5]})))&&be$3(Be,De)||we$2(De,$e,Fe)},d(Ve){Ve&&J$h(Se),De.block.d(Ve),De.token=null,De=null}}}function be$1($e){let Se,Be,De={ctx:$e,current:null,token:null,hasCatch:!1,pending:ze$1,then:ve$1,catch:ye$1,value:21};return be$3(Be=$e[12](e$5({url:$e[7],steps:$e[2],fps:$e[6],ratio:$e[5]})),De),{c(){Se=Yt$1(),De.block.c()},m(Ve,Fe){Nt$1(Ve,Se,Fe),De.block.m(Ve,De.anchor=Fe),De.mount=()=>Se.parentNode,De.anchor=Se},p(Ve,Fe){$e=Ve,De.ctx=$e,Fe&228&&Be!==(Be=$e[12](e$5({url:$e[7],steps:$e[2],fps:$e[6],ratio:$e[5]})))&&be$3(Be,De)||we$2(De,$e,Fe)},d(Ve){Ve&&J$h(Se),De.block.d(Ve),De.token=null,De=null}}}function ke$1($e){return{c:N$f,m:N$f,p:N$f,d:N$f}}function we$1($e){G$3($e);let Se,Be,De,Ve=$e[11]&&Q$2($e);return{c(){Ve&&Ve.c(),Se=Xt$2(),Be=K$g("img"),te$4(Be,"alt","tag-icon"),te$4(Be,"class","icon-image svelte-1j3azjf"),Wt$2(Be.src,De=$e[7])||te$4(Be,"src",De),ne$5(Be,"width",e$8(j$c({originWidth:$e[1],scale:$e[4],wantedWidth:$e[3]}).width)),ne$5(Be,"max-width","initial")},m(Fe,Je){Ve&&Ve.m(Fe,Je),Nt$1(Fe,Se,Je),Nt$1(Fe,Be,Je)},p(Fe,Je){G$3(Fe),Fe[11]?Ve?Ve.p(Fe,Je):(Ve=Q$2(Fe),Ve.c(),Ve.m(Se.parentNode,Se)):Ve&&(Ve.d(1),Ve=null),Je&128&&!Wt$2(Be.src,De=Fe[7])&&te$4(Be,"src",De),Je&184&&ne$5(Be,"width",e$8(j$c({originWidth:Fe[1],scale:Fe[4],wantedWidth:Fe[3]}).width))},d(Fe){Ve&&Ve.d(Fe),Fe&&J$h(Se),Fe&&J$h(Be)}}}function Q$2($e){let Se,Be,De,Ve,Fe;return{c(){Se=K$g("div"),Be=K$g("div"),De=K$g("div"),Ve=Xt$2(),Fe=K$g("div"),te$4(De,"class","icon-bg-circle-inner svelte-1j3azjf"),ne$5(De,"background",$e[11]),ne$5(De,"opacity",$e[10]),te$4(Fe,"class","icon-bg-circle-inner-shadow svelte-1j3azjf"),te$4(Be,"class","icon-bg-circle svelte-1j3azjf"),te$4(Se,"class","icon-bg svelte-1j3azjf")},m(Je,Xe){Nt$1(Je,Se,Xe),pt$1(Se,Be),pt$1(Be,De),pt$1(Be,Ve),pt$1(Be,Fe)},p(Je,Xe){Xe&2048&&ne$5(De,"background",Je[11]),Xe&1024&&ne$5(De,"opacity",Je[10])},d(Je){Je&&J$h(Se)}}}function je($e){return{c:N$f,m:N$f,p:N$f,d:N$f}}function ye$1($e){return{c:N$f,m:N$f,p:N$f,d:N$f}}function ve$1($e){J$5($e);let Se,Be=`url(${$e[7]})`,De=`steps(${$e[19]-1})`;return{c(){Se=K$g("div"),te$4(Se,"class","icon-keyframe svelte-1j3azjf"),ne$5(Se,"width",e$8(j$c({originWidth:$e[1],originHeight:$e[18],scale:$e[4],wantedWidth:$e[3]}).width)),ne$5(Se,"height",e$8(j$c({originWidth:$e[1],originHeight:$e[18],scale:$e[4],wantedWidth:$e[3]}).height)),ne$5(Se,"background-image",Be),ne$5(Se,"animation-duration",$e[20]),ne$5(Se,"animation-timing-function",De)},m(Ve,Fe){Nt$1(Ve,Se,Fe)},p(Ve,Fe){J$5(Ve),Fe&252&&ne$5(Se,"width",e$8(j$c({originWidth:Ve[1],originHeight:Ve[18],scale:Ve[4],wantedWidth:Ve[3]}).width)),Fe&252&&ne$5(Se,"height",e$8(j$c({originWidth:Ve[1],originHeight:Ve[18],scale:Ve[4],wantedWidth:Ve[3]}).height)),Fe&128&&Be!==(Be=`url(${Ve[7]})`)&&ne$5(Se,"background-image",Be),Fe&228&&ne$5(Se,"animation-duration",Ve[20]),Fe&228&&De!==(De=`steps(${Ve[19]-1})`)&&ne$5(Se,"animation-timing-function",De)},d(Ve){Ve&&J$h(Se)}}}function ze$1($e){return{c:N$f,m:N$f,p:N$f,d:N$f}}function We($e){let Se,Be,De=$e[9]&&O$7($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[9]?De?(De.p(Ve,Fe),Fe&512&&ot$4(De,1)):(De=O$7(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function j$c($e){const{originWidth:Se,originHeight:Be,scale:De=1,wantedWidth:Ve}=$e,Fe=(Ve??Se)*De,Je=typeof Be=="number"?Fe*(Be/Se):void 0;return K$3(N$3({},$e),{width:Fe,height:Je})}function Ie($e,Se,Be){let De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,{width:tn=null}=Se,{icon:en=null}=Se,{shadow:an=!1}=Se;const rn=fe$4();function on(cn){return R$8(this,null,function*(){const hn=yield P$b(cn);return rn("iconLoaded",hn),hn})}function sn(cn){return R$8(this,null,function*(){if(typeof Br=="number")return K$3(N$3({},cn),{width:Br});const hn=yield K$4(cn);return rn("iconLoaded",hn),hn})}function ln(){cr||rn("iconLoaded")}return ce$2(()=>{ln()}),$e.$$set=cn=>{"width"in cn&&Be(1,tn=cn.width),"icon"in cn&&Be(14,en=cn.icon),"shadow"in cn&&Be(0,an=cn.shadow)},$e.$$.update=()=>{var cn,hn,mn;$e.$$.dirty&16384&&Be(7,De=en?.url),$e.$$.dirty&16384&&Be(11,Ve=en?.bgcolor),$e.$$.dirty&16384&&Be(10,Fe=(cn=en?.bgopacity)!=null?cn:.6),$e.$$.dirty&16384&&Be(2,Je=(hn=en?.steps)!=null?hn:1),$e.$$.dirty&16384&&Be(6,Xe=en?.fps),$e.$$.dirty&16384&&Be(5,Ke=en?.ratio),$e.$$.dirty&16384&&Be(4,Ye=(mn=en?.scale)!=null?mn:1),$e.$$.dirty&16384&&Be(3,or=en?.width),$e.$$.dirty&252&&Be(9,sr=e$5({url:De,steps:Je,fps:Xe,ratio:Ke,scale:Ye,width:or})),$e.$$.dirty&4&&Be(8,cr=Je>1),$e.$$.dirty&2&&(Br=tn)},ln(),[an,tn,Je,or,Ye,Ke,Xe,De,cr,sr,Fe,Ve,on,sn,en]}let Ee$1=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,Ie,We,Ft$1,{width:1,icon:14,shadow:0},_e$1)}};function K$2($e){Qt$1($e,"svelte-e58ijk",".wrapper.svelte-e58ijk{font-weight:600;cursor:pointer;width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content;position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);display:flex;align-items:center;justify-content:center;flex-direction:column;pointer-events:auto}.text-wrapper.svelte-e58ijk{position:relative;display:flex;align-items:center;justify-content:center}.text.svelte-e58ijk{position:absolute;top:0;font-size:0.875rem;color:#ffffff;letter-spacing:0;text-align:center;max-width:8.75rem;width:-moz-max-content;width:max-content;line-height:1.125rem;text-shadow:0.125rem 0rem 0.5rem rgba(0, 0, 0, 0.15)}")}function z$5($e){let Se,Be,De,Ve,Fe,Je;return Be=new T$a({props:{outDelay:0,inDelay:0,center:!0,width:"80%",blurRadius:40,spreadRadius:16,opacity:.08}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),De=Xt$2(),Ve=K$g("div"),Fe=gt$2($e[2]),te$4(Ve,"class","text svelte-e58ijk"),ne$5(Ve,"top",$e[1]),te$4(Se,"class","text-wrapper svelte-e58ijk")},m(Xe,Ke){Nt$1(Xe,Se,Ke),Dt$1(Be,Se,null),pt$1(Se,De),pt$1(Se,Ve),pt$1(Ve,Fe),Je=!0},p(Xe,Ke){(!Je||Ke&4)&&ee$5(Fe,Xe[2]),Ke&2&&ne$5(Ve,"top",Xe[1])},i(Xe){Je||(ot$4(Be.$$.fragment,Xe),Je=!0)},o(Xe){$t(Be.$$.fragment,Xe),Je=!1},d(Xe){Xe&&J$h(Se),Rt(Be)}}}function M$9($e){let Se,Be,De,Ve;Be=new Ee$1({props:{icon:$e[0],shadow:!0}}),Be.$on("iconLoaded",$e[8]);let Fe=$e[2]&&$e[3]&&z$5($e);return{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),De=Xt$2(),Fe&&Fe.c(),te$4(Se,"class","wrapper svelte-e58ijk")},m(Je,Xe){Nt$1(Je,Se,Xe),Dt$1(Be,Se,null),pt$1(Se,De),Fe&&Fe.m(Se,null),Ve=!0},p(Je,[Xe]){const Ke={};Xe&1&&(Ke.icon=Je[0]),Be.$set(Ke),Je[2]&&Je[3]?Fe?(Fe.p(Je,Xe),Xe&12&&ot$4(Fe,1)):(Fe=z$5(Je),Fe.c(),ot$4(Fe,1),Fe.m(Se,null)):Fe&&(Lt$1(),$t(Fe,1,1,()=>{Fe=null}),Ot$2())},i(Je){Ve||(ot$4(Be.$$.fragment,Je),ot$4(Fe),Ve=!0)},o(Je){$t(Be.$$.fragment,Je),$t(Fe),Ve=!1},d(Je){Je&&J$h(Se),Rt(Be),Fe&&Fe.d()}}}const O$6=4;function Q$1($e,Se,Be){let De,Ve,Fe,Je,Xe,Ke,Ye,{tag:or}=Se;const sr=()=>{Be(3,De=!0)};return $e.$$set=cr=>{"tag"in cr&&Be(4,or=cr.tag)},$e.$$.update=()=>{var cr,Br,tn,en,an,rn,on,sn;$e.$$.dirty&16&&Be(2,Ve=(cr=or.data.title)!=null?cr:or.data.text),$e.$$.dirty&16&&Be(0,Fe=(tn=or.data.icon)!=null?tn:(Br=or.style)==null?void 0:Br.point),$e.$$.dirty&16&&Be(6,Je=(an=(en=or.style)==null?void 0:en.point)==null?void 0:an.width),$e.$$.dirty&16&&Be(5,Xe=(sn=(on=(rn=or.style)==null?void 0:rn.point)==null?void 0:on.scale)!=null?sn:1),$e.$$.dirty&1&&Be(7,Ke=Fe?.bgcolor),$e.$$.dirty&224&&Be(1,Ye=Ke&&Je&&typeof Je=="number"?e$8(Je*.414*Xe/2+O$6):0)},Be(3,De=!1),[Fe,Ye,Ve,De,or,Xe,Je,Ke,sr]}class nt extends Ce$1{constructor(Se){super(),Te$1(this,Se,Q$1,M$9,Ft$1,{tag:4},K$2)}}var A$9=Object.defineProperty,D$b=Object.defineProperties,E$b=Object.getOwnPropertyDescriptors,H$a=Object.getOwnPropertySymbols,F$6=Object.prototype.hasOwnProperty,J$4=Object.prototype.propertyIsEnumerable,R$7=($e,Se,Be)=>Se in $e?A$9($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,q$9=($e,Se)=>{for(var Be in Se||(Se={}))F$6.call(Se,Be)&&R$7($e,Be,Se[Be]);if(H$a)for(var Be of H$a(Se))J$4.call(Se,Be)&&R$7($e,Be,Se[Be]);return $e},B$b=($e,Se)=>D$b($e,E$b(Se));function Y$2($e){Qt$1($e,"svelte-ezi5lu",`.icon.svelte-ezi5lu{font-size:0}.icon-bg.svelte-ezi5lu{position:absolute;width:141%;height:141%;top:50%;left:50%;transform:translate(-50%, -50%);border-radius:50%;overflow:hidden;z-index:-1}.icon-bg-circle.svelte-ezi5lu{border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%}.icon-bg-circle-inner.svelte-ezi5lu{border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%}.icon-bg-circle-inner-shadow.svelte-ezi5lu{border-radius:50%;position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at center, transparent 20%, rgba(255,255,255,0.3))}.icon-bg-circle.svelte-ezi5lu::before{content:"";position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;border-radius:50%;background:linear-gradient(-45deg, rgba(255,255,255,1), rgba(255,255,255,0.2), rgba(255,255,255,1));z-index:1;mask:radial-gradient(circle at center, 
              transparent 65%, 
              black 0%);-webkit-mask:radial-gradient(circle at center, 
              transparent 65%, 
              black 0%)}`)}function C$5($e){let Se,Be;return Se=new T$a({props:{center:!0,blurRadius:24,spreadRadius:16}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function I$9($e){let Se,Be,De,Ve,Fe;return{c(){Se=K$g("div"),Be=K$g("div"),De=K$g("div"),Ve=Xt$2(),Fe=K$g("div"),te$4(De,"class","icon-bg-circle-inner svelte-ezi5lu"),ne$5(De,"background",$e[4]),ne$5(De,"opacity",$e[3]),te$4(Fe,"class","icon-bg-circle-inner-shadow svelte-ezi5lu"),te$4(Be,"class","icon-bg-circle svelte-ezi5lu"),te$4(Se,"class","icon-bg svelte-ezi5lu")},m(Je,Xe){Nt$1(Je,Se,Xe),pt$1(Se,Be),pt$1(Be,De),pt$1(Be,Ve),pt$1(Be,Fe)},p(Je,Xe){Xe&16&&ne$5(De,"background",Je[4]),Xe&8&&ne$5(De,"opacity",Je[3])},d(Je){Je&&J$h(Se)}}}function Z$2($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an=$e[1]&&C$5(),rn=$e[4]&&I$9($e);return{c(){Se=K$g("div"),an&&an.c(),Be=Xt$2(),rn&&rn.c(),De=Xt$2(),Ve=Mt("svg"),Fe=Mt("linearGradient"),Je=Mt("stop"),Xe=Mt("stop"),Ke=Mt("linearGradient"),Ye=Mt("stop"),or=Mt("stop"),sr=Mt("g"),cr=Mt("path"),Br=Mt("path"),tn=Mt("path"),te$4(Je,"offset","0"),te$4(Je,"stop-color","#fff"),te$4(Xe,"offset","1"),te$4(Xe,"stop-color","#fff"),te$4(Xe,"stop-opacity",".7"),te$4(Fe,"id","a"),te$4(Fe,"x1","78.74567%"),te$4(Fe,"x2","5.663764%"),te$4(Fe,"y1","94.075617%"),te$4(Fe,"y2","5.924383%"),te$4(Ye,"offset","0"),te$4(Ye,"stop-color","#fff"),te$4(or,"offset","1"),te$4(or,"stop-color","#fff"),te$4(or,"stop-opacity","0"),te$4(Ke,"id","b"),te$4(Ke,"x1","16.588502%"),te$4(Ke,"x2","68.285986%"),te$4(Ke,"y1","5.924383%"),te$4(Ke,"y2","63.800896%"),te$4(cr,"d","m18 5.4v8c0 1.9329966-4.0294373 3.5-9 3.5-4.97056275 0-9-1.5670034-9-3.5v-8c0 1.93299662 4.02943725 3.5 9 3.5 4.8670094 0 8.8316983-1.50239169 8.9947813-3.37967512zm-13.0396582-.5c.259 0 .504-.063.728-.196.441-.259.721-.728.721-1.26 0-.441-.189-.833-.504-1.085.259-.259.434-.63.434-1.022 0-.245-.063-.476-.182-.679-.252-.413-.693-.658-1.197-.658-.238 0-.462.056-.665.175-.42.238-.679.665-.679 1.162v.035h.721v-.035c0-.315.294-.616.623-.616.357 0 .651.287.651.616 0 .371-.287.658-.651.658h-.14v.728h.14c.399 0 .728.322.728.721s-.329.735-.728.735-.728-.336-.728-.735v-.105h-.728v.105c0 .266.063.511.196.728.259.448.728.728 1.26.728zm3.647 0c.273 0 .518-.07.749-.203.448-.273.742-.763.742-1.302 0-.273-.07-.518-.203-.749-.273-.448-.749-.742-1.288-.742-.077 0-.133 0-.168.007l.875-1.911h-.805l-1.274 2.793c-.091.189-.133.392-.133.602 0 .273.07.525.203.756.273.455.749.749 1.302.749zm0-.742c-.427 0-.763-.336-.763-.763 0-.42.343-.77.763-.77s.77.35.77.77-.35.763-.77.763zm3.654.749c.504 0 .952-.273 1.204-.7.126-.21.189-.441.189-.693v-2.086c0-.511-.273-.98-.693-1.239-.217-.126-.448-.189-.7-.189-.511 0-.98.273-1.232.714-.133.217-.196.455-.196.714v2.086c0 .504.273.952.714 1.204.217.126.455.189.714.189zm0-.721c-.371 0-.693-.301-.693-.672v-2.086c0-.399.308-.693.693-.693.371 0 .651.294.651.693v2.086c0 .385-.28.672-.651.672zm3.2140391-2.11266016c.2734375 0 .5132649-.09855143.7194824-.29565429.2062174-.19710287.3093262-.44376628.3093262-.73999024 0-.28710937-.0991211-.53035481-.2973633-.72973633-.1982422-.19938151-.4420573-.29907226-.7314453-.29907226-.2825521 0-.5257976.10026042-.7297364.30078125s-.3059082.44661458-.3059082.73828125c0 .2734375.0968425.51269531.2905274.71777344.1936849.20507812.4420573.30761718.7451172.30761718zm0-.37255859c-.1822917 0-.3383789-.06494141-.4682618-.19482422-.1298828-.12988281-.1948242-.28369141-.1948242-.46142578 0-.18457031.0655111-.34122721.1965332-.4699707.1310222-.12874349.2865397-.19311524.4665528-.19311524.180013 0 .3343912.06494141.4631347.19482422s.1931153.28369141.1931153.46142578c0 .18457031-.0655111.34122722-.1965332.46997071-.1310222.12874349-.2842611.19311523-.4597168.19311523z"),te$4(cr,"fill","url(#a)"),te$4(cr,"fill-rule","nonzero"),te$4(Br,"d","m18 5.4v8c0 1.9329966-4.0294373 3.5-9 3.5-4.97056275 0-9-1.5670034-9-3.5v-8c0 1.93299662 4.02943725 3.5 9 3.5 4.8670094 0 8.8316983-1.50239169 8.9947813-3.37967512zm-.537 1.917-.0556083.04651904c-1.6129673 1.27557869-4.7855335 2.07278608-8.4073917 2.07278608-3.5667171 0-6.69228643-.77164105-8.32741897-2.0099189l-.13658103-.10838622.00030512 6.082c0 1.4658868 3.60570734 2.8999734 8.15878222 2.9616322l.30491266.0020627c4.6959533 0 8.4636949-1.4652329 8.4636949-2.9636949zm-5.2016582-7.317c.252 0 .483.063.7.189.42.259.693.728.693 1.239v2.086l-.00756.14868c-.02016.19488-.08064.37632-.18144.54432-.252.427-.7.7-1.204.7-.259 0-.497-.063-.714-.189-.441-.252-.714-.7-.714-1.204v-2.086l.007616-.15288c.020384-.20048.081984-.38752.188384-.56112.252-.441.721-.714 1.232-.714zm-7.301 0c.504 0 .945.245 1.197.658.119.203.182.434.182.679 0 .392-.175.763-.434 1.022.315.252.504.644.504 1.085 0 .532-.28 1.001-.721 1.26-.224.133-.469.196-.728.196-.532 0-1.001-.28-1.26-.728-.133-.217-.196-.462-.196-.728v-.105h.728v.105c0 .399.329.735.728.735s.728-.336.728-.735-.329-.721-.728-.721h-.14v-.728h.14c.364 0 .651-.287.651-.658 0-.329-.294-.616-.651-.616-.329 0-.623.301-.623.616v.035h-.721v-.035c0-.497.259-.924.679-1.162.203-.119.427-.175.665-.175zm4.354 0-.875 1.911c.035-.007.091-.007.168-.007.539 0 1.015.294 1.288.742.133.231.203.476.203.749 0 .539-.294 1.029-.742 1.302-.231.133-.476.203-.749.203-.553 0-1.029-.294-1.302-.749-.133-.231-.203-.483-.203-.756 0-.21.042-.413.133-.602l1.274-2.793zm2.947.735c-.385 0-.693.294-.693.693v2.086l.0077784.09927273c.051172.32396694.3479489.57272727.6852216.57272727.371 0 .651-.287.651-.672v-2.086l-.0068002-.10607288c-.044861-.34395191-.3069271-.58692712-.6441998-.58692712zm-3.654 1.89c-.42 0-.763.35-.763.77 0 .427.336.763.763.763.42 0 .77-.343.77-.763s-.35-.77-.77-.77zm6.8680391-2.61611328c.289388 0 .5332031.09969075.7314453.29907226.1982422.19938152.2973633.44262696.2973633.72973633 0 .29622396-.1031088.54288737-.3093262.73999024-.2062175.19710286-.4460449.29565429-.7194824.29565429-.3030599 0-.5514323-.10253906-.7451172-.30761718-.1936849-.20507813-.2905274-.44433594-.2905274-.71777344 0-.29166667.1019694-.53776042.3059082-.73828125s.4471843-.30078125.7297364-.30078125zm0 .37255859c-.1800131 0-.3355306.06437175-.4665528.19311524-.1310221.12874349-.1965332.28540039-.1965332.4699707 0 .17773437.0649414.33154297.1948242.46142578.1298829.12988281.2859701.19482422.4682618.19482422.1754557 0 .3286946-.06437174.4597168-.19311523.1310221-.12874349.1965332-.2854004.1965332-.46997071 0-.17773437-.0643718-.33154297-.1931153-.46142578s-.2831217-.19482422-.4631347-.19482422z"),te$4(Br,"fill","url(#b)"),te$4(Br,"fill-rule","nonzero"),te$4(tn,"d","m3.00030998 2.79110119v5.21779762c-1.84142801-.64087734-3.00030998-1.57225753-3.00030998-2.60889881s1.15888197-1.96802147 3.00030998-2.60889881zm12.00038752.00035068c1.8408432.64086639 2.9993025 1.57209591 2.9993025 2.60854813s-1.1584593 1.96768174-2.9993025 2.60854813z"),te$4(tn,"fill","#d8d8d8"),te$4(tn,"opacity",".6"),te$4(sr,"fill","none"),te$4(sr,"fill-rule","evenodd"),te$4(sr,"transform","translate(3 3.1)"),te$4(Ve,"height",$e[2]),te$4(Ve,"width",$e[2]),te$4(Ve,"viewBox","0 0 24 24"),te$4(Ve,"xmlns","http://www.w3.org/2000/svg"),te$4(Ve,"xmlns:xlink","http://www.w3.org/1999/xlink"),te$4(Se,"class","icon svelte-ezi5lu"),ne$5(Se,"width",$e[0])},m(on,sn){Nt$1(on,Se,sn),an&&an.m(Se,null),pt$1(Se,Be),rn&&rn.m(Se,null),pt$1(Se,De),pt$1(Se,Ve),pt$1(Ve,Fe),pt$1(Fe,Je),pt$1(Fe,Xe),pt$1(Ve,Ke),pt$1(Ke,Ye),pt$1(Ke,or),pt$1(Ve,sr),pt$1(sr,cr),pt$1(sr,Br),pt$1(sr,tn),en=!0},p(on,[sn]){on[1]?an?sn&2&&ot$4(an,1):(an=C$5(),an.c(),ot$4(an,1),an.m(Se,Be)):an&&(Lt$1(),$t(an,1,1,()=>{an=null}),Ot$2()),on[4]?rn?rn.p(on,sn):(rn=I$9(on),rn.c(),rn.m(Se,De)):rn&&(rn.d(1),rn=null),(!en||sn&4)&&te$4(Ve,"height",on[2]),(!en||sn&4)&&te$4(Ve,"width",on[2]),sn&1&&ne$5(Se,"width",on[0])},i(on){en||(ot$4(an),en=!0)},o(on){$t(an),en=!1},d(on){on&&J$h(Se),an&&an.d(),rn&&rn.d()}}}function $$2($e){const{originWidth:Se,originHeight:Be,scale:De=1,wantedWidth:Ve}=$e,Fe=(Ve??Se)*De,Je=typeof Be=="number"?Fe*(Be/Se):void 0;return B$b(q$9({},$e),{width:Fe,height:Je})}function e2($e,Se,Be){let De,Ve,Fe,Je,Xe,{width:Ke=null}=Se,{icon:Ye=null}=Se,{shadow:or=!1}=Se;return $e.$$set=sr=>{"width"in sr&&Be(0,Ke=sr.width),"icon"in sr&&Be(5,Ye=sr.icon),"shadow"in sr&&Be(1,or=sr.shadow)},$e.$$.update=()=>{var sr,cr;$e.$$.dirty&32&&Be(4,De=Ye?.bgcolor),$e.$$.dirty&32&&Be(3,Ve=(sr=Ye?.bgopacity)!=null?sr:.6),$e.$$.dirty&32&&Be(7,Fe=(cr=Ye?.scale)!=null?cr:1),$e.$$.dirty&32&&Be(6,Je=Ye?.width),$e.$$.dirty&192&&Be(2,Xe=$$2({originWidth:24,originHeight:24,scale:Fe,wantedWidth:Je}).width)},[Ke,or,Xe,Ve,De,Ye,Je,Fe]}class r2 extends Ce$1{constructor(Se){super(),Te$1(this,Se,e2,Z$2,Ft$1,{width:0,icon:5,shadow:1},Y$2)}}function v$e($e){Qt$1($e,"svelte-yq4ru9",".wrapper.svelte-yq4ru9{font-weight:600;cursor:pointer;width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content;position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);display:flex;align-items:center;justify-content:center;flex-direction:column;pointer-events:auto}")}function $$1($e){let Se,Be,De;return Be=new r2({props:{icon:$e[0],shadow:!0}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","wrapper svelte-yq4ru9")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,[Fe]){const Je={};Fe&1&&(Je.icon=Ve[0]),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function q$8($e,Se,Be){let De,{tag:Ve}=Se;return $e.$$set=Fe=>{"tag"in Fe&&Be(1,Ve=Fe.tag)},$e.$$.update=()=>{var Fe,Je;$e.$$.dirty&2&&Be(0,De=(Je=Ve.data.icon)!=null?Je:(Fe=Ve.style)==null?void 0:Fe.point)},[De,Ve]}let I$8=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,q$8,$$1,Ft$1,{tag:1},v$e)}};function T$8($e){Qt$1($e,"svelte-kzl2aj",".customElement__container.svelte-kzl2aj{position:relative}")}function q$7($e){let Se,Be;return{c(){Se=new se$2(!1),Be=Yt$1(),Se.a=Be},m(De,Ve){Se.m($e[2],De,Ve),Nt$1(De,Be,Ve)},p:N$f,d(De){De&&J$h(Be),De&&Se.d()}}}function D$a($e){let Se,Be=typeof $e[2]=="string"&&q$7($e);return{c(){Se=K$g("div"),Be&&Be.c(),te$4(Se,"class","customElement__container svelte-kzl2aj"),re$2(Se,"unfolded",$e[1])},m(De,Ve){Nt$1(De,Se,Ve),Be&&Be.m(Se,null),$e[5](Se)},p(De,[Ve]){typeof De[2]=="string"&&Be.p(De,Ve),Ve&2&&re$2(Se,"unfolded",De[1])},i:N$f,o:N$f,d(De){De&&J$h(Se),Be&&Be.d(),$e[5](null)}}}function H$9($e,Se,Be){var De,Ve;let Fe,{tag:Je}=Se,{rendererMap:Xe=new Map}=Se,Ke,Ye=(Ve=Je.element)!=null?Ve:(De=Xe.get(Je.contentType))==null?void 0:De.renderer,or;ce$2(()=>{Ke&&(Ye instanceof Element?(Ke.appendChild(Ye),or=()=>{Ye instanceof Element&&Ye.remove()}):typeof Ye=="function"&&(or=Ye(Ke,Je)))}),le$1(()=>{or?.()});function sr(cr){ft$1[cr?"unshift":"push"](()=>{Ke=cr,Be(0,Ke)})}return $e.$$set=cr=>{"tag"in cr&&Be(3,Je=cr.tag),"rendererMap"in cr&&Be(4,Xe=cr.rendererMap)},$e.$$.update=()=>{$e.$$.dirty&8&&Be(1,Fe=Je.state.unfolded)},[Ke,Fe,Ye,Je,Xe,sr]}let A$8=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,H$9,D$a,Ft$1,{tag:3,rendererMap:4},T$8)}};function BA($e){Qt$1($e,"svelte-1fy4duy",'@font-face{font-family:"TG-TYPE";font-style:normal;font-weight:400;src:local("TG-TYPE-Bold"), url(data:application/font-woff2;charset=utf-8;base64,T1RUTwAKAIAAAwAgQ0ZGINFD4CEAAAaQAAAHC0dTVUIAAQAAAAANnAAAAApPUy8yaB5pEwAAAjQAAABgY21hcEItjGUAAAT0AAABfGhlYWQS1WWOAAAAtAAAADZoaGVhBfMBxwAAAhAAAAAkaG10eJ9gBO8AAADsAAABJG1heHAASVAAAAAArAAAAAZuYW1lqczkZQAAApQAAAJecG9zdP+4ADIAAAZwAAAAIAAAUAAASQAAAAEAAAABAADkeHeyXw889QADA+gAAAAA2NoRKwAAAADY2hErACn/OAHgAyAAAQADAAIAAAAAAAAB9ABdAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACWAAAAlgAAAJYAAACCAA7AcwAdwIIADMCCAA0AhwAMwISADkCCAAuAfQANAH+ACsB/gApAggANAEeAFABHgBQAR4AUAIIADQCCAAuAR4AUAEeAFABfAAxAAEAAAPo/zgAAAIcACkAKQHgAAEAAAAAAAAAAAAAAAAAAABJAAMCLgGQAAUACAKKAlgAAABLAooCWAAAAV4AMgEsAAAAAAgAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFVLV04AIAAg/xsDIP84AMgD6ADIAAAAAQAAAAAB9AK8AAAAIAAAAAAAEADGAAEAAAAAAAEADAAAAAEAAAAAAAIABAAMAAEAAAAAAAMAGwAQAAEAAAAAAAQAEQArAAEAAAAAAAUAPAA8AAEAAAAAAAYAEAB4AAEAAAAAAAgADAAAAAEAAAAAAAkADAAAAAMAAQQJAAEAGACIAAMAAQQJAAIACACgAAMAAQQJAAMANgCoAAMAAQQJAAQAIgDeAAMAAQQJAAUAeAEAAAMAAQQJAAYAIAF4AAMAAQQJAAgAGACIAAMAAQQJAAkAGACIQUxJQkFCQSBGb250Qm9sZDEuMDAwO1VLV047QUxJQkFCQUZvbnQtQm9sZEFMSUJBQkEgRm9udCBCb2xkVmVyc2lvbiAxLjAwMDtQUyAwMDEuMDAwO2hvdGNvbnYgMS4wLjg4O21ha2VvdGYubGliMi41LjY0Nzc1QUxJQkFCQUZvbnQtQm9sZABBAEwASQBCAEEAQgBBACAARgBvAG4AdABCAG8AbABkADEALgAwADAAMAA7AFUASwBXAE4AOwBBAEwASQBCAEEAQgBBAEYAbwBuAHQALQBCAG8AbABkAEEATABJAEIAQQBCAEEAIABGAG8AbgB0ACAAQgBvAGwAZABWAGUAcgBzAGkAbwBuACAAMQAuADAAMAAwADsAUABTACAAMAAwADEALgAwADAAMAA7AGgAbwB0AGMAbwBuAHYAIAAxAC4AMAAuADgAOAA7AG0AYQBrAGUAbwB0AGYALgBsAGkAYgAyAC4ANQAuADYANAA3ADcANQBBAEwASQBCAEEAQgBBAEYAbwBuAHQALQBCAG8AbABkAAAAAAADAAAAAwAAASIAAQAAAAAAHAADAAEAAAEiAAABBgAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAABCSEMANjc4OTo7PD0+PwAAAAAAAAACAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGwAAAAAAABwdHh8gISIjJCUmJygpKissLS4vMDEyMzQ1AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAFoAAAAQABAAAwAAACAALgA5AFoAegCl/xv//wAAACAALAAwAEEAYQCl/xr////hAAAABv/B/7v/nwAAAAEAAAAOAAAAAAAAAAAACgAAAEIASABDAEYARwADAAAAAAAA/7UAMgAAAAAAAAAAAAAAAAAAAAAAAAAAAQAEAgABAQERQUxJQkFCQUZvbnQtQm9sZAABAQEg+A8A+CAB+CEC+BgEtPtc+HT5tAX3KA/3UBGcHAZWEgAHAQENExoiKTpLbmluZS4wMDEuMDAxbW9uZXkudW5pRkYxQm5pbmUuMDAxdW5pRkYxQWNvcHlyaWdodCBtaXNzaW5nQUxJQkFCQSBGb250IEJvbGQAAAEAAQAAIhkAQhkAEQkBhwABigAADQAADwAAZAABiAABiwABiQAADgAASQIAAQCtAK4ArwCwALEAsgCzALQAtQC2ALcAuAC5ALoAuwC8AL0AvgC/AMAAwQDCAMMAxADFAMYAxwDIAMkAygDLAMwAzQDOAM8A0ADRANIA0wDUANUA1gDXANgA2QDaANsA3ADdAN4A3wDgAOEA4gFDAVoBqwIsAloCuAMcAzkDzwQ4BDoEPARRBFMEVQTNBOIE8QUEmPtc0Ky6rKKsuqzHrKPDoa2irLCspq2vraWssKzOAejVrKytrKzYA/gu+bQV+9H+fPfRBj76ORVqSWbNavs6rM2wSqwH7vsVFUXNafs68wfNaRVqZ6wG704VaklFJ6zNsEmsB/c6TxUn+zqt9xnNB6z7DhX7Bfs69wWsO++6anRpwwfv+0EV+wX7OvcFB/cZahUnXO8GrFMVamsHRVwF8Wr7OqwG0boFRawGDg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4OrIr5UQH3OPdUA/ebihVmaZSdbB9Mr2TL0xr3vgewlK2eqh7Kr86y1BuvrIJ5qh/HZrJIQhr7vgdngmp5bR5OZ0tkQxv46ARUX2FSH/u+B1a5YMDAs7TCHve+B8RjtVYeDnD4utkB93HzA/cL+QgVPfH8vPP5UgcOrIn5UgG++DYD+GmJFfw28wb3svfUBZ2glKSnGsNduFBWXF1UiB4ijgaMsJWsnqoIyLHMstYbsa6Ceawfy2ezSUAaVndXZ2Me+2/7jQX3pwYOrIvy92Tz90ryEr/zM/L3SvMu8hPy+B/3/xUT7LCwpMDDGq6CrHqoHsZnTK5DG2lrg3puH09pZk5EGobykAe4tba6vrViXFZiYlcedyOfBhPyxLpdUlJcW1JSXLvEH5ojfAdllGiebB5LsM5j1xuwrpSeqx/KsLPO1xrKcMNerx4OwPL1Affi8gP4dPdlFWD4fPshBvuJ/HkF+wH3ryPy87YH+8z1Ffc69+QF++QHDrb3ZNf3ZfAB9zX3YwP3nRZlaJSebB9LsGPO1xrzBlK6XMTEubrEHtcHxF26UlJcXFIeI/g0+BYh+677JAaorK2ZsBuwroJ4qx/LZrNHPxo/B2aCaHhrHktmR2NAGw6si/X3b/IBufX3b/ID95n4QBWAg4uKhh/3EfelBfsHBvtK/CMFfnCFbm0aZJVnnmoeSrLPYdobsq6Vnqwfy7K10dgasoGueKwey2RHtT4b+9YETlu7yMe8vcfHvVlPT1laTx8OmIr5UQG/+B8D93iKFfsIBvdo+OYF+6T2+B8oBg6iifL3bPX3QPEStvNB8vc/8jXxE/L4EvgHFRPss7Cnu78arYOreqgexWpNr0YbaWyDem4fUmlmTUcaXqBftGAeE/JWYmROSxpklWieax5Ksc9i2BuxrpWerB/LsbTP2BrHaMVath4T7PsN93QVu7FjXFtlZltcZbC7urGzuh8T8oX8ghVPW7zHx7q6yMa9W1BPWVpQHw6i96Tz92/0AbTz93DzA/hp+HkVsIGveKwezmNFtUAbZGeBeGofSmNiRT8aZJVnnmseSrHPYtoboAb7EvukBfcHBvdL+CEFmaySqaQa+9gWxry+yJ6dhoGcHq12oWZmGk5YW1BMXLnKHg4gCiEK+11L91IlCvdiyhWtb6hpJgoeJAoOIQogCqz3pe/3b/UBufX3bfQD+G74dxWyga94rB7NZEW0PhtlaIF4ah9KY2FFPxo7tkTPZh6MjIqKjB+TiJCIjYoIjgaCoKGHoRuanY6QoB+IgfsB+6QF9wcG9y/4IgWYppGnqhr7a/sCFVBbvMjHu7zGyLxbTk5aWk4fDvtd+AojCoz7jBUmCh8kCq1vqGkeDvtdi/cS94wjCvwKBCIKDiD3ru8BvPeuA7z4EhUn967vBw4eoDf/DAmLDAv47BT4exWcEwAHAQFBXW97ipCarPcv8+7yAfdl8gP4aPf6FfIjB+r3gwUiBi77gwWHBjH3gwUkBuP7gwUnJPcxKPsxI/cx+y/y9y/3MPP7MO4GDvtdi/cSJQr3JBZkcqOzsKSksrCkcWdlcnFmHw6up6eurm+naGhvb2hop2+uHwv3EiUK9yP4ChUiCgt3SgWxBrnmBZGVj5eZGgsB2/cSAwtobm5paqBzqoYLAAABAAAAAAAAAAAAAA==) format("woff2")}*{-webkit-tap-highlight-color:transparent}.content__container.svelte-1fy4duy{position:relative;left:50%;top:50%;transform:translate(-50%, -50%);font-family:PingFangSC, Segoe UI, Rototo, sans-serif;transition:opacity 0.2s linear}.content__container.unClickable.svelte-1fy4duy{pointer-events:none !important}.content__container.unClickable.svelte-1fy4duy *{pointer-events:none !important}.content__wrapper.svelte-1fy4duy{pointer-events:none;width:100%;height:100%}.content__container.hide.svelte-1fy4duy{opacity:0;pointer-events:none}.content__container.hide.svelte-1fy4duy *{pointer-events:none !important}.content__container.disable.svelte-1fy4duy{display:none}.content.svelte-1fy4duy{position:relative;width:100%;height:100%;font-size:0.75rem;color:#fff}.content.svelte-1fy4duy:not(.unfolded){pointer-events:none}.content.svelte-1fy4duy:not(.unfolded) *{pointer-events:none !important}.content.unfolded.svelte-1fy4duy{pointer-events:auto;cursor:pointer}')}function _A($e){let Se,Be;return{c(){Se=K$g("div"),te$4(Se,"data-info","tag content is keep folded"),te$4(Se,"data-id",Be=$e[0].id)},m(De,Ve){Nt$1(De,Se,Ve)},p(De,Ve){Ve&1&&Be!==(Be=De[0].id)&&te$4(Se,"data-id",Be)},i:N$f,o:N$f,d(De){De&&J$h(Se)}}}function QA($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an,rn;const on=[MA,DA,hA,yA,bA,CA,kA],sn=[];function ln(cn,hn){return hn&9&&(Ve=null),hn&9&&(Fe=null),hn&9&&(Je=null),hn&9&&(Xe=null),hn&9&&(Ke=null),hn&9&&(Ye=null),hn&9&&(or=null),Ve==null&&(Ve=!!(["Text"].includes(cn[0].contentType)||["Text"].includes(cn[3].get(cn[0].contentType)))),Ve?0:(Fe==null&&(Fe=!!(["ImageText","Image","Video"].includes(cn[0].contentType)||["ImageText","Image","Video"].includes(cn[3].get(cn[0].contentType)))),Fe?1:(Je==null&&(Je=!!(["Audio"].includes(cn[0].contentType)||["Audio"].includes(cn[3].get(cn[0].contentType)))),Je?2:(Xe==null&&(Xe=!!(["Marketing"].includes(cn[0].contentType)||["Marketing"].includes(cn[3].get(cn[0].contentType)))),Xe?3:(Ke==null&&(Ke=!!(["Link","VRLink","PanoLink","Sticker"].includes(cn[0].contentType)||["Link","VRLink","PanoLink","Sticker"].includes(cn[3].get(cn[0].contentType)))),Ke?4:(Ye==null&&(Ye=!!(["MediaPlane","MediaModel"].includes(cn[0].contentType)||["MediaPlane","MediaModel"].includes(cn[3].get(cn[0].contentType)))),Ye?5:(or==null&&(or=!!(["Panorama"].includes(cn[0].contentType)||["Panorama"].includes(cn[3].get(cn[0].contentType)))),or?6:-1))))))}return~(sr=ln($e,-1))&&(cr=sn[sr]=on[sr]($e)),{c(){var cn;Se=K$g("div"),Be=K$g("div"),De=K$g("div"),cr&&cr.c(),te$4(De,"class","content svelte-1fy4duy"),re$2(De,"unfolded",(cn=$e[0].state)==null?void 0:cn.unfolded),te$4(Be,"class","content__wrapper svelte-1fy4duy"),te$4(Se,"class",Br=Gt$1(a$l("content__container",$e[0].className))+" svelte-1fy4duy"),te$4(Se,"data-id",tn=$e[0].id),re$2(Se,"disable",$e[0].enabled===!1),re$2(Se,"hide",$e[5]),re$2(Se,"unClickable",$e[0].config.clickable===!1),ne$5(Se,"width",$e[0].stickType==="Plane"||$e[0].contentType==="MediaModel"?"100%":0),ne$5(Se,"height",$e[0].stickType==="Plane"||$e[0].contentType==="MediaModel"?"100%":0)},m(cn,hn){Nt$1(cn,Se,hn),pt$1(Se,Be),pt$1(Be,De),~sr&&sn[sr].m(De,null),$e[16](Se),en=!0,an||(rn=lt$2(Se,"click",$e[17],!0),an=!0)},p(cn,hn){var mn;let An=sr;sr=ln(cn,hn),sr===An?~sr&&sn[sr].p(cn,hn):(cr&&(Lt$1(),$t(sn[An],1,1,()=>{sn[An]=null}),Ot$2()),~sr?(cr=sn[sr],cr?cr.p(cn,hn):(cr=sn[sr]=on[sr](cn),cr.c()),ot$4(cr,1),cr.m(De,null)):cr=null),(!en||hn&1)&&re$2(De,"unfolded",(mn=cn[0].state)==null?void 0:mn.unfolded),(!en||hn&1&&Br!==(Br=Gt$1(a$l("content__container",cn[0].className))+" svelte-1fy4duy"))&&te$4(Se,"class",Br),(!en||hn&1&&tn!==(tn=cn[0].id))&&te$4(Se,"data-id",tn),(!en||hn&1)&&re$2(Se,"disable",cn[0].enabled===!1),(!en||hn&33)&&re$2(Se,"hide",cn[5]),(!en||hn&1)&&re$2(Se,"unClickable",cn[0].config.clickable===!1),hn&1&&ne$5(Se,"width",cn[0].stickType==="Plane"||cn[0].contentType==="MediaModel"?"100%":0),hn&1&&ne$5(Se,"height",cn[0].stickType==="Plane"||cn[0].contentType==="MediaModel"?"100%":0)},i(cn){en||(ot$4(cr),en=!0)},o(cn){$t(cr),en=!1},d(cn){cn&&J$h(Se),~sr&&sn[sr].d(),$e[16](null),an=!1,rn()}}}function wA($e){let Se,Be,De,Ve,Fe,Je,Xe;return Be=new A$8({props:{tag:e$5($e[0]),rendererMap:$e[2]}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class",De=Gt$1(a$l("content__container",$e[0].className))+" svelte-1fy4duy"),te$4(Se,"data-id",Ve=$e[0].id),re$2(Se,"custom-tag-disable",$e[0].enabled===!1),re$2(Se,"custom-tag-hide",$e[5])},m(Ke,Ye){Nt$1(Ke,Se,Ye),Dt$1(Be,Se,null),$e[14](Se),Fe=!0,Je||(Xe=lt$2(Se,"click",$e[15]),Je=!0)},p(Ke,Ye){const or={};Ye&1&&(or.tag=e$5(Ke[0])),Ye&4&&(or.rendererMap=Ke[2]),Be.$set(or),(!Fe||Ye&1&&De!==(De=Gt$1(a$l("content__container",Ke[0].className))+" svelte-1fy4duy"))&&te$4(Se,"class",De),(!Fe||Ye&1&&Ve!==(Ve=Ke[0].id))&&te$4(Se,"data-id",Ve),(!Fe||Ye&1)&&re$2(Se,"custom-tag-disable",Ke[0].enabled===!1),(!Fe||Ye&33)&&re$2(Se,"custom-tag-hide",Ke[5])},i(Ke){Fe||(ot$4(Be.$$.fragment,Ke),Fe=!0)},o(Ke){$t(Be.$$.fragment,Ke),Fe=!1},d(Ke){Ke&&J$h(Se),Rt(Be),$e[14](null),Je=!1,Xe()}}}function kA($e){let Se,Be;return Se=new I$8({props:{tag:e$5($e[0])}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=e$5(De[0])),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function CA($e){let Se,Be;return Se=new gt({props:{tag:e$5($e[0])}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=e$5(De[0])),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function bA($e){let Se,Be;return Se=new nt({props:{tag:e$5($e[0])}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=e$5(De[0])),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function yA($e){let Se,Be;return Se=new Dt({props:{tag:e$5($e[0])}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=e$5(De[0])),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function hA($e){let Se,Be;return Se=new rt({props:{tag:e$5($e[0])}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=e$5(De[0])),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function DA($e){let Se,Be;return Se=new qe$1({props:{tag:e$5($e[0])}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=e$5(De[0])),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function MA($e){let Se,Be;return Se=new Y$6({props:{tag:e$5($e[0])}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&1&&(Fe.tag=e$5(De[0])),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function vA($e){let Se,Be,De,Ve,Fe;const Je=[wA,QA,_A],Xe=[];function Ke(Ye,or){return or&5&&(Se=null),Se==null&&(Se=!!(Ye[0].element||Ye[2].has(Ye[0].contentType))),Se?0:Ye[4]?1:2}return Be=Ke($e,-1),De=Xe[Be]=Je[Be]($e),{c(){De.c(),Ve=Yt$1()},m(Ye,or){Xe[Be].m(Ye,or),Nt$1(Ye,Ve,or),Fe=!0},p(Ye,[or]){let sr=Be;Be=Ke(Ye,or),Be===sr?Xe[Be].p(Ye,or):(Lt$1(),$t(Xe[sr],1,1,()=>{Xe[sr]=null}),Ot$2(),De=Xe[Be],De?De.p(Ye,or):(De=Xe[Be]=Je[Be](Ye),De.c()),ot$4(De,1),De.m(Ve.parentNode,Ve))},i(Ye){Fe||(ot$4(De),Fe=!0)},o(Ye){$t(De),Fe=!1},d(Ye){Xe[Be].d(Ye),Ye&&J$h(Ve)}}}function EA($e,Se,Be){let De,Ve,Fe,Je,Xe,Ke,{tag:Ye}=Se,{hooks:or}=Se,{rendererMap:sr=new Map}=Se,{contentTypeMap:cr=new Map}=Se,{state:Br}=Se,{mediaStore:tn}=Se,{temporaryState:en}=Se;ae$2("hooks",or),ae$2("mediaStore",tn);let an,rn;function on(An){An?or.emit("exposure",{id:Je,type:"start"}):or.emit("exposure",{id:Je,type:"end"})}function sn(An,xn,pn){var dn,fn;return!(!An.enabled||!xn.visible||!xn.enabled||!pn.visible||!((dn=An.state)!=null&&dn.visible)||((fn=An.temporaryState)==null?void 0:fn.visible)===!1||An instanceof Qo&&An.loading)}function ln(An){ft$1[An?"unshift":"push"](()=>{Ye.contentDom=An,Be(0,Ye)})}const cn=An=>or.emit("click",{event:An,target:"TagContent",tag:Ye});function hn(An){ft$1[An?"unshift":"push"](()=>{Ye.contentDom=An,Be(0,Ye)})}const mn=An=>{Ye.entryFromModel&&o$q(Ye.five.state.mode)?(An.stopPropagation(),Ye.find({targetMode:"Panorama"})):or.emit("click",{event:An,target:"TagContent",tag:Ye})};return $e.$$set=An=>{"tag"in An&&Be(0,Ye=An.tag),"hooks"in An&&Be(1,or=An.hooks),"rendererMap"in An&&Be(2,sr=An.rendererMap),"contentTypeMap"in An&&Be(3,cr=An.contentTypeMap),"state"in An&&Be(6,Br=An.state),"mediaStore"in An&&Be(7,tn=An.mediaStore),"temporaryState"in An&&Be(8,en=An.temporaryState)},$e.$$.update=()=>{var An,xn,pn,dn,fn,yn,Sn,gn,Cn,Mn,Bn;$e.$$.dirty&1&&Be(12,De=(An=Ye.state)==null?void 0:An.unfolded),$e.$$.dirty&1&&Be(11,Ve=(xn=Ye.state)==null?void 0:xn.visible),$e.$$.dirty&321&&Be(13,Fe=Br.visible&&en.visible&&((pn=Ye.state)==null?void 0:pn.visible)),$e.$$.dirty&1&&(Je=Ye.id),$e.$$.dirty&321&&Be(5,Xe=!sn(Ye,Br,en)),$e.$$.dirty&8192&&on(Fe),$e.$$.dirty&7681&&Ye.hooks&&(De!==void 0&&De!==rn&&(Be(10,rn=De),De?(fn=(dn=Ye.hooks).emit)==null||fn.call(dn,"unfolded"):(Sn=Ye==null?void 0:(yn=Ye.hooks).emit)==null||Sn.call(yn,"folded")),Ve!==void 0&&Ve!==an&&(Be(9,an=Ve),Ve?(Cn=(gn=Ye.hooks).emit)==null||Cn.call(gn,"show"):(Bn=(Mn=Ye.hooks).emit)==null||Bn.call(Mn,"hide"))),$e.$$.dirty&1&&Be(4,Ke=!(typeof Ye.config.unfoldedConfig=="object"&&Ye.config.unfoldedConfig.keep==="folded"))},[Ye,or,sr,cr,Ke,Xe,Br,tn,en,an,rn,Ve,De,Fe,ln,cn,hn,mn]}class Fi extends Ce$1{constructor(Se){super(),Te$1(this,Se,EA,vA,Ft$1,{tag:0,hooks:1,rendererMap:2,contentTypeMap:3,state:6,mediaStore:7,temporaryState:8},BA)}}var k$7=Object.defineProperty,O$5=Object.defineProperties,F$5=Object.getOwnPropertyDescriptors,C$4=Object.getOwnPropertySymbols,w$b=Object.prototype.hasOwnProperty,x$c=Object.prototype.propertyIsEnumerable,f$n=($e,Se,Be)=>Se in $e?k$7($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,b$d=($e,Se)=>{for(var Be in Se||(Se={}))w$b.call(Se,Be)&&f$n($e,Be,Se[Be]);if(C$4)for(var Be of C$4(Se))x$c.call(Se,Be)&&f$n($e,Be,Se[Be]);return $e},P$9=($e,Se)=>O$5($e,F$5(Se)),v$d=($e,Se,Be)=>(f$n($e,typeof Se!="symbol"?Se+"":Se,Be),Be),y$c=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class Qo extends Ji{constructor(Se,Be){super(Se,Be),v$d(this,"loading",!1),v$d(this,"loadModel",()=>y$c(this,null,function*(){var De,Ve;const Fe=this.data.modelUrl;if(!Fe||(this.loading=!0,yield M$u(this.five),!this.plugin.tags.includes(this)))return;const Je=f$u(Fe).then(Ye=>y$c(this,null,function*(){var or;const sr=Object.assign(Ye.scene,{customID:this.id,isTagModel:!0,removeEventListener:this.getConfig().clickable===!1?()=>{}:this.addObjectClickHandler(this,Ye.scene,cr=>{this.plugin.hooks.emit("click",{target:"TagModel",tag:this,event:cr})})});return new Matrix4().fromArray(this.matrix).decompose(sr.position,sr.quaternion,sr.scale),sr.updateWorldMatrix(!0,!0),sr.visible=this.visible,(or=this.getConfig().modelConfig)!=null&&or.autoLookAtEnabled&&sr.lookAt(this.five.camera.position.clone().setY(sr.position.y)),sr}));this.model={promise:Je};const Xe=yield Je;if(this.loading=!1,((De=this.model)==null?void 0:De.promise)!==Je||!this.plugin.tags.includes(this))return;this.model.object=Xe;const Ke=this.plugin.gltfObjectGroup.children.find(Ye=>Ye.customID===this.id);if(Ke&&(this.plugin.gltfObjectGroup.remove(Ke),Ke.removeEventListener()),o$o(this)){const Ye=this.data.mediaPosition.map(a$D);if(this.computeRenderType()==="Mesh"&&!this.mediaPlane){this.mediaPlane=new z$d(this.data.mediaData[0].url,Ye,{objectFit:this.data.objectFit});const or=new Vector3().addVectors(Ye[0],Ye[2]).divideScalar(2);this.mediaPlane.position.copy(or),Xe.add(this.mediaPlane)}if(this.computeRenderType()!=="Mesh"){(Ve=this.tag3DContentSvelte)==null||Ve.dispose();const or=document.createElement("div");or.classList.add("tag-media-container");const sr="black";or.style.backgroundColor=sr,or.style.border=`3px solid ${sr}`;const cr=b$d({mode:"behind",cornerPoints:Ye,container:or},this.config.tag3DConfig),Br=this.computeRenderType()==="BehindDom"||cr.mode==="behind"?"behind":"front",tn=new nt$3(P$9(b$d({},cr),{mode:Br})),en=this.computeNormal();tn.position.add(en.clone().setLength(F$c.Z_FIGHTING_OFFSET)),Xe.add(tn);let an;tn.mode==="behind"&&this.config.clickable!==!1&&(an=this.addObjectClickHandler(this,tn,on=>{this.plugin.hooks.emit("click",{event:on,target:"TagContent",tag:this})}));const rn=new Fi({target:or,props:{tag:this,hooks:this.plugin.hooks,state:this.plugin.state,mediaStore:this.plugin.mediaStore,temporaryState:this.plugin.temporaryState}});this.tag3DContentSvelte={svelteApp:rn,domContainer:{css3DObject:tn},css3DInstance:tn,initialNormal:en,currentNormal:en,dispose:()=>{rn.$destroy(),tn.dispose(),an?.()}}}}return this.plugin.gltfObjectGroup.add(Xe),Xe})),this.state.unfolded=!0,E$u(this.five),this.loadModel().then(()=>this.updateVisible())}applyVisible(){var Se,Be;(Se=this.tag3DContentSvelte)==null||Se.svelteApp.$set({tag:this,state:this.plugin.state,temporaryState:this.plugin.temporaryState}),(Be=this.model)!=null&&Be.object&&(this.model.object.visible=this.visible)}set(...Se){super.set(...Se),this.loadModel()}setData(...Se){var Be;super.setData(...Se);const De=this.data.mediaPosition.map(a$D);this.computeRenderType()==="Mesh"?this.mediaPlane&&this.mediaPlane.src!==this.data.mediaData[0].url&&(this.mediaPlane.removeFromParent(),this.mediaPlane=new z$d(this.data.mediaData[0].url,De,{objectFit:this.data.objectFit})):(Be=this.tag3DContentSvelte)==null||Be.svelteApp.$set({tag:this})}computeNormal(){return i$c(this.data.mediaPosition)}}var T$7=Object.defineProperty,b$c=Object.defineProperties,k$6=Object.getOwnPropertyDescriptors,v$c=Object.getOwnPropertySymbols,R$6=Object.prototype.hasOwnProperty,V$2=Object.prototype.propertyIsEnumerable,P$8=($e,Se,Be)=>Se in $e?T$7($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,g$g=($e,Se)=>{for(var Be in Se||(Se={}))R$6.call(Se,Be)&&P$8($e,Be,Se[Be]);if(v$c)for(var Be of v$c(Se))V$2.call(Se,Be)&&P$8($e,Be,Se[Be]);return $e},y$b=($e,Se)=>b$c($e,k$6(Se)),D$9=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const B$a=new Map,O$4=new Map;class Qi extends Ji{constructor(Se,Be){super(Se,Be),this.state.unfolded=!0,this.loadModel()}applyVisible(){var Se,Be,De,Ve,Fe,Je;this.computeRenderType()==="Mesh"?((Be=(Se=this.data.mediaData)==null?void 0:Se[0])==null?void 0:Be.type)==="Video"?this.renderVideoPlane():((Ve=(De=this.data.mediaData)==null?void 0:De[0])==null?void 0:Ve.type)==="Image"&&this.renderImagePlane():((Fe=this.tag3DContentSvelte)==null||Fe.svelteApp.$set({tag:this,state:this.plugin.state,temporaryState:this.plugin.temporaryState}),(Je=this.tag3DContentSvelte)!=null&&Je.css3DInstance&&(this.tag3DContentSvelte.css3DInstance.visible=this.visible,this.five.needsRender=!0))}set(Se,Be=!0){super.set(Se,Be),M$u(this.five).then(()=>{this.tag3DContentSvelte&&(Se.data?this.tag3DContentSvelte.svelteApp.$set({tag:this,state:this.plugin.state,temporaryState:this.plugin.temporaryState}):Se.position&&this.loadModel())})}setData(...Se){var Be,De,Ve,Fe,Je;super.setData(...Se),this.computeRenderType()==="Mesh"?((De=(Be=this.data.mediaData)==null?void 0:Be[0])==null?void 0:De.type)==="Video"?this.renderVideoPlane():((Fe=(Ve=this.data.mediaData)==null?void 0:Ve[0])==null?void 0:Fe.type)==="Image"&&this.renderImagePlane():(Je=this.tag3DContentSvelte)==null||Je.svelteApp.$set({tag:this})}loadModel(){return D$9(this,null,function*(){var Se,Be,De,Ve,Fe,Je;if(yield M$u(this.five),this.computeRenderType()==="Mesh")((Be=(Se=this.data.mediaData)==null?void 0:Se[0])==null?void 0:Be.type)==="Video"?this.renderVideoPlane():((Ve=(De=this.data.mediaData)==null?void 0:De[0])==null?void 0:Ve.type)==="Image"&&this.renderImagePlane();else{E$u(this.five);const Xe=this.position.map(t$j);(Je=(Fe=this.tag3DContentSvelte)==null?void 0:Fe.dispose)==null||Je.call(Fe);const Ke=document.createElement("div");Ke.classList.add("tag-media-container");const Ye=g$g({mode:"front",cornerPoints:Xe,container:Ke},this.config.tag3DConfig),or=this.computeRenderType()==="BehindDom"||Ye.mode==="behind"?"behind":"front",sr=new nt$3(y$b(g$g({},Ye),{mode:or})),cr=this.computeNormal();sr.position.add(cr.clone().setLength(F$c.Z_FIGHTING_OFFSET)),this.plugin.group.add(sr);let Br;sr.mode==="behind"&&this.config.clickable!==!1&&(Br=this.addObjectClickHandler(this,sr,en=>{this.plugin.hooks.emit("click",{event:en,target:"TagContent",tag:this})}));const tn=new Fi({target:Ke,props:{tag:this,hooks:this.plugin.hooks,state:this.plugin.state,mediaStore:this.plugin.mediaStore,temporaryState:this.plugin.temporaryState}});this.tag3DContentSvelte={svelteApp:tn,domContainer:{css3DObject:sr},css3DInstance:sr,initialNormal:cr,currentNormal:cr,dispose:()=>{tn.$destroy(),sr.dispose(),Br?.()}},this.five.needsRender=!0}})}renderVideoPlane(){var Se;const Be=this.data.mediaData[0];if(!Be)return;const{url:De}=Be;if(!De)return;const Ve=this.currentVisible,Fe=!!(this.mediaPlane&&!Ve),Je=!!(!this.mediaPlane&&Ve),Xe=!!(this.mediaPlane&&this.mediaPlane.src!==De);if((Fe||Xe)&&this.mediaPlane&&(this.plugin.imagePlaneGroup.remove(this.mediaPlane),this.mediaPlane.dispose(),this.mediaPlane.removeFromParent(),this.mediaPlane=void 0),Je||Xe){const Ke=this.position.map(a$D),Ye=new D$g(De,Ke,{videoCoverSrc:Be.videoCoverUrl,playButton:this.data.playIcon,paused:!((Se=this.data.autoplayConfig)!=null&&Se.autoplayVideo),objectFit:this.data.objectFit,videoTextureMap:B$a,ImageTextureMap:O$4,domEvents:this.plugin.domEvents});this.plugin.domEvents.addAutoBindEventListener(Ye,"click",sr=>{var cr;!((cr=Ye.videoInstance)!=null&&cr.paused)&&Ye.videoInstance.muted===!1&&this.plugin.hooks.emit("playStateChange",{event:sr,state:"playing",tag:this,mediaInstance:Ye.videoInstance})}),Ye.onVideoReady=sr=>{sr.addEventListener("play",cr=>{this.plugin.mediaStore.set({currentMediaElement:Ye.videoInstance}),this.plugin.hooks.emit("playStateChange",{event:cr,state:"playing",tag:this,mediaInstance:Ye.videoInstance})}),sr.addEventListener("pause",cr=>{this.plugin.hooks.emit("playStateChange",{event:cr,state:"paused",tag:this,mediaInstance:Ye.videoInstance})}),sr.addEventListener("ended",cr=>{this.plugin.hooks.emit("playStateChange",{event:cr,state:"paused",tag:this,mediaInstance:Ye.videoInstance})})};const or=sr=>(this.five.on("renderFrame",sr),()=>this.five.off("renderFrame",sr));Ye.initialRenderHooks(or),this.mediaPlane=Ye,this.play=()=>Ye.play(),this.pause=()=>Ye.pause(),this.plugin.imagePlaneGroup.add(this.mediaPlane)}this.five.needsRender=!0}renderImagePlane(){const Se=this.data.mediaData[0];if(!Se)return;const{url:Be}=Se;if(!Be)return;const De=this.position.map(a$D),Ve=this.currentVisible,Fe=!!(this.mediaPlane&&!Ve),Je=!!(!this.mediaPlane&&Ve),Xe=!!(this.mediaPlane&&this.mediaPlane.src!==Be);(Fe||Xe)&&this.mediaPlane&&(this.plugin.imagePlaneGroup.remove(this.mediaPlane),this.mediaPlane.dispose(),this.mediaPlane.removeFromParent(),this.mediaPlane=void 0),(Je||Xe)&&(this.mediaPlane=new z$d(Be,De,{objectFit:this.data.objectFit}),this.getConfig().clickable!==!1&&this.plugin.domEvents.addAutoBindEventListener(this.mediaPlane,"click",Ke=>{this.plugin.hooks.emit("click",{tag:this,target:"TagContent",event:Ke.origDomEvent})},{noEmitWhenHide:!0}),this.plugin.imagePlaneGroup.add(this.mediaPlane)),this.five.needsRender=!0}computeNormal(){return i$c(this.position)}}function I$7($e){Qt$1($e,"svelte-cksy1a",".audio-tag-point.svelte-cksy1a{position:relative;width:-moz-max-content;width:max-content;height:-moz-max-content;height:max-content;padding:0.25rem;border-radius:100%;border:0.0625rem solid rgba(255, 255, 255, 0.6);background:linear-gradient(to bottom, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2));box-shadow:inset 0 0 0.25rem 0 rgba(255, 255, 255, 0.3);display:flex;align-items:center;justify-content:center}")}function z$4($e){let Se,Be,De,Ve,Fe;return Be=new X$3({props:{playing:$e[0],width:24}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","audio-tag-point svelte-cksy1a")},m(Je,Xe){Nt$1(Je,Se,Xe),Dt$1(Be,Se,null),De=!0,Ve||(Fe=[lt$2(Se,"click",function(){L$k($e[2])&&$e[2].apply(this,arguments)}),lt$2(Se,"mouseenter",function(){L$k($e[3])&&$e[3].apply(this,arguments)}),lt$2(Se,"mouseleave",function(){L$k($e[4])&&$e[4].apply(this,arguments)})],Ve=!0)},p(Je,Xe){$e=Je;const Ke={};Xe&1&&(Ke.playing=$e[0]),Be.$set(Ke)},i(Je){De||(ot$4(Be.$$.fragment,Je),De=!0)},o(Je){$t(Be.$$.fragment,Je),De=!1},d(Je){Je&&J$h(Se),Rt(Be),Ve=!1,M$o(Fe)}}}function U$5($e){let Se,Be;return Se=new Z$3({props:{url:$e[1].data.audioUrl,enable:$e[1].state.visible,style:"width: max-content; height: max-content;",hooksInfo:{tag:$e[1]},$$slots:{default:[z$4]},$$scope:{ctx:$e}}}),Se.$on("play",$e[5].play),Se.$on("pause",$e[5].pause),Se.$on("error",$e[5].error),Se.$on("timeupdate",$e[5].timeupdate),Se.$on("duration",$e[5].duration),Se.$on("audioRef",$e[5].audioRef),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,[Ve]){const Fe={};Ve&2&&(Fe.url=De[1].data.audioUrl),Ve&2&&(Fe.enable=De[1].state.visible),Ve&2&&(Fe.hooksInfo={tag:De[1]}),Ve&157&&(Fe.$$scope={dirty:Ve,ctx:De}),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function j$b($e,Se,Be){let{playing:De=!1}=Se,{tag:Ve}=Se,{handlePointClick:Fe=()=>{}}=Se,{handleMouseEnter:Je=()=>{}}=Se,{handleMouseLeave:Xe=()=>{}}=Se;const Ke=fe$4(),Ye={audioRef:or=>Ke("audioRef",or.detail),play:()=>{Be(0,De=!0),Ke("play")},pause:()=>{Be(0,De=!1),Ke("pause")},error:()=>{Be(0,De=!1),Ke("pause")},timeupdate:or=>Ke("timeupdate",or.detail),duration:or=>Ke("duration",or.detail)};return $e.$$set=or=>{"playing"in or&&Be(0,De=or.playing),"tag"in or&&Be(1,Ve=or.tag),"handlePointClick"in or&&Be(2,Fe=or.handlePointClick),"handleMouseEnter"in or&&Be(3,Je=or.handleMouseEnter),"handleMouseLeave"in or&&Be(4,Xe=or.handleMouseLeave)},[De,Ve,Fe,Je,Xe,Ye]}let O$3=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,j$b,U$5,Ft$1,{playing:0,tag:1,handlePointClick:2,handleMouseEnter:3,handleMouseLeave:4},I$7)}};function Pe($e){Qt$1($e,"svelte-dorxu0",'@charset "UTF-8";.tag-point-click-helper.svelte-dorxu0.svelte-dorxu0{position:absolute;pointer-events:auto;cursor:pointer;width:141%;height:141%;left:50%;top:50%;transform:translate(-50%, -50%);z-index:1000000}.audio-tag-point-click-helper.svelte-dorxu0.svelte-dorxu0{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1}.tag-point-wrapper.svelte-dorxu0.svelte-dorxu0{pointer-events:none;position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);cursor:pointer;z-index:1040}.tag-folded-point.svelte-dorxu0.svelte-dorxu0,.tag-unfolded-point.svelte-dorxu0.svelte-dorxu0{transition:all 0.5s}.tag-point-wrapper.svelte-dorxu0 .tag-unfolded-point.svelte-dorxu0{display:flex;justify-content:center;align-items:center;position:absolute;width:100%;height:100%;border-radius:50%}.tag-point-wrapper.svelte-dorxu0 .tag-unfolded-point.svelte-dorxu0:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);width:0.3125rem;height:0.3125rem;border-radius:50%;background-color:white}.tag-point-wrapper.svelte-dorxu0 .tag-unfolded-point.svelte-dorxu0:before{content:"";position:absolute;width:0.875rem;height:0.875rem;border-radius:50%;background-color:rgba(0, 0, 0, 0.2)}.tag-point-wrapper.folded.svelte-dorxu0 .tag-folded-point.svelte-dorxu0{opacity:1;scale:1}.tag-point-wrapper.folded.svelte-dorxu0 .tag-unfolded-point.svelte-dorxu0{opacity:0;scale:1}.tag-point-wrapper.unfolded.svelte-dorxu0 .tag-folded-point.svelte-dorxu0{opacity:0;scale:0.2}.tag-point-wrapper.unfolded.svelte-dorxu0 .tag-unfolded-point.svelte-dorxu0{opacity:1;scale:1}.tag-point-wrapper.disable-unfold.svelte-dorxu0 .tag-folded-point.svelte-dorxu0{opacity:1 !important;scale:1 !important}.tag-point-wrapper.disable-unfold.svelte-dorxu0 .tag-unfolded-point.svelte-dorxu0{opacity:0 !important;scale:1 !important}')}function Ce($e){let Se;return{c(){Se=K$g("div"),te$4(Se,"class","audio-tag-point-click-helper svelte-dorxu0")},m(Be,De){Nt$1(Be,Se,De),$e[18](Se)},p:N$f,d(Be){Be&&J$h(Se),$e[18](null)}}}function Me($e){let Se,Be,De;return{c(){Se=K$g("div"),te$4(Se,"class","tag-point-click-helper svelte-dorxu0")},m(Ve,Fe){Nt$1(Ve,Se,Fe),$e[17](Se),Be||(De=[lt$2(Se,"click",$e[15]),lt$2(Se,"mouseenter",$e[16]),lt$2(Se,"mouseleave",function(){L$k($e[3])&&$e[3].apply(this,arguments)})],Be=!0)},p(Ve,Fe){$e=Ve},d(Ve){Ve&&J$h(Se),$e[17](null),Be=!1,M$o(De)}}}function Te($e){let Se,Be;return Se=new Ee$1({props:{icon:$e[8],width:$e[7]}}),Se.$on("iconLoaded",$e[21]),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&256&&(Fe.icon=De[8]),Ve&128&&(Fe.width=De[7]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function Le$1($e){let Se,Be;return Se=new O$3({props:{tag:e$5($e[1]),handlePointClick:$e[19],handleMouseEnter:$e[20],handleMouseLeave:$e[3]}}),Se.$on("audioRef",$e[13].audioRef),Se.$on("play",$e[13].play),Se.$on("pause",$e[13].pause),Se.$on("timeupdate",$e[13].timeupdate),Se.$on("duration",$e[13].duration),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&2&&(Fe.tag=e$5(De[1])),Ve&16&&(Fe.handlePointClick=De[19]),Ve&6&&(Fe.handleMouseEnter=De[20]),Ve&8&&(Fe.handleMouseLeave=De[3]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function Ee($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or;function sr(rn,on){return rn[6]?Ce:Me}let cr=sr($e),Br=cr($e);De=new T$a({props:{center:!0,blurRadius:15,spreadRadius:5,opacity:.3}});const tn=[Le$1,Te],en=[];function an(rn,on){return rn[6]?0:1}return Ke=an($e),Ye=en[Ke]=tn[Ke]($e),{c(){Se=K$g("div"),Br.c(),Be=Xt$2(),Ae$2(De.$$.fragment),Ve=Xt$2(),Fe=K$g("div"),Je=Xt$2(),Xe=K$g("div"),Ye.c(),te$4(Fe,"class","tag-unfolded-point svelte-dorxu0"),ne$5(Fe,"transition-delay",($e[9]?$e[11]:0)+"ms"),te$4(Xe,"class","tag-folded-point svelte-dorxu0"),ne$5(Xe,"transition-delay",($e[9]?$e[11]:0)+"ms"),te$4(Se,"class","tag-point-wrapper svelte-dorxu0"),re$2(Se,"unfolded",$e[5]),re$2(Se,"folded",$e[9]),re$2(Se,"disable-unfold",$e[1].isPopoverConfigEnabled())},m(rn,on){Nt$1(rn,Se,on),Br.m(Se,null),pt$1(Se,Be),Dt$1(De,Se,null),pt$1(Se,Ve),pt$1(Se,Fe),pt$1(Se,Je),pt$1(Se,Xe),en[Ke].m(Xe,null),or=!0},p(rn,[on]){cr===(cr=sr(rn))&&Br?Br.p(rn,on):(Br.d(1),Br=cr(rn),Br&&(Br.c(),Br.m(Se,Be))),on&512&&ne$5(Fe,"transition-delay",(rn[9]?rn[11]:0)+"ms");let sn=Ke;Ke=an(rn),Ke===sn?en[Ke].p(rn,on):(Lt$1(),$t(en[sn],1,1,()=>{en[sn]=null}),Ot$2(),Ye=en[Ke],Ye?Ye.p(rn,on):(Ye=en[Ke]=tn[Ke](rn),Ye.c()),ot$4(Ye,1),Ye.m(Xe,null)),on&512&&ne$5(Xe,"transition-delay",(rn[9]?rn[11]:0)+"ms"),(!or||on&32)&&re$2(Se,"unfolded",rn[5]),(!or||on&512)&&re$2(Se,"folded",rn[9]),(!or||on&2)&&re$2(Se,"disable-unfold",rn[1].isPopoverConfigEnabled())},i(rn){or||(ot$4(De.$$.fragment,rn),ot$4(Ye),or=!0)},o(rn){$t(De.$$.fragment,rn),$t(Ye),or=!1},d(rn){rn&&J$h(Se),Br.d(),Rt(De),en[Ke].d()}}}function He($e,Se,Be){var De,Ve;let Fe,Je,Xe,Ke,Ye;const or=de$4("hooks"),sr=fe$4();let{tag:cr}=Se,Br,tn=!1;const en=()=>{Br!==void 0&&clearTimeout(Br),tn=!0,Br=setTimeout(()=>{tn=!1},800)},an=Mn=>{tn||(cr.entryFromModel&&o$q(cr.five.state.mode)?cr.find({targetMode:"Panorama"}).then(()=>cr.unfoldAndFoldOthers()):or.emit("click",{event:Mn,target:"TagPoint",tag:cr}))},rn=cr.contentType==="Text"&&cr.data.appearance==="plane"?500:800;let{tagPointClickHelper:on=null}=Se,{handleMouseEnter:sn=()=>{}}=Se,{handleMouseLeave:ln=()=>{}}=Se,{handleTagPointClick:cn=()=>{}}=Se;const hn=()=>!0,mn=(Ve=(De=cr.config.popoverConfig)==null?void 0:De.beforeOpen)!=null?Ve:hn;let{audioInstance:An=null}=Se;const xn={audioRef:Mn=>{Be(14,An=Mn.detail),sr("audioInstanceReady",An)},play:()=>sr("audioPlay"),pause:()=>sr("audioPause"),timeupdate:Mn=>sr("audioTimeUpdate",Mn.detail),duration:Mn=>sr("audioDuration",Mn.detail)},pn=Mn=>{cn(Mn),an(Mn)},dn=Mn=>{mn(cr)&&sn(Mn)};function fn(Mn){ft$1[Mn?"unshift":"push"](()=>{on=Mn,Be(0,on)})}function yn(Mn){ft$1[Mn?"unshift":"push"](()=>{on=Mn,Be(0,on)})}const Sn=Mn=>{cn(Mn),an(Mn)},gn=Mn=>{mn(cr)&&sn(Mn)};function Cn(Mn){he$2.call(this,$e,Mn)}return $e.$$set=Mn=>{"tag"in Mn&&Be(1,cr=Mn.tag),"tagPointClickHelper"in Mn&&Be(0,on=Mn.tagPointClickHelper),"handleMouseEnter"in Mn&&Be(2,sn=Mn.handleMouseEnter),"handleMouseLeave"in Mn&&Be(3,ln=Mn.handleMouseLeave),"handleTagPointClick"in Mn&&Be(4,cn=Mn.handleTagPointClick),"audioInstance"in Mn&&Be(14,An=Mn.audioInstance)},$e.$$.update=()=>{var Mn,Bn,kn,Ln;$e.$$.dirty&2&&Be(5,Fe=(Mn=cr.state)==null?void 0:Mn.unfolded),$e.$$.dirty&32&&Be(9,Je=!Fe),$e.$$.dirty&2&&Be(8,Xe=(kn=(Bn=cr.style)==null?void 0:Bn.point)!=null&&kn.url?(Ln=cr.style)==null?void 0:Ln.point:{url:U$a}),$e.$$.dirty&2&&Be(7,Ke=(()=>{var Pn,Vn,Yn,ni;const Rn=(Vn=(Pn=cr.style)==null?void 0:Pn.point)==null?void 0:Vn.width;if(typeof Rn=="number")return Rn;const In=(ni=(Yn=cr.style)==null?void 0:Yn.point)==null?void 0:ni.size;if(typeof In=="number")return In;if(In==="S")return 18;if(In==="M")return 20;if(In==="L")return 24;if(In==="XL")return 28})()),$e.$$.dirty&2&&Be(6,Ye=cr.contentType==="Audio"&&cr.data.appearance==="plane")},en(),[on,cr,sn,ln,cn,Fe,Ye,Ke,Xe,Je,an,rn,mn,xn,An,pn,dn,fn,yn,Sn,gn,Cn]}class oo extends Ce$1{constructor(Se){super(),Te$1(this,Se,He,Ee,Ft$1,{tag:1,tagPointClickHelper:0,handleMouseEnter:2,handleMouseLeave:3,handleTagPointClick:4,audioInstance:14},Pe)}get tag(){return this.$$.ctx[1]}set tag(Se){this.$$set({tag:Se}),rt$4()}get tagPointClickHelper(){return this.$$.ctx[0]}set tagPointClickHelper(Se){this.$$set({tagPointClickHelper:Se}),rt$4()}get handleMouseEnter(){return this.$$.ctx[2]}set handleMouseEnter(Se){this.$$set({handleMouseEnter:Se}),rt$4()}get handleMouseLeave(){return this.$$.ctx[3]}set handleMouseLeave(Se){this.$$set({handleMouseLeave:Se}),rt$4()}get handleTagPointClick(){return this.$$.ctx[4]}set handleTagPointClick(Se){this.$$set({handleTagPointClick:Se}),rt$4()}get audioInstance(){return this.$$.ctx[14]}set audioInstance(Se){this.$$set({audioInstance:Se}),rt$4()}}const A$7="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAeCAYAAABqpJ3BAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMKADAAQAAAABAAAAHgAAAAC3G9N3AAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAACfklEQVRYCe2Yu2tVQRCHb1QQFQRBKzEkooJoISL+ATYW/kXBSrBKLxZaidaKhSCxs1Asg4qgRhHBB6IkKr4f3yd3vCfHezfnsTGnuD/4ZWf3zO7M7M4+biZ6vd5muBsehydg1/EdB6/3uTBR8vYg9dPQoLqILzg1A++Gc+tD6JevKR/AY/BXB3kSn+bhX5QD8MNLuAnugz87xMv4cg0uw7AAVDDKo3Ar7MJKPMWPWeiELsOoAFS8D00l98laBvEN+6fgO/gPRgWg4iL8Ct3Ya5lKl7B/Bw7FhqGtg8ariAZwYND0X6V7WNOHkVg38svgw1nED/2qyykDIRfLsmy93Falvza1nUQqhaLjZ4Q38HA0UOqQ+0LExoqy2PaDipNkGfp+r9L/PHqPVE6hSgD2fw63w51QR7wN3dw6EqVOhhylQSmL0K3S/zb6ydT5MyJ/qgagvhfcEbjRCogZjzLVFjqWRbnYJ+S3CGegAa+IOgE44DPo/RCOrEZp3r+ClVAnAAd0djy5puBqOD/HuLdgZdQNwIEfQ4/WLdB8zsUXjHUBRoohrowmAWhgAbofRI6VMD3PwSUHrIMmATi+Z7S39B6YYwV8pHlp1UbTADTkhp6GPvjarMIT+l+BjdAmAA1q/FDfsmOZCuVgUu3v0b8IvSwboW0AGvaVuDdh3YCGwXYvK1eyMdoGoGF/xW2D3tTl2U/V59G/CVvBMz0HbjDILujRWgUfUbJPa+RYAZ0w970998Mqp5I/D30gtkauAHTEH0BuyimYSp05vj+EWZAzAB1yP/jc2AFNz2Ign6ibNj4KsyGeutkGLAw0iewdIfx/jkeuz/AxxjMwnoGMM/AbzDbNM/bhiRQAAAAASUVORK5CYII=",g$f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAeCAMAAABdem3zAAAAb1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABt6r1GAAAAJXRSTlMApb6gupm3s7CprZWRfoeOg4qdenZzLG9ka04KJR4EET04MBlfDzTkzgAAAMpJREFUOMvd0dsSgiAQBuA1o7KMTJRUEE+9/zOGjhmjIHvdtyizM1zAv/C3lOS8BjxZlNpbAhJ/zTig1PkCdS1RZotSgF/FDBXiAXcT8z6jyZLp5PfPGthXJCsF7GrpRgs7BvrcoAM4qexhkSl3orGVM1t5c5COEVPiQIU9UZISvXRNi6S/3pptF87S8dNl9p1lxCQIw2CsadfMnmwHzoJdbJNo5LHKto6uHlENBhVfvGJlJnpGMLLtTyg9zPj5iHLhoAmeHw9YORcf/XMbuOSlzkgAAAAASUVORK5CYII=",B$9="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAwCAYAAAAGlsrkAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHqADAAQAAAABAAAAMAAAAACmbYh+AAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAACtUlEQVRYCcWXzUtWQRSHb1ZWL1FYIH2AkSaEBbkMsTYFQVCbdkVQ7Vr3L/RXRQURIrVopxAuBEmIwCBqkfZBz2/0yLV35oz39X4c+HnHuXPOM2c+ztWi6MZ6Q91wi/GuwLe6SPgy0NdtZzwN9LmyPaAfLZg4j9A9tB+1Ah6D8wyNC2jWdMZ3AT1Ahwxoz6bAIwCeoisoyoh22qwGfF7F7zE66vnXCe4Buo9m0UEPqnd1gSeJ9QSNKij2C7nwvYLlfxupElWKVWkwwct2ml8eorOlzt9b7cOlvmhzUPA1oinT/6+J4oUCEaWVOquCdU1UfSZQDKCM1V/rHqu4qyAcQSmzRNyDJWcbmAqkfl2Tm0jg3PjaMladvYOOb0GzmTBOlh3nZaAMdU3Ke5nbO4uXG1ekvseTAG+gqmbXKeuXAs9kPeMDLOPsUsfA2le3wMeZodcy1lK7FgMfcz3yL//khxTJPU755pZQS10+jKk4UfB6cvRmRXJeh1cDZ7yMuwf3wFZAcisTzVjOb7zozjs71QMdLsVdQq8cwJ5feQfhC9FX0Xmk76vdAPmoHdNf+vch+1zGxoQ+D4x/8Q0tIN3rU8j2LhXQTrXFTY0bsgHETJr26yNaQ+eQskkFVMaC6+mtzK7AxAimpV9EZ9AJFIMLqv7cylQCE6/4iT6gDXQBGcgm0UjGcLZthZayn0AqsQamGSZTe8YKbPaDxjukrJW94LYCte4xcftMAB083fuLSAdPcFlth2szXPznV7rn0Uk0hhpdauLvMF07HbzP6BIaRrb3fc/d3GP8K9knRs8h3XkVnT6o+poAEzdcu7c8de3sz+IdE2gKLLhMB+89mkL6L2Qb3jQYVqj3L3nqPxBNIMDbAMMKtVsHTx+c60gHr3XTnr9oK+NydvrYjHYB1iS+l2fSZrv3D/+KTyvCdHWgAAAAAElFTkSuQmCC",R$5="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAwCAYAAAAGlsrkAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHqADAAQAAAABAAAAMAAAAACmbYh+AAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAACpklEQVRYCcWYPYwOURSGP38Rv4lEsZoVkq0oNEQjEopNFCQSlUIkJCqFUiLR0ah1SIROgWQLQSNBKUIhGwUNUZD4K/w/b3wnmZ1v7tx3xsw4ybsz994z57nn3J9lR6PRaCUa3BZD3Dw4FaDAs/8DLOYdtHVouDJeis6hbUPClwA7gjSBPWgFeop+oV5NwKIdoHEBTRc7+3iPjJXhb6TnWqTsv6EXqBcrZxwQrfthdBqti84unylwMLbwch7tjI6unjmwOKvRCXQMdXbLOeDvAGXb0Rk0o8a/WtXm0iaLjabNJskWoeVoB9IeeIlijNdm5mS8bBzyRyH0Xt5PoQ2FvkavDjhKXQ48RcdJtKs84LQdcGSs8pZNS7UPaeM1OnYOODIulro8gY10HEf2LxsHXJdxcQJraBxE+1H22DlgBf+J6jKWT1RGWR9F0+pMmQNWQK1l1Rqn4q5i4BBKlt4Bp4I7/Tp2M1WODjjWOFfqqvjq240mquWAVWqt8cTH9Dmm225T2dEB6xutcc6iMlV+gi8wF9xkVy8ApBou2Mk4xVD/x/KgA44Stl3jz0BftwHHxdB2Vz8sQ9V2Mo7v2mR8j4/nI0Dx6QRTqZV1LuPwU/wv6DaaKLEGZQ44Sv33i/TPmNwzXO6ir2lXDxyZaJJ1WWvsFhI4a00yroO+gnQDfcgSxw4OuC5jXSxz6IELDD8HLN+qm+st/VfRGzk0NQesTRM3V5Rbx0SZRrsp19rVxaDvaVxC88XONu9OxrHGjwBcR7XHxJ2EA9Zdexk9doM6fjnwc4JcRPYxcaDySYG1aa4hXQi9WBVYl4H+HJG8Z7uYSRl8k6BXUOtj4k4qwNqpZ9ET98Mu/O4TJPkP7y4AVTF0I61HKvGgJvAn9G5Q6hiW/Z9dH5P6A8K2bfEUA9VoAAAAAElFTkSuQmCC",I$6="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAeCAYAAABqpJ3BAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMKADAAQAAAABAAAAHgAAAAC3G9N3AAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAACfElEQVRYCe2XP2sVQRTFd0VsIgmpTAqx1EAStLAIpowgFmohFkEQ0+UbBEEJCpJvkE4REguVoBY2EaysLJSkSCzFQq1EMQg2z9+Jc2EyziSzb/eZJ7wLlzv37v1zzuy82aRstVr9RVGModfQGfR/kHuAfICulz5ayJzBf4oe9uNdtP4BlktlWb42TDsIKAiJs5gnltBl9jLgV31MfxHQQ0jcxsz6iV2wXgT8rRBHisAhEl+gI2HBPvkbzD0PgV/h/CgBJfEWjmOeoyKznyLQFwD/PgYiSUDJkLiOmYsV/sPYAuDvp+btSkBFkFDx6VSDDsffAF6bmJQcAkNUP0J1tbZcJ6uTr7VZPba1nxuLhblhT12ZVyDwWYkpsaLU8+04b0FX651dk5p/eBPwO67M2IiDsWAYUyNITBCfCp91yH+ZA16zs96AEiGgPzkW0SPyOyhf6D0Lge85M7IJqBkkxjELOY1r5MwBfi23PusIWTM1hsRj/IsWa9g+qwJesysRcGCXsaPoUec3ZT7SSL0rSaUjZJ15C8dYz6NNfaX1tZ1n9z9gK0lbBDQBErpapytNSyc/BPyeV2asvJ0jtN1HAyGho3QC9T9Util+TDVhXDHJZrvgVWxNta4sENDVegPtq1z8p2ALcxcCWVdmbEYtAmoIiVOYq7HmGbElwL/NyEumtH2ErKMAQEJ/ep+0WKZ9Vxe85tQm4MCuYIfRQefvZb6SoJracqB2Bxqwk7oGBUg2R1dcDen1pPZvwB/PURrHP+fHIuvVJo6O9W2UgJq638Mky34b4uxP7CvAR/81DHKz3cYJ2GSI6Gs94Pxv2E9NHRub0bO9HejtQFH8BvWooa9jGY/wAAAAAElFTkSuQmCC",C$3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAeCAMAAABdem3zAAAAgVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9d3yJTAAAAK3RSTlMA/Pfx6+XZ39TIwry2sJ+qpY3Ok4jNgpl8dnEGmEUfDi5hOycxmn5YGGhjcHcwqwAAAMZJREFUOMvd0e0OgiAUgGEqs9IiLdNCRQS/6v4vMGrNofJxfvfIzuZ2fugL+ls5ZYwiOPEk0ktA95vHD4Pt0/uIgr6fpCOSI7c+UfSAH4gnGtd+lVwnkgrZkSzLCnmK75QPse+XeKG0FsXRAqaWovFZIza3rU9atWmfHQ2YoWgUGkT6tl1g1GmLHiw0bYfgcrvI8xlyyqG+BwOaw3srvCjqO8zaCn/n4IvJFYdbp1C98NQDSJWiG5CxLffWIB5HUsXbFVjLqzcmgh9KFWWqZgAAAABJRU5ErkJggg==",m$c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAwCAYAAAAGlsrkAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHqADAAQAAAABAAAAMAAAAACmbYh+AAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAACiElEQVRYCcWYsUscQRSH74LaBE60MU2wsBALBQsbTSuEFCkCKmghYmUjdmohiIUpU6WxSZEQQrqkjZA/IEXESksREbEQBRFEOL+nOzK3O7NvvNudG/g5s29m3je/mbnz2EqlDaVer9detIEryOF2geejG2abJ9BdVDDASXQeDQyoC22hS3SDyncMZBDtInH6BC71cgFa4Cx/o6H0mXakA0U8A3xFno9oHHW5chbuGOgkoJ9ozAU0scIcA6yRdAW9Q06XBip1IWCgI+RaRa8lKaX+WPn/tgQGKM7m0BRSXdrLaBoMtJ9Ey2jATpi0q45YQ6gpMFC5QLPoZUO2Zzw8CwxQLtAikjPN29rizhjoKLAZ1IO00vpWAxRnH5B8LqWtugkZk7vVQOUCCbQPmaK6YaA6xgsGKuf4HqXPMsSxWaS3dn5lAh1kxlvPLNUN89TFOcFMfOOBhobVxWXAybnKx8ZXVDdMVMdkwEzq9hGTuOpGmf/Q7QJr81Q3JFAX5wJfauSAfnVxLvApiW9ykqtumKuOyYCr1eotE//mgEO6mnJcAX5I9j8egprUM68hnHFseoH/p/0VXZhYUqvbyDh1jBcsEOBHVJ/RnjwXWXLBApIzRz9ofkPXEgso6nGoYANJtn6b5wMTy6lb2+p0YuBX6BPx70huv68U59gmAJcbv4mO7bjVLtaxldhcvHViv+x4aDv4jF0JcS4X7wt9a+jMGlPOVluAhybwfRpLaDfpU7daHZAkCq74fy6/uTdQL+pE8tMprc6WtpqEmZJcvGk6/mU6YwVwv4AO0QlqeCNQ+hoAOl9FlA4WAPD4L19sZywg7uumFDz+CzazAJzvmHbUGvBEVKCBAa7dA6h+CDnUpjBPAAAAAElFTkSuQmCC",E$a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAwCAYAAAAGlsrkAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHqADAAQAAAABAAAAMAAAAACmbYh+AAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAACXElEQVRYCcWYQSgFQRjHdyUlRU5ykCMOxMHJSXlnV4nk7OTISRw8N7koJSeKg+Ig5R3l4kBOHF8u5KD3IoVa/692XtPXzOz3Ztfu1jQz35v5ft//2++1uxNEUdQZFHC1gDlcADcg8EIR4ACp/kWbyB0eg9/Ql3KFx+Av9DW0dbS2XAJgYFJeQRv4bzgVF7+GYDgHfJH/kOU8JMVw+IP2bWg3sK2EYfiCPtPLpFgHjGNyguAyL7wkxXomLhDENtTX9ch8x0mKyW8UO59Cvwv1I/E8VScBhxqhB+MyFR5aqr+dBKxxG8NpjDYB729YmhxIwCrV3HUfDGuAexWeBKynmsMp3bOAL6M19XiVgG2K9SAGMVkFfEw3usYSsEux7rsDkznAZ9ASC08C1p1LxqNYtAS4s/AkYEmq+ZpuwOddqZeAJSptt6MEuPFJJwHbnEoCojWTpnsuAfM0moCuNe3Y0Ms3ScBpFROzywfsUqP8NR2cRLFy7uqTgqvxzRKwRI1rTR3P8KoPOEkN98nn19xA86wU24K7hNonE7jVZPSw8VS/w8epKcXKtwRsU6N8UK+vucecoPTWar0kYK7G5IzWfKIdA3hnWsBtErCuhu9X80cM9gEVv4FKwC7FlM4jAK9UBNJeArb5esYPO4BWbQtcdgnYlOozOD0E1FlAacH6/ldMtgB80I0+Y4lidY8rAGT2CSMBfwC44VNArkwkgW+x+V8+U21gKpoyVB64ok71G96H6NRHnYHkdhShjpsUOPfDl8KOmwo5YNtLVSS+m1FY+aulYAFu6rvWVyDf9wc6+wpavsNbLQAAAABJRU5ErkJggg==";function T$6($e){Qt$1($e,"svelte-16evpcg",".tag-popover-arrow-wrapper.svelte-16evpcg{position:absolute;transform-origin:center;background-position:center;background-repeat:no-repeat;background-size:100% 100%}.tag-popover-arrow-top.svelte-16evpcg{width:1rem;height:0.625rem;top:0.5rem;left:50%;transform:translateX(-50%)}.tag-popover-arrow-bottom.svelte-16evpcg{width:1rem;height:0.625rem;bottom:0.5rem;left:50%;transform:translateX(-50%)}.tag-popover-arrow-left.svelte-16evpcg{width:0.625rem;height:1rem;top:50%;left:0.5rem;transform:translateY(-50%)}.tag-popover-arrow-right.svelte-16evpcg{width:0.625rem;height:1rem;top:50%;right:0.5rem;transform:translateY(-50%)}")}function l$f($e){let Se,Be,De;return{c(){Se=K$g("div"),te$4(Se,"class",Be="tag-popover-arrow-wrapper tag-popover-arrow-"+$e[0]+" theme-"+$e[2]+" svelte-16evpcg"),te$4(Se,"style",De=`background-image: url(${$e[3]})`)},m(Ve,Fe){Nt$1(Ve,Se,Fe)},p(Ve,Fe){Fe&5&&Be!==(Be="tag-popover-arrow-wrapper tag-popover-arrow-"+Ve[0]+" theme-"+Ve[2]+" svelte-16evpcg")&&te$4(Se,"class",Be),Fe&8&&De!==(De=`background-image: url(${Ve[3]})`)&&te$4(Se,"style",De)},d(Ve){Ve&&J$h(Se)}}}function B$8($e){let Se,Be=$e[1]&&l$f($e);return{c(){Be&&Be.c(),Se=Yt$1()},m(De,Ve){Be&&Be.m(De,Ve),Nt$1(De,Se,Ve)},p(De,[Ve]){De[1]?Be?Be.p(De,Ve):(Be=l$f(De),Be.c(),Be.m(Se.parentNode,Se)):Be&&(Be.d(1),Be=null)},i:N$f,o:N$f,d(De){Be&&Be.d(De),De&&J$h(Se)}}}function R$4($e,Se,Be){let De,{direction:Ve="bottom"}=Se,{show:Fe=!0}=Se,{theme:Je="dark"}=Se;return $e.$$set=Xe=>{"direction"in Xe&&Be(0,Ve=Xe.direction),"show"in Xe&&Be(1,Fe=Xe.show),"theme"in Xe&&Be(2,Je=Xe.theme)},$e.$$.update=()=>{$e.$$.dirty&5&&Be(3,De=(()=>{switch(Je){case"dark":switch(Ve){case"top":return g$f;case"bottom":return A$7;case"left":return B$9;case"right":return R$5}case"light":switch(Ve){case"top":return C$3;case"bottom":return I$6;case"left":return m$c;case"right":return E$a}}})())},[Ve,Fe,Je,De]}let q$6=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,R$4,B$8,Ft$1,{direction:0,show:1,theme:2},T$6)}};function k$5($e){Qt$1($e,"svelte-1d6rvbz",".icon-container.svelte-1d6rvbz{width:3.25rem;height:3.25rem;background-color:var(--bg-color);border-radius:100%;display:flex;align-items:center;justify-content:center;z-index:2}")}function L$7($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or;return{c(){Se=K$g("div"),Be=Mt("svg"),De=Mt("defs"),Ve=Mt("linearGradient"),Fe=Mt("stop"),Je=Mt("stop"),Xe=Mt("linearGradient"),Ke=Mt("stop"),Ye=Mt("stop"),or=Mt("path"),te$4(Fe,"stop-color",$e[1]),te$4(Fe,"offset","0%"),te$4(Je,"stop-color",$e[1]),te$4(Je,"stop-opacity",".5"),te$4(Je,"offset","100%"),te$4(Ve,"x1","53.2804066%"),te$4(Ve,"y1","100%"),te$4(Ve,"x2","64.4764442%"),te$4(Ve,"y2","2.52981206%"),te$4(Ve,"id","video-icon-gradient-a"),te$4(Ke,"stop-color",$e[1]),te$4(Ke,"offset","0%"),te$4(Ye,"stop-color",$e[1]),te$4(Ye,"stop-opacity","0"),te$4(Ye,"offset","100%"),te$4(Xe,"x1","50%"),te$4(Xe,"y1","-5.89066117%"),te$4(Xe,"x2","60.3018289%"),te$4(Xe,"y2","32.0415872%"),te$4(Xe,"id","video-icon-gradient-b"),te$4(or,"d","M8.0883645,5.35 C8.27319183,5.35 8.45426937,5.40368245 8.61098984,5.50477659 L20.4341152,13.1314044 C20.6662958,13.2811749 20.8173539,13.5140616 20.8743923,13.7691613 C20.9300733,14.0181899 20.8962437,14.2885953 20.7601668,14.5243865 L8.61098984,22.4950731 C8.38014238,22.6439836 8.11267156,22.6823641 7.86680489,22.6238045 C7.62023287,22.5650769 7.39563144,22.408984 7.25097187,22.1700998 C7.15226844,22.0071054 7.1,21.8187509 7.1,21.6265526 L7.1,6.37329702 C7.1,6.09035119 7.2108925,5.83405961 7.39059316,5.64859123 C7.56916841,5.46428435 7.81578724,5.35 8.0883645,5.35 Z"),te$4(or,"fill","url(#video-icon-gradient-a)"),te$4(or,"fill-rule","nonzero"),te$4(or,"stroke","url(#video-icon-gradient-b)"),te$4(or,"stroke-width",".2"),te$4(Be,"xmlns","http://www.w3.org/2000/svg"),te$4(Be,"viewBox","0 0 28 28"),te$4(Be,"width",$e[0]),te$4(Be,"height",$e[0]),te$4(Se,"class","icon-container svelte-1d6rvbz"),ne$5(Se,"--bg-color",$e[2])},m(sr,cr){Nt$1(sr,Se,cr),pt$1(Se,Be),pt$1(Be,De),pt$1(De,Ve),pt$1(Ve,Fe),pt$1(Ve,Je),pt$1(De,Xe),pt$1(Xe,Ke),pt$1(Xe,Ye),pt$1(Be,or)},p(sr,[cr]){cr&2&&te$4(Fe,"stop-color",sr[1]),cr&2&&te$4(Je,"stop-color",sr[1]),cr&2&&te$4(Ke,"stop-color",sr[1]),cr&2&&te$4(Ye,"stop-color",sr[1]),cr&1&&te$4(Be,"width",sr[0]),cr&1&&te$4(Be,"height",sr[0]),cr&4&&ne$5(Se,"--bg-color",sr[2])},i:N$f,o:N$f,d(sr){sr&&J$h(Se)}}}function j$a($e,Se,Be){let{size:De="28"}=Se,{color:Ve="#ffffff"}=Se,{bgColor:Fe="#0000004d"}=Se;return $e.$$set=Je=>{"size"in Je&&Be(0,De=Je.size),"color"in Je&&Be(1,Ve=Je.color),"bgColor"in Je&&Be(2,Fe=Je.bgColor)},[De,Ve,Fe]}let B$7=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,j$a,L$7,Ft$1,{size:0,color:1,bgColor:2},k$5)}};function j$9($e){Qt$1($e,"svelte-1d6rvbz",".icon-container.svelte-1d6rvbz{width:3.25rem;height:3.25rem;background-color:var(--bg-color);border-radius:100%;display:flex;align-items:center;justify-content:center;z-index:2}")}function q$5($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an;return{c(){Se=K$g("div"),Be=Mt("svg"),De=Mt("defs"),Ve=Mt("linearGradient"),Fe=Mt("stop"),Je=Mt("stop"),Xe=Mt("linearGradient"),Ke=Mt("stop"),Ye=Mt("stop"),or=Mt("linearGradient"),sr=Mt("stop"),cr=Mt("stop"),Br=Mt("g"),tn=Mt("path"),en=Mt("path"),an=Mt("path"),te$4(Fe,"stop-color","#FFF"),te$4(Fe,"offset","0%"),te$4(Je,"stop-color","#FFF"),te$4(Je,"stop-opacity",".5"),te$4(Je,"offset","100%"),te$4(Ve,"x1","54.417371%"),te$4(Ve,"y1","106.742364%"),te$4(Ve,"x2","72.619444%"),te$4(Ve,"y2","8.15444328%"),te$4(Ve,"id","xmfpi7cnc__sgsykm5x9a"),te$4(Ke,"stop-color","#FFF"),te$4(Ke,"offset","0%"),te$4(Ye,"stop-color","#FFF"),te$4(Ye,"stop-opacity","0"),te$4(Ye,"offset","100%"),te$4(Xe,"x1","50%"),te$4(Xe,"y1",".73169217%"),te$4(Xe,"x2","66.0966077%"),te$4(Xe,"y2","34.1694374%"),te$4(Xe,"id","xmfpi7cnc__tjqs3iy6kb"),te$4(sr,"stop-color","#FFF"),te$4(sr,"offset","0%"),te$4(cr,"stop-color","#FFF"),te$4(cr,"stop-opacity",".5"),te$4(cr,"offset","100%"),te$4(or,"x1","55.1256353%"),te$4(or,"y1","273.650936%"),te$4(or,"x2","55.1256353%"),te$4(or,"y2","81.7206937%"),te$4(or,"id","xmfpi7cnc__rs5hxavsyc"),te$4(tn,"d","M18,5.4 L18,13.4 C18,15.3329966 13.9705627,16.9 9,16.9 C4.02943725,16.9 0,15.3329966 0,13.4 L0,5.4 C0,7.33299662 4.02943725,8.9 9,8.9 C13.8670094,8.9 17.8316983,7.39760831 17.9947813,5.52032488 L18,5.4 Z M4.9603418,4.9 C5.2193418,4.9 5.4643418,4.837 5.6883418,4.704 C6.1293418,4.445 6.4093418,3.976 6.4093418,3.444 C6.4093418,3.003 6.2203418,2.611 5.9053418,2.359 C6.1643418,2.1 6.3393418,1.729 6.3393418,1.337 C6.3393418,1.092 6.2763418,0.861 6.1573418,0.658 C5.9053418,0.245 5.4643418,0 4.9603418,0 C4.7223418,0 4.4983418,0.056 4.2953418,0.175 C3.8753418,0.413 3.6163418,0.84 3.6163418,1.337 L3.6163418,1.372 L4.3373418,1.372 L4.3373418,1.337 C4.3373418,1.022 4.6313418,0.721 4.9603418,0.721 C5.3173418,0.721 5.6113418,1.008 5.6113418,1.337 C5.6113418,1.708 5.3243418,1.995 4.9603418,1.995 L4.8203418,1.995 L4.8203418,2.723 L4.9603418,2.723 C5.3593418,2.723 5.6883418,3.045 5.6883418,3.444 C5.6883418,3.843 5.3593418,4.179 4.9603418,4.179 C4.5613418,4.179 4.2323418,3.843 4.2323418,3.444 L4.2323418,3.339 L3.5043418,3.339 L3.5043418,3.444 C3.5043418,3.71 3.5673418,3.955 3.7003418,4.172 C3.9593418,4.62 4.4283418,4.9 4.9603418,4.9 Z M8.6073418,4.9 C8.8803418,4.9 9.1253418,4.83 9.3563418,4.697 C9.8043418,4.424 10.0983418,3.934 10.0983418,3.395 C10.0983418,3.122 10.0283418,2.877 9.8953418,2.646 C9.6223418,2.198 9.1463418,1.904 8.6073418,1.904 C8.5303418,1.904 8.4743418,1.904 8.4393418,1.911 L9.3143418,0 L8.5093418,0 L7.2353418,2.793 C7.1443418,2.982 7.1023418,3.185 7.1023418,3.395 C7.1023418,3.668 7.1723418,3.92 7.3053418,4.151 C7.5783418,4.606 8.0543418,4.9 8.6073418,4.9 Z M8.6073418,4.158 C8.1803418,4.158 7.8443418,3.822 7.8443418,3.395 C7.8443418,2.975 8.1873418,2.625 8.6073418,2.625 C9.0273418,2.625 9.3773418,2.975 9.3773418,3.395 C9.3773418,3.815 9.0273418,4.158 8.6073418,4.158 Z M12.2613418,4.907 C12.7653418,4.907 13.2133418,4.634 13.4653418,4.207 C13.5913418,3.997 13.6543418,3.766 13.6543418,3.514 L13.6543418,3.514 L13.6543418,1.428 C13.6543418,0.917 13.3813418,0.448 12.9613418,0.189 C12.7443418,0.063 12.5133418,0 12.2613418,0 C11.7503418,0 11.2813418,0.273 11.0293418,0.714 C10.8963418,0.931 10.8333418,1.169 10.8333418,1.428 L10.8333418,1.428 L10.8333418,3.514 C10.8333418,4.018 11.1063418,4.466 11.5473418,4.718 C11.7643418,4.844 12.0023418,4.907 12.2613418,4.907 Z M12.2613418,4.186 C11.8903418,4.186 11.5683418,3.885 11.5683418,3.514 L11.5683418,3.514 L11.5683418,1.428 C11.5683418,1.029 11.8763418,0.735 12.2613418,0.735 C12.6323418,0.735 12.9123418,1.029 12.9123418,1.428 L12.9123418,1.428 L12.9123418,3.514 C12.9123418,3.899 12.6323418,4.186 12.2613418,4.186 Z M15.4753809,2.07333984 C15.7488184,2.07333984 15.9886458,1.97478841 16.1948633,1.77768555 C16.4010807,1.58058268 16.5041895,1.33391927 16.5041895,1.03769531 C16.5041895,0.750585938 16.4050684,0.507340495 16.2068262,0.307958984 C16.008584,0.108577474 15.7647689,0.00888671875 15.4753809,0.00888671875 C15.1928288,0.00888671875 14.9495833,0.109147135 14.7456445,0.309667969 C14.5417057,0.510188802 14.4397363,0.756282552 14.4397363,1.04794922 C14.4397363,1.32138672 14.5365788,1.56064453 14.7302637,1.76572266 C14.9239486,1.97080078 15.172321,2.07333984 15.4753809,2.07333984 Z M15.4753809,1.70078125 C15.2930892,1.70078125 15.137002,1.63583984 15.0071191,1.50595703 C14.8772363,1.37607422 14.8122949,1.22226563 14.8122949,1.04453125 C14.8122949,0.859960938 14.877806,0.703304036 15.0088281,0.574560547 C15.1398503,0.445817057 15.2953678,0.381445313 15.4753809,0.381445313 C15.6553939,0.381445313 15.8097721,0.446386719 15.9385156,0.576269531 C16.0672591,0.706152344 16.1316309,0.859960938 16.1316309,1.03769531 C16.1316309,1.22226563 16.0661198,1.37892253 15.9350977,1.50766602 C15.8040755,1.63640951 15.6508366,1.70078125 15.4753809,1.70078125 Z"),te$4(tn,"fill","url(#xmfpi7cnc__sgsykm5x9a)"),te$4(tn,"transform","translate(3 3.1)"),te$4(en,"d","M18,5.4 L18,13.4 C18,15.3329966 13.9705627,16.9 9,16.9 C4.02943725,16.9 0,15.3329966 0,13.4 L0,5.4 C0,7.33299662 4.02943725,8.9 9,8.9 C13.8670094,8.9 17.8316983,7.39760831 17.9947813,5.52032488 L18,5.4 Z M17.8,6.499 L17.7806846,6.52607583 C16.6077599,8.0452893 13.108676,9.1 9,9.1 C4.87821133,9.1 1.38089175,8.04047836 0.214303539,6.51942435 L0.2,6.5 L0.2,13.4 C0.2,15.1332693 3.96631253,16.6348245 8.69056715,16.6979358 L9,16.7 C13.8681548,16.7 17.8,15.1709491 17.8,13.4 L17.8,6.499 Z M12.2613418,0 C12.5133418,0 12.7443418,0.063 12.9613418,0.189 C13.3813418,0.448 13.6543418,0.917 13.6543418,1.428 L13.6543418,3.514 L13.6467818,3.66268 C13.6266218,3.85756 13.5661418,4.039 13.4653418,4.207 C13.2133418,4.634 12.7653418,4.907 12.2613418,4.907 C12.0023418,4.907 11.7643418,4.844 11.5473418,4.718 C11.1063418,4.466 10.8333418,4.018 10.8333418,3.514 L10.8333418,1.428 L10.8409578,1.27512 C10.8613418,1.07464 10.9229418,0.8876 11.0293418,0.714 C11.2813418,0.273 11.7503418,0 12.2613418,0 Z M9.3143418,0 L8.4393418,1.911 C8.4743418,1.904 8.5303418,1.904 8.6073418,1.904 C9.1463418,1.904 9.6223418,2.198 9.8953418,2.646 C10.0283418,2.877 10.0983418,3.122 10.0983418,3.395 C10.0983418,3.934 9.8043418,4.424 9.3563418,4.697 C9.1253418,4.83 8.8803418,4.9 8.6073418,4.9 C8.0543418,4.9 7.5783418,4.606 7.3053418,4.151 C7.1723418,3.92 7.1023418,3.668 7.1023418,3.395 C7.1023418,3.185 7.1443418,2.982 7.2353418,2.793 L8.5093418,0 L9.3143418,0 Z M4.9603418,0 C5.4643418,0 5.9053418,0.245 6.1573418,0.658 C6.2763418,0.861 6.3393418,1.092 6.3393418,1.337 C6.3393418,1.729 6.1643418,2.1 5.9053418,2.359 C6.2203418,2.611 6.4093418,3.003 6.4093418,3.444 C6.4093418,3.976 6.1293418,4.445 5.6883418,4.704 C5.4643418,4.837 5.2193418,4.9 4.9603418,4.9 C4.4283418,4.9 3.9593418,4.62 3.7003418,4.172 C3.5673418,3.955 3.5043418,3.71 3.5043418,3.444 L3.5043418,3.339 L4.2323418,3.339 L4.2323418,3.444 C4.2323418,3.843 4.5613418,4.179 4.9603418,4.179 C5.3593418,4.179 5.6883418,3.843 5.6883418,3.444 C5.6883418,3.045 5.3593418,2.723 4.9603418,2.723 L4.8203418,2.723 L4.8203418,1.995 L4.9603418,1.995 C5.3243418,1.995 5.6113418,1.708 5.6113418,1.337 C5.6113418,1.008 5.3173418,0.721 4.9603418,0.721 C4.6313418,0.721 4.3373418,1.022 4.3373418,1.337 L4.3373418,1.372 L3.6163418,1.372 L3.6163418,1.337 C3.6163418,0.84 3.8753418,0.413 4.2953418,0.175 C4.4983418,0.056 4.7223418,0 4.9603418,0 Z M12.2613418,0.2 C11.8228535,0.2 11.4197491,0.433900098 11.199862,0.818512412 C11.0880596,1.00092699 11.0333418,1.20205175 11.0333418,1.428 L11.0333418,3.514 C11.0333418,3.94076817 11.2630074,4.32517296 11.6477689,4.54504221 C11.8340054,4.65317955 12.0373271,4.707 12.2613418,4.707 C12.685768,4.707 13.0724302,4.4792625 13.2938432,4.10410085 C13.4010506,3.92542185 13.4543418,3.73002084 13.4543418,3.514 L13.4543418,1.428 C13.4543418,0.993663172 13.2236099,0.585702454 12.8609147,0.361957789 C12.673578,0.253181671 12.4771013,0.2 12.2613418,0.2 Z M4.9603418,0.2 C4.75293536,0.2 4.56476024,0.248895899 4.39394431,0.349004437 C4.11167513,0.508956972 3.91907748,0.764507622 3.84741774,1.06716925 L3.829,1.171 L4.157,1.171 L4.1635929,1.14325273 C4.24904453,0.829489942 4.53273472,0.571946496 4.86075855,0.527713496 L4.9603418,0.521 C5.42264158,0.521 5.8113418,0.89242465 5.8113418,1.337 C5.8113418,1.78012728 5.4916909,2.13625035 5.06824166,2.18841646 L5.02,2.191 L5.02,2.526 L5.06813812,2.52919506 C5.49271718,2.57829524 5.83232975,2.91371045 5.88206553,3.33657664 L5.8883418,3.444 C5.8883418,3.95419336 5.46908818,4.379 4.9603418,4.379 C4.48793444,4.379 4.09269177,4.01271264 4.03863877,3.55189651 L4.037,3.539 L3.709,3.539 L3.71100539,3.58140766 C3.72435814,3.71571552 3.75785509,3.84083114 3.8121867,3.95771875 L3.87348876,4.07189941 C4.09978468,4.46333019 4.50573915,4.7 4.9603418,4.7 C5.18808795,4.7 5.39698916,4.6443932 5.58705743,4.53154283 C5.97364119,4.30450157 6.2093418,3.89738234 6.2093418,3.444 C6.2093418,3.06849319 6.05147644,2.73203269 5.78040279,2.51517376 L5.60591531,2.37558378 L5.76392044,2.21757864 C5.99772857,1.98377051 6.1393418,1.65985061 6.1393418,1.337 C6.1393418,1.12891147 6.08649325,0.932616859 5.98661394,0.762172929 C5.77036899,0.407771483 5.39348118,0.2 4.9603418,0.2 Z M9.002,0.2 L8.638,0.2 L7.41554213,2.87976312 C7.3587619,2.9976913 7.32347683,3.1241874 7.30938306,3.25833536 L7.3023418,3.395 C7.3023418,3.62951354 7.36137928,3.8474981 7.47684038,4.04810085 C7.72111603,4.45522692 8.1383802,4.7 8.6073418,4.7 C8.83989632,4.7 9.05100342,4.64201988 9.25226776,4.52621184 C9.649754,4.28399367 9.8983418,3.85400396 9.8983418,3.395 C9.8983418,3.16244548 9.84036168,2.95133838 9.72455364,2.75007403 C9.48026964,2.34919774 9.06277079,2.104 8.6073418,2.104 L8.51445661,2.10475811 C8.49442789,2.10527049 8.48389809,2.10604952 8.47856502,2.10711614 L8.0943966,2.18394982 L8.25749731,1.82773787 L9.002,0.2 Z M12.2613418,0.535 C12.7468356,0.535 13.1123418,0.922491584 13.1123418,1.428 L13.1123418,3.514 C13.1123418,4.00744192 12.7448365,4.386 12.2613418,4.386 C11.7777279,4.386 11.3683418,3.99355405 11.3683418,3.514 L11.3683418,1.428 C11.3683418,0.922753743 11.7615956,0.535 12.2613418,0.535 Z M8.6073418,2.425 C9.13779875,2.425 9.5773418,2.86454305 9.5773418,3.395 C9.5773418,3.92471151 9.13856864,4.358 8.6073418,4.358 C8.06988485,4.358 7.6443418,3.93245695 7.6443418,3.395 C7.6443418,2.86377316 8.07763029,2.425 8.6073418,2.425 Z M12.2613418,0.735 C11.8763418,0.735 11.5683418,1.029 11.5683418,1.428 L11.5683418,3.514 L11.5761202,3.61327273 C11.6272922,3.93723967 11.9240691,4.186 12.2613418,4.186 C12.6323418,4.186 12.9123418,3.899 12.9123418,3.514 L12.9123418,1.428 L12.9055416,1.32192712 C12.8606806,0.977975207 12.5986145,0.735 12.2613418,0.735 Z M8.6073418,2.625 C8.1873418,2.625 7.8443418,2.975 7.8443418,3.395 C7.8443418,3.822 8.1803418,4.158 8.6073418,4.158 C9.0273418,4.158 9.3773418,3.815 9.3773418,3.395 C9.3773418,2.975 9.0273418,2.625 8.6073418,2.625 Z M15.4753809,0.00888671875 C15.7647689,0.00888671875 16.008584,0.108577474 16.2068262,0.307958984 C16.4050684,0.507340495 16.5041895,0.750585938 16.5041895,1.03769531 C16.5041895,1.33391927 16.4010807,1.58058268 16.1948633,1.77768555 C15.9886458,1.97478841 15.7488184,2.07333984 15.4753809,2.07333984 C15.172321,2.07333984 14.9239486,1.97080078 14.7302637,1.76572266 C14.5365788,1.56064453 14.4397363,1.32138672 14.4397363,1.04794922 C14.4397363,0.756282552 14.5417057,0.510188802 14.7456445,0.309667969 C14.9495833,0.109147135 15.1928288,0.00888671875 15.4753809,0.00888671875 Z M15.4753809,0.381445313 C15.2953678,0.381445313 15.1398503,0.445817057 15.0088281,0.574560547 C14.877806,0.703304036 14.8122949,0.859960938 14.8122949,1.04453125 C14.8122949,1.22226563 14.8772363,1.37607422 15.0071191,1.50595703 C15.137002,1.63583984 15.2930892,1.70078125 15.4753809,1.70078125 C15.6508366,1.70078125 15.8040755,1.63640951 15.9350977,1.50766602 C16.0661198,1.37892253 16.1316309,1.22226563 16.1316309,1.03769531 C16.1316309,0.859960938 16.0672591,0.706152344 15.9385156,0.576269531 C15.8097721,0.446386719 15.6553939,0.381445313 15.4753809,0.381445313 Z"),te$4(en,"fill","url(#xmfpi7cnc__tjqs3iy6kb)"),te$4(en,"transform","translate(3 3.1)"),te$4(an,"d","M3.00030998,2.79110119 L3.00030998,8.00889881 C1.15888197,7.36802147 0,6.43664128 0,5.4 C0,4.36335872 1.15888197,3.43197853 3.00030998,2.79110119 Z M15.0006975,2.79145187 C16.8415407,3.43231826 18,4.36354778 18,5.4 C18,6.43645222 16.8415407,7.36768174 15.0006975,8.00854813 Z"),te$4(an,"fill","url(#xmfpi7cnc__rs5hxavsyc)"),te$4(an,"transform","translate(3 3.1)"),te$4(Br,"fill-rule","nonzero"),te$4(Br,"fill","none"),te$4(Be,"xmlns","http://www.w3.org/2000/svg"),te$4(Be,"viewBox","0 0 24 24"),te$4(Be,"width",$e[0]),te$4(Be,"height",$e[0]),te$4(Se,"class","icon-container svelte-1d6rvbz"),ne$5(Se,"--bg-color",$e[1])},m(rn,on){Nt$1(rn,Se,on),pt$1(Se,Be),pt$1(Be,De),pt$1(De,Ve),pt$1(Ve,Fe),pt$1(Ve,Je),pt$1(De,Xe),pt$1(Xe,Ke),pt$1(Xe,Ye),pt$1(De,or),pt$1(or,sr),pt$1(or,cr),pt$1(Be,Br),pt$1(Br,tn),pt$1(Br,en),pt$1(Br,an)},p(rn,[on]){on&1&&te$4(Be,"width",rn[0]),on&1&&te$4(Be,"height",rn[0]),on&2&&ne$5(Se,"--bg-color",rn[1])},i:N$f,o:N$f,d(rn){rn&&J$h(Se)}}}function B$6($e,Se,Be){let{size:De="28"}=Se,{color:Ve="#ffffff"}=Se,{bgColor:Fe="#0000004d"}=Se;return $e.$$set=Je=>{"size"in Je&&Be(0,De=Je.size),"color"in Je&&Be(2,Ve=Je.color),"bgColor"in Je&&Be(1,Fe=Je.bgColor)},[De,Fe,Ve]}let P$7=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,B$6,q$5,Ft$1,{size:0,color:2,bgColor:1},j$9)}};function u$f($e){if(!$e)return null;try{if($e.includes("youtu.be"))return new URL($e).pathname.substring(1);if($e.includes("youtube.com")){const De=new URL($e),Ve=new URLSearchParams(De.search).get("v");if(Ve)return Ve;if(De.pathname.includes("/embed/"))return De.pathname.split("/embed/")[1];if(De.pathname.includes("/shorts/"))return De.pathname.split("/shorts/")[1];if(De.pathname.includes("/live/"))return De.pathname.split("/live/")[1]}}catch{}const Se=/^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/|shorts\/|live\/)|(?:(?:watch)?\?v(?:i)?=|\&v(?:i)?=))([^#\&\?]*).*/,Be=$e.match(Se);return Be&&Be[1]?Be[1]:null}function i$7($e){if(!$e)return null;try{if($e.includes("vimeo.com")){const De=new URL($e).pathname.split("/").filter(Boolean);if(De.length>0){const Ve=De[0];if(/^\d+$/.test(Ve)&&Ve.length>=5)return Ve}}}catch{}const Se=/^.*vimeo\.com\/[A-Za-z\/]*(\d+)/,Be=$e.match(Se);return Be&&Be[1]&&Be[1].length>=5?Be[1]:null}function o$9($e){return $e?/^(http(s)?:\/\/)?((w){3}.)?youtu(be|.be)?(\.com)?\/.+/.test($e):!1}function m$b($e){return $e?/^(http(s)?:\/\/)?((w){3}.)?vimeo\.com\/(.+)/.test($e):!1}function l$e($e,Se){if(o$9($e)){const Be=u$f($e);if(!Be)return"";const De=new URL(`https://www.youtube.com/embed/${Be}`);return Se?.start!==void 0&&De.searchParams.set("start",Se.start.toString()),Se?.autoplay!==void 0&&De.searchParams.set("autoplay",Se.autoplay.toString()),De.toString()}if(m$b($e)){const Be=i$7($e);if(!Be)return"";const De=new URL(`https://player.vimeo.com/video/${Be}`);return Se?.autoplay!==void 0&&De.searchParams.set("autoplay",Se.autoplay.toString()),De.toString()}return $e}function H$8($e){Qt$1($e,"svelte-16y5k2u",".pano-tag-audio-popup-inline-player-wrapper.svelte-16y5k2u{width:100%;height:1.75rem;background-color:rgba(255, 255, 255, 0.06);border-radius:0.125rem;display:flex;align-items:center;cursor:pointer}.pano-tag-audio-popup-inline-player-icon.svelte-16y5k2u{width:1.5rem;height:1.5rem;display:flex;align-items:center;justify-content:center;flex-shrink:0}.pano-tag-audio-popup-inline-player-progress.svelte-16y5k2u{flex-grow:1;display:flex;position:relative;height:100%;align-items:center}.pano-tag-audio-popup-inline-player-progress-bar.svelte-16y5k2u{width:0;height:100%;background:linear-gradient(to right, rgba(238, 238, 238, 0) 0, rgba(216, 216, 216, 0.3) 100%);position:absolute;top:0;left:0;z-index:0}.pano-tag-audio-popup-inline-player-elapsed-time.svelte-16y5k2u{position:absolute;z-index:1;font-weight:500;font-size:0.875rem;color:#ffffff;line-height:1.25rem;padding-left:0.25rem}")}function J$3($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr;return De=new X$3({props:{playing:$e[0],width:24}}),{c(){Se=K$g("div"),Be=K$g("div"),Ae$2(De.$$.fragment),Ve=Xt$2(),Fe=K$g("div"),Je=K$g("div"),Xe=Xt$2(),Ke=K$g("div"),Ye=gt$2($e[1]),te$4(Be,"class","pano-tag-audio-popup-inline-player-icon svelte-16y5k2u"),te$4(Je,"class","pano-tag-audio-popup-inline-player-progress-bar svelte-16y5k2u"),ne$5(Je,"width",$e[2]+"%"),te$4(Ke,"class","pano-tag-audio-popup-inline-player-elapsed-time svelte-16y5k2u"),te$4(Fe,"class","pano-tag-audio-popup-inline-player-progress svelte-16y5k2u"),te$4(Se,"class","pano-tag-audio-popup-inline-player-wrapper svelte-16y5k2u")},m(Br,tn){Nt$1(Br,Se,tn),pt$1(Se,Be),Dt$1(De,Be,null),pt$1(Se,Ve),pt$1(Se,Fe),pt$1(Fe,Je),pt$1(Fe,Xe),pt$1(Fe,Ke),pt$1(Ke,Ye),or=!0,sr||(cr=lt$2(Se,"click",Zt$1(function(){L$k($e[3])&&$e[3].apply(this,arguments)})),sr=!0)},p(Br,[tn]){$e=Br;const en={};tn&1&&(en.playing=$e[0]),De.$set(en),(!or||tn&4)&&ne$5(Je,"width",$e[2]+"%"),(!or||tn&2)&&ee$5(Ye,$e[1])},i(Br){or||(ot$4(De.$$.fragment,Br),or=!0)},o(Br){$t(De.$$.fragment,Br),or=!1},d(Br){Br&&J$h(Se),Rt(De),sr=!1,cr()}}}function K$1($e,Se,Be){let{playing:De=!1}=Se,{elapsedTime:Ve="00:00"}=Se,{progress:Fe=0}=Se,{onClick:Je=()=>{}}=Se;return $e.$$set=Xe=>{"playing"in Xe&&Be(0,De=Xe.playing),"elapsedTime"in Xe&&Be(1,Ve=Xe.elapsedTime),"progress"in Xe&&Be(2,Fe=Xe.progress),"onClick"in Xe&&Be(3,Je=Xe.onClick)},[De,Ve,Fe,Je]}let U$4=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,K$1,J$3,Ft$1,{playing:0,elapsedTime:1,progress:2,onClick:3},H$8)}};function fe$1($e){Qt$1($e,"svelte-tc67u7",'@charset "UTF-8";.tag-popup.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{position:absolute;pointer-events:auto;padding:0.625rem 0.625rem 0.625rem 1.125rem;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;transform-origin:center}.tag-popup-top.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(-50%, -100%);left:50%}.tag-popup-bottom.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(-50%, 0);left:50%}.tag-popup-left.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(-100%, -50%);top:50%}.tag-popup-right.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(0, -50%);top:50%}.tag-popup-top-left.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(calc(2.625rem - 100%), -100%)}.tag-popup-top-right.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(-2.625rem, -100%)}.tag-popup-bottom-left.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(calc(2.625rem - 100%), 0)}.tag-popup-bottom-right.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(-2.625rem, 0)}.tag-popup-left-top.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(-100%, -2.625rem)}.tag-popup-left-bottom.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(-100%, calc(2.625rem - 100%))}.tag-popup-right-top.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(0, -2.625rem)}.tag-popup-right-bottom.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{transform:translate(0, calc(2.625rem - 100%))}.tag-popup-content.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{position:relative;pointer-events:auto;cursor:pointer;padding:1.25rem;border-radius:0.375rem;max-width:17.5rem;width:17.5rem;background:rgba(0, 0, 0, 0.7490196078)}.tag-popup-top.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7,.tag-popup-top-left.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7,.tag-popup-top-right.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7{box-shadow:0.03125rem 0 0 0 rgba(255, 255, 255, 0.3), -0.03125rem 0 0 0 rgba(255, 255, 255, 0.3)}.tag-popup-bottom.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7,.tag-popup-bottom-left.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7,.tag-popup-bottom-right.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7{box-shadow:0.03125rem 0 0 0 rgba(255, 255, 255, 0.3), -0.03125rem 0 0 0 rgba(255, 255, 255, 0.3)}.tag-popup-left.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7,.tag-popup-left-top.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7,.tag-popup-left-bottom.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7{box-shadow:0 0.03125rem 0 0 rgba(255, 255, 255, 0.3), 0 -0.03125rem 0 0 rgba(255, 255, 255, 0.3)}.tag-popup-right.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7,.tag-popup-right-top.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7,.tag-popup-right-bottom.svelte-tc67u7 .tag-popup-content.svelte-tc67u7.svelte-tc67u7{box-shadow:0 0.03125rem 0 0 rgba(255, 255, 255, 0.3), 0 -0.03125rem 0 0 rgba(255, 255, 255, 0.3)}.light.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{background:#ffffff}.tag-popup-title.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{margin:0;font-size:1rem;font-weight:600;line-height:1.375rem;letter-spacing:0;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;color:#ffffff}.light.svelte-tc67u7 .tag-popup-title.svelte-tc67u7.svelte-tc67u7{color:rgba(0, 0, 0, 0.8509803922)}.tag-popup-description.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{margin:0;font-size:0.875rem;font-weight:400;color:#ffffff;line-height:1.25rem;max-height:5rem;overflow:hidden;word-wrap:break-word;word-break:break-word;white-space:pre-wrap}.light.svelte-tc67u7 .tag-popup-description.svelte-tc67u7.svelte-tc67u7{color:rgba(0, 0, 0, 0.8509803922)}.tag-popup-tags.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{display:flex;align-items:center;margin:0;margin-bottom:0}.tag-popup-tags.svelte-tc67u7 .tag-popup-tag.svelte-tc67u7+.tag-popup-tag.svelte-tc67u7{margin-left:0.25rem}.tag-popup-tag.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{padding:0.125rem 0.25rem;display:flex;align-items:center;justify-content:center;border-radius:0.25rem;font-size:0.75rem;line-height:1.125rem;letter-spacing:0;border-radius:0.125rem;max-width:7.5rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tag-popup-tag-primary.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{color:#ffffff;background-image:linear-gradient(90deg, #ead09a 0%, #e0cca3 100%)}.light.svelte-tc67u7 .tag-popup-tag-primary.svelte-tc67u7.svelte-tc67u7{color:#946700;background-image:linear-gradient(90deg, #ead09a 0%, #e0cca3 100%)}.tag-popup-tag-secondary.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{color:#ffffff;background:rgba(255, 255, 255, 0.1490196078)}.light.svelte-tc67u7 .tag-popup-tag-secondary.svelte-tc67u7.svelte-tc67u7{color:rgba(0, 0, 0, 0.5019607843);background:rgba(0, 0, 0, 0.0588235294)}.tag-popup-price.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{font-family:DINAlternate-Bold;font-weight:700;font-size:1.25rem;color:#ae7900;letter-spacing:0;text-align:center;display:flex;justify-content:flex-start;align-items:center;width:100%;margin:0}.tag-popup-media.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{width:15rem;height:10rem;margin:0 auto;overflow:hidden;border-radius:0.25rem;display:flex;align-items:center;justify-content:center;position:relative}.tag-popup-media.svelte-tc67u7 img.svelte-tc67u7.svelte-tc67u7{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;display:block}.tag-popup-media-type.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);z-index:2}.tag-popup-media-index.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{position:absolute;right:0.375rem;bottom:0.375rem;padding:0.0625rem 0.25rem;background:rgba(0, 0, 0, 0.5);border-radius:0.125rem;font-weight:bold;font-size:0.75rem;color:#ffffff;letter-spacing:0;line-height:1.125rem}.iframe-overlay.svelte-tc67u7.svelte-tc67u7.svelte-tc67u7{position:absolute;top:0;left:0;width:100%;height:100%;background:transparent;z-index:10}.tag-popup-content.svelte-tc67u7>.svelte-tc67u7+.svelte-tc67u7{margin-top:0.5rem}.tag-popup-content.svelte-tc67u7>.svelte-tc67u7.svelte-tc67u7:first-child{margin-top:0 !important}')}const de=$e=>({}),qt=$e=>({}),me=$e=>({}),Bt=$e=>({});function Lt($e,Se,Be){const De=$e.slice();return De[2]=Se[Be],De}function Yt($e,Se,Be){const De=$e.slice();return De[2]=Se[Be],De}function Et($e){let Se,Be;return{c(){Se=K$g("h3"),Be=gt$2($e[5]),te$4(Se,"class","tag-popup-title svelte-tc67u7")},m(De,Ve){Nt$1(De,Se,Ve),pt$1(Se,Be)},p(De,Ve){Ve[0]&32&&ee$5(Be,De[5])},d(De){De&&J$h(Se)}}}function Nt($e){let Se,Be,De=$e[4],Ve=[];for(let Xe=0;Xe<De.length;Xe+=1)Ve[Xe]=Gt(Yt($e,De,Xe));let Fe=$e[13],Je=[];for(let Xe=0;Xe<Fe.length;Xe+=1)Je[Xe]=Ht$1(Lt($e,Fe,Xe));return{c(){Se=K$g("div");for(let Xe=0;Xe<Ve.length;Xe+=1)Ve[Xe].c();Be=Xt$2();for(let Xe=0;Xe<Je.length;Xe+=1)Je[Xe].c();te$4(Se,"class","tag-popup-tags svelte-tc67u7")},m(Xe,Ke){Nt$1(Xe,Se,Ke);for(let Ye=0;Ye<Ve.length;Ye+=1)Ve[Ye]&&Ve[Ye].m(Se,null);pt$1(Se,Be);for(let Ye=0;Ye<Je.length;Ye+=1)Je[Ye]&&Je[Ye].m(Se,null)},p(Xe,Ke){if(Ke[0]&16){De=Xe[4];let Ye;for(Ye=0;Ye<De.length;Ye+=1){const or=Yt(Xe,De,Ye);Ve[Ye]?Ve[Ye].p(or,Ke):(Ve[Ye]=Gt(or),Ve[Ye].c(),Ve[Ye].m(Se,Be))}for(;Ye<Ve.length;Ye+=1)Ve[Ye].d(1);Ve.length=De.length}if(Ke[0]&8192){Fe=Xe[13];let Ye;for(Ye=0;Ye<Fe.length;Ye+=1){const or=Lt(Xe,Fe,Ye);Je[Ye]?Je[Ye].p(or,Ke):(Je[Ye]=Ht$1(or),Je[Ye].c(),Je[Ye].m(Se,null))}for(;Ye<Je.length;Ye+=1)Je[Ye].d(1);Je.length=Fe.length}},d(Xe){Xe&&J$h(Se),Vt(Ve,Xe),Vt(Je,Xe)}}}function Gt($e){let Se,Be=$e[2]+"",De;return{c(){Se=K$g("div"),De=gt$2(Be),te$4(Se,"class","tag-popup-tag tag-popup-tag-primary svelte-tc67u7")},m(Ve,Fe){Nt$1(Ve,Se,Fe),pt$1(Se,De)},p(Ve,Fe){Fe[0]&16&&Be!==(Be=Ve[2]+"")&&ee$5(De,Be)},d(Ve){Ve&&J$h(Se)}}}function Ht$1($e){let Se,Be=$e[2]+"",De;return{c(){Se=K$g("div"),De=gt$2(Be),te$4(Se,"class","tag-popup-tag tag-popup-tag-secondary svelte-tc67u7")},m(Ve,Fe){Nt$1(Ve,Se,Fe),pt$1(Se,De)},p(Ve,Fe){Fe[0]&8192&&Be!==(Be=Ve[2]+"")&&ee$5(De,Be)},d(Ve){Ve&&J$h(Se)}}}function ge$1($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke;Je=new B$7({});let Ye=$e[15]>1&&Jt($e);return{c(){Se=K$g("div"),Be=K$g("video"),Ve=Xt$2(),Fe=K$g("div"),Ae$2(Je.$$.fragment),Xe=Xt$2(),Ye&&Ye.c(),Wt$2(Be.src,De=$e[2].data.mediaData[0].url)||te$4(Be,"src",De),te$4(Be,"class","tag-popup-video-fallback"),Be.controls=!1,Be.autoplay=!1,Be.muted=!0,Be.loop=!0,te$4(Be,"preload","metadata"),te$4(Be,"disablepictureinpicture",""),Be.playsInline=!0,ne$5(Be,"width","100%"),ne$5(Be,"height","100%"),ne$5(Be,"object-fit","cover"),te$4(Fe,"class","tag-popup-media-type svelte-tc67u7"),te$4(Se,"class","tag-popup-media svelte-tc67u7")},m(or,sr){Nt$1(or,Se,sr),pt$1(Se,Be),pt$1(Se,Ve),pt$1(Se,Fe),Dt$1(Je,Fe,null),pt$1(Se,Xe),Ye&&Ye.m(Se,null),Ke=!0},p(or,sr){(!Ke||sr[0]&4&&!Wt$2(Be.src,De=or[2].data.mediaData[0].url))&&te$4(Be,"src",De),or[15]>1?Ye?Ye.p(or,sr):(Ye=Jt(or),Ye.c(),Ye.m(Se,null)):Ye&&(Ye.d(1),Ye=null)},i(or){Ke||(ot$4(Je.$$.fragment,or),Ke=!0)},o(or){$t(Je.$$.fragment,or),Ke=!1},d(or){or&&J$h(Se),Rt(Je),Ye&&Ye.d()}}}function ve($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye;const or=[be,he],sr=[];function cr(tn,en){return tn[7]?0:tn[18]?1:-1}~(Je=cr($e))&&(Xe=sr[Je]=or[Je]($e));let Br=$e[15]>1&&Kt($e);return{c(){Se=K$g("div"),Be=K$g("img"),Fe=Xt$2(),Xe&&Xe.c(),Ke=Xt$2(),Br&&Br.c(),Wt$2(Be.src,De=$e[19])||te$4(Be,"src",De),te$4(Be,"alt",Ve=$e[5]||""),te$4(Be,"draggable","false"),te$4(Be,"class","svelte-tc67u7"),te$4(Se,"class","tag-popup-media svelte-tc67u7")},m(tn,en){Nt$1(tn,Se,en),pt$1(Se,Be),pt$1(Se,Fe),~Je&&sr[Je].m(Se,null),pt$1(Se,Ke),Br&&Br.m(Se,null),Ye=!0},p(tn,en){(!Ye||en[0]&524288&&!Wt$2(Be.src,De=tn[19]))&&te$4(Be,"src",De),(!Ye||en[0]&32&&Ve!==(Ve=tn[5]||""))&&te$4(Be,"alt",Ve);let an=Je;Je=cr(tn),Je!==an&&(Xe&&(Lt$1(),$t(sr[an],1,1,()=>{sr[an]=null}),Ot$2()),~Je?(Xe=sr[Je],Xe||(Xe=sr[Je]=or[Je](tn),Xe.c()),ot$4(Xe,1),Xe.m(Se,Ke)):Xe=null),tn[15]>1?Br?Br.p(tn,en):(Br=Kt(tn),Br.c(),Br.m(Se,null)):Br&&(Br.d(1),Br=null)},i(tn){Ye||(ot$4(Xe),Ye=!0)},o(tn){$t(Xe),Ye=!1},d(tn){tn&&J$h(Se),~Je&&sr[Je].d(),Br&&Br.d()}}}function _e($e){let Se,Be,De,Ve,Fe,Je,Xe=$e[15]>1&&Ot($e);return{c(){Se=K$g("div"),Be=K$g("iframe"),Ve=Xt$2(),Fe=K$g("div"),Je=Xt$2(),Xe&&Xe.c(),te$4(Be,"title",$e[16]),Wt$2(Be.src,De=$e[17])||te$4(Be,"src",De),te$4(Be,"class","tag-popup-video-iframe"),te$4(Be,"frameborder","0"),te$4(Be,"allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"),te$4(Be,"referrerpolicy","strict-origin-when-cross-origin"),Be.allowFullscreen=!0,ne$5(Be,"width","100%"),ne$5(Be,"height","100%"),ne$5(Be,"position","absolute"),ne$5(Be,"top","0"),ne$5(Be,"left","0"),te$4(Fe,"class","iframe-overlay svelte-tc67u7"),te$4(Se,"class","tag-popup-media svelte-tc67u7")},m(Ke,Ye){Nt$1(Ke,Se,Ye),pt$1(Se,Be),pt$1(Se,Ve),pt$1(Se,Fe),pt$1(Se,Je),Xe&&Xe.m(Se,null)},p(Ke,Ye){Ye[0]&65536&&te$4(Be,"title",Ke[16]),Ye[0]&131072&&!Wt$2(Be.src,De=Ke[17])&&te$4(Be,"src",De),Ke[15]>1?Xe?Xe.p(Ke,Ye):(Xe=Ot(Ke),Xe.c(),Xe.m(Se,null)):Xe&&(Xe.d(1),Xe=null)},i:N$f,o:N$f,d(Ke){Ke&&J$h(Se),Xe&&Xe.d()}}}function Jt($e){let Se,Be,De,Ve;return{c(){Se=K$g("div"),Be=gt$2($e[14]),De=gt$2("/"),Ve=gt$2($e[15]),te$4(Se,"class","tag-popup-media-index svelte-tc67u7")},m(Fe,Je){Nt$1(Fe,Se,Je),pt$1(Se,Be),pt$1(Se,De),pt$1(Se,Ve)},p(Fe,Je){Je[0]&16384&&ee$5(Be,Fe[14]),Je[0]&32768&&ee$5(Ve,Fe[15])},d(Fe){Fe&&J$h(Se)}}}function he($e){let Se,Be,De;return Be=new P$7({}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","tag-popup-media-type svelte-tc67u7")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function be($e){let Se,Be,De;return Be=new B$7({}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","tag-popup-media-type svelte-tc67u7")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function Kt($e){let Se,Be,De,Ve;return{c(){Se=K$g("div"),Be=gt$2($e[14]),De=gt$2("/"),Ve=gt$2($e[15]),te$4(Se,"class","tag-popup-media-index svelte-tc67u7")},m(Fe,Je){Nt$1(Fe,Se,Je),pt$1(Se,Be),pt$1(Se,De),pt$1(Se,Ve)},p(Fe,Je){Je[0]&16384&&ee$5(Be,Fe[14]),Je[0]&32768&&ee$5(Ve,Fe[15])},d(Fe){Fe&&J$h(Se)}}}function Ot($e){let Se,Be,De,Ve;return{c(){Se=K$g("div"),Be=gt$2($e[14]),De=gt$2("/"),Ve=gt$2($e[15]),te$4(Se,"class","tag-popup-media-index svelte-tc67u7")},m(Fe,Je){Nt$1(Fe,Se,Je),pt$1(Se,Be),pt$1(Se,De),pt$1(Se,Ve)},p(Fe,Je){Je[0]&16384&&ee$5(Be,Fe[14]),Je[0]&32768&&ee$5(Ve,Fe[15])},d(Fe){Fe&&J$h(Se)}}}function Qt($e){let Se,Be;return{c(){Se=K$g("div"),Be=gt$2($e[20]),te$4(Se,"class","tag-popup-description svelte-tc67u7")},m(De,Ve){Nt$1(De,Se,Ve),pt$1(Se,Be)},p(De,Ve){Ve[0]&1048576&&ee$5(Be,De[20])},d(De){De&&J$h(Se)}}}function Wt$1($e){let Se,Be,De;return Be=new U$4({props:{playing:$e[1],progress:$e[9],elapsedTime:$e[10],onClick:$e[22]}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","tag-popup-audio-player-wrapper svelte-tc67u7")},m(Ve,Fe){Nt$1(Ve,Se,Fe),Dt$1(Be,Se,null),De=!0},p(Ve,Fe){const Je={};Fe[0]&2&&(Je.playing=Ve[1]),Fe[0]&512&&(Je.progress=Ve[9]),Fe[0]&1024&&(Je.elapsedTime=Ve[10]),Be.$set(Je)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Ve&&J$h(Se),Rt(Be)}}}function Xt($e){let Se,Be,De,Ve,Fe=$e[11]&&Zt($e);return{c(){Se=K$g("div"),Fe&&Fe.c(),Be=Xt$2(),De=K$g("span"),Ve=gt$2($e[12]),te$4(De,"class","tag-popup-price-value"),te$4(Se,"class","tag-popup-price svelte-tc67u7")},m(Je,Xe){Nt$1(Je,Se,Xe),Fe&&Fe.m(Se,null),pt$1(Se,Be),pt$1(Se,De),pt$1(De,Ve)},p(Je,Xe){Je[11]?Fe?Fe.p(Je,Xe):(Fe=Zt(Je),Fe.c(),Fe.m(Se,Be)):Fe&&(Fe.d(1),Fe=null),Xe[0]&4096&&ee$5(Ve,Je[12])},d(Je){Je&&J$h(Se),Fe&&Fe.d()}}}function Zt($e){let Se,Be;return{c(){Se=K$g("span"),Be=gt$2($e[11]),te$4(Se,"class","tag-popup-price-unit")},m(De,Ve){Nt$1(De,Se,Ve),pt$1(Se,Be)},p(De,Ve){Ve[0]&2048&&ee$5(Be,De[11])},d(De){De&&J$h(Se)}}}function ye($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en=$e[5]&&Et($e),an=$e[3]&&($e[4].length>0||$e[13].length>0)&&Nt($e);const rn=[_e,ve,ge$1],on=[];function sn(dn,fn){var yn;return dn[6]&&dn[17]?0:dn[19]?1:dn[7]&&dn[2].data.mediaData&&(yn=dn[2].data.mediaData[0])!=null&&yn.url?2:-1}~(Fe=sn($e))&&(Je=on[Fe]=rn[Fe]($e));let ln=$e[20]&&Qt($e),cn=$e[8]&&Wt$1($e),hn=$e[12]&&Xt($e);const mn=$e[38].toolbar,An=Bt$1(mn,$e,$e[37],Bt),xn=$e[38].arrow,pn=Bt$1(xn,$e,$e[37],qt);return{c(){Se=K$g("div"),Be=K$g("div"),en&&en.c(),De=Xt$2(),an&&an.c(),Ve=Xt$2(),Je&&Je.c(),Xe=Xt$2(),ln&&ln.c(),Ke=Xt$2(),cn&&cn.c(),Ye=Xt$2(),hn&&hn.c(),or=Xt$2(),An&&An.c(),sr=Xt$2(),pn&&pn.c(),te$4(Be,"class",cr="tag-popup-content "+$e[21]+" svelte-tc67u7"),te$4(Se,"class",Br="tag-popup tag-popup-"+$e[0]+" svelte-tc67u7")},m(dn,fn){Nt$1(dn,Se,fn),pt$1(Se,Be),en&&en.m(Be,null),pt$1(Be,De),an&&an.m(Be,null),pt$1(Be,Ve),~Fe&&on[Fe].m(Be,null),pt$1(Be,Xe),ln&&ln.m(Be,null),pt$1(Be,Ke),cn&&cn.m(Be,null),pt$1(Be,Ye),hn&&hn.m(Be,null),pt$1(Be,or),An&&An.m(Be,null),pt$1(Be,sr),pn&&pn.m(Be,null),tn=!0},p(dn,fn){dn[5]?en?en.p(dn,fn):(en=Et(dn),en.c(),en.m(Be,De)):en&&(en.d(1),en=null),dn[3]&&(dn[4].length>0||dn[13].length>0)?an?an.p(dn,fn):(an=Nt(dn),an.c(),an.m(Be,Ve)):an&&(an.d(1),an=null);let yn=Fe;Fe=sn(dn),Fe===yn?~Fe&&on[Fe].p(dn,fn):(Je&&(Lt$1(),$t(on[yn],1,1,()=>{on[yn]=null}),Ot$2()),~Fe?(Je=on[Fe],Je?Je.p(dn,fn):(Je=on[Fe]=rn[Fe](dn),Je.c()),ot$4(Je,1),Je.m(Be,Xe)):Je=null),dn[20]?ln?ln.p(dn,fn):(ln=Qt(dn),ln.c(),ln.m(Be,Ke)):ln&&(ln.d(1),ln=null),dn[8]?cn?(cn.p(dn,fn),fn[0]&256&&ot$4(cn,1)):(cn=Wt$1(dn),cn.c(),ot$4(cn,1),cn.m(Be,Ye)):cn&&(Lt$1(),$t(cn,1,1,()=>{cn=null}),Ot$2()),dn[12]?hn?hn.p(dn,fn):(hn=Xt(dn),hn.c(),hn.m(Be,or)):hn&&(hn.d(1),hn=null),An&&An.p&&(!tn||fn[1]&64)&&It(An,mn,dn,dn[37],tn?Ht$2(mn,dn[37],fn,me):Ut(dn[37]),Bt),pn&&pn.p&&(!tn||fn[1]&64)&&It(pn,xn,dn,dn[37],tn?Ht$2(xn,dn[37],fn,de):Ut(dn[37]),qt),(!tn||fn[0]&2097152&&cr!==(cr="tag-popup-content "+dn[21]+" svelte-tc67u7"))&&te$4(Be,"class",cr),(!tn||fn[0]&1&&Br!==(Br="tag-popup tag-popup-"+dn[0]+" svelte-tc67u7"))&&te$4(Se,"class",Br)},i(dn){tn||(ot$4(Je),ot$4(cn),ot$4(An,dn),ot$4(pn,dn),tn=!0)},o(dn){$t(Je),$t(cn),$t(An,dn),$t(pn,dn),tn=!1},d(dn){dn&&J$h(Se),en&&en.d(),an&&an.d(),~Fe&&on[Fe].d(),ln&&ln.d(),cn&&cn.d(),hn&&hn.d(),An&&An.d(dn),pn&&pn.d(dn)}}}function ke($e){const Se=Math.floor($e/60),Be=Math.floor($e%60);return`${Se.toString().padStart(2,"0")}:${Be.toString().padStart(2,"0")}`}function we($e,Se,Be){let De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an,rn,on,sn,ln,cn,hn,mn,An,xn,pn,dn,fn,{$$slots:yn={},$$scope:Sn}=Se,{tag:gn}=Se,{config:Cn={}}=Se,{theme:Mn=void 0}=Se,{placement:Bn="right-top"}=Se,{audioInstance:kn=null}=Se,{audioPlaying:Ln=!1}=Se,{audioCurrentTime:Pn=0}=Se,{audioDuration:Vn=0}=Se,Yn=0,ni="00:00",Rn=null,In=0,Gn=0;function Fn(){return Vn>0?Pn/Vn*100:0}function Hn(){if(!Ln||Vn<=0){Rn=null;return}const Zn=(Date.now()-In)/1e3,si=Pn+Zn,ei=Math.min(si/Vn*100,100)-Gn;Math.abs(ei)>.05&&(Gn+=ei*.2),Rn=requestAnimationFrame(Hn)}function Dn(){if(!Ve)return;const Zn=Fn();Vn>0?(Ln||(Gn=Zn),Be(9,Yn=Gn),Be(10,ni=ke(Gn/100*Vn)),In=Date.now()):(Gn=0,Be(9,Yn=0),Be(10,ni="00:00"))}function zn(){Ln&&Vn>0?Rn||Hn():Rn&&(cancelAnimationFrame(Rn),Rn=null)}function Qn(){kn&&(kn.paused?kn.play():kn.pause())}return le$1(()=>{Rn&&(cancelAnimationFrame(Rn),Rn=null)}),$e.$$set=Zn=>{"tag"in Zn&&Be(2,gn=Zn.tag),"config"in Zn&&Be(23,Cn=Zn.config),"theme"in Zn&&Be(24,Mn=Zn.theme),"placement"in Zn&&Be(0,Bn=Zn.placement),"audioInstance"in Zn&&Be(25,kn=Zn.audioInstance),"audioPlaying"in Zn&&Be(1,Ln=Zn.audioPlaying),"audioCurrentTime"in Zn&&Be(26,Pn=Zn.audioCurrentTime),"audioDuration"in Zn&&Be(27,Vn=Zn.audioDuration),"$$scope"in Zn&&Be(37,Sn=Zn.$$scope)},$e.$$.update=()=>{var Zn,si,ei,hi,Un,Wn;$e.$$.dirty[0]&4&&Be(3,De=gn.contentType==="Marketing"),$e.$$.dirty[0]&4&&Be(8,Ve=gn.contentType==="Audio"),$e.$$.dirty[0]&8&&Be(36,Fe=De?"light":"dark"),$e.$$.dirty[0]&16777220|$e.$$.dirty[1]&32&&Be(21,Je=gn.data.theme!==void 0&&gn.data.theme!==null?gn.data.theme:Mn??Fe),$e.$$.dirty[0]&4&&Be(35,Xe=gn.data.title||gn.data.name||""),$e.$$.dirty[0]&4&&Be(34,Ke=gn.data.description||gn.data.tooltip||""),$e.$$.dirty[1]&16&&Be(5,Ye=Xe||""),$e.$$.dirty[1]&8&&Be(20,or=Ke||""),$e.$$.dirty[0]&201326594&&Dn(),$e.$$.dirty[0]&134217730&&zn(),$e.$$.dirty[0]&268&&Be(33,sr=(()=>{var Ai,oi,ci,ai,wi,Pi,Oi,Ri,_i,Mi,$i;if(Ve||De)return null;if(gn.data.mediaData&&gn.data.mediaData.length>0){const vi=gn.data.mediaData[0];if(vi.type==="Video"){if(vi.videoCoverUrl)return vi.videoCoverUrl;if(vi.url){const ri=vi.url.toLowerCase();if(o$9(ri)){const Ti=u$f(ri);if(Ti)return`https://img.youtube.com/vi/${Ti}/hqdefault.jpg`}if(m$b(ri)){const Ti=i$7(ri);if(Ti)return`https://vumbnail.com/${Ti}.jpg`}return}}if(gn.contentType==="Panorama")return($i=(Oi=(ci=(oi=(Ai=gn.data.mediaData)==null?void 0:Ai[0])==null?void 0:oi.cube)==null?void 0:ci.front)!=null?Oi:(Pi=(wi=(ai=gn.data.mediaData)==null?void 0:ai[0])==null?void 0:wi.thumbnail)==null?void 0:Pi.split("?")[0])!=null?$i:(Mi=(_i=(Ri=gn.data.mediaData)==null?void 0:Ri[0])==null?void 0:_i.url)==null?void 0:Mi.split("?")[0];if(vi.url||vi.thumbnail)return vi.url||vi.thumbnail}return gn.data.imageUrl})()),$e.$$.dirty[0]&8388612|$e.$$.dirty[1]&4&&Be(19,cr=Cn!=null&&Cn.imageURLTransform&&(sr!=null&&sr.includes("realsee-cdn")||sr!=null&&sr.includes("ljcdn.com"))?Cn.imageURLTransform(sr,{width:280,height:280}):sr||gn.data.mediaUrl||""),$e.$$.dirty[0]&4&&Be(7,Br=gn.contentType==="Video"||gn.data.mediaType==="video"),$e.$$.dirty[0]&4&&Be(18,tn=gn.contentType==="Panorama"||gn.data.mediaType==="panorama"),$e.$$.dirty[0]&132&&Be(32,en=Br&&gn.data.mediaData&&((Zn=gn.data.mediaData[0])==null?void 0:Zn.url)&&o$9(gn.data.mediaData[0].url)),$e.$$.dirty[0]&132&&Be(31,an=Br&&gn.data.mediaData&&((si=gn.data.mediaData[0])==null?void 0:si.url)&&m$b(gn.data.mediaData[0].url)),$e.$$.dirty[1]&3&&Be(6,rn=en||an),$e.$$.dirty[0]&68&&Be(17,on=rn&&gn.data.mediaData&&(ei=gn.data.mediaData[0])!=null&&ei.url?l$e(gn.data.mediaData[0].url,{autoplay:0}):""),$e.$$.dirty[0]&32|$e.$$.dirty[1]&3&&Be(16,sn=en?"YouTube video player":an?"Vimeo video player":Ye),$e.$$.dirty[0]&4&&Be(15,ln=((hi=gn.data.mediaData)==null?void 0:hi.length)||0),$e.$$.dirty[0]&12&&Be(30,hn=De?gn.data.brandTags||[]:[]),$e.$$.dirty[0]&12&&Be(29,mn=De?gn.data.tags||[]:[]),$e.$$.dirty[0]&1073741824&&Be(4,An=hn.filter(Boolean).slice(0,2)),$e.$$.dirty[0]&16&&Be(28,xn=Math.max(0,2-An.length)),$e.$$.dirty[0]&805306368&&Be(13,pn=xn>0?mn.filter(Boolean).slice(0,xn):[]),$e.$$.dirty[0]&12&&Be(12,dn=De&&((Un=gn.data.price)==null?void 0:Un.value)||""),$e.$$.dirty[0]&12&&Be(11,fn=De&&((Wn=gn.data.price)==null?void 0:Wn.unit)||"")},Be(14,cn=1),[Bn,Ln,gn,De,An,Ye,rn,Br,Ve,Yn,ni,fn,dn,pn,cn,ln,sn,on,tn,cr,or,Je,Qn,Cn,Mn,kn,Pn,Vn,xn,mn,hn,an,en,sr,Ke,Xe,Fe,Sn,yn]}let Ae$1=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,we,ye,Ft$1,{tag:2,config:23,theme:24,placement:0,audioInstance:25,audioPlaying:1,audioCurrentTime:26,audioDuration:27},fe$1,[-1,-1])}};function q$4($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br;return{c(){Se=Mt("svg"),Be=Mt("defs"),De=Mt("linearGradient"),Ve=Mt("stop"),Fe=Mt("stop"),Xe=Mt("linearGradient"),Ke=Mt("stop"),Ye=Mt("stop"),sr=Mt("path"),te$4(Ve,"stop-color",$e[1]),te$4(Ve,"offset","0%"),te$4(Fe,"stop-color",$e[1]),te$4(Fe,"stop-opacity",".5"),te$4(Fe,"offset","100%"),te$4(De,"id",Je="arrow-right-icon-gradient-"+$e[1]),te$4(De,"x1","96.2%"),te$4(De,"y1","50%"),te$4(De,"x2","0%"),te$4(De,"y2","50%"),te$4(Ke,"stop-color",$e[1]),te$4(Ke,"offset","0%"),te$4(Ye,"stop-color",$e[1]),te$4(Ye,"stop-opacity","0"),te$4(Ye,"offset","100%"),te$4(Xe,"id",or="arrow-right-icon-stroke-"+$e[1]),te$4(Xe,"x1","50%"),te$4(Xe,"y1","9.83%"),te$4(Xe,"x2","41.99%"),te$4(Xe,"y2","24.46%"),te$4(sr,"d","M4.84572153,2.14166669 C4.94036186,2.14170036 5.03490004,2.17870347 5.10676798,2.25203341 L9.39516942,6.66308361 C9.48635681,6.75687897 9.53195051,6.87843949 9.53195051,7 C9.53195051,7.12156051 9.48635681,7.24312103 9.39516942,7.33691639 L5.11673708,11.7390017 C5.02118573,11.813978 4.92122439,11.8514005 4.82705048,11.851434 C4.73517505,11.8514667 4.65029153,11.8150862 4.59276829,11.7576692 C4.51856427,11.6593496 4.48179951,11.5564146 4.48176638,11.4595899 C4.48173399,11.3649536 4.51747117,11.2773335 4.58937836,11.2035272 L7.74273899,7.43877755 C7.84906128,7.31184097 7.90222243,7.15592048 7.90222243,7 C7.90222243,6.84407952 7.84906128,6.68815903 7.74273449,6.56121708 L4.54804918,2.74803934 C4.65338339,2.20863952 4.74441906,2.14163065 4.84572153,2.14166669 Z"),te$4(sr,"fill",cr=`url(#arrow-right-icon-gradient-${$e[1]})`),te$4(sr,"fill-rule","nonzero"),te$4(sr,"stroke",Br=`url(#arrow-right-icon-stroke-${$e[1]})`),te$4(sr,"stroke-width",".2"),te$4(Se,"xmlns","http://www.w3.org/2000/svg"),te$4(Se,"viewBox","0 0 14 14"),te$4(Se,"width",$e[0]),te$4(Se,"height",$e[0]),ne$5(Se,"opacity",$e[2])},m(tn,en){Nt$1(tn,Se,en),pt$1(Se,Be),pt$1(Be,De),pt$1(De,Ve),pt$1(De,Fe),pt$1(Be,Xe),pt$1(Xe,Ke),pt$1(Xe,Ye),pt$1(Se,sr)},p(tn,[en]){en&2&&te$4(Ve,"stop-color",tn[1]),en&2&&te$4(Fe,"stop-color",tn[1]),en&2&&Je!==(Je="arrow-right-icon-gradient-"+tn[1])&&te$4(De,"id",Je),en&2&&te$4(Ke,"stop-color",tn[1]),en&2&&te$4(Ye,"stop-color",tn[1]),en&2&&or!==(or="arrow-right-icon-stroke-"+tn[1])&&te$4(Xe,"id",or),en&2&&cr!==(cr=`url(#arrow-right-icon-gradient-${tn[1]})`)&&te$4(sr,"fill",cr),en&2&&Br!==(Br=`url(#arrow-right-icon-stroke-${tn[1]})`)&&te$4(sr,"stroke",Br),en&1&&te$4(Se,"width",tn[0]),en&1&&te$4(Se,"height",tn[0]),en&4&&ne$5(Se,"opacity",tn[2])},i:N$f,o:N$f,d(tn){tn&&J$h(Se)}}}function A$6($e,Se,Be){let{size:De="14"}=Se,{color:Ve="#ffffff"}=Se,{opacity:Fe=1}=Se;return $e.$$set=Je=>{"size"in Je&&Be(0,De=Je.size),"color"in Je&&Be(1,Ve=Je.color),"opacity"in Je&&Be(2,Fe=Je.opacity)},[De,Ve,Fe]}let I$5=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,A$6,q$4,Ft$1,{size:0,color:1,opacity:2})}};function S$8($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br;return{c(){Se=Mt("svg"),Be=Mt("defs"),De=Mt("linearGradient"),Ve=Mt("stop"),Fe=Mt("stop"),Xe=Mt("linearGradient"),Ke=Mt("stop"),Ye=Mt("stop"),sr=Mt("path"),te$4(Ve,"stop-color",$e[1]),te$4(Ve,"offset","0%"),te$4(Fe,"stop-color",$e[1]),te$4(Fe,"stop-opacity",".5"),te$4(Fe,"offset","100%"),te$4(De,"id",Je="share-icon-gradient-"+$e[1]),te$4(De,"x1","41.65%"),te$4(De,"y1","59.05%"),te$4(De,"x2","66.13%"),te$4(De,"y2","9.07%"),te$4(Ke,"stop-color",$e[1]),te$4(Ke,"offset","0%"),te$4(Ye,"stop-color",$e[1]),te$4(Ye,"stop-opacity","0"),te$4(Ye,"offset","100%"),te$4(Xe,"id",or="share-icon-stroke-"+$e[1]),te$4(Xe,"x1","55.68%"),te$4(Xe,"y1","2.48%"),te$4(Xe,"x2","60.83%"),te$4(Xe,"y2","14.28%"),te$4(sr,"d","M12.4937515,2.60140991 L12.6834904,2.60248871 C13.307774,2.63121157 13.9222065,2.90874077 14.3642696,3.436433 C14.7794904,3.93278385 14.923342,4.60854408 14.8265514,5.24548738 C14.7279361,5.89144103 14.4428997,6.3527969 14.063774,6.65956953 C13.6079793,7.02837949 13.0189069,7.17403325 12.4632035,7.15562178 C11.7380729,7.13162078 11.0390809,7.42803145 10.5261758,7.9357119 C9.96083448,8.49643643 9.67596892,9.19792997 9.69443632,9.91942004 C9.66449732,10.8859455 9.96309104,11.5807243 10.4796578,12.092029 C11.0239965,12.6296813 11.7402488,12.9101676 12.4817091,12.8884813 C13.0940469,12.8705618 13.7481304,13.0495781 14.2150699,13.5117611 C14.6987029,13.9904677 14.9268415,14.6256711 14.8974895,15.2508921 C14.8684928,15.868544 14.5880857,16.4761837 14.055365,16.9134138 C13.5533941,17.3248246 12.8689122,17.4672624 12.2258037,17.3713572 C11.5727886,17.2736846 11.1063284,16.991503 10.7961882,16.6159844 C10.4239402,16.1652655 10.2768519,15.5827583 10.2954352,15.0332376 C10.3197006,14.3149783 10.0202124,13.6224897 9.50703789,13.1145427 C8.94671715,12.5587885 8.2455275,12.2800717 7.51547371,12.2927077 C7.23521908,12.3053648 6.95603622,12.2673623 6.69423123,12.1827116 C6.1605306,11.9588888 5.9529663,11.8380114 5.77703284,11.66387 C5.40155143,11.2922134 5.1829777,10.8272392 5.11950899,10.3459077 C5.05433663,9.85165608 5.15259721,9.34024891 5.41443015,8.89062791 C5.61688125,8.49864777 5.91421421,8.21950306 6.25529625,8.03627882 C6.64911257,7.8247265 7.1008248,7.74055154 7.53306889,7.75691992 L7.73219905,7.75624362 C8.39290266,7.7280909 9.01896921,7.44343917 9.49037385,6.97683639 C10.0339806,6.43762468 10.3173723,5.72806794 10.2954528,4.99382841 C10.2784266,4.38712951 10.4592448,3.74020534 10.9258673,3.27833603 C11.4093877,2.79921041 12.051472,2.57340998 12.6834904,2.60248871 Z"),te$4(sr,"fill",cr=`url(#share-icon-gradient-${$e[1]})`),te$4(sr,"fill-rule","nonzero"),te$4(sr,"stroke",Br=`url(#share-icon-stroke-${$e[1]})`),te$4(sr,"stroke-width",".2"),te$4(Se,"xmlns","http://www.w3.org/2000/svg"),te$4(Se,"viewBox","0 0 20 20"),te$4(Se,"width",$e[0]),te$4(Se,"height",$e[0]),ne$5(Se,"opacity",$e[2])},m(tn,en){Nt$1(tn,Se,en),pt$1(Se,Be),pt$1(Be,De),pt$1(De,Ve),pt$1(De,Fe),pt$1(Be,Xe),pt$1(Xe,Ke),pt$1(Xe,Ye),pt$1(Se,sr)},p(tn,[en]){en&2&&te$4(Ve,"stop-color",tn[1]),en&2&&te$4(Fe,"stop-color",tn[1]),en&2&&Je!==(Je="share-icon-gradient-"+tn[1])&&te$4(De,"id",Je),en&2&&te$4(Ke,"stop-color",tn[1]),en&2&&te$4(Ye,"stop-color",tn[1]),en&2&&or!==(or="share-icon-stroke-"+tn[1])&&te$4(Xe,"id",or),en&2&&cr!==(cr=`url(#share-icon-gradient-${tn[1]})`)&&te$4(sr,"fill",cr),en&2&&Br!==(Br=`url(#share-icon-stroke-${tn[1]})`)&&te$4(sr,"stroke",Br),en&1&&te$4(Se,"width",tn[0]),en&1&&te$4(Se,"height",tn[0]),en&4&&ne$5(Se,"opacity",tn[2])},i:N$f,o:N$f,d(tn){tn&&J$h(Se)}}}function q$3($e,Se,Be){let{size:De="20"}=Se,{color:Ve="#ffffff"}=Se,{opacity:Fe=1}=Se;return $e.$$set=Je=>{"size"in Je&&Be(0,De=Je.size),"color"in Je&&Be(1,Ve=Je.color),"opacity"in Je&&Be(2,Fe=Je.opacity)},[De,Ve,Fe]}let I$4=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,q$3,S$8,Ft$1,{size:0,color:1,opacity:2})}};function G$2($e){Qt$1($e,"svelte-18owx9v",".tag-popover-toolbar.svelte-18owx9v.svelte-18owx9v{display:flex;align-items:center;margin-top:0.75rem;padding-top:0;border-top:none}.tag-popover-toolbar.both-buttons.svelte-18owx9v.svelte-18owx9v{justify-content:space-between}.tag-popover-toolbar.single-button.svelte-18owx9v.svelte-18owx9v{justify-content:flex-end}.tag-popover-toolbar-dark.svelte-18owx9v .tag-popover-btn.svelte-18owx9v{color:#ffffff}.tag-popover-toolbar-light.svelte-18owx9v .tag-popover-btn.svelte-18owx9v{color:rgba(0, 0, 0, 0.85)}.tag-popover-btn.view-more.svelte-18owx9v.svelte-18owx9v{display:flex;align-items:center;justify-content:center;font-weight:500;font-size:0.875rem;letter-spacing:0;line-height:1.25rem}.tag-popover-btn.share.svelte-18owx9v.svelte-18owx9v{display:flex;align-items:center;justify-content:center;width:1.5rem;height:1.5rem}")}function M$8($e){let Se,Be,De,Ve,Fe=$e[0].showMore&&S$7($e),Je=$e[0].showShare&&T$5($e);return{c(){Se=K$g("div"),Fe&&Fe.c(),Be=Xt$2(),Je&&Je.c(),te$4(Se,"class",De="tag-popover-toolbar tag-popover-toolbar-"+$e[1]+" "+($e[0].showMore&&$e[0].showShare?"both-buttons":"single-button")+" svelte-18owx9v")},m(Xe,Ke){Nt$1(Xe,Se,Ke),Fe&&Fe.m(Se,null),pt$1(Se,Be),Je&&Je.m(Se,null),Ve=!0},p(Xe,Ke){Xe[0].showMore?Fe?(Fe.p(Xe,Ke),Ke&1&&ot$4(Fe,1)):(Fe=S$7(Xe),Fe.c(),ot$4(Fe,1),Fe.m(Se,Be)):Fe&&(Lt$1(),$t(Fe,1,1,()=>{Fe=null}),Ot$2()),Xe[0].showShare?Je?(Je.p(Xe,Ke),Ke&1&&ot$4(Je,1)):(Je=T$5(Xe),Je.c(),ot$4(Je,1),Je.m(Se,null)):Je&&(Lt$1(),$t(Je,1,1,()=>{Je=null}),Ot$2()),(!Ve||Ke&3&&De!==(De="tag-popover-toolbar tag-popover-toolbar-"+Xe[1]+" "+(Xe[0].showMore&&Xe[0].showShare?"both-buttons":"single-button")+" svelte-18owx9v"))&&te$4(Se,"class",De)},i(Xe){Ve||(ot$4(Fe),ot$4(Je),Ve=!0)},o(Xe){$t(Fe),$t(Je),Ve=!1},d(Xe){Xe&&J$h(Se),Fe&&Fe.d(),Je&&Je.d()}}}function S$7($e){let Se,Be,De,Ve,Fe,Je,Xe;return Ve=new I$5({props:{size:"14",color:$e[1]==="light"?"#000000":"#ffffff",opacity:$e[1]==="light"?.8:1}}),{c(){Se=K$g("div"),Be=gt$2($e[2]),De=Xt$2(),Ae$2(Ve.$$.fragment),te$4(Se,"class","tag-popover-btn view-more svelte-18owx9v")},m(Ke,Ye){Nt$1(Ke,Se,Ye),pt$1(Se,Be),pt$1(Se,De),Dt$1(Ve,Se,null),Fe=!0,Je||(Xe=lt$2(Se,"click",$e[3]),Je=!0)},p(Ke,Ye){(!Fe||Ye&4)&&ee$5(Be,Ke[2]);const or={};Ye&2&&(or.color=Ke[1]==="light"?"#000000":"#ffffff"),Ye&2&&(or.opacity=Ke[1]==="light"?.8:1),Ve.$set(or)},i(Ke){Fe||(ot$4(Ve.$$.fragment,Ke),Fe=!0)},o(Ke){$t(Ve.$$.fragment,Ke),Fe=!1},d(Ke){Ke&&J$h(Se),Rt(Ve),Je=!1,Xe()}}}function T$5($e){let Se,Be,De,Ve,Fe;return Be=new I$4({props:{size:"20",color:$e[1]==="light"?"#000000":"#ffffff",opacity:$e[1]==="light"?.8:1}}),{c(){Se=K$g("div"),Ae$2(Be.$$.fragment),te$4(Se,"class","tag-popover-btn share svelte-18owx9v")},m(Je,Xe){Nt$1(Je,Se,Xe),Dt$1(Be,Se,null),De=!0,Ve||(Fe=lt$2(Se,"click",$e[4]),Ve=!0)},p(Je,Xe){const Ke={};Xe&2&&(Ke.color=Je[1]==="light"?"#000000":"#ffffff"),Xe&2&&(Ke.opacity=Je[1]==="light"?.8:1),Be.$set(Ke)},i(Je){De||(ot$4(Be.$$.fragment,Je),De=!0)},o(Je){$t(Be.$$.fragment,Je),De=!1},d(Je){Je&&J$h(Se),Rt(Be),Ve=!1,Fe()}}}function H$7($e){let Se,Be,De=($e[0].showMore||$e[0].showShare)&&M$8($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[0].showMore||Ve[0].showShare?De?(De.p(Ve,Fe),Fe&1&&ot$4(De,1)):(De=M$8(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function J$2($e,Se,Be){let De;const Ve=de$4("hooks");fe$4();let{tag:Fe}=Se,{toolbar:Je={showMore:!0,showShare:!0}}=Se,{theme:Xe="dark"}=Se,{closePopover:Ke=void 0}=Se;function Ye(sr){sr.stopPropagation(),typeof Ke=="function"&&Ke(),Ve.emit("click",{event:sr,target:"TagPopoverViewMore",tag:Fe})}function or(sr){sr.stopPropagation(),typeof Ke=="function"&&Ke(),Ve.emit("click",{event:sr,target:"TagPopoverShare",tag:Fe})}return $e.$$set=sr=>{"tag"in sr&&Be(5,Fe=sr.tag),"toolbar"in sr&&Be(0,Je=sr.toolbar),"theme"in sr&&Be(1,Xe=sr.theme),"closePopover"in sr&&Be(6,Ke=sr.closePopover)},$e.$$.update=()=>{$e.$$.dirty&32&&Be(2,De=i$w(Fe.data.highlightText)&&Fe.data.highlightText.trim()!==""?Fe.data.highlightText:i$w(Fe.config.popoverConfig.viewMoreText)&&Fe.config.popoverConfig.viewMoreText.trim()!==""?Fe.config.popoverConfig.viewMoreText:"查看更多")},[Je,Xe,De,Ye,or,Fe,Ke]}let it$1=class extends Ce$1{constructor(Se){super(),Te$1(this,Se,J$2,H$7,Ft$1,{tag:5,toolbar:0,theme:1,closePopover:6},G$2)}};function k$4($e){let Se,Be;return Se=new it$1({props:{toolbar:{showMore:$e[7].showMore===void 0?!0:$e[7].showMore,showShare:$e[7].showShare===void 0?!0:$e[7].showShare},theme:$e[2],tag:$e[4],closePopover:$e[8]}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve&128&&(Fe.toolbar={showMore:De[7].showMore===void 0?!0:De[7].showMore,showShare:De[7].showShare===void 0?!0:De[7].showShare}),Ve&4&&(Fe.theme=De[2]),Ve&16&&(Fe.tag=De[4]),Ve&256&&(Fe.closePopover=De[8]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function E$9($e){let Se,Be,De,Ve;return Se=new q$6({props:{show:$e[0],direction:$e[1],theme:$e[2]}}),De=new Ae$1({props:{placement:$e[3],tag:$e[4],config:$e[5],theme:$e[6],audioInstance:$e[9],audioPlaying:$e[10],audioCurrentTime:$e[11],audioDuration:$e[12],$$slots:{toolbar:[k$4]},$$scope:{ctx:$e}}}),De.$on("resize",$e[13]),{c(){Ae$2(Se.$$.fragment),Be=Xt$2(),Ae$2(De.$$.fragment)},m(Fe,Je){Dt$1(Se,Fe,Je),Nt$1(Fe,Be,Je),Dt$1(De,Fe,Je),Ve=!0},p(Fe,[Je]){const Xe={};Je&1&&(Xe.show=Fe[0]),Je&2&&(Xe.direction=Fe[1]),Je&4&&(Xe.theme=Fe[2]),Se.$set(Xe);const Ke={};Je&8&&(Ke.placement=Fe[3]),Je&16&&(Ke.tag=Fe[4]),Je&32&&(Ke.config=Fe[5]),Je&64&&(Ke.theme=Fe[6]),Je&512&&(Ke.audioInstance=Fe[9]),Je&1024&&(Ke.audioPlaying=Fe[10]),Je&2048&&(Ke.audioCurrentTime=Fe[11]),Je&4096&&(Ke.audioDuration=Fe[12]),Je&16788&&(Ke.$$scope={dirty:Je,ctx:Fe}),De.$set(Ke)},i(Fe){Ve||(ot$4(Se.$$.fragment,Fe),ot$4(De.$$.fragment,Fe),Ve=!0)},o(Fe){$t(Se.$$.fragment,Fe),$t(De.$$.fragment,Fe),Ve=!1},d(Fe){Rt(Se,Fe),Fe&&J$h(Be),Rt(De,Fe)}}}function F$4($e,Se,Be){let{showArrow:De}=Se,{arrowDirection:Ve}=Se,{effectiveTheme:Fe}=Se,{adjustedPlacement:Je}=Se,{tag:Xe}=Se,{config:Ke}=Se,{theme:Ye}=Se,{toolbar:or}=Se,{closePopover:sr}=Se,{audioInstance:cr=null}=Se,{audioPlaying:Br=!1}=Se,{audioCurrentTime:tn=0}=Se,{audioDuration:en=0}=Se;function an(rn){he$2.call(this,$e,rn)}return $e.$$set=rn=>{"showArrow"in rn&&Be(0,De=rn.showArrow),"arrowDirection"in rn&&Be(1,Ve=rn.arrowDirection),"effectiveTheme"in rn&&Be(2,Fe=rn.effectiveTheme),"adjustedPlacement"in rn&&Be(3,Je=rn.adjustedPlacement),"tag"in rn&&Be(4,Xe=rn.tag),"config"in rn&&Be(5,Ke=rn.config),"theme"in rn&&Be(6,Ye=rn.theme),"toolbar"in rn&&Be(7,or=rn.toolbar),"closePopover"in rn&&Be(8,sr=rn.closePopover),"audioInstance"in rn&&Be(9,cr=rn.audioInstance),"audioPlaying"in rn&&Be(10,Br=rn.audioPlaying),"audioCurrentTime"in rn&&Be(11,tn=rn.audioCurrentTime),"audioDuration"in rn&&Be(12,en=rn.audioDuration)},[De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,tn,en,an]}class fe extends Ce$1{constructor(Se){super(),Te$1(this,Se,F$4,E$9,Ft$1,{showArrow:0,arrowDirection:1,effectiveTheme:2,adjustedPlacement:3,tag:4,config:5,theme:6,toolbar:7,closePopover:8,audioInstance:9,audioPlaying:10,audioCurrentTime:11,audioDuration:12})}}function Ht($e){Qt$1($e,"svelte-11cjg3j",'@charset "UTF-8";.tag-popover.svelte-11cjg3j{position:absolute;z-index:1000010;pointer-events:auto;width:auto;height:auto;padding:0;margin:0;visibility:visible;opacity:1}.tag-popover-content.svelte-11cjg3j{cursor:pointer;pointer-events:auto}.tag-popover-content.audio-tag-popover.svelte-11cjg3j{cursor:default}')}function it($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye;return De=new fe({props:{showArrow:$e[13],arrowDirection:$e[12],effectiveTheme:$e[18],adjustedPlacement:$e[8],tag:$e[0],config:$e[1],theme:$e[2],toolbar:$e[16],audioInstance:$e[4],audioPlaying:$e[5],audioCurrentTime:$e[6],audioDuration:$e[7],closePopover:$e[24]}}),De.$on("viewMore",$e[20]),De.$on("share",$e[21]),De.$on("resize",$e[22]),{c(){Se=K$g("div"),Be=K$g("div"),Ae$2(De.$$.fragment),te$4(Be,"class","tag-popover-content svelte-11cjg3j"),re$2(Be,"audio-tag-popover",$e[11]),te$4(Se,"class",Fe="tag-popover tag-popover-"+$e[18]+" tag-popover-"+$e[8]+" svelte-11cjg3j"),te$4(Se,"data-tag-id",Je=$e[0].id),ne$5(Se,"z-index",$e[17]),ne$5(Se,"left",$e[14].x+"px"),ne$5(Se,"top",$e[14].y+"px")},m(or,sr){Nt$1(or,Se,sr),pt$1(Se,Be),Dt$1(De,Be,null),$e[35](Be),$e[36](Se),Xe=!0,Ke||(Ye=[lt$2(Be,"mouseenter",$e[33]),lt$2(Be,"mouseleave",$e[34]),lt$2(Be,"click",$e[23])],Ke=!0)},p(or,sr){$e=or;const cr={};sr[0]&8192&&(cr.showArrow=$e[13]),sr[0]&4096&&(cr.arrowDirection=$e[12]),sr[0]&262144&&(cr.effectiveTheme=$e[18]),sr[0]&256&&(cr.adjustedPlacement=$e[8]),sr[0]&1&&(cr.tag=$e[0]),sr[0]&2&&(cr.config=$e[1]),sr[0]&4&&(cr.theme=$e[2]),sr[0]&65536&&(cr.toolbar=$e[16]),sr[0]&16&&(cr.audioInstance=$e[4]),sr[0]&32&&(cr.audioPlaying=$e[5]),sr[0]&64&&(cr.audioCurrentTime=$e[6]),sr[0]&128&&(cr.audioDuration=$e[7]),De.$set(cr),(!Xe||sr[0]&2048)&&re$2(Be,"audio-tag-popover",$e[11]),(!Xe||sr[0]&262400&&Fe!==(Fe="tag-popover tag-popover-"+$e[18]+" tag-popover-"+$e[8]+" svelte-11cjg3j"))&&te$4(Se,"class",Fe),(!Xe||sr[0]&1&&Je!==(Je=$e[0].id))&&te$4(Se,"data-tag-id",Je),(!Xe||sr[0]&131072)&&ne$5(Se,"z-index",$e[17]),(!Xe||sr[0]&16384)&&ne$5(Se,"left",$e[14].x+"px"),(!Xe||sr[0]&16384)&&ne$5(Se,"top",$e[14].y+"px")},i(or){Xe||(ot$4(De.$$.fragment,or),z$j(()=>{Xe&&(Ve||(Ve=ye$3(Be,$e[19],{duration:$e[15],easing:o$u,y:$e[12]==="top"?-8:$e[12]==="bottom"?8:0,x:$e[12]==="left"?-8:$e[12]==="right"?8:0},!0)),Ve.run(1))}),Xe=!0)},o(or){$t(De.$$.fragment,or),Ve||(Ve=ye$3(Be,$e[19],{duration:$e[15],easing:o$u,y:$e[12]==="top"?-8:$e[12]==="bottom"?8:0,x:$e[12]==="left"?-8:$e[12]==="right"?8:0},!1)),Ve.run(0),Xe=!1},d(or){or&&J$h(Se),Rt(De),$e[35](null),or&&Ve&&Ve.end(),$e[36](null),Ke=!1,M$o(Ye)}}}function Wt($e){let Se,Be,De=$e[3]&&$e[14]&&it($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,Fe){Ve[3]&&Ve[14]?De?(De.p(Ve,Fe),Fe[0]&16392&&ot$4(De,1)):(De=it(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function Ft($e,Se,Be){let De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr;const Br=de$4("hooks");let{tag:tn}=Se,{config:en={}}=Se,{triggerElement:an}=Se,{wrapperElement:rn=document.body}=Se,{popoverContainer:on=null}=Se,{theme:sn=void 0}=Se,{visible:ln=!0}=Se,{closePopover:cn=void 0}=Se,{audioInstance:hn=null}=Se,{audioPlaying:mn=!1}=Se,{audioCurrentTime:An=0}=Se,{audioDuration:xn=0}=Se;const pn=fe$4();let dn,fn={width:0,height:0},yn=null,Sn=Ve;function gn(Dn,{duration:zn=400,easing:Qn=o$u,x:Zn=0,y:si=0}){return{duration:zn,css:(ei,hi)=>`
          opacity: ${ei};
          transform: translate(${hi*Zn}px, ${hi*si}px);
        `}}const Cn=()=>{if(!tn.screenPosition||!an||!rn)return Ve;const Dn=en?.autoPlacementBaseSpace||{top:.2,bottom:.2,right:.15},zn=rn.clientWidth,Qn=rn.clientHeight,Zn=Qn*Dn.top,si=Qn*(1-Dn.bottom),ei=zn*(1-Dn.right),hi=tn.screenPosition.leftPx,Un=tn.screenPosition.topPx,Wn=fn.width||280,Ai=fn.height||200;return Un<=Zn?hi<=ei?hi+Wn<=zn&&Un+Ai<=Qn?"right-top":"bottom-left":hi-Wn>=0&&Un+Ai<=Qn?"left-top":"bottom-right":Un>=si?hi<=ei?hi+Wn<=zn&&Un-Ai>=0?"right-bottom":"top-left":hi-Wn>=0&&Un-Ai>=0?"left-bottom":"top-right":hi<=ei?hi+Wn<=zn?"right-top":"left-top":hi-Wn>=0?"left-top":"right-top"},Mn=(Dn,zn)=>{switch(Dn){case"top":case"top-left":case"top-right":return{x:zn.left+zn.width/2,y:zn.top};case"bottom":case"bottom-left":case"bottom-right":return{x:zn.left+zn.width/2,y:zn.top+zn.height};case"left":case"left-top":case"left-bottom":return{x:zn.left,y:zn.top+zn.height/2};case"right":case"right-top":case"right-bottom":return{x:zn.left+zn.width,y:zn.top+zn.height/2};default:return{x:zn.left+zn.width/2,y:zn.top}}},Bn=Dn=>{Rn(),Br&&Br.emit("click",{event:Dn.detail.event,target:"TagPopoverViewMore",tag:tn})},kn=Dn=>{Rn(),Br&&Br.emit("click",{event:Dn.detail.event,target:"TagPopoverShare",tag:tn})},Ln=Dn=>{Be(29,fn=Dn.detail),fn.width>0&&fn.height>0&&Be(8,Sn=Cn())},Pn=Dn=>{cr||Rn(),Dn.stopPropagation(),Br.emit("click",{event:Dn,target:"TagPopoverContent",tag:tn})};let Vn=null,Yn=!1;function ni(){on&&Vn&&Vn.parentNode!==on&&on.appendChild(Vn)}ce$2(()=>{(!rn||rn===document.body)&&console.warn("TagPopover 组件警告：禁止使用 document.body 作为 wrapperElement，请传入自定义容器元素。"),Yn=!0,ni(),rn&&rn!==document.body&&Be(25,rn.style.overflow="hidden",rn)}),ue$3(()=>{Yn&&ni()}),le$1(()=>{Vn&&Vn.parentNode&&Vn.parentNode.removeChild(Vn),rn&&rn!==document.body&&Be(25,rn.style.overflow="",rn)});function Rn(){typeof cn=="function"&&cn(),pn("close")}function In(Dn){he$2.call(this,$e,Dn)}function Gn(Dn){he$2.call(this,$e,Dn)}function Fn(Dn){ft$1[Dn?"unshift":"push"](()=>{dn=Dn,Be(9,dn)})}function Hn(Dn){ft$1[Dn?"unshift":"push"](()=>{Vn=Dn,Be(10,Vn)})}return $e.$$set=Dn=>{"tag"in Dn&&Be(0,tn=Dn.tag),"config"in Dn&&Be(1,en=Dn.config),"triggerElement"in Dn&&Be(26,an=Dn.triggerElement),"wrapperElement"in Dn&&Be(25,rn=Dn.wrapperElement),"popoverContainer"in Dn&&Be(27,on=Dn.popoverContainer),"theme"in Dn&&Be(2,sn=Dn.theme),"visible"in Dn&&Be(3,ln=Dn.visible),"closePopover"in Dn&&Be(28,cn=Dn.closePopover),"audioInstance"in Dn&&Be(4,hn=Dn.audioInstance),"audioPlaying"in Dn&&Be(5,mn=Dn.audioPlaying),"audioCurrentTime"in Dn&&Be(6,An=Dn.audioCurrentTime),"audioDuration"in Dn&&Be(7,xn=Dn.audioDuration)},$e.$$.update=()=>{if($e.$$.dirty[0]&5&&Be(18,De=i$w(sn)?sn:i$w(tn.data.theme)&&["light","dark"].includes(tn.data.theme)?tn.data.theme:tn.contentType==="Marketing"?"light":"dark"),$e.$$.dirty[0]&2&&Be(32,Ve=en?.placement||"right-top"),$e.$$.dirty[0]&2&&Be(16,Xe=typeof en?.toolbar=="boolean"?en.toolbar?{showMore:!0,showShare:!0}:{showMore:!1,showShare:!1}:en?.toolbar||{showMore:!0,showShare:!0}),$e.$$.dirty[1]&2&&(Ve==="auto"?Be(8,Sn=Cn()):Be(8,Sn=Ve)),$e.$$.dirty[0]&2&&Be(15,Ke=en?.transitionDuration||350),$e.$$.dirty[0]&67108865&&tn.screenPosition&&an&&Be(8,Sn=Cn()),$e.$$.dirty[0]&536870912&&fn.width>0&&fn.height>0&&Be(8,Sn=Cn()),$e.$$.dirty[0]&67109121&&tn.screenPosition&&Sn&&an){const Dn=an.getBoundingClientRect();Dn.width>0&&Dn.height>0&&Be(30,yn=Mn(Sn,Dn))}$e.$$.dirty[0]&1073741824&&Be(14,Ye=yn),$e.$$.dirty[1]&1&&Be(13,or=typeof Fe=="boolean"?Fe:!0),$e.$$.dirty[0]&256&&Be(12,sr=(()=>{switch(Sn){case"top":case"top-left":case"top-right":return"bottom";case"bottom":case"bottom-left":case"bottom-right":return"top";case"left":case"left-top":case"left-bottom":return"right";case"right":case"right-top":case"right-bottom":return"left";default:return"bottom"}})()),$e.$$.dirty[0]&1&&Be(11,cr=tn.contentType==="Audio"&&tn.data.appearance==="plane")},Be(31,Fe=!0),Be(17,Je=1060),[tn,en,sn,ln,hn,mn,An,xn,Sn,dn,Vn,cr,sr,or,Ye,Ke,Xe,Je,De,gn,Bn,kn,Ln,Pn,Rn,rn,an,on,cn,fn,yn,Fe,Ve,In,Gn,Fn,Hn]}class so extends Ce$1{constructor(Se){super(),Te$1(this,Se,Ft,Wt,Ft$1,{tag:0,config:1,triggerElement:26,wrapperElement:25,popoverContainer:27,theme:2,visible:3,closePopover:28,audioInstance:4,audioPlaying:5,audioCurrentTime:6,audioDuration:7},Ht,[-1,-1])}}function Le($e){Qt$1($e,"svelte-2g2g8a",".tag.svelte-2g2g8a{position:absolute;width:0rem;height:0rem;overflow:visible;pointer-events:auto;will-change:opacity;transition:opacity 0.2s linear}.tag.enableZIndex.svelte-2g2g8a{position:absolute}.tag.hide.svelte-2g2g8a{opacity:0;pointer-events:none}.tag.hide.svelte-2g2g8a *{pointer-events:none !important}.tag.unClickable.svelte-2g2g8a{pointer-events:none !important}.tag.unClickable.svelte-2g2g8a *{pointer-events:none !important}")}function re$1($e){let Se,Be,De,Ve,Fe,Je,Xe,Ke,Ye,or;const sr=[ze,Ue],cr=[];function Br(rn,on){return rn[10]?0:1}Be=Br($e),De=cr[Be]=sr[Be]($e);const tn=[Re,Ae],en=[];function an(rn,on){return rn[25]?0:1}return Fe=an($e),Je=en[Fe]=tn[Fe]($e),{c(){Se=K$g("div"),De.c(),Ve=Xt$2(),Je.c(),te$4(Se,"class","tag svelte-2g2g8a"),te$4(Se,"data-tag-id",$e[23]),te$4(Se,"data-tag-unfolded",$e[8]),te$4(Se,"data-content-type",Xe=$e[0].contentType),te$4(Se,"data-popover-enabled",Ke=$e[0].isPopoverConfigEnabled()),te$4(Se,"id",Ye=`tag-${$e[23]}`),re$2(Se,"unClickable",$e[0].config.clickable===!1),re$2(Se,"hide",$e[21]),re$2(Se,"enableZIndex",$e[18]),ne$5(Se,"z-index",$e[18]),ne$5(Se,"transform",`translate3d(${$e[20]}, ${$e[19]}, 0) scale(${$e[9].scale})`)},m(rn,on){Nt$1(rn,Se,on),cr[Be].m(Se,null),pt$1(Se,Ve),en[Fe].m(Se,null),$e[36](Se),or=!0},p(rn,on){let sn=Be;Be=Br(rn),Be===sn?cr[Be].p(rn,on):(Lt$1(),$t(cr[sn],1,1,()=>{cr[sn]=null}),Ot$2(),De=cr[Be],De?De.p(rn,on):(De=cr[Be]=sr[Be](rn),De.c()),ot$4(De,1),De.m(Se,Ve));let ln=Fe;Fe=an(rn),Fe===ln?en[Fe].p(rn,on):(Lt$1(),$t(en[ln],1,1,()=>{en[ln]=null}),Ot$2(),Je=en[Fe],Je?Je.p(rn,on):(Je=en[Fe]=tn[Fe](rn),Je.c()),ot$4(Je,1),Je.m(Se,null)),(!or||on[0]&8388608)&&te$4(Se,"data-tag-id",rn[23]),(!or||on[0]&256)&&te$4(Se,"data-tag-unfolded",rn[8]),(!or||on[0]&1&&Xe!==(Xe=rn[0].contentType))&&te$4(Se,"data-content-type",Xe),(!or||on[0]&1&&Ke!==(Ke=rn[0].isPopoverConfigEnabled()))&&te$4(Se,"data-popover-enabled",Ke),(!or||on[0]&8388608&&Ye!==(Ye=`tag-${rn[23]}`))&&te$4(Se,"id",Ye),(!or||on[0]&1)&&re$2(Se,"unClickable",rn[0].config.clickable===!1),(!or||on[0]&2097152)&&re$2(Se,"hide",rn[21]),(!or||on[0]&262144)&&re$2(Se,"enableZIndex",rn[18]),on[0]&262144&&ne$5(Se,"z-index",rn[18]),on[0]&1573376&&ne$5(Se,"transform",`translate3d(${rn[20]}, ${rn[19]}, 0) scale(${rn[9].scale})`)},i(rn){or||(ot$4(De),ot$4(Je),or=!0)},o(rn){$t(De),$t(Je),or=!1},d(rn){rn&&J$h(Se),cr[Be].d(),en[Fe].d(),$e[36](null)}}}function Ue($e){let Se;return{c(){Se=K$g("div"),te$4(Se,"data-info","tag point is disable")},m(Be,De){Nt$1(Be,Se,De)},p:N$f,i:N$f,o:N$f,d(Be){Be&&J$h(Se)}}}function ze($e){let Se,Be,De;function Ve(Je){$e[34](Je)}let Fe={tag:$e[0],handleMouseEnter:$e[30],handleMouseLeave:$e[31],handleTagPointClick:$e[32]};return $e[12]!==void 0&&(Fe.tagPointClickHelper=$e[12]),Se=new oo({props:Fe}),ft$1.push(()=>Me$1(Se,"tagPointClickHelper",Ve)),$e[35](Se),Se.$on("audioInstanceReady",$e[27].audioInstanceReady),Se.$on("audioPlay",$e[27].audioPlay),Se.$on("audioPause",$e[27].audioPause),Se.$on("audioTimeUpdate",$e[27].audioTimeUpdate),Se.$on("audioDuration",$e[27].audioDuration),{c(){Ae$2(Se.$$.fragment)},m(Je,Xe){Dt$1(Se,Je,Xe),De=!0},p(Je,Xe){const Ke={};Xe[0]&1&&(Ke.tag=Je[0]),!Be&&Xe[0]&4096&&(Be=!0,Ke.tagPointClickHelper=Je[12],pe$3(()=>Be=!1)),Se.$set(Ke)},i(Je){De||(ot$4(Se.$$.fragment,Je),De=!0)},o(Je){$t(Se.$$.fragment,Je),De=!1},d(Je){$e[35](null),Rt(Se,Je)}}}function Ae($e){let Se;return{c(){Se=K$g("div"),te$4(Se,"data-info","tag content is disable")},m(Be,De){Nt$1(Be,Se,De)},p:N$f,i:N$f,o:N$f,d(Be){Be&&J$h(Se)}}}function Re($e){let Se,Be;return Se=new Fi({props:{mediaStore:$e[1],tag:e$5($e[0]),hooks:$e[26],state:$e[4],temporaryState:$e[5],rendererMap:$e[2],contentTypeMap:$e[3]}}),{c(){Ae$2(Se.$$.fragment)},m(De,Ve){Dt$1(Se,De,Ve),Be=!0},p(De,Ve){const Fe={};Ve[0]&2&&(Fe.mediaStore=De[1]),Ve[0]&1&&(Fe.tag=e$5(De[0])),Ve[0]&16&&(Fe.state=De[4]),Ve[0]&32&&(Fe.temporaryState=De[5]),Ve[0]&4&&(Fe.rendererMap=De[2]),Ve[0]&8&&(Fe.contentTypeMap=De[3]),Se.$set(Fe)},i(De){Be||(ot$4(Se.$$.fragment,De),Be=!0)},o(De){$t(Se.$$.fragment,De),Be=!1},d(De){Rt(Se,De)}}}function ne$2($e){var Se;let Be,De;return Be=new so({props:{tag:$e[0],config:$e[0].config.popoverConfig,theme:(Se=$e[0].config.popoverConfig)==null?void 0:Se.theme,wrapperElement:$e[6],triggerElement:$e[12],popoverContainer:$e[7],visible:!0,closePopover:$e[33],audioInstance:$e[14],audioPlaying:$e[15],audioCurrentTime:$e[16],audioDuration:$e[17]}}),Be.$on("mouseenter",$e[28]),Be.$on("mouseleave",$e[29]),Be.$on("close",$e[33]),{c(){Ae$2(Be.$$.fragment)},m(Ve,Fe){Dt$1(Be,Ve,Fe),De=!0},p(Ve,Fe){var Je;const Xe={};Fe[0]&1&&(Xe.tag=Ve[0]),Fe[0]&1&&(Xe.config=Ve[0].config.popoverConfig),Fe[0]&1&&(Xe.theme=(Je=Ve[0].config.popoverConfig)==null?void 0:Je.theme),Fe[0]&64&&(Xe.wrapperElement=Ve[6]),Fe[0]&4096&&(Xe.triggerElement=Ve[12]),Fe[0]&128&&(Xe.popoverContainer=Ve[7]),Fe[0]&16384&&(Xe.audioInstance=Ve[14]),Fe[0]&32768&&(Xe.audioPlaying=Ve[15]),Fe[0]&65536&&(Xe.audioCurrentTime=Ve[16]),Fe[0]&131072&&(Xe.audioDuration=Ve[17]),Be.$set(Xe)},i(Ve){De||(ot$4(Be.$$.fragment,Ve),De=!0)},o(Ve){$t(Be.$$.fragment,Ve),De=!1},d(Ve){Rt(Be,Ve)}}}function Ze($e){var Se;let Be,De=$e[0].isPopoverConfigEnabled()&&$e[24]&&($e[11]||((Se=$e[0].config.popoverConfig)==null?void 0:Se.debug)),Ve,Fe,Je=$e[9]&&(!$e[22]||$e[11])&&re$1($e),Xe=De&&ne$2($e);return{c(){Je&&Je.c(),Be=Xt$2(),Xe&&Xe.c(),Ve=Yt$1()},m(Ke,Ye){Je&&Je.m(Ke,Ye),Nt$1(Ke,Be,Ye),Xe&&Xe.m(Ke,Ye),Nt$1(Ke,Ve,Ye),Fe=!0},p(Ke,Ye){var or;Ke[9]&&(!Ke[22]||Ke[11])?Je?(Je.p(Ke,Ye),Ye[0]&4196864&&ot$4(Je,1)):(Je=re$1(Ke),Je.c(),ot$4(Je,1),Je.m(Be.parentNode,Be)):Je&&(Lt$1(),$t(Je,1,1,()=>{Je=null}),Ot$2()),Ye[0]&16779265&&(De=Ke[0].isPopoverConfigEnabled()&&Ke[24]&&(Ke[11]||((or=Ke[0].config.popoverConfig)==null?void 0:or.debug))),De?Xe?(Xe.p(Ke,Ye),Ye[0]&16779265&&ot$4(Xe,1)):(Xe=ne$2(Ke),Xe.c(),ot$4(Xe,1),Xe.m(Ve.parentNode,Ve)):Xe&&(Lt$1(),$t(Xe,1,1,()=>{Xe=null}),Ot$2())},i(Ke){Fe||(ot$4(Je),ot$4(Xe),Fe=!0)},o(Ke){$t(Je),$t(Xe),Fe=!1},d(Ke){Je&&Je.d(Ke),Ke&&J$h(Be),Xe&&Xe.d(Ke),Ke&&J$h(Ve)}}}function Ne($e,Se,Be){let De,Ve,Fe,Je,Xe,Ke,Ye,or,sr,cr,Br,{tag:tn}=Se,{mediaStore:en}=Se,{rendererMap:an=new Map}=Se,{contentTypeMap:rn=new Map}=Se,{state:on}=Se,{temporaryState:sn}=Se,{wrapperElement:ln=null}=Se,{popoverContainer:cn=null}=Se;const hn=de$4("hooks");let mn=!1,An,xn,pn=null,dn=!1,fn=!1,yn=null,Sn=null,gn=!1,Cn=0,Mn=0;const Bn={audioInstanceReady:Dn=>{Be(14,Sn=Dn.detail),Be(15,gn=!Sn.paused)},audioPlay:()=>{Be(15,gn=!0)},audioPause:()=>{Be(15,gn=!1)},audioTimeUpdate:Dn=>{Be(16,Cn=Dn.detail)},audioDuration:Dn=>{Be(17,Mn=Dn.detail)}};let kn=!1;const Ln=Dn=>{if(xn&&clearTimeout(xn),Dn===!0&&!kn){kn=!0,Be(11,mn=!0);return}xn=setTimeout(()=>{var zn;!dn&&!fn&&!((zn=tn.config.popoverConfig)!=null&&zn.debug)&&(kn=!1,Be(11,mn=!1))},300)},Pn=()=>{dn=!0,xn&&clearTimeout(xn)},Vn=()=>{dn=!1,Ln(!1)},Yn=Dn=>{var zn,Qn,Zn,si,ei,hi;if(fn=!0,tn.isPopoverConfigEnabled()&&tn.isHoverEnabled()&&((Qn=(zn=tn.currentConfig)==null?void 0:zn.popoverConfig)==null?void 0:Qn.trigger)==="hover"){if(xn&&clearTimeout(xn),An!==void 0)return;((si=(Zn=tn.currentConfig)==null?void 0:Zn.popoverConfig)==null?void 0:si.triggerDelay)>0?An=setTimeout(()=>{Ln(!0),tn.hooks.emit("hover",{event:Dn,tag:tn}),An=void 0},(hi=(ei=tn.currentConfig)==null?void 0:ei.popoverConfig)==null?void 0:hi.triggerDelay):(Ln(!0),tn.hooks.emit("hover",{event:Dn,tag:tn}))}},ni=Dn=>{var zn,Qn;fn=!1,tn.isHoverEnabled()&&tn.isPopoverConfigEnabled()&&((Qn=(zn=tn.currentConfig)==null?void 0:zn.popoverConfig)==null?void 0:Qn.trigger)==="hover"&&(An!==void 0&&(clearTimeout(An),An=void 0),Ln(!1))},Rn=Dn=>{var zn,Qn;const Zn=tn.contentType==="Audio"&&tn.data.appearance==="plane";tn.isPopoverConfigEnabled()&&tn.isHoverEnabled()&&((Qn=(zn=tn.currentConfig)==null?void 0:zn.popoverConfig)==null?void 0:Qn.trigger)==="click"&&(Zn?mn||(Be(11,mn=!0),tn.hooks.emit("hover",{event:Dn,tag:tn})):(Be(11,mn=!mn),mn&&tn.hooks.emit("hover",{event:Dn,tag:tn})))};function In(){kn=!1,Be(11,mn=!1)}ce$2(()=>()=>{An&&clearTimeout(An),xn&&clearTimeout(xn)});function Gn(Dn){pn=Dn,Be(12,pn)}function Fn(Dn){ft$1[Dn?"unshift":"push"](()=>{yn=Dn,Be(13,yn)})}function Hn(Dn){ft$1[Dn?"unshift":"push"](()=>{tn.dom=Dn,Be(0,tn)})}return $e.$$set=Dn=>{"tag"in Dn&&Be(0,tn=Dn.tag),"mediaStore"in Dn&&Be(1,en=Dn.mediaStore),"rendererMap"in Dn&&Be(2,an=Dn.rendererMap),"contentTypeMap"in Dn&&Be(3,rn=Dn.contentTypeMap),"state"in Dn&&Be(4,on=Dn.state),"temporaryState"in Dn&&Be(5,sn=Dn.temporaryState),"wrapperElement"in Dn&&Be(6,ln=Dn.wrapperElement),"popoverContainer"in Dn&&Be(7,cn=Dn.popoverContainer)},$e.$$.update=()=>{var Dn,zn,Qn,Zn;$e.$$.dirty[0]&5&&Be(10,De=(()=>{var si,ei,hi;return((ei=(si=tn.style)==null?void 0:si.point)==null?void 0:ei.enabled)===!1||((hi=an.get(tn.contentType))==null?void 0:hi.usePoint)===!1||tn.contentType==="Sticker"||tn.contentType==="Link"||tn.contentType==="VRLink"||tn.contentType==="PanoLink"?!1:tn.contentType==="Panorama"?!0:tn.contentType==="Audio"&&tn.data.appearance==="plane"?tn.isPopoverConfigEnabled():!0})()),$e.$$.dirty[0]&1025&&Be(25,Ve=!(tn.isPopoverConfigEnabled()&&tn.contentType==="Panorama"||tn.isPopoverConfigEnabled()&&tn.contentType==="ImageText"||tn.isPopoverConfigEnabled()&&tn.contentType==="Text"||tn.isPopoverConfigEnabled()&&tn.contentType==="Audio"||tn.stickType!=="2DPoint"||tn.entryFromModel&&o$q(tn.five.state.mode)&&De)),$e.$$.dirty[0]&1&&Be(24,Fe=(()=>{var si;return tn.contentType==="Marketing"?!!(tn.data.title||tn.data.name||tn.data.description||tn.data.tooltip||(si=tn.data.price)!=null&&si.value||tn.data.brandTags&&tn.data.brandTags.length>0||tn.data.tags&&tn.data.tags.length>0||tn.data.imageUrl||tn.data.mediaUrl||tn.data.mediaData&&tn.data.mediaData.length>0):!!(tn.data.title||tn.data.name||tn.data.text||tn.data.description||tn.data.tooltip||tn.data.imageUrl||tn.data.mediaUrl||tn.data.mediaData&&tn.data.mediaData.length>0)})()),$e.$$.dirty[0]&1&&Be(23,Je=tn.id),$e.$$.dirty[0]&1&&Be(9,Xe=tn.screenPosition),$e.$$.dirty[0]&1&&Be(22,Ke=tn.enabled===!1||!tn.state),$e.$$.dirty[0]&513&&Be(21,Ye=!((Dn=tn.state)!=null&&Dn.visible)||((zn=tn.temporaryState)==null?void 0:zn.visible)===!1||!Xe),$e.$$.dirty[0]&1&&Be(8,or=((Qn=tn.state)==null?void 0:Qn.unfolded)&&!tn.isPopoverConfigEnabled()),$e.$$.dirty[0]&512&&Be(20,sr=Xe?.leftPx+"px"),$e.$$.dirty[0]&512&&Be(19,cr=Xe?.topPx+"px"),$e.$$.dirty[0]&257&&Be(18,Br=or?((Zn=tn.zIndex)!=null?Zn:0)+(or?1e6:0):void 0)},[tn,en,an,rn,on,sn,ln,cn,or,Xe,De,mn,pn,yn,Sn,gn,Cn,Mn,Br,cr,sr,Ye,Ke,Je,Fe,Ve,hn,Bn,Pn,Vn,Yn,ni,Rn,In,Gn,Fn,Hn]}class fr extends Ce$1{constructor(Se){super(),Te$1(this,Se,Ne,Ze,Ft$1,{tag:0,mediaStore:1,rendererMap:2,contentTypeMap:3,state:4,temporaryState:5,wrapperElement:6,popoverContainer:7},Le,[-1,-1])}}let e$4=null;function n$d($e=2e6){return e$4&&document.body.contains(e$4)?(e$4.style.zIndex=String($e),e$4):(e$4=document.createElement("div"),e$4.className="tag-popover-container",Object.assign(e$4.style,{position:"absolute",left:"0",top:"0",width:"100%",height:"100%",zIndex:String($e),pointerEvents:"none",overflow:"hidden"}),document.body.appendChild(e$4),e$4)}function X$2($e){Qt$1($e,"svelte-9ehqs9",".tag--container.svelte-9ehqs9{box-sizing:border-box;position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;opacity:1;-webkit-user-select:none;-moz-user-select:none;user-select:none;transform:translate3d(0, 0, 0);transition:opacity 0.2s linear;overflow:hidden}.tag--container.hide.svelte-9ehqs9{opacity:0 !important;pointer-events:none}.tag--container.hide.svelte-9ehqs9 *{pointer-events:none !important}")}function w$a($e,Se,Be){const De=$e.slice();return De[12]=Se[Be],De}function T$4($e){let Se,Be=[],De=new Map,Ve,Fe,Je,Xe=$e[0];const Ke=Ye=>Ye[12].id;for(let Ye=0;Ye<Xe.length;Ye+=1){let or=w$a($e,Xe,Ye),sr=Ke(or);De.set(sr,Be[Ye]=I$3(sr,or))}return{c(){var Ye;Se=K$g("div");for(let or=0;or<Be.length;or+=1)Be[or].c();te$4(Se,"class","tag--container svelte-9ehqs9"),te$4(Se,"data-infive",Ve=!$e[4].visible||!$e[5].visible?"1":"0"),re$2(Se,"hide",!$e[4].visible||!$e[5].visible),ne$5(Se,"z-index",(Ye=$e[6])!=null?Ye:"")},m(Ye,or){Nt$1(Ye,Se,or);for(let sr=0;sr<Be.length;sr+=1)Be[sr]&&Be[sr].m(Se,null);$e[10](Se),Je=!0},p(Ye,or){var sr;or&447&&(Xe=Ye[0],Lt$1(),Be=Ee$2(Be,or,Ke,1,Ye,Xe,De,Se,xe,I$3,null,w$a),Ot$2()),(!Je||or&48&&Ve!==(Ve=!Ye[4].visible||!Ye[5].visible?"1":"0"))&&te$4(Se,"data-infive",Ve),(!Je||or&48)&&re$2(Se,"hide",!Ye[4].visible||!Ye[5].visible),or&64&&ne$5(Se,"z-index",(sr=Ye[6])!=null?sr:"")},i(Ye){if(!Je){for(let or=0;or<Xe.length;or+=1)ot$4(Be[or]);Fe||z$j(()=>{Fe=me$2(Se,C$i,{}),Fe.start()}),Je=!0}},o(Ye){for(let or=0;or<Be.length;or+=1)$t(Be[or]);Je=!1},d(Ye){Ye&&J$h(Se);for(let or=0;or<Be.length;or+=1)Be[or].d();$e[10](null)}}}function I$3($e,Se){let Be,De,Ve;return De=new fr({props:{state:Se[4],temporaryState:Se[5],tag:Se[12],mediaStore:Se[1],rendererMap:Se[2],contentTypeMap:Se[3],wrapperElement:Se[7],popoverContainer:Se[8]}}),{key:$e,first:null,c(){Be=Yt$1(),Ae$2(De.$$.fragment),this.first=Be},m(Fe,Je){Nt$1(Fe,Be,Je),Dt$1(De,Fe,Je),Ve=!0},p(Fe,Je){Se=Fe;const Xe={};Je&16&&(Xe.state=Se[4]),Je&32&&(Xe.temporaryState=Se[5]),Je&1&&(Xe.tag=Se[12]),Je&2&&(Xe.mediaStore=Se[1]),Je&4&&(Xe.rendererMap=Se[2]),Je&8&&(Xe.contentTypeMap=Se[3]),Je&128&&(Xe.wrapperElement=Se[7]),Je&256&&(Xe.popoverContainer=Se[8]),De.$set(Xe)},i(Fe){Ve||(ot$4(De.$$.fragment,Fe),Ve=!0)},o(Fe){$t(De.$$.fragment,Fe),Ve=!1},d(Fe){Fe&&J$h(Be),Rt(De,Fe)}}}function Y$1($e){let Se,Be,De=$e[4].enabled&&T$4($e);return{c(){De&&De.c(),Se=Yt$1()},m(Ve,Fe){De&&De.m(Ve,Fe),Nt$1(Ve,Se,Fe),Be=!0},p(Ve,[Fe]){Ve[4].enabled?De?(De.p(Ve,Fe),Fe&16&&ot$4(De,1)):(De=T$4(Ve),De.c(),ot$4(De,1),De.m(Se.parentNode,Se)):De&&(Lt$1(),$t(De,1,1,()=>{De=null}),Ot$2())},i(Ve){Be||(ot$4(De),Be=!0)},o(Ve){$t(De),Be=!1},d(Ve){De&&De.d(Ve),Ve&&J$h(Se)}}}function x$b($e,Se,Be){let{tags:De=[]}=Se,{hooks:Ve}=Se,{mediaStore:Fe}=Se,{rendererMap:Je}=Se,{contentTypeMap:Xe}=Se,{state:Ke}=Se,{temporaryState:Ye}=Se,{zIndex:or=void 0}=Se,sr=null,cr=null,Br=2e3;ae$2("hooks",Ve),ae$2("mediaStore",Fe),ce$2(()=>{Be(8,cr=n$d(Br))});function tn(en){ft$1[en?"unshift":"push"](()=>{sr=en,Be(7,sr)})}return $e.$$set=en=>{"tags"in en&&Be(0,De=en.tags),"hooks"in en&&Be(9,Ve=en.hooks),"mediaStore"in en&&Be(1,Fe=en.mediaStore),"rendererMap"in en&&Be(2,Je=en.rendererMap),"contentTypeMap"in en&&Be(3,Xe=en.contentTypeMap),"state"in en&&Be(4,Ke=en.state),"temporaryState"in en&&Be(5,Ye=en.temporaryState),"zIndex"in en&&Be(6,or=en.zIndex)},$e.$$.update=()=>{var en,an,rn,on;$e.$$.dirty&1&&De&&De.length>0&&(Br=(on=(rn=(an=(en=De[0])==null?void 0:en.config)==null?void 0:an.popoverConfig)==null?void 0:rn.zIndex)!=null?on:2e6)},[De,Fe,Je,Xe,Ke,Ye,or,sr,cr,Ve,tn]}class wr extends Ce$1{constructor(Se){super(),Te$1(this,Se,x$b,Y$1,Ft$1,{tags:0,hooks:9,mediaStore:1,rendererMap:2,contentTypeMap:3,state:4,temporaryState:5,zIndex:6},X$2)}}var P$6=Object.defineProperty,E$8=Object.defineProperties,U$3=Object.getOwnPropertyDescriptors,v$b=Object.getOwnPropertySymbols,A$5=Object.prototype.hasOwnProperty,k$3=Object.prototype.propertyIsEnumerable,g$e=($e,Se,Be)=>Se in $e?P$6($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,f$m=($e,Se)=>{for(var Be in Se||(Se={}))A$5.call(Se,Be)&&g$e($e,Be,Se[Be]);if(v$b)for(var Be of v$b(Se))k$3.call(Se,Be)&&g$e($e,Be,Se[Be]);return $e},c$i=($e,Se)=>E$8($e,U$3(Se)),p$m=($e,Se,Be)=>(g$e($e,typeof Se!="symbol"?Se+"":Se,Be),Be),l$d=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const S$6="Dnalogel-PanoTagPlugin";class No extends Xt$1{constructor(Se,Be){super(Se),p$m(this,"state",{enabled:!0,visible:!0}),p$m(this,"debug"),p$m(this,"debugUtil",new h$j(this)),p$m(this,"globalHoverEnabled",!0),p$m(this,"changeTagModel",(De,Ve)=>l$d(this,null,function*(){var Fe;De.data=a$q({},De.data,Ve),yield(Fe=De.loadModel)==null?void 0:Fe.call(De)})),p$m(this,"handleFiveModeChange",De=>{const Ve=()=>{this.filter2DPointTag.forEach(Fe=>{Fe.state.visible=!1,Fe.applyVisible()}),this.five.ready().then(()=>{this.tagsDo(this.tags,Fe=>{Fe.updateVisible(),o$o(Fe)&&De!=="Panorama"&&this.changeTagMode(Fe,"behind")})})};this.tags.length<500?Ve():this.five.ready().then(()=>Ve())}),p$m(this,"handleFiveWantsMoveToPano",De=>{if(this.tags.length>500){this.temporaryState.visible=!1,this.addRenderQueue({type:"TagContainerSvelte",keys:["temporaryState"]});return}else this.temporaryState.visible=!0,this.tags.forEach(Ve=>{Ve.temporaryState.visible=!0}),this.addRenderQueue({type:"TagContainerSvelte",keys:["tags"]}),this.tags.forEach(Ve=>Ve.applyVisible())}),p$m(this,"clickhandler",De=>{De.tag.onClick(De)}),p$m(this,"handleFiveCameraUpdate",()=>{this.filterPointTag.forEach(De=>De.updateScreenPosition())}),p$m(this,"handleFiveCameraFovUpdate",()=>{this.handleFiveCameraUpdate(),this.five.off("render.prepare",this.handleFiveCameraUpdate),this.five.on("render.prepare",this.handleFiveCameraUpdate),setTimeout(()=>{this.five.off("render.prepare",this.handleFiveCameraUpdate)},1e3)}),p$m(this,"handleFivePanoArrived",()=>l$d(this,null,function*(){this.filter2DPointTag.forEach(De=>{De.state.visible=!1,De.applyVisible()}),this.tagsDo(this.tags,De=>{De.updateVisible()}),this.temporaryState.visible=!0,this.addRenderQueue({type:"TagContainerSvelte",keys:["temporaryState"]}),yield this.setUnfolded(),this.tags.filter(c$s).filter(De=>{var Ve;return(Ve=De.getConfig().modelConfig)==null?void 0:Ve.autoLookAtEnabled}).forEach(De=>{var Ve;const Fe=new Mesh(new BoxGeometry,new MeshBasicMaterial),Je=(Ve=De.model)==null?void 0:Ve.object;if(!Je)return;Fe.position.copy(Je.position),Fe.quaternion.copy(Je.quaternion);const Xe=this.five.camera.position;Fe.lookAt(Xe.clone().setY(Fe.position.y));const Ke=Je.quaternion.clone(),Ye=Fe.quaternion.clone(),or=F$f();or.onUpdate(({progress:sr})=>{Je.quaternion.copy(Ke.clone().slerp(Ye,sr))}),or.play()})})),p$m(this,"handleFiveModelShownFloorChange",()=>{this.tagsDo(this.tags,De=>De.updateVisible())}),p$m(this,"onFiveRefined",i$i(()=>{o$q(this.five.getCurrentState().mode)?this.setUnfoldedByCamera():this.tags.forEach(De=>De.cache.clear()),this.tagsDo(this.tags,De=>De.updateVisible())})),p$m(this,"onFiveEveryReady",()=>{this.setUnfoldedByCamera(),o$q(this.five.getCurrentState().mode)&&this.tagsDo(this.tags,De=>De.updateVisible())}),p$m(this,"render",()=>{this.renderQueue.forEach((De,Ve)=>{const{keys:Fe}=De;if(Ve==="TagContainerSvelte"){const Je=this.filterPointTag.filter(Ke=>Ke.screenPosition),Xe={hooks:this.hooks,tags:Je,state:this.state,temporaryState:this.temporaryState,mediaStore:this.mediaStore,rendererMap:this.rendererMap,contentTypeMap:this.contentTypeMap,zIndex:this.params.containerZIndex};if(this.TagContainerSvelte){let Ke={};if(Fe.length===0)Ke=Xe;else for(const Ye of Fe)Ke[Ye]=Xe[Ye];this.TagContainerSvelte.$set(Ke)}else{if(!this.container)return console.error("updateRenderPlaneTag: tag2DContainer not found");this.TagContainerSvelte=new wr({target:this.container,props:c$i(f$m({},Xe),{state:c$i(f$m({},this.state),{enabled:!1})})}),T$f(()=>{var Ke;(Ke=this.TagContainerSvelte)==null||Ke.$set({state:this.state})})}}}),this.renderQueue.clear()}),this.params=a$q({},{debug:!1,config:this.config},f$m({},Be)),this.debug=this.params.debug,this.config=this.params.config,this.debug&&this.debugUtil.bindLog(),a$j(1,{namespace:d$q.PlayAudio});try{Array.isArray(window.__PANOTAGPLUGIN_DEBUG_LIST__)||(window.__PANOTAGPLUGIN_DEBUG_LIST__=[]),this.NAME=S$6+"-"+window.__PANOTAGPLUGIN_DEBUG_LIST__.length,window.__PANOTAGPLUGIN_DEBUG_LIST__.push(this),window.__PANOTAGPLUGIN_DEBUG__||Object.defineProperty(window,"__PANOTAGPLUGIN_DEBUG__",{get:function(){return window.__PANOTAGPLUGIN_DEBUG_LIST__.sort((De,Ve)=>Ve.tags.length-De.tags.length)[0]}})}catch{}}appendTo(Se){var Be,De,Ve;this.container=Se;const Fe=(De=(Be=this.TagContainerSvelte)==null?void 0:Be.$$)==null?void 0:De.root;Fe&&Fe!==this.container&&((Ve=this.TagContainerSvelte)==null||Ve.$destroy(),this.TagContainerSvelte=void 0)}load(Se){return l$d(this,null,function*(){var Be,De;this.clearTags();try{console.debug(this.NAME," load:",{data:JSON.parse(JSON.stringify(Se))})}catch{}this.config=a$q({},this.config,{globalConfig:(Be=Se.globalConfig)!=null?Be:{},contentTypeConfig:(De=Se.contentTypeConfig)!=null?De:{}});const Ve=yield this.addTag(Se.tagList);return this.hooks.emit("loaded"),Ve})}addTag(Se){return l$d(this,null,function*(){const Be=(Array.isArray(Se)?Se:[Se]).filter(De=>De.position).map(De=>{const Ve=o$n(De);if(Ve==="2DPoint"||Ve==="3DPoint")return new Jt$1(this,De);if(Ve==="Model")return new Qo(this,De);if(Ve==="Plane")return new Qi(this,De)});return Be.forEach(p$s),this.tags.push(...Be),this.tagsLengthWillUpdate=!0,M$u(this.five).then(()=>l$d(this,null,function*(){var De,Ve;this.store.eventListenerDisposer&&((Ve=(De=this.store).eventListenerDisposer)==null||Ve.call(De)),this.state.enabled&&this.handleEnable(),this.addResizeListener(),this.clearUnusedPanelTag(),this.tagsDo(Be,Fe=>{this.tags.includes(Fe)&&(Fe.updateVisible(),Fe.updateZIndex())}),this.setUnfolded(),this.addRenderQueue({type:"TagContainerSvelte"}),this.hooks.emit("tagsLengthChange")}))})}changeConfig(Se,Be=!0){Be?this.config=a$q({},this.config,Se):this.config=Se,this.tags.forEach(De=>{De.updateConfig()}),this.tagsDo(this.tags,De=>De.updateVisible())}changeGlobalConfig(Se,Be=!0){Be?this.config.globalConfig=a$q({},this.config.globalConfig,Se):this.config.globalConfig=Se,this.tags.forEach(De=>{De.updateConfig()}),this.tagsDo(this.tags,De=>{De.updateVisible()})}changeContentTypeConfig(Se,Be,De=!0){this.config.contentTypeConfig||(this.config.contentTypeConfig={}),De?this.config.contentTypeConfig[Se]=a$q({},this.config.contentTypeConfig[Se],Be):this.config.contentTypeConfig[Se]=Be,this.tags.forEach(Ve=>{Ve.updateConfig()}),this.tagsDo(this.tags,Ve=>{Ve.updateVisible()})}show(Se){return l$d(this,null,function*(){if(this.checkDisposed())return;const{userAction:Be=!0}=Se??{};this.setState({visible:!0},{userAction:Be}),this.hooks.emit("show",{userAction:Be})})}hide(Se){return l$d(this,null,function*(){if(this.checkDisposed())return;const{userAction:Be=!0}=Se??{};this.setState({visible:!1},{userAction:Be}),this.hooks.emit("hide",{userAction:Be})})}enable(Se){if(this.checkDisposed())return;const{userAction:Be=!0}=Se??{};this.setState({enabled:!0},{userAction:Be}),this.hooks.emit("enable",{userAction:Be})}disable(Se){if(this.checkDisposed())return;const{userAction:Be=!0}=Se??{};this.setState({enabled:!1},{userAction:Be}),this.hooks.emit("disable",{userAction:Be})}setState(Se,Be){if(this.checkDisposed())return;const{userAction:De=!0}=Be??{},Ve=f$m({},this.state);this.state=Object.assign(this.state,Se),Ve.visible!==this.state.visible&&(Se.visible?this.handleShow():this.handleHide()),Ve.enabled!==this.state.enabled&&(Se.enabled?this.handleEnable():this.handleDisable()),this.hooks.emit("stateChange",{state:this.state,prevState:Ve,userAction:De})}dispose(){var Se,Be,De,Ve,Fe,Je;this.pauseCurrentMedia(),this.disposeAllCSS3DContainer(),(Se=this.TagContainerSvelte)==null||Se.$destroy(),this.filterCSS3DTag.forEach(Xe=>{var Ke;return(Ke=Xe.tag3DContentSvelte)==null?void 0:Ke.svelteApp.$destroy()}),this.tags.forEach(Xe=>Xe.cache.clear()),this.tags=[],this.tagsLengthWillUpdate=!0,this.hooks.emit("tagsLengthChange"),(Be=this.store.disposers)==null||Be.forEach(Xe=>Xe?.()),this.store.disposers=[],(Ve=(De=this.store).eventListenerDisposer)==null||Ve.call(De),this.store.eventListenerDisposer=void 0,(Je=(Fe=this.store).resizeObserverDisposer)==null||Je.call(Fe),this.store.resizeObserverDisposer=void 0,this.store.resizeObserverDisposerAdding=!1,this.five.scene.remove(this.group),this.group.remove(...this.group.children),this.gltfObjectGroup.remove(...this.gltfObjectGroup.children),this.imagePlaneGroup.remove(...this.imagePlaneGroup.children),this.five.needsRender=!0,this.store.disposed=!0,this.hooks.emit("dispose")}blinkTagById(Se,Be){return l$d(this,null,function*(){var De;return(De=this.getTagById(Se))==null?void 0:De.blink(Be)})}changeUnfoldedById(Se,Be){const De=this.getTagById(Se);Be?De?.unfold():De?.fold()}changeEnabledById(Se,Be){var De;const Ve=this.getTagById(Se);Ve&&(Ve.enabled=Be,(De=Ve.hooks)==null||De.emit(Be?"enable":"disable"))}changeTagNormalById(Se,Be){const De=this.getTagById(Se);De&&De.tag3DContentSvelte&&(De.tag3DContentSvelte.currentNormal=a$D(Be))}changePositionById(Se,Be){const De=this.getTagById(Se);De&&De.setPosition(Be)}changeDataById(Se,Be,De=!0){const Ve=this.getTagById(Se);Ve&&(Ve.setData(Be,De),this.clearUnusedPanelTag(),Ve.hooks.emit("dataChanged",Ve.data))}changeStickTypeById(Se,Be,De=!0){this.changeTagById(Se,Be,De)}changeTagById(Se,Be,De=!0){const Ve=this.getTagById(Se);Ve&&(Ve.set(Be),Ve.updateVisible(),this.clearUnusedPanelTag(),Ve.hooks.emit("dataChanged",Ve.data))}destroyTagById(Se){(Array.isArray(Se)?Se:[Se]).forEach(Be=>{var De;return(De=this.getTagById(Be))==null?void 0:De.destroy()})}updateRenderAllTags(){this.tagsDo(this.tags,Se=>Se.updateVisible()),this.five.needsRender=!0}clearTags(){var Se;this.tags.length&&(this.tags.forEach(Be=>{var De,Ve,Fe,Je,Xe,Ke;(De=Be.tag3DContentSvelte)==null||De.dispose(),(Fe=(Ve=Be.mediaPlane)==null?void 0:Ve.parent)==null||Fe.remove(Be.mediaPlane),(Ke=(Xe=(Je=Be.model)==null?void 0:Je.object)==null?void 0:Xe.parent)==null||Ke.remove(Be.model.object)}),this.tags=[],this.tagsLengthWillUpdate=!0,this.hooks.emit("tagsLengthChange"),(Se=this.TagContainerSvelte)==null||Se.$destroy(),this.TagContainerSvelte=void 0,this.disposeAllCSS3DContainer()),this.enabledModelTagSet.clear(),this.cache.clear()}setUnfolded(){return l$d(this,null,function*(){return new Promise(Se=>{setTimeout(()=>{this.setUnfoldedByCamera(),Se()},100)})})}handleShow(){this.state.visible=!0,this.group.visible=!0,this.addRenderQueue({type:"TagContainerSvelte",keys:["state"]}),this.updateRenderAllTags(),this.five.needsRender=!0}handleHide(){this.pauseCurrentMedia(),this.state.visible=!1,this.group.visible=!1,this.addRenderQueue({type:"TagContainerSvelte",keys:["state"]}),this.five.needsRender=!0}handleEnable(){this.state.enabled=!0,this.store.eventListenerDisposer=this.addEventListener(),this.five.scene.children.includes(this.group)||this.five.scene.add(this.group),this.five.needsRender=!0}handleDisable(){var Se,Be,De;this.pauseCurrentMedia(),this.state.enabled=!1,(Be=(Se=this.store).eventListenerDisposer)==null||Be.call(Se),this.five.scene.remove(this.group),(De=this.TagContainerSvelte)==null||De.$set({tags:[]}),this.five.needsRender=!0}addResizeListener(){if(!this.store.resizeObserverDisposer&&!this.store.resizeObserverDisposerAdding){const Se=this.addResizeObserver();this.store.resizeObserverDisposerAdding=!0,setTimeout(()=>{this.store.resizeObserverDisposer=Se,this.store.resizeObserverDisposerAdding=!1},200)}}addResizeObserver(){if(this.store.disposed)return;const Se=this.five.getElement(),Be=()=>{this.state.enabled&&(this.filterPointTag.forEach(Ke=>Ke.updateScreenPosition({force:!0})),this.temporaryState.visible=!0,this.addRenderQueue({type:"TagContainerSvelte",keys:["temporaryState"]}))},De=()=>{this.state.enabled&&(this.temporaryState.visible=!1,this.addRenderQueue({type:"TagContainerSvelte",keys:["temporaryState"]}))},{observe:Ve,unobserve:Fe}=o$G(i$h(()=>{this.store.resizeObserverDisposer&&De()},500),Se),{observe:Je,unobserve:Xe}=o$G(i$i(()=>Be(),400),Se);return Ve(),Je(),()=>{Fe(),Xe()}}setUnfoldedByCamera(){let Se=!1;this.filterPointTag.forEach(Be=>{const De=Be.getUnfoldedByCamera();if(Be.state&&De!==void 0){if(De===!0&&Be.screenPosition){const Ve=Be.getConfig().unfoldedConfig;r$s(Ve).keep!=="unfolded"&&(Se=!0)}Be.state.unfolded=De}}),Se&&this.filterPointTag.forEach(Be=>{const De=Be.getConfig().unfoldedConfig;typeof De=="object"&&(De.autoUnfold||De.autoUnfold===!1||r$s(De.autoUnfold).enable===!1||De.keep)||Be.state&&(Be.state.unfolded=!1)})}changeTagMode(Se,Be){var De;(De=Se.tag3DContentSvelte)!=null&&De.css3DInstance&&(Se.tag3DContentSvelte.css3DInstance.mode=Be)}addEventListener(){const{five:Se,hooks:Be}=this,De=i$x(this.five,this.onFiveEveryReady);return this.handleFivePanoArrived(),Se.on("wantsMoveToPano",this.handleFiveWantsMoveToPano),Se.on("models.refined",this.onFiveRefined),Se.on("modeChange",this.handleFiveModeChange),Se.on("modelShownFloorChange",this.handleFiveModelShownFloorChange),Se.on("cameraUpdate",this.handleFiveCameraUpdate),Se.on("cameraFovUpdate",this.handleFiveCameraFovUpdate),Se.on("panoArrived",this.handleFivePanoArrived),Se.on("panoArrived",this.loadVideoFirstFrame),Se.on("render.prepare",this.render),Be.on("click",this.clickhandler),()=>{De(),Se.off("wantsMoveToPano",this.handleFiveWantsMoveToPano),Se.off("models.refined",this.onFiveRefined),Se.off("modeChange",this.handleFiveModeChange),Se.off("modelShownFloorChange",this.handleFiveModelShownFloorChange),Se.off("cameraUpdate",this.handleFiveCameraUpdate),Se.off("cameraFovUpdate",this.handleFiveCameraFovUpdate),Se.off("panoArrived",this.handleFivePanoArrived),Se.off("panoArrived",this.loadVideoFirstFrame),Se.off("render.prepare",this.render),Be.off("click",this.clickhandler),this.store.eventListenerDisposer=void 0}}setTagHoverEnabled(Se,Be){const De=this.getTagById(Se);De&&(De.hoverEnabled=Be)}getTagHoverEnabled(Se){const Be=this.getTagById(Se);return Be?.hoverEnabled}setGlobalHoverEnabled(Se){this.globalHoverEnabled=Se}getGlobalHoverEnabled(){return this.globalHoverEnabled}}const Wr=($e,Se)=>new No($e,Se);function r$e($e,Se,Be){if(Be){const De=new Vector3().subVectors($e.position,Be).applyQuaternion($e.quaternion.clone().inverse()).applyQuaternion(Se).add(Be);$e.position.copy(De)}$e.quaternion.copy(Se)}var x$a=Object.defineProperty,b$b=($e,Se,Be)=>Se in $e?x$a($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,u$e=($e,Se,Be)=>(b$b($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let h$9=class extends c$C{constructor(Se,Be){var De,Ve;super(),u$e(this,"originObject3D"),u$e(this,"onRender"),u$e(this,"positionFrom"),this.originObject3D=Se,this.onRender=(De=Be?.onRender)!=null?De:()=>{},this.positionFrom=(Ve=Be?.positionFrom)!=null?Ve:"objectPosition"}get helperObject(){return this}render(){this.onRender()}enable(){this.parent.children.includes(this)||this.parent.add(this)}disable(){this.removeFromParent()}show(){this.visible=!0,this.render()}hide(){this.visible=!1,this.render()}raycasterIntersectObject(Se,Be=[]){return Se.intersectObject(this,!0,Be)}initialPosition(Se){var Be,De;this.positionFrom==="objectPosition"?this.position.copy(this.originObject3D.position):this.positionFrom==="boundingBox"?this.position.copy((Be=R$j(this.originObject3D))==null?void 0:Be.getCenter(new Vector3).applyMatrix4(this.originObject3D.matrixWorld)):this.positionFrom==="boundingSphere"?this.position.copy((De=T$j(this.originObject3D))==null?void 0:De.center.clone().applyMatrix4(this.originObject3D.matrixWorld)):this.positionFrom instanceof Vector3?this.position.copy(this.positionFrom):this.positionFrom instanceof Function&&this.position.copy(this.positionFrom(this.originObject3D)),Se&&this.position.add(Se)}setScaleByCamera(Se){}initQuaternion(Se){if(this.quaternion.copy(this.originObject3D.quaternion),Se&&(Se.xAxis||Se.yAxis||Se.zAxis)){const Be=Se.xAxis instanceof Function?Se.xAxis():Se.xAxis,De=Se.yAxis instanceof Function?Se.yAxis():Se.yAxis,Ve=Se.zAxis instanceof Function?Se.zAxis():Se.zAxis;let Fe=Be?.clone(),Je=De?.clone(),Xe=Ve?.clone();if(Fe&&!Je&&!Je){const Ke=new Quaternion().setFromUnitVectors(new Vector3(1,0,0),Fe.normalize());this.applyQuaternion(Ke)}if(Je&&!Fe&&!Xe){const Ke=new Quaternion().setFromUnitVectors(new Vector3(0,1,0),Je.normalize());this.applyQuaternion(Ke)}if(Xe&&!Fe&&!Je){const Ke=new Quaternion().setFromUnitVectors(new Vector3(0,0,1),Xe.normalize());this.applyQuaternion(Ke)}if([Fe,Je,Xe].filter(i$w).length>=2){Fe||(Fe=new Vector3().crossVectors(Je,Xe).normalize()),Je||(Je=new Vector3().crossVectors(Fe,Xe).normalize()),Xe||(Xe=new Vector3().crossVectors(Fe,Je).normalize()),Fe.applyQuaternion(this.quaternion),Je.applyQuaternion(this.quaternion),Xe.applyQuaternion(this.quaternion);const Ke=new Matrix4().makeBasis(Fe,Je,Xe),Ye=new Quaternion().setFromRotationMatrix(Ke);this.quaternion.copy(Ye)}}}applyHelperScaleMatrix4(Se,Be){this.scale.applyMatrix4(Se)}setHelperQuaternion(Se,Be){this.initQuaternion(),r$e(this,this.quaternion.clone().premultiply(Se),Be)}applyHelperQuaternion(Se,Be){if(Be){const De=new Vector3().subVectors(this.position,Be).applyQuaternion(Se).add(Be);this.position.copy(De)}this.applyQuaternion(Se)}dispose(){this.removeFromParent()}},z$3=class extends h$9{},M$7=class extends h$9{},R$3=class extends h$9{},f$l=class extends h$9{},B$5=class extends h$9{};var n$c=Object.defineProperty,d$f=($e,Se,Be)=>Se in $e?n$c($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$6=($e,Se,Be)=>(d$f($e,Se+"",Be),Be);let u$d=class extends Group$1{constructor(Se){super(),i$6(this,"direction"),this.direction=Se||"x"}},x$9=class extends Mesh{constructor(Se,Be,De){super(Se,Be),i$6(this,"direction"),this.direction=De||"x"}};var y$a=Object.defineProperty,g$d=($e,Se,Be)=>Se in $e?y$a($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$d=($e,Se,Be)=>(g$d($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let G$1=class extends u$d{constructor(Se){var Be;super(Se.direction),r$d(this,"line"),r$d(this,"arrow"),r$d(this,"lineHeight",.4),r$d(this,"arrowHeight",.1),r$d(this,"renderOrder",50),r$d(this,"name","ArrowGroup");const De=new Color((Be=Se.color)!=null?Be:16214315),Ve=new MeshBasicMaterial({color:De,depthTest:!1,depthWrite:!1,transparent:!0}),Fe=new ConeGeometry(.04,.1,32),Je=new x$9(Fe,Ve.clone(),Se.direction);Je.name=`arrow-${Se.direction}`,this.arrow=Je;const Xe=.004,Ke=new CylinderGeometry(Xe,Xe,.4,32),Ye=new x$9(Ke,Ve.clone(),Se.direction);Ye.name=`line-${Se.direction}`,this.line=Ye,this.formatArrow(),this.formatLine(),this.add(this.arrow,this.line)}formatArrow(){this.arrow.geometry.translate(0,this.lineHeight+this.arrowHeight/2,0),this.direction==="x"?(this.arrow.geometry.rotateX(Math.PI/2),this.arrow.geometry.rotateY(Math.PI/2)):this.direction==="z"&&this.arrow.geometry.rotateX(Math.PI/2)}formatLine(){this.line.geometry.translate(0,this.lineHeight/2,0),this.direction==="x"?(this.line.geometry.rotateX(Math.PI/2),this.line.geometry.rotateY(Math.PI/2)):this.direction==="z"&&this.line.geometry.rotateX(Math.PI/2)}};const o$8={X:15618642,Y:4765519,Z:4227839};let t$2=class{static get X(){return new Color(o$8.X).convertSRGBToLinear().clone()}static get Y(){return new Color(o$8.Y).convertSRGBToLinear().clone()}static get Z(){return new Color(o$8.Z).convertSRGBToLinear().clone()}};function S$5($e,Se,Be){const De=$e.position.distanceTo(Se),Ve=$e.fov,Fe=$e.distance||3,Je=De/3,Xe=Ve/90,Ke=Fe/3,Ye=Je*Xe*Ke,or=Be?.min||.6,sr=Be?.max;return or&&Ye<or?or:sr&&Ye>sr?sr:Ye}function f$k($e,Se,Be){return $e<Se?Se:$e>Be?Be:$e}function f$j($e){let Se=$e.pose.latitude,Be=$e.pose.longitude;if(t$e(Se)||t$e(Be)){const De=$e.matrix.elements;Se=Math.asin(f$k(De[9],-1,1)),Math.abs(De[9])<.9999999?Be=o$h(Math.atan2(De[8],De[10])):Be=o$h(Math.atan2(-De[2],De[0]))}return{latitude:Se,longitude:Be}}function a$b($e){const{latitude:Se,longitude:Be}=$e,De=new Vector3;return i$5-Se<.03?De.set(0,1,0):s$4(0,Be)?De.set(0,0,1):s$4(Math.PI,Be)?De.set(0,0,-1):s$4(i$5,Be)?De.set(1,0,0):De.set(-1,0,0),De}const i$5=Number((Math.PI/2).toFixed(5));function s$4($e,Se){return typeof $e!="number"||typeof Se!="number"?!1:Math.abs($e-Se)<.001}var p$l=Object.defineProperty,c$h=($e,Se,Be)=>Se in $e?p$l($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,a$a=($e,Se,Be)=>(c$h($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let D$8=class extends z$3{constructor(Se,Be){super(Se,Be),a$a(this,"name","MoveHelper"),a$a(this,"xArrow"),a$a(this,"yArrow"),a$a(this,"zArrow"),Be.xArrowEnable!==!1&&(this.xArrow=new G$1({direction:"x",color:t$2.X})),Be.yArrowEnable!==!1&&(this.yArrow=new G$1({direction:"y",color:t$2.Y})),Be.zArrowEnable!==!1&&(this.zArrow=new G$1({direction:"z",color:t$2.Z})),this.add(...[this.xArrow,this.yArrow,this.zArrow].filter(Boolean))}update(Se){if(this.xArrow&&(this.xArrow.visible=!0),this.yArrow&&(this.yArrow.visible=!0),this.zArrow&&(this.zArrow.visible=!0),Se.type==="OrthographicCamera"){const Be=new Vector3(1,0,0).applyQuaternion(this.quaternion),De=new Vector3(0,1,0).applyQuaternion(this.quaternion),Ve=new Vector3(0,0,1).applyQuaternion(this.quaternion),Fe=f$j(Se),Je=a$b(Fe),Xe=.0872665;Math.abs(Be.angleTo(Je)-0)<Xe||Math.abs(Be.angleTo(Je)-Math.PI)<Xe?this.xArrow&&(this.xArrow.visible=!1):Math.abs(De.angleTo(Je)-0)<Xe||Math.abs(De.angleTo(Je)-Math.PI)<Xe?this.yArrow&&(this.yArrow.visible=!1):(Math.abs(Ve.angleTo(Je)-0)<Xe||Math.abs(Ve.angleTo(Je)-Math.PI)<Xe)&&this.zArrow&&(this.zArrow.visible=!1)}}show(){super.show(),this.xArrow&&this.add(this.xArrow),this.yArrow&&this.add(this.yArrow),this.zArrow&&this.add(this.zArrow)}setScaleByCamera(Se){this.scale.setScalar(S$5(Se,this.position))}showDraggingHelper(Se){this.xArrow&&(Se.includes("x")?this.add(this.xArrow):this.remove(this.xArrow)),this.yArrow&&(Se.includes("y")?this.add(this.yArrow):this.remove(this.yArrow)),this.zArrow&&(Se.includes("z")?this.add(this.zArrow):this.remove(this.zArrow))}dispose(){this.remove(...[this.xArrow,this.yArrow,this.zArrow].filter(Boolean)),super.dispose()}};function o$7($e,Se){return i$4(document.createElement("div"),$e)}function i$4($e,Se){if(!Se)return $e;for(const Be in Se)Be&&Se[Be]&&($e.style[Be]=Se[Be]);return $e}var r$c=Object.defineProperty,n$b=Object.getOwnPropertySymbols,d$e=Object.prototype.hasOwnProperty,f$i=Object.prototype.propertyIsEnumerable,l$c=($e,Se,Be)=>Se in $e?r$c($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,p$k=($e,Se)=>{for(var Be in Se||(Se={}))d$e.call(Se,Be)&&l$c($e,Be,Se[Be]);if(n$b)for(var Be of n$b(Se))f$i.call(Se,Be)&&l$c($e,Be,Se[Be]);return $e};function x$8($e){const Se=o$7(p$k({position:"absolute",display:"block",borderRadius:"4px",paddingTop:"1px",paddingBottom:"1px",paddingLeft:"4px",paddingRight:"4px",pointerEvents:"none",userSelect:"none",zIndex:"99999",backgroundColor:"rgba(0,0,0,0.7)",fontSize:"12px",color:"#fff",letterSpacing:"0",lineHeight:"18px"},$e)),Be=()=>{Se.style.display!=="block"&&Se.style.top&&Se.style.left&&(Se.style.display="block")};return{element:Se,show:Be,hide:()=>{Se.style.display="none",Se.style.top="",Se.style.left=""},setLeftTop:(De,Ve)=>{Se.style.left=De,Se.style.top=Ve,Be()}}}var m$a=Object.defineProperty,w$9=($e,Se,Be)=>Se in $e?m$a($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$3=($e,Se,Be)=>(w$9($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let D$7=class extends R$3{constructor(Se,Be){super(Se,Be),i$3(this,"name","RotateHelper"),i$3(this,"xCircle"),i$3(this,"yCircle"),i$3(this,"zCircle"),i$3(this,"children",[]),i$3(this,"angleTips"),i$3(this,"container"),Be?.yzCircleEnable!==!1&&(this.xCircle=new n$a({direction:"x",color:t$2.X})),Be?.xzCircleEnable!==!1&&(this.yCircle=new n$a({direction:"y",color:t$2.Y})),Be?.xyCircleEnable!==!1&&(this.zCircle=new n$a({direction:"z",color:t$2.Z})),Be!=null&&Be.container&&Be?.angleTipsEnable!==!1&&(this.container=Be?.container,this.angleTips=x$8({display:"none"}),this.container.appendChild(this.angleTips.element)),this.add(...[this.xCircle,this.yCircle,this.zCircle].filter(Boolean)),this.show()}hide(){this.children.forEach(Se=>Se.hide())}show(){var Se;this.children.forEach(Be=>Be.showCircle()),(Se=this.angleTips)==null||Se.hide()}setScaleByCamera(Se){this.scale.setScalar(S$5(Se,this.position))}showDraggingHelper(Se){var Be;this.hide(),this.children.filter(De=>Se.includes(De.direction)).forEach(De=>De.showRing()),(Be=this.angleTips)==null||Be.show()}dispose(){var Se,Be;this.removeFromParent(),(Be=(Se=this.angleTips)==null?void 0:Se.element)==null||Be.remove()}},n$a=class extends Group$1{constructor(Se){super(),i$3(this,"direction"),i$3(this,"circle"),i$3(this,"ring"),i$3(this,"angleSector"),this.direction=Se.direction,this.circle=new x$7(Se),this.ring=new b$a(Se),this.angleSector=new M$6(Se),this.add(this.circle,this.ring,this.angleSector),this.direction==="y"?this.rotateX(Math.PI/2):this.direction==="x"&&this.rotateY(-Math.PI/2)}showCircle(){this.add(this.circle),this.remove(this.ring,this.angleSector)}showRing(){this.add(this.ring,this.angleSector),this.remove(this.circle)}hide(){this.remove(this.ring,this.angleSector,this.circle)}},x$7=class extends Mesh{constructor(Se){var Be;super(),i$3(this,"direction"),i$3(this,"gapAngle",.02),i$3(this,"geometry",new RingGeometry(.25,.3,20,8,this.gapAngle,Math.PI/2-this.gapAngle*2)),this.material=new MeshBasicMaterial({opacity:.6,color:(Be=Se.color)!=null?Be:16777215,transparent:!0,side:DoubleSide,depthTest:!1,depthWrite:!1}),this.renderOrder=50,this.direction=Se.direction,this.geometry.name=`RotateHelperCircleGeometry-${this.direction}`}},b$a=class extends Group$1{constructor(Se){super(),i$3(this,"direction"),this.direction=Se.direction;const Be=.015,De=new Array(8).fill(null).map((Ve,Fe)=>{const Je=new RingGeometry(.25,.3,20,8,Math.PI/4*Fe+Be,Math.PI/4-Be*2),Xe=new MeshBasicMaterial({opacity:1,color:16777215,depthTest:!1,depthWrite:!1,transparent:!0,side:DoubleSide});this.renderOrder=50;const Ke=new Mesh(Je,Xe);return Ke.name=`AxesDashedRing-${this.direction}-${Fe}`,Ke});this.add(...De)}},M$6=class extends Mesh{constructor(Se){var Be;switch(super(),i$3(this,"direction"),i$3(this,"baseAxes"),i$3(this,"angleDirection"),Se.direction){case"x":this.baseAxes=new Vector3(0,0,1);break;case"y":this.baseAxes=new Vector3(1,0,0);break;case"z":this.baseAxes=new Vector3(1,0,0);break}const De=.3+5e-4;this.geometry=new CircleGeometry(De,48,0,1e-4),this.material=new MeshBasicMaterial({opacity:.4,color:(Be=Se.color)!=null?Be:16777215,depthTest:!1,depthWrite:!1,transparent:!0,side:DoubleSide}),this.renderOrder=50,this.direction=Se.direction,this.angleDirection=this.direction==="z"?1:-1}};var f$h=Object.defineProperty,g$c=Object.getOwnPropertySymbols,q$2=Object.prototype.hasOwnProperty,x$6=Object.prototype.propertyIsEnumerable,w$8=($e,Se,Be)=>Se in $e?f$h($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,b$9=($e,Se)=>{for(var Be in Se||(Se={}))q$2.call(Se,Be)&&w$8($e,Be,Se[Be]);if(g$c)for(var Be of g$c(Se))x$6.call(Se,Be)&&w$8($e,Be,Se[Be]);return $e};function F$3(){const $e=o$7({width:"100%",height:"100%",left:"0",top:"0",position:"absolute",pointerEvents:"none"}),Se=o$7({boxSizing:"border-box",width:"100%",height:"100%",left:"0",top:"0",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"}),Be=o$7({boxSizing:"border-box",width:"100%",height:"100%",left:"0",top:"0",position:"absolute",border:"1px solid rgba(255,255,255,0.4)"});$e.appendChild(Se),Se.appendChild(Be);const De="-4px",Ve={direction:"nesw",element:o$6({cursor:"nesw-resize",left:De,bottom:De})},Fe={direction:"ns",element:o$6({cursor:"ns-resize",bottom:De})},Je={direction:"nwse",element:o$6({cursor:"nwse-resize",right:De,bottom:De})},Xe={direction:"ew",element:o$6({cursor:"ew-resize",right:De})},Ke={direction:"nesw",element:o$6({cursor:"nesw-resize",right:De,top:De})},Ye={direction:"ns",element:o$6({cursor:"ns-resize",top:De})},or={direction:"nwse",element:o$6({cursor:"nwse-resize",left:De,top:De})},sr={direction:"ew",element:o$6({cursor:"ew-resize",left:De})};return new Array(Fe,Xe,Ye,sr,Ve,Je,Ke,or).forEach(cr=>Se.appendChild(cr.element)),{container:$e,squares:[Ve,Fe,Je,Xe,Ke,Ye,or,sr]}}function o$6($e){const Se=o$7(b$9({background:"#FFFFFF",width:"9px",height:"9px",position:"absolute",pointerEvents:"none"},$e)),Be=o$7({width:"15px",height:"15px",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"}),De=o$7({width:"15px",height:"15px",cursor:$e?.cursor,pointerEvents:"auto",background:"transparent"});return De.draggable=!0,Be.appendChild(De),Se.appendChild(Be),Se}var b$8=Object.defineProperty,D$6=($e,Se,Be)=>Se in $e?b$8($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i$2=($e,Se,Be)=>(D$6($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let v$a=class extends B$5{constructor(Se,Be,De,Ve){super(Se),i$2(this,"name","CSS3DScaleHelper"),i$2(this,"points",[]),i$2(this,"cornerPositions",[]),i$2(this,"css3DInstance"),i$2(this,"plane"),i$2(this,"css3DRenderer",new y$u),i$2(this,"camera"),i$2(this,"scene"),i$2(this,"container"),i$2(this,"enabled",!1),this.camera=De,this.scene=Ve,this.container=Be,this.initRectangleScaleHelper()}get helperObject(){var Se;if(!((Se=this.css3DInstance)!=null&&Se.css3DObject))throw new Error("css3DInstance is not initialized");return this.css3DInstance.css3DObject}initQuaternion(){this.quaternion.copy(this.originObject3D.quaternion)}applyMatrix4(Se){var Be;super.applyMatrix4(Se),this.helperObject.applyMatrix4(Se),(Be=this.plane)==null||Be.applyMatrix4(Se),this.cornerPositions.forEach(De=>De.applyMatrix4(Se))}showDraggingHelper(){}applyHelperScaleMatrix4(Se,Be){var De;(De=this.plane)==null||De.scale.applyMatrix4(Se),this.helperObject.applyScaleMatrix4(Se)}updatePoints(){const Se=this.calculatePointPosition(this.cornerPositions);this.points.forEach((Be,De)=>{Be.position.copy(Se[De])})}applyHelperQuaternion(Se,Be){var De;const Ve=(De=this.css3DInstance)==null?void 0:De.css3DObject;if(Ve){const Fe=new Vector3().subVectors(Ve.position,Be).applyQuaternion(Se).add(Be);Ve.position.copy(Fe),Ve.applyQuaternion(Se)}if(this.plane){const Fe=new Vector3().subVectors(this.plane.position,Be).applyQuaternion(Se).add(Be);this.plane.position.copy(Fe),this.plane.applyQuaternion(Se)}this.cornerPositions.forEach(Fe=>{const Je=new Vector3().subVectors(Fe,Be).applyQuaternion(Se).add(Be);Fe.copy(Je)})}enable(){var Se;this.enabled||(this.enabled=!0,(Se=this.css3DInstance)==null||Se.enable(),this.plane&&this.scene.add(this.plane))}disable(){var Se;this.enabled&&(this.enabled=!1,(Se=this.css3DInstance)==null||Se.disable(),this.plane&&this.scene.remove(this.plane))}show(){var Se;(Se=this.css3DInstance)==null||Se.show(),this.plane&&(this.plane.visible=!0)}hide(){var Se;(Se=this.css3DInstance)==null||Se.hide(),this.plane&&(this.plane.visible=!1)}dispose(){this.disable(),this.css3DRenderer.dispose()}initRectangleScaleHelper(){var Se,Be;const De=this.getCornerPositions();if(!De)return;this.cornerPositions=De;const Ve=this.css3DRenderer.create3DElement(this.camera,De,{ratio:.003});if(!Ve)return;this.css3DInstance=Ve,Ve.appendToElement(this.container);const Fe=Ve.css3DObject.container,{container:Je,squares:Xe}=F$3();this.points=Xe.map((Ke,Ye)=>({direction:Ke.direction,point:Ke.element,position:this.calculatePointPosition(De)[Ye]})),Fe.insertBefore(Je,(Se=Fe.children[0])!=null?Se:null),this.helperObject.position.copy(this.originObject3D.position),(Be=this.plane)==null||Be.position.copy(this.originObject3D.position)}getCornerPositions(){const{originObject3D:Se}=this;if(Se.isCSS3DObject&&Se.cornerPoints)return Se.cornerPoints;console.error("当前物体暂时不支持 ScaleHelper")}calculatePointPosition(Se){return[Se[0].clone(),Se[0].clone().add(Se[1]).divideScalar(2),Se[1].clone(),Se[1].clone().add(Se[2]).divideScalar(2),Se[2].clone(),Se[2].clone().add(Se[3]).divideScalar(2),Se[3].clone(),Se[3].clone().add(Se[0]).divideScalar(2)]}};var u$c=Object.defineProperty,c$g=($e,Se,Be)=>Se in $e?u$c($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$b=($e,Se,Be)=>(c$g($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let d$d=class extends M$7{constructor(Se){super(Se),r$b(this,"name","BoundingBoxHelper"),r$b(this,"box"),r$b(this,"outline"),r$b(this,"positionAttribute"),this.positionAttribute=new BufferAttribute(new Float32Array(8*3),3),this.box=this.createBox(),this.outline=this.createOutline(),this.add(this.box,this.outline),this.update()}initQuaternion(){this.quaternion.copy(this.originObject3D.quaternion)}setHelperQuaternion(Se,Be){r$e(this,Se,Be)}raycasterIntersectObject(Se,Be){return Se.intersectObject(this,!1,Be)}raycast(Se,Be){this.box.raycast(Se,Be)}update(){const Se=R$j(this.originObject3D);if(!Se)return;const{min:Be,max:De}=Se;this.positionAttribute.setXYZ(0,De.x,De.y,De.z),this.positionAttribute.setXYZ(1,Be.x,De.y,De.z),this.positionAttribute.setXYZ(2,Be.x,Be.y,De.z),this.positionAttribute.setXYZ(3,De.x,Be.y,De.z),this.positionAttribute.setXYZ(4,De.x,De.y,Be.z),this.positionAttribute.setXYZ(5,Be.x,De.y,Be.z),this.positionAttribute.setXYZ(6,Be.x,Be.y,Be.z),this.positionAttribute.setXYZ(7,De.x,Be.y,Be.z),this.positionAttribute.needsUpdate=!0}createOutline(){const Se=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),Be=new BufferGeometry;Be.setIndex(new BufferAttribute(Se,1)),Be.setAttribute("position",this.positionAttribute);const De=new LineBasicMaterial({color:64767,linewidth:1,opacity:1,toneMapped:!1}),Ve=new LineSegments(Be,De);return Ve.matrixAutoUpdate=!1,Ve}createBox(){const Se=new Uint16Array([0,1,2,0,2,3,0,3,7,0,7,4,0,4,5,0,5,1,6,1,5,6,2,1,6,5,4,6,4,7,6,3,2,6,7,3]),Be=new BufferGeometry;Be.setIndex(new BufferAttribute(Se,1)),Be.setAttribute("position",this.positionAttribute);const De=new MeshBasicMaterial({color:64767,opacity:.1,depthTest:!1,transparent:!0});return new Mesh(Be,De)}};const e$3=new Map;function l$b($e){if(e$3.has($e))return e$3.get($e).hooks;const Se=new E$v;let Be=null,De;const Ve=()=>{Be=requestAnimationFrame(Ve);const Je=$e.projectionMatrix.toArray().join(",")+$e.matrixWorld.toArray().join(",");Je!==De&&(De=Je,Se.emit("cameraUpdate"))};Ve();const Fe=()=>{e$3.delete($e),cancelAnimationFrame(Be)};return e$3.set($e,{hooks:Se,dispose:Fe}),Se}var m$9=Object.defineProperty,H$6=($e,Se,Be)=>Se in $e?m$9($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,o$5=($e,Se,Be)=>(H$6($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let B$4=class{constructor(Se,Be){o$5(this,"originObject3D"),o$5(this,"hooks"),o$5(this,"preventTapDefaultEvent",!1),o$5(this,"internalHooks"),o$5(this,"disposers",[]),o$5(this,"helperObject3D"),o$5(this,"camera"),o$5(this,"model"),o$5(this,"scene"),o$5(this,"container"),o$5(this,"domEvents"),o$5(this,"isDragging",!1),o$5(this,"enabled",!1),o$5(this,"name","BaseController"),o$5(this,"boundingBox"),o$5(this,"config"),o$5(this,"onRender"),o$5(this,"cameraHooks"),o$5(this,"onWantsTapGesture",Br=>{if(this.getIntersectObject(Br))return!1}),o$5(this,"updateHelperScale",()=>{this.helperObject3D.setScaleByCamera(this.camera)}),o$5(this,"getBox",()=>this.boundingBox?this.boundingBox:(this.boundingBox=R$j(this.originObject3D),this.boundingBox));var De,Ve,Fe;this.hooks=(De=Se.sharedHooks)!=null?De:new E$v,this.internalHooks=(Ve=Se.sharedInternalHooks)!=null?Ve:new E$v,this.camera=Se.camera,this.model=Se.model,this.originObject3D=Se.originObject3D,this.helperObject3D=Se.helperObject3D,this.container=Se.container,this.scene=Se.scene,this.domEvents=Se.domEvents,this.onRender=(Fe=Se.onRender)!=null?Fe:()=>{},this.config=Be??{},this.initialHelperPosition(),this.initialHelperQuaternion(),this.updateHelperScale(),this.cameraHooks=l$b(this.camera),this.enable();const Je=this.onSetOriginObjectScale.bind(this),Xe=this.onSetOriginObjectRotate.bind(this),Ke=this.onSetOriginObjectPosition.bind(this),Ye=this.onApplyOriginObjectScale.bind(this),or=this.onApplyOriginObjectRotate.bind(this),sr=this.onApplyOriginObjectPosition.bind(this),cr=this.initialHelperPosition.bind(this);this.cameraHooks.on("cameraUpdate",this.updateHelperScale),this.internalHooks.on("initialHelperPosition",cr),this.internalHooks.on("setObjectScale",Je),this.internalHooks.on("setObjectRotate",Xe),this.internalHooks.on("setObjectPosition",Ke),this.internalHooks.on("applyObjectPosition",sr),this.internalHooks.on("applyObjectRotate",or),this.internalHooks.on("applyObjectScale",Ye),this.hooks.on("moveEnd",this.updateHelperScale),this.internalHooks.on("setObjectPosition",this.updateHelperScale),this.internalHooks.on("initialHelperPosition",this.updateHelperScale),this.disposers.push(()=>{this.cameraHooks.off("cameraUpdate",this.updateHelperScale),this.internalHooks.off("initialHelperPosition",cr),this.internalHooks.off("setObjectScale",Je),this.internalHooks.off("setObjectRotate",Xe),this.internalHooks.off("setObjectPosition",Ke),this.internalHooks.off("applyObjectPosition",sr),this.internalHooks.off("applyObjectRotate",or),this.internalHooks.off("applyObjectScale",Ye),this.hooks.off("moveEnd",this.updateHelperScale),this.internalHooks.off("setObjectPosition",this.updateHelperScale),this.internalHooks.off("initialHelperPosition",this.updateHelperScale)})}initialHelperPosition(){this.helperObject3D.initialPosition(this.calculateOffset(this.config.offset))}initialHelperQuaternion(){this.helperObject3D.initQuaternion(this.config)}enable(){this.enabled||(this.enabled=!0,this.scene.add(this.helperObject3D),this.helperObject3D.enable(),this.render())}disable(){this.enabled&&(this.enabled=!1,this.helperObject3D.disable(),this.render())}show(){this.helperObject3D.show(),this.render()}hide(){this.helperObject3D.hide(),this.render()}dispose(){var Se;(Se=this.disposers)==null||Se.forEach(Be=>Be?.()),this.helperObject3D.dispose(),this.render()}applyHelperMatrix4(Se){this.helperObject3D.applyMatrix4(Se)}applyHelperQuaternion(Se,Be){this.helperObject3D.applyHelperQuaternion(Se,Be)}applyHelperScaleMatrix4(Se,Be){this.helperObject3D.applyHelperScaleMatrix4(Se,Be)}onWantsGesture(Se,Be,De){if(this.isDragging)return!1}onIntersectionOnModelUpdate(Se){}onApplyOriginObjectScale(Se){this.applyHelperScaleMatrix4(Se.matrix,Se.origin)}onApplyOriginObjectRotate(Se){this.applyHelperQuaternion(Se.quaternion,Se.origin)}onApplyOriginObjectPosition(Se){this.applyHelperMatrix4(Se.matrix)}onSetOriginObjectScale(Se){this.helperObject3D.scale.copy(Se),this.updateOffsetByScale(Se)}onSetOriginObjectRotate(Se,Be){this.helperObject3D.setHelperQuaternion(Se,Be)}onSetOriginObjectPosition(Se){this.helperObject3D.position.copy(Se.clone().add(this.calculateOffset(this.config.offset)))}render(){this.onRender()}updateOffsetByScale(Se){if(this.boundingBox&&this.config.offset){const Be=this.originObject3D.position,De=new Vector3().subVectors(this.boundingBox.max,Be).multiply(Se).add(Be),Ve=new Vector3().subVectors(this.boundingBox.min,Be).multiply(Se).add(Be),Fe=this.calculateOffset(this.config.offset,{min:Ve,max:De});this.helperObject3D.initialPosition(Fe)}}hoverListener(Se,Be=16777215,De=1){const Ve=t$c(Se).filter(i$w),Fe=[];for(const Je of Ve)if(Je.material||Je instanceof Group$1){const Xe=Je instanceof Group$1?Je.children.filter(cr=>cr instanceof Mesh):[Je];Xe.forEach(cr=>{var Br,tn;cr.__originalColor__=(Br=cr.__originalColor__)!=null?Br:cr.material.color.clone(),cr.__originalOpacity__=(tn=cr.__originalOpacity__)!=null?tn:cr.material.opacity});const Ke=()=>{Xe.forEach(cr=>{cr.material.color.set(Be),cr.material.opacity=De}),this.render()},Ye=()=>{Xe.forEach(cr=>{cr.material.color.copy(cr.__originalColor__),cr.material.opacity=cr.__originalOpacity__}),this.render()},or=()=>{this.isDragging||Ke()},sr=()=>{this.isDragging||Ye()};for(const cr of Xe)this.domEvents.addEventListener(cr,"mouseover",or),this.domEvents.addEventListener(cr,"mouseout",sr),this.hooks.on("moveStart",Ke),this.hooks.on("moveEnd",Ye),this.hooks.on("rotateEnd",Ye),this.hooks.on("scaleEnd",Ye),Fe.push(()=>{this.domEvents.removeEventListener(cr,"mouseover",or),this.domEvents.removeEventListener(cr,"mouseout",sr),this.hooks.off("moveStart",Ke),this.hooks.off("moveEnd",Ye),this.hooks.off("rotateEnd",Ye),this.hooks.off("scaleEnd",Ye)})}return()=>Fe.forEach(Je=>Je?.())}getIntersectObject(Se){const Be=this.camera.position,De=this.helperObject3D;if(!De)return;const Ve=this.helperObject3D.raycasterIntersectObject(Se)[0];if(!Ve)return;const Fe=Ve;if(Fe.object=De,this.model.intersectRaycaster){const Je=this.model.intersectRaycaster(Se)[0];if(Je&&Je.point.distanceTo(Be)<Fe.point.distanceTo(Be))return}return Fe.object}calculateOffset(Se,Be){const De=new Vector3(0,0,0);if(!Se)return De;const Ve=()=>Be||this.getBox();if(typeof Se.x=="number")De.setX(Se.x);else if(typeof Se.x=="object"){const Fe=Ve();De.setX((Fe.max.x-Fe.min.x)*Se.x.percents)}if(typeof Se.y=="number")De.setY(Se.y);else if(typeof Se.y=="object"){const Fe=Ve();De.setY((Fe.max.y-Fe.min.y)*Se.y.percents)}if(typeof Se.z=="number")De.setZ(Se.z);else if(typeof Se.z=="object"){const Fe=Ve();De.setZ((Fe.max.z-Fe.min.z)*Se.z.percents)}return De}};function s$3($e,Se){const{offsetWidth:Be,offsetHeight:De}=Se,{top:Ve,left:Fe}=Se.getBoundingClientRect();return Object.assign(new Vector2,{x:($e.x-Fe)/Be*2-1,y:-($e.y-Ve)/De*2+1})}function u$b($e,Se,Be){if(!Se||!Be||!$e)return;const De=s$3(Se,Be);if(Math.abs(De.x)===1||Math.abs(De.y)===1)return;const Ve=new Raycaster;return Ve.setFromCamera(De,$e),Ve.params.Points.threshold=.1,Ve}var v$9=Object.defineProperty,f$g=($e,Se,Be)=>Se in $e?v$9($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,a$9=($e,Se,Be)=>(f$g($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let w$7=class extends B$4{constructor(...Se){super(...Se),a$9(this,"name","MoveController"),a$9(this,"startInfo"),a$9(this,"_moveByMouse",{enabled:!1}),a$9(this,"mouseInfo"),a$9(this,"mousedownEventListenerDisposer"),a$9(this,"dragStart",Je=>{if(this.moveByMouseEnable||this.isDragging)return;const Xe=Je?.intersect;if(!Xe)return this.dragEnd();const Ke=(Xe?.object).direction;if(!Ke)return this.dragEnd();const Ye=new Vector3(1,0,0).applyQuaternion(this.helperObject3D.quaternion),or=new Vector3(0,1,0).applyQuaternion(this.helperObject3D.quaternion),sr=new Vector3(0,0,1).applyQuaternion(this.helperObject3D.quaternion),cr=(()=>{switch(Ke){case"x":return Ye;case"y":return or;case"z":return sr}})(),Br=Xe.point.clone(),tn=new Line3(Br.clone().sub(cr.normalize()),Br.clone().add(cr.normalize()));this.startInfo={startVectorProject:Br,line:tn},this.helperObject3D.showDraggingHelper([Ke]),this.hooks.emit("moveStart"),this.isDragging=!0}),a$9(this,"dragging",Je=>{if(!this.isDragging||!this.startInfo)return;const Xe="touches"in Je?Je.touches[0].clientX:Je.x,Ke="touches"in Je?Je.touches[0].clientY:Je.y,Ye=u$b(this.camera,{x:Xe,y:Ke},this.container);return Ye?(this.move(Ye),!1):this.dragEnd()}),a$9(this,"dragEnd",()=>{this.isDragging&&(this.startInfo=void 0,this.isDragging=!1,this.helperObject3D.show(),this.hooks.emit("moveEnd"))});const Be=this.helperObject3D;this.hoverListener([Be.xArrow,Be.yArrow,Be.zArrow]);const De=this.show.bind(this),Ve=this.hide.bind(this),Fe=()=>{this.helperObject3D.update(this.camera),this.render()};Fe(),this.domEvents.addEventListener(this.helperObject3D,"mousedown",this.dragStart),document.addEventListener("mousemove",this.dragging),document.addEventListener("mouseup",this.dragEnd),this.domEvents.addEventListener(this.helperObject3D,"touchstart",this.dragStart),document.addEventListener("touchmove",this.dragging),document.addEventListener("touchend",this.dragEnd),this.hooks.on("rotateStart",Ve),this.hooks.on("rotateEnd",De),this.hooks.on("scaleStart",Ve),this.hooks.on("scaleEnd",De),this.hooks.on("moveByMouseEnable",Ve),this.hooks.on("moveByMouseDisable",De),this.cameraHooks.on("cameraUpdate",Fe),this.disposers.push(()=>{this.domEvents.removeEventListener(this.helperObject3D,"mousedown",this.dragStart),document.removeEventListener("mousemove",this.dragging),document.removeEventListener("mouseup",this.dragEnd),this.domEvents.removeEventListener(this.helperObject3D,"touchstart",this.dragStart),document.removeEventListener("touchmove",this.dragging),document.removeEventListener("touchend",this.dragEnd),this.hooks.off("rotateStart",Ve),this.hooks.off("rotateEnd",De),this.hooks.off("scaleStart",Ve),this.hooks.off("scaleEnd",De),this.hooks.off("moveByMouseEnable",Ve),this.hooks.off("moveByMouseDisable",De),this.cameraHooks.off("cameraUpdate",Fe)}),this.moveByMouseEnable&&this.moveByMouse()}get moveByMouseEnable(){return this._moveByMouse.enabled}dispose(){var Se;super.dispose(),(Se=this.disposers)==null||Se.forEach(Be=>Be?.())}moveByMouse(Se){this._moveByMouse={enabled:!0,useFaceNormal:Se?.useFaceNormal},this.preventTapDefaultEvent=!0;const Be=this.handleMouseDown.bind(this),De=this.handleMouseUp.bind(this);this.hooks.emit("moveByMouseEnable"),setTimeout(()=>{this.container.addEventListener("mousedown",Be),this.container.addEventListener("mouseup",De)}),this.mousedownEventListenerDisposer=()=>{this.container.removeEventListener("mousedown",Be),this.container.removeEventListener("mouseup",De)}}disableMoveByMouse(){var Se;this._moveByMouse={enabled:!1},this.preventTapDefaultEvent=!1,this.hooks.emit("moveByMouseDisable"),(Se=this.mousedownEventListenerDisposer)==null||Se.call(this)}onIntersectionOnModelUpdate(Se){var Be,De,Ve;if(!this.moveByMouseEnable)return;const{point:Fe,face:Je}=Se;if(!this.hooks.emit("wantToMove",Fe)){if(this.originObject3D.position.copy(Fe),(this._moveByMouse.useFaceNormal===!0||typeof this._moveByMouse.useFaceNormal=="object"&&this._moveByMouse.useFaceNormal.enable!==!1)&&Je!=null&&Je.normal){const Xe=typeof this._moveByMouse.useFaceNormal=="object"&&this._moveByMouse.useFaceNormal.alignmentVector?this._moveByMouse.useFaceNormal.alignmentVector:{x:0,y:1,z:0},Ke=new Vector3((Be=Xe.x)!=null?Be:0,(De=Xe.y)!=null?De:0,(Ve=Xe.z)!=null?Ve:0),Ye=typeof this._moveByMouse.useFaceNormal=="object"&&this._moveByMouse.useFaceNormal.fixedFaceNormal?this._moveByMouse.useFaceNormal.fixedFaceNormal(Je.normal):Je.normal;this.originObject3D.quaternion.setFromUnitVectors(Ke,Ye),this.internalHooks.emit("setObjectRotate",this.originObject3D.quaternion.clone())}this.internalHooks.emit("setObjectPosition",Fe),this.hooks.emit("move",Fe)}}handleMouseDown(Se){const{x:Be,y:De}=Se;this.mouseInfo={x:Be,y:De,mouseDownTimestamp:Date.now()}}handleMouseUp(Se){if(!this.mouseInfo)return;const{x:Be,y:De}=Se;this.mouseInfo.x===Be&&this.mouseInfo.y===De&&Date.now()-this.mouseInfo.mouseDownTimestamp<500&&(this.disableMoveByMouse(),this.mouseInfo=void 0)}move(Se){if(!this.startInfo)return this.dragEnd();const{line:Be,startVectorProject:De}=this.startInfo,Ve=this.originObject3D,Fe=w$o({raycaster:Se,line:Be,clampToLine:!1}),Je=Fe.clone().sub(De),Xe=new Matrix4;Xe.setPosition(Je);const Ke=Ve.position.clone().applyMatrix4(Xe);this.hooks.emit("wantToMove",Ke)||(Ve.applyMatrix4(Xe),De.copy(Fe),this.internalHooks.emit("applyObjectPosition",{matrix:Xe}),this.hooks.emit("move",Ke))}};var v$8=Object.defineProperty,C$2=($e,Se,Be)=>Se in $e?v$8($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$a=($e,Se,Be)=>(C$2($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let F$2=class{constructor(Se,Be,De,Ve,Fe,Je,Xe,Ke){r$a(this,"helperController"),r$a(this,"five"),r$a(this,"onFiveWantsTapGesture",tn=>{if(!this.helperController)return;if(this.helperController.preventTapDefaultEvent)return!1;const en=this.helperController.onWantsTapGesture(tn);return this.five.needsRender=!0,en}),r$a(this,"onFiveWantsGesture",(...tn)=>{if(!this.helperController)return;const en=this.helperController.onWantsGesture(...tn);return this.five.needsRender=!0,en}),r$a(this,"onFiveIntersectionOnModelUpdate",(...tn)=>{this.helperController&&this.helperController.onIntersectionOnModelUpdate(...tn)});const{camera:Ye,model:or,scene:sr}=Se,cr=Se.getElement();if(this.five=Se,!Ye||!or||!cr||!sr)return;const Br=()=>{Se.needsRender=!0};this.helperController=new De({camera:Ye,model:or,domEvents:Be,originObject3D:Ve,helperObject3D:Fe,container:cr,scene:sr,onRender:Br,sharedHooks:Xe,sharedInternalHooks:Ke},Je),Se.on("wantsTapGesture",this.onFiveWantsTapGesture),Se.on("wantsGesture",this.onFiveWantsGesture),Se.on("intersectionOnModelUpdate",this.onFiveIntersectionOnModelUpdate)}dispose(){var Se;this.five.off("wantsTapGesture",this.onFiveWantsTapGesture),this.five.off("wantsGesture",this.onFiveWantsGesture),this.five.off("intersectionOnModelUpdate",this.onFiveIntersectionOnModelUpdate),(Se=this.helperController)==null||Se.dispose()}};var u$a=Object.defineProperty,f$f=Object.getOwnPropertySymbols,S$4=Object.prototype.hasOwnProperty,E$7=Object.prototype.propertyIsEnumerable,d$c=($e,Se,Be)=>Se in $e?u$a($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,a$8=($e,Se)=>{for(var Be in Se||(Se={}))S$4.call(Se,Be)&&d$c($e,Be,Se[Be]);if(f$f)for(var Be of f$f(Se))E$7.call(Se,Be)&&d$c($e,Be,Se[Be]);return $e},r$9=($e,Se,Be)=>(d$c($e,typeof Se!="symbol"?Se+"":Se,Be),Be),b$7=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const D$5="v1.0.1",y$9="Object3DHelper",c$f=`${y$9}@${D$5}`,k$2=()=>{console.error(`${c$f} is disposed`)},I$2=()=>{console.warn(`${c$f} is disabled`)},m$8=()=>{console.error(`${c$f} is disabled`)};let L$6=class{constructor(Se){r$9(this,"controllers",{}),r$9(this,"state",{visible:!0,enabled:!0,disposed:!1}),r$9(this,"hooks",new E$v),r$9(this,"eventListener",{}),Se&&this.addControllers(Se),this.setState(this.state)}show(Se){return b$7(this,null,function*(){this.setState({visible:!0},Se)})}hide(Se){return b$7(this,null,function*(){this.setState({visible:!1},Se)})}enable(Se){this.setState({enabled:!0},Se)}disable(Se){this.setState({enabled:!1},Se)}dispose(){this.setState({disposed:!0})}setState(Se,Be){if(this.state.disposed)return k$2();if(!this.state.enabled&&Se.enabled!==!0&&Se.disposed!==!0)return m$8();const De=a$8({},this.state);this.state=a$8(a$8({},this.state),Se),Se.disposed!==void 0&&Se.disposed!==De.disposed&&Se.disposed&&this.handleDispose(),Se.visible!==void 0&&this.handleVisible(Se.visible),Se.enabled!==void 0&&this.handleEnable(Se.enabled),this.hooks.emit("stateChange",{state:this.state,prevState:De})}addControllers(Se){this.controllers=a$8(a$8({},this.controllers),Se),this.setState(this.state)}initialHelperMatrix(){this.everyControllerDo(Se=>{Se.initialHelperPosition(),Se.initialHelperQuaternion()})}getCurrentState(){return this.state}handleEnable(Se,Be=!0){Se?(this.everyControllerDo(De=>{De.enable()}),this.hooks.emit("enable",{userAction:Be})):(this.everyControllerDo(De=>{De.disable()}),this.hooks.emit("disable",{userAction:Be})),this.state.enabled=Se}handleVisible(Se,Be=!0){Se?(this.everyControllerDo(De=>{De.show()}),this.actionIfStateIsEnabled(()=>this.hooks.emit("show",{userAction:Be}))):(this.everyControllerDo(De=>{De.hide()}),this.actionIfStateIsEnabled(()=>this.hooks.emit("hide",{userAction:Be}))),this.state.visible=Se}everyControllerDo(Se){Object.values(this.controllers).forEach(Be=>{Be&&Se(Be)})}handleDispose(){var Se,Be;Object.values(this.controllers).forEach(De=>{De?.dispose()});for(const De in this.controllers){if(!De)continue;const Ve=De;(Be=(Se=this.eventListener)[Ve])==null||Be.call(Se)}}actionIfStateIsEnabled(Se,Be){if(this.state.enabled)return Se();Be!=null&&Be.warnLog&&I$2()}};function e$2($e){return $e*Math.PI/180}var j$8=Object.defineProperty,w$6=($e,Se,Be)=>Se in $e?j$8($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,d$b=($e,Se,Be)=>(w$6($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let y$8=new Quaternion,P$5=class extends B$4{constructor(...Se){var Be,De,Ve;super(...Se),d$b(this,"name","RotateController"),d$b(this,"startInfo"),d$b(this,"removeListener");const Fe=this.helperObject3D;this.hoverListener([(Be=Fe.xCircle)==null?void 0:Be.circle,(De=Fe.yCircle)==null?void 0:De.circle,(Ve=Fe.zCircle)==null?void 0:Ve.circle].filter(Boolean));const Je=this.dragStart.bind(this),Xe=this.dragging.bind(this),Ke=this.dragEnd.bind(this),Ye=this.show.bind(this),or=this.hide.bind(this);this.domEvents.addEventListener(this.helperObject3D,"mousedown",Je),document.addEventListener("mousemove",Xe),document.addEventListener("mouseup",Ke),this.domEvents.addEventListener(this.helperObject3D,"touchstart",Je),document.addEventListener("touchmove",Xe),document.addEventListener("touchend",Ke),this.hooks.on("moveStart",or),this.hooks.on("moveEnd",Ye),this.hooks.on("scaleStart",or),this.hooks.on("scaleEnd",Ye),this.hooks.on("moveByMouseEnable",or),this.hooks.on("moveByMouseDisable",Ye),this.disposers.push(()=>{this.domEvents.removeEventListener(this.helperObject3D,"mousedown",Je),document.removeEventListener("mousemove",Xe),document.removeEventListener("mouseup",Ke),this.domEvents.removeEventListener(this.helperObject3D,"touchstart",Je),document.removeEventListener("touchmove",Xe),document.removeEventListener("touchend",Ke),this.hooks.off("moveStart",or),this.hooks.off("moveEnd",Ye),this.hooks.off("scaleStart",or),this.hooks.off("scaleEnd",Ye),this.hooks.off("moveByMouseEnable",or),this.hooks.off("moveByMouseDisable",Ye)})}get rotateCenter(){return this.helperObject3D.position.clone()}setRotateAngle(Se){const{x:Be=0,y:De=0,z:Ve=0}=Se,Fe=new Euler(e$2(Be),e$2(De),e$2(Ve)),Je=new Quaternion().setFromEuler(Fe);if(this.hooks.emit("wantToRotate",Je))return;const{originObject3D:Xe,rotateCenter:Ke}=this;r$e(Xe,Je,Ke),this.internalHooks.emit("setObjectRotate",Je,Ke),this.hooks.emit("rotate",Je),this.render()}onApplyOriginObjectRotate(Se){this.isDragging||super.onApplyOriginObjectRotate(Se)}onApplyOriginObjectScale(Se){}dragStart(Se){if(this.isDragging)return;const Be=Se?.intersect;if(!Be)return this.dragEnd();const De=(Be?.object).direction;if(!De)return this.dragEnd();const Ve=Be.point,Fe=this.getAngleHelper(De);this.setTipsAngle(0);const Je=Ve.clone();Je.y+=.2,this.setTipsPosition(Je);const Xe=this.helperObject3D.quaternion.clone(),Ke=(()=>{if(De==="x")return new Vector3(1,0,0).applyQuaternion(Xe);if(De==="y")return new Vector3(0,1,0).applyQuaternion(Xe);if(De==="z")return new Vector3(0,0,1).applyQuaternion(Xe)})(),Ye=new Plane().setFromNormalAndCoplanarPoint(Ke,Ve),or=Ye.projectPoint(Ve.clone(),new Vector3).clone().sub(this.rotateCenter),sr=or.angleTo(Fe.baseAxes.clone().applyQuaternion(Xe));this.setAngleHelperStart(De,sr),this.setAngleHelperLength(De,0),this.startInfo={direction:De,startVector:or,plane:Ye,angleHelper:Fe,angle:0,helperQuaternion:Xe.clone()},y$8=new Quaternion,this.helperObject3D.showDraggingHelper([De]),this.hooks.emit("rotateStart"),this.isDragging=!0}dragging(Se){if(!this.isDragging)return;const Be="touches"in Se?Se.touches[0].clientX:Se.x,De="touches"in Se?Se.touches[0].clientY:Se.y,Ve=u$b(this.camera,{x:Be,y:De},this.container);return Ve?(this.rotate(Ve),!1):this.dragEnd()}rotate(Se){if(!this.startInfo)return this.dragEnd();const{startVector:Be,plane:De,angleHelper:Ve,direction:Fe,helperQuaternion:Je}=this.startInfo,{originObject3D:Xe}=this,Ke=Se.ray.intersectPlane(De,new Vector3);if(!Ke)return;const Ye=this.rotateCenter.clone(),or=De.projectPoint(Ke.clone(),new Vector3).clone().sub(Ye);if(Be.angleTo(or)===0)return;const sr=new Quaternion().setFromUnitVectors(Be.clone().normalize(),or.clone().normalize()),cr=Xe.quaternion.clone().premultiply(sr);if(this.hooks.emit("wantToRotate",cr))return;const Br=new Euler().setFromQuaternion(new Quaternion().setFromUnitVectors(Be.clone().normalize().applyQuaternion(Je.clone().inverse()),or.clone().normalize().applyQuaternion(Je.clone().inverse())),`${Fe.toUpperCase()}${"XZY".replace(Fe.toUpperCase(),"")}`)[Fe]*Ve.angleDirection;if(this.startInfo.angle+=Br,this.setAngleHelperLength(Fe,this.startInfo.angle),this.setTipsAngle(t$9(this.startInfo.angle)),Ye){const tn=new Vector3().subVectors(Xe.position,Ye).applyQuaternion(sr).add(Ye);Xe.position.copy(tn)}Xe.applyQuaternion(sr),y$8.premultiply(sr),this.internalHooks.emit("applyObjectRotate",{quaternion:sr,origin:Ye}),this.hooks.emit("rotate",Xe.quaternion),this.startInfo.startVector=or}dragEnd(){this.isDragging&&(this.applyHelperQuaternion(y$8,this.rotateCenter),this.startInfo=void 0,this.isDragging=!1,this.helperObject3D.show(),this.hooks.emit("rotateEnd"))}getAngleHelper(Se){var Be,De,Ve;switch(Se){case"x":return(Be=this.helperObject3D.xCircle)==null?void 0:Be.angleSector;case"y":return(De=this.helperObject3D.yCircle)==null?void 0:De.angleSector;case"z":return(Ve=this.helperObject3D.zCircle)==null?void 0:Ve.angleSector}}setAngleHelperStart(Se,Be){const De=this.getAngleHelper(Se);if(!De){console.warn("angleHelper is undefined");return}if(De instanceof Mesh&&De.geometry instanceof CircleGeometry){const{radius:Ve,segments:Fe,thetaLength:Je}=De.geometry.parameters;De.geometry=new CircleGeometry(Ve,Fe,Be,Je)}else console.warn("only support THREE.CircleGeometry")}setAngleHelperLength(Se,Be){const De=Be>=0?Math.max(Be,.001):Math.min(Be,-.001),Ve=this.getAngleHelper(Se);if(Ve instanceof Mesh&&Ve.geometry instanceof CircleGeometry){const{radius:Fe,thetaStart:Je}=Ve.geometry.parameters,Xe=Math.ceil(Math.abs(De)*(40/(2*Math.PI)));Ve.geometry=new CircleGeometry(Fe,Xe,Je,De)}else console.warn("only support THREE.CircleGeometry")}setTipsAngle(Se){var Be;const De=(Be=this.helperObject3D.angleTips)==null?void 0:Be.element;De&&(De.innerText=`${Se.toFixed(0)}°`)}setTipsPosition(Se){const Be=this.helperObject3D.angleTips;if(!Be)return;const De=Se.project(this.camera),{x:Ve,y:Fe,z:Je}=De;if(Je>1)return;const Xe=(Ve+1)/2*100+"%",Ke=(-Fe+1)/2*100+"%";Be.setLeftTop(Xe,Ke)}};var W$5=Object.defineProperty,X$1=($e,Se,Be)=>Se in $e?W$5($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,j$7=($e,Se,Be)=>(X$1($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let _$5=class extends B$4{constructor(...Se){super(...Se),j$7(this,"startInfo"),j$7(this,"name","RectangleScaleController")}enable(){this.helperObject3D.enable(),super.enable()}disable(){this.helperObject3D.disable(),super.disable()}show(){this.helperObject3D.show(),super.show()}hide(){this.helperObject3D.hide(),super.hide()}onApplyOriginObjectPosition(Se){this.isDragging||super.onApplyOriginObjectPosition(Se)}onApplyOriginObjectScale(Se){this.helperObject3D.applyHelperScaleMatrix4(Se.matrix,Se.origin)}getDragPlane(){const Se=new Plane,Be=this.helperObject3D.cornerPositions;if(Be.length!==0)return Be.length<3?Se.setFromNormalAndCoplanarPoint(this.originObject3D.getWorldDirection(new Vector3),Be[0]):Se.setFromCoplanarPoints(Be[0],Be[1],Be[2]),Se}dragStart(Se,Be){var De,Ve;(Ve=(De=this.helperObject3D).updatePoints)==null||Ve.call(De);const Fe=this.getDragPlane();if(!Fe)return this.dragEnd();this.startInfo={startPoint:{position:Be.position.clone(),direction:Be.direction},plane:Fe},this.hooks.emit("scaleStart"),this.render(),this.isDragging=!0}dragging(Se){if(!this.isDragging)return;const Be=u$b(this.camera,Se,this.container);if(!Be)return this.dragEnd();this.scale(Be)}scale(Se){var Be,De;if(!this.startInfo)return;const Ve=this.originObject3D,{startPoint:Fe,plane:Je}=this.startInfo,Xe=this.helperObject3D.cornerPositions;if(Xe.length<4)return this.dragEnd();const Ke=Se.ray.intersectPlane(Je,new Vector3);if(!Ke||u$o(Ke,this.camera.position))return;const Ye=new Vector3().addVectors(Xe[0],Xe[2]).divideScalar(2),{position:or,direction:sr}=Fe,cr=new Vector3().subVectors(Xe[1],Xe[0]),Br=new Vector3().subVectors(Xe[3],Xe[0]),tn=pn=>{const dn=new Vector3(0,0,0);if(!this.startInfo)return dn;const fn=(pn==="ew"?cr:Br).clone(),yn=or.clone().projectOnVector(fn),Sn=Ke.clone().projectOnVector(fn),gn=Ye.clone().projectOnVector(fn);if(Sn.equals(yn))return dn;if(pn==="ns"&&typeof this.startInfo.dragPointInCenterBottom!="boolean"){const Bn=new Vector3().subVectors(Sn,gn),kn=Bn.x<0&&fn.x>=0,Ln=Bn.y<0&&fn.y>=0,Pn=Bn.z<0&&fn.z>=0;this.startInfo.dragPointInCenterBottom=kn||Ln||Pn}if(pn==="ew"&&typeof this.startInfo.dragPointInCenterLeft!="boolean"){const Bn=new Vector3().subVectors(Sn,gn),kn=Bn.x<0&&fn.x>=0,Ln=Bn.y<0&&fn.y>=0,Pn=Bn.z<0&&fn.z>=0;this.startInfo.dragPointInCenterLeft=kn||Ln||Pn}const Cn=new Vector3().subVectors(Sn,yn),Mn=Cn.length();return Mn>.3?(console.warn("offset.length() > 0.3, skipped",Mn),dn):Cn},en=tn("ew"),an=tn("ns"),rn=()=>{const pn=en;this.helperObject3D.cornerPositions.forEach((dn,fn)=>{var yn;(yn=this.startInfo)!=null&&yn.dragPointInCenterLeft?(fn===0||fn===3)&&dn.add(pn):(fn===1||fn===2)&&dn.add(pn)})},on=()=>{const pn=an;this.helperObject3D.cornerPositions.forEach((dn,fn)=>{var yn;(yn=this.startInfo)!=null&&yn.dragPointInCenterBottom?(fn===0||fn===1)&&dn.add(pn):(fn===2||fn===3)&&dn.add(pn)})};switch(sr){case"ew":rn();break;case"ns":on();break;case"nesw":case"nwse":rn(),on()}const sn=new Vector3().subVectors(Xe[1],Xe[0]).length()/cr.length(),ln=new Vector3().subVectors(Xe[3],Xe[0]).length()/Br.length(),cn=new Vector3(sn,ln,1),hn=new Matrix4().scale(cn);Ve.isCSS3DObjectPlus&&Ve.applyScaleMatrix4?Ve.applyScaleMatrix4(hn):Ve.scale.applyMatrix4(hn),Fe.position.copy(Ke);const mn=new Vector3().addVectors(Xe[0],Xe[2]).divideScalar(2),An=new Vector3().subVectors(mn,Ye),xn=new Matrix4().setPosition(An);Ve.applyMatrix4(xn),(Be=this.helperObject3D.css3DInstance)==null||Be.css3DObject.applyMatrix4(xn),(De=this.helperObject3D.plane)==null||De.applyMatrix4(xn),this.internalHooks.emit("applyObjectScale",{matrix:hn}),this.internalHooks.emit("applyObjectPosition",{matrix:xn}),this.render()}dragEnd(){this.isDragging&&(this.startInfo=void 0,this.isDragging=!1,this.hooks.emit("scaleEnd"),this.render())}};var g$b=Object.defineProperty,c$e=($e,Se,Be)=>Se in $e?g$b($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,d$a=($e,Se,Be)=>(c$e($e,Se+"",Be),Be);let E$6=class extends _$5{constructor(...Se){super(...Se),d$a(this,"name","CSS3DScaleController"),this.addHTMLEventListener()}addHTMLEventListener(){this.helperObject3D.points.forEach(Se=>{if(!Se)return;const Be=Se.point,De=Je=>this.dragStart(Je,Se),Ve=this.dragging.bind(this),Fe=this.dragEnd.bind(this);Be.addEventListener("dragstart",De),Be.addEventListener("drag",Ve),Be.addEventListener("dragend",Fe)})}};var t$1=Object.defineProperty,l$a=($e,Se,Be)=>Se in $e?t$1($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,e$1=($e,Se,Be)=>(l$a($e,Se+"",Be),Be);let x$5=class extends B$4{constructor(...Se){super(...Se),e$1(this,"name","BoundingBoxController")}};var p$j=Object.defineProperty,h$8=($e,Se,Be)=>Se in $e?p$j($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,c$d=($e,Se,Be)=>(h$8($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let S$3=class extends f$l{constructor(Se,Be){super(Se,Be),c$d(this,"name","ScaleHelper"),c$d(this,"scaleMeshes",[]),c$d(this,"positions",[]),Be&&(this.positions=Be.positions)}initQuaternion(){this.quaternion.copy(this.originObject3D.quaternion)}initialPosition(Se){this.position.copy(this.originObject3D.position);const Be=typeof this.positions=="function"?this.positions():this.positions;Be&&(this.scaleMeshes=Be.map((De,Ve)=>{var Fe;const Je=(Fe=this.scaleMeshes[Ve])!=null?Fe:m$7();return Je.position.copy(De.handlePosition),Je.scalePosition=De,this.addIfNotExists(Je),Je}))}setScaleByCamera(Se){this.scaleMeshes.forEach(Be=>{Be.scale.setScalar(S$5(Se,Be.scalePosition.handlePosition.clone().applyMatrix4(this.matrixWorld)))})}};function m$7(){const $e=new Group$1;$e.name="ScaleHelperCube";const Se=.05,Be=new BoxGeometry(Se,Se,Se),De=new MeshBasicMaterial({color:16776960,transparent:!0,side:DoubleSide}),Ve=new MeshBasicMaterial({color:16776960,opacity:.4,depthTest:!1,depthWrite:!1,transparent:!0,side:DoubleSide}),Fe=new Mesh(Be,De),Je=new Mesh(Be,Ve);return Fe.name="ScaleHelperCube-front",Je.name="ScaleHelperCube-behind",Fe.renderOrder=11,Je.renderOrder=10,$e.add(Fe,Je),$e}var v$7=Object.defineProperty,p$i=($e,Se,Be)=>Se in $e?v$7($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,h$7=($e,Se,Be)=>(p$i($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let S$2=class extends B$4{constructor(...Se){super(...Se),h$7(this,"name","ScaleController"),h$7(this,"startInfo"),h$7(this,"dragStart",Ve=>{if(this.isDragging)return;this.isDragging=!0;const{intersect:Fe}=Ve,Je=this.camera.position;let Xe=Fe.object;Xe.scalePosition||(Xe=Fe.object.parent);const Ke=Xe.scalePosition.basePosition.clone(),Ye=Xe.scalePosition.handlePosition.clone().clone().sub(Ke).clone(),or=new Line3(Ke,Ke.clone().add(Ye.normalize().multiplyScalar(5)));or.applyMatrix4(this.helperObject3D.matrixWorld);const sr=new Raycaster(Je,Fe.point.clone().sub(Je)),cr=w$o({raycaster:sr,line:or});this.startInfo={line:or,scaleStartPoint:cr,draggingObject:Xe},this.helperObject3D.scaleMeshes.forEach(Br=>{Br.uuid!==Xe.uuid&&(Br.visible=!1)}),Xe.visible=!0,this.hooks.emit("scaleStart")}),h$7(this,"dragging",Ve=>{if(!this.isDragging||!this.startInfo)return;const Fe="touches"in Ve?Ve.touches[0].clientX:Ve.x,Je="touches"in Ve?Ve.touches[0].clientY:Ve.y,Xe=u$b(this.camera,{x:Fe,y:Je},this.container);return Xe?(this.scale(Xe),!1):this.dragEnd()}),h$7(this,"scale",Ve=>{var Fe,Je;if(!this.startInfo)return;const{line:Xe,scaleStartPoint:Ke,draggingObject:Ye}=this.startInfo,{scalePosition:or}=Ye,sr=w$o({raycaster:Ve,line:Xe,clampToLine:!1});sr.applyMatrix4(new Matrix4().getInverse(this.helperObject3D.matrixWorld.clone())),(Je=(Fe=this.config)==null?void 0:Fe.scaleCallback)==null||Je.call(Fe,{intersectPoint:sr,scalePosition:or,offset:sr.clone().sub(Ke)}),Ye.position.copy(sr.clone()),this.hooks.emit("scale",new Vector3(1,1,1))}),h$7(this,"dragEnd",()=>{this.isDragging&&(this.startInfo=void 0,this.isDragging=!1,this.helperObject3D.scaleMeshes.forEach(Ve=>{Ve.visible=!0}),this.internalHooks.emit("initialHelperPosition"),this.hooks.emit("scaleEnd"))});const Be=this.show.bind(this),De=this.hide.bind(this);this.domEvents.addEventListener(this.helperObject3D,"mousedown",this.dragStart),document.addEventListener("mousemove",this.dragging),document.addEventListener("mouseup",this.dragEnd),this.domEvents.addEventListener(this.helperObject3D,"touchstart",this.dragStart),document.addEventListener("touchmove",this.dragging),document.addEventListener("touchend",this.dragEnd),this.hooks.on("rotateStart",De),this.hooks.on("rotateEnd",Be),this.hooks.on("moveStart",De),this.hooks.on("moveEnd",Be),this.hooks.on("moveByMouseEnable",De),this.hooks.on("moveByMouseDisable",Be),this.disposers.push(()=>{this.domEvents.removeEventListener(this.helperObject3D,"mousedown",this.dragStart),document.removeEventListener("mousemove",this.dragging),document.removeEventListener("mouseup",this.dragEnd),this.domEvents.removeEventListener(this.helperObject3D,"touchstart",this.dragStart),document.removeEventListener("touchmove",this.dragging),document.removeEventListener("touchend",this.dragEnd),this.hooks.off("rotateStart",De),this.hooks.off("rotateEnd",Be),this.hooks.off("moveStart",De),this.hooks.off("moveEnd",Be),this.hooks.off("moveByMouseEnable",De),this.hooks.off("moveByMouseDisable",Be)})}initialHelperPosition(){this.helperObject3D.initialPosition();const Se=this;Se.offHoverListener&&Se.offHoverListener(),Se.offHoverListener=this.hoverListener(this.helperObject3D.scaleMeshes)}setScale(Se){var Be,De,Ve;let Fe=1,Je=1,Xe=1;typeof Se=="number"?(Fe=Se,Je=Se,Xe=Se):typeof Se=="object"&&(Fe=(Be=Se.x)!=null?Be:1,Je=(De=Se.y)!=null?De:1,Xe=(Ve=Se.z)!=null?Ve:1);const Ke=new Vector3(Fe,Je,Xe);this.hooks.emit("wantToScale",Ke)||(this.originObject3D.scale.copy(Ke),this.internalHooks.emit("setObjectScale",Ke),this.hooks.emit("scale",Ke),this.render())}};function n$9($e,Se){this._camera=$e||null,this._domElement=Se||document,this._raycaster=new Raycaster,this._selected=null,this._boundObjs={};var Be=this;this._$onClick=function(){Be._onClick.apply(Be,arguments)},this._$onDblClick=function(){Be._onDblClick.apply(Be,arguments)},this._$onMouseMove=function(){Be._onMouseMove.apply(Be,arguments)},this._$onMouseDown=function(){Be._onMouseDown.apply(Be,arguments)},this._$onMouseUp=function(){Be._onMouseUp.apply(Be,arguments)},this._$onTouchMove=function(){Be._onTouchMove.apply(Be,arguments)},this._$onTouchStart=function(){Be._onTouchStart.apply(Be,arguments)},this._$onTouchEnd=function(){Be._onTouchEnd.apply(Be,arguments)},this._$onContextmenu=function(){Be._onContextmenu.apply(Be,arguments)},this._domElement.addEventListener("click",this._$onClick,!1),this._domElement.addEventListener("dblclick",this._$onDblClick,!1),this._domElement.addEventListener("mousemove",this._$onMouseMove,!1),this._domElement.addEventListener("mousedown",this._$onMouseDown,!1),this._domElement.addEventListener("mouseup",this._$onMouseUp,!1),this._domElement.addEventListener("touchmove",this._$onTouchMove,!1),this._domElement.addEventListener("touchstart",this._$onTouchStart,!1),this._domElement.addEventListener("touchend",this._$onTouchEnd,!1),this._domElement.addEventListener("contextmenu",this._$onContextmenu,!1)}n$9.prototype.destroy=function(){this._domElement.removeEventListener("click",this._$onClick,!1),this._domElement.removeEventListener("dblclick",this._$onDblClick,!1),this._domElement.removeEventListener("mousemove",this._$onMouseMove,!1),this._domElement.removeEventListener("mousedown",this._$onMouseDown,!1),this._domElement.removeEventListener("mouseup",this._$onMouseUp,!1),this._domElement.removeEventListener("touchmove",this._$onTouchMove,!1),this._domElement.removeEventListener("touchstart",this._$onTouchStart,!1),this._domElement.removeEventListener("touchend",this._$onTouchEnd,!1),this._domElement.removeEventListener("contextmenu",this._$onContextmenu,!1)};n$9.eventNames=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu","touchstart","touchend"];n$9.prototype._getRelativeMouseXY=function($e){var Se=$e.target||$e.srcElement;Se.nodeType===3&&(Se=Se.parentNode);var Be={x:0,y:0},De=Se,Ve=getComputedStyle(De,null);Be.y+=parseInt(Ve.getPropertyValue("padding-top"),10),Be.x+=parseInt(Ve.getPropertyValue("padding-left"),10);do Be.x+=De.offsetLeft,Be.y+=De.offsetTop,Ve=getComputedStyle(De,null),Be.x+=parseInt(Ve.getPropertyValue("border-left-width"),10),Be.y+=parseInt(Ve.getPropertyValue("border-top-width"),10);while(De=De.offsetParent);var Fe={width:Se===window?window.innerWidth:Se.offsetWidth,height:Se===window?window.innerHeight:Se.offsetHeight};return{x:Number(($e.pageX-Be.x)/Fe.width)*2-1,y:-(($e.pageY-Be.y)/Fe.height)*2+1}};n$9.prototype._objectCtxInit=function($e){$e._3xDomEvent={}};n$9.prototype._objectCtxDeinit=function($e){delete $e._3xDomEvent};n$9.prototype._objectCtxIsInit=function($e){return!!$e._3xDomEvent};n$9.prototype._objectCtxGet=function($e){return $e._3xDomEvent};n$9.prototype.camera=function($e){return $e&&(this._camera=$e),this._camera};n$9.prototype.bind=function($e,Se,Be,De){console.assert(n$9.eventNames.indexOf(Se)!==-1,"not available events:"+Se),this._objectCtxIsInit($e)||this._objectCtxInit($e);var Ve=this._objectCtxGet($e);Ve[Se+"Handlers"]||(Ve[Se+"Handlers"]=[]),Ve[Se+"Handlers"].push({callback:Be,useCapture:De}),this._boundObjs[Se]===void 0&&(this._boundObjs[Se]=[]),this._boundObjs[Se].push($e)};n$9.prototype.addEventListener=n$9.prototype.bind;n$9.prototype.unbind=function($e,Se,Be,De){console.assert(n$9.eventNames.indexOf(Se)!==-1,"not available events:"+Se),this._objectCtxIsInit($e)||this._objectCtxInit($e);var Ve=this._objectCtxGet($e);Ve[Se+"Handlers"]||(Ve[Se+"Handlers"]=[]);for(var Fe=Ve[Se+"Handlers"],Je=0;Je<Fe.length;Je++){var Xe=Fe[Je];if(Be==Xe.callback&&De==Xe.useCapture){Fe.splice(Je,1);break}}var Ke=this._boundObjs[Se].indexOf($e);this._boundObjs[Se].splice(Ke,1)};n$9.prototype.removeEventListener=n$9.prototype.unbind;n$9.prototype._bound=function($e,Se){var Be=this._objectCtxGet(Se);return Be?!!Be[$e+"Handlers"]:!1};n$9.prototype._onMove=function($e,Se,Be,De){var Ve=this._boundObjs[$e];if(!(Ve===void 0||Ve.length===0)){var Fe=new Vector2;Fe.set(Se,Be),this._raycaster.setFromCamera(Fe,this._camera);var Je=this._raycaster.intersectObjects(Ve),Xe=this._selected;if(Je.length>0){var Ke,Ye,or,sr=Je[0],cr=sr.object;this._selected=cr,or=this._bound("mousemove",cr),Xe!=cr&&(Ke=this._bound("mouseover",cr),Ye=Xe&&this._bound("mouseout",Xe))}else Ye=Xe&&this._bound("mouseout",Xe),this._selected=null;or&&this._notify("mousemove",cr,De,sr),Ke&&this._notify("mouseover",cr,De,sr),Ye&&this._notify("mouseout",Xe,De,sr)}};n$9.prototype._onEvent=function($e,Se,Be,De){var Ve=this._boundObjs[$e];if(!(Ve===void 0||Ve.length===0)){var Fe=new Vector2;Fe.set(Se,Be),this._raycaster.setFromCamera(Fe,this._camera);var Je=this._raycaster.intersectObjects(Ve,!0);if(Je.length!==0){for(var Xe=Je[0],Ke=Xe.object,Ye=this._objectCtxGet(Ke),or=Ke.parent;typeof Ye>"u"&&or;)Ye=this._objectCtxGet(or),or=or.parent;Ye&&this._notify($e,Ke,De,Xe)}}};n$9.prototype._notify=function($e,Se,Be,De){var Ve=this._objectCtxGet(Se),Fe=Ve?Ve[$e+"Handlers"]:null;if(!Ve||!Fe||Fe.length===0){Se.parent&&this._notify($e,Se.parent,Be,De);return}for(var Fe=Ve[$e+"Handlers"],Je=0;Je<Fe.length;Je++){var Xe=Fe[Je],Ke=!0;Xe.callback({type:$e,target:Se,origDomEvent:Be,intersect:De,stopPropagation:function(){Ke=!1}}),Ke&&Xe.useCapture===!1&&Se.parent&&this._notify($e,Se.parent,Be,De)}};n$9.prototype._onMouseDown=function($e){return this._onMouseEvent("mousedown",$e)};n$9.prototype._onMouseUp=function($e){return this._onMouseEvent("mouseup",$e)};n$9.prototype._onMouseEvent=function($e,Se){var Be=this._getRelativeMouseXY(Se);this._onEvent($e,Be.x,Be.y,Se)};n$9.prototype._onMouseMove=function($e){var Se=this._getRelativeMouseXY($e);this._onMove("mousemove",Se.x,Se.y,$e),this._onMove("mouseover",Se.x,Se.y,$e),this._onMove("mouseout",Se.x,Se.y,$e)};n$9.prototype._onClick=function($e){this._onMouseEvent("click",$e)};n$9.prototype._onDblClick=function($e){this._onMouseEvent("dblclick",$e)};n$9.prototype._onContextmenu=function($e){this._onMouseEvent("contextmenu",$e)};n$9.prototype._onTouchStart=function($e){return this._onTouchEvent("touchstart",$e)};n$9.prototype._onTouchEnd=function($e){return this._onTouchEvent("touchend",$e)};n$9.prototype._onTouchMove=function($e){if($e.touches.length==1){var Se=Number($e.touches[0].pageX/window.innerWidth)*2-1,Be=-($e.touches[0].pageY/window.innerHeight)*2+1;this._onMove("mousemove",Se,Be,$e),this._onMove("mouseover",Se,Be,$e),this._onMove("mouseout",Se,Be,$e)}};n$9.prototype._onTouchEvent=function($e,Se){var Be=Se.touches;if(Be.length==0&&(Be=Se.changedTouches),Be.length==1){var De=Number(Be[0].pageX/window.innerWidth)*2-1,Ve=-(Be[0].pageY/window.innerHeight)*2+1;this._onEvent($e,De,Ve,Se)}};var I$1=Object.defineProperty,y$7=Object.getOwnPropertySymbols,W$4=Object.prototype.hasOwnProperty,j$6=Object.prototype.propertyIsEnumerable,g$a=($e,Se,Be)=>Se in $e?I$1($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,p$h=($e,Se)=>{for(var Be in Se||(Se={}))W$4.call(Se,Be)&&g$a($e,Be,Se[Be]);if(y$7)for(var Be of y$7(Se))j$6.call(Se,Be)&&g$a($e,Be,Se[Be]);return $e},c$c=($e,Se,Be)=>(g$a($e,typeof Se!="symbol"?Se+"":Se,Be),Be),w$5=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const M$5="Object3DHelperPlugin",O$2=M$5,Z$1=()=>{console.error(`${O$2} is disposed`)},ee=()=>{console.warn(`${O$2} is disabled`)},re=()=>{console.error(`${O$2} is disabled`)};class Tr extends F$i{constructor(Se){super(Se),c$c(this,"name",M$5),c$c(this,"state",{visible:!0,enabled:!0,disposed:!1}),c$c(this,"objectHelperMap",new Map),c$c(this,"css3DObjectParentMap",new Map),c$c(this,"css3DObjectModeMap",new Map),c$c(this,"css3DRender"),this.five=Se,this.css3DRender=new y$u(this.five.scene),console.warn("Object3DHelper: 使用此插件，需要在初始化five时，设置five参数: { backgroundAlpha: 0, backgroundColor: 0x000000 }"),Object.assign(window,{[`__${M$5.toUpperCase()}_DEBUG__`]:this})}show(Se){return w$5(this,null,function*(){this.setState({visible:!0},Se)})}hide(Se){return w$5(this,null,function*(){this.setState({visible:!1},Se)})}enable(Se){this.setState({enabled:!0},Se)}disable(Se){this.setState({enabled:!1},Se)}dispose(){this.setState({disposed:!0})}setState(Se,Be){if(this.state.disposed)return Z$1();if(!this.state.enabled&&Se.enabled!==!0&&Se.disposed!==!0)return re();const De=p$h({},this.state);this.state=p$h(p$h({},this.state),Se),Se.disposed!==void 0&&Se.disposed!==De.disposed&&Se.disposed&&this.handleDispose(),Se.visible!==void 0&&Se.visible!==De.visible&&this.handleVisible(Se.visible),Se.enabled!==void 0&&Se.enabled!==De.enabled&&this.handleEnable(Se.enabled),this.hooks.emit("stateChange",{state:this.state,prevState:De})}getObject3DHelper(Se){return this.objectHelperMap.get(Se)}addObject3DHelper(Se,Be={}){var De;if(!Se){console.error("Object3D is undefined");return}if(this.objectHelperMap.has(Se)){console.warn(`Object3DHelperPlugin: object3D ${Se.name} is already has helper`);return}const Ve=new L$6,Fe=[],Je=(De=this.five.getElement())==null?void 0:De.parentElement,Xe=this.five.camera,Ke=p$h(p$h({},{moveHelper:!0,rotateHelper:!0,scaleHelper:!0,boundingBoxHelper:!1,positionFrom:"objectPosition"}),Be),{moveHelper:Ye,rotateHelper:or,scaleHelper:sr,boundingBoxHelper:cr}=Ke,Br=Ve.hooks,tn=new E$v,en=new n$9(this.five.camera,this.five.getElement()),an=rn=>{if(rn)return typeof rn=="boolean"?rn:rn.enable};if(an(Ye)){const rn=p$h(p$h({},this.getConfig(Ke.moveHelper)),Ke),on=new D$8(Se,p$h({},rn)),sn=new F$2(this.five,en,w$7,Se,on,rn,Br,tn);Ve.addControllers({moveController:sn.helperController}),Fe.push(()=>sn.dispose())}if(an(or)){const rn=p$h(p$h({},this.getConfig(Ke.rotateHelper)),Ke),on=new D$7(Se,p$h({container:Je},rn)),sn=new F$2(this.five,en,P$5,Se,on,rn,Br,tn);Ve.addControllers({rotateController:sn.helperController}),Fe.push(()=>sn.dispose())}if(an(cr)){const rn=new d$d(Se),on=new F$2(this.five,en,x$5,Se,rn,void 0,Br,tn);Ve.addControllers({boundingBoxController:on.helperController})}if(an(sr))if(Se.isCSS3DObject&&Je){const rn=new v$a(Se,Je,Xe,this.five.scene),on=new F$2(this.five,en,E$6,Se,rn,void 0,Br,tn);Ve.addControllers({scaleController:on.helperController}),Fe.push(()=>on.dispose()),M$u(this.five).then(()=>{var sn,ln;if(Se.isCSS3DObjectPlus){const cn=Se;if(!cn||cn.mode!=="front")return;const hn=(sn=this.css3DRender.behindModeCSS3DRenderer.wrapper)!=null?sn:d$D(this.five);hn&&(this.css3DObjectParentMap.set(cn,cn.parent),cn.removeFromParent(),this.css3DRender.behindModeCSS3DRenderer.setWrapper(hn),(ln=this.css3DRender.getBehindCSS3DObjectGroup())==null||ln.add(cn),this.css3DRender.render(this.five.camera))}else Se.isCSS3DObject&&(this.css3DObjectModeMap.set(Se,Se.mode),Se.mode="behind")})}else{const rn=p$h(p$h({},this.getConfig(Ke.scaleHelper)),Ke),on=new S$3(Se,rn),sn=new F$2(this.five,en,S$2,Se,on,rn,Br,tn);Ve.addControllers({scaleController:sn.helperController}),Fe.push(()=>sn.dispose())}return this.objectHelperMap.set(Se,{helper:Ve,disposers:Fe}),Ve.controllers}removeObject3DHelper(Se){if(!this.objectHelperMap.has(Se))return;const{helper:Be,disposers:De}=this.objectHelperMap.get(Se);if(Be){if(Se.isCSS3DObjectPlus){const Ve=Se,Fe=this.css3DObjectParentMap.get(Ve);Fe&&Fe.add(Ve),this.css3DRender.render(this.five.camera)}else if(Se.isCSS3DObject){const Ve=this.css3DObjectModeMap.get(Se);Se.mode=Ve}this.objectHelperMap.delete(Se),Be.dispose(),De?.forEach(Ve=>Ve?.())}}handleEnable(Se,Be=!0){Se?(this.everyHelperDo(De=>De.enable()),this.hooks.emit("enable",{userAction:Be})):(this.everyHelperDo(De=>De.disable()),this.hooks.emit("disable",{userAction:Be})),this.state.enabled=Se}handleVisible(Se,Be=!0){Se?(this.everyHelperDo(De=>De.show()),this.actionIfStateIsEnabled(()=>this.hooks.emit("show",{userAction:Be}))):(this.everyHelperDo(De=>De.hide()),this.actionIfStateIsEnabled(()=>this.hooks.emit("hide",{userAction:Be}))),this.state.visible=Se}handleDispose(){this.everyHelperDo((Se,Be)=>{Se.dispose(),Be?.forEach(De=>De?.())})}everyHelperDo(Se){this.objectHelperMap.forEach(({helper:Be,disposers:De})=>{Be&&Se(Be,De)})}actionIfStateIsEnabled(Se,Be){if(this.state.enabled)return Se();Be!=null&&Be.warnLog&&ee()}getConfig(Se){if(Se&&typeof Se!="boolean"&&Se.enable)return Se}}var r$8=Object.defineProperty,n$8=($e,Se,Be)=>Se in $e?r$8($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,t=($e,Se,Be)=>(n$8($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let f$e=class{constructor(){t(this,"five"),t(this,"_cursor"),t(this,"_pointSelector"),t(this,"_fiveDomEvents"),t(this,"_object3DHelper"),t(this,"inited",!1),t(this,"init",Se=>{this.inited=!0,this.five=Se,this._cursor=void 0,this._pointSelector=void 0,this._fiveDomEvents=void 0,this._object3DHelper=void 0})}get cursor(){if(!this.inited)throw new Error("Global not inited");return this._cursor?this._cursor:(this._cursor=new B$i(this.five.getElement()),this._cursor)}get pointSelector(){if(!this.inited)throw new Error("Global not inited");return this._pointSelector?this._pointSelector:(this._pointSelector=new se$3(this.five,{mode:"cursor"}),this._pointSelector)}get fiveDomEvents(){if(!this.inited)throw new Error("Global not inited");return this._fiveDomEvents?this._fiveDomEvents:(this._fiveDomEvents=new Q$a(this.five,{noEmitWhenNotInScene:!0}),this._fiveDomEvents)}get object3DHelper(){if(!this.inited)throw new Error("Global not inited");return this._object3DHelper?this._object3DHelper:(this._object3DHelper=new Tr(this.five),this._object3DHelper)}};const v$6=new f$e;window.globalModules=v$6;function u$9($e,Se){return $e?Se($e)?$e:$e.parent?u$9($e.parent,Se):null:null}function f$d($e){const Se=[...$e];if($e.length<3)return $e;const Be=$e[$e.length-1],De=$e[0];return Be.equals(De)||Se.push(De),Se}var M$4=Object.defineProperty,E$5=Object.defineProperties,b$6=Object.getOwnPropertyDescriptors,a$7=Object.getOwnPropertySymbols,g$9=Object.prototype.hasOwnProperty,f$c=Object.prototype.propertyIsEnumerable,p$g=($e,Se,Be)=>Se in $e?M$4($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$7=($e,Se)=>{for(var Be in Se||(Se={}))g$9.call(Se,Be)&&p$g($e,Be,Se[Be]);if(a$7)for(var Be of a$7(Se))f$c.call(Se,Be)&&p$g($e,Be,Se[Be]);return $e},c$b=($e,Se)=>E$5($e,b$6(Se)),S$1=($e,Se)=>{var Be={};for(var De in $e)g$9.call($e,De)&&Se.indexOf(De)<0&&(Be[De]=$e[De]);if($e!=null&&a$7)for(var De of a$7($e))Se.indexOf(De)<0&&f$c.call($e,De)&&(Be[De]=$e[De]);return Be},h$6=($e,Se,Be)=>(p$g($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let P$4=class extends c$C{constructor(Se){super(),h$6(this,"name","PolylineBaseMesh"),h$6(this,"lines",[]),h$6(this,"withDots"),h$6(this,"paramsStyle");const Be=Se,{withDots:De,points:Ve}=Be,Fe=S$1(Be,["withDots","points"]);this.withDots=De??!0,Ve&&this.setPoints(Ve),Fe&&this.setStyle(Fe)}get style(){var Se;return{lineColor:this.lineColor,lineWidth:this.lineWidth,opacity:this.opacity,dashed:this.dashed,occlusionVisibility:this.occlusionVisibility,occlusionMode:this.occlusionMode,lengthEnable:(Se=this.paramsStyle)==null?void 0:Se.lengthEnable}}get opacity(){var Se,Be,De;return(De=(Se=this.lines[0])==null?void 0:Se.lineOpacity)!=null?De:(Be=this.paramsStyle)==null?void 0:Be.lineOpacity}get lineColor(){var Se,Be,De;return(De=(Se=this.lines[0])==null?void 0:Se.color)!=null?De:(Be=this.paramsStyle)!=null&&Be.lineColor?new Color(this.paramsStyle.lineColor):void 0}get lineWidth(){var Se,Be,De;return(De=(Se=this.lines[0])==null?void 0:Se.lineWidth)!=null?De:(Be=this.paramsStyle)==null?void 0:Be.lineWidth}get dashed(){var Se,Be,De;return(De=(Se=this.lines[0])==null?void 0:Se.dashed)!=null?De:(Be=this.paramsStyle)==null?void 0:Be.dashed}get occlusionVisibility(){var Se,Be,De;return(De=(Se=this.lines[0])==null?void 0:Se.occlusionVisibility)!=null?De:(Be=this.paramsStyle)==null?void 0:Be.occlusionVisibility}get occlusionMode(){var Se,Be,De;return(De=(Se=this.lines[0])==null?void 0:Se.occlusionMode)!=null?De:(Be=this.paramsStyle)==null?void 0:Be.occlusionMode}get points(){var Se,Be,De;return this.lines.map(Ve=>Ve.points[0]).concat((De=(Be=this.lines)==null?void 0:Be[((Se=this.lines)==null?void 0:Se.length)-1])==null?void 0:De.points[1]).filter(Boolean)}setPoints(Se,Be={closed:!1}){let De=Se.map(t$j);Be.closed&&(De=f$d(De)),De.forEach((Ve,Fe)=>{var Je;const Xe=De[Fe+1];if(Fe!==0&&Xe===void 0)return;const Ke=(Je=this.lines[Fe])!=null?Je:(()=>{const Ye=new z$g(c$b(r$7({},this.style),{pointVisibility:this.withDots?{startPoint:Fe===0,endPoint:!0}:!1}));return this.lines[Fe]=Ye,this.add(Ye),Ye})();Ke.setStyle(this.style),Ke.setPoints([Ve,Xe])}),De.length===0?(this.lines.forEach(Ve=>Ve.removeFromParent()),this.lines=[]):De.length===1||this.lines.length>De.length-1&&this.lines.splice(De.length-1).forEach(Ve=>Ve.removeFromParent())}setStyle(Se){this.paramsStyle=r$7(r$7({},this.paramsStyle),Se),this.lines.forEach(Be=>Be.setStyle(this.paramsStyle))}highlight(){this.lines.forEach(Se=>Se.highlight())}unhighlight(){this.lines.forEach(Se=>Se.unhighlight())}},j$5=class extends P$4{constructor(...Se){super(c$b(r$7({},Se[0]),{withDots:!1})),h$6(this,"name","PolylineMesh")}},x$4=class extends P$4{constructor(...Se){super(c$b(r$7({},Se[0]),{withDots:!0})),h$6(this,"name","PolylineWithDotsMesh")}};var w$4=Object.defineProperty,v$5=Object.defineProperties,E$4=Object.getOwnPropertyDescriptors,g$8=Object.getOwnPropertySymbols,b$5=Object.prototype.hasOwnProperty,D$4=Object.prototype.propertyIsEnumerable,c$a=($e,Se,Be)=>Se in $e?w$4($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,l$9=($e,Se)=>{for(var Be in Se||(Se={}))b$5.call(Se,Be)&&c$a($e,Be,Se[Be]);if(g$8)for(var Be of g$8(Se))D$4.call(Se,Be)&&c$a($e,Be,Se[Be]);return $e},d$9=($e,Se)=>v$5($e,E$4(Se)),r$6=($e,Se,Be)=>(c$a($e,typeof Se!="symbol"?Se+"":Se,Be),Be);const p$f=new Map;let M$3=class Up extends c$C{constructor(Se,Be){var De,Ve;super(),r$6(this,"name","Sculpt"),r$6(this,"isSculptObject",!0),r$6(this,"draggable"),r$6(this,"selected"),r$6(this,"config"),r$6(this,"on",(Fe,Je,Xe)=>p.modules.fiveDomEvents.addEventListener(this,Fe,Je,Xe)),r$6(this,"off",(...Fe)=>p.modules.fiveDomEvents.removeEventListener(this,...Fe)),r$6(this,"applyObjectMatrixWorld",(Fe,Je)=>{const Xe=Je??this;return Xe.updateMatrixWorld(),a$x(Xe,Fe)}),r$6(this,"applyObjectReversalMatrixWorld",(Fe,Je)=>{const Xe=Je??this;return Xe.updateMatrixWorld(),e$g(Xe,Fe)}),Se!=null&&Se.id&&(this.uuid=Se.id),this.config=l$9({defaultAction:!0,occlusionVisibility:!0,occlusionMode:"translucence"},Be),Se&&(i$w((De=this.config)==null?void 0:De.occlusionMode)&&(Se.style=d$9(l$9({},Se.style),{occlusionMode:this.config.occlusionMode})),i$w((Ve=this.config)==null?void 0:Ve.occlusionVisibility)&&(Se.style=d$9(l$9({},Se.style),{occlusionVisibility:this.config.occlusionVisibility}))),K$e("esc",()=>{this.stopCreating()}),this.config.defaultAction&&(K$e("backspace, delete",()=>{this.selected&&this.delete()}),this.on("click",()=>{var Fe;this.editing||(this.select({only:!0}),this.editor.enable(),(Fe=this.parent)==null||Fe.children.forEach(Je=>{var Xe;Je instanceof Up&&Je!==this&&((Xe=Je._editor)==null||Xe.disable())}))}),K$e("esc",()=>{this.selected&&this.unselect()}))}get editing(){return this.pointSelector.enabled}get baseData(){return{id:this.uuid,type:this.type}}get pointSelector(){return p.modules.pointSelector}undo(){throw new Error("Method not implemented.")}redo(){throw new Error("Method not implemented.")}canUndo(){throw new Error("Method not implemented.")}canRedo(){throw new Error("Method not implemented.")}stopCreating(){p.modules.pointSelector.disable()}delete(){var Se;this.stopCreating(),this.removeFromParent(),this.off(),(Se=this.editor)==null||Se.disable()}select(Se={only:!1}){if(this.selected)return;this.selected=!0,this.highlight(),p$f.has(this.parent.uuid)||p$f.set(this.parent.uuid,[]);const Be=p$f.get(this.parent.uuid);Be.push(this),Se.only&&Be?.forEach(De=>{De!==this&&De.unselect()})}unselect(){var Se;this.selected&&(this.selected=!1,this.unhighlight(),(Se=this._editor)==null||Se.disable())}highlight(){}unhighlight(){}showDeleteButton(Se,Be){p.modules.cursor.showDeleteButton({clientX:Se,clientY:Be,container:document.body,onClick:()=>this.delete()}),p.modules.five.once("cameraUpdate",()=>{p.modules.cursor.removeDeleteButton()})}};var b$4=Object.defineProperty,l$8=Object.getOwnPropertySymbols,h$5=Object.prototype.hasOwnProperty,j$4=Object.prototype.propertyIsEnumerable,c$9=($e,Se,Be)=>Se in $e?b$4($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,n$7=($e,Se)=>{for(var Be in Se||(Se={}))h$5.call(Se,Be)&&c$9($e,Be,Se[Be]);if(l$8)for(var Be of l$8(Se))j$4.call(Se,Be)&&c$9($e,Be,Se[Be]);return $e},r$5=($e,Se,Be)=>(c$9($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let O$1=class extends c$C{constructor(Se){super(),r$5(this,"hooks",new E$v),r$5(this,"originObject"),this.originObject=Se}enable(){this.originObject.add(this)}disable(){this.originObject.remove(this)}},u$8=class extends O$1{constructor(Se,Be){super(Se),r$5(this,"objectHelperConfig"),r$5(this,"onObjectUpdate",()=>{this.hooks.emit("objectUpdate")}),this.objectHelperConfig=Be}get helper(){var Se;return(Se=p.modules.object3DHelper.getObject3DHelper(this.originObject))==null?void 0:Se.helper}enable(){super.enable();const Se=typeof this.objectHelperConfig=="function"?this.objectHelperConfig():this.objectHelperConfig;p.modules.object3DHelper.addObject3DHelper(this.originObject,n$7({positionFrom:"boundingBox"},Se));const Be=p.modules.object3DHelper.getObject3DHelper(this.originObject).helper;Be.hooks.on("move",this.onObjectUpdate),Be.hooks.on("rotate",this.onObjectUpdate),Be.hooks.on("scale",this.onObjectUpdate)}disable(){var Se,Be,De;super.disable(),(Se=this.helper)==null||Se.hooks.off("move",this.onObjectUpdate),(Be=this.helper)==null||Be.hooks.off("rotate",this.onObjectUpdate),(De=this.helper)==null||De.hooks.off("scale",this.onObjectUpdate),p.modules.object3DHelper.removeObject3DHelper(this.originObject)}initialHelperMatrix(){var Se;(Se=this.helper)==null||Se.initialHelperMatrix()}};var p$e=Object.defineProperty,g$7=($e,Se,Be)=>Se in $e?p$e($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,o$4=($e,Se,Be)=>(g$7($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let l$7=class extends O$1{constructor(Se){super(Se),o$4(this,"draggingPoints",[]),o$4(this,"onDragstart",Be=>{const De=Be.target;this.draggingPoints=this.pointMeshes.filter(Ve=>Ve.position.equals(De.position))}),o$4(this,"onDragend",Be=>{this.draggingPoints=[]})}get pointMeshes(){return this.children.filter(Se=>Se instanceof ot$3)}get pointHandles(){return this.children}enable(){super.enable(),this.points.filter(i$w).forEach(Se=>{const Be=new ot$3;Be.visible=!1,Be.position.copy(Se),Be.draggable=!0,p.modules.fiveDomEvents.addEventListener(Be,"drag",this.onDrag),p.modules.fiveDomEvents.addEventListener(Be,"dragstart",this.onDragstart),p.modules.fiveDomEvents.addEventListener(Be,"dragend",this.onDragend),this.add(Be)})}disable(){super.disable(),this.removeChildren()}},H$5=class extends l$7{constructor(Se){super(Se),o$4(this,"onDrag",Be=>{if(!this.draggingPoints||this.draggingPoints.length===0)return;const De=w$p(p.modules.five,Be.raycaster);this.draggingPoints.forEach(Ve=>Ve.position.copy(De.point)),this.originObject.lineMesh.setPoints(this.pointMeshes.map(Ve=>Ve.position))})}get points(){return this.originObject.lineMesh.points}};var n$6=Object.defineProperty,p$d=($e,Se,Be)=>Se in $e?n$6($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$4=($e,Se,Be)=>(p$d($e,Se+"",Be),Be);let y$6=class extends l$7{constructor(Se){super(Se),r$4(this,"onDrag",Be=>{if(!this.draggingPoints||this.draggingPoints.length===0)return;const De=w$p(p.modules.five,Be.raycaster);this.draggingPoints.forEach(Ve=>Ve.position.copy(De.point)),this.originObject.polyLineMesh.setPoints(this.pointMeshes.map(Ve=>Ve.position))})}get points(){return this.originObject.polyLineMesh.points}};function a$6($e){return Array.isArray($e)?$e.map(Se=>[Se.x,Se.y,Se.z]):[$e.x,$e.y,$e.z]}var A$4=Object.defineProperty,D$3=Object.defineProperties,T$3=Object.getOwnPropertyDescriptors,R$2=Object.getOwnPropertySymbols,F$1=Object.prototype.hasOwnProperty,k$1=Object.prototype.propertyIsEnumerable,v$4=($e,Se,Be)=>Se in $e?A$4($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,p$c=($e,Se)=>{for(var Be in Se||(Se={}))F$1.call(Se,Be)&&v$4($e,Be,Se[Be]);if(R$2)for(var Be of R$2(Se))k$1.call(Se,Be)&&v$4($e,Be,Se[Be]);return $e},M$2=($e,Se)=>D$3($e,T$3(Se)),f$b=($e,Se,Be)=>(v$4($e,typeof Se!="symbol"?Se+"":Se,Be),Be),E$3=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class $ extends M$3{constructor(Se,Be){super(Se,Be),f$b(this,"type","Polyline"),f$b(this,"polyLineMesh"),f$b(this,"_editor"),f$b(this,"creatingObject"),Se&&(this.polyLineMesh=new x$4(p$c(p$c({},Se.style),Se)),this.add(this.polyLineMesh))}get editor(){return this._editor||(this._editor=new y$6(this)),this._editor}get data(){return M$2(p$c({},this.baseData),{points:a$6(this.applyObjectMatrixWorld(this.polyLineMesh.points)),style:{lineColor:new Color(this.polyLineMesh.lineColor).getHex(),lineWidth:this.polyLineMesh.lineWidth,dashed:this.polyLineMesh.dashed}})}setData(Se){Se.points&&this.polyLineMesh.setPoints(this.applyObjectReversalMatrixWorld(Se.points.map(t$j))),this.polyLineMesh.setStyle(Se.style)}highlight(){var Se;(Se=this.polyLineMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.polyLineMesh)==null||Se.unhighlight()}canUndo(){var Se;(Se=this.creatingObject)==null||Se.canUndo()}canRedo(){var Se;(Se=this.creatingObject)==null||Se.canRedo()}undo(){var Se;(Se=this.creatingObject)==null||Se.undo()}redo(){var Se;(Se=this.creatingObject)==null||Se.redo()}create(Se){return E$3(this,null,function*(){this.removeChildren();const Be=new x$4(Se);this.polyLineMesh=Be,this.add(this.polyLineMesh),this.creatingObject=q$1(Be,this.pointSelector,Se),yield this.creatingObject.finished,this.config.defaultAction&&this.editor.enable()})}}function q$1($e,Se,Be){var De;const Ve=$e.parent;if(!Ve)return;const{promise:Fe,resolve:Je,reject:Xe}=i$d(),Ke=(De=Be?.limit)!=null?De:"none",Ye=new j$5($e.style);Ve.add(Ye);const or=new j$5(M$2(p$c({},$e.style),{dashed:!0,lengthEnable:!1}));Ve.add(or),Se.enable();const sr=[];let cr,Br,tn;const en=[],an=()=>sr.length>0,rn=()=>en.length>0,on=()=>{an()&&(en.push(sr.pop()),$e.setPoints(sr),cn(tn),Se.pointSelectorHelper.magnifier.render())},sn=()=>{rn()&&(sr.push(en.pop()),$e.setPoints(sr),cn(tn),Se.pointSelectorHelper.magnifier.render())},ln=hn=>{en.length=0;const mn=sr.length===0?hn.point:cr.clone();sr.push(mn),$e.setPoints(sr)},cn=hn=>{const mn=()=>{Ye.setPoints([]),or.setPoints([]),cr=null};if(!hn||(tn=hn,!(sr!=null&&sr.length)))return mn();const An=sr.at(-1).clone();Ke==="none"?(cr=hn.point,Ye.setPoints([An,cr])):Ke==="xoz"?(Br=Br??new Plane().setFromNormalAndCoplanarPoint(new Vector3(0,1,0),sr[0]),Se.plane=Br,cr=Br.projectPoint(hn.point,new Vector3),Ye.setPoints([An,cr]),or.setPoints([cr,hn.point])):Ke==="y"&&(sr.length===1?(cr=hn.point,Ye.setPoints([An,cr])):(Br=Br??new Plane().setFromCoplanarPoints(sr[0],sr[1],new Vector3(0,1,0).add(sr[0])),Se.plane=Br,cr=Br.projectPoint(hn.point,new Vector3),Ye.setPoints([An,cr]),or.setPoints([cr,hn.point])))};return Se.on("select",ln),Se.on("intersectionUpdate",cn),Se.on("disable",()=>{if(Se.off("select",ln),Se.off("intersectionUpdate",cn),Se.plane=null,Ve.remove(Ye),Ve.remove(or),sr.length<2)return Ve.remove($e),Xe(new Error("Cancelled"));Je()}),{finished:Fe,canUndo:an,canRedo:rn,undo:on,redo:sn}}var a$5=Object.defineProperty,n$5=($e,Se,Be)=>Se in $e?a$5($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,o$3=($e,Se,Be)=>(n$5($e,Se+"",Be),Be);let f$a=class extends O$1{constructor(Se){super(Se),o$3(this,"onDrag",Be=>{var De;const Ve=w$p(p.modules.five,Be.raycaster);(De=this.originObject.pointMesh)==null||De.position.copy(Ve.point)})}enable(){super.enable(),this.originObject.draggable=!0,this.originObject.on("drag",this.onDrag)}disable(){super.disable(),this.originObject.draggable=!1,this.originObject.off("drag",this.onDrag)}};var b$3=Object.defineProperty,g$6=Object.defineProperties,M$1=Object.getOwnPropertyDescriptors,d$8=Object.getOwnPropertySymbols,P$3=Object.prototype.hasOwnProperty,v$3=Object.prototype.propertyIsEnumerable,c$8=($e,Se,Be)=>Se in $e?b$3($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,f$9=($e,Se)=>{for(var Be in Se||(Se={}))P$3.call(Se,Be)&&c$8($e,Be,Se[Be]);if(d$8)for(var Be of d$8(Se))v$3.call(Se,Be)&&c$8($e,Be,Se[Be]);return $e},m$6=($e,Se)=>g$6($e,M$1(Se)),p$b=($e,Se,Be)=>(c$8($e,typeof Se!="symbol"?Se+"":Se,Be),Be),y$5=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});let B$3=class extends M$3{constructor(Se,Be){super(Se,Be),p$b(this,"type","Point"),p$b(this,"pointMesh"),p$b(this,"_editor"),Se&&(this.pointMesh=new ot$3(f$9(f$9({},Se.style),Se)),this.add(this.pointMesh))}get editor(){return this._editor||(this._editor=new f$a(this)),this._editor}get data(){return m$6(f$9({},this.baseData),{point:a$6(this.applyObjectMatrixWorld(this.pointMesh.position)),style:{color:this.pointMesh.color.getHex(),size:this.pointMesh.size}})}setData(Se){Se.point&&this.pointMesh.position.copy(t$j(Se.point)),this.pointMesh.setStyle(Se.style)}highlight(){var Se;(Se=this.pointMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.pointMesh)==null||Se.unhighlight()}setStyle(Se){this.pointMesh.setStyle(Se)}create(Se){return y$5(this,null,function*(){this.pointMesh&&this.remove(this.pointMesh),this.add(this.pointMesh=new ot$3(Se)),yield U$2(this.pointMesh,this.pointSelector),this.config.defaultAction&&this.editor.enable()})}};function U$2($e,Se){return new Promise((Be,De)=>{Se.enable(),$e.visible=!1;const Ve=Ke=>{Ke&&($e.visible=!0,$e.position.copy(Ke.point))},Fe=Ke=>{Ke&&($e.visible=!0,$e.position.copy(Ke.point),Je())},Je=()=>{Se.off("select",Fe),Se.off("disable",Xe),Se.off("intersectionUpdate",Ve),Se.disable(),Be()},Xe=()=>{Se.off("select",Fe),Se.off("disable",Xe),Se.off("intersectionUpdate",Ve),$e.removeFromParent(),De(new Error("Cancelled"))};Se.on("intersectionUpdate",Ve),Se.on("disable",Xe),Se.once("select",Fe)})}var p$a=Object.defineProperty,f$8=Object.defineProperties,P$2=Object.getOwnPropertyDescriptors,l$6=Object.getOwnPropertySymbols,d$7=Object.prototype.hasOwnProperty,c$7=Object.prototype.propertyIsEnumerable,o$2=($e,Se,Be)=>Se in $e?p$a($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,h$4=($e,Se)=>{for(var Be in Se||(Se={}))d$7.call(Se,Be)&&o$2($e,Be,Se[Be]);if(l$6)for(var Be of l$6(Se))c$7.call(Se,Be)&&o$2($e,Be,Se[Be]);return $e},r$3=($e,Se)=>f$8($e,P$2(Se)),y$4=($e,Se)=>{var Be={};for(var De in $e)d$7.call($e,De)&&Se.indexOf(De)<0&&(Be[De]=$e[De]);if($e!=null&&l$6)for(var De of l$6($e))Se.indexOf(De)<0&&c$7.call($e,De)&&(Be[De]=$e[De]);return Be},g$5=($e,Se,Be)=>(o$2($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let m$5=class extends j$i{constructor(Se){const Be=Se??{},{points:De}=Be,Ve=y$4(Be,["points"]);super(),g$5(this,"name","PolygonWithEdgeMesh"),g$5(this,"line",new j$5),De&&this.setPoints(De),Ve&&this.setStyle(Ve)}get style(){return r$3(h$4({},super.style),{lineWidth:this.lineWidth,lineColor:this.lineColor})}get lineWidth(){return this.line.lineWidth}get lineColor(){return this.line.lineColor}raycast(Se,Be){return this.children.forEach(De=>{c$L(De,Se,Be,!0)}),!1}setPoints(Se,Be){super.setPoints(Se,h$4({closed:!0},Be)),this.points&&(this.line.setPoints(this.points,h$4({closed:!0},Be)),this.addIfNotExists(this.line))}setStyle(Se){super.setStyle(Se),Se.lineOpacity!==void 0?this.line.setStyle(r$3(h$4({},Se),{lineOpacity:Se.lineOpacity})):this.line.setStyle(Se),this.needsRender=!0}highlight(){super.highlight(),this.line.highlight()}unhighlight(){super.unhighlight(),this.line.unhighlight()}};var a$4=Object.defineProperty,h$3=($e,Se,Be)=>Se in $e?a$4($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$2=($e,Se,Be)=>(h$3($e,Se+"",Be),Be);class M extends m$5{constructor(){super(...arguments),r$2(this,"name","AreaMesh")}}var a$3=Object.defineProperty,c$6=($e,Se,Be)=>Se in $e?a$3($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,r$1=($e,Se,Be)=>(c$6($e,Se+"",Be),Be);let u$7=class extends l$7{constructor(Se){super(Se),r$1(this,"onDrag",Be=>{if(!this.draggingPoints||this.draggingPoints.length===0)return;const De=w$p(p.modules.five,Be.raycaster),Ve=this.originObject.areaMesh.projectPoint(De.point);this.draggingPoints.forEach(Fe=>Fe.position.copy(Ve)),this.originObject.areaMesh.setPoints(this.pointMeshes.map(Fe=>Fe.position))})}get points(){return this.originObject.areaMesh.points}};var F=Object.defineProperty,I=Object.defineProperties,L$5=Object.getOwnPropertyDescriptors,A$3=Object.getOwnPropertySymbols,N$2=Object.prototype.hasOwnProperty,z$2=Object.prototype.propertyIsEnumerable,E$2=($e,Se,Be)=>Se in $e?F($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,g$4=($e,Se)=>{for(var Be in Se||(Se={}))N$2.call(Se,Be)&&E$2($e,Be,Se[Be]);if(A$3)for(var Be of A$3(Se))z$2.call(Se,Be)&&E$2($e,Be,Se[Be]);return $e},O=($e,Se)=>I($e,L$5(Se)),u$6=($e,Se,Be)=>(E$2($e,typeof Se!="symbol"?Se+"":Se,Be),Be),H$4=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class ie extends M$3{constructor(Se,Be){super(Se,Be),u$6(this,"type","Polygon"),u$6(this,"areaMesh"),u$6(this,"_editor"),u$6(this,"creatingObject"),Se&&(this.areaMesh=new M(g$4(g$4({},Se.style),Se)),this.add(this.areaMesh))}get editor(){return this._editor||(this._editor=new u$7(this)),this._editor}get data(){return this.updateMatrixWorld(),O(g$4({},this.baseData),{points:a$6(this.applyObjectMatrixWorld(this.areaMesh.points)),style:{color:this.areaMesh.color.getHex(),lineColor:this.areaMesh.lineColor.getHex(),lineWidth:this.areaMesh.lineWidth}})}setData(Se){Se.points&&this.areaMesh.setPoints(this.applyObjectReversalMatrixWorld(Se.points.map(t$j))),this.areaMesh.setStyle(Se.style)}highlight(){var Se;(Se=this.areaMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.areaMesh)==null||Se.unhighlight()}canUndo(){var Se;(Se=this.creatingObject)==null||Se.canUndo()}canRedo(){var Se;(Se=this.creatingObject)==null||Se.canRedo()}undo(){var Se;(Se=this.creatingObject)==null||Se.undo()}redo(){var Se;(Se=this.creatingObject)==null||Se.redo()}create(Se){return H$4(this,null,function*(){this.children.forEach(De=>{De.parent===this&&this.remove(De)}),this.children.length=0;const Be=new M(Se);this.areaMesh=Be,this.add(this.areaMesh),this.creatingObject=X(this.areaMesh,this.pointSelector,Se),yield this.creatingObject.finished,this.config.defaultAction&&this.editor.enable()})}}function X($e,Se,Be){var De;const{promise:Ve,resolve:Fe,reject:Je}=i$d(),Xe=$e.parent;if(!Xe){Je(new Error("No container"));return}const Ke=(De=Be?.limit)!=null?De:"none",Ye=new j$5($e.style);Xe?.add(Ye);const or=new j$5(O(g$4({},$e.style),{dashed:!0,lengthEnable:!1}));Xe?.add(or),Se.enable();const sr=[];let cr,Br,tn=!1,en;const an=[],rn=()=>sr.length>0,on=()=>an.length>0,sn=()=>{rn()&&(an.push(sr.pop()),hn(en),Se.pointSelectorHelper.magnifier.render())},ln=()=>{on()&&(sr.push(an.pop()),hn(en),Se.pointSelectorHelper.magnifier.render())},cn=xn=>{an.length=0;const pn=sr.length===0?xn.point:cr.clone();sr.push(pn),$e.setPoints(sr,{closed:!1}),tn&&(mn(),Fe())},hn=xn=>{const pn=()=>{Ye.setPoints([]),or.setPoints([]),$e.setPoints(sr),Se.pointSelectorHelper.magnifier.render()};if(!xn||(en=xn,!(sr!=null&&sr.length)))return pn();const dn=sr.at(-1).clone();if(sr.length<3&&(Ke==="none"?(cr=xn.point,Ye.setPoints([dn,cr]),or.setPoints([])):Ke==="xoz"?(Br=Br??new Plane().setFromNormalAndCoplanarPoint(new Vector3(0,1,0),sr[0]),Se.plane=Br,cr=Br.projectPoint(xn.point,new Vector3),Ye.setPoints([dn,cr]),or.setPoints([cr,xn.point])):Ke==="y"&&(sr.length===1?(cr=xn.point,Ye.setPoints([dn,cr]),or.setPoints([])):(Br=Br??new Plane().setFromCoplanarPoints(sr[0],sr[1],new Vector3(0,1,0).add(sr[0])),Se.plane=Br,cr=Br.projectPoint(xn.point,new Vector3),Ye.setPoints([dn,cr]),or.setPoints([cr,xn.point])))),sr.length>=3){cr=$e.projectPoint(xn.point);const fn=sr[0],yn=.2;fn.distanceTo(cr)<yn||fn.distanceTo(xn.point)<yn?(cr=fn,xn.point.copy(fn),Se.pointSelectorHelper.updateWithIntersect(xn,{emitEvent:!1}),tn=!0):tn=!1,Ye.setPoints([dn,cr]),or.setPoints([cr,xn.point])}sr.length>=2?($e.setPoints([...sr,cr],{closed:!1}),$e.line.setPoints($e.points.slice(0,-1)),$e.isBlank?(Se.cursorError=!0,Ye.setStyle({lineColor:16734553}),or.setStyle({lineColor:16734553})):(Se.cursorError=!1,Ye.setStyle({lineColor:$e.lineColor}),or.setStyle({lineColor:$e.lineColor}))):$e.setPoints([])},mn=()=>{Se.off("select",cn),Se.off("intersectionUpdate",hn),Se.off("disable",An),Se.plane=null,Se.disable(),Xe?.remove(Ye,or)},An=()=>{mn(),Xe?.remove($e,or,Ye),Je(new Error("Cancelled"))};return Se.on("select",cn),Se.on("intersectionUpdate",hn),Se.on("disable",An),{finished:Ve,canUndo:rn,canRedo:on,undo:sn,redo:ln}}function x$3($e){const Se=[...$e],Be=[];for(let De=0;De<Se.length-2;De++)Be.push(0,De+1,De+2);return Be}function s$2($e){const Se=$e.map(Be=>new Vector3(Be[0],Be[1],Be[2]));return p$u(Se)}var x$2=Object.defineProperty,y$3=($e,Se,Be)=>Se in $e?x$2($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,p$9=($e,Se,Be)=>(y$3($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let v$2=class extends BufferGeometry{constructor(Se){super(),p$9(this,"bottomPositions",[]),p$9(this,"topPosition",[]),p$9(this,"_type","Concave"),Se&&this.setPosition(Se)}setPosition(Se){var Be,De,Ve;const Fe=(Be=Se.bottomPositions)!=null?Be:this.bottomPositions,Je=(De=Se.topPosition)!=null?De:this.topPosition;if(this._type=(Ve=Se.type)!=null?Ve:this._type,this.bottomPositions=Fe,this.topPosition=Je,!Fe||Fe.length<3){console.error("PrismGeometry: Invalid parameters",Fe,Je,Se),this.bottomPositions=[],this.setAttribute("position",new BufferAttribute(new Float32Array([]),3));return}const Xe=[],Ke=[];Ke.push(...Fe),Ke[0][0]===Ke.at(-1)[0]&&Ke[0][1]===Ke.at(-1)[1]&&Ke[0][2]===Ke.at(-1)[2]&&(Ke.length-=1);const Ye=this._type==="Concave"?s$2(Ke):x$3(Ke);if(Xe.push(...Ye),Je&&Je.length===3){const or=[Je[0]-Fe[0][0],Je[1]-Fe[0][1],Je[2]-Fe[0][2]],sr=Ke.map(Br=>[Br[0]+or[0],Br[1]+or[1],Br[2]+or[2]]);Ke.push(...sr);const cr=Xe.map(Br=>Br+Ke.length/2);Xe.push(...cr);for(let Br=0;Br<Ke.length/2-1;Br++)Xe.push(Br,Br+1,Br+Ke.length/2),Xe.push(Br+1,Br+Ke.length/2+1,Br+Ke.length/2);Xe.push(0,Ke.length/2,Ke.length/2-1),Xe.push(Ke.length/2,Ke.length-1,Ke.length/2-1)}this.setAttribute("position",new Float32BufferAttribute(Ke.flat(),3)),this.setIndex(Xe),this.computeBoundingSphere()}};var b$2=Object.defineProperty,d$6=Object.getOwnPropertySymbols,C$1=Object.prototype.hasOwnProperty,w$3=Object.prototype.propertyIsEnumerable,c$5=($e,Se,Be)=>Se in $e?b$2($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,a$2=($e,Se)=>{for(var Be in Se||(Se={}))C$1.call(Se,Be)&&c$5($e,Be,Se[Be]);if(d$6)for(var Be of d$6(Se))w$3.call(Se,Be)&&c$5($e,Be,Se[Be]);return $e},s$1=($e,Se,Be)=>(c$5($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let H$3=class extends c$C{constructor(Se){super(),s$1(this,"name","PrismMesh"),s$1(this,"_geometryInfoCache"),s$1(this,"geometryInfoNeedUpdate",!0),s$1(this,"edgeMesh",new Oe),s$1(this,"prismMesh",new A$n),s$1(this,"paramStyle"),this.prismMesh.name="PrismMesh",this.prismMesh.geometry=new v$2,this.edgeMesh.name="EdgeMesh",this.addIfNotExists(this.prismMesh,this.edgeMesh),Se&&this.setPoints(Se),this.setStyle(Se)}get topPosition(){return new Vector3().fromArray(this.prismMesh.geometry.topPosition)}get bottomPositions(){return this.prismMesh.geometry.bottomPositions.map(Se=>new Vector3().fromArray(Se))}get topPositions(){const Se=this.bottomPositions[0].clone().sub(this.topPosition);return this.bottomPositions.map(Be=>Be.clone().sub(Se))}get style(){return{color:this.color,lineColor:this.lineColor,lineWidth:this.lineWidth,opacity:this.opacity,occlusionVisibility:this.occlusionVisibility,occlusionMode:this.occlusionMode}}get opacity(){return this.prismMesh.opacity}get occlusionVisibility(){return this.prismMesh.occlusionVisibility}get occlusionMode(){return this.prismMesh.occlusionMode}get center(){return this.localCenter.clone()}get localCenter(){var Se;return(Se=this.geometryInfo.center.clone())!=null?Se:new Vector3(9999,9999,9999)}get geometryInfo(){if(this.geometryInfoNeedUpdate){this.geometryInfoNeedUpdate=!1;const Se=this.prismMesh.geometry.bottomPositions,Be=this.prismMesh.geometry.topPosition;if(!Se||Se.length<3||!Be){this._geometryInfoCache=void 0;return}const De=Se.map((Ke,Ye)=>Ye>=Se.length-2?null:[new Vector3().fromArray(Se[0]),new Vector3().fromArray(Se[Ye+1]),new Vector3().fromArray(Se[Ye+2])]).filter(Boolean);if(De.length===0){this._geometryInfoCache=void 0;return}let Ve=0,Fe=new Vector3;for(const[Ke,Ye,or]of De){const sr=u$s(Ke,Ye,or),cr=d$t(Ke,Ye,or,sr);Ve+=sr,Fe.add(cr)}Fe=Fe.divideScalar(Ve);const Je=new Vector3().fromArray(Be).sub(new Vector3().fromArray(Se[0])),Xe=Fe.clone().add(Je.divideScalar(2));this._geometryInfoCache={center:Xe}}return this._geometryInfoCache}get worldCenter(){return this.updateMatrixWorld(),this.localToWorld(this.localCenter)}get color(){return this.prismMesh.color}get lineWidth(){return this.edgeMesh.style.lineWidth}get lineColor(){return this.edgeMesh.color}setStyle(Se={}){this.paramStyle=a$2(a$2({},this.paramStyle),Se),this.prismMesh.setStyle(this.paramStyle),this.edgeMesh.setStyle(this.paramStyle)}setPoints(Se){var Be;this.prismMesh.geometry.setPosition({bottomPositions:(Be=Se.points)==null?void 0:Be.map(t$j).map(De=>De.toArray()),topPosition:Se.heightPoint?t$j(Se.heightPoint).toArray():void 0}),this.edgeMesh.geometry=new a$w().fromEdgesGeometry(new EdgesGeometry(this.prismMesh.geometry)),this.geometryInfoNeedUpdate=!0}highlight(){this.prismMesh.highlight()}unhighlight(){this.prismMesh.unhighlight()}raycast(Se,Be){return this.children.forEach(De=>c$L(De,Se,Be,!0)),!1}},f$7=class extends u$8{constructor(Se){super(Se,()=>({positionFrom:()=>Se.worldCenter,yAxis:()=>Se.up,scaleHelper:{enable:!0,positions:()=>{const Be=Se.bottomPositions,De=Se.topPosition,Ve=new Vector3().subVectors(De,Be[0]),Fe=Se.geometryInfo.center,Je=Fe.clone().sub(Ve.clone().divideScalar(2)),Xe=Fe.clone().add(Ve.clone().divideScalar(2));return[{id:"top",handlePosition:Xe,basePosition:Je},{id:"bottom",handlePosition:Je,basePosition:Xe}]},scaleCallback:Be=>{const{intersectPoint:De,scalePosition:Ve}=Be,{id:Fe,basePosition:Je,handlePosition:Xe}=Ve;if(Fe==="top"){const Ke=De.clone().sub(Je);Se.setPoints({heightPoint:Se.bottomPositions[0].clone().add(Ke)})}else if(Fe==="bottom"){const Ke=De.clone().sub(Je);Se.setPoints({points:Se.topPositions.map(Ye=>Ye.clone().add(Ke))})}}}}))}};var W$3=Object.defineProperty,_$4=Object.defineProperties,j$3=Object.getOwnPropertyDescriptors,u$5=Object.getOwnPropertySymbols,E$1=Object.prototype.hasOwnProperty,L$4=Object.prototype.propertyIsEnumerable,d$5=($e,Se,Be)=>Se in $e?W$3($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,p$8=($e,Se)=>{for(var Be in Se||(Se={}))E$1.call(Se,Be)&&d$5($e,Be,Se[Be]);if(u$5)for(var Be of u$5(Se))L$4.call(Se,Be)&&d$5($e,Be,Se[Be]);return $e},w$2=($e,Se)=>_$4($e,j$3(Se)),c$4=($e,Se,Be)=>(d$5($e,typeof Se!="symbol"?Se+"":Se,Be),Be),f$6=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class Z extends M$3{constructor(Se,Be){super(Se,Be),c$4(this,"type","Prism"),c$4(this,"prismMesh"),c$4(this,"_editor"),Se&&(this.prismMesh=new H$3(p$8(p$8({},Se.style),Se)),this.add(this.prismMesh))}get editor(){return this._editor||(this._editor=new f$7(this.prismMesh)),this._editor}get data(){return w$2(p$8({},this.baseData),{points:a$6(this.applyObjectMatrixWorld(this.prismMesh.bottomPositions,this.prismMesh)),heightPoint:a$6(this.applyObjectMatrixWorld(this.prismMesh.topPosition,this.prismMesh)),style:{color:this.prismMesh.color.getHex(),lineWidth:this.prismMesh.lineWidth,lineColor:this.prismMesh.lineColor.getHex()}})}setData(Se){this.prismMesh.setPoints({points:Se.points?this.applyObjectReversalMatrixWorld(Se.points.map(t$j),this.prismMesh):void 0,heightPoint:Se.heightPoint?this.applyObjectReversalMatrixWorld(t$j(Se.heightPoint),this.prismMesh):void 0}),this.prismMesh.setStyle(Se.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var Se;(Se=this.prismMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.prismMesh)==null||Se.unhighlight()}create(Se){return f$6(this,null,function*(){this.prismMesh=new H$3(Se),this.add(this.prismMesh),yield V$1(this.prismMesh,this.pointSelector),this.config.defaultAction&&this.editor.enable()})}}function V$1($e,Se){return f$6(this,null,function*(){const Be=$e.parent,De=new M($e.style);Be.add(De),yield X(De,Se).finished,Be.remove(De),$e.setPoints({points:De.points});const Ve=new Oe;Ve.name="LineHelper",Be.add(Ve);const Fe=De.points.at(-1),Je=l$n(De.points),Xe=Fe.clone().add(Je.clone().multiplyScalar(100)),Ke=Fe.clone().sub(Je.clone().multiplyScalar(100));return Ve.setPoints([Xe,Ke]),Se.enable(),new Promise((Ye,or)=>{const sr=en=>{Br(),Ye()},cr=en=>{if(!(en!=null&&en.raycaster))return;const an=w$o({raycaster:en.raycaster,line:new Line3(Xe,Ke)});an&&$e.setPoints({heightPoint:an})},Br=()=>{Se.off("select",sr),Se.off("intersectionUpdate",cr),Se.off("disable",tn),Be.remove(Ve),Se.disable()},tn=()=>{Br(),Be.remove($e),or(new Error("Cancelled"))};Se.on("select",sr),Se.on("intersectionUpdate",cr),Se.on("disable",tn)})})}let b$1=class extends u$8{constructor(Se){super(Se,()=>({yAxis:()=>{const Be=Se.points;return l$n(Be).normalize()},zAxis:()=>{const Be=Se.points;return Be[0].clone().sub(Be[1]).normalize()},scaleHelper:{enable:!0,positions:()=>{const Be=Se.points,De=Be[0].clone().lerp(Be[3],.5),Ve=Be[1].clone().lerp(Be[2],.5),Fe=Be[0].clone().lerp(Be[1],.5),Je=Be[3].clone().lerp(Be[2],.5);return[{id:"left",handlePosition:De,basePosition:Ve},{id:"right",handlePosition:Ve,basePosition:De},{id:"top",handlePosition:Fe,basePosition:Je},{id:"bottom",handlePosition:Je,basePosition:Fe}]},scaleCallback:Be=>{const{intersectPoint:De,scalePosition:Ve}=Be,{id:Fe,basePosition:Je}=Ve,Xe=De.clone().sub(Je),Ke=Se.points;Fe==="top"?Se.setPoints([Ke[3].clone().add(Xe),Ke[2].clone().add(Xe),Ke[2],Ke[3]]):Fe==="bottom"?Se.setPoints([Ke[0],Ke[1],Ke[1].clone().add(Xe),Ke[0].clone().add(Xe)]):Fe==="left"?Se.setPoints([Ke[1].clone().add(Xe),Ke[1],Ke[2],Ke[2].clone().add(Xe)]):Fe==="right"&&Se.setPoints([Ke[0],Ke[0].clone().add(Xe),Ke[3].clone().add(Xe),Ke[3]])}}}))}};var i$1=Object.defineProperty,a$1=($e,Se,Be)=>Se in $e?i$1($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,n$4=($e,Se,Be)=>(a$1($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let l$5=class extends BufferGeometry{constructor(Se){if(super(),n$4(this,"name","RectangleGeometry"),n$4(this,"points"),Se.length!==4){console.error("Invalid number of points, it's not a rectangle");return}this.points=Se.slice(0,4),this.setAttribute("position",new BufferAttribute(new Float32Array(this.points.flatMap(Be=>Be.toArray())),3)),this.setIndex(new BufferAttribute(new Uint16Array([0,1,2,0,2,3]),1))}};var l$4=Object.defineProperty,c$3=($e,Se,Be)=>Se in $e?l$4($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,i=($e,Se,Be)=>(c$3($e,Se+"",Be),Be);let j$2=class extends j$i{constructor(Se){super(Se),i(this,"name","RectangleMesh")}get color(){return this.meshFont.material.color}setPoints(Se){const Be=Se.map(t$j).filter(i$w);if(Be.length<3){console.error("Invalid position");return}if(Se.length===3){const[De,Ve,Fe]=Be,Je=De.clone().add(Fe).sub(Ve);Be.push(Je)}this.points=Be,this.geometry=new l$5(Be),this.planeHelperNeedUpdate=!0,this.geometryInfoNeedUpdate=!0}};var c$2=Object.defineProperty,h$2=Object.getOwnPropertySymbols,u$4=Object.prototype.hasOwnProperty,p$7=Object.prototype.propertyIsEnumerable,n$3=($e,Se,Be)=>Se in $e?c$2($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,l$3=($e,Se)=>{for(var Be in Se||(Se={}))u$4.call(Se,Be)&&n$3($e,Be,Se[Be]);if(h$2)for(var Be of h$2(Se))p$7.call(Se,Be)&&n$3($e,Be,Se[Be]);return $e},y$2=($e,Se)=>{var Be={};for(var De in $e)u$4.call($e,De)&&Se.indexOf(De)<0&&(Be[De]=$e[De]);if($e!=null&&h$2)for(var De of h$2($e))Se.indexOf(De)<0&&p$7.call($e,De)&&(Be[De]=$e[De]);return Be},o$1=($e,Se,Be)=>(n$3($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let W$2=class extends j$2{constructor(Se){const Be=Se??{},{points:De}=Be,Ve=y$2(Be,["points"]);super(),o$1(this,"name","RectangleWithEdgeMesh"),o$1(this,"line",new j$5),De&&this.setPoints(De),Ve&&this.setStyle(Ve)}get style(){return l$3(l$3({},super.style),this.line.style)}get lineWidth(){return this.line.lineWidth}get lineColor(){return this.line.lineColor}setPoints(Se){super.setPoints(Se),this.points&&(this.line.setPoints([this.points[0],this.points[1],this.points[2],this.points[3],this.points[0]]),this.addIfNotExists(this.line))}setStyle(Se){super.setStyle(Se),this.line.setStyle(Se)}highlight(){super.highlight(),this.line.highlight()}unhighlight(){super.unhighlight(),this.line.unhighlight()}};function f$5($e,Se){const Be=l$n($e),De=c$J(...$e),Ve=Se.clone().sub(De);return Be.dot(Ve)>=0?$e:$e.slice().reverse()}var q=Object.defineProperty,G=Object.defineProperties,J$1=Object.getOwnPropertyDescriptors,W$1=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,T$2=($e,Se,Be)=>Se in $e?q($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,p$6=($e,Se)=>{for(var Be in Se||(Se={}))K.call(Se,Be)&&T$2($e,Be,Se[Be]);if(W$1)for(var Be of W$1(Se))Q.call(Se,Be)&&T$2($e,Be,Se[Be]);return $e},P$1=($e,Se)=>G($e,J$1(Se)),N$1=($e,Se,Be)=>(T$2($e,typeof Se!="symbol"?Se+"":Se,Be),Be),D$2=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class ge extends M$3{constructor(Se,Be){super(Se,Be),N$1(this,"type","Rectangle"),N$1(this,"rectangleMesh"),N$1(this,"_editor"),Se&&(this.rectangleMesh=new W$2(p$6(p$6({},Se.style),Se)),this.add(this.rectangleMesh))}get editor(){return this._editor||(this._editor=new b$1(this.rectangleMesh)),this._editor}get data(){return P$1(p$6({},this.baseData),{points:a$6(this.applyObjectMatrixWorld(this.rectangleMesh.points,this.rectangleMesh)),style:{color:this.rectangleMesh.color.getHex(),opacity:this.rectangleMesh.opacity,lineWidth:this.rectangleMesh.lineWidth,lineColor:this.rectangleMesh.lineColor.getHex()}})}setData(Se){Se.points&&this.rectangleMesh.setPoints(this.applyObjectReversalMatrixWorld(Se.points.map(t$j),this.rectangleMesh)),this.rectangleMesh.setStyle(Se.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var Se;(Se=this.rectangleMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.rectangleMesh)==null||Se.unhighlight()}create(Se){return D$2(this,null,function*(){this.removeChildren();const Be=new W$2(Se);this.rectangleMesh=Be,this.add(this.rectangleMesh),yield te(this.rectangleMesh,this.pointSelector,Se),this.config.defaultAction&&this.editor.enable()})}}function te($e,Se,Be){var De;return((De=Be?.drawMethod)!=null?De:"diagonal")==="diagonal"?se($e,Se,Be):oe($e,Se,Be)}function ne$1($e,Se){const Be=[];return $e.scene.traverse(De=>{var Ve;if(De.visible&&!((Ve=Se?.excludes)!=null&&Ve.includes(De))&&(De instanceof j$2||De instanceof j$i)){const Fe=De.points.map(Je=>{const Xe=new Face3(Je.x,Je.y,Je.z,De.normal);return De.style.occlusionVisibility&&(Xe.IsAlwaysVisible=!0),Xe});Be.push(...Fe)}}),Be}function se($e,Se,Be){var De;const{promise:Ve,reject:Fe,resolve:Je}=i$d(),Xe=$e.parent;if(!Xe)return Fe(new Error("No container"));const Ke=(De=Be?.limit)!=null?De:"none",Ye=new x$4(P$1(p$6({},$e.style),{dashed:!0})),or=new x$4(P$1(p$6({},$e.style),{dashed:!0,lengthEnable:!1})),sr=new x$4(P$1(p$6({},$e.style),{dashed:!1,lengthEnable:!1}));Xe.add(Ye,sr,or),Se.enable();const cr=[];let Br=new Vector3,tn=new Vector3;const en=new Plane,an=()=>{cr.push(Br.clone()),cr.length===1?(Ke==="xoz"&&en.setFromNormalAndCoplanarPoint(new Vector3(0,1,0),cr[0]),Ke==="none"&&en.setFromNormalAndCoplanarPoint(tn,cr[0])):cr.length===2?Ke==="y"||Ke==="xoz"?(on(),Je()):sr.setPoints([cr[0],cr[1]]):cr.length===3&&(on(),Je())},rn=ln=>{var cn,hn;if(!(ln!=null&&ln.raycaster))return;const mn=(cn=cr.at(-1))==null?void 0:cn.clone();if(cr.length===0){Br=ln.point.clone(),tn=(hn=ln.face)==null?void 0:hn.normal;return}if(cr.length===1&&Ke==="y"){const An=new Line3(new Vector3(0,1,0).add(cr[0]),new Vector3(0,-1,0).add(cr[0])).closestPointToPoint(ln.point,!1,new Vector3);$e.setPoints([cr[0],An,ln.point]);return}if(cr.length===1&&Ke==="xoz"){const An=new Line3(new Vector3(1,0,0).add(cr[0]),new Vector3(-1,0,0).add(cr[0])),xn=ln.raycaster.ray.intersectPlane(en,new Vector3),pn=An.closestPointToPoint(xn,!1,new Vector3);$e.setPoints([cr[0],pn,xn]);return}if(cr.length===1&&Ke==="none"){en?(Br=ln.raycaster.ray.intersectPlane(en,new Vector3),or.setPoints([Br,ln.point])):Br=ln.point.clone(),Ye.setPoints([mn,Br]);return}if(cr.length===2&&Ke==="none"){Xe.remove(Ye);const An=ln.raycaster.ray.intersectPlane(en,new Vector3),xn=cr[0].distanceTo(cr[1])/2,pn=new Vector3().lerpVectors(cr[0],cr[1],.5),dn=new Vector3().subVectors(An,pn).normalize();Br=new Vector3().addVectors(pn,dn.multiplyScalar(xn));const fn=[cr[0],Br,cr[1]],yn=f$5(fn,p.modules.five.camera.position);$e.setPoints(yn);return}},on=()=>{Se.off("select",an),Se.off("intersectionUpdate",rn),Se.off("disable",sn),Se.disable(),Xe?.remove(Ye,sr,or)},sn=()=>{on(),Xe?.remove($e),Fe(new Error("Cancelled"))};return Se.on("select",an),Se.on("intersectionUpdate",rn),Se.on("disable",sn),Ve}function oe($e,Se,Be){var De;const{promise:Ve,reject:Fe,resolve:Je}=i$d(),Xe=$e.parent;if(!Xe)return Fe(new Error("No container"));const Ke=(De=Be?.limit)!=null?De:"none",Ye=new x$4(P$1(p$6({},$e.style),{dashed:!0})),or=new x$4(P$1(p$6({},$e.style),{dashed:!0,lengthEnable:!1})),sr=new x$4(P$1(p$6({},$e.style),{dashed:!1,lengthEnable:!1}));Xe.add(Ye,sr,or),Se.enable(),Se.setAdherePoints(ne$1(Se.five,{excludes:[$e]}));const cr=[];let Br=new Vector3,tn=new Vector3;const en=new Plane,an=()=>{if(cr.push(Br.clone()),cr.length===1)Se.planeMode="onlyPlane",Ke==="y"&&(Se.adhereLine=[new Line3(cr[0],new Vector3(0,1,0).add(cr[0]))]),Ke==="xoz"&&(en.setFromNormalAndCoplanarPoint(new Vector3(0,1,0),cr[0]),Se.plane=en),Ke==="none"&&(en.setFromNormalAndCoplanarPoint(tn,cr[0]),Se.plane=en);else if(cr.length===2){Se.planeMode="vertical",Ke==="y"&&(Se.adhereLine=[]);let ln=!1;cr[0].x===cr[1].x&&cr[0].z===cr[1].z&&(ln=!0),Ke==="y"&&!ln&&(en.setFromCoplanarPoints(cr[0],cr[1],new Vector3(0,1,0).add(cr[0])),Se.plane=en),sr.setPoints([cr[0],cr[1]])}else cr.length===3&&(on(),Je())},rn=ln=>{var cn,hn,mn,An;if(!ln||!(ln!=null&&ln.raycaster))return;const xn=(cn=cr.at(-1))==null?void 0:cn.clone();if(cr.length===0){Br=ln.point.clone(),tn=(hn=ln.face)==null?void 0:hn.normal;return}if(cr.length===1){Br=ln.point,or.setPoints([(mn=ln.originalPoint)!=null?mn:ln.point,ln.point]),Ye.setPoints([xn,Br]);return}if(cr.length===2){if(!Se.plane){const yn=l$n([cr[0],cr[1],ln.point]);en.setFromNormalAndCoplanarPoint(yn,cr[0])}or.setPoints([(An=ln.originalPoint)!=null?An:ln.point,ln.point]);const pn=new Vector3().crossVectors(cr[0].clone().sub(cr[1]),en.normal).normalize();Br=new Line3(cr[1].clone().add(pn),cr[1].clone().sub(pn)).closestPointToPoint(ln.point,!1,new Vector3);const dn=[cr[0],cr[1],Br],fn=f$5(dn,p.modules.five.camera.position);$e.setPoints(fn);return}},on=()=>{Se.setAdherePoints([]),Se.adhereLine=[],Se.adherePlane=[],Se.plane=void 0,Se.off("select",an),Se.off("intersectionUpdate",rn),Se.off("disable",sn),Se.disable(),Xe?.remove(Ye,sr,or)},sn=()=>{on(),Xe?.remove($e),Fe(new Error("Cancelled"))};return Se.on("select",an),Se.on("intersectionUpdate",rn),Se.on("disable",sn),Ve}class s extends u$8{constructor(Se){super(Se,()=>({yAxis:()=>Se.normal}))}}function n$2($e){return Math.max(32,Math.min(128,Math.floor($e*40)))}var l$2=Object.defineProperty,_$3=($e,Se,Be)=>Se in $e?l$2($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,e=($e,Se,Be)=>(_$3($e,typeof Se!="symbol"?Se+"":Se,Be),Be);class N extends A$n{constructor(Se){super(Se),e(this,"_normal"),e(this,"_center"),e(this,"_radius"),Se!=null&&Se.center&&Se!=null&&Se.normal&&Se!=null&&Se.radius&&this.setPoints(Se)}get center(){return this.position.clone()}get normal(){return this._normal}set normal(Se){this._normal=Se}get radius(){var Se,Be;return(Be=(Se=this.meshFont.geometry)==null?void 0:Se.parameters)==null?void 0:Be.radius}setPoints(Se){var Be,De,Ve;if(this._center=(Be=t$j(Se.center))!=null?Be:this._center,this._normal=((De=t$j(Se.normal))!=null?De:this._normal).normalize(),this._radius=(Ve=Se.radius)!=null?Ve:this._radius,i$w(this._radius)&&this._radius!==this.radius){const Fe=n$2(this._radius);this.geometry=new CircleGeometry(this._radius,Fe)}this._center&&this.position.copy(this._center),this._normal&&(this.lookAt(this._normal.clone().add(this._center)),this.normal=this._normal.clone()),this.needsRender=!0}}var c$1=Object.defineProperty,r=Object.getOwnPropertySymbols,u$3=Object.prototype.hasOwnProperty,L$3=Object.prototype.propertyIsEnumerable,P=($e,Se,Be)=>Se in $e?c$1($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,l$1=($e,Se)=>{var Be={};for(var De in $e)u$3.call($e,De)&&Se.indexOf(De)<0&&(Be[De]=$e[De]);if($e!=null&&r)for(var De of r($e))Se.indexOf(De)<0&&L$3.call($e,De)&&(Be[De]=$e[De]);return Be},d$4=($e,Se,Be)=>(P($e,Se+"",Be),Be);class S extends N{constructor(Se){const Be=Se??{},{normal:De,radius:Ve,center:Fe}=Be,Je=l$1(Be,["normal","radius","center"]);super(Je),d$4(this,"edgeLine"),this.edgeLine=new Oe(Je),this.add(this.edgeLine),De&&Ve&&Fe&&this.setPoints({normal:De,radius:Ve,center:Fe})}setPoints(...Se){super.setPoints(...Se);const Be=this.meshFont.geometry.vertices.slice(1);this.edgeLine.setPoints(Be.concat(Be[0]))}setStyle(Se){super.setStyle(Se),this.edgeLine.setStyle(Se)}highlight(){super.highlight(),this.edgeLine.highlight()}unhighlight(){super.unhighlight(),this.edgeLine.unhighlight()}}var x$1=Object.defineProperty,_$2=Object.defineProperties,T$1=Object.getOwnPropertyDescriptors,u$2=Object.getOwnPropertySymbols,A$2=Object.prototype.hasOwnProperty,H$2=Object.prototype.propertyIsEnumerable,m$4=($e,Se,Be)=>Se in $e?x$1($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,d$3=($e,Se)=>{for(var Be in Se||(Se={}))A$2.call(Se,Be)&&m$4($e,Be,Se[Be]);if(u$2)for(var Be of u$2(Se))H$2.call(Se,Be)&&m$4($e,Be,Se[Be]);return $e},g$3=($e,Se)=>_$2($e,T$1(Se)),f$4=($e,Se,Be)=>(m$4($e,typeof Se!="symbol"?Se+"":Se,Be),Be),y$1=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});let L$2=class extends M$3{constructor(Se,Be){super(Se,Be),f$4(this,"type","Circle"),f$4(this,"circleMesh"),f$4(this,"_editor"),Se&&(this.circleMesh=new S(d$3(d$3({},Se.style),Se)),this.add(this.circleMesh))}get editor(){return this._editor||(this._editor=new s(this.circleMesh)),this._editor}get data(){return g$3(d$3({},this.baseData),{center:a$6(this.applyObjectMatrixWorld(this.circleMesh.center,this.circleMesh)),normal:a$6(this.circleMesh.normal.clone().applyQuaternion(this.circleMesh.quaternion)),radius:this.circleMesh.radius,style:{color:this.circleMesh.color.getHex()}})}setData(Se){this.circleMesh.setPoints({center:Se.center?this.applyObjectReversalMatrixWorld(t$j(Se.center),this.circleMesh):void 0,normal:Se.normal?t$j(Se.normal):void 0,radius:Se.radius}),this.circleMesh.setStyle(Se.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var Se;(Se=this.circleMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.circleMesh)==null||Se.unhighlight()}create(Se){return y$1(this,null,function*(){this.children.forEach(De=>{De.parent===this&&this.remove(De)}),this.children.length=0;const Be=new S(Se);this.circleMesh=Be,this.add(this.circleMesh),yield D$1(this.circleMesh,this.pointSelector),this.config.defaultAction&&this.editor.enable()})}};function D$1($e,Se){return new Promise((Be,De)=>{const Ve=$e.parent;if(!Ve){De(new Error("No container"));return}const Fe=new j$5({dashed:!0});Ve.add(Fe),Se.enable();let Je,Xe;const Ke=cr=>{if(cr){if(!Je){Je={point:cr.point,normal:cr.face.normal};return}Je&&Xe&&(or(),Be())}},Ye=cr=>{if(!cr||!Je)return;const Br=new Plane().setFromNormalAndCoplanarPoint(Je.normal,Je.point);if(Xe=cr.raycaster.ray.intersectPlane(Br,new Vector3),Xe){const tn=Je.point.distanceTo(Xe);$e.setPoints({center:Je.point,normal:Je.normal,radius:tn})}},or=()=>{Se.off("select",Ke),Se.off("intersectionUpdate",Ye),Se.off("disable",sr),Se.disable(),Ve?.remove(Fe)},sr=()=>{or(),Ve?.remove($e,Fe),De(new Error("Cancelled"))};Se.on("select",Ke),Se.on("intersectionUpdate",Ye),Se.on("disable",sr)})}var g$2=Object.defineProperty,d$2=Object.getOwnPropertySymbols,u$1=Object.prototype.hasOwnProperty,p$5=Object.prototype.propertyIsEnumerable,n$1=($e,Se,Be)=>Se in $e?g$2($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,l=($e,Se)=>{for(var Be in Se||(Se={}))u$1.call(Se,Be)&&n$1($e,Be,Se[Be]);if(d$2)for(var Be of d$2(Se))p$5.call(Se,Be)&&n$1($e,Be,Se[Be]);return $e},o=($e,Se,Be)=>(n$1($e,typeof Se!="symbol"?Se+"":Se,Be),Be);let H$1=class extends c$C{constructor(Se){super(),o(this,"bottomCircle"),o(this,"topCircle"),o(this,"edgeMesh"),o(this,"highlighted",!1),o(this,"params"),o(this,"_topCenter"),o(this,"_bottomCenter"),o(this,"_radius"),this.params=Se,this.bottomCircle=new S(Se),this.bottomCircle.name="bottomCircle",this.topCircle=new S(Se),this.topCircle.name="topCircle",this.edgeMesh=new A$n(Se),Se!=null&&Se.bottomCenter&&Se!=null&&Se.topCenter&&Se!=null&&Se.radius&&this.setPoints(Se),this.addIfNotExists(this.bottomCircle)}get bottomCenter(){return this.bottomCircle.center}get topCenter(){return this.topCircle.center}get normal(){return this.bottomCircle.normal}get radius(){return this.bottomCircle.radius}get color(){return this.bottomCircle.color}setPoints(Se){var Be,De;if(this._topCenter=(Be=t$j(Se.topCenter))!=null?Be:this.topCenter,this._bottomCenter=(De=t$j(Se.bottomCenter))!=null?De:this.bottomCenter,this._radius=i$w(Se.radius)?Se.radius:this.radius,this._topCenter&&this._bottomCenter){const Ve=this._topCenter.clone().sub(this._bottomCenter).normalize();this.bottomCircle.setPoints({center:this._bottomCenter,normal:Ve,radius:this._radius}),this.setTopCenter(this._topCenter)}this.needsRender=!0}setTopCenter(Se){this.addIfNotExists(this.topCircle),this.topCircle.setPoints({center:Se,normal:this.normal,radius:this.radius}),this.setEdgeMesh()}setBottomCenter(Se){this.addIfNotExists(this.bottomCircle),this.bottomCircle.setPoints({center:Se,normal:this.normal,radius:this.radius}),this.setEdgeMesh()}setStyle(Se){this.params=l(l({},this.params),Se),this.bottomCircle.setStyle(this.params),this.topCircle.setStyle(this.params)}highlight(){this.highlighted||(this.highlighted=!0,this.edgeMesh.highlight(),this.bottomCircle.highlight(),this.topCircle.highlight(),this.needsRender=!0)}unhighlight(){this.highlighted&&(this.highlighted=!1,this.edgeMesh.unhighlight(),this.bottomCircle.unhighlight(),this.topCircle.unhighlight(),this.needsRender=!0)}setEdgeMesh(){this.addIfNotExists(this.edgeMesh);const Se=this.topCircle.center,Be=this.bottomCircle.center;this.edgeMesh.geometry.dispose(),this.edgeMesh.geometry=new CylinderGeometry(this.radius,this.radius,Se.distanceTo(Be),n$2(this.radius),1,!0);const De=new Quaternion().setFromUnitVectors(new Vector3(0,1,0),this.normal.clone().normalize());this.edgeMesh.position.copy(new Vector3().lerpVectors(Be,Se,.5)),this.edgeMesh.quaternion.copy(De)}};class c extends u$8{constructor(Se){super(Se,()=>{const Be=()=>{const De=Se.topCenter,Ve=Se.bottomCenter,Fe=new Vector3().lerpVectors(De,Ve,.5);return{topCenter:De,bottomCenter:Ve,boxCenter:Fe}};return{positionFrom:"boundingBox",yAxis:()=>Se.normal,scaleHelper:{enable:!0,positions:()=>{const De=Be();return[{id:"top",handlePosition:De.topCenter,basePosition:De.bottomCenter},{id:"bottom",handlePosition:De.bottomCenter,basePosition:De.topCenter}]},scaleCallback:De=>{const{intersectPoint:Ve,scalePosition:Fe}=De,{id:Je}=Fe;Je==="top"?Se.setTopCenter(Ve):Je==="bottom"&&Se.setBottomCenter(Ve)}}}})}}var E=Object.defineProperty,L$1=Object.defineProperties,T=Object.getOwnPropertyDescriptors,g$1=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,A$1=Object.prototype.propertyIsEnumerable,p$4=($e,Se,Be)=>Se in $e?E($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,d$1=($e,Se)=>{for(var Be in Se||(Se={}))W.call(Se,Be)&&p$4($e,Be,Se[Be]);if(g$1)for(var Be of g$1(Se))A$1.call(Se,Be)&&p$4($e,Be,Se[Be]);return $e},w$1=($e,Se)=>L$1($e,T(Se)),m$3=($e,Se,Be)=>(p$4($e,typeof Se!="symbol"?Se+"":Se,Be),Be),f$3=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class Y extends M$3{constructor(Se,Be){super(Se,Be),m$3(this,"type","Cylinder"),m$3(this,"cylinderMesh"),m$3(this,"_editor"),Se&&(this.cylinderMesh=new H$1(d$1(d$1({},Se.style),Se)),this.add(this.cylinderMesh))}get editor(){return this._editor||(this._editor=new c(this.cylinderMesh)),this._editor}get data(){return w$1(d$1({},this.baseData),{bottomCenter:a$6(this.applyObjectMatrixWorld(this.cylinderMesh.bottomCenter,this.cylinderMesh)),topCenter:a$6(this.applyObjectMatrixWorld(this.cylinderMesh.topCenter,this.cylinderMesh)),radius:this.cylinderMesh.radius,style:{color:this.cylinderMesh.color.getHex()}})}setData(Se){this.cylinderMesh.setPoints({bottomCenter:Se.bottomCenter?this.applyObjectReversalMatrixWorld(t$j(Se.bottomCenter),this.cylinderMesh):void 0,topCenter:Se.topCenter?this.applyObjectReversalMatrixWorld(t$j(Se.topCenter),this.cylinderMesh):void 0}),this.cylinderMesh.setStyle(Se.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var Se;(Se=this.cylinderMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.cylinderMesh)==null||Se.unhighlight()}create(Se){return f$3(this,null,function*(){this.cylinderMesh=new H$1(Se),this.add(this.cylinderMesh),yield B$2(this.cylinderMesh,this.pointSelector),this.config.defaultAction&&this.editor.enable()})}}function B$2($e,Se){return f$3(this,null,function*(){const Be=$e.parent;yield D$1($e.bottomCircle,Se);const De=new Oe;De.name="LineHelper",Be.add(De);const Ve=Se.position.point,Fe=$e.normal.clone().normalize(),Je=Ve.clone().add(Fe.clone().multiplyScalar(100)),Xe=Ve.clone().sub(Fe.clone().multiplyScalar(100));return De.setPoints([Je,Xe]),Se.enable(),new Promise((Ke,Ye)=>{const or=tn=>{cr(),Ke()},sr=tn=>{if(!(tn!=null&&tn.raycaster))return;const en=w$o({raycaster:tn.raycaster,line:new Line3(Je,Xe)}),an=new Plane().setFromNormalAndCoplanarPoint($e.normal,$e.bottomCenter).projectPoint(en,new Vector3),rn=en.clone().sub(an),on=$e.bottomCenter.clone().add(rn);en&&$e.setTopCenter(on)},cr=()=>{Se.off("select",or),Se.off("intersectionUpdate",sr),Se.off("disable",Br),Be.remove(De),Se.disable()},Br=()=>{cr(),Be.remove($e),Ye(new Error("Cancelled"))};Se.on("select",or),Se.on("intersectionUpdate",sr),Se.on("disable",Br)})})}class V extends u$8{constructor(Se){super(Se,()=>({positionFrom:()=>Se.worldCenter,yAxis:()=>new Vector3().subVectors(Se.topPosition,Se.bottomPositions[0]).normalize(),zAxis:()=>new Vector3().subVectors(Se.bottomPositions[0],Se.bottomPositions[1]).normalize(),scaleHelper:{enable:!0,positions:()=>{const Be=Se.bottomPositions,De=Se.topPosition,Ve=new Vector3().subVectors(De,Be[0]),Fe=new Vector3().subVectors(Be[1],Be[0]),Je=new Vector3().subVectors(Be[2],Be[1]),Xe=Se.geometryInfo.center,Ke=Xe.clone().sub(Ve.clone().divideScalar(2)),Ye=Xe.clone().add(Ve.clone().divideScalar(2)),or=Xe.clone().sub(Fe.clone().divideScalar(2)),sr=Xe.clone().add(Fe.clone().divideScalar(2)),cr=Xe.clone().sub(Je.clone().divideScalar(2)),Br=Xe.clone().add(Je.clone().divideScalar(2));return[{id:"top",handlePosition:Ye,basePosition:Ke},{id:"bottom",handlePosition:Ke,basePosition:Ye},{id:"left",handlePosition:or,basePosition:sr},{id:"right",handlePosition:sr,basePosition:or},{id:"front",handlePosition:cr,basePosition:Br},{id:"back",handlePosition:Br,basePosition:cr}]},scaleCallback:Be=>{const{intersectPoint:De,scalePosition:Ve}=Be,{id:Fe,basePosition:Je}=Ve,Xe=Se.bottomPositions,Ke=Se.topPositions;let Ye=new Vector3().subVectors(Se.topPosition,Xe[0]),or;if(Fe==="top")Ye=De.clone().sub(Je),or=Xe;else if(Fe==="bottom"){const sr=De.clone().sub(Je);or=Ke.map(cr=>cr.clone().add(sr)),Ye=void 0}else if(Fe==="left"){const sr=De.clone().sub(Je);or=[Xe[1].clone().add(sr),Xe[1],Xe[2],Xe[2].clone().add(sr)]}else if(Fe==="right"){const sr=De.clone().sub(Je);or=[Xe[0],Xe[0].clone().add(sr),Xe[3].clone().add(sr),Xe[3]]}else if(Fe==="front"){const sr=De.clone().sub(Je);or=[Xe[3].clone().add(sr),Xe[2].clone().add(sr),Xe[2],Xe[3]]}else if(Fe==="back"){const sr=De.clone().sub(Je);or=[Xe[0],Xe[1],Xe[1].clone().add(sr),Xe[0].clone().add(sr)]}Se.setPoints({points:or,heightPoint:Ye?or[0].clone().add(Ye):void 0})}}}))}}var m$2=Object.defineProperty,h$1=($e,Se,Be)=>Se in $e?m$2($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,n=($e,Se,Be)=>(h$1($e,Se+"",Be),Be);let p$3=class extends H$3{constructor(){super(...arguments),n(this,"name","BoxMesh")}get geometryInfo(){if(this.geometryInfoNeedUpdate){this.geometryInfoNeedUpdate=!1;const Se=this.bottomPositions,Be=this.topPosition;if(!Se||Se.length<3||!Be){this._geometryInfoCache=void 0;return}const De=c$J(...Se),Ve=Be.clone().sub(Se[0]),Fe=De.clone().add(Ve.clone().divideScalar(2));this._geometryInfoCache={center:Fe}}return this._geometryInfoCache}};var H=Object.defineProperty,R$1=Object.defineProperties,_$1=Object.getOwnPropertyDescriptors,w=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,j$1=Object.prototype.propertyIsEnumerable,b=($e,Se,Be)=>Se in $e?H($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,m$1=($e,Se)=>{for(var Be in Se||(Se={}))C.call(Se,Be)&&b($e,Be,Se[Be]);if(w)for(var Be of w(Se))j$1.call(Se,Be)&&b($e,Be,Se[Be]);return $e},v$1=($e,Se)=>R$1($e,_$1(Se)),d=($e,Se,Be)=>(b($e,typeof Se!="symbol"?Se+"":Se,Be),Be),p$2=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class ot extends M$3{constructor(Se,Be){super(Se,Be),d(this,"type","Box"),d(this,"boxMesh"),d(this,"_editor"),Se&&(this.boxMesh=new p$3(m$1(m$1({},Se.style),Se)),this.add(this.boxMesh))}get editor(){return this._editor||(this._editor=new V(this.boxMesh)),this._editor}get data(){return v$1(m$1({},this.baseData),{points:a$6(this.applyObjectMatrixWorld(this.boxMesh.bottomPositions,this.boxMesh)),heightPoint:a$6(this.applyObjectMatrixWorld(this.boxMesh.topPosition,this.boxMesh)),style:{color:this.boxMesh.color.getHex(),opacity:this.boxMesh.opacity,lineWidth:this.boxMesh.lineWidth,lineColor:this.boxMesh.lineColor.getHex()}})}setData(Se){this.boxMesh.setPoints({points:Se.points?this.applyObjectReversalMatrixWorld(Se.points.map(t$j),this.boxMesh):void 0,heightPoint:Se.heightPoint?this.applyObjectReversalMatrixWorld(t$j(Se.heightPoint),this.boxMesh):void 0}),this.boxMesh.setStyle(Se.style),this._editor&&this._editor.initialHelperMatrix()}highlight(){var Se;(Se=this.boxMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.boxMesh)==null||Se.unhighlight()}create(Se){return p$2(this,null,function*(){this.removeChildren(),this.boxMesh=new p$3(Se),this.add(this.boxMesh),yield z$1(this.boxMesh,this.pointSelector,Se),this.config.defaultAction&&this.editor.enable()})}}function z$1($e,Se,Be){return p$2(this,null,function*(){return new Promise((De,Ve)=>p$2(this,null,function*(){const Fe=$e.parent;if(!Fe){Ve(new Error("No container"));return}const Je=new W$2($e.style);Fe.add(Je),yield te(Je,Se,Be),Fe.remove(Je),$e.setPoints({points:Je.points});const Xe=new Oe,Ke=l$n($e.bottomPositions),Ye=c$J(...$e.bottomPositions),or=Ye.clone().add(Ke.clone().multiplyScalar(100)),sr=Ye.clone().sub(Ke.clone().multiplyScalar(100));Xe.setPoints([or,sr]),Fe.add(Xe),Se.enable();const cr=an=>{tn(),De()},Br=an=>{if(!(an!=null&&an.raycaster))return;const rn=w$o({raycaster:an.raycaster,line:new Line3(or,sr)});if(rn){const on=rn.clone().sub(Ye);$e.setPoints({heightPoint:$e.bottomPositions[0].clone().add(on)})}},tn=()=>{Se.off("select",cr),Se.off("intersectionUpdate",Br),Se.off("disable",en),Se.disable(),Fe?.remove(Xe)},en=()=>{tn(),Fe?.remove($e),Ve(new Error("Cancelled"))};Se.on("select",cr),Se.on("intersectionUpdate",Br),Se.on("disable",en)}))})}function f$2($e,Se){for(let Be=$e.length-1;Be>=0;Be--)Se($e[Be])}var A=Object.defineProperty,D=Object.defineProperties,k=Object.getOwnPropertyDescriptors,R=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,B$1=Object.prototype.propertyIsEnumerable,j=($e,Se,Be)=>Se in $e?A($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,f$1=($e,Se)=>{for(var Be in Se||(Se={}))z.call(Se,Be)&&j($e,Be,Se[Be]);if(R)for(var Be of R(Se))B$1.call(Se,Be)&&j($e,Be,Se[Be]);return $e},v=($e,Se)=>D($e,k(Se)),p$1=($e,Se,Be)=>(j($e,typeof Se!="symbol"?Se+"":Se,Be),Be),U$1=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});class ne extends M$3{constructor(Se,Be){super(Se,Be),p$1(this,"type","Line"),p$1(this,"lineMesh"),p$1(this,"_editor"),p$1(this,"creatingObject"),Se&&(this.lineMesh=new z$g(f$1(f$1({},Se.style),Se)),this.add(this.lineMesh))}get editor(){return this._editor||(this._editor=new H$5(this)),this._editor}get data(){return v(f$1({},this.baseData),{points:a$6(this.applyObjectMatrixWorld(this.lineMesh.points)),style:{lineColor:new Color(this.lineMesh.color).getHex(),lineWidth:this.lineMesh.lineWidth,dashed:this.lineMesh.dashed}})}setData(Se){Se.points&&this.lineMesh.setPoints(Se.points),this.lineMesh.setStyle(Se.style)}highlight(){var Se;(Se=this.lineMesh)==null||Se.highlight()}unhighlight(){var Se;(Se=this.lineMesh)==null||Se.unhighlight()}canUndo(){var Se;(Se=this.creatingObject)==null||Se.canUndo()}canRedo(){var Se;(Se=this.creatingObject)==null||Se.canRedo()}undo(){var Se;(Se=this.creatingObject)==null||Se.undo()}redo(){var Se;(Se=this.creatingObject)==null||Se.redo()}create(Se){return U$1(this,null,function*(){this.removeChildren();const Be=new z$g(Se);this.lineMesh=Be,this.add(this.lineMesh),this.creatingObject=J(Be,this.pointSelector,Se),yield this.creatingObject.finished,this.config.defaultAction&&this.editor.enable()})}}function J($e,Se,Be){var De;const Ve=$e.parent;if(!Ve)return;const{promise:Fe,resolve:Je,reject:Xe}=i$d(),Ke=(De=Be?.limit)!=null?De:"none",Ye=new Oe($e.style);Ve.add(Ye);const or=new Oe(v(f$1({},$e.style),{dashed:!0,lengthEnable:!1}));Ve.add(or),Se.enable();const sr=[];let cr,Br,tn;const en=[],an=()=>sr.length>0,rn=()=>en.length>0,on=()=>{an()&&(en.push(sr.pop()),$e.setPoints(sr),cn(tn),Se.pointSelectorHelper.magnifier.render())},sn=()=>{rn()&&(sr.push(en.pop()),$e.setPoints(sr),cn(tn),Se.pointSelectorHelper.magnifier.render())},ln=An=>{if(!An)return;en.length=0;const xn=sr.length===0?An.point:cr.clone();sr.push(xn),$e.setPoints(sr),sr.length===2&&(hn(),Je())},cn=An=>{const xn=()=>{Ye.setPoints([]),or.setPoints([]),Se.pointSelectorHelper.magnifier.render()};if(!(sr!=null&&sr.length)||!An)return xn();tn=An;const pn=sr.at(-1).clone();Ke==="none"?(cr=An.point,Ye.setPoints([pn,cr])):Ke==="xoz"?(Se.plane=Br,Br=Br??new Plane().setFromNormalAndCoplanarPoint(new Vector3(0,1,0),sr[0]),cr=Br.projectPoint(An.point,new Vector3),Ye.setPoints([pn,cr]),or.setPoints([cr,An.point])):Ke==="y"&&(An.isVirtual?(cr=w$o({raycaster:An.raycaster,line:new Line3(sr[0].clone(),new Vector3(0,1,0).add(sr[0])),clampToLine:!1}),or.setPoints([])):(cr=new Line3(sr[0].clone(),new Vector3(0,1,0).add(sr[0])).closestPointToPoint(An.point,!1,new Vector3),or.setPoints([cr,An.point])),Ye.setPoints([pn,cr]))},hn=()=>{Se.off("select",ln),Se.off("intersectionUpdate",cn),Se.off("disable",mn),Se.plane=null,Se.disable(),Ve?.remove(Ye,or)},mn=()=>{hn(),sr.length!==2&&Ve?.remove($e),Xe(new Error("Cancelled"))};return Se.on("select",ln),Se.on("intersectionUpdate",cn),Se.on("disable",mn),{finished:Fe,canUndo:an,canRedo:rn,undo:on,redo:sn}}var L=Object.defineProperty,B=Object.defineProperties,U=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,g=($e,Se,Be)=>Se in $e?L($e,Se,{enumerable:!0,configurable:!0,writable:!0,value:Be}):$e[Se]=Be,a=($e,Se)=>{for(var Be in Se||(Se={}))_.call(Se,Be)&&g($e,Be,Se[Be]);if(y)for(var Be of y(Se))x.call(Se,Be)&&g($e,Be,Se[Be]);return $e},f=($e,Se)=>B($e,U(Se)),h=($e,Se,Be)=>(g($e,typeof Se!="symbol"?Se+"":Se,Be),Be),m=($e,Se,Be)=>new Promise((De,Ve)=>{var Fe=Ke=>{try{Xe(Be.next(Ke))}catch(Ye){Ve(Ye)}},Je=Ke=>{try{Xe(Be.throw(Ke))}catch(Ye){Ve(Ye)}},Xe=Ke=>Ke.done?De(Ke.value):Promise.resolve(Ke.value).then(Fe,Je);Xe((Be=Be.apply($e,Se)).next())});const u=class extends E$v{constructor($e,Se){super(),h(this,"group"),h(this,"theme"),h(this,"five"),h(this,"creatingItem",null),h(this,"undo",()=>{var Be;console.log("undo"),(Be=this.creatingItem)==null||Be.undo(),this.five.needsRender=!0}),h(this,"redo",()=>{var Be;console.log("redo"),(Be=this.creatingItem)==null||Be.redo(),this.five.needsRender=!0}),this.five=$e,this.theme=Se,this.group=new c$C,this.group.name="Sculpt",$e.scene.add(this.group),u.modules.init($e),K$e("ctrl+z, command+z",this.undo),K$e("ctrl+shift+z, command+shift+z",this.redo),u.modules.fiveDomEvents.addEventListener(this.group,"click",({intersects:Be,origDomEvent:De})=>{var Ve;const Fe=u$9((Ve=Be?.[0])==null?void 0:Ve.object,Je=>Je.isSculptObject);return Fe&&!Fe.editing?this.emit("click",De,Fe):!1}),window.__SCULPT_DEBUG__=this,window.__SCULPT_MODULES_DEBUG__=u.modules}get data(){return{items:this.items.map($e=>{try{return $e.data}catch(Se){return console.error(Se),null}}).filter(i$w)}}get items(){return this.group.children}load($e,Se){var Be;this.clear();const De=(Be=$e?.items)==null?void 0:Be.map(Ve=>{var Fe;const Je=f(a({},Ve),{style:a(a({},(Fe=this.theme)==null?void 0:Fe[Ve.type.toLowerCase()]),Ve.style)});return Ve.type==="Point"?new B$3(Je,Se):Ve.type==="line"?new ne(Je,Se):Ve.type==="Polyline"?new $(Je,Se):Ve.type==="Polygon"?new ie(Je,Se):Ve.type==="Prism"?new Z(Je,Se):Ve.type==="Rectangle"?new ge(Je,Se):Ve.type==="Circle"?new L$2(Je,Se):Ve.type==="Cylinder"?new Y(Je,Se):Ve.type==="Box"?new ot(Je,Se):null});this.group.add(...De),this.five.needsRender=!0}getItemById($e){return this.items.find(Se=>Se.uuid===$e)}putObject($e){var Se;this.group.add($e);const Be=u.modules.object3DHelper,De=Be.addObject3DHelper($e);return(Se=De?.moveController)==null||Se.moveByMouse(),Be}createPoint(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.point,$e[0]),this.createItem(B$3,...$e)})}createLine(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.line,$e[0]),this.createItem(ne,...$e)})}createline(...$e){return m(this,null,function*(){this.createLine(...$e)})}createPolyline(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.polyline,$e[0]),this.createItem($,...$e)})}createPolygon(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.polygon,$e[0]),this.createItem(ie,...$e)})}createPrism(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.prism,$e[0]),this.createItem(Z,...$e)})}createRectangle(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.rectangle,$e[0]),this.createItem(ge,...$e)})}createCircle(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.circle,$e[0]),this.createItem(L$2,...$e)})}createCylinder(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.cylinder,$e[0]),this.createItem(Y,...$e)})}createBox(...$e){return m(this,null,function*(){var Se,Be;return Object.assign((Se=$e[0])!=null?Se:{},(Be=this.theme)==null?void 0:Be.box,$e[0]),this.createItem(ot,...$e)})}canUndo(){var $e;return this.creatingItem?($e=this.creatingItem)==null?void 0:$e.canUndo():!1}canRedo(){var $e;return this.creatingItem?($e=this.creatingItem)==null?void 0:$e.canRedo():!1}clear(){f$2(this.items,$e=>$e.delete()),this.five.needsRender=!0}createItem($e,...Se){return m(this,null,function*(){this.creatingItem&&(this.creatingItem.stopCreating(),this.creatingItem=null);const Be=new $e;this.creatingItem=Be,this.group.add(Be);const{promise:De,resolve:Ve,reject:Fe}=i$d();return yield Be.create(...Se).then((...Je)=>(this.creatingItem=null,Ve(Be),Je)).catch(Je=>{Fe(Je),this.group.remove(Be)}),De})}};let p=u;h(p,"modules",v$6);c$P();A$z();function PanoTag(){const $e=reactExports.useRef(),Se=useController(),Be=useFiveInstance(),De=reactExports.useRef(Wr(Be,{config:{globalConfig:{visibleConfig:{keep:"visible"},unfoldedConfig:{autoUnfold:!1,unfoldDistance:{max:100}}}}}));return reactExports.useEffect(()=>{if(Se.configs?.keyframeMap.PanoTag===!1)return;const Ve=Fe=>{if(!De.current)return;const{start:Je,end:Xe,data:Ke}=Fe,Ye=Ke,or=Date.now().toString(),sr="PointTag",cr="2D",Br=[Ye.vertex.x,Ye.vertex.y,Ye.vertex.z],tn=Ye.imgUrl?{id:or,pointType:sr,position:Br,dimensionType:cr,contentType:"ImageText",stickType:"2DPoint",data:{text:Ye.text,mediaData:[{type:"Image",url:Ye.imgUrl}]}}:{id:or,pointType:sr,position:Br,dimensionType:cr,contentType:"Text",stickType:"2DPoint",data:{text:Ye.text}};De.current.load({tagList:[tn]});const en=De.current.getTagById(or);en&&(en.state.unfolded=!0,De.current.updateRenderAllTags()),$e.current=setTimeout(()=>{const an=De.current.getTagById(or);an&&(an.state&&(an.state.unfolded=!1,De.current.updateRenderAllTags()),an.hooks?.on("folded",()=>{setTimeout(()=>{an.state&&(an.state.visible=!1,De.current.destroyTagById(or))},1500)}))},Xe-Je)};return Se.on(VreoKeyframeEnum.PanoTag,Ve),()=>{Se.off(VreoKeyframeEnum.PanoTag,Ve),$e.current&&clearTimeout($e.current)}},[Se]),null}var CSS3DObject=function($e){Object3D.call(this),this.element=$e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.addEventListener("removed",function(){this.traverse(function(Se){Se.element instanceof Element&&Se.element.parentNode!==null&&Se.element.parentNode.removeChild(Se.element)})})};CSS3DObject.prototype=Object.create(Object3D.prototype);CSS3DObject.prototype.constructor=CSS3DObject;var CSS3DSprite=function($e){CSS3DObject.call(this,$e)};CSS3DSprite.prototype=Object.create(CSS3DObject.prototype);CSS3DSprite.prototype.constructor=CSS3DSprite;var CSS3DRenderer=function(){var $e=this,Se,Be,De,Ve,Fe=new Matrix4,Je={camera:{fov:0,style:""},objects:new WeakMap},Xe=document.createElement("div");Xe.style.overflow="hidden",this.domElement=Xe;var Ke=document.createElement("div");Ke.style.WebkitTransformStyle="preserve-3d",Ke.style.transformStyle="preserve-3d",Ke.style.pointerEvents="none",Xe.appendChild(Ke);var Ye=/Trident/i.test(navigator.userAgent);this.getSize=function(){return{width:Se,height:Be}},this.setSize=function(rn,on){Se=rn,Be=on,De=Se/2,Ve=Be/2,Xe.style.width=rn+"px",Xe.style.height=on+"px",Ke.style.width=rn+"px",Ke.style.height=on+"px"};function or(rn){return Math.abs(rn)<1e-10?0:rn}function sr(rn){var on=rn.elements;return"matrix3d("+or(on[0])+","+or(-on[1])+","+or(on[2])+","+or(on[3])+","+or(on[4])+","+or(-on[5])+","+or(on[6])+","+or(on[7])+","+or(on[8])+","+or(-on[9])+","+or(on[10])+","+or(on[11])+","+or(on[12])+","+or(-on[13])+","+or(on[14])+","+or(on[15])+")"}function cr(rn,on){var sn=rn.elements,ln="matrix3d("+or(sn[0])+","+or(sn[1])+","+or(sn[2])+","+or(sn[3])+","+or(-sn[4])+","+or(-sn[5])+","+or(-sn[6])+","+or(-sn[7])+","+or(sn[8])+","+or(sn[9])+","+or(sn[10])+","+or(sn[11])+","+or(sn[12])+","+or(sn[13])+","+or(sn[14])+","+or(sn[15])+")";return Ye?"translate(-50%,-50%)translate("+De+"px,"+Ve+"px)"+on+ln:"translate(-50%,-50%)"+ln}function Br(rn,on,sn,ln){if(rn instanceof CSS3DObject){rn.onBeforeRender($e,on,sn);var cn;rn instanceof CSS3DSprite?(Fe.copy(sn.matrixWorldInverse),Fe.transpose(),Fe.copyPosition(rn.matrixWorld),Fe.scale(rn.scale),Fe.elements[3]=0,Fe.elements[7]=0,Fe.elements[11]=0,Fe.elements[15]=1,cn=cr(Fe,ln)):cn=cr(rn.matrixWorld,ln);var hn=rn.element,mn=Je.objects.get(rn);if(mn===void 0||mn.style!==cn){hn.style.WebkitTransform=cn,hn.style.transform=cn;var An={style:cn};Ye&&(An.distanceToCameraSquared=tn(sn,rn)),Je.objects.set(rn,An)}hn.style.display=rn.visible?"":"none",hn.parentNode!==Ke&&Ke.appendChild(hn),rn.onAfterRender($e,on,sn)}for(var xn=0,pn=rn.children.length;xn<pn;xn++)Br(rn.children[xn],on,sn,ln)}var tn=function(){var rn=new Vector3,on=new Vector3;return function(sn,ln){return rn.setFromMatrixPosition(sn.matrixWorld),on.setFromMatrixPosition(ln.matrixWorld),rn.distanceToSquared(on)}}();function en(rn){var on=[];return rn.traverse(function(sn){sn instanceof CSS3DObject&&on.push(sn)}),on}function an(rn){for(var on=en(rn).sort(function(hn,mn){var An=Je.objects.get(hn).distanceToCameraSquared,xn=Je.objects.get(mn).distanceToCameraSquared;return An-xn}),sn=on.length,ln=0,cn=on.length;ln<cn;ln++)on[ln].element.style.zIndex=sn-ln}this.render=function(rn,on){var sn=on.projectionMatrix.elements[5]*Ve;if(Je.camera.fov!==sn&&(on.isPerspectiveCamera?(Xe.style.WebkitPerspective=sn+"px",Xe.style.perspective=sn+"px"):(Xe.style.WebkitPerspective="",Xe.style.perspective=""),Je.camera.fov=sn),rn.autoUpdate===!0&&rn.updateMatrixWorld(),on.parent===null&&on.updateMatrixWorld(),on.isOrthographicCamera)var ln=-(on.right+on.left)/2,cn=(on.top+on.bottom)/2;var hn=on.isOrthographicCamera?"scale("+sn+")translate("+or(ln)+"px,"+or(cn)+"px)"+sr(on.matrixWorldInverse):"translateZ("+sn+"px)"+sr(on.matrixWorldInverse),mn=hn+"translate("+De+"px,"+Ve+"px)";Je.camera.style!==mn&&!Ye&&(Ke.style.WebkitTransform=mn,Ke.style.transform=mn,Je.camera.style=mn),Br(rn,rn,on,hn),Ye&&an(rn)}};function evenNumber($e,Se){const Be=Math.round($e);return Be%2===0?Be:Be+(Se?.smaller?-1:1)}function centerPoint($e,Se){return new Vector3(($e.x+Se.x)/2,($e.y+Se.y)/2,($e.z+Se.z)/2)}const transformPositionToVector3=({x:$e,y:Se,z:Be})=>new Vector3($e,Se,Be);function createResizeObserver($e,Se){if(!Se||typeof ResizeObserver>"u")return{observe:()=>window.addEventListener("resize",$e),unobserve:()=>window.removeEventListener("resize",$e)};{const Be=new ResizeObserver($e);return{observe:()=>Be.observe(Se),unobserve:()=>Be.unobserve(Se)}}}const CSS3DRenderPlugin=$e=>{const Se={disposeCallbacks:[]},Be=(...Ve)=>{const Fe=Ve[0].map(fn=>fn instanceof Vector3?fn:transformPositionToVector3(fn)),Je=Ve[1];if(Fe?.length<4)return console.error("points must be equal or greater than than 4");if(!$e?.model?.loaded)return console.error("five.model.loaded is: ",$e?.model?.loaded);const Xe=$e.getElement();if(!Xe)return console.error("five.getElement() is "+Xe);const Ke=[],Ye=Je?.ratio||.00216;Ye<=.00215&&console.warn("if you need click css3DElement on safari, ratio must be greater than 0.00215");const or=Je?.dpr||1,sr=Je?.mode||"front",cr=Je?.autoRender??!0,Br=Je?.behindFiveContainer||Xe.parentElement||document.body,tn=Je?.container||document.createElement("div");tn.classList.add("__Dnalogel-plugin--CSS3DRenderPlugin");const{css3DObject:en,mesh:an}=De(Fe,{ratio:Ye,dpr:or,container:tn,mode:sr});let rn;const on=sr==="front"&&!Se.frontMode,sn=sr==="behind"&&!Se.behindMode,ln=!(on||sn);let cn=!1,hn=null;sn&&(Se.behindMode={scene:new Scene$1,css3DRenderer:new CSS3DRenderer}),on&&(Se.frontMode={scene:new Scene$1,css3DRenderer:new CSS3DRenderer});const{scene:mn,css3DRenderer:An}=sr==="behind"?Se.behindMode:Se.frontMode,xn=(()=>{if(ln)return()=>{mn.add(en)};{const fn=()=>{const Sn=evenNumber(Xe.clientWidth,{smaller:!0}),gn=evenNumber(Xe.clientHeight,{smaller:!0});An.setSize(Sn,gn)};fn(),rn=createResizeObserver(fn,Xe),An.domElement.style.position="absolute",An.domElement.style.top="0",An.domElement.style.userSelect="none",An.domElement.style.pointerEvents="none";const yn=()=>{cn||(hn=requestAnimationFrame(yn),An.render(mn,$e.camera))};return()=>{mn.add(en),rn?.observe?.(),yn(),sr==="behind"&&an&&($e.scene.add(an),Ke.push(()=>an&&$e.scene.remove(an)))}}})();on&&(Xe.parentElement||document.body).appendChild(An.domElement),sn&&Br.appendChild(An.domElement);const pn=()=>(cn=!0,Ke.forEach(fn=>fn?.()),mn.remove(en),typeof hn=="number"&&cancelAnimationFrame(hn),mn.children.length===0&&(An.domElement.remove(),sr==="front"&&(Se.frontMode=void 0),sr==="behind"&&(Se.behindMode=void 0),!Se.behindMode&&!Se.frontMode&&rn?.unobserve?.()),!0),dn=Se.disposeCallbacks.findIndex(fn=>fn===pn);return dn!==-1?Se.disposeCallbacks.splice(dn,1):Se.disposeCallbacks.push(pn),cr&&xn(),{container:tn,dispose:pn,css3DObject:en,render:cr?void 0:xn}},De=(Ve,Fe)=>{const{ratio:Je,dpr:Xe,container:Ke,mode:Ye}=Fe,or=Ve[0].distanceTo(Ve[1]),sr=Ve[1].distanceTo(Ve[2]),cr=evenNumber(or/Je*Xe),Br=evenNumber(sr/Je*Xe),tn=new CSS3DObject(Ke);tn.scale.set(Je,Je,Je),Ke.style.width=cr+"px",Ke.style.height=Br+"px",Ke.style.pointerEvents="none";const en=centerPoint(Ve[0],Ve[2]),an=Ve[1].clone().sub(Ve[0]),rn=Ve[2].clone().sub(Ve[1]),on=new Vector3(0,1,0).angleTo(new Vector3(0,rn.y,rn.z)),sn=new Vector3(1,0,0).angleTo(new Vector3(an.x,0,an.z)),ln=an.angleTo(new Vector3(an.x,0,an.z)),cn=(rn.z>0?-1:1)*on,hn=(an.z<0?1:-1)*sn,mn=(an.x>0&&an.y<0||an.x<0&&an.y>0?-1:1)*ln;tn.rotateOnWorldAxis(new Vector3(1,0,0),cn),tn.rotateOnWorldAxis(new Vector3(0,1,0),hn),tn.rotateOnWorldAxis(new Vector3(0,0,1),mn),tn.position.set(en.x,en.y,en.z);let An;if(Ye==="behind"){const xn=new MeshBasicMaterial({opacity:0,transparent:!1,side:DoubleSide}),pn=new PlaneGeometry(cr,Br);An=new Mesh(pn,xn),An.name="CSS3DRenderPlugin-mesh",An.position.copy(tn.position),An.rotation.copy(tn.rotation),An.scale.copy(tn.scale)}return{css3DObject:tn,mesh:An}};return{create3DDomContainer:Be,disposeAll:()=>{Se.disposeCallbacks.forEach(Ve=>Ve?.()),Se.disposeCallbacks=[]}}},calcPoints=($e,Se,Be,De)=>{const Ve=Be/375,Fe=De/375,Je=new PlaneGeometry(Ve,Fe);if(Se){const on=new Vector3(Se.x+$e.x,Se.y+$e.y,Se.z+$e.z);Je.lookAt(on)}const Xe=new MeshBasicMaterial({color:16776960,side:DoubleSide}),Ke=new Mesh(Je,Xe),Ye=$e.clone();Ke.position.copy(Ye);const[or,sr,cr,Br]=Ke.geometry.vertices,tn=Ye.clone().add(Br),en=Ye.clone().add(cr),an=Ye.clone().add(sr),rn=Ye.clone().add(or);return[tn,en,rn,an]};function PanoTextLabel(){const $e=reactExports.useRef(),Se=useController(),Be=useFiveInstance(),De=reactExports.useRef();return reactExports.useEffect(()=>{if(Se.configs?.keyframeMap.PanoTextLabel===!1)return;const Ve=Fe=>{const{start:Je,end:Xe,data:Ke}=Fe,Ye=Ke;if(Ke.text==="")return;const{x:or,y:sr,z:cr}=Ye.vertex,Br=new Vector3(or,sr,cr),tn=new Vector3(Ye.normal?.x,Ye.normal?.y,Ye.normal?.z),rn=calcPoints(Br,Ye.normal&&tn,200,30);De.current||(De.current=CSS3DRenderPlugin(Be));const on=De.current.create3DDomContainer(rn),sn=on?.css3DObject;if(Ke.quaternion){const ln=new Quaternion(Ke.quaternion.x,Ke.quaternion.y,Ke.quaternion.z,Ke.quaternion.w);sn?.quaternion.copy(ln)}on?.container&&ReactDOM.render(jsxRuntimeExports.jsx("div",{className:"PanoTextLabel PanoTextLabel--notHidden",children:jsxRuntimeExports.jsx("div",{className:"PanoTextLabel-wrapper",children:jsxRuntimeExports.jsx("div",{style:{fontSize:`${Ke.fontSize||16}px`},className:"PanoText-innerText",children:Ke.text||""})})}),on?.container),$e.current=setTimeout(()=>{De.current?.disposeAll()},Xe-Je)};return Se.on(VreoKeyframeEnum.PanoTextLabel,Ve),()=>{Se.off(VreoKeyframeEnum.PanoTextLabel,Ve),$e.current&&clearTimeout($e.current)}},[Se]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}function Prompter(){const[$e,Se]=reactExports.useState(""),[Be,De]=reactExports.useState(!0),Ve=reactExports.useRef(null),Fe=useController();return reactExports.useEffect(()=>{if(Fe.configs?.keyframeMap.Prompter===!1)return;const Je=Xe=>{const{start:Ke,end:Ye,data:or}=Xe;Se(or.text),De(!1),Ve.current&&(clearTimeout(Ve.current),Ve.current=null),Ve.current=setTimeout(()=>{De(!0),Se(""),Ve.current&&clearTimeout(Ve.current),Ve.current=null},Ye-Ke)};return Fe.on(VreoKeyframeEnum.Prompter,Je),()=>{Fe.off(VreoKeyframeEnum.Prompter,Je)}},[Fe]),jsxRuntimeExports.jsx("div",{className:classNames("vreo-prompter",{"vreo-prompter--hidden":Be,[`vreo-prompter-left--${Fe.agentType}`]:!0}),children:jsxRuntimeExports.jsx("div",{className:"vreo-prompter-text",children:jsxRuntimeExports.jsx("div",{className:"vreo-prompter-innerText",children:$e})})})}function UpdateVRPanorama(){const $e=useController(),Se=useFiveInstance(),Be=reactExports.useRef(null),De=reactExports.useRef(null),Ve=reactExports.useCallback(()=>{if(De.current=null,Be.current){const Xe=parseWork(Be.current);Se.load(Xe)}},[]),Fe=reactExports.useCallback(()=>{if(Be.current){const Xe=parseWork(Be.current);Object.assign(window,{$rawWork:Xe}),Se.load(Xe)}},[]),Je=reactExports.useCallback(()=>{De.current&&Se.load(De.current)},[]);return reactExports.useEffect(()=>{const Xe=Ke=>{!Be.current&&Se.work?.raw?.works&&(Be.current=Se.work.raw.works);const Ye=Ke.data;if(Ye.work){De.current=parseWork(Ye.work),Se.load(De.current);return}const or=Se.work?.raw?.works?.[0];if(!or){console.warn("No raw work found");return}if(Ye.dynamic_scene&&!Ye.panorama){const cr=JSON.parse(or).panorama,Br=Ye.dynamic_scene.images.index;cr.list[Br]=Ye.dynamic_scene.images,Ye.panorama=cr,delete Ye.dynamic_scene}Object.assign(window,{$work1:JSON.parse(or),$work2:Ye,parseWork}),De.current=parseWork([or,Ye]),Se.load(De.current)};return $e.on(VreoKeyframeEnum.UpdateVRPanorama,Xe),$e.on(VreoKeyframeEnum.Exit,Ve),$e.on("loaded",Ve),$e.on("paused",Fe),$e.on("playing",Je),()=>{$e.off(VreoKeyframeEnum.UpdateVRPanorama,Xe),$e.off(VreoKeyframeEnum.Exit,Ve),$e.off("loaded",Ve),$e.off("paused",Fe),$e.off("playing",Je)}},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}const inlinePlay=$e=>{if(!$e)return;const Se=()=>{$e.removeEventListener("canplaythrough",Se);try{$e.play()}catch{}};$e.addEventListener("canplaythrough",Se),$e.load()},PI=Math.PI,PI_2=PI*2;function VideoEffect(){const $e=reactExports.useRef(null),Se=reactExports.useRef(),Be=useController(),De=reactExports.useRef(),[Ve,Fe]=reactExports.useState(!1),Je=useFiveInstance(),Xe=Ke=>{Se.current&&(Se.current.src=Ke)};return reactExports.useEffect(()=>{const Ke=async or=>{const{start:sr,end:cr}=or,{videoSrc:Br,fov:tn,direction:en,panoIndex:an,vector:rn}=or.data,[on,sn]=(()=>{if(rn)return[rn.longitude,rn.latitude];if(!en)return[0,0];let ln=-Math.atan2(en.x,-en.z);ln=(ln%PI_2+PI_2)%PI_2;const cn=-Math.asin(en.y/1);return[ln,cn]})();Je.setState({fov:tn,panoIndex:an,longitude:on,latitude:sn},!0),Xe(Br),inlinePlay(Se.current),Fe(!0),De.current=setTimeout(()=>{Se.current?.pause(),Fe(!1),Xe("")},cr-sr)};Be.on(VreoKeyframeEnum.VideoEffect,Ke);const Ye=()=>{De.current&&clearTimeout(De.current),Se.current?.pause(),Fe(!1),Xe("")};return Be.on("paused",()=>Ye()),Be.on("ended",()=>Ye()),()=>{Be.off(VreoKeyframeEnum.VideoEffect,Ke),De.current&&clearTimeout(De.current)}},[Be]),reactExports.useEffect(()=>{if(!$e.current)return;const Ke=Be.configs?.videos?.videoEffect||document.createElement("video");Ke.setAttribute("playsinline","true"),Ke.setAttribute("webkit-playsinline","true"),Ke.setAttribute("autoplay","true"),Ke.setAttribute("key","VideoEffect-video"),Ke.setAttribute("class","VideoEffect-video"),Se.current=Ke,$e.current.append(Se.current),document.addEventListener("WeixinJSBridgeReady",function(){Se.current?.play()},!1),$e.current},[]),jsxRuntimeExports.jsx("div",{ref:$e,className:classNames("VideoEffect",{"VideoEffect--visible":Ve})})}const Preloader={blob:$e=>{const Se=()=>null;return new Promise((Be,De)=>{const Ve=new XMLHttpRequest,Fe=()=>{Ve.ontimeout=Se,Ve.onreadystatechange=Se,Ve.onprogress=Se,Ve.onabort=Se};Ve.ontimeout=()=>{De(new Error("timeout")),Fe()},Ve.onreadystatechange=()=>{Ve.readyState===4&&(Ve.status===0&&!Ve.response||(Ve.status===200||Ve.status===0?(Be(Ve.response),Fe()):(De(new Error(`status:${Ve.status}`)),Fe())))},Ve.open("GET",$e,!0),Ve.responseType="blob",Ve.send(null)})}};class AudioLike extends Subscribe{$timestamp=0;$currentTime=0;$duration=0;stopInterval;muted=!1;src="";setAttribute(Se,Be){}constructor({duration:Se}={}){super(),Se&&(this.$duration=Se)}play(){this.$timestamp===0&&(this.$timestamp=performance.now()),this.$currentTime===this.$duration&&(this.$currentTime=0),this.stopInterval=requestAnimationFrameInterval(()=>this.requestAnimationFrameLoop()),this.emit("play")}pause(){this.stopInterval&&(this.stopInterval(),this.emit("pause"),this.stopInterval=void 0),this.$timestamp=0}requestAnimationFrameLoop(){const Se=performance.now();this.$currentTime=Se-this.$timestamp,this.emit("timeupdate"),this.$currentTime>=this.$duration-10&&(this.$currentTime=this.$duration,this.pause(),this.emit("ended"))}get currentTime(){return this.$currentTime/1e3}set currentTime(Se){this.$currentTime=Se*1e3}get duration(){return this.$duration}set duration(Se){this.pause(),this.$duration=Se,this.$timestamp=0,this.$currentTime=0}get ended(){return this.$currentTime===this.$duration}get paused(){return!this.stopInterval}addEventListener(Se,Be,De=!1){this.on(Se,Be)}removeEventListener(Se,Be,De=!1){this.off(Se,Be)}}const vertexShader=`
varying vec2 vUv;
varying vec2 vColorUv;
varying vec2 vMaskUv;
void main(){
  vUv = uv;
  vColorUv = vec2(uv.x / 2.0, uv.y);
  vMaskUv = vec2(0.5 + uv.x / 2.0, uv.y);
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,fragmentShaderTpl=()=>`
uniform int enable;
uniform sampler2D map;
varying vec2 vUv;
varying vec2 vColorUv;
varying vec2 vMaskUv;

vec3 hsv2rgb(vec3 c) {
  const vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}

vec3 rgb2hsv(vec3 c) {
  const vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
  vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
  vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

  float d = q.x - min(q.w, q.y);
  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + 0.001)), d / (q.x + 0.001), q.x);
}

void main(void) {
  vec3 color = texture2D(map, vUv).xyz;
  float amask = 1.0;

  float ref = color.r;
  if (ref < color.b) ref = color.b;
  amask = color.g - ref + 0.1;
  amask = smoothstep(0.1, 0.3, amask);
  amask = 1.0 - amask;

  vec3 target = rgb2hsv(vec3(0.0 / 255.0, 255.0 / 255.0, 0.0 / 255.0));
  vec3 hsv = rgb2hsv(color);
  float distance = abs(hsv.x - target.x);
  if (distance < 0.15) {
    hsv.y = 0.0;
  }
  color = hsv2rgb(hsv);

  gl_FragColor = vec4(color.rgb, amask * float(enable));
}
`,cacheInstance={};class VideoAgentMesh extends Mesh{options;videoUrl;freeze;paused;audioInstance;audioLikeInstance;$removeEventListener;get mediaInstance(){return this.videoUrl?getMediaType(this.videoUrl)==="audio"?this.audioInstance:this.material.uniforms.map.value.image:this.audioLikeInstance}constructor(Se,Be,De,Ve,Fe={preload:!0}){if(!Fe.videoInstance)if(cacheInstance.videoInstance)Fe.videoInstance=cacheInstance.videoInstance;else{const cr=document.createElement("video");cr.style.opacity="0",cr.style.pointerEvents="none",cr.style.display="none",document.body.append(cr),Fe.videoInstance=cr,cacheInstance.videoInstance=cr,cr.playsInline=!0,cr.controls=!1}const Je=new PlaneGeometry(Se,Be,De,Ve),Xe=new VideoTexture(Fe.videoInstance),Ke=new ShaderMaterial({uniforms:{map:{value:Xe},enable:{value:0}},vertexShader,fragmentShader:fragmentShaderTpl(),transparent:!0});if(super(Je,Ke),this.options=Fe,this.freeze=!1,this.paused=!0,Fe.audioInstance)this.audioInstance=Fe.audioInstance;else if(cacheInstance.audioInstance)this.audioInstance=cacheInstance.audioInstance;else{const cr=document.createElement("audio");cr.crossOrigin="",cr.muted=!1,cr.autoplay=!1,cr.style.display="none",document.body.appendChild(cr),this.audioInstance=cr,cacheInstance.audioInstance=cr}this.audioLikeInstance=new AudioLike,makeObservable(this,{paused:observable});const Ye=cr=>runInAction(()=>this.paused=cr),or=()=>Ye(!0),sr=()=>Ye(!1);this.audioInstance.addEventListener("pause",or),this.audioInstance.addEventListener("play",sr),this.options.videoInstance?.addEventListener("pause",or),this.options.videoInstance?.addEventListener("play",sr),this.audioLikeInstance.addEventListener("pause",or),this.audioLikeInstance.addEventListener("play",sr),this.$removeEventListener=()=>{this.audioInstance.removeEventListener("pause",or),this.audioInstance.removeEventListener("play",sr),this.options.videoInstance?.removeEventListener("pause",or),this.options.videoInstance?.removeEventListener("play",sr),this.audioLikeInstance.removeEventListener("pause",or),this.audioLikeInstance.removeEventListener("play",sr)}}async update(Se){if(this.videoUrl===Se)return;this.videoUrl=Se,this.freeze=!0,await this.mediaInstance.pause();const Be=this.material.uniforms;this.mediaInstance.muted=!0,this.mediaInstance.src=this.options.preload||this.options.preload===void 0||getMediaType(this.videoUrl)==="video"?await URL.createObjectURL(await Preloader.blob(this.videoUrl)):this.videoUrl,this.mediaInstance.setAttribute("data-src",this.videoUrl);const De=()=>{this.mediaInstance.currentTime!==0&&(this.freeze=!1,this.mediaInstance.muted=!1,Be.enable.value=getMediaType(this.videoUrl)?1:0,this.mediaInstance.removeEventListener("timeupdate",De,!1))};this.mediaInstance.addEventListener("timeupdate",De,!1)}async play(Se="",Be=0,De){return Se=Se||"",De&&!Se?(this.currentTime&&(this.mediaInstance.currentTime=Be),this.mediaInstance.duration=De,this.videoUrl="",this.mediaInstance.play(),!0):Se?Se===this.videoUrl?(this.mediaInstance.currentTime=Be,await this.mediaInstance.play(),!0):(await this.update(Se),this.mediaInstance.pause(),await new Promise(Ve=>setTimeout(async()=>{this.mediaInstance.currentTime=Be,await this.mediaInstance.play(),Ve(!0)},20))):(this.videoUrl?await this.mediaInstance.play():console.warn("警告：视频资源未初始化。"),!0)}get currentTime(){return this.mediaInstance.currentTime*1e3}dispose(){this.$removeEventListener(),cacheInstance.audioInstance&&(document.body.removeChild(cacheInstance.audioInstance),cacheInstance.audioInstance=void 0),cacheInstance.videoInstance&&(document.body.removeChild(cacheInstance.videoInstance),cacheInstance.videoInstance=void 0)}}class VideoAgentScene{videoAgentMesh;scene=new Scene$1;camera=new OrthographicCamera(-240,240,135,-135);renderer=new WebGLRenderer({alpha:!0});disposers=[];constructor(Se,Be){if(this.videoAgentMesh=new VideoAgentMesh(480,270,1,1,Be),Se){this.camera.position.set(0,0,10),this.camera.lookAt(0,0,0);const De=this.renderer.domElement;De.classList.add("VideoAgent-canvas");const Ve=addResizeListener(Se,(Fe,Je)=>{this.renderer.setSize(Fe*window.devicePixelRatio,Je*window.devicePixelRatio),De.style.width=`${Fe}px`,De.style.height=`${Je}px`});this.disposers.push(Ve),Se.append(De),this.scene.add(this.videoAgentMesh),this.run()}}run=()=>{!(this.videoAgentMesh.paused||this.videoAgentMesh.freeze)&&this.videoAgentMesh.currentTime>1e3&&this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.run)};dispose=()=>{this.videoAgentMesh?.dispose(),this.disposers.forEach(Se=>Se?.())}}function VideoAgent($e){const Se=reactExports.useRef(null),Be=useController(),De=reactExports.useMemo(()=>Be.avatar?.url&&Be.avatar.force===!0,[Be.avatar]),Ve=reactExports.useMemo(()=>De?!1:Be.videoAgentScene?.videoAgentMesh.mediaInstance instanceof HTMLVideoElement,[Be.videoAgentScene,De]);return reactExports.useEffect(()=>{if(!Se.current)throw new Error("React 渲染异常，请稍后重试 ...");if(Be.videoAgentScene){console.warn('VideoAgentScene" 重复初始化，已被过滤');return}const Fe=new VideoAgentScene(Se.current,$e.options);return Be.videoAgentScene=Fe,()=>{Be.dispose(),Be.videoAgentScene?.dispose()}},[]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"Avatar",style:{display:De?"block":"none"},children:jsxRuntimeExports.jsx("div",{className:"Avatar-wrapper ratio-1-1",children:jsxRuntimeExports.jsx("img",{className:"Avatar-img",src:Be.avatar?.url,onClick:()=>$e.onClick?.()})})}),jsxRuntimeExports.jsx("div",{className:classNames("VideoAgent",{hide:!Ve}),children:jsxRuntimeExports.jsx("div",{className:"VideoAgent-container",children:jsxRuntimeExports.jsx("div",{className:"VideoAgent-wrapper ratio-16-9",children:jsxRuntimeExports.jsx("div",{className:"VideoAgent-inner",ref:Se,children:jsxRuntimeExports.jsx("div",{className:"VideoAgent-play",onClick:()=>$e.onClick?.()})})})})})]})}const blankAudioSrc="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAADAAAGhgBVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVWqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr///////////////////////////////////////////8AAAA5TEFNRTMuOThyAc0AAAAAAAAAABSAJAiqQgAAgAAABobxtI73AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uQxAACFEII9ACZ/sJZwWEoEb8w/////N//////JcxjHjf+7/v/H2PzCCFAiDtGeyBCIx7bJJ1mmEEMy6g8mm2c8nrGABB4h2Mkmn//4z/73u773R5qHHu/j/w7Kxkzh5lWRWdsifCkNAnY9Zc1HvDAhjhSHdFkHFzLmabt/AQxSg2wwzLhHIJOBnAWwVY4zrhIYhhc2kvhYDfQ4hDi2Gmh5KyFn8EcGIrHAngNgIwVIEMf5bzbAiTRoAD///8z/KVhkkWEle6IX+d/z4fvH3BShK1e5kmjkCMoxVmXhd4ROlTKo3iipasvTilY21q19ta30/v/0/idPX1v8PNxJL6ramnOVsdvMv2akO0iSYIzdJFirtzWXCZicS9vHqvSKyqm5XJBdqBwPxyfJdykhWTZ0G0ZyTZGpLKxsNwwoRhsx3tZfhwmeOBVISm3impAC/IT/8hP/EKEM1KMdVdVKM2rHV4x7HVXZvbVVKN/qq8CiV9VL9jjH/6l6qf7MBCjZmOqsAibjcP+qqqv0oxqpa/NVW286hPo1nz2L/h8+jXt//uSxCmDU2IK/ECN98KKtE5IYzNoCfbw+u9i5r8PoadUMFPKqWL4LK3T/LCraMSHGkW4bpLXR/E6LlHOVQxmslKVJ8IULktMN06N0FKCpHCoYsjC4F+Z0NVqdNFoGSTjSiyjzLdnZ2fNqTi2eHKONONKLMPMKLONKLMPQRJGlFxZRoKcJFAYEeIFiRQkUWUeYfef//Ko04soswso40UJAgMw8wosososy0EalnZyjQUGBRQGIFggOWUacWUeYmuadrZziQKKEgQsQLAhQkUJAgMQDghltLO1onp0cpkNInSFMqlYeSEJ5AHsqFdOwy1DA2sRmRJKxdKRfLhfLw5BzUxBTUUzLjk4LjJVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUxBTUUzLjk4LjJVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7ksRRA8AAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVU=",audioList=[];function getAudio($e){let Se=audioList.find(Be=>!Be.realSrc||Be.realSrc===blankAudioSrc);return Se||(Se=new IAudio(blankAudioSrc),audioList.push(Se)),$e&&(Se.src=$e),Se}async function waitForBlankAudioGenerated($e=100,Se=2e3){console.log("waitForBlankAudioGenerated, needGenerate: ",audioList.some(Ve=>!Ve.ended&&Ve.src===blankAudioSrc));const Be=Date.now();let De=!1;for(;audioList.some(Ve=>!Ve.ended&&Ve.src===blankAudioSrc)&&!De;){if(Date.now()-Be>Se)return De=!0,Promise.resolve();await new Promise(Ve=>setTimeout(Ve,$e))}}function generateBlankAudio($e){const Se=$e-audioList.length;if(!(Se<=0))for(let Be=0;Be<Se;Be++)audioList.push(new IAudio(blankAudioSrc))}function initAudio($e){$e.inited||($e.src&&($e.inited=!0,$e.removeDocumentEventListener()),$e.src===blankAudioSrc&&$e.play())}class IAudio extends Audio{preload="auto";get src(){return this.getAttribute("src")||""}set src(Se){this.setAttribute("src",Se),this.realSrc=Se}realSrc="";inited=!1;removeDocumentEventListener;constructor(Se){super(Se),this.realSrc=Se??"",super.addEventListener("ended",()=>{this.src=""});const Be=()=>initAudio(this);document.addEventListener("click",Be),document.addEventListener("touchend",Be),this.removeDocumentEventListener=()=>{document.removeEventListener("click",Be),document.removeEventListener("touchend",Be)}}}function BgMusic(){const $e=useController();return reactExports.useEffect(()=>{const Se=async(Be,De)=>{const{start:Ve,end:Fe}=Be,Je=(De-Ve)/1e3;if(Je<0||Je>=Be.end-Be.start)return;const Xe=getAudio(Be.data.url);Xe.currentTime=Math.max(0,Je),Xe.play();const Ke=()=>{Xe.removeEventListener("pause",Ye),Xe.pause(),Xe.src=""};Xe.addEventListener("ended",()=>{Ke()});const Ye=()=>{Xe.realSrc===Be.data.url&&Xe.play()};Xe.addEventListener("pause",Ye),$e.once("paused",()=>{Ke()})};return $e.on(VreoKeyframeEnum.BgMusic,Se),()=>{$e.off(VreoKeyframeEnum.BgMusic,Se)}}),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}const defaultPrefix="https://vr-public.realsee-cdn.cn/release/static/image/release/",WAVES={single:{width:766,height:60,frames:20,hevc:"vapor/static/wave-single.140d197f4838c130b69e87dfd0705479.mov",vp9:"vapor/static/wave-single.eda65de390a830193fff40d1f1255555.webm",png:"vapor/static/wave-single.f51aade2a6e1c59211698a1a24e6135f.png"},double:{width:766,height:60,frames:16,hevc:"vapor/static/wave-double.3e6d73050ee6958cc3060b107ebe5f39.mov",vp9:"/vapor/static/wave-double.77dfe8548ebcb3f3d336785d4fe9c7b2.webm",png:"/vapor/static/wave-double.ab4fe7d8a70395109ca4f759af7bd53f.png"},solid:{width:1126,height:90,frames:48,hevc:"vapor/static/wave-solid.cf68912a93275d07aa6b5097ea11fdda.mov",vp9:"vapor/static/wave-solid.64438b63cbb346906d066bb7b8dc3e20.webm",png:"vapor/static/wave-solid.6969d7f3f2f44f7ac1ade30e65660cb1.png"},swap:{width:2250,height:180,frames:41,hevc:"vapor/static/wave-swap.b38f22e2cf84ee21e9be35f7f56c9cfc.mov",vp9:"vapor/static/wave-swap.c02e4b94cf05aecf6e7a0023bc7bb90f.webm",png:"vapor/static/wave-swap.772ba526a7210dcc01567062c6319545.png"},expand:{width:2250,height:180,frames:45,hevc:"vapor/static/wave-expand.9529956c5954740cd4c9d07d51e32822.mov",vp9:"vapor/static/wave-expand.a0d2a0074001cd3d4fea56818c6d3c38.webm",png:"vapor/static/wave-expand.62fcf27b445533e6eb1b17bab5eafa0d.png"}},userAgent=typeof navigator<"u"?navigator.userAgent:"",isAppleDevice=/(iPhone|iPad|iPod)/i.test(userAgent),isSafari=/safari/i.test(userAgent)&&!/chrome/i.test(userAgent)&&/version/i.test(userAgent),isMicroMessenger=/microMessenger/i.test(userAgent),canPlayHevc=isAppleDevice||isSafari,canPlayVp9=typeof MediaSource<"u"&&MediaSource.isTypeSupported("video/webm; codecs=vp9");function Wave($e){const Se=React.useMemo(()=>{const Ve=$e?.appearance??"solid";return WAVES[Ve]},[$e?.appearance]),Be=React.useMemo(()=>Se.height/Se.width,[Se]);let De=null;return isMicroMessenger?De=jsxRuntimeExports.jsx(KeyframeWaveContent,{wave:Se,prefix:$e?.staticPrefix}):canPlayHevc?De=jsxRuntimeExports.jsx(VideoWaveContent,{format:"hevc",wave:Se,prefix:$e?.staticPrefix}):canPlayVp9?De=jsxRuntimeExports.jsx(VideoWaveContent,{format:"vp9",wave:Se,prefix:$e?.staticPrefix}):De=jsxRuntimeExports.jsx(KeyframeWaveContent,{wave:Se,prefix:$e?.staticPrefix}),jsxRuntimeExports.jsx("div",{className:"vreo-wave",onClick:$e?.onClick,children:jsxRuntimeExports.jsx("div",{style:{position:"relative",width:"100%",paddingTop:`${Be*100}%`},children:jsxRuntimeExports.jsx("div",{style:{position:"absolute",width:"100%",height:"100%",left:0,top:0},children:De})})})}const VideoWaveContent=({wave:$e,format:Se,prefix:Be=defaultPrefix})=>{const De=reactExports.useRef(null),[Ve,Fe]=reactExports.useState(!1),[Je,Xe]=reactExports.useState(!1),Ke=Be+$e[Se];reactExports.useEffect(()=>{Fe(!1)},[Ke]);const Ye=reactExports.useCallback(()=>{De.current&&De.current.play(),Fe(!0)},[]),or=reactExports.useCallback(()=>{Xe(!0)},[]);return Je?jsxRuntimeExports.jsx(KeyframeWaveContent,{wave:$e,prefix:Be}):jsxRuntimeExports.jsx("video",{style:{opacity:Ve?1:0},preload:"auto",ref:De,width:"100%",height:"100%",playsInline:!0,autoPlay:!0,onCanPlay:Ye,onError:or,muted:!0,loop:!0,src:Ke})},KeyframeWaveContent=({wave:$e,prefix:Se=defaultPrefix})=>{const Be=Se+$e.png;return jsxRuntimeExports.jsx("div",{style:{width:"100%",height:"100%",backgroundImage:`url(${Be})`,backgroundSize:"100%",animationName:"vreo-wave-keyframes",animationTimingFunction:`steps(${$e.frames-1})`,animationDuration:`${$e.frames/25}s`,animationIterationCount:"infinite"}})},AppView=observer(({controller:$e})=>jsxRuntimeExports.jsx("div",{className:classNames("vreo-panel",{"vreo-panel--hidden":!$e.visible}),children:jsxRuntimeExports.jsxs("div",{className:"vreo-panel-inner",children:[jsxRuntimeExports.jsx(Wave,{onClick:$e.configs?.onWaveClick,appearance:$e.waveAppearance??"single",staticPrefix:$e.configs.waveStaticPrefix}),jsxRuntimeExports.jsx(VideoAgent,{onClick:()=>{if($e.configs?.onAvatarClick){$e.configs.onAvatarClick();return}$e.playing?$e.setPlaying(!1):$e.setPlaying(!0)},options:$e.configs?.videoAgentMeshOptions||{}}),jsxRuntimeExports.jsx(Prompter,{}),$e.configs?.customPanelChildren]})}));function App(){const $e=useController();return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ResizeObserver$1,{}),jsxRuntimeExports.jsx(CameraMovement,{}),jsxRuntimeExports.jsx(ModelVideo,{}),jsxRuntimeExports.jsx(UpdateVRPanorama,{}),jsxRuntimeExports.jsx(VideoEffect,{}),jsxRuntimeExports.jsx(PanoTag,{}),jsxRuntimeExports.jsx(PanoTextLabel,{}),jsxRuntimeExports.jsx(InfoPanel,{}),jsxRuntimeExports.jsx(PanoEffect,{}),jsxRuntimeExports.jsx(BgMusic,{})]}),jsxRuntimeExports.jsx(AppView,{controller:$e})]})}const DrawerView=observer(({controller:$e})=>{const Se="400px",Be=(()=>{const De=$e.drawerConfig?.height;return De?typeof De=="number"?De+"px":De:"max-content"})();return jsxRuntimeExports.jsx("div",{className:classNames("vreo-drawer",{"vreo-drawer-visible":$e.drawerConfig&&$e.drawerConfig.content}),onClick:()=>$e.openDrawer(!1),children:jsxRuntimeExports.jsx("div",{className:"vreo-drawer-inner",style:{height:Be,maxHeight:Se},children:$e.drawerConfig?.content||""})})});function Drawer(){const $e=useController();return jsxRuntimeExports.jsx(DrawerView,{controller:$e})}const PopUpView=observer(({controller:$e})=>jsxRuntimeExports.jsx("div",{className:classNames("vreo-PopUp",{"vreo-PopUp-visible":$e.popUp}),onClick:()=>$e.openPopUp(!1),children:jsxRuntimeExports.jsx("div",{className:"vreo-PopUp-inner",children:$e.popUp||""})}));function PopUp(){const $e=useController();return jsxRuntimeExports.jsx(PopUpView,{controller:$e})}const DefaultAudioCacheLength=3,id="vreo-app-dhjskadhksahdjskahdjksa",audioCacheLength=Number(location.search.match(/audio_cache=(\d+)/)?.[1]??DefaultAudioCacheLength);class Player extends Subscribe{$five;controller;configs;constructor(Se,Be={}){if(super(),this.$five=Se,generateBlankAudio(audioCacheLength),Be.container||(Be.container=Be.containter),!Be.container){const De=document.getElementById(id);De&&(reactDomExports.unmountComponentAtNode(De),De.remove());const Ve=document.createElement("div");Ve.id=id,Be.container=Ve;const Fe=Se.getElement()?.parentNode;Fe?Fe.append(Ve):document.body.append(Ve)}Be.container.classList.contains("vreo-app")||Be.container.classList.add("vreo-app"),this.configs=Object.freeze(Object.assign({keyframeMap:{}},Be)),this.controller=new Controller({five:Se,container:Be.container,configs:this.configs}),reactDomExports.render(jsxRuntimeExports.jsxs(ControllerContext.Provider,{value:this.controller,children:[jsxRuntimeExports.jsx(App,{}),jsxRuntimeExports.jsx(Drawer,{}),jsxRuntimeExports.jsx(PopUp,{}),this.configs.customKeyframes&&this.configs.customKeyframes.map((De,Ve)=>jsxRuntimeExports.jsx(De,{subscribe:{on:(Fe,Je)=>this.on(Fe,Je),once:(Fe,Je)=>this.once(Fe,Je),off:(Fe,Je)=>this.off(Fe,Je)},five:Se},Ve))]}),Be.container),reaction(()=>this.controller.ended,De=>{De&&this.emit("paused",!0)}),reaction(()=>this.controller.playing,De=>{this.controller.ended||this.emit(De?"playing":"paused")})}async load(Se,Be=0,De=!1,Ve=!1){if(this.controller.clear(),this.controller.setLoading(!0),Ve&&(Se=JSON.parse(JSON.stringify(Se))),this.controller.stopInterval&&(this.controller.stopInterval(),this.controller.stopInterval=void 0),this.controller.vreoUnit=Se,this.controller.mediaInstance?.pause(),this.$five.imageOptions.size&&this.configs.imageOptions?.size&&this.$five.imageOptions.size>this.configs.imageOptions.size&&(this.$five.imageOptions.size=this.configs.imageOptions.size),De||De===void 0&&this.configs.autoPreload){const Fe=Se.keyframes.filter(Xe=>!(Xe.type!==VreoKeyframeEnum.CameraMovement||Xe.data.panoIndex===void 0)).reduce((Xe,Ke)=>{const Ye=Ke.data.panoIndex;return Xe[Ye]||(Xe[Ye]=!0),Xe},{}),Je=Object.keys(Fe);for(let Xe=0;Xe<Je.length;Xe++)await this.$five.preloadPano(Number(Je[Xe]))}return this.emit("loaded",Se),this.controller.emit("loaded",Se),this.controller.videoAgentScene?.videoAgentMesh.mediaInstance&&(this.controller.videoAgentScene.videoAgentMesh.mediaInstance.currentTime=Be/1e3),this.controller.setAvatar(Se.video.avatar),await waitForBlankAudioGenerated(),await this.controller.videoAgentScene?.videoAgentMesh.play(Se.video.url,Be/1e3,Se.video.duration),this.controller.setEnded(!1),this.play(),this.controller.run((Fe,Je)=>this.emit(Fe,Je,this.controller.currentTime)),this.controller.setLoading(!1),!0}get paused(){return!this.controller.playing}play(Se){return this.controller.playing||(Se&&this.controller.mediaInstance&&(this.controller.mediaInstance.currentTime=Se/1e3),Object.assign(window,{$vreoController:this.controller}),this.controller.setEnded(!1),this.controller.setPlaying(!0),this.controller.vreoUnit?.keyframes.forEach(Be=>{Be.type===VreoKeyframeEnum.BgMusic&&(Be.parsed=!1)})),!0}setAppearance(Se){this.controller.setAppearance(Se)}pause(){this.controller.setPlaying(!1)}show(){this.controller.setVisible(!0)}hide(){this.controller.setVisible(!1)}getCurrentTime(){return this.controller.currentTime}dispose(){this.controller.dispose(),this.configs.container&&reactDomExports.unmountComponentAtNode(this.configs.container)}}console.log(`
    ┏━━━┓━━━━━━━━━┏┓━━━━━━━━━━━━━
    ┃┏━┓┃━━━━━━━━━┃┃━━━━━━━━━━━━━
    ┃┗━┛┃┏━━┓┏━━┓━┃┃━┏━━┓┏━━┓┏━━┓
    ┃┏┓┏┛┃┏┓┃┗━┓┃━┃┃━┃━━┫┃┏┓┃┃┏┓┃
    ┃┃┃┗┓┃┃━┫┃┗┛┗┓┃┗┓┣━━┃┃┃━┫┃┃━┫
    ┗┛┗━┛┗━━┛┗━━━┛┗━┛┗━━┛┗━━┛┗━━┛
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`);export{Ae$3 as A,CSS3DRenderPlugin as C,Ge$1 as G,Ie$2 as I,Player as P,ReactDOM as R,VreoKeyframeEnum as V,Vector3 as a,Raycaster as b,reactDomExports as c,jsxRuntimeExports as j,parseWork as p,reactExports as r,tweenProgress as t};
