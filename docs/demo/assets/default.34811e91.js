var Ue=Object.defineProperty;var Ve=(e,t,n)=>t in e?Ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var b=(e,t,n)=>(Ve(e,typeof t!="symbol"?t+"":t,n),n);import{r as w,S as ne,m as we,o as O,b as H,d as be,e as Ne,E as Be,T as $e,F as oe,j as h,f as L,a as R,V as P,g as Ie,L as G,h as Pe,i as Oe,B as qe,k as re,M as se,D as ie,l as J,n as Ae,q as je,s as We,t as ae,C as _e,v as He,w as U,x as ue,y as Te,z as Ge,P as ce,Q as Je,R as Ke,p as q,A as Qe,G as Xe,O as Ye,W as Ze,H as le,I as de}from"./vendor.f4c5cb32.js";const et=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};et();const K=window.requestAnimationFrame||(e=>setTimeout(e,16)),tt=window.cancelAnimationFrame||clearTimeout;function Ee(e,t=0){t<=0?K(e):K(()=>Ee(e,t-1))}function Q(e,t=60){let n=-1,s=0,o=-1;const i=1e3/t;function a(c){o===-1&&(o=c),n=K(a),!(c-s<i)&&(s=c,e&&e(c-o))}return n=K(a),function(){tt(n)}}class nt extends ne{constructor(){super();b(this,"$five");b(this,"configs");b(this,"videoAgentScene");b(this,"vreoUnit");b(this,"stopInterval");b(this,"playing",!1);b(this,"visible",!1);b(this,"popUp",null);b(this,"drawerConfig",null);we(this,{visible:O,setVisible:H,playing:O,setPlaying:H,popUp:O.ref,openPopUp:H,drawerConfig:O.ref,openDrawer:H}),be(()=>this.playing,t=>{this.emit(t?"playing":"paused")})}get isAudio(){var t,n;return!((n=(t=this.videoAgentScene)==null?void 0:t.videoAgentMesh.videoUrl)==null?void 0:n.endsWith(".mp4"))}openPopUp(t){if(!t){this.popUp=null;return}this.popUp=t}setVisible(t){this.visible=t}setPlaying(t){this.playing=t}openDrawer(t){var n;if(!t){this.drawerConfig={content:"",height:(n=this.drawerConfig)==null?void 0:n.height};return}this.drawerConfig=t}get ready(){return!!this.videoAgentScene}get currentTime(){var t;return((t=this.videoAgentScene)==null?void 0:t.videoAgentMesh.currentTime)||0}get currentKeyframes(){return this.vreoUnit?this.vreoUnit.keyframes.filter(n=>{if(n.parsed)return!1;const s=this.currentTime-n.start;return s<=100&&s>=0}):[]}get videoInstance(){var t;return(t=this.videoAgentScene)==null?void 0:t.videoAgentMesh.videoInstance}requestAnimationFrameLoop(t){var s,o,i,a;if((s=this.videoInstance)==null?void 0:s.ended){this.setPlaying(!1),this.videoInstance.pause();return}if(!this.playing){((o=this.videoInstance)==null?void 0:o.paused)||(i=this.videoInstance)==null||i.pause();return}((a=this.videoInstance)==null?void 0:a.paused)&&this.playing&&this.videoInstance.play(),this.currentKeyframes.forEach(c=>{c.parsed||(c.parsed=!0,this.emit(c.type,c),t&&t(c.type,c))})}run(t){this.stopInterval||(this.stopInterval=Q(()=>this.requestAnimationFrameLoop(t)))}dispose(){this.setPlaying(!1),this.currentKeyframes&&this.currentKeyframes.forEach(t=>t.parsed=!1),this.vreoUnit=void 0,this.videoInstance&&(this.videoInstance.currentTime=0),this.stopInterval&&(this.stopInterval(),this.stopInterval=void 0)}}const Ce=w.exports.createContext(null);function C(){const e=Ne.useContext(Ce);if(!e)throw new Error('\u6CA1\u6709\u627E\u5230 "ControllerContext"');return e}function V(){const e=C();if(!e.$five)throw new Error('\u6CA1\u6709\u627E\u5230 "five" \u5B9E\u4F8B');return e.$five}function Me(){const e=V();return t=>e.project2d(t,!1)}var X;(function(e){e.Move="Move",e.Rotate="Rotate"})(X||(X={}));var z;(function(e){e.Clockwise="Clockwise",e.Anticlockwise="Anticlockwise",e.Loop="Loop"})(z||(z={}));const ke=Be;function ot(e,t,n,s=ke.Linear.None){const o=new $e(e).to(t,n).easing(s);Ee(()=>o.start(0));const i=Q(c=>{o.update(c)===!1&&i()}),a=[];return o.onDestroy=c=>(a.push(c),o),o.destroy=function(){this.stop(),Object.assign(o,{_onStartCallback:null,_onUpdateCallback:null,_onCompleteCallback:null,_onStopCallbackL:null});let c;for(;c=a.shift();)c();i()},o}function rt(e,t){return ot({progress:0},{progress:1},e,t)}const Y=Math.PI*2;function Le(e){return e%Y}function Se(e){return(e%Y+Y)%Y}const fe=(e,t,n)=>{const s=Math.PI,o=s*2;return e=Se(e),t=Se(t),n===z.Anticlockwise&&e<t&&(e+=o),n===z.Clockwise&&t<e&&(t+=o),n===z.Loop&&t-e>s?fe(e,t,z.Anticlockwise):n===z.Loop&&e-t>s?fe(e,t,z.Clockwise):{from:e,to:t}};function pe(e,t,n){return e+(t-e)*n}const st=e=>{const t=(o,i,a={preload:!0})=>new Promise(async(c,f)=>{if(a.asyncStartCallback&&a.asyncStartCallback(),e.panoIndex===void 0)return f(!1);if(o.mode&&o.mode!==e.currentMode&&await new Promise(p=>{!o.mode||(e.once("modeChange",r=>{e.once("initAnimationEnded",()=>{r===o.mode&&p(!0)})}),e.changeMode(o.mode,{fov:o.fov||void 0,latitude:o.latitude||void 0,longitude:o.longitude||void 0,panoIndex:o.panoIndex||void 0}))}),o.mode===oe.Mode.Floorplan||(a.preload&&o.panoIndex!==void 0&&o.panoIndex!==e.panoIndex&&await e.preloadPano(o.panoIndex),a.asyncEndCallback&&a.asyncEndCallback(),o.panoIndex===void 0&&o.fov===void 0&&o.latitude===void 0&&o.longitude===void 0))return c(!0);const l=o.panoIndex!==void 0?o.panoIndex:e.panoIndex;if(l!==void 0){const p=Object.assign(o,{duration:i,moveEndCallback:()=>c(!0),moveCancelCallback:()=>{c(!0)}});await e.moveToPano(l,p)}else f(!1)}),n=o=>{const i=e.state,a=Le(i.latitude),c=Le(o.latitude),{from:f,to:l}=fe(i.longitude,o.longitude,o.rotation||z.Loop),p=i.fov,r=o.fov;return{from:{latitude:a,longitude:f,fov:p},to:{latitude:c,longitude:l,fov:r}}};return{move:t,rotate:async(o,i,a={})=>{a.asyncStartCallback&&a.asyncStartCallback(),o.mode&&e.currentMode!==o.mode&&await e.changeMode(o.mode),o.mode===oe.Mode.Panorama&&e.currentMode===oe.Mode.Panorama&&o.panoIndex!==void 0&&o.panoIndex!==e.panoIndex&&(a.preload&&await e.preloadPano(o.panoIndex),await new Promise((l,p)=>{e.moveToPano(o.panoIndex,{moveEndCallback:()=>l(!0),moveCancelCallback:()=>p(!1),effect:"fade"})})),a.asyncEndCallback&&a.asyncEndCallback();const{from:c,to:f}=n(o);return await new Promise((l,p)=>{const r=({progress:d})=>{const x={};x.longitude=pe(c.longitude,f.longitude,d),x.latitude=pe(c.latitude,f.latitude,d),x.fov=pe(c.fov,f.fov,d),e.setState(x,!0)},v=()=>{l(!0)},g=()=>{l(!1)},u=o.rotateSpeed?Math.ceil(Math.abs(f.longitude-c.longitude)/o.rotateSpeed*1e3):i,m=rt(u,ke.Linear.None).onUpdate(r).onComplete(v).onDestroy(g);o.rotation===z.Loop&&m.repeat(1/0).yoyo(!0),setTimeout(()=>{m.destroy(),l(!0)},i)})}}};var T;(function(e){e.CameraMovement="CameraMovement",e.PanoTag="PanoTag",e.PanoTextLabel="PanoTextLabel",e.Prompter="Prompter",e.UpdateVRPanorama="UpdateVRPanorama",e.ModelVideo="ModelVideo",e.PanoEffect="PanoEffect",e.InfoPanel="InfoPanel",e.VideoEffect="VideoEffect",e.BgMusic="BgMusic",e.Exit="Exit",e.Custom="Custom"})(T||(T={}));var j;(function(e){e.Text="Text",e.Image="Image"})(j||(j={}));var Z;(function(e){e.Growth="Growth",e.Expand="Expand"})(Z||(Z={}));var Re;(function(e){e.Distance="Distance"})(Re||(Re={}));var B;(function(e){e.Image="Image",e.Video="Video"})(B||(B={}));var me;(function(e){e.Drawer="Drawer",e.PopUp="PopUp"})(me||(me={}));function it(){const e=C(),t=V(),n=w.exports.useRef();return w.exports.useEffect(()=>{const s=async o=>{n.current||(n.current=st(t));const{start:i,end:a,data:c}=o,f=c,l=f.effect;l===X.Rotate?await n.current.rotate(c,a-i):l===X.Move?await n.current.move(c,a-i):f.panoIndex!==void 0&&f.panoIndex!==t.panoIndex?await n.current.move(c,a-i):await n.current.rotate(c,a-i)};return e.on(T.CameraMovement,s),()=>{e.off(T.CameraMovement,s)}},[e]),h(L,{})}function Fe({url:e,children:t}){return R("div",{className:"vreo-infoPanel vreo-infoPanel--img",children:[t,h("div",{className:"vreo-infoPanelImg",style:{backgroundImage:`url(${e})`}})]})}function De({url:e,children:t}){return R("div",{className:"vreo-infoPanel vreo-infoPanel--video",children:[t,h("div",{className:"vreo-infoPanelWrapper",children:h("video",{playsInline:!0,autoPlay:!0,className:"vreo-infoPanelVideo",src:e})})]})}const ee=e=>!e.title&&!e.subTitle?null:R("div",{className:"vreo-infoPanel-title",children:[h("div",{className:"vreo-infoPanel-t1",children:e.title}),h("div",{className:"vreo-infoPanel-t2",children:e.subTitle})]});function at(){const e=w.exports.useRef(),t=C();return w.exports.useEffect(()=>{var s;if(((s=t.configs)==null?void 0:s.keyframeMap.InfoPanel)===!1)return;const n=o=>{const{start:i,end:a,data:c}=o,f=c,{title:l,subTitle:p,style:r}=f;do{if(r===me.PopUp){f.type===B.Image?t.openPopUp(h(Fe,{url:f.url,children:h(ee,{title:l,subTitle:p})})):f.type===B.Video&&t.openPopUp(h(De,{url:f.url,children:h(ee,{title:l,subTitle:p})}));break}f.type===B.Image?t.openDrawer({content:h(Fe,{url:f.url,children:h(ee,{title:l,subTitle:p})}),height:"60vh"}):f.type===B.Video&&t.openDrawer({content:h(De,{url:f.url,children:h(ee,{title:l,subTitle:p})}),height:"60vh"})}while(!1);e.current=setTimeout(()=>{t.openDrawer(!1),t.openPopUp(!1)},a-i)};return t.on(T.InfoPanel,n),()=>{t.off(T.InfoPanel,n),e.current&&clearTimeout(e.current)}},[t]),h(L,{})}const ut=(e,{videoElement:t})=>{const n={videoMeshes:[],videoTextureEnabled:!1,videoSource:"",rectPoints:[],enabled:!1,videoElement:t},s=r=>{n.videoTexture&&(n.videoTexture.image.muted=r,n.videoTexture.image.play())},o=()=>n.videoTexture?n.videoTexture.image.muted:!0,i=()=>{if(n.enabled||!n.videoTexture)return;n.enabled=!0,n.videoMeshes=c(),n.videoMeshes.forEach(v=>e.scene.add(v));const r=()=>{if(!n.videoTexture)return;const v=()=>{var g;!n.videoTexture||((g=n.videoTexture)==null||g.image.removeEventListener("timeupdate",v),n.videoTextureEnabled=!0,n.videoMeshes.forEach(u=>{u.material.map!==n.videoTexture&&(u.material.map=n.videoTexture)}),e.needsRender=!0)};n.videoTexture.image.addEventListener("timeupdate",v),n.videoTexture&&n.videoMeshes.length&&n.videoTexture.image.play()};if(e.model.loaded)r();else return e.once("modelLoaded",()=>r())},a=()=>{!n.enabled||(n.enabled=!1,n.videoMeshes.forEach(r=>{r.geometry.dispose(),r.material.dispose(),e.scene.remove(r),n.videoTexture&&n.videoTexture.image.pause()}),n.videoMeshes=[],e.needsRender=!0)},c=()=>n.rectPoints.map((r,v)=>{const g=new qe,u=128,m=[];m.push(r[0].x,r[0].y,r[0].z);for(let y=1;y<u;y++)m.push(r[0].x+(r[1].x-r[0].x)*y/u,r[0].y+(r[1].y-r[0].y)*y/u,r[0].z+(r[1].z-r[0].z)*y/u);m.push(r[1].x,r[1].y,r[1].z),m.push(r[2].x,r[2].y,r[2].z);for(let y=1;y<u;y++)m.push(r[2].x+(r[3].x-r[2].x)*y/u,r[2].y+(r[3].y-r[2].y)*y/u,r[2].z+(r[3].z-r[2].z)*y/u);m.push(r[3].x,r[3].y,r[3].z);const d=[];d.push(0,1);for(let y=1;y<u;y++)d.push(0,1-y/u);d.push(0,0),d.push(1,0);for(let y=1;y<u;y++)d.push(1,y/u);d.push(1,1);const x=[];for(let y=0;y<u;y++)x.push(y,y+1,u*2-y,y,u*2-y,u*2+1-y);g.setAttribute("position",new re(new Float32Array(m),3)),g.setAttribute("uv",new re(new Float32Array(d),2)),g.setIndex(new re(new Uint32Array(x),1));const A=new se({map:n.videoTextureEnabled?n.videoTexture:n.imageTexture,side:ie}),I=new J(g,A);return I.renderOrder=1,I.name=`video-${v}-${performance.now()}`,I}),f=r=>{const v=new Ae().load(r);return v.minFilter=G,v.magFilter=G,v.format=Pe,v},l=(r,v)=>new Promise((g,u)=>{const m=new XMLHttpRequest;m.onreadystatechange=()=>{if(m.readyState==4)if(m.status==200){const d=window.URL||window.webkitURL;v=v||document.createElement("video"),v.crossOrigin="anonymous",v.autoplay=!0,v.muted=!0,v.loop=!0,v.playsInline=!0,v.src=d.createObjectURL(m.response);const x=new Ie(v);x.minFilter=G,x.magFilter=G,x.format=Pe,g(Object.assign(x,{videoSource:r}))}else u(new Error("Video download Error: "+m.status))},m.onerror=d=>u(d),m.open("GET",r),m.responseType="blob",m.send()}),p=async(r,v)=>{const{video_src:g,video_poster_src:u,points:m}=r;n.videoSource=g,n.rectPoints=m.map(d=>d.map(({x,y:A,z:I})=>new P(x,A,I))),n.imageTexture=f(u),v&&(n.videoElement=v),n.videoTexture=await l(n.videoSource,n.videoElement),n.enabled=!!r.enable,n.enabled&&i()};return e.on("modeChange",()=>s(!0)),e.on("wantsTapGesture",r=>{if(!n.enabled)return;const[v]=r.intersectObjects(e.scene.children,!0);if(!!v&&/^video/.test(v.object.name))return n.videoTexture&&s(!n.videoTexture.image.muted),!1}),e.on("panoArrived",()=>{if(!n.enabled||o())return;const r=e.camera.position;n.rectPoints.find(g=>{const u=g.reduce((m,d)=>new P(m.x+d.x/g.length,m.y+d.y/g.length,m.z+d.z/g.length),new P);return g.map(m=>new P((m.x+u.x)/2,(m.y+u.y)/2,(m.z+u.z)/2)).filter(m=>{m=m.clone().sub(r).normalize();const d=new Oe(r,m),[x]=d.intersectObjects(e.scene.children,!0);return!!x&&/^video/.test(x.object.name)}).length>=2})||s(!0)}),e.on("renderFrame",()=>{n.videoMeshes.forEach(r=>{r&&(r.needsRender=!0)})}),e.on("load",r=>{r.modelTVVideoData&&p(r.modelTVVideoData)}),{enable:i,disable:a,load:p}};function ct(e){const t=new je;return t.fromArray(e),n=>{const s=new P(...n);return s.applyMatrix4(t),s.toArray()}}function lt(){const e=C(),t=V(),n=w.exports.useRef(),s=w.exports.useRef();return w.exports.useEffect(()=>{const o=async i=>{var u,m;n.current||(n.current=ut(t,{}));const{start:a,end:c}=i,{videoSrc:f,videoPosterSrc:l,vertexs:p,matrixWorld:r}=i.data,v=(()=>{if(p.length<4)throw new Error("ModelVideo: \u9876\u70B9\u6570\u636E\u96C6\u5408\u4E0D\u591F\uFF0C\u65E0\u6CD5\u7EC4\u6210\u77E9\u5F62 ....");if(p.length===4)return p;const d=new We;return p.forEach(x=>d.expandByPoint(new P(x.x,x.y,x.z))),[new P(d.min.x,d.max.y,d.max.z),new P(d.min.x,d.min.y,d.max.z),new P(d.max.x,d.min.y,d.max.z),new P(d.max.x,d.max.y,d.max.z)]})(),g=(()=>{if(r){const d=ct(r);return[v.map(x=>{const A=d([x.x,x.y,x.z]);return{x:A[0],y:A[1],z:A[2]}})]}return[v]})();n.current.disable(),await n.current.load({video_src:f,video_poster_src:l,points:g},(m=(u=e.configs)==null?void 0:u.videos)==null?void 0:m.modelTVVideo),n.current.enable(),s.current=setTimeout(()=>{var d;return(d=n.current)==null?void 0:d.disable()},c-a)};return e.on(T.ModelVideo,o),()=>{e.off(T.ModelVideo,o),s.current&&clearTimeout(s.current)}},[e]),h(L,{})}class dt extends ae.Tween{constructor(){super(...arguments);b(this,"disposeMethods",[]);b(this,"animationFrameDisposer");b(this,"onDispose",t=>(this.disposeMethods.push(t),this));b(this,"play",()=>(this.start(),this.animationFrameDisposer=Q(()=>this.update()),this));b(this,"dispose",()=>{var t;this.stop(),(t=this.animationFrameDisposer)==null||t.call(this),this.disposeMethods.forEach(n=>n()),this.disposeMethods=[],ae.remove(this)})}}function ft(e,t=ae.Easing.Linear.None){const n=new dt({progress:0}).to({progress:1});return e!==void 0&&n.duration(e),t!==void 0&&n.easing(t),n}function pt(e,t,n){const s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAIVBMVEUAAAD////////////////////////////////////////PIev5AAAACnRSTlMAG/Py2baba05un7UgfgAAAHJJREFUKM9joBpgLHVSCRdA4metAoJlCJHmVWBgAeNzroKCCVCBLpjACqgJVjCBxRBT2FbBQQJYQAohsBAsUIUQWA4WiEIILAULeCEEloAFtBACizAEMLRgGIphLabDMJ2O6TlM72MGECIIMQIZIxqoBQCPvpJ/e9FaAAAAAABJRU5ErkJggg==",o=new Ae().load(s),i=new _e(16777215),a=new He;a.setMaterial({linewidth:2,color:i});const c=a.points.material;return c.map=o,c.color.set(i),a.line.material.depthTest=!1,ft().onUpdate(({progress:f})=>{const l=.5-f/2,p=.5+f/2,r=t.clone().lerp(n,l),v=t.clone().lerp(n,p);a.setPoints(r,v)}).onStart(()=>e.scene.add(a)).onDispose(()=>{e.scene.remove(a),e.needsRender=!0})}function mt(){const[e,t]=w.exports.useState(null),n=V(),s=w.exports.useRef(null),[o,i]=w.exports.useState(null),a=w.exports.useRef(),c=C(),f=Me(),l=()=>{s.current&&s.current.dispose()};return w.exports.useEffect(()=>{const p=r=>{const{start:v,end:g,data:u}=r,m=u,[d,x]=m.twoVertexs,A=new P(d.x,d.y,d.z),I=new P(x.x,x.y,x.z);s.current=pt(n,A.clone(),I.clone()),s.current.play();const y=A.lerp(I,.5),D=A.distanceTo(I),M=f(y);if(!M)return;const{x:S,y:E}=M;t({center:y,distance:D}),i({left:S,top:E}),a.current=setTimeout(()=>{t(null),i(null),l()},g-v)};return c.on(T.PanoEffect,p),()=>{c.off(T.PanoEffect,p),a.current&&clearTimeout(a.current),l()}},[c]),w.exports.useEffect(()=>{const p=()=>{if(!(e==null?void 0:e.center))return;const{x:r,y:v,z:g}=e.center,u=f(new P(r,v,g));if(!u)return;const{x:m,y:d}=u;i({left:m,top:d})};return n.on("currentStateChange",p),()=>{n.off("currentStateChange",p)}},[e==null?void 0:e.center]),h(L,{children:h("div",{className:U("PanoEffect",{"PanoEffect--notHidden":e}),style:{left:((o==null?void 0:o.left)||0)+"px",top:((o==null?void 0:o.top)||0)+"px"},children:(e==null?void 0:e.distance.toFixed(4))+"m"})})}function ht(){const[e,t]=w.exports.useState(null),[n,s]=w.exports.useState(null),o=w.exports.useRef(),i=C(),a=V(),c=Me();w.exports.useEffect(()=>{var p;if(((p=i.configs)==null?void 0:p.keyframeMap.PanoTag)===!1)return;const l=r=>{const{start:v,end:g,data:u}=r,m=u,d=m.vertex,{x,y:A,z:I}=m.vertex,y=c(new P(x,A,I));if(!y)return;const{x:D,y:M}=y;t({vertex:d,text:m.text||j.Text,type:m.type,imgUrl:m.imgUrl,style:m.style||Z.Growth}),s({left:D,top:M}),o.current=setTimeout(()=>{t(null),s(null)},g-v)};return i.on(T.PanoTag,l),()=>{i.off(T.PanoTag,l),o.current&&clearTimeout(o.current)}},[i]),w.exports.useEffect(()=>{const l=()=>{if(!(e==null?void 0:e.vertex))return;const{x:p,y:r,z:v}=e.vertex,g=c(new P(p,r,v));if(!g)return;const{x:u,y:m}=g;s({left:u,top:m})};return a.on("currentStateChange",l),()=>{a.off("currentStateChange",l)}},[e==null?void 0:e.vertex]);const f=(()=>{if(!!e){if(e.type===j.Text)return h(L,{children:h("span",{children:e.text})});if(e.type===j.Image)return R(L,{children:[h("img",{className:"PanoTag-img",src:e.imgUrl,alt:e.text||""}),h("span",{className:"PanoTag-txt",children:e.text})]})}})();return(e==null?void 0:e.style)===Z.Expand?h(L,{children:R("div",{className:U("PanoTag",{"PanoTag--expand":!0,"PanoTag--notHidden":e}),style:{left:((n==null?void 0:n.left)||0)+"px",top:((n==null?void 0:n.top)||0)+"px"},children:[h("div",{className:"PanoTag-box PanoTag-box--"+((e==null?void 0:e.type)||""),children:f}),h("div",{className:"PanoTag-guideline"})]})}):h(L,{children:R("div",{className:U("PanoTag",{"PanoTag--notHidden":e}),style:{left:((n==null?void 0:n.left)||0)+"px",top:((n==null?void 0:n.top)||0)+"px"},children:[h("div",{className:"PanoTag-point"}),R("div",{className:"PanoTag-content",children:[R("span",{className:"PanoTag-linewrap",children:[h("span",{className:"PanoTag-slashline"}),h("span",{className:"PanoTag-straightline"})]}),h("div",{className:"PanoTag-box PanoTag-box--"+((e==null?void 0:e.type)||""),children:f})]})]})})}function te(e,t){const n=Math.round(e);return n%2==0?n:n+Number((t==null?void 0:t.smaller)?-1:1)}function vt(e,t){return new P((e.x+t.x)/2,(e.y+t.y)/2,(e.z+t.z)/2)}const xt=({x:e,y:t,z:n})=>new P(e,t,n);function gt(e,t){if(!t||typeof ResizeObserver=="undefined")return{observe:()=>window.addEventListener("resize",e),unobserve:()=>window.removeEventListener("resize",e)};{const n=new ResizeObserver(e);return{observe:()=>n.observe(t),unobserve:()=>n.unobserve(t)}}}const yt=e=>{const t={disposeCallbacks:[]},n=(...o)=>{var xe,ge,ye;const i=o[0].map(k=>k instanceof P?k:xt(k)),a=o[1];if((i==null?void 0:i.length)<4)return console.error("points must be equal or greater than than 4");if(!((xe=e==null?void 0:e.model)==null?void 0:xe.loaded))return console.error("five.model.loaded is: ",(ge=e==null?void 0:e.model)==null?void 0:ge.loaded);const c=e.getElement();if(!c)return console.error("five.getElement() is "+c);const f=[],l=(a==null?void 0:a.ratio)||.00216;l<=.00215&&console.warn("if you need click css3DElement on safari, ratio must be greater than 0.00215");const p=(a==null?void 0:a.dpr)||1,r=(a==null?void 0:a.mode)||"front",v=(ye=a==null?void 0:a.autoRender)!=null?ye:!0,g=(a==null?void 0:a.behindFiveContainer)||c.parentElement||document.body,u=(a==null?void 0:a.container)||document.createElement("div");u.classList.add("__Dnalogel-plugin--CSS3DRenderPlugin");const{css3DObject:m,mesh:d}=s(i,{ratio:l,dpr:p,container:u,mode:r});let x;const A=r==="front"&&!t.frontMode,I=r==="behind"&&!t.behindMode,y=!(A||I);let D=!1,M=null;I&&(t.behindMode={scene:new ue,css3DRenderer:new Te}),A&&(t.frontMode={scene:new ue,css3DRenderer:new Te});const{scene:S,css3DRenderer:E}=r==="behind"?t.behindMode:t.frontMode,W=(()=>{if(y)return()=>{S.add(m)};{const k=()=>{const _=te(c.clientWidth,{smaller:!0}),ze=te(c.clientHeight,{smaller:!0});E.setSize(_,ze)};k(),x=gt(k,c),E.domElement.style.position="absolute",E.domElement.style.top="0",E.domElement.style.userSelect="none",E.domElement.style.pointerEvents="none";const N=()=>{D||(M=requestAnimationFrame(N),E.render(S,e.camera))};return()=>{var _;S.add(m),(_=x==null?void 0:x.observe)==null||_.call(x),N(),r==="behind"&&d&&(e.scene.add(d),f.push(()=>d&&e.scene.remove(d)))}}})();A&&(c.parentElement||document.body).appendChild(E.domElement),I&&g.appendChild(E.domElement);const $=()=>{var k;return D=!0,f.forEach(N=>N==null?void 0:N()),S.remove(m),typeof M=="number"&&cancelAnimationFrame(M),S.children.length===0&&(E.domElement.remove(),r==="front"&&(t.frontMode=void 0),r==="behind"&&(t.behindMode=void 0),!t.behindMode&&!t.frontMode&&((k=x==null?void 0:x.unobserve)==null||k.call(x))),!0},ve=t.disposeCallbacks.findIndex(k=>k===$);return ve!==-1?t.disposeCallbacks.splice(ve,1):t.disposeCallbacks.push($),v&&W(),{container:u,dispose:$,css3DObject:m,render:v?void 0:W}},s=(o,i)=>{const{ratio:a,dpr:c,container:f,mode:l}=i,p=o[0].distanceTo(o[1]),r=o[1].distanceTo(o[2]),v=te(p/a*c),g=te(r/a*c),u=new Ge(f);u.scale.set(a,a,a),f.style.width=v+"px",f.style.height=g+"px",f.style.pointerEvents="none";const m=vt(o[0],o[2]),d=o[1].clone().sub(o[0]),x=o[2].clone().sub(o[1]),A=new P(0,1,0).angleTo(new P(0,x.y,x.z)),I=new P(1,0,0).angleTo(new P(d.x,0,d.z)),y=d.angleTo(new P(d.x,0,d.z)),D=(x.z>0?-1:1)*A,M=(d.z<0?1:-1)*I,S=(d.x>0&&d.y<0||d.x<0&&d.y>0?-1:1)*y;u.rotateOnWorldAxis(new P(1,0,0),D),u.rotateOnWorldAxis(new P(0,1,0),M),u.rotateOnWorldAxis(new P(0,0,1),S),u.position.set(m.x,m.y,m.z);let E;if(l==="behind"){const W=new se({opacity:0,transparent:!1,side:ie}),$=new ce(v,g);E=new J($,W),E.name="CSS3DRenderPlugin-mesh",E.position.copy(u.position),E.rotation.copy(u.rotation),E.scale.copy(u.scale)}return{css3DObject:u,mesh:E}};return{create3DDomContainer:n,disposeAll:()=>{t.disposeCallbacks.forEach(o=>o==null?void 0:o()),t.disposeCallbacks=[]}}},wt=(e,t,n,s)=>{const o=n/375,i=s/375,a=new ce(o,i);if(t){const A=new P(t.x+e.x,t.y+e.y,t.z+e.z);a.lookAt(A)}const c=new se({color:16776960,side:ie}),f=new J(a,c),l=e.clone();f.position.copy(l);const[p,r,v,g]=f.geometry.vertices,u=l.clone().add(g),m=l.clone().add(v),d=l.clone().add(r),x=l.clone().add(p);return[u,m,x,d]};function bt(){const e=w.exports.useRef(),t=C(),n=V(),s=w.exports.useRef();return w.exports.useEffect(()=>{var i;if(((i=t.configs)==null?void 0:i.keyframeMap.PanoTextLabel)===!1)return;const o=a=>{var D,M,S;const{start:c,end:f,data:l}=a,p=l;if(l.text==="")return;const{x:r,y:v,z:g}=p.vertex,u=new P(r,v,g),m=new P((D=p.normal)==null?void 0:D.x,(M=p.normal)==null?void 0:M.y,(S=p.normal)==null?void 0:S.z),d=200,x=30,A=wt(u,p.normal&&m,d,x);s.current||(s.current=yt(n));const I=s.current.create3DDomContainer(A),y=I==null?void 0:I.css3DObject;if(l.quaternion){const E=new Je(l.quaternion.x,l.quaternion.y,l.quaternion.z,l.quaternion.w);y==null||y.quaternion.copy(E)}(I==null?void 0:I.container)&&Ke.render(h("div",{className:"PanoTextLabel PanoTextLabel--notHidden",children:h("div",{className:"PanoTextLabel-wrapper",children:h("div",{style:{fontSize:`${l.fontSize||16}px`},className:"PanoText-innerText",children:l.text||""})})}),I==null?void 0:I.container),e.current=setTimeout(()=>{var E;(E=s.current)==null||E.disposeAll()},f-c)};return t.on(T.PanoTextLabel,o),()=>{t.off(T.PanoTextLabel,o),e.current&&clearTimeout(e.current)}},[t]),h(L,{})}function It(){const[e,t]=w.exports.useState(""),[n,s]=w.exports.useState(!0),o=w.exports.useRef(null),i=C();return w.exports.useEffect(()=>{var c;if(((c=i.configs)==null?void 0:c.keyframeMap.Prompter)===!1)return;const a=f=>{const{start:l,end:p,data:r}=f;t(r.text),s(!1),o.current&&(clearTimeout(o.current),o.current=null),o.current=setTimeout(()=>{s(!0),t(""),o.current&&clearTimeout(o.current),o.current=null},p-l)};return i.on(T.Prompter,a),()=>{i.off(T.Prompter,a)}},[i]),h("div",{className:U("vreo-prompter",{"vreo-prompter--hidden":n,"vreo-prompter--audio":i.isAudio}),children:h("div",{className:"vreo-prompter-text",children:h("div",{className:"vreo-prompter-innerText",children:e})})})}function Pt(){const e=C(),t=V(),n=w.exports.useRef(null),s=w.exports.useRef(null),o=w.exports.useCallback(()=>{if(s.current=null,n.current){const c=q(n.current);t.load(c)}},[]),i=w.exports.useCallback(()=>{if(n.current){const c=q(n.current);Object.assign(window,{$rawWork:c}),t.load(c)}},[]),a=w.exports.useCallback(()=>{!s.current||t.load(s.current)},[]);return w.exports.useEffect(()=>{const c=f=>{var r;n.current||(n.current=t.work.raw.works);const l=f.data;if(l.work){s.current=q(l.work),t.load(s.current);return}const p=(r=t.work)==null?void 0:r.raw.works[0];if(l.dynamic_scene&&!l.panorama){const g=JSON.parse(p).panorama,u=l.dynamic_scene.images.index;g.list[u]=l.dynamic_scene.images,l.panorama=g,delete l.dynamic_scene}Object.assign(window,{$work1:JSON.parse(p),$work2:l,parseWork:q}),s.current=q([p,l]),t.load(s.current)};return e.on(T.UpdateVRPanorama,c),e.on(T.Exit,o),e.on("loaded",o),e.on("paused",i),e.on("playing",a),()=>{e.off(T.UpdateVRPanorama,c),e.off(T.Exit,o),e.off("loaded",o),e.off("paused",i),e.off("playing",a)}},[]),h(L,{})}const At=e=>{if(!e)return;const t=()=>{e.removeEventListener("canplaythrough",t);try{e.play()}catch{}};e.addEventListener("canplaythrough",t),e.load()},Tt=Math.PI,he=Tt*2;function Et(){const e=w.exports.useRef(null),t=w.exports.useRef(),n=C(),s=w.exports.useRef(),[o,i]=w.exports.useState(!1),a=V(),c=f=>{!t.current||(t.current.src=f)};return w.exports.useEffect(()=>{const f=async l=>{const{start:p,end:r}=l,{videoSrc:v,fov:g,direction:u,panoIndex:m,vector:d}=l.data,[x,A]=(()=>{if(d)return[d.longitude,d.latitude];if(!u)return[0,0];let I=-Math.atan2(u.x,-u.z);I=(I%he+he)%he;const y=-Math.asin(u.y/1);return[I,y]})();a.setState({fov:g,panoIndex:m,longitude:x,latitude:A},!0),c(v),At(t.current),i(!0),s.current=setTimeout(()=>{var I,y;((I=t.current)==null?void 0:I.paused)||(y=t.current)==null||y.pause(),i(!1),c("")},r-p)};return n.on(T.VideoEffect,f),()=>{n.off(T.VideoEffect,f),s.current&&clearTimeout(s.current)}},[n]),w.exports.useEffect(()=>{var l,p;if(!e.current)return;const f=((p=(l=n.configs)==null?void 0:l.videos)==null?void 0:p.videoEffect)||document.createElement("video");f.setAttribute("playsinline","true"),f.setAttribute("webkit-playsinline","true"),f.setAttribute("autoplay","true"),f.setAttribute("key","VideoEffect-video"),f.setAttribute("class","VideoEffect-video"),t.current=f,e.current.append(t.current),document.addEventListener("WeixinJSBridgeReady",function(){var r;(r=t.current)==null||r.play()},!1),!!e.current},[]),h("div",{ref:e,className:U("VideoEffect",{"VideoEffect--visible":o})})}const Ct={blob:e=>{const t=()=>null;return new Promise((n,s)=>{const o=new XMLHttpRequest,i=()=>{o.ontimeout=t,o.onreadystatechange=t,o.onprogress=t,o.onabort=t};o.ontimeout=()=>{s(new Error("timeout")),i()},o.onreadystatechange=()=>{o.readyState===4&&(o.status===0&&!o.response||(o.status===200||o.status===0?(n(o.response),i()):(s(new Error("status:"+o.status)),i())))},o.open("GET",e,!0),o.responseType="blob",o.send(null)})}};class Mt extends ne{constructor({duration:t}={}){super();b(this,"$timestamp",0);b(this,"$currentTime",0);b(this,"$duration",0);b(this,"stopInterval");b(this,"muted",!1);b(this,"src","");t&&(this.$duration=t)}setAttribute(t,n){}play(){this.$timestamp===0&&(this.$timestamp=performance.now()),this.$currentTime===this.$duration&&(this.$currentTime=0),this.stopInterval=Q(()=>this.requestAnimationFrameLoop()),this.emit("play")}pause(){this.stopInterval&&(this.stopInterval(),this.emit("pause"),this.stopInterval=void 0),this.$timestamp=0}requestAnimationFrameLoop(){const t=performance.now();this.$currentTime=t-this.$timestamp,this.emit("timeupdate"),this.$currentTime>=this.$duration-10&&(this.$currentTime=this.$duration,this.pause(),this.emit("ended"))}get currentTime(){return this.$currentTime/1e3}set currentTime(t){this.$currentTime=t}get duration(){return this.$duration}set duration(t){this.pause(),this.$duration=t,this.$timestamp=0,this.$currentTime=0}get ended(){return this.$currentTime===this.$duration}get paused(){return!this.stopInterval}addEventListener(t,n,s=!1){this.on(t,n)}removeEventListener(t,n,s=!1){this.off(t,n)}}const kt=`
varying vec2 vUv;
varying vec2 vColorUv;
varying vec2 vMaskUv;
void main(){
  vUv = uv;
  vColorUv = vec2(uv.x / 2.0, uv.y);
  vMaskUv = vec2(0.5 + uv.x / 2.0, uv.y);
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Lt=()=>`
uniform int enable;
uniform sampler2D map;
varying vec2 vUv;
varying vec2 vColorUv;
varying vec2 vMaskUv;

vec3 hsv2rgb(vec3 c) {
  const vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}

vec3 rgb2hsv(vec3 c) {
  const vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
  vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
  vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

  float d = q.x - min(q.w, q.y);
  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + 0.001)), d / (q.x + 0.001), q.x);
}

void main(void) {
  vec3 color = texture2D(map, vUv).xyz;
  float amask = 1.0;

  float ref = color.r;
  if (ref < color.b) ref = color.b;
  amask = color.g - ref + 0.1;
  amask = smoothstep(0.1, 0.3, amask);
  amask = 1.0 - amask;

  vec3 target = rgb2hsv(vec3(0.0 / 255.0, 255.0 / 255.0, 0.0 / 255.0));
  vec3 hsv = rgb2hsv(color);
  float distance = abs(hsv.x - target.x);
  if (distance < 0.15) {
    hsv.y = 0.0;
  }
  color = hsv2rgb(hsv);

  gl_FragColor = vec4(color.rgb, amask * float(enable));
}
`,F={};class St extends J{constructor(t,n,s,o,i={}){var v,g;if(!i.videoInstance)if(F.videoInstance)i.videoInstance=F.videoInstance;else{const u=document.createElement("video");u.style.opacity="0",u.style.display="none",document.body.append(u),i.videoInstance=u,F.videoInstance=u,u.playsInline=!0,u.controls=!1}const a=new ce(t,n,s,o),c=new Ie(i.videoInstance),f=new Qe({uniforms:{map:{value:c},enable:{value:0}},vertexShader:kt,fragmentShader:Lt(),transparent:!0});super(a,f);b(this,"options");b(this,"videoUrl");b(this,"freeze");b(this,"paused");b(this,"audioInstance");b(this,"audioLikeInstance");b(this,"$removeEventListener");if(this.options=i,this.freeze=!1,this.paused=!0,i.audioInstance)this.audioInstance=i.audioInstance;else if(F.audioInstance)this.audioInstance=F.audioInstance;else{const u=document.createElement("audio");u.crossOrigin="",u.muted=!1,u.setAttribute("playsinline","true"),u.setAttribute("webkit-playsinline","true"),u.setAttribute("autoplay","false"),u.setAttribute("style","display: none;"),document.body.appendChild(u),this.audioInstance=u,F.audioInstance=u}this.audioLikeInstance=new Mt,we(this,{paused:O});const l=u=>Xe(()=>this.paused=u),p=()=>l(!0),r=()=>l(!1);this.audioInstance.addEventListener("pause",p),this.audioInstance.addEventListener("play",r),(v=this.options.videoInstance)==null||v.addEventListener("pause",p),(g=this.options.videoInstance)==null||g.addEventListener("play",r),this.audioLikeInstance.addEventListener("pause",p),this.audioLikeInstance.addEventListener("play",r),this.$removeEventListener=()=>{var u,m;this.audioInstance.removeEventListener("pause",p),this.audioInstance.removeEventListener("play",r),(u=this.options.videoInstance)==null||u.removeEventListener("pause",p),(m=this.options.videoInstance)==null||m.removeEventListener("play",r),this.audioLikeInstance.removeEventListener("pause",p),this.audioLikeInstance.removeEventListener("play",r)}}get videoInstance(){var s;return this.videoUrl?((s=this.videoUrl)==null?void 0:s.endsWith("mp3"))?this.audioInstance:this.material.uniforms.map.value.image:this.audioLikeInstance}async update(t){if(this.videoUrl===t)return;this.videoUrl=t,this.freeze=!0,await this.videoInstance.pause();const n=this.material.uniforms;this.videoInstance.muted=!0,this.videoInstance.src=await URL.createObjectURL(await Ct.blob(this.videoUrl)),this.videoInstance.setAttribute("data-src",this.videoUrl);const s=()=>{var o;this.videoInstance.currentTime!==0&&(this.freeze=!1,this.videoInstance.muted=!1,n.enable.value=((o=this.videoUrl)==null?void 0:o.endsWith(".mp4"))?1:0,this.videoInstance.removeEventListener("timeupdate",s,!1))};this.videoInstance.addEventListener("timeupdate",s,!1)}async play(t="",n=0,s){return t=t||"",s&&!t?(this.currentTime&&(this.videoInstance.currentTime=n),this.videoInstance.duration=s,this.videoUrl="",this.videoInstance.play(),!0):t?(console.log("play",t,this.videoUrl),t===this.videoUrl?(this.videoInstance.currentTime=n,await this.videoInstance.play(),!0):(await this.update(t),this.videoInstance.pause(),await new Promise(o=>setTimeout(async()=>{this.videoInstance.currentTime=n,await this.videoInstance.play(),o(!0)},20)))):(this.videoUrl?await this.videoInstance.play():console.warn("\u8B66\u544A\uFF1A\u89C6\u9891\u8D44\u6E90\u672A\u521D\u59CB\u5316\u3002"),!0)}get currentTime(){return this.videoInstance.currentTime*1e3}dispose(){this.$removeEventListener(),F.audioInstance&&(document.body.removeChild(F.audioInstance),F.audioInstance=void 0),F.videoInstance&&(document.body.removeChild(F.videoInstance),F.videoInstance=void 0)}}class Rt{constructor(t,n=!0,s={}){b(this,"videoAgentMesh");b(this,"scene",new ue);b(this,"camera",new Ye(-240,240,135,-135));b(this,"renderer",new Ze({alpha:!0}));b(this,"container");b(this,"run",()=>{var n;const t=this.renderer.domElement;!(this.videoAgentMesh.paused||this.videoAgentMesh.freeze)&&this.videoAgentMesh.currentTime>1e3&&this.renderer.render(this.scene,this.camera),((n=this.videoAgentMesh.videoUrl)==null?void 0:n.endsWith(".mp4"))?t.style.display!=="block"&&(t.style.display="block"):t.style.display!=="none"&&(t.style.display="none"),requestAnimationFrame(this.run)});b(this,"dispose",()=>{var t;(t=this.videoAgentMesh)==null||t.dispose()});this.container=t,this.camera.position.set(0,0,10),this.camera.lookAt(0,0,0);const o={width:t.offsetWidth,height:t.offsetHeight},i=this.renderer.domElement;i.classList.add("VideoAgent-canvas"),this.renderer.setSize(o.width*window.devicePixelRatio,o.height*window.devicePixelRatio),i.setAttribute("style",`width: ${o.width}px;height: ${o.height}px;`),this.videoAgentMesh=new St(480,270,1,1,s),n&&(t.append(i),this.scene.add(this.videoAgentMesh),this.run())}}function Ft(e){const t=w.exports.useRef(null),n=C();return w.exports.useEffect(()=>{if(!t.current)throw new Error("React \u6E32\u67D3\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5 ...");if(n.videoAgentScene){console.warn('"VideoAgentScene" \u91CD\u590D\u521D\u59CB\u5316\uFF0C\u5DF2\u88AB\u8FC7\u6EE4 ...');return}const s=new Rt(t.current,!0,e.options||{});return n.videoAgentScene=s,()=>{var o;n.dispose(),(o=n.videoAgentScene)==null||o.dispose()}},[]),h("div",{className:"VideoAgent",onClick:()=>{!e.onClick||e.onClick()},ref:t,children:h("div",{className:"VideoAgent-play"})})}function Dt(){const e=C(),t=w.exports.useRef(null),n=w.exports.useCallback(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]);return w.exports.useEffect(()=>{const s=new Audio;s.setAttribute("id","vreo-singleton-bgmusic"),s.style.display="none",s.setAttribute("playsinline","true"),s.loop=!0,document.body.append(s);const o=i=>{const{start:a,end:c}=i,{url:f}=i.data;s.src=f;const l=()=>{s.play()};s.addEventListener("canplaythrough",l),n();const p=()=>{s.pause(),s.currentTime=0,s.src="",n(),s.removeEventListener("canplaythrough",l)},r=c-a||5e3;t.current=setTimeout(()=>{p()},r),e.once("paused",()=>{p()})};return e.on(T.BgMusic,o),()=>{e.off(T.BgMusic,o),document.body.removeChild(s),n()}}),h(L,{})}const zt=le(({controller:e})=>{var t,n;return h("div",{className:U("vreo-panel",{"vreo-panel--hidden":!e.visible}),children:R("div",{className:"vreo-panel-inner",children:[h(Ft,{onClick:()=>{e.isAudio||(e.playing?e.setPlaying(!1):e.setPlaying(!0))},options:((t=e.configs)==null?void 0:t.videoAgentMeshOptions)||{}}),h(It,{}),(n=e.configs)==null?void 0:n.customPanelChildren]})})});function Ut(){const e=C();return R(L,{children:[R(L,{children:[h(it,{}),h(lt,{}),h(Pt,{}),h(Et,{}),h(ht,{}),h(bt,{}),h(at,{}),h(mt,{}),h(Dt,{})]}),h(zt,{controller:e})]})}const Vt=le(({controller:e})=>{var s;const t="400px",n=(()=>{var i;const o=(i=e.drawerConfig)==null?void 0:i.height;return o?typeof o=="number"?o+"px":o:"max-content"})();return h("div",{className:U("vreo-drawer",{"vreo-drawer-visible":e.drawerConfig&&e.drawerConfig.content}),onClick:()=>e.openDrawer(!1),children:h("div",{className:"vreo-drawer-inner",style:{height:n,maxHeight:t},children:((s=e.drawerConfig)==null?void 0:s.content)||""})})});function Nt(){const e=C();return h(Vt,{controller:e})}const Bt=le(({controller:e})=>h("div",{className:U("vreo-PopUp",{"vreo-PopUp-visible":e.popUp}),onClick:()=>e.openPopUp(!1),children:h("div",{className:"vreo-PopUp-inner",children:e.popUp||""})}));function $t(){const e=C();return h(Bt,{controller:e})}class jt extends ne{constructor(t,n={}){super();b(this,"$five");b(this,"controller");b(this,"configs");if(this.controller=new nt,this.$five=this.controller.$five=t,!n.containter){const s=document.querySelector("#vreo-app")||document.createElement("div");de.exports.unmountComponentAtNode(s),s.setAttribute("id","vreo-app"),n.containter=s,document.body.append(s)}this.configs=Object.freeze(Object.assign({keyframeMap:{}},n)),this.controller.configs=this.configs,de.exports.render(R(Ce.Provider,{value:this.controller,children:[h(Ut,{}),h(Nt,{}),h($t,{}),this.configs.customKeyframes&&this.configs.customKeyframes.map((s,o)=>h(s,{subscribe:{on:(i,a)=>this.on(i,a),once:(i,a)=>this.once(i,a),off:(i,a)=>this.off(i,a)},five:t},o))]}),n.containter),be(()=>this.controller.playing,s=>{this.emit(s?"playing":"paused")})}async load(t,n=0,s=!1,o=!1){var i,a,c,f;if(o&&(t=JSON.parse(JSON.stringify(t))),this.controller.visible||(this.controller.setVisible(!0),await new Promise(l=>{setTimeout(()=>l(!0),500)})),this.controller.stopInterval&&(this.controller.stopInterval(),this.controller.stopInterval=void 0),this.controller.vreoUnit=t,(i=this.controller.videoInstance)==null||i.pause(),this.$five.imageOptions.size&&((a=this.configs.imageOptions)==null?void 0:a.size)&&this.$five.imageOptions.size>this.configs.imageOptions.size&&(this.$five.imageOptions.size=this.configs.imageOptions.size),s||s===void 0&&this.configs.autoPreload){const l=t.keyframes.filter(r=>!(r.type!==T.CameraMovement||r.data.panoIndex===void 0)).reduce((r,v)=>{const g=v.data.panoIndex;return r[g]||(r[g]=!0),r},{}),p=Object.keys(l);for(let r=0;r<p.length;r++)await this.$five.preloadPano(Number(p[r]))}return this.emit("loaded",t),this.controller.emit("loaded",t),((c=this.controller.videoAgentScene)==null?void 0:c.videoAgentMesh.videoInstance)&&(this.controller.videoAgentScene.videoAgentMesh.videoInstance.currentTime=n/1e3),await((f=this.controller.videoAgentScene)==null?void 0:f.videoAgentMesh.play(t.video.url,n/1e3,t.video.duration)),this.play(),this.controller.run((l,p)=>this.emit(l,p)),!0}get paused(){return!this.controller.playing}play(t){return this.controller.playing||(t&&this.controller.videoInstance&&(this.controller.videoInstance.currentTime=t/1e3),Object.assign(window,{$vreoController:this.controller}),this.controller.setPlaying(!0)),!0}pause(){this.controller.setPlaying(!1)}show(){this.controller.setVisible(!0)}hide(){this.controller.setVisible(!1)}dispose(){this.pause(),this.controller.dispose(),this.configs.containter&&de.exports.unmountComponentAtNode(this.configs.containter)}}console.log(`

\u250F\u2501\u2501\u2501\u2513\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u250F\u2513\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
\u2503\u250F\u2501\u2513\u2503\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2503\u2503\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
\u2503\u2517\u2501\u251B\u2503\u250F\u2501\u2501\u2513\u250F\u2501\u2501\u2513\u2501\u2503\u2503\u2501\u250F\u2501\u2501\u2513\u250F\u2501\u2501\u2513\u250F\u2501\u2501\u2513
\u2503\u250F\u2513\u250F\u251B\u2503\u250F\u2513\u2503\u2517\u2501\u2513\u2503\u2501\u2503\u2503\u2501\u2503\u2501\u2501\u252B\u2503\u250F\u2513\u2503\u2503\u250F\u2513\u2503
\u2503\u2503\u2503\u2517\u2513\u2503\u2503\u2501\u252B\u2503\u2517\u251B\u2517\u2513\u2503\u2517\u2513\u2523\u2501\u2501\u2503\u2503\u2503\u2501\u252B\u2503\u2503\u2501\u252B
\u2517\u251B\u2517\u2501\u251B\u2517\u2501\u2501\u251B\u2517\u2501\u2501\u2501\u251B\u2517\u2501\u251B\u2517\u2501\u2501\u251B\u2517\u2501\u2501\u251B\u2517\u2501\u2501\u251B
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501
\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 

`);export{yt as C,jt as P,T as V,ft as t};
