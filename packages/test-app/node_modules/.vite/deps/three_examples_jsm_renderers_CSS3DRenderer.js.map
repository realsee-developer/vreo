{
  "version": 3,
  "sources": ["../../../../../node_modules/.pnpm/three@0.117.1/node_modules/three/examples/jsm/renderers/CSS3DRenderer.js"],
  "sourcesContent": ["/**\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\n * @author mrdoob / http://mrdoob.com/\n * @author yomotsu / https://yomotsu.net/\n */\n\nimport {\n\tMatrix4,\n\tObject3D,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar CSS3DObject = function ( element ) {\n\n\tObject3D.call( this );\n\n\tthis.element = element;\n\tthis.element.style.position = 'absolute';\n\tthis.element.style.pointerEvents = 'auto';\n\n\tthis.addEventListener( 'removed', function () {\n\n\t\tthis.traverse( function ( object ) {\n\n\t\t\tif ( object.element instanceof Element && object.element.parentNode !== null ) {\n\n\t\t\t\tobject.element.parentNode.removeChild( object.element );\n\n\t\t\t}\n\n\t\t} );\n\n\t} );\n\n};\n\nCSS3DObject.prototype = Object.create( Object3D.prototype );\nCSS3DObject.prototype.constructor = CSS3DObject;\n\nvar CSS3DSprite = function ( element ) {\n\n\tCSS3DObject.call( this, element );\n\n};\n\nCSS3DSprite.prototype = Object.create( CSS3DObject.prototype );\nCSS3DSprite.prototype.constructor = CSS3DSprite;\n\n//\n\nvar CSS3DRenderer = function () {\n\n\tvar _this = this;\n\n\tvar _width, _height;\n\tvar _widthHalf, _heightHalf;\n\n\tvar matrix = new Matrix4();\n\n\tvar cache = {\n\t\tcamera: { fov: 0, style: '' },\n\t\tobjects: new WeakMap()\n\t};\n\n\tvar domElement = document.createElement( 'div' );\n\tdomElement.style.overflow = 'hidden';\n\n\tthis.domElement = domElement;\n\n\tvar cameraElement = document.createElement( 'div' );\n\n\tcameraElement.style.WebkitTransformStyle = 'preserve-3d';\n\tcameraElement.style.transformStyle = 'preserve-3d';\n\tcameraElement.style.pointerEvents = 'none';\n\n\tdomElement.appendChild( cameraElement );\n\n\tvar isIE = /Trident/i.test( navigator.userAgent );\n\n\tthis.getSize = function () {\n\n\t\treturn {\n\t\t\twidth: _width,\n\t\t\theight: _height\n\t\t};\n\n\t};\n\n\tthis.setSize = function ( width, height ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\t\t_widthHalf = _width / 2;\n\t\t_heightHalf = _height / 2;\n\n\t\tdomElement.style.width = width + 'px';\n\t\tdomElement.style.height = height + 'px';\n\n\t\tcameraElement.style.width = width + 'px';\n\t\tcameraElement.style.height = height + 'px';\n\n\t};\n\n\tfunction epsilon( value ) {\n\n\t\treturn Math.abs( value ) < 1e-10 ? 0 : value;\n\n\t}\n\n\tfunction getCameraCSSMatrix( matrix ) {\n\n\t\tvar elements = matrix.elements;\n\n\t\treturn 'matrix3d(' +\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\tepsilon( - elements[ 1 ] ) + ',' +\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\tepsilon( elements[ 4 ] ) + ',' +\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\tepsilon( elements[ 6 ] ) + ',' +\n\t\t\tepsilon( elements[ 7 ] ) + ',' +\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\tepsilon( - elements[ 9 ] ) + ',' +\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\tepsilon( - elements[ 13 ] ) + ',' +\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\tepsilon( elements[ 15 ] ) +\n\t\t')';\n\n\t}\n\n\tfunction getObjectCSSMatrix( matrix, cameraCSSMatrix ) {\n\n\t\tvar elements = matrix.elements;\n\t\tvar matrix3d = 'matrix3d(' +\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\tepsilon( elements[ 1 ] ) + ',' +\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\tepsilon( - elements[ 4 ] ) + ',' +\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\tepsilon( - elements[ 6 ] ) + ',' +\n\t\t\tepsilon( - elements[ 7 ] ) + ',' +\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\tepsilon( elements[ 9 ] ) + ',' +\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\tepsilon( elements[ 13 ] ) + ',' +\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\tepsilon( elements[ 15 ] ) +\n\t\t')';\n\n\t\tif ( isIE ) {\n\n\t\t\treturn 'translate(-50%,-50%)' +\n\t\t\t\t'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)' +\n\t\t\t\tcameraCSSMatrix +\n\t\t\t\tmatrix3d;\n\n\t\t}\n\n\t\treturn 'translate(-50%,-50%)' + matrix3d;\n\n\t}\n\n\tfunction renderObject( object, scene, camera, cameraCSSMatrix ) {\n\n\t\tif ( object instanceof CSS3DObject ) {\n\n\t\t\tobject.onBeforeRender( _this, scene, camera );\n\n\t\t\tvar style;\n\n\t\t\tif ( object instanceof CSS3DSprite ) {\n\n\t\t\t\t// http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\n\n\t\t\t\tmatrix.copy( camera.matrixWorldInverse );\n\t\t\t\tmatrix.transpose();\n\t\t\t\tmatrix.copyPosition( object.matrixWorld );\n\t\t\t\tmatrix.scale( object.scale );\n\n\t\t\t\tmatrix.elements[ 3 ] = 0;\n\t\t\t\tmatrix.elements[ 7 ] = 0;\n\t\t\t\tmatrix.elements[ 11 ] = 0;\n\t\t\t\tmatrix.elements[ 15 ] = 1;\n\n\t\t\t\tstyle = getObjectCSSMatrix( matrix, cameraCSSMatrix );\n\n\t\t\t} else {\n\n\t\t\t\tstyle = getObjectCSSMatrix( object.matrixWorld, cameraCSSMatrix );\n\n\t\t\t}\n\n\t\t\tvar element = object.element;\n\t\t\tvar cachedObject = cache.objects.get( object );\n\n\t\t\tif ( cachedObject === undefined || cachedObject.style !== style ) {\n\n\t\t\t\telement.style.WebkitTransform = style;\n\t\t\t\telement.style.transform = style;\n\n\t\t\t\tvar objectData = { style: style };\n\n\t\t\t\tif ( isIE ) {\n\n\t\t\t\t\tobjectData.distanceToCameraSquared = getDistanceToSquared( camera, object );\n\n\t\t\t\t}\n\n\t\t\t\tcache.objects.set( object, objectData );\n\n\t\t\t}\n\n\t\t\telement.style.display = object.visible ? '' : 'none';\n\n\t\t\tif ( element.parentNode !== cameraElement ) {\n\n\t\t\t\tcameraElement.appendChild( element );\n\n\t\t\t}\n\n\t\t\tobject.onAfterRender( _this, scene, camera );\n\n\t\t}\n\n\t\tfor ( var i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\trenderObject( object.children[ i ], scene, camera, cameraCSSMatrix );\n\n\t\t}\n\n\t}\n\n\tvar getDistanceToSquared = function () {\n\n\t\tvar a = new Vector3();\n\t\tvar b = new Vector3();\n\n\t\treturn function ( object1, object2 ) {\n\n\t\t\ta.setFromMatrixPosition( object1.matrixWorld );\n\t\t\tb.setFromMatrixPosition( object2.matrixWorld );\n\n\t\t\treturn a.distanceToSquared( b );\n\n\t\t};\n\n\t}();\n\n\tfunction filterAndFlatten( scene ) {\n\n\t\tvar result = [];\n\n\t\tscene.traverse( function ( object ) {\n\n\t\t\tif ( object instanceof CSS3DObject ) result.push( object );\n\n\t\t} );\n\n\t\treturn result;\n\n\t}\n\n\tfunction zOrder( scene ) {\n\n\t\tvar sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\n\n\t\t\tvar distanceA = cache.objects.get( a ).distanceToCameraSquared;\n\t\t\tvar distanceB = cache.objects.get( b ).distanceToCameraSquared;\n\n\t\t\treturn distanceA - distanceB;\n\n\t\t} );\n\n\t\tvar zMax = sorted.length;\n\n\t\tfor ( var i = 0, l = sorted.length; i < l; i ++ ) {\n\n\t\t\tsorted[ i ].element.style.zIndex = zMax - i;\n\n\t\t}\n\n\t}\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tvar fov = camera.projectionMatrix.elements[ 5 ] * _heightHalf;\n\n\t\tif ( cache.camera.fov !== fov ) {\n\n\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\tdomElement.style.WebkitPerspective = fov + 'px';\n\t\t\t\tdomElement.style.perspective = fov + 'px';\n\n\t\t\t} else {\n\n\t\t\t\tdomElement.style.WebkitPerspective = '';\n\t\t\t\tdomElement.style.perspective = '';\n\n\t\t\t}\n\n\t\t\tcache.camera.fov = fov;\n\n\t\t}\n\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\tif ( camera.isOrthographicCamera ) {\n\n\t\t\tvar tx = - ( camera.right + camera.left ) / 2;\n\t\t\tvar ty = ( camera.top + camera.bottom ) / 2;\n\n\t\t}\n\n\t\tvar cameraCSSMatrix = camera.isOrthographicCamera ?\n\t\t\t'scale(' + fov + ')' + 'translate(' + epsilon( tx ) + 'px,' + epsilon( ty ) + 'px)' + getCameraCSSMatrix( camera.matrixWorldInverse ) :\n\t\t\t'translateZ(' + fov + 'px)' + getCameraCSSMatrix( camera.matrixWorldInverse );\n\n\t\tvar style = cameraCSSMatrix +\n\t\t\t'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)';\n\n\t\tif ( cache.camera.style !== style && ! isIE ) {\n\n\t\t\tcameraElement.style.WebkitTransform = style;\n\t\t\tcameraElement.style.transform = style;\n\n\t\t\tcache.camera.style = style;\n\n\t\t}\n\n\t\trenderObject( scene, scene, camera, cameraCSSMatrix );\n\n\t\tif ( isIE ) {\n\n\t\t\t// IE10 and 11 does not support 'preserve-3d'.\n\t\t\t// Thus, z-order in 3D will not work.\n\t\t\t// We have to calc z-order manually and set CSS z-index for IE.\n\t\t\t// FYI: z-index can't handle object intersection\n\t\t\tzOrder( scene );\n\n\t\t}\n\n\t};\n\n};\n\nexport { CSS3DObject, CSS3DSprite, CSS3DRenderer };\n"],
  "mappings": ";;;;;;;;AAYA,IAAI,cAAc,SAAW,SAAU;AAEtC,WAAS,KAAM,IAAK;AAEpB,OAAK,UAAU;AACf,OAAK,QAAQ,MAAM,WAAW;AAC9B,OAAK,QAAQ,MAAM,gBAAgB;AAEnC,OAAK,iBAAkB,WAAW,WAAY;AAE7C,SAAK,SAAU,SAAW,QAAS;AAElC,UAAK,OAAO,mBAAmB,WAAW,OAAO,QAAQ,eAAe,MAAO;AAE9E,eAAO,QAAQ,WAAW,YAAa,OAAO,OAAQ;AAAA,MAEvD;AAAA,IAED,CAAE;AAAA,EAEH,CAAE;AAEH;AAEA,YAAY,YAAY,OAAO,OAAQ,SAAS,SAAU;AAC1D,YAAY,UAAU,cAAc;AAEpC,IAAI,cAAc,SAAW,SAAU;AAEtC,cAAY,KAAM,MAAM,OAAQ;AAEjC;AAEA,YAAY,YAAY,OAAO,OAAQ,YAAY,SAAU;AAC7D,YAAY,UAAU,cAAc;AAIpC,IAAI,gBAAgB,WAAY;AAE/B,MAAI,QAAQ;AAEZ,MAAI,QAAQ;AACZ,MAAI,YAAY;AAEhB,MAAI,SAAS,IAAI,QAAQ;AAEzB,MAAI,QAAQ;AAAA,IACX,QAAQ,EAAE,KAAK,GAAG,OAAO,GAAG;AAAA,IAC5B,SAAS,oBAAI,QAAQ;AAAA,EACtB;AAEA,MAAI,aAAa,SAAS,cAAe,KAAM;AAC/C,aAAW,MAAM,WAAW;AAE5B,OAAK,aAAa;AAElB,MAAI,gBAAgB,SAAS,cAAe,KAAM;AAElD,gBAAc,MAAM,uBAAuB;AAC3C,gBAAc,MAAM,iBAAiB;AACrC,gBAAc,MAAM,gBAAgB;AAEpC,aAAW,YAAa,aAAc;AAEtC,MAAI,OAAO,WAAW,KAAM,UAAU,SAAU;AAEhD,OAAK,UAAU,WAAY;AAE1B,WAAO;AAAA,MACN,OAAO;AAAA,MACP,QAAQ;AAAA,IACT;AAAA,EAED;AAEA,OAAK,UAAU,SAAW,OAAO,QAAS;AAEzC,aAAS;AACT,cAAU;AACV,iBAAa,SAAS;AACtB,kBAAc,UAAU;AAExB,eAAW,MAAM,QAAQ,QAAQ;AACjC,eAAW,MAAM,SAAS,SAAS;AAEnC,kBAAc,MAAM,QAAQ,QAAQ;AACpC,kBAAc,MAAM,SAAS,SAAS;AAAA,EAEvC;AAEA,WAAS,QAAS,OAAQ;AAEzB,WAAO,KAAK,IAAK,KAAM,IAAI,QAAQ,IAAI;AAAA,EAExC;AAEA,WAAS,mBAAoBA,SAAS;AAErC,QAAI,WAAWA,QAAO;AAEtB,WAAO,cACN,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,CAAE,SAAU,CAAE,CAAE,IAAI,MAC7B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,CAAE,SAAU,CAAE,CAAE,IAAI,MAC7B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,CAAE,SAAU,CAAE,CAAE,IAAI,MAC7B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,CAAE,SAAU,EAAG,CAAE,IAAI,MAC9B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,SAAU,EAAG,CAAE,IACzB;AAAA,EAED;AAEA,WAAS,mBAAoBA,SAAQ,iBAAkB;AAEtD,QAAI,WAAWA,QAAO;AACtB,QAAI,WAAW,cACd,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,CAAE,SAAU,CAAE,CAAE,IAAI,MAC7B,QAAS,CAAE,SAAU,CAAE,CAAE,IAAI,MAC7B,QAAS,CAAE,SAAU,CAAE,CAAE,IAAI,MAC7B,QAAS,CAAE,SAAU,CAAE,CAAE,IAAI,MAC7B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,CAAE,CAAE,IAAI,MAC3B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,SAAU,EAAG,CAAE,IAAI,MAC5B,QAAS,SAAU,EAAG,CAAE,IACzB;AAEA,QAAK,MAAO;AAEX,aAAO,mCACS,aAAa,QAAQ,cAAc,QAClD,kBACA;AAAA,IAEF;AAEA,WAAO,yBAAyB;AAAA,EAEjC;AAEA,WAAS,aAAc,QAAQ,OAAO,QAAQ,iBAAkB;AAE/D,QAAK,kBAAkB,aAAc;AAEpC,aAAO,eAAgB,OAAO,OAAO,MAAO;AAE5C,UAAI;AAEJ,UAAK,kBAAkB,aAAc;AAIpC,eAAO,KAAM,OAAO,kBAAmB;AACvC,eAAO,UAAU;AACjB,eAAO,aAAc,OAAO,WAAY;AACxC,eAAO,MAAO,OAAO,KAAM;AAE3B,eAAO,SAAU,CAAE,IAAI;AACvB,eAAO,SAAU,CAAE,IAAI;AACvB,eAAO,SAAU,EAAG,IAAI;AACxB,eAAO,SAAU,EAAG,IAAI;AAExB,gBAAQ,mBAAoB,QAAQ,eAAgB;AAAA,MAErD,OAAO;AAEN,gBAAQ,mBAAoB,OAAO,aAAa,eAAgB;AAAA,MAEjE;AAEA,UAAI,UAAU,OAAO;AACrB,UAAI,eAAe,MAAM,QAAQ,IAAK,MAAO;AAE7C,UAAK,iBAAiB,UAAa,aAAa,UAAU,OAAQ;AAEjE,gBAAQ,MAAM,kBAAkB;AAChC,gBAAQ,MAAM,YAAY;AAE1B,YAAI,aAAa,EAAE,MAAa;AAEhC,YAAK,MAAO;AAEX,qBAAW,0BAA0B,qBAAsB,QAAQ,MAAO;AAAA,QAE3E;AAEA,cAAM,QAAQ,IAAK,QAAQ,UAAW;AAAA,MAEvC;AAEA,cAAQ,MAAM,UAAU,OAAO,UAAU,KAAK;AAE9C,UAAK,QAAQ,eAAe,eAAgB;AAE3C,sBAAc,YAAa,OAAQ;AAAA,MAEpC;AAEA,aAAO,cAAe,OAAO,OAAO,MAAO;AAAA,IAE5C;AAEA,aAAU,IAAI,GAAG,IAAI,OAAO,SAAS,QAAQ,IAAI,GAAG,KAAO;AAE1D,mBAAc,OAAO,SAAU,CAAE,GAAG,OAAO,QAAQ,eAAgB;AAAA,IAEpE;AAAA,EAED;AAEA,MAAI,uBAAuB,WAAY;AAEtC,QAAI,IAAI,IAAI,QAAQ;AACpB,QAAI,IAAI,IAAI,QAAQ;AAEpB,WAAO,SAAW,SAAS,SAAU;AAEpC,QAAE,sBAAuB,QAAQ,WAAY;AAC7C,QAAE,sBAAuB,QAAQ,WAAY;AAE7C,aAAO,EAAE,kBAAmB,CAAE;AAAA,IAE/B;AAAA,EAED,EAAE;AAEF,WAAS,iBAAkB,OAAQ;AAElC,QAAI,SAAS,CAAC;AAEd,UAAM,SAAU,SAAW,QAAS;AAEnC,UAAK,kBAAkB,YAAc,QAAO,KAAM,MAAO;AAAA,IAE1D,CAAE;AAEF,WAAO;AAAA,EAER;AAEA,WAAS,OAAQ,OAAQ;AAExB,QAAI,SAAS,iBAAkB,KAAM,EAAE,KAAM,SAAW,GAAG,GAAI;AAE9D,UAAI,YAAY,MAAM,QAAQ,IAAK,CAAE,EAAE;AACvC,UAAI,YAAY,MAAM,QAAQ,IAAK,CAAE,EAAE;AAEvC,aAAO,YAAY;AAAA,IAEpB,CAAE;AAEF,QAAI,OAAO,OAAO;AAElB,aAAU,IAAI,GAAG,IAAI,OAAO,QAAQ,IAAI,GAAG,KAAO;AAEjD,aAAQ,CAAE,EAAE,QAAQ,MAAM,SAAS,OAAO;AAAA,IAE3C;AAAA,EAED;AAEA,OAAK,SAAS,SAAW,OAAO,QAAS;AAExC,QAAI,MAAM,OAAO,iBAAiB,SAAU,CAAE,IAAI;AAElD,QAAK,MAAM,OAAO,QAAQ,KAAM;AAE/B,UAAK,OAAO,qBAAsB;AAEjC,mBAAW,MAAM,oBAAoB,MAAM;AAC3C,mBAAW,MAAM,cAAc,MAAM;AAAA,MAEtC,OAAO;AAEN,mBAAW,MAAM,oBAAoB;AACrC,mBAAW,MAAM,cAAc;AAAA,MAEhC;AAEA,YAAM,OAAO,MAAM;AAAA,IAEpB;AAEA,QAAK,MAAM,eAAe,KAAO,OAAM,kBAAkB;AACzD,QAAK,OAAO,WAAW,KAAO,QAAO,kBAAkB;AAEvD,QAAK,OAAO,sBAAuB;AAElC,UAAI,KAAK,EAAI,OAAO,QAAQ,OAAO,QAAS;AAC5C,UAAI,MAAO,OAAO,MAAM,OAAO,UAAW;AAAA,IAE3C;AAEA,QAAI,kBAAkB,OAAO,uBAC5B,WAAW,MAAM,gBAAqB,QAAS,EAAG,IAAI,QAAQ,QAAS,EAAG,IAAI,QAAQ,mBAAoB,OAAO,kBAAmB,IACpI,gBAAgB,MAAM,QAAQ,mBAAoB,OAAO,kBAAmB;AAE7E,QAAI,QAAQ,kBACX,eAAe,aAAa,QAAQ,cAAc;AAEnD,QAAK,MAAM,OAAO,UAAU,SAAS,CAAE,MAAO;AAE7C,oBAAc,MAAM,kBAAkB;AACtC,oBAAc,MAAM,YAAY;AAEhC,YAAM,OAAO,QAAQ;AAAA,IAEtB;AAEA,iBAAc,OAAO,OAAO,QAAQ,eAAgB;AAEpD,QAAK,MAAO;AAMX,aAAQ,KAAM;AAAA,IAEf;AAAA,EAED;AAED;",
  "names": ["matrix"]
}
