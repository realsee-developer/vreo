import{C as D,t as T,_ as y}from"./default-BPKLuSfr.js";import{r as e,V as N,R as j,a as b,b as V}from"./index-Cc9jxIgg.js";var Y=function(n){var a=n.five,r=n.dom,i=new b;a.camera.getWorldDirection(i);var c=a.camera.position,v=a.model.intersectRaycaster(new V(c,i)),d=y(v,1),h=d[0],m=a.project2d(h.point),p=window.innerWidth>560,$=r.clientHeight;r.style.left=m.x+"px",r.style.top=m.y-$/2+"px";var s=r.getBoundingClientRect(),S=s.left,f=s.top,o=s.bottom,g=s.right,R=new b(S,o),w=new b(S,f),_=new b(g,f),E=new b(g,o),l=[R,E,_,w].map(function(u){return u.setX(u.x/window.innerWidth*2-(p?1.25:1.75)),u.setY(-(u.y/window.innerHeight)*2+(p?1.35:1.125)),u.setZ(.5),u.unproject(a.camera).addScaledVector(i,.2)}),P=R.distanceTo(E)/(p?150:120);return{points:l,ratio:P}};function A(t){var n=e.useRef(null),a=e.useRef(null),r=e.useRef(null),i=e.useRef(D(t.five));return e.useEffect(function(){if(a.current){var c=function(d){if(d.data.customType==="SpatialScenePanel"){var h=d.data,m=Y({five:t.five,dom:a.current}),p=m.points,$=m.ratio,s=i.current.create3DDomContainer(p,{ratio:$,autoRender:!1})||{},S=s.container,f=s.dispose,o=s.css3DObject,g=s.render;if(Object.assign(window,{$css3DObject:o}),!!S){j.render(e.createElement(L,{ref:function(P){return r.current=P},data:h}),S);var R=-(Math.PI*2)/9,w=0;T(1e3).onUpdate(function(l){var P=l.progress,u=Math.PI/90*11*P,x=u-w;o==null||o.rotateY(x),w=u}).onStart(function(){o==null||o.rotateY(R),g()}).onDispose(function(){var l;(l=r.current)===null||l===void 0||l.classList.add("show")}).play();var _=d.start,E=d.end;n.current=setTimeout(function(){var l;(l=r.current)===null||l===void 0||l.classList.add("hide"),n.current=setTimeout(function(){f==null||f(),n.current=null},1500)},E-_)}}};return Object.assign(window,{$callback:c}),t.subscribe.on(N.Custom,c),function(){t.subscribe.off(N.Custom,c),n.current&&clearTimeout(n.current)}}},[]),e.createElement("div",{className:"vreo-SpatialScenePanel",ref:a})}function C(){var t=e.useRef(null),n=e.useRef(null);return e.useEffect(function(){if(t.current){var a=function(){var i;(i=t.current)===null||i===void 0||i.setAttribute("class","SpatialScenePanel-bg"),n.current=setTimeout(function(){var c;(c=t.current)===null||c===void 0||c.setAttribute("class","SpatialScenePanel-bg SpatialScenePanel-bg--animation"),n.current=null},3e3)};return t.current.addEventListener("animationend",a),function(){t.current&&t.current.removeEventListener("animationend",a),n.current&&clearTimeout(n.current)}}},[]),e.createElement("div",{ref:t,className:"SpatialScenePanel-bg SpatialScenePanel-bg--animation"})}var L=e.forwardRef(function(t,n){var a,r,i,c;return e.createElement("div",{className:"SpatialScenePanel",ref:n},e.createElement("div",{className:"SpatialScenePanel-show-area"},e.createElement(C,null),e.createElement("div",{className:"SpatialScenePanel-header"},e.createElement("div",{className:"SpatialScenePanel-title"},(a=t.data)===null||a===void 0?void 0:a.title),e.createElement("div",{className:"SpatialScenePanel-temperature"},(r=t.data)===null||r===void 0?void 0:r.temperature,"â„ƒ")),e.createElement("div",{className:"SpatialScenePanel-body"},(i=t.data)===null||i===void 0||(c=i.stateList)===null||c===void 0?void 0:c.map(function(v,d){return e.createElement("div",{key:"scene-".concat(v.text),className:"SpatialScenePanel-item index_".concat(d)},e.createElement("img",{className:"SpatialScenePanel-icon",src:v.icon,alt:"".concat(v.text)}),e.createElement("div",{className:"SpatialScenePanel-text"},v.text),e.createElement("div",{className:"SpatialScenePanel-dot"}))}))),e.createElement("div",{className:"SpatialScenePanel-disappear-area"}))});export{A as S};
